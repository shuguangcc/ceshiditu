import{u as j,e as t,y as i,n as f}from"./cast-7928d7aa.js";import{c as N}from"./Analysis-f03f731f.js";import{l as u}from"./Color-a42a8267.js";import{l as S}from"./Clonable-ba795b08.js";import{o as w,e as E}from"./screenUtils-410d12c0.js";import{t as y,r,e as v}from"./typedArrayUtil-a8b5b3e9.js";import{T as c}from"./ensureType-cf29afa9.js";import{u as P}from"./LengthDimension-d35d103c.js";import{j as $}from"./Collection-78126e82.js";import{t as q,n as D}from"./collectionUtils-3831b7c4.js";import{l as O,w as R}from"./reactiveUtils-f41a4e00.js";import{a as x,r as k}from"./Extent-69509002.js";import{G as z}from"./projection-d7b57a6c.js";import{O as C}from"./MultiOriginJSONSupport-27362d57.js";import{b as _}from"./Layer-f0696768.js";import{c as A}from"./OperationalLayer-24e6fa34.js";import"./string-cdf077e6.js";import"./Error-653283ae.js";import"./nextTick-3ee5a785.js";import"./promiseUtils-6684e352.js";import"./Identifiable-aa6d459d.js";import"./colorUtils-639f4d25.js";import"./mathUtils-2519596a.js";import"./vec3-a020a6f6.js";import"./vec3f64-2f9cef06.js";import"./common-c186b691.js";import"./vec4-790471c0.js";import"./geometry-5a216427.js";import"./Polyline-bf268e7b.js";import"./typeUtils-eb9416d0.js";import"./jsonMap-c1f958cf.js";import"./Cyclical-b66238c6.js";import"./Evented-515b9d9c.js";import"./SimpleObservable-7dcdef1d.js";import"./Ellipsoid-89682c5e.js";import"./preload-helper-41c905a7.js";import"./unitUtils-47abac71.js";import"./mat4-44a0988f.js";import"./assets-0b172f07.js";import"./request-d3e98716.js";import"./aaBoundingRect-4a760199.js";import"./zscale-1e1fc911.js";import"./Loadable-48bc1293.js";import"./Promise-dfdee8ba.js";import"./TimeExtent-744afd75.js";import"./persistableUrlUtils-a16d0f55.js";import"./ElevationInfo-ce9cacc2.js";import"./fieldUtils-31bfecd2.js";import"./arcadeOnDemand-c6d1b9f2.js";import"./lengthUtils-d2d33f94.js";import"./opacityUtils-243aae26.js";let p=class extends j(S){constructor(e){super(e),this.type="simple",this.color=new u("black"),this.lineSize=2,this.fontSize=10,this.textColor=new u("black"),this.textBackgroundColor=new u([255,255,255,.6])}};t([i({type:["simple"],readOnly:!0,json:{write:{isRequired:!0}}})],p.prototype,"type",void 0),t([i({type:u,nonNullable:!0,json:{type:[c],write:{isRequired:!0}}})],p.prototype,"color",void 0),t([i({type:Number,cast:w,nonNullable:!0,range:{min:E(1)},json:{write:{isRequired:!0}}})],p.prototype,"lineSize",void 0),t([i({type:Number,cast:w,nonNullable:!0,json:{write:{isRequired:!0}}})],p.prototype,"fontSize",void 0),t([i({type:u,nonNullable:!0,json:{type:[c],write:{isRequired:!0}}})],p.prototype,"textColor",void 0),t([i({type:u,nonNullable:!0,json:{type:[c],write:{isRequired:!0}}})],p.prototype,"textBackgroundColor",void 0),p=t([f("esri.analysis.DimensionSimpleStyle")],p);const g=p,h=$.ofType(P);let l=class extends N{constructor(e){super(e),this.type="dimension",this.style=new g,this.extent=null}initialize(){this.addHandles(O(()=>this._computeExtent(),e=>{(y(e)||y(e.pending))&&this._set("extent",r(e)?e.extent:null)},R))}get dimensions(){return this._get("dimensions")||new h}set dimensions(e){this._set("dimensions",D(e,this.dimensions,h))}get spatialReference(){for(const e of this.dimensions){if(r(e.startPoint))return e.startPoint.spatialReference;if(r(e.endPoint))return e.endPoint.spatialReference}return null}get requiredPropertiesForEditing(){return this.dimensions.reduce((e,o)=>(e.push(o.startPoint,o.endPoint),e),[])}async waitComputeExtent(){const e=this._computeExtent();return r(e)?v(e.pending):null}_computeExtent(){const e=this.spatialReference;if(y(e))return{pending:null,extent:null};const o=[];for(const s of this.dimensions)r(s.startPoint)&&o.push(s.startPoint),r(s.endPoint)&&o.push(s.endPoint);const a=z(o,e);if(r(a.pending))return{pending:a.pending,extent:null};let d=null;return r(a.geometries)&&(d=a.geometries.reduce((s,m)=>y(s)?r(m)?x.fromPoint(m):null:r(m)?s.union(x.fromPoint(m)):s,null)),{pending:null,extent:d}}clear(){this.dimensions.removeAll()}};t([i({type:["dimension"]})],l.prototype,"type",void 0),t([i({cast:q,type:h,nonNullable:!0})],l.prototype,"dimensions",null),t([i({readOnly:!0})],l.prototype,"spatialReference",null),t([i({types:{key:"type",base:null,typeMap:{simple:g}},nonNullable:!0})],l.prototype,"style",void 0),t([i({value:null,readOnly:!0})],l.prototype,"extent",void 0),t([i({readOnly:!0})],l.prototype,"requiredPropertiesForEditing",null),l=t([f("esri.analysis.DimensionAnalysis")],l);const b=l;let n=class extends A(C(_)){constructor(e){if(super(e),this.type="dimension",this.operationalLayerType="ArcGISDimensionLayer",this.source=new b,this.opacity=1,e){const{source:o,style:a}=e;o&&a&&(o.style=a)}}initialize(){this.addHandles([O(()=>this.source,(e,o)=>{r(o)&&o.parent===this&&(o.parent=null),r(e)&&(e.parent=this)},R)])}async load(){return this.addResolvingPromise(this.source.waitComputeExtent()),this}get spatialReference(){return v(this.source.spatialReference)}get style(){return this.source.style}set style(e){this.source.style=e}get fullExtent(){return this.source.extent}releaseAnalysis(e){this.source===e&&(this.source=new b)}get analysis(){return this.source}set analysis(e){this.source=e}get dimensions(){return this.source.dimensions}set dimensions(e){this.source.dimensions=e}writeDimensions(e,o,a,d){o.dimensions=e.filter(({startPoint:s,endPoint:m})=>r(s)&&r(m)).map(s=>s.toJSON(d)).toJSON()}};t([i({json:{read:!1},readOnly:!0})],n.prototype,"type",void 0),t([i({type:["ArcGISDimensionLayer"]})],n.prototype,"operationalLayerType",void 0),t([i({nonNullable:!0})],n.prototype,"source",void 0),t([i({readOnly:!0})],n.prototype,"spatialReference",null),t([i({types:{key:"type",base:null,typeMap:{simple:g}},json:{write:{ignoreOrigin:!0}}})],n.prototype,"style",null),t([i({readOnly:!0})],n.prototype,"fullExtent",null),t([i({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],n.prototype,"opacity",void 0),t([i({type:["show","hide"]})],n.prototype,"listMode",void 0),t([i({type:$.ofType(P),json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{ignoreOrigin:!0}}}}})],n.prototype,"dimensions",null),t([k("web-scene","dimensions")],n.prototype,"writeDimensions",null),n=t([f("esri.layers.DimensionLayer")],n);const Ce=n;export{Ce as default};
