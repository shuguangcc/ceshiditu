import{s as tt,a as Ze,b as QE}from"./Error-653283ae.js";import{e as f,l as Wo,n as ge,m as et,y,u as rie,s as Mr,t as mi,a as rye,b as sie,x as _G,A as Vm,v as aie,o as sye,c as bh,d as Wi,f as bG,g as MN,h as sB,i as th,r as oie,j as pn,k as tf,p as ZD,q as aye,w as IM,z as oye,F as lye,B as JE,C as aT}from"./cast-7928d7aa.js";import{s as wG,x as Dx}from"./Basemap-a8f7f439.js";import{_ as Ee}from"./preload-helper-41c905a7.js";import{l as Xt}from"./Color-a42a8267.js";import{j as _i,E as xG}from"./Collection-78126e82.js";import{n as cye}from"./collectionUtils-3831b7c4.js";import{o as uye,n as Do}from"./compilerUtils-034cacb8.js";import{y as ko,n as kx,h as Fi}from"./string-cdf077e6.js";import{m as q0}from"./Loadable-48bc1293.js";import{n as dye}from"./loadAll-7fd968fe.js";import{f as Cn,E as Ra,i as Uv,g as iy,U as Fx,j as zo,b as hye,L as lie,A as cie,a as js,v as Bm,p as bu,C as BA,t as LL,D as _b,w as pye,d as fye,r as mye,x as DL,y as e2}from"./promiseUtils-6684e352.js";import{T as CG,b as kL,a as Pv,t as $M,r as uS,n as ps,S as gye,e as Ic}from"./ensureType-cf29afa9.js";import{r as eE,w as Wt,o as PN,R as FL,E as Vc,a as fs,k as $n,I as uie,p as die,b as aB,c as hie,d as vye,M as oB,P as zA,s as UA,f as TG,e as ON,g as yye,A as NI,S as oT,h as VI,u as _ye,T as pie,i as bye,j as Xv,l as fie}from"./Extent-69509002.js";import{t as B,r as T,s as _t,i as Jt,u as HA,o as Qa,f as NL,c as VL,e as kt,h as Gr,p as ll,q as ms,w as Lr,a as Ht,b as Ov,l as wye,y as mie,A as gie,d as vie,n as qb,C as BI,v as yie,g as K0,j as xye,k as RN,m as Cye,M as Tye,x as Sye,z as Eye,B as Aye}from"./typedArrayUtil-a8b5b3e9.js";import{r as bb}from"./enumeration-3c281341.js";import{r as Mye,n as Pye}from"./opacityUtils-243aae26.js";import{l as t2}from"./CollectionFlattener-3dd1f479.js";import{n as Pn}from"./Evented-515b9d9c.js";import{F as Oye,U as Mc,s as SG,n as Rye,I as lB,B as Iye,o as $ye}from"./request-d3e98716.js";import{l as Lye,d as Dye,t as kye}from"./TablesMixin-e7a6aab1.js";import{g as ao}from"./Graphic-b46e2684.js";import{i as _ie}from"./Clonable-ba795b08.js";import{s as BL,r as py,i as i2,o as Fye}from"./Cyclical-b66238c6.js";import{a as lt,b as ql,l as Uo,m as zi,g as Hp,j as Nye,A as Vye,D as Bye,h as ki,v as Nx,N as nf,i as cB,F as IN,c as n2}from"./mathUtils-2519596a.js";import{i as zye}from"./geometry-5a216427.js";import{v as $N,c as bie}from"./jsonUtils-03c4af61.js";import{l as ue,h as At,a as Sn,f as rs,U as on,j as $u,w as hn,P as Uye}from"./reactiveUtils-f41a4e00.js";import{c as Cs,i as Fn,x as pa,p as Vx,d as Ep,u as Hn,e as Gp,s as wie}from"./screenUtils-410d12c0.js";import{l as xie}from"./workers-898a7c4c.js";import{e as Y0,A as $y,r as Bc,t as MC,R as X0,y as Hye,g as ya,j as no,d as fy,x as Kl,Z as zm,p as Gye,v as zL,a as Cie,H as Tie,P as Wye,f as lT,i as Ac,b as jye,c as qye,_ as Kye}from"./projection-d7b57a6c.js";import{p as Yye,j as tE}from"./TileInfo-34f80a8e.js";import{i as zI,e as En,M as gr,n as z,v as UI,h as EG,f as Su,p as Ow,k as Sie,a as Bx,t as Eie,w as Xye,b as uB,r as AG,c as Aie,o as MG}from"./widget-f7489a3f.js";import{c as wb,a as Ba,d as PC}from"./HandleOwner-e1406413.js";import{s as ua}from"./intl-f1e98361.js";import{s as LN,t as Zye}from"./byteSizeEstimations-f0cab514.js";import{E as ec,O as Mie,J as Pie,K as Oie,R as Rie,A as Qye,T as Jye,$ as rf,a as e_e,u as rn,L as t_e,Y as i_e}from"./unitUtils-47abac71.js";import{m as lg,L as HI,u as n_e,S as Iie}from"./number-347a3a44.js";import{a as r_e,s as QD}from"./executeQueryJSON-bcd96e1a.js";import{c as PG,d as DN}from"./RelationshipQuery-db5fcd0c.js";import{x as s_e,h as a_e,i as JO,T as o_e,t as OG,r as kN,s as RG,n as l_e,f as c_e,C as u_e,R as d_e,e as IG,o as h_e,a as $ie,c as Lie,E as p_e}from"./fieldUtils-31bfecd2.js";import{u as f_e,i as m_e,c as Die,a as g_e,I as v_e,b as kie,d as y_e,e as __e,f as OC,g as dB,h as Fie,k as b_e}from"./PopupTemplate-6eb885db.js";import{i as UL,o as w_e}from"./arcadeOnDemand-c6d1b9f2.js";import{a as zx,n as x_e}from"./assets-0b172f07.js";import"./LegendOptions-e65e7a9c.js";import{j as Kb,q as r2,x as JD,M as C_e,N as T_e,y as FN,g as Nie,a as S_e,h as E_e,d as HL,b as Vie,f as A_e,w as M_e}from"./utils-725f8b4e.js";import{m as s2,S as a2,p as P_e,d as hB,l as Bie,i as pB,j as zie,h as O_e,a as R_e,b as I_e,y as wh,c as jy,e as Uie}from"./symbols-fa594797.js";import{a as $_e,t as L_e}from"./jsonUtils-c56f8821.js";import{m as D_e,x as eR}from"./Query-ff8c2cfb.js";import{n as k_e}from"./featureConversionUtils-01cdde8a.js";import{i as F_e,v as Om,u as Hie,c as Gie,o as N_e,a as V_e,m as sx,r as Ux,h as $G}from"./Polyline-bf268e7b.js";import{f as B_e,i as z_e,o as U_e,M as H_e}from"./normalizeUtils-ee4bf39f.js";import"./pbf-e1a6c35b.js";import G_e from"./FeatureSet-0573546e.js";import"./TopFeaturesQuery-785f5453.js";import{l as NN,s as Wie}from"./locale-30120714.js";import gp from"./FeatureLayer-a9f3e6ec.js";import{s as RC,i as fB}from"./Identifiable-aa6d459d.js";import{b as LG}from"./Layer-f0696768.js";import{y as mB,p as jie}from"./colorUtils-82440b70.js";import{n as VN,o as cT,i as o2,a as gB,c as vB,e as GL,h as W_e,f as qie,M as j_e,r as yB}from"./mat2d-d0b91e3e.js";import{e as DG}from"./Queue-3a0c055d.js";import{t as q_e,I as $r,y as GA,a as Ap,F as WL,g as K_e}from"./Scheduler-8433672d.js";import{T as Y_e}from"./TimeExtent-744afd75.js";import{j as WA,b as l2,c as _B}from"./asyncUtils-62e8a185.js";import{m as bB,_ as X_e}from"./Promise-dfdee8ba.js";import{l as Z_e,i as Kie,a as BN,h as wB}from"./GraphicsLayer-10573c27.js";import{v as jA}from"./HeightModelInfo-22ad72d7.js";import{m as tR}from"./arcgisLayerUrl-0b2b7691.js";import{l as Ot,a as iE,o as kG}from"./ViewingMode-5d7d590b.js";import{t as zN,r as Q_e,I as rd}from"./enums-0fc02184.js";import{r as xB,a as CB}from"./common-c186b691.js";import{o as Yn,v as my,y as Yie,j as cr,q as GI,C as TB,l as Po,r as Bi,z as fm,g as Xie,a as Zs,s as sd,m as sf,k as SB,E as J_e,A as Hv,b as WI,H as e0e,_ as FG,d as Wp,p as Hx,L as t0e,w as NG}from"./vec2-2cef68de.js";import{r as dn,n as xt,f as Z0,t as dS,e as Zie}from"./vec2f64-30dc1443.js";import{s as i0e,r as Qie,M as UN,h as Jie,i as n0e,a as Um,o as cg,g as r0e,u as IC,f as ene,p as s0e}from"./mat3-3fc68e72.js";import{e as ny,r as a0e}from"./mat3f32-d3d088e8.js";import{t as Rv,n as o0e}from"./vec2f32-461e65a9.js";import"./TileStrategy-4189758f.js";import{d as l0e,h as c0e}from"./TileStore-787dbea4.js";import"./TileKey-0750ad58.js";import{g as Ye,r as Ge,u as rt,o as je,x as Gn,s as Et,H as Hm,P as dt,e as nt,F as uh,O as $t,z as mt,v as dd,_ as vi,A as oo,M as u0e,J as pr,G as af,p as Fo,S as Lp,Z as c2,X as tne,j as No,U as ine,c as d0e,q as gy,Y as vp,E as HN,V as VG}from"./vec3-a020a6f6.js";import{l as h0e}from"./capabilities-3636c6a4.js";import{r as La,o as p0e}from"./context-util-1e3c8cfc.js";import{r as Gt,n as q,t as Ts,b as f0e,e as gu,f as wd,l as Zv,i as m0e}from"./vec3f64-2f9cef06.js";import{u as qi,f as nne,b as rne,H as g0e,D as Eh,z as jI,s as Mp,l as vy,h as ry,E as jL,M as GN,a as u2,m as EB,p as AB,o as sne,d as v0e,K as y0e,q as _0e,c as ane,I as $0,U as WN,R as BG,y as one,w as b0e,g as zG}from"./aaBoundingRect-4a760199.js";import{s as MB,c as si,b as w0e,f as L0,n as dh,E as x0e,$ as C0e,p as Ah,z as qL,q as T0e,d as Oc,h as S0e,k as jN,Y as KL,O as PB,W as OB,r as E0e,a as RB,e as A0e,R as gf,F as M0e,g as IB,C as P0e,w as O0e,i as lne,T as cne}from"./sphere-4f5e644f.js";import{h as Da,o as $B,g as Mh,n as da,k as R0e,Q as LB,u as Vs,m as d2,f as gd,r as Q0,b as h2,l as DB,A as I0e,B as $0e,R as L0e,c as of,F as une,x as dne,s as hne,i as pne,C as D0e,v as k0e}from"./mat4-44a0988f.js";import{e as St,t as fne,o as Ks,r as iR}from"./mat4f64-1e28eae0.js";import{v as $C,A as UG,M as kB,b as D0,k as mne}from"./lineSegment-e6f72ff2.js";import{p as Dr,E as F0e,A as nE,O as p2,F as N0e,q as xb,x as V0e,U as B0e,z as FB,H as z0e,Y as ro,L as qN,a as nR,_ as Gx,b as rR,R as tr,k as U0e,T as gne,P as KN,l as J0,j as Dp,c as H0e,d as G0e,K as HG,g as LM,V as W0e}from"./plane-45609588.js";import{o as j0e,r as q0e}from"./scaleUtils-b32a50d8.js";import{s as YN,c as K0e,t as ax,i as vne,r as GG,n as WG,e as jG}from"./layerUtils-034678f6.js";import{h as Y0e,t as X0e}from"./ElevationSamplerData-7decf898.js";import{s as Rc,t as Z0e,e as Q0e}from"./Ellipsoid-89682c5e.js";import{n as Dn,e as yne,r as Xn,t as NB,_ as oh,l as ox}from"./vec4f64-e407da96.js";import{r as dl,w as Sm,a as Em,D as XN,b as qG,l as VB,s as J0e,G as _ne,j as bne,E as ebe}from"./vec4-790471c0.js";import{o as YL,d as yy,a as XL,m as tbe,b as Ds,r as ibe,s as f2,e as BB,c as zB,v as wne,f as nbe,t as rbe,x as sbe,h as xne,n as Cne}from"./PhysicallyBasedRendering.glsl-a986c926.js";import{a as eb}from"./ReadLinearDepth.glsl-7ff30f7d.js";import{e as UB,v as abe,I as HB,c as obe,i as lbe,E as Ws,r as bp,a as Nl,R as GB,n as qI,b as cbe,_ as ube,d as dbe}from"./WaterSurface.glsl-fc8a5726.js";import{e as hl,f as sn,i as Eu,u as Tne,a as Ou,r as qA}from"./Texture2DPassUniform-6e8ae673.js";import{e as pl,a as Io,v as hbe,d as KG,c as pbe,o as fbe,b as YG}from"./View.glsl-8b12b8c2.js";import{e as jp}from"./Float4PassUniform-3a47b7b3.js";import{o as Hi}from"./FloatPassUniform-d2dfc562.js";import{o as Nr,n as ee,t as Es,i as Cb,a as WB}from"./ShaderBuilder-93e8045e.js";import{O as j}from"./VertexAttribute-9c5c630d.js";import{e as _n,o as gn,W as yi,l as Na,_ as $i,t as bn,s as vf,L as ek,r as Sne,n as mbe,i as Ene,c as gbe,a as Lu,P as Ane,b as vbe,h as jB,p as KI,d as ybe,f as _be,u as Mne,M as bbe}from"./EvaluateSceneLighting.glsl-3bbc6edf.js";import{E as Mn,u as tc,A as KA,r as lf,a as ZL,d as ug,o as wbe,f as Pne,b as XG,L as xbe,c as Qr,e as One,g as LC,h as ZN,i as QN,j as YA,v as Rne,x as qB,l as Cbe,s as Ine,k as Tbe,U as Sbe,p as Ebe,m as KB,O as $ne,n as Lne,q as Abe,t as xm,V as Dne,w as Mbe,y as kne,z as Pbe,N as Obe,B as tb,C as Rbe,D as Ibe,F as ZG}from"./VisualVariablePassParameters-5807c7dc.js";import{R as vt,I as lo,E as Qi,T as m2,Y as ka,M as Wn,P as Ui,G as un,D as An,L as fn,F as kn,V as Ja,_ as hr,C as sy,B as $be,U as sR,N as v0,S as Fne,O as lx,t as rE,A as Yi,X as tk,n as kd,W as Lbe,r as QG,f as Dbe}from"./enums-64ab819c.js";import{e as Pe,t as ic}from"./ShaderTechniqueConfiguration-9f5b4555.js";import{t as kbe}from"./PiUtils.glsl-0c0898f0.js";import{e as Nne,o as ln}from"./TransparencyPassType-cd195b0e.js";import{a as Tb}from"./RgbaFloatEncoding.glsl-6036ca34.js";import{r as Un,a as Fbe,n as wr,t as JG}from"./vec3f32-c9aa289f.js";import{e as Ho}from"./mat3f64-c6305894.js";import{o as dg}from"./ScreenSpacePass-00f8c8a4.js";import{o as JN,i as QL,a as Nbe,t as eW,b as tW,d as Vne,F as aR,c as Vbe,W as Bbe,e as iW}from"./ForwardLinearDepth.glsl-36f9eb3b.js";import{x as ma,n as al,E as In,R as Bne,a as zne,u as YI,b as Ph,s as zbe,i as nW}from"./FramebufferObject-50e1b68f.js";import{s as Ube,c as Hbe,p as _y,a as Tf}from"./HUD.glsl-80cf9a21.js";import{o as Gbe,n as e5}from"./MultipassTerrainTest.glsl-e79d40de.js";import{E as at,d as Bs,u as Wbe,y as rW,j as lh,A as Ly,a as jbe,h as Une,o as qbe,b as YB,B as Hne,c as Gne,e as g2,f as Kbe,t as Sb,g as xd,l as Eb,i as JL,k as Gm,m as ib,n as Ab,_ as XB,s as XI,p as Wne,q as jne,P as qne,r as ZB,v as QB,w as JB,x as ez,S as tz,C as v2,z as Ybe,D as uT,F as Xbe,G as Zbe,Y as Qbe,H as sW,I as Jbe,J as e1e,L as t1e,K as i1e,V as n1e,M as r1e,N as s1e}from"./objectResourceUtils-ef6e3cdf.js";import{s as yf}from"./DefaultTechniqueConfiguration-e8962072.js";import{r as Kne}from"./Transform.glsl-f15542a7.js";import{o as Dh,m as a1e,A as t5,a as i5,f as o1e,e as l1e,u as aW,T as oW,d as c1e,w as u1e}from"./edgeProcessing-3ca548e1.js";import{T as Js}from"./InterleavedLayout-5e9cf734.js";import{a as xh,u as nb,l as ZI,i as QI,O as oR,n as qs,c as iz,C as vu,N as ds,t as sE,D as y2}from"./basicInterfaces-19ed850e.js";import{u as nz,m as d1e,n as h1e}from"./DefaultMaterial_COLOR_GAMMA-9831d979.js";import{e as Ti,i as lW,g as p1e,l as f1e,k as m1e,m as g1e,M as Yne,f as v1e,s as Yb,u as DM,h as y1e}from"./Util-a48361c6.js";import{E as Er,n as zl,a as Eg}from"./Texture-e79b14e7.js";import{a as _1e,q as cW,g as uW,R as b1e,v as w1e,j as x1e,V as C1e,k as T1e}from"./projection-aa2a8986.js";import{h as Re,e as Xne}from"./Matrix3PassUniform-da8eddae.js";import{H as _2,u as JI,s as Zne,l as Jn,I as S1e,L as E1e,i as e3,P as A1e,m as M1e,p as Qne,k as P1e,G as hh,U as Jr,v as O1e}from"./Octree-1a841545.js";import{S as R1e,Q as I1e,O as $1e}from"./quat-5b263584.js";import{e as n5}from"./quatf64-7fd38d64.js";import{a as Go,A as fr,p as ph,P as rz,B as sz,c as Wx,f as jx,I as Jne,N as az,y as ere,d as L1e,q as D1e,V as tre,E as oz,w as lz,D as k1e,l as F1e,M as Au,R as fh,h as N1e,g as ire,F as kM,u as r5,k as V1e}from"./aaBoundingBox-fc742a4e.js";import{x as by,T as wy,i as xy,u as nre,b as dW,l as b2,h as B1e,c as Wm,d as hW,a as rre}from"./BufferView-646ba1de.js";import{V as z1e,H as pW}from"./HUDMaterial.glsl-4bf3c7df.js";import{v as Id,J as U1e,w as H1e}from"./dehydratedFeatures-4eeb381a.js";import{createLabelFunction as G1e}from"./labelFormatUtils-4d730eaa.js";import{r as W1e,n as j1e}from"./ElevationInfo-ce9cacc2.js";import{A as Vi,a as q1e,f as sre,U as K1e,J as Y1e,F as fW,O as X1e,W as Z1e}from"./I3SUtil-3ffd3baa.js";import{u as Q1e}from"./LineCallout.glsl-a0056465.js";import{x as w2}from"./earcut-58237617.js";import{t as are,r as e$,e as ore}from"./vec33-ce3aa99b.js";import{t as J1e,e as mW,q as gW}from"./QueryEngineResult-665bf7fb.js";import{getVisualVariableValues as lre,getRotationAngle as ewe,getSize as twe}from"./visualVariableUtils-c59ab38d.js";import{l as t3,c as qx,g as iwe,a as nwe,e as ik}from"./MeshComponent-f50df6af.js";import{d as rwe,i as swe}from"./TextureOnly.glsl-18701a3b.js";import{s as cre,a as awe,p as nk,f as owe}from"./MarkerSizing.glsl-c6fa192a.js";import{A as lwe,s as cwe,r as cx,j as uwe}from"./RibbonLine.glsl-2a3b4d4e.js";import{c as dwe,f as hwe,o as pwe,i as hd,e as fwe,a as mwe,b as ux,n as ure,t as gwe}from"./MixExternalColor.glsl-25f0049c.js";import{i as vwe,s as ywe,h as _we,r as bwe}from"./MemCache-4b976a8b.js";import{u as dre}from"./LineStipple.glsl-de782d6a.js";import{i as wwe}from"./callExpressionWithFeature-a7532499.js";import{m as s5}from"./lengthUtils-d2d33f94.js";import{e as vW,o as xwe,a as Cwe}from"./sdfPrimitives-a24e9cb2.js";import{L as i3}from"./Texture-bbae5d9d.js";import{d as n3}from"./CIMSymbol-1379245a.js";import{M as Twe}from"./LineMarker.glsl-8f444621.js";import{n as Swe,o as hre,r as t$}from"./symbolColorUtils-604c5345.js";import{v as Ewe}from"./NativeLine.glsl-cdbbf172.js";import{c as Awe,t as rk}from"./symbolLayerUtils3D-1f8d4478.js";import{i as $c}from"./Normals.glsl-90e28525.js";import{_ as Mwe,p as Pwe}from"./Path.glsl-60b36878.js";import{f as Owe}from"./ColorMaterial.glsl-8310ffb3.js";import{a as Iv,T as Rwe}from"./Pattern.glsl-d3388745.js";import{r as Kx,a as Iwe,c as $we,_ as Lwe,p as Dwe,T as kwe,E as Fwe,m as Nwe,l as yW,n as _W,h as Vwe,b as Bwe,d as zwe}from"./EffectView-d3bf37ed.js";import{j as cz}from"./Portal-8b65c9c4.js";import{n as Uwe}from"./RefreshableLayer-1c078c47.js";import{n as Hwe,h as Gwe}from"./LercDecoder-73115fd2.js";import{e as bW}from"./config-1337d16e.js";import{u as pre,p as Wwe}from"./Slice.glsl-a612de15.js";import{o as a5}from"./OutputDepth.glsl-179f1d8f.js";import{a as fre,i as jwe}from"./OutputHighlight.glsl-7364b03b.js";import{r as qwe}from"./NormalUtils.glsl-a59958d7.js";import{o as o5,r as mre}from"./floatRGBA-fa8308d2.js";import{u as r3,o as gre,f as uz}from"./Texture2DDrawUniform-22924c6f.js";import{e as vre}from"./VertexColor.glsl-db21b96c.js";import{c as Kwe}from"./DefaultMaterial.glsl-b4f4cbc5.js";import{t as Ywe,o as Xwe}from"./AlphaCutoff-96178e0d.js";import{n as dz}from"./SSAO.glsl-6f3b4065.js";import{D as FM}from"./workerHelper-c6d4a8cb.js";import{t as hz}from"./VertexElementDescriptor-2925c6af.js";import{y as Zwe}from"./FeatureLayerBase-aebdf2da.js";import{c as wW}from"./Subtype-5b01b21f.js";import{t as Qwe,D as Sf}from"./datetime-4f774298.js";import{u as Jwe}from"./Field-f5fc9f6b.js";import{u as exe}from"./messages-be07754e.js";import{r as txe}from"./deprecate-b9088bd3.js";import{n as xW}from"./uuid-73213768.js";import{m as ixe}from"./diffUtils-1ac65748.js";import{a as nxe,i as rxe}from"./sizeVariableUtils-d4870b0d.js";import{S as Yx,a as sxe}from"./jsonUtils-d7db3dc7.js";import{l as pz,c as fz,x as axe,h as Xx,E as ns,g as mz,d as l5,s as yre}from"./elevationInfoUtils-427916a5.js";import{s as oxe}from"./jsonMap-c1f958cf.js";import{i as lxe}from"./BlendLayer-d8293c8d.js";import{c as cxe}from"./ExportImageParameters-f328a234.js";import{j as uxe,a as dxe}from"./UniqueValueRenderer-103ec66d.js";import{I as _re}from"./cimSymbolUtils-2e4dde89.js";import{resolveWebStyleSymbol as hxe}from"./webStyleSymbolUtils-55ed91cd.js";import{U as pxe,w as fxe}from"./enums-4b2a86a0.js";import"./nextTick-3ee5a785.js";import"./PortalItem-aa42c739.js";import"./writeUtils-067c4f82.js";import"./colorUtils-639f4d25.js";import"./SimpleObservable-7dcdef1d.js";import"./typeUtils-eb9416d0.js";import"./Connection-a681777e.js";import"./zscale-1e1fc911.js";import"./dom-5b7af1bf.js";import"./query-922e6fbf.js";import"./pbfQueryUtils-72f9b45b.js";import"./OptimizedFeature-3de538c1.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./queryZScale-d9d8ef40.js";import"./ItemCache-ee28c7ba.js";import"./Symbol-fc4312a4.js";import"./persistableUrlUtils-a16d0f55.js";import"./Symbol3DAnchorPosition2D-c0f4a14d.js";import"./DictionaryLoader-2cf5144e.js";import"./LRUCache-14115d91.js";import"./heatmapUtils-84e8c43b.js";import"./MultiOriginJSONSupport-27362d57.js";import"./LayerFloorInfo-2cd5e8ae.js";import"./editsZScale-2015e7db.js";import"./APIKeyMixin-34d76a46.js";import"./ArcGISService-ea748edf.js";import"./CustomParametersMixin-807d2055.js";import"./EditBusLayer-40671d1a.js";import"./FeatureReductionLayer-4077b2ae.js";import"./OperationalLayer-24e6fa34.js";import"./labelingInfo-5c3a46f6.js";import"./labelUtils-a194a22a.js";import"./defaultsJSON-59981e75.js";import"./OrderedLayer-e7edf19c.js";import"./PortalLayer-f1a64f99.js";import"./PortalUser-4c8e1adc.js";import"./PortalGroup-bfe93c76.js";import"./ScaleRangeLayer-271178b7.js";import"./TemporalLayer-39c07299.js";import"./TimeInfo-c89d0ef4.js";import"./FeatureTemplate-746d033e.js";import"./FeatureType-c83c5f49.js";import"./fieldProperties-7547b373.js";import"./FieldsIndex-aa6dd3fa.js";import"./versionUtils-92993d41.js";import"./styleUtils-da81b13f.js";import"./popupUtils-07fe66a7.js";import"./rbush-8e36784a.js";import"./quickselect-322ec8e1.js";import"./mat4f32-77b3d8ac.js";import"./SSAOBlur.glsl-c6f142fc.js";import"./VerticalOffset.glsl-86460edb.js";import"./devEnvironmentUtils-5002a058.js";import"./Version-9baeb7ac.js";import"./RealisticTree.glsl-2b30ed32.js";import"./VisualVariables.glsl-b8290512.js";import"./deduplicate-b0bc48cc.js";import"./types-e1c0a5bf.js";import"./ObjectAndLayerIdColor.glsl-73c19386.js";import"./quantizationUtils-33aba427.js";import"./I3SBinaryReader-3d2c2faa.js";import"./WhereClause-2b5b05b2.js";import"./utils-30a9a7e0.js";import"./generateRendererUtils-a996108f.js";import"./colorRamps-3a8ac20b.js";import"./utils-1f4fcfec.js";import"./json-48e3ea08.js";import"./DiscardOrAdjustAlphaBlend.glsl-5f837994.js";import"./parser-2b40deea.js";import"./fieldType-b1002185.js";import"./sublayerUtils-ba7f61bc.js";import"./styleUtils-4adfed9e.js";import"./utils-c81a5c52.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function gz(i,e){const t=Object.create(null),n=i.split(",");for(let r=0;r<n.length;r++)t[n[r]]=!0;return e?r=>!!t[r.toLowerCase()]:r=>!!t[r]}function pt(i){if(st(i)){const e={};for(let t=0;t<i.length;t++){const n=i[t],r=Ft(n)?yxe(n):pt(n);if(r)for(const s in r)e[s]=r[s]}return e}else{if(Ft(i))return i;if(oi(i))return i}}const mxe=/;(?![^(]*\))/g,gxe=/:([^]+)/,vxe=/\/\*.*?\*\//gs;function yxe(i){const e={};return i.replace(vxe,"").split(mxe).forEach(t=>{if(t){const n=t.split(gxe);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function N(i){let e="";if(Ft(i))e=i;else if(st(i))for(let t=0;t<i.length;t++){const n=N(i[t]);n&&(e+=n+" ")}else if(oi(i))for(const t in i)i[t]&&(e+=t+" ");return e.trim()}function mh(i){if(!i)return null;let{class:e,style:t}=i;return e&&!Ft(e)&&(i.class=N(e)),t&&(i.style=pt(t)),i}const _xe="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",bxe=gz(_xe);function bre(i){return!!i||i===""}function wxe(i,e){if(i.length!==e.length)return!1;let t=!0;for(let n=0;t&&n<i.length;n++)t=Zx(i[n],e[n]);return t}function Zx(i,e){if(i===e)return!0;let t=rb(i),n=rb(e);if(t||n)return t&&n?i.getTime()===e.getTime():!1;if(t=x2(i),n=x2(e),t||n)return i===e;if(t=st(i),n=st(e),t||n)return t&&n?wxe(i,e):!1;if(t=oi(i),n=oi(e),t||n){if(!t||!n)return!1;const r=Object.keys(i).length,s=Object.keys(e).length;if(r!==s)return!1;for(const a in i){const o=i.hasOwnProperty(a),l=e.hasOwnProperty(a);if(o&&!l||!o&&l||!Zx(i[a],e[a]))return!1}}return String(i)===String(e)}function wre(i,e){return i.findIndex(t=>Zx(t,e))}const We=i=>Ft(i)?i:i==null?"":st(i)||oi(i)&&(i.toString===Cre||!Lt(i.toString))?JSON.stringify(i,xre,2):String(i),xre=(i,e)=>e&&e.__v_isRef?xre(i,e.value):hx(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[n,r])=>(t[`${n} =>`]=r,t),{})}:a3(e)?{[`Set(${e.size})`]:[...e.values()]}:oi(e)&&!st(e)&&!Tre(e)?String(e):e,ts={},dx=[],yn=()=>{},xxe=()=>!1,Cxe=/^on[^a-z]/,s3=i=>Cxe.test(i),vz=i=>i.startsWith("onUpdate:"),co=Object.assign,yz=(i,e)=>{const t=i.indexOf(e);t>-1&&i.splice(t,1)},Txe=Object.prototype.hasOwnProperty,Ci=(i,e)=>Txe.call(i,e),st=Array.isArray,hx=i=>XA(i)==="[object Map]",a3=i=>XA(i)==="[object Set]",rb=i=>XA(i)==="[object Date]",Lt=i=>typeof i=="function",Ft=i=>typeof i=="string",x2=i=>typeof i=="symbol",oi=i=>i!==null&&typeof i=="object",C2=i=>oi(i)&&Lt(i.then)&&Lt(i.catch),Cre=Object.prototype.toString,XA=i=>Cre.call(i),lR=i=>XA(i).slice(8,-1),Tre=i=>XA(i)==="[object Object]",_z=i=>Ft(i)&&i!=="NaN"&&i[0]!=="-"&&""+parseInt(i,10)===i,cR=gz(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),o3=i=>{const e=Object.create(null);return t=>e[t]||(e[t]=i(t))},Sxe=/-(\w)/g,Sd=o3(i=>i.replace(Sxe,(e,t)=>t?t.toUpperCase():"")),Exe=/\B([A-Z])/g,Dy=o3(i=>i.replace(Exe,"-$1").toLowerCase()),ZA=o3(i=>i.charAt(0).toUpperCase()+i.slice(1)),uR=o3(i=>i?`on${ZA(i)}`:""),T2=(i,e)=>!Object.is(i,e),dR=(i,e)=>{for(let t=0;t<i.length;t++)i[t](e)},i$=(i,e,t)=>{Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value:t})},S2=i=>{const e=parseFloat(i);return isNaN(e)?i:e};let CW;const Axe=()=>CW||(CW=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let pu;class Sre{constructor(e=!1){this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=pu,!e&&pu&&(this.index=(pu.scopes||(pu.scopes=[])).push(this)-1)}run(e){if(this.active){const t=pu;try{return pu=this,e()}finally{pu=t}}}on(){pu=this}off(){pu=this.parent}stop(e){if(this.active){let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.scopes)for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this.active=!1}}}function Mxe(i){return new Sre(i)}function Pxe(i,e=pu){e&&e.active&&e.effects.push(i)}function Oxe(){return pu}function Ere(i){pu&&pu.cleanups.push(i)}const bz=i=>{const e=new Set(i);return e.w=0,e.n=0,e},Are=i=>(i.w&Cy)>0,Mre=i=>(i.n&Cy)>0,Rxe=({deps:i})=>{if(i.length)for(let e=0;e<i.length;e++)i[e].w|=Cy},Ixe=i=>{const{deps:e}=i;if(e.length){let t=0;for(let n=0;n<e.length;n++){const r=e[n];Are(r)&&!Mre(r)?r.delete(i):e[t++]=r,r.w&=~Cy,r.n&=~Cy}e.length=t}},c5=new WeakMap;let hS=0,Cy=1;const u5=30;let ch;const k0=Symbol(""),d5=Symbol("");class wz{constructor(e,t=null,n){this.fn=e,this.scheduler=t,this.active=!0,this.deps=[],this.parent=void 0,Pxe(this,n)}run(){if(!this.active)return this.fn();let e=ch,t=ay;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=ch,ch=this,ay=!0,Cy=1<<++hS,hS<=u5?Rxe(this):TW(this),this.fn()}finally{hS<=u5&&Ixe(this),Cy=1<<--hS,ch=this.parent,ay=t,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ch===this?this.deferStop=!0:this.active&&(TW(this),this.onStop&&this.onStop(),this.active=!1)}}function TW(i){const{deps:e}=i;if(e.length){for(let t=0;t<e.length;t++)e[t].delete(i);e.length=0}}let ay=!0;const Pre=[];function DC(){Pre.push(ay),ay=!1}function kC(){const i=Pre.pop();ay=i===void 0?!0:i}function Du(i,e,t){if(ay&&ch){let n=c5.get(i);n||c5.set(i,n=new Map);let r=n.get(t);r||n.set(t,r=bz()),Ore(r)}}function Ore(i,e){let t=!1;hS<=u5?Mre(i)||(i.n|=Cy,t=!Are(i)):t=!i.has(ch),t&&(i.add(ch),ch.deps.push(i))}function jm(i,e,t,n,r,s){const a=c5.get(i);if(!a)return;let o=[];if(e==="clear")o=[...a.values()];else if(t==="length"&&st(i)){const l=S2(n);a.forEach((c,u)=>{(u==="length"||u>=l)&&o.push(c)})}else switch(t!==void 0&&o.push(a.get(t)),e){case"add":st(i)?_z(t)&&o.push(a.get("length")):(o.push(a.get(k0)),hx(i)&&o.push(a.get(d5)));break;case"delete":st(i)||(o.push(a.get(k0)),hx(i)&&o.push(a.get(d5)));break;case"set":hx(i)&&o.push(a.get(k0));break}if(o.length===1)o[0]&&h5(o[0]);else{const l=[];for(const c of o)c&&l.push(...c);h5(bz(l))}}function h5(i,e){const t=st(i)?i:[...i];for(const n of t)n.computed&&SW(n);for(const n of t)n.computed||SW(n)}function SW(i,e){(i!==ch||i.allowRecurse)&&(i.scheduler?i.scheduler():i.run())}const $xe=gz("__proto__,__v_isRef,__isVue"),Rre=new Set(Object.getOwnPropertyNames(Symbol).filter(i=>i!=="arguments"&&i!=="caller").map(i=>Symbol[i]).filter(x2)),Lxe=xz(),Dxe=xz(!1,!0),kxe=xz(!0),EW=Fxe();function Fxe(){const i={};return["includes","indexOf","lastIndexOf"].forEach(e=>{i[e]=function(...t){const n=mn(this);for(let s=0,a=this.length;s<a;s++)Du(n,"get",s+"");const r=n[e](...t);return r===-1||r===!1?n[e](...t.map(mn)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{i[e]=function(...t){DC();const n=mn(this)[e].apply(this,t);return kC(),n}}),i}function xz(i=!1,e=!1){return function(n,r,s){if(r==="__v_isReactive")return!i;if(r==="__v_isReadonly")return i;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&s===(i?e?Jxe:kre:e?Dre:Lre).get(n))return n;const a=st(n);if(!i&&a&&Ci(EW,r))return Reflect.get(EW,r,s);const o=Reflect.get(n,r,s);return(x2(r)?Rre.has(r):$xe(r))||(i||Du(n,"get",r),e)?o:Vn(o)?a&&_z(r)?o:o.value:oi(o)?i?FC(o):Ji(o):o}}const Nxe=Ire(),Vxe=Ire(!0);function Ire(i=!1){return function(t,n,r,s){let a=t[n];if(Qx(a)&&Vn(a)&&!Vn(r))return!1;if(!i&&(!n$(r)&&!Qx(r)&&(a=mn(a),r=mn(r)),!st(t)&&Vn(a)&&!Vn(r)))return a.value=r,!0;const o=st(t)&&_z(n)?Number(n)<t.length:Ci(t,n),l=Reflect.set(t,n,r,s);return t===mn(s)&&(o?T2(r,a)&&jm(t,"set",n,r):jm(t,"add",n,r)),l}}function Bxe(i,e){const t=Ci(i,e);i[e];const n=Reflect.deleteProperty(i,e);return n&&t&&jm(i,"delete",e,void 0),n}function zxe(i,e){const t=Reflect.has(i,e);return(!x2(e)||!Rre.has(e))&&Du(i,"has",e),t}function Uxe(i){return Du(i,"iterate",st(i)?"length":k0),Reflect.ownKeys(i)}const $re={get:Lxe,set:Nxe,deleteProperty:Bxe,has:zxe,ownKeys:Uxe},Hxe={get:kxe,set(i,e){return!0},deleteProperty(i,e){return!0}},Gxe=co({},$re,{get:Dxe,set:Vxe}),Cz=i=>i,l3=i=>Reflect.getPrototypeOf(i);function NM(i,e,t=!1,n=!1){i=i.__v_raw;const r=mn(i),s=mn(e);t||(e!==s&&Du(r,"get",e),Du(r,"get",s));const{has:a}=l3(r),o=n?Cz:t?Ez:E2;if(a.call(r,e))return o(i.get(e));if(a.call(r,s))return o(i.get(s));i!==r&&i.get(e)}function VM(i,e=!1){const t=this.__v_raw,n=mn(t),r=mn(i);return e||(i!==r&&Du(n,"has",i),Du(n,"has",r)),i===r?t.has(i):t.has(i)||t.has(r)}function BM(i,e=!1){return i=i.__v_raw,!e&&Du(mn(i),"iterate",k0),Reflect.get(i,"size",i)}function AW(i){i=mn(i);const e=mn(this);return l3(e).has.call(e,i)||(e.add(i),jm(e,"add",i,i)),this}function MW(i,e){e=mn(e);const t=mn(this),{has:n,get:r}=l3(t);let s=n.call(t,i);s||(i=mn(i),s=n.call(t,i));const a=r.call(t,i);return t.set(i,e),s?T2(e,a)&&jm(t,"set",i,e):jm(t,"add",i,e),this}function PW(i){const e=mn(this),{has:t,get:n}=l3(e);let r=t.call(e,i);r||(i=mn(i),r=t.call(e,i)),n&&n.call(e,i);const s=e.delete(i);return r&&jm(e,"delete",i,void 0),s}function OW(){const i=mn(this),e=i.size!==0,t=i.clear();return e&&jm(i,"clear",void 0,void 0),t}function zM(i,e){return function(n,r){const s=this,a=s.__v_raw,o=mn(a),l=e?Cz:i?Ez:E2;return!i&&Du(o,"iterate",k0),a.forEach((c,u)=>n.call(r,l(c),l(u),s))}}function UM(i,e,t){return function(...n){const r=this.__v_raw,s=mn(r),a=hx(s),o=i==="entries"||i===Symbol.iterator&&a,l=i==="keys"&&a,c=r[i](...n),u=t?Cz:e?Ez:E2;return!e&&Du(s,"iterate",l?d5:k0),{next(){const{value:d,done:h}=c.next();return h?{value:d,done:h}:{value:o?[u(d[0]),u(d[1])]:u(d),done:h}},[Symbol.iterator](){return this}}}}function Ag(i){return function(...e){return i==="delete"?!1:this}}function Wxe(){const i={get(s){return NM(this,s)},get size(){return BM(this)},has:VM,add:AW,set:MW,delete:PW,clear:OW,forEach:zM(!1,!1)},e={get(s){return NM(this,s,!1,!0)},get size(){return BM(this)},has:VM,add:AW,set:MW,delete:PW,clear:OW,forEach:zM(!1,!0)},t={get(s){return NM(this,s,!0)},get size(){return BM(this,!0)},has(s){return VM.call(this,s,!0)},add:Ag("add"),set:Ag("set"),delete:Ag("delete"),clear:Ag("clear"),forEach:zM(!0,!1)},n={get(s){return NM(this,s,!0,!0)},get size(){return BM(this,!0)},has(s){return VM.call(this,s,!0)},add:Ag("add"),set:Ag("set"),delete:Ag("delete"),clear:Ag("clear"),forEach:zM(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{i[s]=UM(s,!1,!1),t[s]=UM(s,!0,!1),e[s]=UM(s,!1,!0),n[s]=UM(s,!0,!0)}),[i,t,e,n]}const[jxe,qxe,Kxe,Yxe]=Wxe();function Tz(i,e){const t=e?i?Yxe:Kxe:i?qxe:jxe;return(n,r,s)=>r==="__v_isReactive"?!i:r==="__v_isReadonly"?i:r==="__v_raw"?n:Reflect.get(Ci(t,r)&&r in n?t:n,r,s)}const Xxe={get:Tz(!1,!1)},Zxe={get:Tz(!1,!0)},Qxe={get:Tz(!0,!1)},Lre=new WeakMap,Dre=new WeakMap,kre=new WeakMap,Jxe=new WeakMap;function eCe(i){switch(i){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function tCe(i){return i.__v_skip||!Object.isExtensible(i)?0:eCe(lR(i))}function Ji(i){return Qx(i)?i:Sz(i,!1,$re,Xxe,Lre)}function Fre(i){return Sz(i,!1,Gxe,Zxe,Dre)}function FC(i){return Sz(i,!0,Hxe,Qxe,kre)}function Sz(i,e,t,n,r){if(!oi(i)||i.__v_raw&&!(e&&i.__v_isReactive))return i;const s=r.get(i);if(s)return s;const a=tCe(i);if(a===0)return i;const o=new Proxy(i,a===2?n:t);return r.set(i,o),o}function px(i){return Qx(i)?px(i.__v_raw):!!(i&&i.__v_isReactive)}function Qx(i){return!!(i&&i.__v_isReadonly)}function n$(i){return!!(i&&i.__v_isShallow)}function Nre(i){return px(i)||Qx(i)}function mn(i){const e=i&&i.__v_raw;return e?mn(e):i}function F0(i){return i$(i,"__v_skip",!0),i}const E2=i=>oi(i)?Ji(i):i,Ez=i=>oi(i)?FC(i):i;function Vre(i){ay&&ch&&(i=mn(i),Ore(i.dep||(i.dep=bz())))}function Az(i,e){i=mn(i),i.dep&&h5(i.dep)}function Vn(i){return!!(i&&i.__v_isRef===!0)}function W(i){return Bre(i,!1)}function nr(i){return Bre(i,!0)}function Bre(i,e){return Vn(i)?i:new iCe(i,e)}class iCe{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:mn(e),this._value=t?e:E2(e)}get value(){return Vre(this),this._value}set value(e){const t=this.__v_isShallow||n$(e)||Qx(e);e=t?e:mn(e),T2(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:E2(e),Az(this))}}function dT(i){Az(i)}function v(i){return Vn(i)?i.value:i}const nCe={get:(i,e,t)=>v(Reflect.get(i,e,t)),set:(i,e,t,n)=>{const r=i[e];return Vn(r)&&!Vn(t)?(r.value=t,!0):Reflect.set(i,e,t,n)}};function zre(i){return px(i)?i:new Proxy(i,nCe)}function _a(i){const e=st(i)?new Array(i.length):{};for(const t in i)e[t]=kr(i,t);return e}class rCe{constructor(e,t,n){this._object=e,this._key=t,this._defaultValue=n,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function kr(i,e,t){const n=i[e];return Vn(n)?n:new rCe(i,e,t)}var Ure;class sCe{constructor(e,t,n,r){this._setter=t,this.dep=void 0,this.__v_isRef=!0,this[Ure]=!1,this._dirty=!0,this.effect=new wz(e,()=>{this._dirty||(this._dirty=!0,Az(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=n}get value(){const e=mn(this);return Vre(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}Ure="__v_isReadonly";function Hre(i,e,t=!1){let n,r;const s=Lt(i);return s?(n=i,r=yn):(n=i.get,r=i.set),new sCe(n,r,s||!r,t)}function aCe(i,...e){}function oy(i,e,t,n){let r;try{r=n?i(...n):i()}catch(s){c3(s,e,t)}return r}function Cd(i,e,t,n){if(Lt(i)){const s=oy(i,e,t,n);return s&&C2(s)&&s.catch(a=>{c3(a,e,t)}),s}const r=[];for(let s=0;s<i.length;s++)r.push(Cd(i[s],e,t,n));return r}function c3(i,e,t,n=!0){const r=e?e.vnode:null;if(e){let s=e.parent;const a=e.proxy,o=t;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](i,a,o)===!1)return}s=s.parent}const l=e.appContext.config.errorHandler;if(l){oy(l,null,10,[i,a,o]);return}}oCe(i,t,r,n)}function oCe(i,e,t,n=!0){console.error(i)}let A2=!1,p5=!1;const sl=[];let Pp=0;const fx=[];let om=null,e0=0;const Gre=Promise.resolve();let Mz=null;function ut(i){const e=Mz||Gre;return i?e.then(this?i.bind(this):i):e}function lCe(i){let e=Pp+1,t=sl.length;for(;e<t;){const n=e+t>>>1;M2(sl[n])<i?e=n+1:t=n}return e}function Pz(i){(!sl.length||!sl.includes(i,A2&&i.allowRecurse?Pp+1:Pp))&&(i.id==null?sl.push(i):sl.splice(lCe(i.id),0,i),Wre())}function Wre(){!A2&&!p5&&(p5=!0,Mz=Gre.then(qre))}function cCe(i){const e=sl.indexOf(i);e>Pp&&sl.splice(e,1)}function uCe(i){st(i)?fx.push(...i):(!om||!om.includes(i,i.allowRecurse?e0+1:e0))&&fx.push(i),Wre()}function RW(i,e=A2?Pp+1:0){for(;e<sl.length;e++){const t=sl[e];t&&t.pre&&(sl.splice(e,1),e--,t())}}function jre(i){if(fx.length){const e=[...new Set(fx)];if(fx.length=0,om){om.push(...e);return}for(om=e,om.sort((t,n)=>M2(t)-M2(n)),e0=0;e0<om.length;e0++)om[e0]();om=null,e0=0}}const M2=i=>i.id==null?1/0:i.id,dCe=(i,e)=>{const t=M2(i)-M2(e);if(t===0){if(i.pre&&!e.pre)return-1;if(e.pre&&!i.pre)return 1}return t};function qre(i){p5=!1,A2=!0,sl.sort(dCe);const e=yn;try{for(Pp=0;Pp<sl.length;Pp++){const t=sl[Pp];t&&t.active!==!1&&oy(t,null,14)}}finally{Pp=0,sl.length=0,jre(),A2=!1,Mz=null,(sl.length||fx.length)&&qre()}}function hCe(i,e,...t){if(i.isUnmounted)return;const n=i.vnode.props||ts;let r=t;const s=e.startsWith("update:"),a=s&&e.slice(7);if(a&&a in n){const u=`${a==="modelValue"?"model":a}Modifiers`,{number:d,trim:h}=n[u]||ts;h&&(r=t.map(p=>Ft(p)?p.trim():p)),d&&(r=t.map(S2))}let o,l=n[o=uR(e)]||n[o=uR(Sd(e))];!l&&s&&(l=n[o=uR(Dy(e))]),l&&Cd(l,i,6,r);const c=n[o+"Once"];if(c){if(!i.emitted)i.emitted={};else if(i.emitted[o])return;i.emitted[o]=!0,Cd(c,i,6,r)}}function Kre(i,e,t=!1){const n=e.emitsCache,r=n.get(i);if(r!==void 0)return r;const s=i.emits;let a={},o=!1;if(!Lt(i)){const l=c=>{const u=Kre(c,e,!0);u&&(o=!0,co(a,u))};!t&&e.mixins.length&&e.mixins.forEach(l),i.extends&&l(i.extends),i.mixins&&i.mixins.forEach(l)}return!s&&!o?(oi(i)&&n.set(i,null),null):(st(s)?s.forEach(l=>a[l]=null):co(a,s),oi(i)&&n.set(i,a),a)}function u3(i,e){return!i||!s3(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ci(i,e[0].toLowerCase()+e.slice(1))||Ci(i,Dy(e))||Ci(i,e))}let $o=null,d3=null;function r$(i){const e=$o;return $o=i,d3=i&&i.type.__scopeId||null,e}function pCe(i){d3=i}function fCe(){d3=null}function pe(i,e=$o,t){if(!e||i._n)return i;const n=(...r)=>{n._d&&UW(-1);const s=r$(e);let a;try{a=i(...r)}finally{r$(s),n._d&&UW(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function sk(i){const{type:e,vnode:t,proxy:n,withProxy:r,props:s,propsOptions:[a],slots:o,attrs:l,emit:c,render:u,renderCache:d,data:h,setupState:p,ctx:m,inheritAttrs:g}=i;let _,b;const x=r$(i);try{if(t.shapeFlag&4){const C=r||n;_=Tp(u.call(C,C,d,s,p,h,m)),b=l}else{const C=e;_=Tp(C.length>1?C(s,{attrs:l,slots:o,emit:c}):C(s,null)),b=e.props?l:mCe(l)}}catch(C){uE.length=0,c3(C,i,1),_=re(Gl)}let w=_;if(b&&g!==!1){const C=Object.keys(b),{shapeFlag:S}=w;C.length&&S&7&&(a&&C.some(vz)&&(b=gCe(b,a)),w=Km(w,b))}return t.dirs&&(w=Km(w),w.dirs=w.dirs?w.dirs.concat(t.dirs):t.dirs),t.transition&&(w.transition=t.transition),_=w,r$(x),_}const mCe=i=>{let e;for(const t in i)(t==="class"||t==="style"||s3(t))&&((e||(e={}))[t]=i[t]);return e},gCe=(i,e)=>{const t={};for(const n in i)(!vz(n)||!(n.slice(9)in e))&&(t[n]=i[n]);return t};function vCe(i,e,t){const{props:n,children:r,component:s}=i,{props:a,children:o,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return n?IW(n,a,c):!!a;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const h=u[d];if(a[h]!==n[h]&&!u3(c,h))return!0}}}else return(r||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?IW(n,a,c):!0:!!a;return!1}function IW(i,e,t){const n=Object.keys(e);if(n.length!==Object.keys(i).length)return!0;for(let r=0;r<n.length;r++){const s=n[r];if(e[s]!==i[s]&&!u3(t,s))return!0}return!1}function yCe({vnode:i,parent:e},t){for(;e&&e.subTree===i;)(i=e.vnode).el=t,e=e.parent}const _Ce=i=>i.__isSuspense;function bCe(i,e){e&&e.pendingBranch?st(i)?e.effects.push(...i):e.effects.push(i):uCe(i)}function pi(i,e){if(Za){let t=Za.provides;const n=Za.parent&&Za.parent.provides;n===t&&(t=Za.provides=Object.create(n)),t[i]=e}}function ht(i,e,t=!1){const n=Za||$o;if(n){const r=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(r&&i in r)return r[i];if(arguments.length>1)return t&&Lt(e)?e.call(n.proxy):e}}function Ru(i,e){return h3(i,null,e)}function wCe(i,e){return h3(i,null,{flush:"post"})}const HM={};function Ve(i,e,t){return h3(i,e,t)}function h3(i,e,{immediate:t,deep:n,flush:r,onTrack:s,onTrigger:a}=ts){const o=Za;let l,c=!1,u=!1;if(Vn(i)?(l=()=>i.value,c=n$(i)):px(i)?(l=()=>i,n=!0):st(i)?(u=!0,c=i.some(w=>px(w)||n$(w)),l=()=>i.map(w=>{if(Vn(w))return w.value;if(px(w))return y0(w);if(Lt(w))return oy(w,o,2)})):Lt(i)?e?l=()=>oy(i,o,2):l=()=>{if(!(o&&o.isUnmounted))return d&&d(),Cd(i,o,3,[h])}:l=yn,e&&n){const w=l;l=()=>y0(w())}let d,h=w=>{d=b.onStop=()=>{oy(w,o,4)}},p;if($2)if(h=yn,e?t&&Cd(e,o,3,[l(),u?[]:void 0,h]):l(),r==="sync"){const w=cTe();p=w.__watcherHandles||(w.__watcherHandles=[])}else return yn;let m=u?new Array(i.length).fill(HM):HM;const g=()=>{if(b.active)if(e){const w=b.run();(n||c||(u?w.some((C,S)=>T2(C,m[S])):T2(w,m)))&&(d&&d(),Cd(e,o,3,[w,m===HM?void 0:u&&m[0]===HM?[]:m,h]),m=w)}else b.run()};g.allowRecurse=!!e;let _;r==="sync"?_=g:r==="post"?_=()=>xc(g,o&&o.suspense):(g.pre=!0,o&&(g.id=o.uid),_=()=>Pz(g));const b=new wz(l,_);e?t?g():m=b.run():r==="post"?xc(b.run.bind(b),o&&o.suspense):b.run();const x=()=>{b.stop(),o&&o.scope&&yz(o.scope.effects,b)};return p&&p.push(x),x}function xCe(i,e,t){const n=this.proxy,r=Ft(i)?i.includes(".")?Yre(n,i):()=>n[i]:i.bind(n,n);let s;Lt(e)?s=e:(s=e.handler,t=e);const a=Za;Jx(this);const o=h3(r,s.bind(n),t);return a?Jx(a):N0(),o}function Yre(i,e){const t=e.split(".");return()=>{let n=i;for(let r=0;r<t.length&&n;r++)n=n[t[r]];return n}}function y0(i,e){if(!oi(i)||i.__v_skip||(e=e||new Set,e.has(i)))return i;if(e.add(i),Vn(i))y0(i.value,e);else if(st(i))for(let t=0;t<i.length;t++)y0(i[t],e);else if(a3(i)||hx(i))i.forEach(t=>{y0(t,e)});else if(Tre(i))for(const t in i)y0(i[t],e);return i}function Xre(){const i={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return qt(()=>{i.isMounted=!0}),Vr(()=>{i.isUnmounting=!0}),i}const Nu=[Function,Array],CCe={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Nu,onEnter:Nu,onAfterEnter:Nu,onEnterCancelled:Nu,onBeforeLeave:Nu,onLeave:Nu,onAfterLeave:Nu,onLeaveCancelled:Nu,onBeforeAppear:Nu,onAppear:Nu,onAfterAppear:Nu,onAppearCancelled:Nu},setup(i,{slots:e}){const t=ti(),n=Xre();let r;return()=>{const s=e.default&&Oz(e.default(),!0);if(!s||!s.length)return;let a=s[0];if(s.length>1){for(const g of s)if(g.type!==Gl){a=g;break}}const o=mn(i),{mode:l}=o;if(n.isLeaving)return ak(a);const c=$W(a);if(!c)return ak(a);const u=P2(c,o,n,t);O2(c,u);const d=t.subTree,h=d&&$W(d);let p=!1;const{getTransitionKey:m}=c.type;if(m){const g=m();r===void 0?r=g:g!==r&&(r=g,p=!0)}if(h&&h.type!==Gl&&(!t0(c,h)||p)){const g=P2(h,o,n,t);if(O2(h,g),l==="out-in")return n.isLeaving=!0,g.afterLeave=()=>{n.isLeaving=!1,t.update.active!==!1&&t.update()},ak(a);l==="in-out"&&c.type!==Gl&&(g.delayLeave=(_,b,x)=>{const w=Qre(n,h);w[String(h.key)]=h,_._leaveCb=()=>{b(),_._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=x})}return a}}},Zre=CCe;function Qre(i,e){const{leavingVNodes:t}=i;let n=t.get(e.type);return n||(n=Object.create(null),t.set(e.type,n)),n}function P2(i,e,t,n){const{appear:r,mode:s,persisted:a=!1,onBeforeEnter:o,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:d,onLeave:h,onAfterLeave:p,onLeaveCancelled:m,onBeforeAppear:g,onAppear:_,onAfterAppear:b,onAppearCancelled:x}=e,w=String(i.key),C=Qre(t,i),S=(P,O)=>{P&&Cd(P,n,9,O)},E=(P,O)=>{const M=O[1];S(P,O),st(P)?P.every(V=>V.length<=1)&&M():P.length<=1&&M()},A={mode:s,persisted:a,beforeEnter(P){let O=o;if(!t.isMounted)if(r)O=g||o;else return;P._leaveCb&&P._leaveCb(!0);const M=C[w];M&&t0(i,M)&&M.el._leaveCb&&M.el._leaveCb(),S(O,[P])},enter(P){let O=l,M=c,V=u;if(!t.isMounted)if(r)O=_||l,M=b||c,V=x||u;else return;let L=!1;const U=P._enterCb=G=>{L||(L=!0,G?S(V,[P]):S(M,[P]),A.delayedLeave&&A.delayedLeave(),P._enterCb=void 0)};O?E(O,[P,U]):U()},leave(P,O){const M=String(i.key);if(P._enterCb&&P._enterCb(!0),t.isUnmounting)return O();S(d,[P]);let V=!1;const L=P._leaveCb=U=>{V||(V=!0,O(),U?S(m,[P]):S(p,[P]),P._leaveCb=void 0,C[M]===i&&delete C[M])};C[M]=i,h?E(h,[P,L]):L()},clone(P){return P2(P,e,t,n)}};return A}function ak(i){if(p3(i))return i=Km(i),i.children=null,i}function $W(i){return p3(i)?i.children?i.children[0]:void 0:i}function O2(i,e){i.shapeFlag&6&&i.component?O2(i.component.subTree,e):i.shapeFlag&128?(i.ssContent.transition=e.clone(i.ssContent),i.ssFallback.transition=e.clone(i.ssFallback)):i.transition=e}function Oz(i,e=!1,t){let n=[],r=0;for(let s=0;s<i.length;s++){let a=i[s];const o=t==null?a.key:String(t)+String(a.key!=null?a.key:s);a.type===gt?(a.patchFlag&128&&r++,n=n.concat(Oz(a.children,e,o))):(e||a.type!==Gl)&&n.push(o!=null?Km(a,{key:o}):a)}if(r>1)for(let s=0;s<n.length;s++)n[s].patchFlag=-2;return n}function de(i){return Lt(i)?{setup:i,name:i.name}:i}const aE=i=>!!i.type.__asyncLoader,p3=i=>i.type.__isKeepAlive;function TCe(i,e){ese(i,"a",e)}function Jre(i,e){ese(i,"da",e)}function ese(i,e,t=Za){const n=i.__wdc||(i.__wdc=()=>{let r=t;for(;r;){if(r.isDeactivated)return;r=r.parent}return i()});if(f3(e,n,t),t){let r=t.parent;for(;r&&r.parent;)p3(r.parent.vnode)&&SCe(n,e,t,r),r=r.parent}}function SCe(i,e,t,n){const r=f3(e,i,n,!0);ky(()=>{yz(n[e],r)},t)}function f3(i,e,t=Za,n=!1){if(t){const r=t[i]||(t[i]=[]),s=e.__weh||(e.__weh=(...a)=>{if(t.isUnmounted)return;DC(),Jx(t);const o=Cd(e,t,i,a);return N0(),kC(),o});return n?r.unshift(s):r.push(s),s}}const hg=i=>(e,t=Za)=>(!$2||i==="sp")&&f3(i,(...n)=>e(...n),t),m3=hg("bm"),qt=hg("m"),tse=hg("bu"),pg=hg("u"),Vr=hg("bum"),ky=hg("um"),ECe=hg("sp"),ACe=hg("rtg"),MCe=hg("rtc");function PCe(i,e=Za){f3("ec",i,e)}function zt(i,e){const t=$o;if(t===null)return i;const n=y3(t)||t.proxy,r=i.dirs||(i.dirs=[]);for(let s=0;s<e.length;s++){let[a,o,l,c=ts]=e[s];a&&(Lt(a)&&(a={mounted:a,updated:a}),a.deep&&y0(o),r.push({dir:a,instance:n,value:o,oldValue:void 0,arg:l,modifiers:c}))}return i}function qy(i,e,t,n){const r=i.dirs,s=e&&e.dirs;for(let a=0;a<r.length;a++){const o=r[a];s&&(o.oldValue=s[a].value);let l=o.dir[n];l&&(DC(),Cd(l,t,8,[i.el,o,i,e]),kC())}}const Rz="components",OCe="directives";function jt(i,e){return Iz(Rz,i,!0,e)||i}const ise=Symbol();function hi(i){return Ft(i)?Iz(Rz,i,!1)||i:i||ise}function R2(i){return Iz(OCe,i)}function Iz(i,e,t=!0,n=!1){const r=$o||Za;if(r){const s=r.type;if(i===Rz){const o=aTe(s,!1);if(o&&(o===e||o===Sd(e)||o===ZA(Sd(e))))return s}const a=LW(r[i]||s[i],e)||LW(r.appContext[i],e);return!a&&n?s:a}}function LW(i,e){return i&&(i[e]||i[Sd(e)]||i[ZA(Sd(e))])}function xi(i,e,t,n){let r;const s=t&&t[n];if(st(i)||Ft(i)){r=new Array(i.length);for(let a=0,o=i.length;a<o;a++)r[a]=e(i[a],a,void 0,s&&s[a])}else if(typeof i=="number"){r=new Array(i);for(let a=0;a<i;a++)r[a]=e(a+1,a,void 0,s&&s[a])}else if(oi(i))if(i[Symbol.iterator])r=Array.from(i,(a,o)=>e(a,o,void 0,s&&s[o]));else{const a=Object.keys(i);r=new Array(a.length);for(let o=0,l=a.length;o<l;o++){const c=a[o];r[o]=e(i[c],c,o,s&&s[o])}}else r=[];return t&&(t[n]=r),r}function qm(i,e){for(let t=0;t<e.length;t++){const n=e[t];if(st(n))for(let r=0;r<n.length;r++)i[n[r].name]=n[r].fn;else n&&(i[n.name]=n.key?(...r)=>{const s=n.fn(...r);return s&&(s.key=n.key),s}:n.fn)}return i}function Fe(i,e,t={},n,r){if($o.isCE||$o.parent&&aE($o.parent)&&$o.parent.isCE)return e!=="default"&&(t.name=e),re("slot",t,n&&n());let s=i[e];s&&s._c&&(s._d=!1),I();const a=s&&nse(s(t)),o=Se(gt,{key:t.key||a&&a.key||`_${e}`},a||(n?n():[]),a&&i._===1?64:-2);return!r&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),s&&s._c&&(s._d=!0),o}function nse(i){return i.some(e=>Pr(e)?!(e.type===Gl||e.type===gt&&!nse(e.children)):!0)?i:null}function RCe(i,e){const t={};for(const n in i)t[e&&/[A-Z]/.test(n)?`on:${n}`:uR(n)]=i[n];return t}const f5=i=>i?fse(i)?y3(i)||i.proxy:f5(i.parent):null,oE=co(Object.create(null),{$:i=>i,$el:i=>i.vnode.el,$data:i=>i.data,$props:i=>i.props,$attrs:i=>i.attrs,$slots:i=>i.slots,$refs:i=>i.refs,$parent:i=>f5(i.parent),$root:i=>f5(i.root),$emit:i=>i.emit,$options:i=>$z(i),$forceUpdate:i=>i.f||(i.f=()=>Pz(i.update)),$nextTick:i=>i.n||(i.n=ut.bind(i.proxy)),$watch:i=>xCe.bind(i)}),ok=(i,e)=>i!==ts&&!i.__isScriptSetup&&Ci(i,e),ICe={get({_:i},e){const{ctx:t,setupState:n,data:r,props:s,accessCache:a,type:o,appContext:l}=i;let c;if(e[0]!=="$"){const p=a[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return r[e];case 4:return t[e];case 3:return s[e]}else{if(ok(n,e))return a[e]=1,n[e];if(r!==ts&&Ci(r,e))return a[e]=2,r[e];if((c=i.propsOptions[0])&&Ci(c,e))return a[e]=3,s[e];if(t!==ts&&Ci(t,e))return a[e]=4,t[e];m5&&(a[e]=0)}}const u=oE[e];let d,h;if(u)return e==="$attrs"&&Du(i,"get",e),u(i);if((d=o.__cssModules)&&(d=d[e]))return d;if(t!==ts&&Ci(t,e))return a[e]=4,t[e];if(h=l.config.globalProperties,Ci(h,e))return h[e]},set({_:i},e,t){const{data:n,setupState:r,ctx:s}=i;return ok(r,e)?(r[e]=t,!0):n!==ts&&Ci(n,e)?(n[e]=t,!0):Ci(i.props,e)||e[0]==="$"&&e.slice(1)in i?!1:(s[e]=t,!0)},has({_:{data:i,setupState:e,accessCache:t,ctx:n,appContext:r,propsOptions:s}},a){let o;return!!t[a]||i!==ts&&Ci(i,a)||ok(e,a)||(o=s[0])&&Ci(o,a)||Ci(n,a)||Ci(oE,a)||Ci(r.config.globalProperties,a)},defineProperty(i,e,t){return t.get!=null?i._.accessCache[e]=0:Ci(t,"value")&&this.set(i,e,t.value,null),Reflect.defineProperty(i,e,t)}};let m5=!0;function $Ce(i){const e=$z(i),t=i.proxy,n=i.ctx;m5=!1,e.beforeCreate&&DW(e.beforeCreate,i,"bc");const{data:r,computed:s,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:d,mounted:h,beforeUpdate:p,updated:m,activated:g,deactivated:_,beforeDestroy:b,beforeUnmount:x,destroyed:w,unmounted:C,render:S,renderTracked:E,renderTriggered:A,errorCaptured:P,serverPrefetch:O,expose:M,inheritAttrs:V,components:L,directives:U,filters:G}=e;if(c&&LCe(c,n,null,i.appContext.config.unwrapInjectedRef),a)for(const D in a){const $=a[D];Lt($)&&(n[D]=$.bind(t))}if(r){const D=r.call(t,t);oi(D)&&(i.data=Ji(D))}if(m5=!0,s)for(const D in s){const $=s[D],F=Lt($)?$.bind(t,t):Lt($.get)?$.get.bind(t,t):yn,Y=!Lt($)&&Lt($.set)?$.set.bind(t):yn,ne=R({get:F,set:Y});Object.defineProperty(n,D,{enumerable:!0,configurable:!0,get:()=>ne.value,set:X=>ne.value=X})}if(o)for(const D in o)rse(o[D],n,t,D);if(l){const D=Lt(l)?l.call(t):l;Reflect.ownKeys(D).forEach($=>{pi($,D[$])})}u&&DW(u,i,"c");function k(D,$){st($)?$.forEach(F=>D(F.bind(t))):$&&D($.bind(t))}if(k(m3,d),k(qt,h),k(tse,p),k(pg,m),k(TCe,g),k(Jre,_),k(PCe,P),k(MCe,E),k(ACe,A),k(Vr,x),k(ky,C),k(ECe,O),st(M))if(M.length){const D=i.exposed||(i.exposed={});M.forEach($=>{Object.defineProperty(D,$,{get:()=>t[$],set:F=>t[$]=F})})}else i.exposed||(i.exposed={});S&&i.render===yn&&(i.render=S),V!=null&&(i.inheritAttrs=V),L&&(i.components=L),U&&(i.directives=U)}function LCe(i,e,t=yn,n=!1){st(i)&&(i=g5(i));for(const r in i){const s=i[r];let a;oi(s)?"default"in s?a=ht(s.from||r,s.default,!0):a=ht(s.from||r):a=ht(s),Vn(a)&&n?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):e[r]=a}}function DW(i,e,t){Cd(st(i)?i.map(n=>n.bind(e.proxy)):i.bind(e.proxy),e,t)}function rse(i,e,t,n){const r=n.includes(".")?Yre(t,n):()=>t[n];if(Ft(i)){const s=e[i];Lt(s)&&Ve(r,s)}else if(Lt(i))Ve(r,i.bind(t));else if(oi(i))if(st(i))i.forEach(s=>rse(s,e,t,n));else{const s=Lt(i.handler)?i.handler.bind(t):e[i.handler];Lt(s)&&Ve(r,s,i)}}function $z(i){const e=i.type,{mixins:t,extends:n}=e,{mixins:r,optionsCache:s,config:{optionMergeStrategies:a}}=i.appContext,o=s.get(e);let l;return o?l=o:!r.length&&!t&&!n?l=e:(l={},r.length&&r.forEach(c=>s$(l,c,a,!0)),s$(l,e,a)),oi(e)&&s.set(e,l),l}function s$(i,e,t,n=!1){const{mixins:r,extends:s}=e;s&&s$(i,s,t,!0),r&&r.forEach(a=>s$(i,a,t,!0));for(const a in e)if(!(n&&a==="expose")){const o=DCe[a]||t&&t[a];i[a]=o?o(i[a],e[a]):e[a]}return i}const DCe={data:kW,props:E_,emits:E_,methods:E_,computed:E_,beforeCreate:Sl,created:Sl,beforeMount:Sl,mounted:Sl,beforeUpdate:Sl,updated:Sl,beforeDestroy:Sl,beforeUnmount:Sl,destroyed:Sl,unmounted:Sl,activated:Sl,deactivated:Sl,errorCaptured:Sl,serverPrefetch:Sl,components:E_,directives:E_,watch:FCe,provide:kW,inject:kCe};function kW(i,e){return e?i?function(){return co(Lt(i)?i.call(this,this):i,Lt(e)?e.call(this,this):e)}:e:i}function kCe(i,e){return E_(g5(i),g5(e))}function g5(i){if(st(i)){const e={};for(let t=0;t<i.length;t++)e[i[t]]=i[t];return e}return i}function Sl(i,e){return i?[...new Set([].concat(i,e))]:e}function E_(i,e){return i?co(co(Object.create(null),i),e):e}function FCe(i,e){if(!i)return e;if(!e)return i;const t=co(Object.create(null),i);for(const n in e)t[n]=Sl(i[n],e[n]);return t}function NCe(i,e,t,n=!1){const r={},s={};i$(s,g3,1),i.propsDefaults=Object.create(null),sse(i,e,r,s);for(const a in i.propsOptions[0])a in r||(r[a]=void 0);t?i.props=n?r:Fre(r):i.type.props?i.props=r:i.props=s,i.attrs=s}function VCe(i,e,t,n){const{props:r,attrs:s,vnode:{patchFlag:a}}=i,o=mn(r),[l]=i.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=i.vnode.dynamicProps;for(let d=0;d<u.length;d++){let h=u[d];if(u3(i.emitsOptions,h))continue;const p=e[h];if(l)if(Ci(s,h))p!==s[h]&&(s[h]=p,c=!0);else{const m=Sd(h);r[m]=v5(l,o,m,p,i,!1)}else p!==s[h]&&(s[h]=p,c=!0)}}}else{sse(i,e,r,s)&&(c=!0);let u;for(const d in o)(!e||!Ci(e,d)&&((u=Dy(d))===d||!Ci(e,u)))&&(l?t&&(t[d]!==void 0||t[u]!==void 0)&&(r[d]=v5(l,o,d,void 0,i,!0)):delete r[d]);if(s!==o)for(const d in s)(!e||!Ci(e,d))&&(delete s[d],c=!0)}c&&jm(i,"set","$attrs")}function sse(i,e,t,n){const[r,s]=i.propsOptions;let a=!1,o;if(e)for(let l in e){if(cR(l))continue;const c=e[l];let u;r&&Ci(r,u=Sd(l))?!s||!s.includes(u)?t[u]=c:(o||(o={}))[u]=c:u3(i.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(s){const l=mn(t),c=o||ts;for(let u=0;u<s.length;u++){const d=s[u];t[d]=v5(r,l,d,c[d],i,!Ci(c,d))}}return a}function v5(i,e,t,n,r,s){const a=i[t];if(a!=null){const o=Ci(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&Lt(l)){const{propsDefaults:c}=r;t in c?n=c[t]:(Jx(r),n=c[t]=l.call(null,e),N0())}else n=l}a[0]&&(s&&!o?n=!1:a[1]&&(n===""||n===Dy(t))&&(n=!0))}return n}function ase(i,e,t=!1){const n=e.propsCache,r=n.get(i);if(r)return r;const s=i.props,a={},o=[];let l=!1;if(!Lt(i)){const u=d=>{l=!0;const[h,p]=ase(d,e,!0);co(a,h),p&&o.push(...p)};!t&&e.mixins.length&&e.mixins.forEach(u),i.extends&&u(i.extends),i.mixins&&i.mixins.forEach(u)}if(!s&&!l)return oi(i)&&n.set(i,dx),dx;if(st(s))for(let u=0;u<s.length;u++){const d=Sd(s[u]);FW(d)&&(a[d]=ts)}else if(s)for(const u in s){const d=Sd(u);if(FW(d)){const h=s[u],p=a[d]=st(h)||Lt(h)?{type:h}:Object.assign({},h);if(p){const m=BW(Boolean,p.type),g=BW(String,p.type);p[0]=m>-1,p[1]=g<0||m<g,(m>-1||Ci(p,"default"))&&o.push(d)}}}const c=[a,o];return oi(i)&&n.set(i,c),c}function FW(i){return i[0]!=="$"}function NW(i){const e=i&&i.toString().match(/^\s*function (\w+)/);return e?e[1]:i===null?"null":""}function VW(i,e){return NW(i)===NW(e)}function BW(i,e){return st(e)?e.findIndex(t=>VW(t,i)):Lt(e)&&VW(e,i)?0:-1}const ose=i=>i[0]==="_"||i==="$stable",Lz=i=>st(i)?i.map(Tp):[Tp(i)],BCe=(i,e,t)=>{if(e._n)return e;const n=pe((...r)=>Lz(e(...r)),t);return n._c=!1,n},lse=(i,e,t)=>{const n=i._ctx;for(const r in i){if(ose(r))continue;const s=i[r];if(Lt(s))e[r]=BCe(r,s,n);else if(s!=null){const a=Lz(s);e[r]=()=>a}}},cse=(i,e)=>{const t=Lz(e);i.slots.default=()=>t},zCe=(i,e)=>{if(i.vnode.shapeFlag&32){const t=e._;t?(i.slots=mn(e),i$(e,"_",t)):lse(e,i.slots={})}else i.slots={},e&&cse(i,e);i$(i.slots,g3,1)},UCe=(i,e,t)=>{const{vnode:n,slots:r}=i;let s=!0,a=ts;if(n.shapeFlag&32){const o=e._;o?t&&o===1?s=!1:(co(r,e),!t&&o===1&&delete r._):(s=!e.$stable,lse(e,r)),a=e}else e&&(cse(i,e),a={default:1});if(s)for(const o in r)!ose(o)&&!(o in a)&&delete r[o]};function use(){return{app:null,config:{isNativeTag:xxe,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let HCe=0;function GCe(i,e){return function(n,r=null){Lt(n)||(n=Object.assign({},n)),r!=null&&!oi(r)&&(r=null);const s=use(),a=new Set;let o=!1;const l=s.app={_uid:HCe++,_component:n,_props:r,_container:null,_context:s,_instance:null,version:uTe,get config(){return s.config},set config(c){},use(c,...u){return a.has(c)||(c&&Lt(c.install)?(a.add(c),c.install(l,...u)):Lt(c)&&(a.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,d){if(!o){const h=re(n,r);return h.appContext=s,u&&e?e(h,c):i(h,c,d),o=!0,l._container=c,c.__vue_app__=l,y3(h.component)||h.component.proxy}},unmount(){o&&(i(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l}};return l}}function y5(i,e,t,n,r=!1){if(st(i)){i.forEach((h,p)=>y5(h,e&&(st(e)?e[p]:e),t,n,r));return}if(aE(n)&&!r)return;const s=n.shapeFlag&4?y3(n.component)||n.component.proxy:n.el,a=r?null:s,{i:o,r:l}=i,c=e&&e.r,u=o.refs===ts?o.refs={}:o.refs,d=o.setupState;if(c!=null&&c!==l&&(Ft(c)?(u[c]=null,Ci(d,c)&&(d[c]=null)):Vn(c)&&(c.value=null)),Lt(l))oy(l,o,12,[a,u]);else{const h=Ft(l),p=Vn(l);if(h||p){const m=()=>{if(i.f){const g=h?Ci(d,l)?d[l]:u[l]:l.value;r?st(g)&&yz(g,s):st(g)?g.includes(s)||g.push(s):h?(u[l]=[s],Ci(d,l)&&(d[l]=u[l])):(l.value=[s],i.k&&(u[i.k]=l.value))}else h?(u[l]=a,Ci(d,l)&&(d[l]=a)):p&&(l.value=a,i.k&&(u[i.k]=a))};a?(m.id=-1,xc(m,t)):m()}}}const xc=bCe;function WCe(i){return jCe(i)}function jCe(i,e){const t=Axe();t.__VUE__=!0;const{insert:n,remove:r,patchProp:s,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:h,setScopeId:p=yn,insertStaticContent:m}=i,g=(ie,oe,we,Ae=null,Oe=null,ve=null,ke=!1,be=null,$e=!!oe.dynamicChildren)=>{if(ie===oe)return;ie&&!t0(ie,oe)&&(Ae=ce(ie),X(ie,Oe,ve,!0),ie=null),oe.patchFlag===-2&&($e=!1,oe.dynamicChildren=null);const{type:Le,ref:Ce,shapeFlag:Be}=oe;switch(Le){case NC:_(ie,oe,we,Ae);break;case Gl:b(ie,oe,we,Ae);break;case cE:ie==null&&x(oe,we,Ae,ke);break;case gt:L(ie,oe,we,Ae,Oe,ve,ke,be,$e);break;default:Be&1?S(ie,oe,we,Ae,Oe,ve,ke,be,$e):Be&6?U(ie,oe,we,Ae,Oe,ve,ke,be,$e):(Be&64||Be&128)&&Le.process(ie,oe,we,Ae,Oe,ve,ke,be,$e,le)}Ce!=null&&Oe&&y5(Ce,ie&&ie.ref,ve,oe||ie,!oe)},_=(ie,oe,we,Ae)=>{if(ie==null)n(oe.el=o(oe.children),we,Ae);else{const Oe=oe.el=ie.el;oe.children!==ie.children&&c(Oe,oe.children)}},b=(ie,oe,we,Ae)=>{ie==null?n(oe.el=l(oe.children||""),we,Ae):oe.el=ie.el},x=(ie,oe,we,Ae)=>{[ie.el,ie.anchor]=m(ie.children,oe,we,Ae,ie.el,ie.anchor)},w=({el:ie,anchor:oe},we,Ae)=>{let Oe;for(;ie&&ie!==oe;)Oe=h(ie),n(ie,we,Ae),ie=Oe;n(oe,we,Ae)},C=({el:ie,anchor:oe})=>{let we;for(;ie&&ie!==oe;)we=h(ie),r(ie),ie=we;r(oe)},S=(ie,oe,we,Ae,Oe,ve,ke,be,$e)=>{ke=ke||oe.type==="svg",ie==null?E(oe,we,Ae,Oe,ve,ke,be,$e):O(ie,oe,Oe,ve,ke,be,$e)},E=(ie,oe,we,Ae,Oe,ve,ke,be)=>{let $e,Le;const{type:Ce,props:Be,shapeFlag:He,transition:Xe,dirs:Je}=ie;if($e=ie.el=a(ie.type,ve,Be&&Be.is,Be),He&8?u($e,ie.children):He&16&&P(ie.children,$e,null,Ae,Oe,ve&&Ce!=="foreignObject",ke,be),Je&&qy(ie,null,Ae,"created"),Be){for(const Qe in Be)Qe!=="value"&&!cR(Qe)&&s($e,Qe,null,Be[Qe],ve,ie.children,Ae,Oe,Te);"value"in Be&&s($e,"value",null,Be.value),(Le=Be.onVnodeBeforeMount)&&Hh(Le,Ae,ie)}A($e,ie,ie.scopeId,ke,Ae),Je&&qy(ie,null,Ae,"beforeMount");const it=(!Oe||Oe&&!Oe.pendingBranch)&&Xe&&!Xe.persisted;it&&Xe.beforeEnter($e),n($e,oe,we),((Le=Be&&Be.onVnodeMounted)||it||Je)&&xc(()=>{Le&&Hh(Le,Ae,ie),it&&Xe.enter($e),Je&&qy(ie,null,Ae,"mounted")},Oe)},A=(ie,oe,we,Ae,Oe)=>{if(we&&p(ie,we),Ae)for(let ve=0;ve<Ae.length;ve++)p(ie,Ae[ve]);if(Oe){let ve=Oe.subTree;if(oe===ve){const ke=Oe.vnode;A(ie,ke,ke.scopeId,ke.slotScopeIds,Oe.parent)}}},P=(ie,oe,we,Ae,Oe,ve,ke,be,$e=0)=>{for(let Le=$e;Le<ie.length;Le++){const Ce=ie[Le]=be?$v(ie[Le]):Tp(ie[Le]);g(null,Ce,oe,we,Ae,Oe,ve,ke,be)}},O=(ie,oe,we,Ae,Oe,ve,ke)=>{const be=oe.el=ie.el;let{patchFlag:$e,dynamicChildren:Le,dirs:Ce}=oe;$e|=ie.patchFlag&16;const Be=ie.props||ts,He=oe.props||ts;let Xe;we&&Ky(we,!1),(Xe=He.onVnodeBeforeUpdate)&&Hh(Xe,we,oe,ie),Ce&&qy(oe,ie,we,"beforeUpdate"),we&&Ky(we,!0);const Je=Oe&&oe.type!=="foreignObject";if(Le?M(ie.dynamicChildren,Le,be,we,Ae,Je,ve):ke||$(ie,oe,be,null,we,Ae,Je,ve,!1),$e>0){if($e&16)V(be,oe,Be,He,we,Ae,Oe);else if($e&2&&Be.class!==He.class&&s(be,"class",null,He.class,Oe),$e&4&&s(be,"style",Be.style,He.style,Oe),$e&8){const it=oe.dynamicProps;for(let Qe=0;Qe<it.length;Qe++){const te=it[Qe],me=Be[te],Ie=He[te];(Ie!==me||te==="value")&&s(be,te,me,Ie,Oe,ie.children,we,Ae,Te)}}$e&1&&ie.children!==oe.children&&u(be,oe.children)}else!ke&&Le==null&&V(be,oe,Be,He,we,Ae,Oe);((Xe=He.onVnodeUpdated)||Ce)&&xc(()=>{Xe&&Hh(Xe,we,oe,ie),Ce&&qy(oe,ie,we,"updated")},Ae)},M=(ie,oe,we,Ae,Oe,ve,ke)=>{for(let be=0;be<oe.length;be++){const $e=ie[be],Le=oe[be],Ce=$e.el&&($e.type===gt||!t0($e,Le)||$e.shapeFlag&70)?d($e.el):we;g($e,Le,Ce,null,Ae,Oe,ve,ke,!0)}},V=(ie,oe,we,Ae,Oe,ve,ke)=>{if(we!==Ae){if(we!==ts)for(const be in we)!cR(be)&&!(be in Ae)&&s(ie,be,we[be],null,ke,oe.children,Oe,ve,Te);for(const be in Ae){if(cR(be))continue;const $e=Ae[be],Le=we[be];$e!==Le&&be!=="value"&&s(ie,be,Le,$e,ke,oe.children,Oe,ve,Te)}"value"in Ae&&s(ie,"value",we.value,Ae.value)}},L=(ie,oe,we,Ae,Oe,ve,ke,be,$e)=>{const Le=oe.el=ie?ie.el:o(""),Ce=oe.anchor=ie?ie.anchor:o("");let{patchFlag:Be,dynamicChildren:He,slotScopeIds:Xe}=oe;Xe&&(be=be?be.concat(Xe):Xe),ie==null?(n(Le,we,Ae),n(Ce,we,Ae),P(oe.children,we,Ce,Oe,ve,ke,be,$e)):Be>0&&Be&64&&He&&ie.dynamicChildren?(M(ie.dynamicChildren,He,we,Oe,ve,ke,be),(oe.key!=null||Oe&&oe===Oe.subTree)&&Dz(ie,oe,!0)):$(ie,oe,we,Ce,Oe,ve,ke,be,$e)},U=(ie,oe,we,Ae,Oe,ve,ke,be,$e)=>{oe.slotScopeIds=be,ie==null?oe.shapeFlag&512?Oe.ctx.activate(oe,we,Ae,ke,$e):G(oe,we,Ae,Oe,ve,ke,$e):H(ie,oe,$e)},G=(ie,oe,we,Ae,Oe,ve,ke)=>{const be=ie.component=iTe(ie,Ae,Oe);if(p3(ie)&&(be.ctx.renderer=le),nTe(be),be.asyncDep){if(Oe&&Oe.registerDep(be,k),!ie.el){const $e=be.subTree=re(Gl);b(null,$e,oe,we)}return}k(be,ie,oe,we,Oe,ve,ke)},H=(ie,oe,we)=>{const Ae=oe.component=ie.component;if(vCe(ie,oe,we))if(Ae.asyncDep&&!Ae.asyncResolved){D(Ae,oe,we);return}else Ae.next=oe,cCe(Ae.update),Ae.update();else oe.el=ie.el,Ae.vnode=oe},k=(ie,oe,we,Ae,Oe,ve,ke)=>{const be=()=>{if(ie.isMounted){let{next:Ce,bu:Be,u:He,parent:Xe,vnode:Je}=ie,it=Ce,Qe;Ky(ie,!1),Ce?(Ce.el=Je.el,D(ie,Ce,ke)):Ce=Je,Be&&dR(Be),(Qe=Ce.props&&Ce.props.onVnodeBeforeUpdate)&&Hh(Qe,Xe,Ce,Je),Ky(ie,!0);const te=sk(ie),me=ie.subTree;ie.subTree=te,g(me,te,d(me.el),ce(me),ie,Oe,ve),Ce.el=te.el,it===null&&yCe(ie,te.el),He&&xc(He,Oe),(Qe=Ce.props&&Ce.props.onVnodeUpdated)&&xc(()=>Hh(Qe,Xe,Ce,Je),Oe)}else{let Ce;const{el:Be,props:He}=oe,{bm:Xe,m:Je,parent:it}=ie,Qe=aE(oe);if(Ky(ie,!1),Xe&&dR(Xe),!Qe&&(Ce=He&&He.onVnodeBeforeMount)&&Hh(Ce,it,oe),Ky(ie,!0),Be&&Ue){const te=()=>{ie.subTree=sk(ie),Ue(Be,ie.subTree,ie,Oe,null)};Qe?oe.type.__asyncLoader().then(()=>!ie.isUnmounted&&te()):te()}else{const te=ie.subTree=sk(ie);g(null,te,we,Ae,ie,Oe,ve),oe.el=te.el}if(Je&&xc(Je,Oe),!Qe&&(Ce=He&&He.onVnodeMounted)){const te=oe;xc(()=>Hh(Ce,it,te),Oe)}(oe.shapeFlag&256||it&&aE(it.vnode)&&it.vnode.shapeFlag&256)&&ie.a&&xc(ie.a,Oe),ie.isMounted=!0,oe=we=Ae=null}},$e=ie.effect=new wz(be,()=>Pz(Le),ie.scope),Le=ie.update=()=>$e.run();Le.id=ie.uid,Ky(ie,!0),Le()},D=(ie,oe,we)=>{oe.component=ie;const Ae=ie.vnode.props;ie.vnode=oe,ie.next=null,VCe(ie,oe.props,Ae,we),UCe(ie,oe.children,we),DC(),RW(),kC()},$=(ie,oe,we,Ae,Oe,ve,ke,be,$e=!1)=>{const Le=ie&&ie.children,Ce=ie?ie.shapeFlag:0,Be=oe.children,{patchFlag:He,shapeFlag:Xe}=oe;if(He>0){if(He&128){Y(Le,Be,we,Ae,Oe,ve,ke,be,$e);return}else if(He&256){F(Le,Be,we,Ae,Oe,ve,ke,be,$e);return}}Xe&8?(Ce&16&&Te(Le,Oe,ve),Be!==Le&&u(we,Be)):Ce&16?Xe&16?Y(Le,Be,we,Ae,Oe,ve,ke,be,$e):Te(Le,Oe,ve,!0):(Ce&8&&u(we,""),Xe&16&&P(Be,we,Ae,Oe,ve,ke,be,$e))},F=(ie,oe,we,Ae,Oe,ve,ke,be,$e)=>{ie=ie||dx,oe=oe||dx;const Le=ie.length,Ce=oe.length,Be=Math.min(Le,Ce);let He;for(He=0;He<Be;He++){const Xe=oe[He]=$e?$v(oe[He]):Tp(oe[He]);g(ie[He],Xe,we,null,Oe,ve,ke,be,$e)}Le>Ce?Te(ie,Oe,ve,!0,!1,Be):P(oe,we,Ae,Oe,ve,ke,be,$e,Be)},Y=(ie,oe,we,Ae,Oe,ve,ke,be,$e)=>{let Le=0;const Ce=oe.length;let Be=ie.length-1,He=Ce-1;for(;Le<=Be&&Le<=He;){const Xe=ie[Le],Je=oe[Le]=$e?$v(oe[Le]):Tp(oe[Le]);if(t0(Xe,Je))g(Xe,Je,we,null,Oe,ve,ke,be,$e);else break;Le++}for(;Le<=Be&&Le<=He;){const Xe=ie[Be],Je=oe[He]=$e?$v(oe[He]):Tp(oe[He]);if(t0(Xe,Je))g(Xe,Je,we,null,Oe,ve,ke,be,$e);else break;Be--,He--}if(Le>Be){if(Le<=He){const Xe=He+1,Je=Xe<Ce?oe[Xe].el:Ae;for(;Le<=He;)g(null,oe[Le]=$e?$v(oe[Le]):Tp(oe[Le]),we,Je,Oe,ve,ke,be,$e),Le++}}else if(Le>He)for(;Le<=Be;)X(ie[Le],Oe,ve,!0),Le++;else{const Xe=Le,Je=Le,it=new Map;for(Le=Je;Le<=He;Le++){const De=oe[Le]=$e?$v(oe[Le]):Tp(oe[Le]);De.key!=null&&it.set(De.key,Le)}let Qe,te=0;const me=He-Je+1;let Ie=!1,K=0;const se=new Array(me);for(Le=0;Le<me;Le++)se[Le]=0;for(Le=Xe;Le<=Be;Le++){const De=ie[Le];if(te>=me){X(De,Oe,ve,!0);continue}let Tt;if(De.key!=null)Tt=it.get(De.key);else for(Qe=Je;Qe<=He;Qe++)if(se[Qe-Je]===0&&t0(De,oe[Qe])){Tt=Qe;break}Tt===void 0?X(De,Oe,ve,!0):(se[Tt-Je]=Le+1,Tt>=K?K=Tt:Ie=!0,g(De,oe[Tt],we,null,Oe,ve,ke,be,$e),te++)}const Me=Ie?qCe(se):dx;for(Qe=Me.length-1,Le=me-1;Le>=0;Le--){const De=Je+Le,Tt=oe[De],Zt=De+1<Ce?oe[De+1].el:Ae;se[Le]===0?g(null,Tt,we,Zt,Oe,ve,ke,be,$e):Ie&&(Qe<0||Le!==Me[Qe]?ne(Tt,we,Zt,2):Qe--)}}},ne=(ie,oe,we,Ae,Oe=null)=>{const{el:ve,type:ke,transition:be,children:$e,shapeFlag:Le}=ie;if(Le&6){ne(ie.component.subTree,oe,we,Ae);return}if(Le&128){ie.suspense.move(oe,we,Ae);return}if(Le&64){ke.move(ie,oe,we,le);return}if(ke===gt){n(ve,oe,we);for(let Be=0;Be<$e.length;Be++)ne($e[Be],oe,we,Ae);n(ie.anchor,oe,we);return}if(ke===cE){w(ie,oe,we);return}if(Ae!==2&&Le&1&&be)if(Ae===0)be.beforeEnter(ve),n(ve,oe,we),xc(()=>be.enter(ve),Oe);else{const{leave:Be,delayLeave:He,afterLeave:Xe}=be,Je=()=>n(ve,oe,we),it=()=>{Be(ve,()=>{Je(),Xe&&Xe()})};He?He(ve,Je,it):it()}else n(ve,oe,we)},X=(ie,oe,we,Ae=!1,Oe=!1)=>{const{type:ve,props:ke,ref:be,children:$e,dynamicChildren:Le,shapeFlag:Ce,patchFlag:Be,dirs:He}=ie;if(be!=null&&y5(be,null,we,ie,!0),Ce&256){oe.ctx.deactivate(ie);return}const Xe=Ce&1&&He,Je=!aE(ie);let it;if(Je&&(it=ke&&ke.onVnodeBeforeUnmount)&&Hh(it,oe,ie),Ce&6)ye(ie.component,we,Ae);else{if(Ce&128){ie.suspense.unmount(we,Ae);return}Xe&&qy(ie,null,oe,"beforeUnmount"),Ce&64?ie.type.remove(ie,oe,we,Oe,le,Ae):Le&&(ve!==gt||Be>0&&Be&64)?Te(Le,oe,we,!1,!0):(ve===gt&&Be&384||!Oe&&Ce&16)&&Te($e,oe,we),Ae&&J(ie)}(Je&&(it=ke&&ke.onVnodeUnmounted)||Xe)&&xc(()=>{it&&Hh(it,oe,ie),Xe&&qy(ie,null,oe,"unmounted")},we)},J=ie=>{const{type:oe,el:we,anchor:Ae,transition:Oe}=ie;if(oe===gt){he(we,Ae);return}if(oe===cE){C(ie);return}const ve=()=>{r(we),Oe&&!Oe.persisted&&Oe.afterLeave&&Oe.afterLeave()};if(ie.shapeFlag&1&&Oe&&!Oe.persisted){const{leave:ke,delayLeave:be}=Oe,$e=()=>ke(we,ve);be?be(ie.el,ve,$e):$e()}else ve()},he=(ie,oe)=>{let we;for(;ie!==oe;)we=h(ie),r(ie),ie=we;r(oe)},ye=(ie,oe,we)=>{const{bum:Ae,scope:Oe,update:ve,subTree:ke,um:be}=ie;Ae&&dR(Ae),Oe.stop(),ve&&(ve.active=!1,X(ke,ie,oe,we)),be&&xc(be,oe),xc(()=>{ie.isUnmounted=!0},oe),oe&&oe.pendingBranch&&!oe.isUnmounted&&ie.asyncDep&&!ie.asyncResolved&&ie.suspenseId===oe.pendingId&&(oe.deps--,oe.deps===0&&oe.resolve())},Te=(ie,oe,we,Ae=!1,Oe=!1,ve=0)=>{for(let ke=ve;ke<ie.length;ke++)X(ie[ke],oe,we,Ae,Oe)},ce=ie=>ie.shapeFlag&6?ce(ie.component.subTree):ie.shapeFlag&128?ie.suspense.next():h(ie.anchor||ie.el),ae=(ie,oe,we)=>{ie==null?oe._vnode&&X(oe._vnode,null,null,!0):g(oe._vnode||null,ie,oe,null,null,null,we),RW(),jre(),oe._vnode=ie},le={p:g,um:X,m:ne,r:J,mt:G,mc:P,pc:$,pbc:M,n:ce,o:i};let fe,Ue;return e&&([fe,Ue]=e(le)),{render:ae,hydrate:fe,createApp:GCe(ae,fe)}}function Ky({effect:i,update:e},t){i.allowRecurse=e.allowRecurse=t}function Dz(i,e,t=!1){const n=i.children,r=e.children;if(st(n)&&st(r))for(let s=0;s<n.length;s++){const a=n[s];let o=r[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=r[s]=$v(r[s]),o.el=a.el),t||Dz(a,o)),o.type===NC&&(o.el=a.el)}}function qCe(i){const e=i.slice(),t=[0];let n,r,s,a,o;const l=i.length;for(n=0;n<l;n++){const c=i[n];if(c!==0){if(r=t[t.length-1],i[r]<c){e[n]=r,t.push(n);continue}for(s=0,a=t.length-1;s<a;)o=s+a>>1,i[t[o]]<c?s=o+1:a=o;c<i[t[s]]&&(s>0&&(e[n]=t[s-1]),t[s]=n)}}for(s=t.length,a=t[s-1];s-- >0;)t[s]=a,a=e[a];return t}const KCe=i=>i.__isTeleport,lE=i=>i&&(i.disabled||i.disabled===""),zW=i=>typeof SVGElement<"u"&&i instanceof SVGElement,_5=(i,e)=>{const t=i&&i.to;return Ft(t)?e?e(t):null:t},YCe={__isTeleport:!0,process(i,e,t,n,r,s,a,o,l,c){const{mc:u,pc:d,pbc:h,o:{insert:p,querySelector:m,createText:g,createComment:_}}=c,b=lE(e.props);let{shapeFlag:x,children:w,dynamicChildren:C}=e;if(i==null){const S=e.el=g(""),E=e.anchor=g("");p(S,t,n),p(E,t,n);const A=e.target=_5(e.props,m),P=e.targetAnchor=g("");A&&(p(P,A),a=a||zW(A));const O=(M,V)=>{x&16&&u(w,M,V,r,s,a,o,l)};b?O(t,E):A&&O(A,P)}else{e.el=i.el;const S=e.anchor=i.anchor,E=e.target=i.target,A=e.targetAnchor=i.targetAnchor,P=lE(i.props),O=P?t:E,M=P?S:A;if(a=a||zW(E),C?(h(i.dynamicChildren,C,O,r,s,a,o),Dz(i,e,!0)):l||d(i,e,O,M,r,s,a,o,!1),b)P||GM(e,t,S,c,1);else if((e.props&&e.props.to)!==(i.props&&i.props.to)){const V=e.target=_5(e.props,m);V&&GM(e,V,null,c,0)}else P&&GM(e,E,A,c,1)}dse(e)},remove(i,e,t,n,{um:r,o:{remove:s}},a){const{shapeFlag:o,children:l,anchor:c,targetAnchor:u,target:d,props:h}=i;if(d&&s(u),(a||!lE(h))&&(s(c),o&16))for(let p=0;p<l.length;p++){const m=l[p];r(m,e,t,!0,!!m.dynamicChildren)}},move:GM,hydrate:XCe};function GM(i,e,t,{o:{insert:n},m:r},s=2){s===0&&n(i.targetAnchor,e,t);const{el:a,anchor:o,shapeFlag:l,children:c,props:u}=i,d=s===2;if(d&&n(a,e,t),(!d||lE(u))&&l&16)for(let h=0;h<c.length;h++)r(c[h],e,t,2);d&&n(o,e,t)}function XCe(i,e,t,n,r,s,{o:{nextSibling:a,parentNode:o,querySelector:l}},c){const u=e.target=_5(e.props,l);if(u){const d=u._lpa||u.firstChild;if(e.shapeFlag&16)if(lE(e.props))e.anchor=c(a(i),e,o(i),t,n,r,s),e.targetAnchor=d;else{e.anchor=a(i);let h=d;for(;h;)if(h=a(h),h&&h.nodeType===8&&h.data==="teleport anchor"){e.targetAnchor=h,u._lpa=e.targetAnchor&&a(e.targetAnchor);break}c(d,e,u,t,n,r,s)}dse(e)}return e.anchor&&a(e.anchor)}const QA=YCe;function dse(i){const e=i.ctx;if(e&&e.ut){let t=i.children[0].el;for(;t!==i.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const gt=Symbol(void 0),NC=Symbol(void 0),Gl=Symbol(void 0),cE=Symbol(void 0),uE=[];let gh=null;function I(i=!1){uE.push(gh=i?null:[])}function ZCe(){uE.pop(),gh=uE[uE.length-1]||null}let I2=1;function UW(i){I2+=i}function hse(i){return i.dynamicChildren=I2>0?gh||dx:null,ZCe(),I2>0&&gh&&gh.push(i),i}function Z(i,e,t,n,r,s){return hse(Q(i,e,t,n,r,s,!0))}function Se(i,e,t,n,r){return hse(re(i,e,t,n,r,!0))}function Pr(i){return i?i.__v_isVNode===!0:!1}function t0(i,e){return i.type===e.type&&i.key===e.key}const g3="__vInternal",pse=({key:i})=>i??null,hR=({ref:i,ref_key:e,ref_for:t})=>i!=null?Ft(i)||Vn(i)||Lt(i)?{i:$o,r:i,k:e,f:!!t}:i:null;function Q(i,e=null,t=null,n=0,r=null,s=i===gt?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:i,props:e,key:e&&pse(e),ref:e&&hR(e),scopeId:d3,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:n,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:$o};return o?(kz(l,t),s&128&&i.normalize(l)):t&&(l.shapeFlag|=Ft(t)?8:16),I2>0&&!a&&gh&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&gh.push(l),l}const re=QCe;function QCe(i,e=null,t=null,n=0,r=null,s=!1){if((!i||i===ise)&&(i=Gl),Pr(i)){const o=Km(i,e,!0);return t&&kz(o,t),I2>0&&!s&&gh&&(o.shapeFlag&6?gh[gh.indexOf(i)]=o:gh.push(o)),o.patchFlag|=-2,o}if(oTe(i)&&(i=i.__vccOpts),e){e=v3(e);let{class:o,style:l}=e;o&&!Ft(o)&&(e.class=N(o)),oi(l)&&(Nre(l)&&!st(l)&&(l=co({},l)),e.style=pt(l))}const a=Ft(i)?1:_Ce(i)?128:KCe(i)?64:oi(i)?4:Lt(i)?2:0;return Q(i,e,t,n,r,a,s,!0)}function v3(i){return i?Nre(i)||g3 in i?co({},i):i:null}function Km(i,e,t=!1){const{props:n,ref:r,patchFlag:s,children:a}=i,o=e?ci(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:i.type,props:o,key:o&&pse(o),ref:e&&e.ref?t&&r?st(r)?r.concat(hR(e)):[r,hR(e)]:hR(e):r,scopeId:i.scopeId,slotScopeIds:i.slotScopeIds,children:a,target:i.target,targetAnchor:i.targetAnchor,staticCount:i.staticCount,shapeFlag:i.shapeFlag,patchFlag:e&&i.type!==gt?s===-1?16:s|16:s,dynamicProps:i.dynamicProps,dynamicChildren:i.dynamicChildren,appContext:i.appContext,dirs:i.dirs,transition:i.transition,component:i.component,suspense:i.suspense,ssContent:i.ssContent&&Km(i.ssContent),ssFallback:i.ssFallback&&Km(i.ssFallback),el:i.el,anchor:i.anchor,ctx:i.ctx}}function Gi(i=" ",e=0){return re(NC,null,i,e)}function JCe(i,e){const t=re(cE,null,i);return t.staticCount=e,t}function _e(i="",e=!1){return e?(I(),Se(Gl,null,i)):re(Gl,null,i)}function Tp(i){return i==null||typeof i=="boolean"?re(Gl):st(i)?re(gt,null,i.slice()):typeof i=="object"?$v(i):re(NC,null,String(i))}function $v(i){return i.el===null&&i.patchFlag!==-1||i.memo?i:Km(i)}function kz(i,e){let t=0;const{shapeFlag:n}=i;if(e==null)e=null;else if(st(e))t=16;else if(typeof e=="object")if(n&65){const r=e.default;r&&(r._c&&(r._d=!1),kz(i,r()),r._c&&(r._d=!0));return}else{t=32;const r=e._;!r&&!(g3 in e)?e._ctx=$o:r===3&&$o&&($o.slots._===1?e._=1:(e._=2,i.patchFlag|=1024))}else Lt(e)?(e={default:e,_ctx:$o},t=32):(e=String(e),n&64?(t=16,e=[Gi(e)]):t=8);i.children=e,i.shapeFlag|=t}function ci(...i){const e={};for(let t=0;t<i.length;t++){const n=i[t];for(const r in n)if(r==="class")e.class!==n.class&&(e.class=N([e.class,n.class]));else if(r==="style")e.style=pt([e.style,n.style]);else if(s3(r)){const s=e[r],a=n[r];a&&s!==a&&!(st(s)&&s.includes(a))&&(e[r]=s?[].concat(s,a):a)}else r!==""&&(e[r]=n[r])}return e}function Hh(i,e,t,n=null){Cd(i,e,7,[t,n])}const eTe=use();let tTe=0;function iTe(i,e,t){const n=i.type,r=(e?e.appContext:i.appContext)||eTe,s={uid:tTe++,vnode:i,type:n,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new Sre(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ase(n,r),emitsOptions:Kre(n,r),emit:null,emitted:null,propsDefaults:ts,inheritAttrs:n.inheritAttrs,ctx:ts,data:ts,props:ts,attrs:ts,slots:ts,refs:ts,setupState:ts,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=hCe.bind(null,s),i.ce&&i.ce(s),s}let Za=null;const ti=()=>Za||$o,Jx=i=>{Za=i,i.scope.on()},N0=()=>{Za&&Za.scope.off(),Za=null};function fse(i){return i.vnode.shapeFlag&4}let $2=!1;function nTe(i,e=!1){$2=e;const{props:t,children:n}=i.vnode,r=fse(i);NCe(i,t,r,e),zCe(i,n);const s=r?rTe(i,e):void 0;return $2=!1,s}function rTe(i,e){const t=i.type;i.accessCache=Object.create(null),i.proxy=F0(new Proxy(i.ctx,ICe));const{setup:n}=t;if(n){const r=i.setupContext=n.length>1?gse(i):null;Jx(i),DC();const s=oy(n,i,0,[i.props,r]);if(kC(),N0(),C2(s)){if(s.then(N0,N0),e)return s.then(a=>{HW(i,a,e)}).catch(a=>{c3(a,i,0)});i.asyncDep=s}else HW(i,s,e)}else mse(i,e)}function HW(i,e,t){Lt(e)?i.type.__ssrInlineRender?i.ssrRender=e:i.render=e:oi(e)&&(i.setupState=zre(e)),mse(i,t)}let GW;function mse(i,e,t){const n=i.type;if(!i.render){if(!e&&GW&&!n.render){const r=n.template||$z(i).template;if(r){const{isCustomElement:s,compilerOptions:a}=i.appContext.config,{delimiters:o,compilerOptions:l}=n,c=co(co({isCustomElement:s,delimiters:o},a),l);n.render=GW(r,c)}}i.render=n.render||yn}Jx(i),DC(),$Ce(i),kC(),N0()}function sTe(i){return new Proxy(i.attrs,{get(e,t){return Du(i,"get","$attrs"),e[t]}})}function gse(i){const e=n=>{i.exposed=n||{}};let t;return{get attrs(){return t||(t=sTe(i))},slots:i.slots,emit:i.emit,expose:e}}function y3(i){if(i.exposed)return i.exposeProxy||(i.exposeProxy=new Proxy(zre(F0(i.exposed)),{get(e,t){if(t in e)return e[t];if(t in oE)return oE[t](i)},has(e,t){return t in e||t in oE}}))}function aTe(i,e=!0){return Lt(i)?i.displayName||i.name:i.name||e&&i.__name}function oTe(i){return Lt(i)&&"__vccOpts"in i}const R=(i,e)=>Hre(i,e,$2);function uo(){return vse().slots}function VC(){return vse().attrs}function vse(){const i=ti();return i.setupContext||(i.setupContext=gse(i))}function bt(i,e,t){const n=arguments.length;return n===2?oi(e)&&!st(e)?Pr(e)?re(i,null,[e]):re(i,e):re(i,null,e):(n>3?t=Array.prototype.slice.call(arguments,2):n===3&&Pr(t)&&(t=[t]),re(i,e,t))}const lTe=Symbol(""),cTe=()=>ht(lTe),uTe="3.2.45",dTe="http://www.w3.org/2000/svg",i0=typeof document<"u"?document:null,WW=i0&&i0.createElement("template"),hTe={insert:(i,e,t)=>{e.insertBefore(i,t||null)},remove:i=>{const e=i.parentNode;e&&e.removeChild(i)},createElement:(i,e,t,n)=>{const r=e?i0.createElementNS(dTe,i):i0.createElement(i,t?{is:t}:void 0);return i==="select"&&n&&n.multiple!=null&&r.setAttribute("multiple",n.multiple),r},createText:i=>i0.createTextNode(i),createComment:i=>i0.createComment(i),setText:(i,e)=>{i.nodeValue=e},setElementText:(i,e)=>{i.textContent=e},parentNode:i=>i.parentNode,nextSibling:i=>i.nextSibling,querySelector:i=>i0.querySelector(i),setScopeId(i,e){i.setAttribute(e,"")},insertStaticContent(i,e,t,n,r,s){const a=t?t.previousSibling:e.lastChild;if(r&&(r===s||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),t),!(r===s||!(r=r.nextSibling)););else{WW.innerHTML=n?`<svg>${i}</svg>`:i;const o=WW.content;if(n){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,t)}return[a?a.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}};function pTe(i,e,t){const n=i._vtc;n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?i.removeAttribute("class"):t?i.setAttribute("class",e):i.className=e}function fTe(i,e,t){const n=i.style,r=Ft(t);if(t&&!r){for(const s in t)b5(n,s,t[s]);if(e&&!Ft(e))for(const s in e)t[s]==null&&b5(n,s,"")}else{const s=n.display;r?e!==t&&(n.cssText=t):e&&i.removeAttribute("style"),"_vod"in i&&(n.display=s)}}const jW=/\s*!important$/;function b5(i,e,t){if(st(t))t.forEach(n=>b5(i,e,n));else if(t==null&&(t=""),e.startsWith("--"))i.setProperty(e,t);else{const n=mTe(i,e);jW.test(t)?i.setProperty(Dy(n),t.replace(jW,""),"important"):i[n]=t}}const qW=["Webkit","Moz","ms"],lk={};function mTe(i,e){const t=lk[e];if(t)return t;let n=Sd(e);if(n!=="filter"&&n in i)return lk[e]=n;n=ZA(n);for(let r=0;r<qW.length;r++){const s=qW[r]+n;if(s in i)return lk[e]=s}return e}const KW="http://www.w3.org/1999/xlink";function gTe(i,e,t,n,r){if(n&&e.startsWith("xlink:"))t==null?i.removeAttributeNS(KW,e.slice(6,e.length)):i.setAttributeNS(KW,e,t);else{const s=bxe(e);t==null||s&&!bre(t)?i.removeAttribute(e):i.setAttribute(e,s?"":t)}}function vTe(i,e,t,n,r,s,a){if(e==="innerHTML"||e==="textContent"){n&&a(n,r,s),i[e]=t??"";return}if(e==="value"&&i.tagName!=="PROGRESS"&&!i.tagName.includes("-")){i._value=t;const l=t??"";(i.value!==l||i.tagName==="OPTION")&&(i.value=l),t==null&&i.removeAttribute(e);return}let o=!1;if(t===""||t==null){const l=typeof i[e];l==="boolean"?t=bre(t):t==null&&l==="string"?(t="",o=!0):l==="number"&&(t=0,o=!0)}try{i[e]=t}catch{}o&&i.removeAttribute(e)}function Gv(i,e,t,n){i.addEventListener(e,t,n)}function yTe(i,e,t,n){i.removeEventListener(e,t,n)}function _Te(i,e,t,n,r=null){const s=i._vei||(i._vei={}),a=s[e];if(n&&a)a.value=n;else{const[o,l]=bTe(e);if(n){const c=s[e]=CTe(n,r);Gv(i,o,c,l)}else a&&(yTe(i,o,a,l),s[e]=void 0)}}const YW=/(?:Once|Passive|Capture)$/;function bTe(i){let e;if(YW.test(i)){e={};let n;for(;n=i.match(YW);)i=i.slice(0,i.length-n[0].length),e[n[0].toLowerCase()]=!0}return[i[2]===":"?i.slice(3):Dy(i.slice(2)),e]}let ck=0;const wTe=Promise.resolve(),xTe=()=>ck||(wTe.then(()=>ck=0),ck=Date.now());function CTe(i,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Cd(TTe(n,t.value),e,5,[n])};return t.value=i,t.attached=xTe(),t}function TTe(i,e){if(st(e)){const t=i.stopImmediatePropagation;return i.stopImmediatePropagation=()=>{t.call(i),i._stopped=!0},e.map(n=>r=>!r._stopped&&n&&n(r))}else return e}const XW=/^on[a-z]/,STe=(i,e,t,n,r=!1,s,a,o,l)=>{e==="class"?pTe(i,n,r):e==="style"?fTe(i,t,n):s3(e)?vz(e)||_Te(i,e,t,n,a):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):ETe(i,e,n,r))?vTe(i,e,n,s,a,o,l):(e==="true-value"?i._trueValue=n:e==="false-value"&&(i._falseValue=n),gTe(i,e,n,r))};function ETe(i,e,t,n){return n?!!(e==="innerHTML"||e==="textContent"||e in i&&XW.test(e)&&Lt(t)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&i.tagName==="INPUT"||e==="type"&&i.tagName==="TEXTAREA"||XW.test(e)&&Ft(t)?!1:e in i}function ATe(i){const e=ti();if(!e)return;const t=e.ut=(r=i(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(s=>x5(s,r))},n=()=>{const r=i(e.proxy);w5(e.subTree,r),t(r)};wCe(n),qt(()=>{const r=new MutationObserver(n);r.observe(e.subTree.el.parentNode,{childList:!0}),ky(()=>r.disconnect())})}function w5(i,e){if(i.shapeFlag&128){const t=i.suspense;i=t.activeBranch,t.pendingBranch&&!t.isHydrating&&t.effects.push(()=>{w5(t.activeBranch,e)})}for(;i.component;)i=i.component.subTree;if(i.shapeFlag&1&&i.el)x5(i.el,e);else if(i.type===gt)i.children.forEach(t=>w5(t,e));else if(i.type===cE){let{el:t,anchor:n}=i;for(;t&&(x5(t,e),t!==n);)t=t.nextSibling}}function x5(i,e){if(i.nodeType===1){const t=i.style;for(const n in e)t.setProperty(`--${n}`,e[n])}}const Mg="transition",hT="animation",Ss=(i,{slots:e})=>bt(Zre,_se(i),e);Ss.displayName="Transition";const yse={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},MTe=Ss.props=co({},Zre.props,yse),Yy=(i,e=[])=>{st(i)?i.forEach(t=>t(...e)):i&&i(...e)},ZW=i=>i?st(i)?i.some(e=>e.length>1):i.length>1:!1;function _se(i){const e={};for(const L in i)L in yse||(e[L]=i[L]);if(i.css===!1)return e;const{name:t="v",type:n,duration:r,enterFromClass:s=`${t}-enter-from`,enterActiveClass:a=`${t}-enter-active`,enterToClass:o=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:d=`${t}-leave-from`,leaveActiveClass:h=`${t}-leave-active`,leaveToClass:p=`${t}-leave-to`}=i,m=PTe(r),g=m&&m[0],_=m&&m[1],{onBeforeEnter:b,onEnter:x,onEnterCancelled:w,onLeave:C,onLeaveCancelled:S,onBeforeAppear:E=b,onAppear:A=x,onAppearCancelled:P=w}=e,O=(L,U,G)=>{ev(L,U?u:o),ev(L,U?c:a),G&&G()},M=(L,U)=>{L._isLeaving=!1,ev(L,d),ev(L,p),ev(L,h),U&&U()},V=L=>(U,G)=>{const H=L?A:x,k=()=>O(U,L,G);Yy(H,[U,k]),QW(()=>{ev(U,L?l:s),Wf(U,L?u:o),ZW(H)||JW(U,n,g,k)})};return co(e,{onBeforeEnter(L){Yy(b,[L]),Wf(L,s),Wf(L,a)},onBeforeAppear(L){Yy(E,[L]),Wf(L,l),Wf(L,c)},onEnter:V(!1),onAppear:V(!0),onLeave(L,U){L._isLeaving=!0;const G=()=>M(L,U);Wf(L,d),wse(),Wf(L,h),QW(()=>{L._isLeaving&&(ev(L,d),Wf(L,p),ZW(C)||JW(L,n,_,G))}),Yy(C,[L,G])},onEnterCancelled(L){O(L,!1),Yy(w,[L])},onAppearCancelled(L){O(L,!0),Yy(P,[L])},onLeaveCancelled(L){M(L),Yy(S,[L])}})}function PTe(i){if(i==null)return null;if(oi(i))return[uk(i.enter),uk(i.leave)];{const e=uk(i);return[e,e]}}function uk(i){return S2(i)}function Wf(i,e){e.split(/\s+/).forEach(t=>t&&i.classList.add(t)),(i._vtc||(i._vtc=new Set)).add(e)}function ev(i,e){e.split(/\s+/).forEach(n=>n&&i.classList.remove(n));const{_vtc:t}=i;t&&(t.delete(e),t.size||(i._vtc=void 0))}function QW(i){requestAnimationFrame(()=>{requestAnimationFrame(i)})}let OTe=0;function JW(i,e,t,n){const r=i._endId=++OTe,s=()=>{r===i._endId&&n()};if(t)return setTimeout(s,t);const{type:a,timeout:o,propCount:l}=bse(i,e);if(!a)return n();const c=a+"end";let u=0;const d=()=>{i.removeEventListener(c,h),s()},h=p=>{p.target===i&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},o+1),i.addEventListener(c,h)}function bse(i,e){const t=window.getComputedStyle(i),n=m=>(t[m]||"").split(", "),r=n(`${Mg}Delay`),s=n(`${Mg}Duration`),a=ej(r,s),o=n(`${hT}Delay`),l=n(`${hT}Duration`),c=ej(o,l);let u=null,d=0,h=0;e===Mg?a>0&&(u=Mg,d=a,h=s.length):e===hT?c>0&&(u=hT,d=c,h=l.length):(d=Math.max(a,c),u=d>0?a>c?Mg:hT:null,h=u?u===Mg?s.length:l.length:0);const p=u===Mg&&/\b(transform|all)(,|$)/.test(n(`${Mg}Property`).toString());return{type:u,timeout:d,propCount:h,hasTransform:p}}function ej(i,e){for(;i.length<e.length;)i=i.concat(i);return Math.max(...e.map((t,n)=>tj(t)+tj(i[n])))}function tj(i){return Number(i.slice(0,-1).replace(",","."))*1e3}function wse(){return document.body.offsetHeight}const xse=new WeakMap,Cse=new WeakMap,RTe={name:"TransitionGroup",props:co({},MTe,{tag:String,moveClass:String}),setup(i,{slots:e}){const t=ti(),n=Xre();let r,s;return pg(()=>{if(!r.length)return;const a=i.moveClass||`${i.name||"v"}-move`;if(!kTe(r[0].el,t.vnode.el,a))return;r.forEach($Te),r.forEach(LTe);const o=r.filter(DTe);wse(),o.forEach(l=>{const c=l.el,u=c.style;Wf(c,a),u.transform=u.webkitTransform=u.transitionDuration="";const d=c._moveCb=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",d),c._moveCb=null,ev(c,a))};c.addEventListener("transitionend",d)})}),()=>{const a=mn(i),o=_se(a);let l=a.tag||gt;r=s,s=e.default?Oz(e.default()):[];for(let c=0;c<s.length;c++){const u=s[c];u.key!=null&&O2(u,P2(u,o,n,t))}if(r)for(let c=0;c<r.length;c++){const u=r[c];O2(u,P2(u,o,n,t)),xse.set(u,u.el.getBoundingClientRect())}return re(l,null,s)}}},ITe=RTe;function $Te(i){const e=i.el;e._moveCb&&e._moveCb(),e._enterCb&&e._enterCb()}function LTe(i){Cse.set(i,i.el.getBoundingClientRect())}function DTe(i){const e=xse.get(i),t=Cse.get(i),n=e.left-t.left,r=e.top-t.top;if(n||r){const s=i.el.style;return s.transform=s.webkitTransform=`translate(${n}px,${r}px)`,s.transitionDuration="0s",i}}function kTe(i,e,t){const n=i.cloneNode();i._vtc&&i._vtc.forEach(a=>{a.split(/\s+/).forEach(o=>o&&n.classList.remove(o))}),t.split(/\s+/).forEach(a=>a&&n.classList.add(a)),n.style.display="none";const r=e.nodeType===1?e:e.parentNode;r.appendChild(n);const{hasTransform:s}=bse(n);return r.removeChild(n),s}const eC=i=>{const e=i.props["onUpdate:modelValue"]||!1;return st(e)?t=>dR(e,t):e};function FTe(i){i.target.composing=!0}function ij(i){const e=i.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Fz={created(i,{modifiers:{lazy:e,trim:t,number:n}},r){i._assign=eC(r);const s=n||r.props&&r.props.type==="number";Gv(i,e?"change":"input",a=>{if(a.target.composing)return;let o=i.value;t&&(o=o.trim()),s&&(o=S2(o)),i._assign(o)}),t&&Gv(i,"change",()=>{i.value=i.value.trim()}),e||(Gv(i,"compositionstart",FTe),Gv(i,"compositionend",ij),Gv(i,"change",ij))},mounted(i,{value:e}){i.value=e??""},beforeUpdate(i,{value:e,modifiers:{lazy:t,trim:n,number:r}},s){if(i._assign=eC(s),i.composing||document.activeElement===i&&i.type!=="range"&&(t||n&&i.value.trim()===e||(r||i.type==="number")&&S2(i.value)===e))return;const a=e??"";i.value!==a&&(i.value=a)}},a$={deep:!0,created(i,e,t){i._assign=eC(t),Gv(i,"change",()=>{const n=i._modelValue,r=Sse(i),s=i.checked,a=i._assign;if(st(n)){const o=wre(n,r),l=o!==-1;if(s&&!l)a(n.concat(r));else if(!s&&l){const c=[...n];c.splice(o,1),a(c)}}else if(a3(n)){const o=new Set(n);s?o.add(r):o.delete(r),a(o)}else a(Ese(i,s))})},mounted:nj,beforeUpdate(i,e,t){i._assign=eC(t),nj(i,e,t)}};function nj(i,{value:e,oldValue:t},n){i._modelValue=e,st(e)?i.checked=wre(e,n.props.value)>-1:a3(e)?i.checked=e.has(n.props.value):e!==t&&(i.checked=Zx(e,Ese(i,!0)))}const Tse={created(i,{value:e},t){i.checked=Zx(e,t.props.value),i._assign=eC(t),Gv(i,"change",()=>{i._assign(Sse(i))})},beforeUpdate(i,{value:e,oldValue:t},n){i._assign=eC(n),e!==t&&(i.checked=Zx(e,n.props.value))}};function Sse(i){return"_value"in i?i._value:i.value}function Ese(i,e){const t=e?"_trueValue":"_falseValue";return t in i?i[t]:e}const NTe=["ctrl","shift","alt","meta"],VTe={stop:i=>i.stopPropagation(),prevent:i=>i.preventDefault(),self:i=>i.target!==i.currentTarget,ctrl:i=>!i.ctrlKey,shift:i=>!i.shiftKey,alt:i=>!i.altKey,meta:i=>!i.metaKey,left:i=>"button"in i&&i.button!==0,middle:i=>"button"in i&&i.button!==1,right:i=>"button"in i&&i.button!==2,exact:(i,e)=>NTe.some(t=>i[`${t}Key`]&&!e.includes(t))},Dt=(i,e)=>(t,...n)=>{for(let r=0;r<e.length;r++){const s=VTe[e[r]];if(s&&s(t,e))return}return i(t,...n)},BTe={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},Di=(i,e)=>t=>{if(!("key"in t))return;const n=Dy(t.key);if(e.some(r=>r===n||BTe[r]===n))return i(t)},Ei={beforeMount(i,{value:e},{transition:t}){i._vod=i.style.display==="none"?"":i.style.display,t&&e?t.beforeEnter(i):pT(i,e)},mounted(i,{value:e},{transition:t}){t&&e&&t.enter(i)},updated(i,{value:e,oldValue:t},{transition:n}){!e!=!t&&(n?e?(n.beforeEnter(i),pT(i,!0),n.enter(i)):n.leave(i,()=>{pT(i,!1)}):pT(i,e))},beforeUnmount(i,{value:e}){pT(i,e)}};function pT(i,e){i.style.display=e?i._vod:"none"}const zTe=co({patchProp:STe},hTe);let rj;function Ase(){return rj||(rj=WCe(zTe))}const tC=(...i)=>{Ase().render(...i)},Mse=(...i)=>{const e=Ase().createApp(...i),{mount:t}=e;return e.mount=n=>{const r=UTe(n);if(!r)return;const s=e._component;!Lt(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const a=t(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},e};function UTe(i){return Ft(i)?document.querySelector(i):i}var HTe=typeof global=="object"&&global&&global.Object===Object&&global;const Pse=HTe;var GTe=typeof self=="object"&&self&&self.Object===Object&&self,WTe=Pse||GTe||Function("return this")();const kh=WTe;var jTe=kh.Symbol;const Ed=jTe;var Ose=Object.prototype,qTe=Ose.hasOwnProperty,KTe=Ose.toString,fT=Ed?Ed.toStringTag:void 0;function YTe(i){var e=qTe.call(i,fT),t=i[fT];try{i[fT]=void 0;var n=!0}catch{}var r=KTe.call(i);return n&&(e?i[fT]=t:delete i[fT]),r}var XTe=Object.prototype,ZTe=XTe.toString;function QTe(i){return ZTe.call(i)}var JTe="[object Null]",eSe="[object Undefined]",sj=Ed?Ed.toStringTag:void 0;function Mb(i){return i==null?i===void 0?eSe:JTe:sj&&sj in Object(i)?YTe(i):QTe(i)}function cf(i){return i!=null&&typeof i=="object"}var tSe="[object Symbol]";function _3(i){return typeof i=="symbol"||cf(i)&&Mb(i)==tSe}function Rse(i,e){for(var t=-1,n=i==null?0:i.length,r=Array(n);++t<n;)r[t]=e(i[t],t,i);return r}var iSe=Array.isArray;const Yl=iSe;var nSe=1/0,aj=Ed?Ed.prototype:void 0,oj=aj?aj.toString:void 0;function Ise(i){if(typeof i=="string")return i;if(Yl(i))return Rse(i,Ise)+"";if(_3(i))return oj?oj.call(i):"";var e=i+"";return e=="0"&&1/i==-nSe?"-0":e}var rSe=/\s/;function sSe(i){for(var e=i.length;e--&&rSe.test(i.charAt(e)););return e}var aSe=/^\s+/;function oSe(i){return i&&i.slice(0,sSe(i)+1).replace(aSe,"")}function Xl(i){var e=typeof i;return i!=null&&(e=="object"||e=="function")}var lj=0/0,lSe=/^[-+]0x[0-9a-f]+$/i,cSe=/^0b[01]+$/i,uSe=/^0o[0-7]+$/i,dSe=parseInt;function cj(i){if(typeof i=="number")return i;if(_3(i))return lj;if(Xl(i)){var e=typeof i.valueOf=="function"?i.valueOf():i;i=Xl(e)?e+"":e}if(typeof i!="string")return i===0?i:+i;i=oSe(i);var t=cSe.test(i);return t||uSe.test(i)?dSe(i.slice(2),t?2:8):lSe.test(i)?lj:+i}function Nz(i){return i}var hSe="[object AsyncFunction]",pSe="[object Function]",fSe="[object GeneratorFunction]",mSe="[object Proxy]";function Vz(i){if(!Xl(i))return!1;var e=Mb(i);return e==pSe||e==fSe||e==hSe||e==mSe}var gSe=kh["__core-js_shared__"];const dk=gSe;var uj=function(){var i=/[^.]+$/.exec(dk&&dk.keys&&dk.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function vSe(i){return!!uj&&uj in i}var ySe=Function.prototype,_Se=ySe.toString;function Pb(i){if(i!=null){try{return _Se.call(i)}catch{}try{return i+""}catch{}}return""}var bSe=/[\\^$.*+?()[\]{}|]/g,wSe=/^\[object .+?Constructor\]$/,xSe=Function.prototype,CSe=Object.prototype,TSe=xSe.toString,SSe=CSe.hasOwnProperty,ESe=RegExp("^"+TSe.call(SSe).replace(bSe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ASe(i){if(!Xl(i)||vSe(i))return!1;var e=Vz(i)?ESe:wSe;return e.test(Pb(i))}function MSe(i,e){return i==null?void 0:i[e]}function Ob(i,e){var t=MSe(i,e);return ASe(t)?t:void 0}var PSe=Ob(kh,"WeakMap");const C5=PSe;var dj=Object.create,OSe=function(){function i(){}return function(e){if(!Xl(e))return{};if(dj)return dj(e);i.prototype=e;var t=new i;return i.prototype=void 0,t}}();const RSe=OSe;function ISe(i,e,t){switch(t.length){case 0:return i.call(e);case 1:return i.call(e,t[0]);case 2:return i.call(e,t[0],t[1]);case 3:return i.call(e,t[0],t[1],t[2])}return i.apply(e,t)}function $Se(){}function $se(i,e){var t=-1,n=i.length;for(e||(e=Array(n));++t<n;)e[t]=i[t];return e}var LSe=800,DSe=16,kSe=Date.now;function FSe(i){var e=0,t=0;return function(){var n=kSe(),r=DSe-(n-t);if(t=n,r>0){if(++e>=LSe)return arguments[0]}else e=0;return i.apply(void 0,arguments)}}function NSe(i){return function(){return i}}var VSe=function(){try{var i=Ob(Object,"defineProperty");return i({},"",{}),i}catch{}}();const o$=VSe;var BSe=o$?function(i,e){return o$(i,"toString",{configurable:!0,enumerable:!1,value:NSe(e),writable:!0})}:Nz;const zSe=BSe;var USe=FSe(zSe);const Lse=USe;function HSe(i,e){for(var t=-1,n=i==null?0:i.length;++t<n&&e(i[t],t,i)!==!1;);return i}function GSe(i,e,t,n){for(var r=i.length,s=t+(n?1:-1);n?s--:++s<r;)if(e(i[s],s,i))return s;return-1}function WSe(i){return i!==i}function jSe(i,e,t){for(var n=t-1,r=i.length;++n<r;)if(i[n]===e)return n;return-1}function qSe(i,e,t){return e===e?jSe(i,e,t):GSe(i,WSe,t)}function KSe(i,e){var t=i==null?0:i.length;return!!t&&qSe(i,e,0)>-1}var YSe=9007199254740991,XSe=/^(?:0|[1-9]\d*)$/;function b3(i,e){var t=typeof i;return e=e??YSe,!!e&&(t=="number"||t!="symbol"&&XSe.test(i))&&i>-1&&i%1==0&&i<e}function Bz(i,e,t){e=="__proto__"&&o$?o$(i,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):i[e]=t}function JA(i,e){return i===e||i!==i&&e!==e}var ZSe=Object.prototype,QSe=ZSe.hasOwnProperty;function zz(i,e,t){var n=i[e];(!(QSe.call(i,e)&&JA(n,t))||t===void 0&&!(e in i))&&Bz(i,e,t)}function eM(i,e,t,n){var r=!t;t||(t={});for(var s=-1,a=e.length;++s<a;){var o=e[s],l=n?n(t[o],i[o],o,t,i):void 0;l===void 0&&(l=i[o]),r?Bz(t,o,l):zz(t,o,l)}return t}var hj=Math.max;function Dse(i,e,t){return e=hj(e===void 0?i.length-1:e,0),function(){for(var n=arguments,r=-1,s=hj(n.length-e,0),a=Array(s);++r<s;)a[r]=n[e+r];r=-1;for(var o=Array(e+1);++r<e;)o[r]=n[r];return o[e]=t(a),ISe(i,this,o)}}function kse(i,e){return Lse(Dse(i,e,Nz),i+"")}var JSe=9007199254740991;function Uz(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=JSe}function BC(i){return i!=null&&Uz(i.length)&&!Vz(i)}function eEe(i,e,t){if(!Xl(t))return!1;var n=typeof e;return(n=="number"?BC(t)&&b3(e,t.length):n=="string"&&e in t)?JA(t[e],i):!1}function tEe(i){return kse(function(e,t){var n=-1,r=t.length,s=r>1?t[r-1]:void 0,a=r>2?t[2]:void 0;for(s=i.length>3&&typeof s=="function"?(r--,s):void 0,a&&eEe(t[0],t[1],a)&&(s=r<3?void 0:s,r=1),e=Object(e);++n<r;){var o=t[n];o&&i(e,o,n,s)}return e})}var iEe=Object.prototype;function Hz(i){var e=i&&i.constructor,t=typeof e=="function"&&e.prototype||iEe;return i===t}function nEe(i,e){for(var t=-1,n=Array(i);++t<i;)n[t]=e(t);return n}var rEe="[object Arguments]";function pj(i){return cf(i)&&Mb(i)==rEe}var Fse=Object.prototype,sEe=Fse.hasOwnProperty,aEe=Fse.propertyIsEnumerable,oEe=pj(function(){return arguments}())?pj:function(i){return cf(i)&&sEe.call(i,"callee")&&!aEe.call(i,"callee")};const L2=oEe;function lEe(){return!1}var Nse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,fj=Nse&&typeof module=="object"&&module&&!module.nodeType&&module,cEe=fj&&fj.exports===Nse,mj=cEe?kh.Buffer:void 0,uEe=mj?mj.isBuffer:void 0,dEe=uEe||lEe;const D2=dEe;var hEe="[object Arguments]",pEe="[object Array]",fEe="[object Boolean]",mEe="[object Date]",gEe="[object Error]",vEe="[object Function]",yEe="[object Map]",_Ee="[object Number]",bEe="[object Object]",wEe="[object RegExp]",xEe="[object Set]",CEe="[object String]",TEe="[object WeakMap]",SEe="[object ArrayBuffer]",EEe="[object DataView]",AEe="[object Float32Array]",MEe="[object Float64Array]",PEe="[object Int8Array]",OEe="[object Int16Array]",REe="[object Int32Array]",IEe="[object Uint8Array]",$Ee="[object Uint8ClampedArray]",LEe="[object Uint16Array]",DEe="[object Uint32Array]",Zr={};Zr[AEe]=Zr[MEe]=Zr[PEe]=Zr[OEe]=Zr[REe]=Zr[IEe]=Zr[$Ee]=Zr[LEe]=Zr[DEe]=!0;Zr[hEe]=Zr[pEe]=Zr[SEe]=Zr[fEe]=Zr[EEe]=Zr[mEe]=Zr[gEe]=Zr[vEe]=Zr[yEe]=Zr[_Ee]=Zr[bEe]=Zr[wEe]=Zr[xEe]=Zr[CEe]=Zr[TEe]=!1;function kEe(i){return cf(i)&&Uz(i.length)&&!!Zr[Mb(i)]}function Gz(i){return function(e){return i(e)}}var Vse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,dE=Vse&&typeof module=="object"&&module&&!module.nodeType&&module,FEe=dE&&dE.exports===Vse,hk=FEe&&Pse.process,NEe=function(){try{var i=dE&&dE.require&&dE.require("util").types;return i||hk&&hk.binding&&hk.binding("util")}catch{}}();const iC=NEe;var gj=iC&&iC.isTypedArray,VEe=gj?Gz(gj):kEe;const Wz=VEe;var BEe=Object.prototype,zEe=BEe.hasOwnProperty;function Bse(i,e){var t=Yl(i),n=!t&&L2(i),r=!t&&!n&&D2(i),s=!t&&!n&&!r&&Wz(i),a=t||n||r||s,o=a?nEe(i.length,String):[],l=o.length;for(var c in i)(e||zEe.call(i,c))&&!(a&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||b3(c,l)))&&o.push(c);return o}function zse(i,e){return function(t){return i(e(t))}}var UEe=zse(Object.keys,Object);const HEe=UEe;var GEe=Object.prototype,WEe=GEe.hasOwnProperty;function jEe(i){if(!Hz(i))return HEe(i);var e=[];for(var t in Object(i))WEe.call(i,t)&&t!="constructor"&&e.push(t);return e}function tM(i){return BC(i)?Bse(i):jEe(i)}function qEe(i){var e=[];if(i!=null)for(var t in Object(i))e.push(t);return e}var KEe=Object.prototype,YEe=KEe.hasOwnProperty;function XEe(i){if(!Xl(i))return qEe(i);var e=Hz(i),t=[];for(var n in i)n=="constructor"&&(e||!YEe.call(i,n))||t.push(n);return t}function iM(i){return BC(i)?Bse(i,!0):XEe(i)}var ZEe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,QEe=/^\w*$/;function jz(i,e){if(Yl(i))return!1;var t=typeof i;return t=="number"||t=="symbol"||t=="boolean"||i==null||_3(i)?!0:QEe.test(i)||!ZEe.test(i)||e!=null&&i in Object(e)}var JEe=Ob(Object,"create");const k2=JEe;function e2e(){this.__data__=k2?k2(null):{},this.size=0}function t2e(i){var e=this.has(i)&&delete this.__data__[i];return this.size-=e?1:0,e}var i2e="__lodash_hash_undefined__",n2e=Object.prototype,r2e=n2e.hasOwnProperty;function s2e(i){var e=this.__data__;if(k2){var t=e[i];return t===i2e?void 0:t}return r2e.call(e,i)?e[i]:void 0}var a2e=Object.prototype,o2e=a2e.hasOwnProperty;function l2e(i){var e=this.__data__;return k2?e[i]!==void 0:o2e.call(e,i)}var c2e="__lodash_hash_undefined__";function u2e(i,e){var t=this.__data__;return this.size+=this.has(i)?0:1,t[i]=k2&&e===void 0?c2e:e,this}function sb(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var n=i[e];this.set(n[0],n[1])}}sb.prototype.clear=e2e;sb.prototype.delete=t2e;sb.prototype.get=s2e;sb.prototype.has=l2e;sb.prototype.set=u2e;function d2e(){this.__data__=[],this.size=0}function w3(i,e){for(var t=i.length;t--;)if(JA(i[t][0],e))return t;return-1}var h2e=Array.prototype,p2e=h2e.splice;function f2e(i){var e=this.__data__,t=w3(e,i);if(t<0)return!1;var n=e.length-1;return t==n?e.pop():p2e.call(e,t,1),--this.size,!0}function m2e(i){var e=this.__data__,t=w3(e,i);return t<0?void 0:e[t][1]}function g2e(i){return w3(this.__data__,i)>-1}function v2e(i,e){var t=this.__data__,n=w3(t,i);return n<0?(++this.size,t.push([i,e])):t[n][1]=e,this}function fg(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var n=i[e];this.set(n[0],n[1])}}fg.prototype.clear=d2e;fg.prototype.delete=f2e;fg.prototype.get=m2e;fg.prototype.has=g2e;fg.prototype.set=v2e;var y2e=Ob(kh,"Map");const F2=y2e;function _2e(){this.size=0,this.__data__={hash:new sb,map:new(F2||fg),string:new sb}}function b2e(i){var e=typeof i;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?i!=="__proto__":i===null}function x3(i,e){var t=i.__data__;return b2e(e)?t[typeof e=="string"?"string":"hash"]:t.map}function w2e(i){var e=x3(this,i).delete(i);return this.size-=e?1:0,e}function x2e(i){return x3(this,i).get(i)}function C2e(i){return x3(this,i).has(i)}function T2e(i,e){var t=x3(this,i),n=t.size;return t.set(i,e),this.size+=t.size==n?0:1,this}function mg(i){var e=-1,t=i==null?0:i.length;for(this.clear();++e<t;){var n=i[e];this.set(n[0],n[1])}}mg.prototype.clear=_2e;mg.prototype.delete=w2e;mg.prototype.get=x2e;mg.prototype.has=C2e;mg.prototype.set=T2e;var S2e="Expected a function";function C3(i,e){if(typeof i!="function"||e!=null&&typeof e!="function")throw new TypeError(S2e);var t=function(){var n=arguments,r=e?e.apply(this,n):n[0],s=t.cache;if(s.has(r))return s.get(r);var a=i.apply(this,n);return t.cache=s.set(r,a)||s,a};return t.cache=new(C3.Cache||mg),t}C3.Cache=mg;var E2e=500;function A2e(i){var e=C3(i,function(n){return t.size===E2e&&t.clear(),n}),t=e.cache;return e}var M2e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,P2e=/\\(\\)?/g,O2e=A2e(function(i){var e=[];return i.charCodeAt(0)===46&&e.push(""),i.replace(M2e,function(t,n,r,s){e.push(r?s.replace(P2e,"$1"):n||t)}),e});const R2e=O2e;function I2e(i){return i==null?"":Ise(i)}function T3(i,e){return Yl(i)?i:jz(i,e)?[i]:R2e(I2e(i))}var $2e=1/0;function nM(i){if(typeof i=="string"||_3(i))return i;var e=i+"";return e=="0"&&1/i==-$2e?"-0":e}function qz(i,e){e=T3(e,i);for(var t=0,n=e.length;i!=null&&t<n;)i=i[nM(e[t++])];return t&&t==n?i:void 0}function Tr(i,e,t){var n=i==null?void 0:qz(i,e);return n===void 0?t:n}function Kz(i,e){for(var t=-1,n=e.length,r=i.length;++t<n;)i[r+t]=e[t];return i}var vj=Ed?Ed.isConcatSpreadable:void 0;function L2e(i){return Yl(i)||L2(i)||!!(vj&&i&&i[vj])}function rM(i,e,t,n,r){var s=-1,a=i.length;for(t||(t=L2e),r||(r=[]);++s<a;){var o=i[s];e>0&&t(o)?e>1?rM(o,e-1,t,n,r):Kz(r,o):n||(r[r.length]=o)}return r}function Use(i){var e=i==null?0:i.length;return e?rM(i,1):[]}function D2e(i){return Lse(Dse(i,void 0,Use),i+"")}var k2e=zse(Object.getPrototypeOf,Object);const Yz=k2e;var F2e="[object Object]",N2e=Function.prototype,V2e=Object.prototype,Hse=N2e.toString,B2e=V2e.hasOwnProperty,z2e=Hse.call(Object);function U2e(i){if(!cf(i)||Mb(i)!=F2e)return!1;var e=Yz(i);if(e===null)return!0;var t=B2e.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Hse.call(t)==z2e}function nC(){if(!arguments.length)return[];var i=arguments[0];return Yl(i)?i:[i]}function H2e(){this.__data__=new fg,this.size=0}function G2e(i){var e=this.__data__,t=e.delete(i);return this.size=e.size,t}function W2e(i){return this.__data__.get(i)}function j2e(i){return this.__data__.has(i)}var q2e=200;function K2e(i,e){var t=this.__data__;if(t instanceof fg){var n=t.__data__;if(!F2||n.length<q2e-1)return n.push([i,e]),this.size=++t.size,this;t=this.__data__=new mg(n)}return t.set(i,e),this.size=t.size,this}function Ch(i){var e=this.__data__=new fg(i);this.size=e.size}Ch.prototype.clear=H2e;Ch.prototype.delete=G2e;Ch.prototype.get=W2e;Ch.prototype.has=j2e;Ch.prototype.set=K2e;function Y2e(i,e){return i&&eM(e,tM(e),i)}function X2e(i,e){return i&&eM(e,iM(e),i)}var Gse=typeof exports=="object"&&exports&&!exports.nodeType&&exports,yj=Gse&&typeof module=="object"&&module&&!module.nodeType&&module,Z2e=yj&&yj.exports===Gse,_j=Z2e?kh.Buffer:void 0,bj=_j?_j.allocUnsafe:void 0;function Wse(i,e){if(e)return i.slice();var t=i.length,n=bj?bj(t):new i.constructor(t);return i.copy(n),n}function Q2e(i,e){for(var t=-1,n=i==null?0:i.length,r=0,s=[];++t<n;){var a=i[t];e(a,t,i)&&(s[r++]=a)}return s}function jse(){return[]}var J2e=Object.prototype,eAe=J2e.propertyIsEnumerable,wj=Object.getOwnPropertySymbols,tAe=wj?function(i){return i==null?[]:(i=Object(i),Q2e(wj(i),function(e){return eAe.call(i,e)}))}:jse;const Xz=tAe;function iAe(i,e){return eM(i,Xz(i),e)}var nAe=Object.getOwnPropertySymbols,rAe=nAe?function(i){for(var e=[];i;)Kz(e,Xz(i)),i=Yz(i);return e}:jse;const qse=rAe;function sAe(i,e){return eM(i,qse(i),e)}function Kse(i,e,t){var n=e(i);return Yl(i)?n:Kz(n,t(i))}function T5(i){return Kse(i,tM,Xz)}function aAe(i){return Kse(i,iM,qse)}var oAe=Ob(kh,"DataView");const S5=oAe;var lAe=Ob(kh,"Promise");const E5=lAe;var cAe=Ob(kh,"Set");const mx=cAe;var xj="[object Map]",uAe="[object Object]",Cj="[object Promise]",Tj="[object Set]",Sj="[object WeakMap]",Ej="[object DataView]",dAe=Pb(S5),hAe=Pb(F2),pAe=Pb(E5),fAe=Pb(mx),mAe=Pb(C5),A_=Mb;(S5&&A_(new S5(new ArrayBuffer(1)))!=Ej||F2&&A_(new F2)!=xj||E5&&A_(E5.resolve())!=Cj||mx&&A_(new mx)!=Tj||C5&&A_(new C5)!=Sj)&&(A_=function(i){var e=Mb(i),t=e==uAe?i.constructor:void 0,n=t?Pb(t):"";if(n)switch(n){case dAe:return Ej;case hAe:return xj;case pAe:return Cj;case fAe:return Tj;case mAe:return Sj}return e});const N2=A_;var gAe=Object.prototype,vAe=gAe.hasOwnProperty;function yAe(i){var e=i.length,t=new i.constructor(e);return e&&typeof i[0]=="string"&&vAe.call(i,"index")&&(t.index=i.index,t.input=i.input),t}var _Ae=kh.Uint8Array;const l$=_Ae;function Zz(i){var e=new i.constructor(i.byteLength);return new l$(e).set(new l$(i)),e}function bAe(i,e){var t=e?Zz(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.byteLength)}var wAe=/\w*$/;function xAe(i){var e=new i.constructor(i.source,wAe.exec(i));return e.lastIndex=i.lastIndex,e}var Aj=Ed?Ed.prototype:void 0,Mj=Aj?Aj.valueOf:void 0;function CAe(i){return Mj?Object(Mj.call(i)):{}}function Yse(i,e){var t=e?Zz(i.buffer):i.buffer;return new i.constructor(t,i.byteOffset,i.length)}var TAe="[object Boolean]",SAe="[object Date]",EAe="[object Map]",AAe="[object Number]",MAe="[object RegExp]",PAe="[object Set]",OAe="[object String]",RAe="[object Symbol]",IAe="[object ArrayBuffer]",$Ae="[object DataView]",LAe="[object Float32Array]",DAe="[object Float64Array]",kAe="[object Int8Array]",FAe="[object Int16Array]",NAe="[object Int32Array]",VAe="[object Uint8Array]",BAe="[object Uint8ClampedArray]",zAe="[object Uint16Array]",UAe="[object Uint32Array]";function HAe(i,e,t){var n=i.constructor;switch(e){case IAe:return Zz(i);case TAe:case SAe:return new n(+i);case $Ae:return bAe(i,t);case LAe:case DAe:case kAe:case FAe:case NAe:case VAe:case BAe:case zAe:case UAe:return Yse(i,t);case EAe:return new n;case AAe:case OAe:return new n(i);case MAe:return xAe(i);case PAe:return new n;case RAe:return CAe(i)}}function Xse(i){return typeof i.constructor=="function"&&!Hz(i)?RSe(Yz(i)):{}}var GAe="[object Map]";function WAe(i){return cf(i)&&N2(i)==GAe}var Pj=iC&&iC.isMap,jAe=Pj?Gz(Pj):WAe;const qAe=jAe;var KAe="[object Set]";function YAe(i){return cf(i)&&N2(i)==KAe}var Oj=iC&&iC.isSet,XAe=Oj?Gz(Oj):YAe;const ZAe=XAe;var QAe=1,JAe=2,eMe=4,Zse="[object Arguments]",tMe="[object Array]",iMe="[object Boolean]",nMe="[object Date]",rMe="[object Error]",Qse="[object Function]",sMe="[object GeneratorFunction]",aMe="[object Map]",oMe="[object Number]",Jse="[object Object]",lMe="[object RegExp]",cMe="[object Set]",uMe="[object String]",dMe="[object Symbol]",hMe="[object WeakMap]",pMe="[object ArrayBuffer]",fMe="[object DataView]",mMe="[object Float32Array]",gMe="[object Float64Array]",vMe="[object Int8Array]",yMe="[object Int16Array]",_Me="[object Int32Array]",bMe="[object Uint8Array]",wMe="[object Uint8ClampedArray]",xMe="[object Uint16Array]",CMe="[object Uint32Array]",zr={};zr[Zse]=zr[tMe]=zr[pMe]=zr[fMe]=zr[iMe]=zr[nMe]=zr[mMe]=zr[gMe]=zr[vMe]=zr[yMe]=zr[_Me]=zr[aMe]=zr[oMe]=zr[Jse]=zr[lMe]=zr[cMe]=zr[uMe]=zr[dMe]=zr[bMe]=zr[wMe]=zr[xMe]=zr[CMe]=!0;zr[rMe]=zr[Qse]=zr[hMe]=!1;function hE(i,e,t,n,r,s){var a,o=e&QAe,l=e&JAe,c=e&eMe;if(t&&(a=r?t(i,n,r,s):t(i)),a!==void 0)return a;if(!Xl(i))return i;var u=Yl(i);if(u){if(a=yAe(i),!o)return $se(i,a)}else{var d=N2(i),h=d==Qse||d==sMe;if(D2(i))return Wse(i,o);if(d==Jse||d==Zse||h&&!r){if(a=l||h?{}:Xse(i),!o)return l?sAe(i,X2e(a,i)):iAe(i,Y2e(a,i))}else{if(!zr[d])return r?i:{};a=HAe(i,d,o)}}s||(s=new Ch);var p=s.get(i);if(p)return p;s.set(i,a),ZAe(i)?i.forEach(function(_){a.add(hE(_,e,t,_,i,s))}):qAe(i)&&i.forEach(function(_,b){a.set(b,hE(_,e,t,b,i,s))});var m=c?l?aAe:T5:l?iM:tM,g=u?void 0:m(i);return HSe(g||i,function(_,b){g&&(b=_,_=i[b]),zz(a,b,hE(_,e,t,b,i,s))}),a}var TMe=4;function Rj(i){return hE(i,TMe)}var SMe=1,EMe=4;function eae(i){return hE(i,SMe|EMe)}var AMe="__lodash_hash_undefined__";function MMe(i){return this.__data__.set(i,AMe),this}function PMe(i){return this.__data__.has(i)}function V2(i){var e=-1,t=i==null?0:i.length;for(this.__data__=new mg;++e<t;)this.add(i[e])}V2.prototype.add=V2.prototype.push=MMe;V2.prototype.has=PMe;function OMe(i,e){for(var t=-1,n=i==null?0:i.length;++t<n;)if(e(i[t],t,i))return!0;return!1}function tae(i,e){return i.has(e)}var RMe=1,IMe=2;function iae(i,e,t,n,r,s){var a=t&RMe,o=i.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(i),u=s.get(e);if(c&&u)return c==e&&u==i;var d=-1,h=!0,p=t&IMe?new V2:void 0;for(s.set(i,e),s.set(e,i);++d<o;){var m=i[d],g=e[d];if(n)var _=a?n(g,m,d,e,i,s):n(m,g,d,i,e,s);if(_!==void 0){if(_)continue;h=!1;break}if(p){if(!OMe(e,function(b,x){if(!tae(p,x)&&(m===b||r(m,b,t,n,s)))return p.push(x)})){h=!1;break}}else if(!(m===g||r(m,g,t,n,s))){h=!1;break}}return s.delete(i),s.delete(e),h}function $Me(i){var e=-1,t=Array(i.size);return i.forEach(function(n,r){t[++e]=[r,n]}),t}function Qz(i){var e=-1,t=Array(i.size);return i.forEach(function(n){t[++e]=n}),t}var LMe=1,DMe=2,kMe="[object Boolean]",FMe="[object Date]",NMe="[object Error]",VMe="[object Map]",BMe="[object Number]",zMe="[object RegExp]",UMe="[object Set]",HMe="[object String]",GMe="[object Symbol]",WMe="[object ArrayBuffer]",jMe="[object DataView]",Ij=Ed?Ed.prototype:void 0,pk=Ij?Ij.valueOf:void 0;function qMe(i,e,t,n,r,s,a){switch(t){case jMe:if(i.byteLength!=e.byteLength||i.byteOffset!=e.byteOffset)return!1;i=i.buffer,e=e.buffer;case WMe:return!(i.byteLength!=e.byteLength||!s(new l$(i),new l$(e)));case kMe:case FMe:case BMe:return JA(+i,+e);case NMe:return i.name==e.name&&i.message==e.message;case zMe:case HMe:return i==e+"";case VMe:var o=$Me;case UMe:var l=n&LMe;if(o||(o=Qz),i.size!=e.size&&!l)return!1;var c=a.get(i);if(c)return c==e;n|=DMe,a.set(i,e);var u=iae(o(i),o(e),n,r,s,a);return a.delete(i),u;case GMe:if(pk)return pk.call(i)==pk.call(e)}return!1}var KMe=1,YMe=Object.prototype,XMe=YMe.hasOwnProperty;function ZMe(i,e,t,n,r,s){var a=t&KMe,o=T5(i),l=o.length,c=T5(e),u=c.length;if(l!=u&&!a)return!1;for(var d=l;d--;){var h=o[d];if(!(a?h in e:XMe.call(e,h)))return!1}var p=s.get(i),m=s.get(e);if(p&&m)return p==e&&m==i;var g=!0;s.set(i,e),s.set(e,i);for(var _=a;++d<l;){h=o[d];var b=i[h],x=e[h];if(n)var w=a?n(x,b,h,e,i,s):n(b,x,h,i,e,s);if(!(w===void 0?b===x||r(b,x,t,n,s):w)){g=!1;break}_||(_=h=="constructor")}if(g&&!_){var C=i.constructor,S=e.constructor;C!=S&&"constructor"in i&&"constructor"in e&&!(typeof C=="function"&&C instanceof C&&typeof S=="function"&&S instanceof S)&&(g=!1)}return s.delete(i),s.delete(e),g}var QMe=1,$j="[object Arguments]",Lj="[object Array]",WM="[object Object]",JMe=Object.prototype,Dj=JMe.hasOwnProperty;function ePe(i,e,t,n,r,s){var a=Yl(i),o=Yl(e),l=a?Lj:N2(i),c=o?Lj:N2(e);l=l==$j?WM:l,c=c==$j?WM:c;var u=l==WM,d=c==WM,h=l==c;if(h&&D2(i)){if(!D2(e))return!1;a=!0,u=!1}if(h&&!u)return s||(s=new Ch),a||Wz(i)?iae(i,e,t,n,r,s):qMe(i,e,l,t,n,r,s);if(!(t&QMe)){var p=u&&Dj.call(i,"__wrapped__"),m=d&&Dj.call(e,"__wrapped__");if(p||m){var g=p?i.value():i,_=m?e.value():e;return s||(s=new Ch),r(g,_,t,n,s)}}return h?(s||(s=new Ch),ZMe(i,e,t,n,r,s)):!1}function S3(i,e,t,n,r){return i===e?!0:i==null||e==null||!cf(i)&&!cf(e)?i!==i&&e!==e:ePe(i,e,t,n,S3,r)}var tPe=1,iPe=2;function nPe(i,e,t,n){var r=t.length,s=r,a=!n;if(i==null)return!s;for(i=Object(i);r--;){var o=t[r];if(a&&o[2]?o[1]!==i[o[0]]:!(o[0]in i))return!1}for(;++r<s;){o=t[r];var l=o[0],c=i[l],u=o[1];if(a&&o[2]){if(c===void 0&&!(l in i))return!1}else{var d=new Ch;if(n)var h=n(c,u,l,i,e,d);if(!(h===void 0?S3(u,c,tPe|iPe,n,d):h))return!1}}return!0}function nae(i){return i===i&&!Xl(i)}function rPe(i){for(var e=tM(i),t=e.length;t--;){var n=e[t],r=i[n];e[t]=[n,r,nae(r)]}return e}function rae(i,e){return function(t){return t==null?!1:t[i]===e&&(e!==void 0||i in Object(t))}}function sPe(i){var e=rPe(i);return e.length==1&&e[0][2]?rae(e[0][0],e[0][1]):function(t){return t===i||nPe(t,i,e)}}function aPe(i,e){return i!=null&&e in Object(i)}function oPe(i,e,t){e=T3(e,i);for(var n=-1,r=e.length,s=!1;++n<r;){var a=nM(e[n]);if(!(s=i!=null&&t(i,a)))break;i=i[a]}return s||++n!=r?s:(r=i==null?0:i.length,!!r&&Uz(r)&&b3(a,r)&&(Yl(i)||L2(i)))}function sae(i,e){return i!=null&&oPe(i,e,aPe)}var lPe=1,cPe=2;function uPe(i,e){return jz(i)&&nae(e)?rae(nM(i),e):function(t){var n=Tr(t,i);return n===void 0&&n===e?sae(t,i):S3(e,n,lPe|cPe)}}function dPe(i){return function(e){return e==null?void 0:e[i]}}function hPe(i){return function(e){return qz(e,i)}}function pPe(i){return jz(i)?dPe(nM(i)):hPe(i)}function fPe(i){return typeof i=="function"?i:i==null?Nz:typeof i=="object"?Yl(i)?uPe(i[0],i[1]):sPe(i):pPe(i)}function mPe(i){return function(e,t,n){for(var r=-1,s=Object(e),a=n(e),o=a.length;o--;){var l=a[i?o:++r];if(t(s[l],l,s)===!1)break}return e}}var gPe=mPe();const aae=gPe;function vPe(i,e){return i&&aae(i,e,tM)}function yPe(i,e){return function(t,n){if(t==null)return t;if(!BC(t))return i(t,n);for(var r=t.length,s=e?r:-1,a=Object(t);(e?s--:++s<r)&&n(a[s],s,a)!==!1;);return t}}var _Pe=yPe(vPe);const bPe=_Pe;var wPe=function(){return kh.Date.now()};const fk=wPe;var xPe="Expected a function",CPe=Math.max,TPe=Math.min;function Zl(i,e,t){var n,r,s,a,o,l,c=0,u=!1,d=!1,h=!0;if(typeof i!="function")throw new TypeError(xPe);e=cj(e)||0,Xl(t)&&(u=!!t.leading,d="maxWait"in t,s=d?CPe(cj(t.maxWait)||0,e):s,h="trailing"in t?!!t.trailing:h);function p(E){var A=n,P=r;return n=r=void 0,c=E,a=i.apply(P,A),a}function m(E){return c=E,o=setTimeout(b,e),u?p(E):a}function g(E){var A=E-l,P=E-c,O=e-A;return d?TPe(O,s-P):O}function _(E){var A=E-l,P=E-c;return l===void 0||A>=e||A<0||d&&P>=s}function b(){var E=fk();if(_(E))return x(E);o=setTimeout(b,g(E))}function x(E){return o=void 0,h&&n?p(E):(n=r=void 0,a)}function w(){o!==void 0&&clearTimeout(o),c=0,n=l=r=o=void 0}function C(){return o===void 0?a:x(fk())}function S(){var E=fk(),A=_(E);if(n=arguments,r=this,l=E,A){if(o===void 0)return m(l);if(d)return clearTimeout(o),o=setTimeout(b,e),p(l)}return o===void 0&&(o=setTimeout(b,e)),a}return S.cancel=w,S.flush=C,S}function A5(i,e,t){(t!==void 0&&!JA(i[e],t)||t===void 0&&!(e in i))&&Bz(i,e,t)}function oae(i){return cf(i)&&BC(i)}function M5(i,e){if(!(e==="constructor"&&typeof i[e]=="function")&&e!="__proto__")return i[e]}function SPe(i){return eM(i,iM(i))}function EPe(i,e,t,n,r,s,a){var o=M5(i,t),l=M5(e,t),c=a.get(l);if(c){A5(i,t,c);return}var u=s?s(o,l,t+"",i,e,a):void 0,d=u===void 0;if(d){var h=Yl(l),p=!h&&D2(l),m=!h&&!p&&Wz(l);u=l,h||p||m?Yl(o)?u=o:oae(o)?u=$se(o):p?(d=!1,u=Wse(l,!0)):m?(d=!1,u=Yse(l,!0)):u=[]:U2e(l)||L2(l)?(u=o,L2(o)?u=SPe(o):(!Xl(o)||Vz(o))&&(u=Xse(l))):d=!1}d&&(a.set(l,u),r(u,l,n,s,a),a.delete(l)),A5(i,t,u)}function lae(i,e,t,n,r){i!==e&&aae(e,function(s,a){if(r||(r=new Ch),Xl(s))EPe(i,e,a,t,lae,n,r);else{var o=n?n(M5(i,a),s,a+"",i,e,r):void 0;o===void 0&&(o=s),A5(i,a,o)}},iM)}function APe(i,e,t){for(var n=-1,r=i==null?0:i.length;++n<r;)if(t(e,i[n]))return!0;return!1}function MPe(i,e){var t=-1,n=BC(i)?Array(i.length):[];return bPe(i,function(r,s,a){n[++t]=e(r,s,a)}),n}function PPe(i,e){var t=Yl(i)?Rse:MPe;return t(i,fPe(e))}function OPe(i,e){return rM(PPe(i,e),1)}var RPe=1/0;function IPe(i){var e=i==null?0:i.length;return e?rM(i,RPe):[]}function cae(i){for(var e=-1,t=i==null?0:i.length,n={};++e<t;){var r=i[e];n[r[0]]=r[1]}return n}function Iu(i,e){return S3(i,e)}function so(i){return i==null}var $Pe=tEe(function(i,e,t){lae(i,e,t)});const uae=$Pe;function dae(i,e,t,n){if(!Xl(i))return i;e=T3(e,i);for(var r=-1,s=e.length,a=s-1,o=i;o!=null&&++r<s;){var l=nM(e[r]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return i;if(r!=a){var u=o[l];c=n?n(u,l,o):void 0,c===void 0&&(c=Xl(u)?u:b3(e[r+1])?[]:{})}zz(o,l,c),o=o[l]}return i}function LPe(i,e,t){for(var n=-1,r=e.length,s={};++n<r;){var a=e[n],o=qz(i,a);t(o,a)&&dae(s,T3(a,i),o)}return s}function DPe(i,e){return LPe(i,e,function(t,n){return sae(i,n)})}var kPe=D2e(function(i,e){return i==null?{}:DPe(i,e)});const Am=kPe;function FPe(i,e,t){return i==null?i:dae(i,e,t)}var NPe="Expected a function";function V0(i,e,t){var n=!0,r=!0;if(typeof i!="function")throw new TypeError(NPe);return Xl(t)&&(n="leading"in t?!!t.leading:n,r="trailing"in t?!!t.trailing:r),Zl(i,e,{leading:n,maxWait:e,trailing:r})}var VPe=1/0,BPe=mx&&1/Qz(new mx([,-0]))[1]==VPe?function(i){return new mx(i)}:$Se;const zPe=BPe;var UPe=200;function HPe(i,e,t){var n=-1,r=KSe,s=i.length,a=!0,o=[],l=o;if(t)a=!1,r=APe;else if(s>=UPe){var c=e?null:zPe(i);if(c)return Qz(c);a=!1,r=tae,l=new V2}else l=e?[]:o;e:for(;++n<s;){var u=i[n],d=e?e(u):u;if(u=t||u!==0?u:0,a&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;e&&l.push(d),o.push(u)}else r(l,d,t)||(l!==o&&l.push(d),o.push(u))}return o}var GPe=kse(function(i){return HPe(rM(i,1,oae,!0))});const mk=GPe,WPe='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',jPe=i=>getComputedStyle(i).position==="fixed"?!1:i.offsetParent!==null,kj=i=>Array.from(i.querySelectorAll(WPe)).filter(e=>qPe(e)&&jPe(e)),qPe=i=>{if(i.tabIndex>0||i.tabIndex===0&&i.getAttribute("tabIndex")!==null)return!0;if(i.disabled)return!1;switch(i.nodeName){case"A":return!!i.href&&i.rel!=="ignore";case"INPUT":return!(i.type==="hidden"||i.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},pR=function(i,e,...t){let n;e.includes("mouse")||e.includes("click")?n="MouseEvents":e.includes("key")?n="KeyboardEvent":n="HTMLEvents";const r=document.createEvent(n);return r.initEvent(e,...t),i.dispatchEvent(r),i},hae=i=>!i.getAttribute("aria-owns"),pae=(i,e,t)=>{const{parentNode:n}=i;if(!n)return null;const r=n.querySelectorAll(t),s=Array.prototype.indexOf.call(r,i);return r[s+e]||null},fR=i=>{i&&(i.focus(),!hae(i)&&i.click())},Hr=(i,e,{checkForDefaultPrevented:t=!0}={})=>r=>{const s=i==null?void 0:i(r);if(t===!1||!s)return e==null?void 0:e(r)},Fj=i=>e=>e.pointerType==="mouse"?i(e):void 0;var KPe=Object.defineProperty,YPe=Object.defineProperties,XPe=Object.getOwnPropertyDescriptors,Nj=Object.getOwnPropertySymbols,ZPe=Object.prototype.hasOwnProperty,QPe=Object.prototype.propertyIsEnumerable,Vj=(i,e,t)=>e in i?KPe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,JPe=(i,e)=>{for(var t in e||(e={}))ZPe.call(e,t)&&Vj(i,t,e[t]);if(Nj)for(var t of Nj(e))QPe.call(e,t)&&Vj(i,t,e[t]);return i},eOe=(i,e)=>YPe(i,XPe(e));function Bj(i,e){var t;const n=nr();return Ru(()=>{n.value=i()},eOe(JPe({},e),{flush:(t=e==null?void 0:e.flush)!=null?t:"sync"})),FC(n)}var zj;const Ii=typeof window<"u",tOe=i=>typeof i<"u",Ys=i=>typeof i=="boolean",iOe=i=>typeof i=="function",It=i=>typeof i=="number",nOe=i=>typeof i=="string",B2=()=>{};Ii&&((zj=window==null?void 0:window.navigator)!=null&&zj.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function ab(i){return typeof i=="function"?i():v(i)}function fae(i,e){function t(...n){return new Promise((r,s)=>{Promise.resolve(i(()=>e.apply(this,n),{fn:e,thisArg:this,args:n})).then(r).catch(s)})}return t}function rOe(i,e={}){let t,n,r=B2;const s=o=>{clearTimeout(o),r(),r=B2};return o=>{const l=ab(i),c=ab(e.maxWait);return t&&s(t),l<=0||c!==void 0&&c<=0?(n&&(s(n),n=null),Promise.resolve(o())):new Promise((u,d)=>{r=e.rejectOnCancel?d:u,c&&!n&&(n=setTimeout(()=>{t&&s(t),n=null,u(o())},c)),t=setTimeout(()=>{n&&s(n),n=null,u(o())},l)})}}function sOe(i,e=!0,t=!0,n=!1){let r=0,s,a=!0,o=B2,l;const c=()=>{s&&(clearTimeout(s),s=void 0,o(),o=B2)};return d=>{const h=ab(i),p=Date.now()-r,m=()=>l=d();if(c(),h<=0)return r=Date.now(),m();if(p>h&&(t||!a))r=Date.now(),m();else if(e)return new Promise((g,_)=>{o=n?_:g,s=setTimeout(()=>{r=Date.now(),a=!0,g(m()),c()},h-p)});return!t&&!s&&(s=setTimeout(()=>a=!0,h)),a=!1,l}}function aOe(i){return i}function E3(i){return Oxe()?(Ere(i),!0):!1}function oOe(i,e=200,t={}){return fae(rOe(e,t),i)}function lOe(i,e=200,t={}){const n=W(i.value),r=oOe(()=>{n.value=i.value},e,t);return Ve(i,()=>r()),n}function mae(i,e=200,t=!1,n=!0,r=!1){return fae(sOe(e,t,n,r),i)}function Jz(i,e=!0){ti()?qt(i):e?i():ut(i)}function ob(i,e,t={}){const{immediate:n=!0}=t,r=W(!1);let s=null;function a(){s&&(clearTimeout(s),s=null)}function o(){r.value=!1,a()}function l(...c){a(),r.value=!0,s=setTimeout(()=>{r.value=!1,s=null,i(...c)},ab(e))}return n&&(r.value=!0,Ii&&l()),E3(o),{isPending:FC(r),start:l,stop:o}}function Mu(i){var e;const t=ab(i);return(e=t==null?void 0:t.$el)!=null?e:t}const zC=Ii?window:void 0,cOe=Ii?window.document:void 0;function mr(...i){let e,t,n,r;if(nOe(i[0])||Array.isArray(i[0])?([t,n,r]=i,e=zC):[e,t,n,r]=i,!e)return B2;Array.isArray(t)||(t=[t]),Array.isArray(n)||(n=[n]);const s=[],a=()=>{s.forEach(u=>u()),s.length=0},o=(u,d,h)=>(u.addEventListener(d,h,r),()=>u.removeEventListener(d,h,r)),l=Ve(()=>Mu(e),u=>{a(),u&&s.push(...t.flatMap(d=>n.map(h=>o(u,d,h))))},{immediate:!0,flush:"post"}),c=()=>{l(),a()};return E3(c),c}function e9(i,e,t={}){const{window:n=zC,ignore:r=[],capture:s=!0,detectIframe:a=!1}=t;if(!n)return;let o=!0,l;const c=p=>r.some(m=>{if(typeof m=="string")return Array.from(n.document.querySelectorAll(m)).some(g=>g===p.target||p.composedPath().includes(g));{const g=Mu(m);return g&&(p.target===g||p.composedPath().includes(g))}}),u=p=>{n.clearTimeout(l);const m=Mu(i);if(!(!m||m===p.target||p.composedPath().includes(m))){if(p.detail===0&&(o=!c(p)),!o){o=!0;return}e(p)}},d=[mr(n,"click",u,{passive:!0,capture:s}),mr(n,"pointerdown",p=>{const m=Mu(i);m&&(o=!p.composedPath().includes(m)&&!c(p))},{passive:!0}),mr(n,"pointerup",p=>{if(p.button===0){const m=p.composedPath();p.composedPath=()=>m,l=n.setTimeout(()=>u(p),50)}},{passive:!0}),a&&mr(n,"blur",p=>{var m;const g=Mu(i);((m=n.document.activeElement)==null?void 0:m.tagName)==="IFRAME"&&!(g!=null&&g.contains(n.document.activeElement))&&e(p)})].filter(Boolean);return()=>d.forEach(p=>p())}function uOe(i,e=!1){const t=W(),n=()=>t.value=Boolean(i());return n(),Jz(n,e),t}function dOe(i){return JSON.parse(JSON.stringify(i))}const P5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},O5="__vueuse_ssr_handlers__";P5[O5]=P5[O5]||{};P5[O5];function hOe(i,e,{window:t=zC,initialValue:n=""}={}){const r=W(n),s=R(()=>{var a;return Mu(e)||((a=t==null?void 0:t.document)==null?void 0:a.documentElement)});return Ve([s,()=>ab(i)],([a,o])=>{var l;if(a&&t){const c=(l=t.getComputedStyle(a).getPropertyValue(o))==null?void 0:l.trim();r.value=c||n}},{immediate:!0}),Ve(r,a=>{var o;(o=s.value)!=null&&o.style&&s.value.style.setProperty(ab(i),a)}),r}function pOe({document:i=cOe}={}){if(!i)return W("visible");const e=W(i.visibilityState);return mr(i,"visibilitychange",()=>{e.value=i.visibilityState}),e}var Uj=Object.getOwnPropertySymbols,fOe=Object.prototype.hasOwnProperty,mOe=Object.prototype.propertyIsEnumerable,gOe=(i,e)=>{var t={};for(var n in i)fOe.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&Uj)for(var n of Uj(i))e.indexOf(n)<0&&mOe.call(i,n)&&(t[n]=i[n]);return t};function fl(i,e,t={}){const n=t,{window:r=zC}=n,s=gOe(n,["window"]);let a;const o=uOe(()=>r&&"ResizeObserver"in r),l=()=>{a&&(a.disconnect(),a=void 0)},c=Ve(()=>Mu(i),d=>{l(),o.value&&r&&d&&(a=new ResizeObserver(e),a.observe(d,s))},{immediate:!0,flush:"post"}),u=()=>{l(),c()};return E3(u),{isSupported:o,stop:u}}function Hj(i,e={}){const{reset:t=!0,windowResize:n=!0,windowScroll:r=!0,immediate:s=!0}=e,a=W(0),o=W(0),l=W(0),c=W(0),u=W(0),d=W(0),h=W(0),p=W(0);function m(){const g=Mu(i);if(!g){t&&(a.value=0,o.value=0,l.value=0,c.value=0,u.value=0,d.value=0,h.value=0,p.value=0);return}const _=g.getBoundingClientRect();a.value=_.height,o.value=_.bottom,l.value=_.left,c.value=_.right,u.value=_.top,d.value=_.width,h.value=_.x,p.value=_.y}return fl(i,m),Ve(()=>Mu(i),g=>!g&&m()),r&&mr("scroll",m,{capture:!0,passive:!0}),n&&mr("resize",m,{passive:!0}),Jz(()=>{s&&m()}),{height:a,bottom:o,left:l,right:c,top:u,width:d,x:h,y:p,update:m}}var Gj;(function(i){i.UP="UP",i.RIGHT="RIGHT",i.DOWN="DOWN",i.LEFT="LEFT",i.NONE="NONE"})(Gj||(Gj={}));var vOe=Object.defineProperty,Wj=Object.getOwnPropertySymbols,yOe=Object.prototype.hasOwnProperty,_Oe=Object.prototype.propertyIsEnumerable,jj=(i,e,t)=>e in i?vOe(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,bOe=(i,e)=>{for(var t in e||(e={}))yOe.call(e,t)&&jj(i,t,e[t]);if(Wj)for(var t of Wj(e))_Oe.call(e,t)&&jj(i,t,e[t]);return i};const wOe={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};bOe({linear:aOe},wOe);function xOe(i,e,t,n={}){var r,s,a;const{clone:o=!1,passive:l=!1,eventName:c,deep:u=!1,defaultValue:d}=n,h=ti(),p=t||(h==null?void 0:h.emit)||((r=h==null?void 0:h.$emit)==null?void 0:r.bind(h))||((a=(s=h==null?void 0:h.proxy)==null?void 0:s.$emit)==null?void 0:a.bind(h==null?void 0:h.proxy));let m=c;e||(e="modelValue"),m=c||m||`update:${e.toString()}`;const g=b=>o?iOe(o)?o(b):dOe(b):b,_=()=>tOe(i[e])?g(i[e]):d;if(l){const b=_(),x=W(b);return Ve(()=>i[e],w=>x.value=g(w)),Ve(x,w=>{(w!==i[e]||u)&&p(m,w)},{deep:u}),x}else return R({get(){return _()},set(b){p(m,b)}})}function COe({window:i=zC}={}){if(!i)return W(!1);const e=W(i.document.hasFocus());return mr(i,"blur",()=>{e.value=!1}),mr(i,"focus",()=>{e.value=!0}),e}function TOe(i={}){const{window:e=zC,initialWidth:t=1/0,initialHeight:n=1/0,listenOrientation:r=!0,includeScrollbar:s=!0}=i,a=W(t),o=W(n),l=()=>{e&&(s?(a.value=e.innerWidth,o.value=e.innerHeight):(a.value=e.document.documentElement.clientWidth,o.value=e.document.documentElement.clientHeight))};return l(),Jz(l),mr("resize",l,{passive:!0}),r&&mr("orientationchange",l,{passive:!0}),{width:a,height:o}}const SOe=(i,e)=>{if(!Ii||!i||!e)return!1;const t=i.getBoundingClientRect();let n;return e instanceof Element?n=e.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<n.bottom&&t.bottom>n.top&&t.right>n.left&&t.left<n.right},qj=i=>{let e=0,t=i;for(;t;)e+=t.offsetTop,t=t.offsetParent;return e},EOe=(i,e)=>Math.abs(qj(i)-qj(e)),t9=i=>{let e,t;return i.type==="touchend"?(t=i.changedTouches[0].clientY,e=i.changedTouches[0].clientX):i.type.startsWith("touch")?(t=i.touches[0].clientY,e=i.touches[0].clientX):(t=i.clientY,e=i.clientX),{clientX:e,clientY:t}},eo=i=>i===void 0,pd=i=>!i&&i!==0||st(i)&&i.length===0||oi(i)&&!Object.keys(i).length,Oh=i=>typeof Element>"u"?!1:i instanceof Element,AOe=i=>so(i),MOe=i=>Ft(i)?!Number.isNaN(Number(i)):!1,gae=(i="")=>i.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),Op=i=>ZA(i),z2=i=>Object.keys(i),POe=i=>Object.entries(i),mR=(i,e,t)=>({get value(){return Tr(i,e,t)},set value(n){FPe(i,e,n)}});class OOe extends Error{constructor(e){super(e),this.name="ElementPlusError"}}function ba(i,e){throw new OOe(`[${i}] ${e}`)}const vae=(i="")=>i.split(" ").filter(e=>!!e.trim()),Th=(i,e)=>{if(!i||!e)return!1;if(e.includes(" "))throw new Error("className should not contain space.");return i.classList.contains(e)},kp=(i,e)=>{!i||!e.trim()||i.classList.add(...vae(e))},Lc=(i,e)=>{!i||!e.trim()||i.classList.remove(...vae(e))},Cm=(i,e)=>{var t;if(!Ii||!i||!e)return"";let n=Sd(e);n==="float"&&(n="cssFloat");try{const r=i.style[n];if(r)return r;const s=(t=document.defaultView)==null?void 0:t.getComputedStyle(i,"");return s?s[n]:""}catch{return i.style[n]}};function Xs(i,e="px"){if(!i)return"";if(It(i)||MOe(i))return`${i}${e}`;if(Ft(i))return i}const ROe=(i,e)=>{if(!Ii)return!1;const t={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(e)],n=Cm(i,t);return["scroll","auto","overlay"].some(r=>n.includes(r))},i9=(i,e)=>{if(!Ii)return;let t=i;for(;t;){if([window,document,document.documentElement].includes(t))return window;if(ROe(t,e))return t;t=t.parentNode}return t};let jM;const yae=i=>{var e;if(!Ii)return 0;if(jM!==void 0)return jM;const t=document.createElement("div");t.className=`${i}-scrollbar__wrap`,t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const n=t.offsetWidth;t.style.overflow="scroll";const r=document.createElement("div");r.style.width="100%",t.appendChild(r);const s=r.offsetWidth;return(e=t.parentNode)==null||e.removeChild(t),jM=n-s,jM};function _ae(i,e){if(!Ii)return;if(!e){i.scrollTop=0;return}const t=[];let n=e.offsetParent;for(;n!==null&&i!==n&&i.contains(n);)t.push(n),n=n.offsetParent;const r=e.offsetTop+t.reduce((l,c)=>l+c.offsetTop,0),s=r+e.offsetHeight,a=i.scrollTop,o=a+i.clientHeight;r<a?i.scrollTop=r:s>o&&(i.scrollTop=s-i.clientHeight)}/*! Element Plus Icons Vue v2.0.10 */var en=(i,e)=>{let t=i.__vccOpts||i;for(let[n,r]of e)t[n]=r;return t},IOe={name:"ArrowDown"},$Oe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},LOe=Q("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1),DOe=[LOe];function kOe(i,e,t,n,r,s){return I(),Z("svg",$Oe,DOe)}var Fy=en(IOe,[["render",kOe],["__file","arrow-down.vue"]]),FOe={name:"ArrowLeft"},NOe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},VOe=Q("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"},null,-1),BOe=[VOe];function zOe(i,e,t,n,r,s){return I(),Z("svg",NOe,BOe)}var Ty=en(FOe,[["render",zOe],["__file","arrow-left.vue"]]),UOe={name:"ArrowRight"},HOe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},GOe=Q("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"},null,-1),WOe=[GOe];function jOe(i,e,t,n,r,s){return I(),Z("svg",HOe,WOe)}var Wl=en(UOe,[["render",jOe],["__file","arrow-right.vue"]]),qOe={name:"ArrowUp"},KOe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},YOe=Q("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0z"},null,-1),XOe=[YOe];function ZOe(i,e,t,n,r,s){return I(),Z("svg",KOe,XOe)}var A3=en(qOe,[["render",ZOe],["__file","arrow-up.vue"]]),QOe={name:"Back"},JOe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},eRe=Q("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64z"},null,-1),tRe=Q("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312L237.248 512z"},null,-1),iRe=[eRe,tRe];function nRe(i,e,t,n,r,s){return I(),Z("svg",JOe,iRe)}var rRe=en(QOe,[["render",nRe],["__file","back.vue"]]),sRe={name:"Calendar"},aRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},oRe=Q("path",{fill:"currentColor",d:"M128 384v512h768V192H768v32a32 32 0 1 1-64 0v-32H320v32a32 32 0 0 1-64 0v-32H128v128h768v64H128zm192-256h384V96a32 32 0 1 1 64 0v32h160a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h160V96a32 32 0 0 1 64 0v32zm-32 384h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64zm0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64zm192-192h64a32 32 0 0 1 0 64h-64a32 32 0 0 1 0-64zm0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64zm192-192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64zm0 192h64a32 32 0 1 1 0 64h-64a32 32 0 1 1 0-64z"},null,-1),lRe=[oRe];function cRe(i,e,t,n,r,s){return I(),Z("svg",aRe,lRe)}var uRe=en(sRe,[["render",cRe],["__file","calendar.vue"]]),dRe={name:"CaretRight"},hRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},pRe=Q("path",{fill:"currentColor",d:"M384 192v640l384-320.064z"},null,-1),fRe=[pRe];function mRe(i,e,t,n,r,s){return I(),Z("svg",hRe,fRe)}var bae=en(dRe,[["render",mRe],["__file","caret-right.vue"]]),gRe={name:"CaretTop"},vRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},yRe=Q("path",{fill:"currentColor",d:"M512 320 192 704h639.936z"},null,-1),_Re=[yRe];function bRe(i,e,t,n,r,s){return I(),Z("svg",vRe,_Re)}var wRe=en(gRe,[["render",bRe],["__file","caret-top.vue"]]),xRe={name:"Check"},CRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},TRe=Q("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1),SRe=[TRe];function ERe(i,e,t,n,r,s){return I(),Z("svg",CRe,SRe)}var sM=en(xRe,[["render",ERe],["__file","check.vue"]]),ARe={name:"CircleCheckFilled"},MRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},PRe=Q("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1),ORe=[PRe];function RRe(i,e,t,n,r,s){return I(),Z("svg",MRe,ORe)}var IRe=en(ARe,[["render",RRe],["__file","circle-check-filled.vue"]]),$Re={name:"CircleCheck"},LRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},DRe=Q("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),kRe=Q("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"},null,-1),FRe=[DRe,kRe];function NRe(i,e,t,n,r,s){return I(),Z("svg",LRe,FRe)}var n9=en($Re,[["render",NRe],["__file","circle-check.vue"]]),VRe={name:"CircleCloseFilled"},BRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},zRe=Q("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336L512 457.664z"},null,-1),URe=[zRe];function HRe(i,e,t,n,r,s){return I(),Z("svg",BRe,URe)}var r9=en(VRe,[["render",HRe],["__file","circle-close-filled.vue"]]),GRe={name:"CircleClose"},WRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},jRe=Q("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248L466.752 512z"},null,-1),qRe=Q("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),KRe=[jRe,qRe];function YRe(i,e,t,n,r,s){return I(),Z("svg",WRe,KRe)}var Ny=en(GRe,[["render",YRe],["__file","circle-close.vue"]]),XRe={name:"Clock"},ZRe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},QRe=Q("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768zm0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896z"},null,-1),JRe=Q("path",{fill:"currentColor",d:"M480 256a32 32 0 0 1 32 32v256a32 32 0 0 1-64 0V288a32 32 0 0 1 32-32z"},null,-1),eIe=Q("path",{fill:"currentColor",d:"M480 512h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32z"},null,-1),tIe=[QRe,JRe,eIe];function iIe(i,e,t,n,r,s){return I(),Z("svg",ZRe,tIe)}var wae=en(XRe,[["render",iIe],["__file","clock.vue"]]),nIe={name:"Close"},rIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},sIe=Q("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1),aIe=[sIe];function oIe(i,e,t,n,r,s){return I(),Z("svg",rIe,aIe)}var Rh=en(nIe,[["render",oIe],["__file","close.vue"]]),lIe={name:"DArrowLeft"},cIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},uIe=Q("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"},null,-1),dIe=[uIe];function hIe(i,e,t,n,r,s){return I(),Z("svg",cIe,dIe)}var rC=en(lIe,[["render",hIe],["__file","d-arrow-left.vue"]]),pIe={name:"DArrowRight"},fIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},mIe=Q("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688zm-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"},null,-1),gIe=[mIe];function vIe(i,e,t,n,r,s){return I(),Z("svg",fIe,gIe)}var sC=en(pIe,[["render",vIe],["__file","d-arrow-right.vue"]]),yIe={name:"Delete"},_Ie={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},bIe=Q("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1),wIe=[bIe];function xIe(i,e,t,n,r,s){return I(),Z("svg",_Ie,wIe)}var CIe=en(yIe,[["render",xIe],["__file","delete.vue"]]),TIe={name:"Document"},SIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},EIe=Q("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640V384zm-26.496-64L640 154.496V320h165.504zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32zm160 448h384v64H320v-64zm0-192h160v64H320v-64zm0 384h384v64H320v-64z"},null,-1),AIe=[EIe];function MIe(i,e,t,n,r,s){return I(),Z("svg",SIe,AIe)}var PIe=en(TIe,[["render",MIe],["__file","document.vue"]]),OIe={name:"FullScreen"},RIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},IIe=Q("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1),$Ie=[IIe];function LIe(i,e,t,n,r,s){return I(),Z("svg",RIe,$Ie)}var DIe=en(OIe,[["render",LIe],["__file","full-screen.vue"]]),kIe={name:"Hide"},FIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},NIe=Q("path",{d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2L371.2 588.8ZM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z",fill:"currentColor"},null,-1),VIe=Q("path",{d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z",fill:"currentColor"},null,-1),BIe=[NIe,VIe];function zIe(i,e,t,n,r,s){return I(),Z("svg",FIe,BIe)}var UIe=en(kIe,[["render",zIe],["__file","hide.vue"]]),HIe={name:"InfoFilled"},GIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},WIe=Q("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1),jIe=[WIe];function qIe(i,e,t,n,r,s){return I(),Z("svg",GIe,jIe)}var s9=en(HIe,[["render",qIe],["__file","info-filled.vue"]]),KIe={name:"Loading"},YIe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},XIe=Q("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"},null,-1),ZIe=[XIe];function QIe(i,e,t,n,r,s){return I(),Z("svg",YIe,ZIe)}var Vy=en(KIe,[["render",QIe],["__file","loading.vue"]]),JIe={name:"Minus"},e$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},t$e=Q("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64z"},null,-1),i$e=[t$e];function n$e(i,e,t,n,r,s){return I(),Z("svg",e$e,i$e)}var r$e=en(JIe,[["render",n$e],["__file","minus.vue"]]),s$e={name:"MoreFilled"},a$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},o$e=Q("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224z"},null,-1),l$e=[o$e];function c$e(i,e,t,n,r,s){return I(),Z("svg",a$e,l$e)}var Kj=en(s$e,[["render",c$e],["__file","more-filled.vue"]]),u$e={name:"More"},d$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},h$e=Q("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96zm336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224zm0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96z"},null,-1),p$e=[h$e];function f$e(i,e,t,n,r,s){return I(),Z("svg",d$e,p$e)}var m$e=en(u$e,[["render",f$e],["__file","more.vue"]]),g$e={name:"PictureFilled"},v$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},y$e=Q("path",{fill:"currentColor",d:"M96 896a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h832a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32H96zm315.52-228.48-68.928-68.928a32 32 0 0 0-45.248 0L128 768.064h778.688l-242.112-290.56a32 32 0 0 0-49.216 0L458.752 665.408a32 32 0 0 1-47.232 2.112zM256 384a96 96 0 1 0 192.064-.064A96 96 0 0 0 256 384z"},null,-1),_$e=[y$e];function b$e(i,e,t,n,r,s){return I(),Z("svg",v$e,_$e)}var w$e=en(g$e,[["render",b$e],["__file","picture-filled.vue"]]),x$e={name:"Plus"},C$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},T$e=Q("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1),S$e=[T$e];function E$e(i,e,t,n,r,s){return I(),Z("svg",C$e,S$e)}var xae=en(x$e,[["render",E$e],["__file","plus.vue"]]),A$e={name:"QuestionFilled"},M$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},P$e=Q("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm23.744 191.488c-52.096 0-92.928 14.784-123.2 44.352-30.976 29.568-45.76 70.4-45.76 122.496h80.256c0-29.568 5.632-52.8 17.6-68.992 13.376-19.712 35.2-28.864 66.176-28.864 23.936 0 42.944 6.336 56.32 19.712 12.672 13.376 19.712 31.68 19.712 54.912 0 17.6-6.336 34.496-19.008 49.984l-8.448 9.856c-45.76 40.832-73.216 70.4-82.368 89.408-9.856 19.008-14.08 42.24-14.08 68.992v9.856h80.96v-9.856c0-16.896 3.52-31.68 10.56-45.76 6.336-12.672 15.488-24.64 28.16-35.2 33.792-29.568 54.208-48.576 60.544-55.616 16.896-22.528 26.048-51.392 26.048-86.592 0-42.944-14.08-76.736-42.24-101.376-28.16-25.344-65.472-37.312-111.232-37.312zm-12.672 406.208a54.272 54.272 0 0 0-38.72 14.784 49.408 49.408 0 0 0-15.488 38.016c0 15.488 4.928 28.16 15.488 38.016A54.848 54.848 0 0 0 523.072 768c15.488 0 28.16-4.928 38.72-14.784a51.52 51.52 0 0 0 16.192-38.72 51.968 51.968 0 0 0-15.488-38.016 55.936 55.936 0 0 0-39.424-14.784z"},null,-1),O$e=[P$e];function R$e(i,e,t,n,r,s){return I(),Z("svg",M$e,O$e)}var I$e=en(A$e,[["render",R$e],["__file","question-filled.vue"]]),$$e={name:"RefreshLeft"},L$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},D$e=Q("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"},null,-1),k$e=[D$e];function F$e(i,e,t,n,r,s){return I(),Z("svg",L$e,k$e)}var N$e=en($$e,[["render",F$e],["__file","refresh-left.vue"]]),V$e={name:"RefreshRight"},B$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},z$e=Q("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"},null,-1),U$e=[z$e];function H$e(i,e,t,n,r,s){return I(),Z("svg",B$e,U$e)}var G$e=en(V$e,[["render",H$e],["__file","refresh-right.vue"]]),W$e={name:"ScaleToOriginal"},j$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},q$e=Q("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zM512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412zM512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512z"},null,-1),K$e=[q$e];function Y$e(i,e,t,n,r,s){return I(),Z("svg",j$e,K$e)}var X$e=en(W$e,[["render",Y$e],["__file","scale-to-original.vue"]]),Z$e={name:"Search"},Q$e={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},J$e=Q("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1),eLe=[J$e];function tLe(i,e,t,n,r,s){return I(),Z("svg",Q$e,eLe)}var iLe=en(Z$e,[["render",tLe],["__file","search.vue"]]),nLe={name:"SortDown"},rLe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},sLe=Q("path",{fill:"currentColor",d:"M576 96v709.568L333.312 562.816A32 32 0 1 0 288 608l297.408 297.344A32 32 0 0 0 640 882.688V96a32 32 0 0 0-64 0z"},null,-1),aLe=[sLe];function oLe(i,e,t,n,r,s){return I(),Z("svg",rLe,aLe)}var lLe=en(nLe,[["render",oLe],["__file","sort-down.vue"]]),cLe={name:"SortUp"},uLe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},dLe=Q("path",{fill:"currentColor",d:"M384 141.248V928a32 32 0 1 0 64 0V218.56l242.688 242.688A32 32 0 1 0 736 416L438.592 118.656A32 32 0 0 0 384 141.248z"},null,-1),hLe=[dLe];function pLe(i,e,t,n,r,s){return I(),Z("svg",uLe,hLe)}var fLe=en(cLe,[["render",pLe],["__file","sort-up.vue"]]),mLe={name:"StarFilled"},gLe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},vLe=Q("path",{fill:"currentColor",d:"M283.84 867.84 512 747.776l228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72z"},null,-1),yLe=[vLe];function _Le(i,e,t,n,r,s){return I(),Z("svg",gLe,yLe)}var qM=en(mLe,[["render",_Le],["__file","star-filled.vue"]]),bLe={name:"Star"},wLe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},xLe=Q("path",{fill:"currentColor",d:"m512 747.84 228.16 119.936a6.4 6.4 0 0 0 9.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 0 0-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 0 0-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 0 0-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 0 0 9.28 6.72L512 747.84zM313.6 924.48a70.4 70.4 0 0 1-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 0 1 128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 0 1 126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0 1 39.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 0 1-102.144 74.24L512 820.096l-198.4 104.32z"},null,-1),CLe=[xLe];function TLe(i,e,t,n,r,s){return I(),Z("svg",wLe,CLe)}var SLe=en(bLe,[["render",TLe],["__file","star.vue"]]),ELe={name:"SuccessFilled"},ALe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},MLe=Q("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336L456.192 600.384z"},null,-1),PLe=[MLe];function OLe(i,e,t,n,r,s){return I(),Z("svg",ALe,PLe)}var Cae=en(ELe,[["render",OLe],["__file","success-filled.vue"]]),RLe={name:"View"},ILe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},$Le=Q("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1),LLe=[$Le];function DLe(i,e,t,n,r,s){return I(),Z("svg",ILe,LLe)}var kLe=en(RLe,[["render",DLe],["__file","view.vue"]]),FLe={name:"WarningFilled"},NLe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},VLe=Q("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896zm0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256zm0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4z"},null,-1),BLe=[VLe];function zLe(i,e,t,n,r,s){return I(),Z("svg",NLe,BLe)}var M3=en(FLe,[["render",zLe],["__file","warning-filled.vue"]]),ULe={name:"ZoomIn"},HLe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},GLe=Q("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zm-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64h96z"},null,-1),WLe=[GLe];function jLe(i,e,t,n,r,s){return I(),Z("svg",HLe,WLe)}var Tae=en(ULe,[["render",jLe],["__file","zoom-in.vue"]]),qLe={name:"ZoomOut"},KLe={viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},YLe=Q("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704zM352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64z"},null,-1),XLe=[YLe];function ZLe(i,e,t,n,r,s){return I(),Z("svg",KLe,XLe)}var QLe=en(qLe,[["render",ZLe],["__file","zoom-out.vue"]]);const Sae="__epPropKey",xe=i=>i,JLe=i=>oi(i)&&!!i[Sae],Fh=(i,e)=>{if(!oi(i)||JLe(i))return i;const{values:t,required:n,default:r,type:s,validator:a}=i,l={type:s,required:!!n,validator:t||a?c=>{let u=!1,d=[];if(t&&(d=Array.from(t),Ci(i,"default")&&d.push(r),u||(u=d.includes(c))),a&&(u||(u=a(c))),!u&&d.length>0){const h=[...new Set(d)].map(p=>JSON.stringify(p)).join(", ");aCe(`Invalid prop: validation failed${e?` for prop "${e}"`:""}. Expected one of [${h}], got value ${JSON.stringify(c)}.`)}return u}:void 0,[Sae]:!0};return Ci(i,"default")&&(l.default=r),l},Ke=i=>cae(Object.entries(i).map(([e,t])=>[e,Fh(t,e)])),Zn=xe([String,Object,Function]),Eae={Close:Rh},a9={Close:Rh,SuccessFilled:Cae,InfoFilled:s9,WarningFilled:M3,CircleCloseFilled:r9},Sy={success:Cae,warning:M3,error:r9,info:s9},Aae={validating:Vy,success:n9,error:Ny},ii=(i,e)=>{if(i.install=t=>{for(const n of[i,...Object.values(e??{})])t.component(n.name,n)},e)for(const[t,n]of Object.entries(e))i[t]=n;return i},Mae=(i,e)=>(i.install=t=>{i._context=t._context,t.config.globalProperties[e]=i},i),e3e=(i,e)=>(i.install=t=>{t.directive(e,i)},i),Wr=i=>(i.install=yn,i),P3=(...i)=>e=>{i.forEach(t=>{Lt(t)?t(e):t.value=e})},wt={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},t3e=["year","month","date","dates","week","datetime","datetimerange","daterange","monthrange"],gk=["sun","mon","tue","wed","thu","fri","sat"],ri="update:modelValue",rr="change",jl="input",Yj=Symbol("INSTALLED_KEY"),gg=["","default","small","large"],i3e={large:40,default:32,small:24},n3e=i=>i3e[i||"default"],aM=i=>["",...gg].includes(i);var id=(i=>(i[i.TEXT=1]="TEXT",i[i.CLASS=2]="CLASS",i[i.STYLE=4]="STYLE",i[i.PROPS=8]="PROPS",i[i.FULL_PROPS=16]="FULL_PROPS",i[i.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",i[i.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",i[i.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",i[i.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",i[i.NEED_PATCH=512]="NEED_PATCH",i[i.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",i[i.HOISTED=-1]="HOISTED",i[i.BAIL=-2]="BAIL",i))(id||{});function R5(i){return Pr(i)&&i.type===gt}function r3e(i){return Pr(i)&&i.type===Gl}function s3e(i){return Pr(i)&&!R5(i)&&!r3e(i)}const a3e=i=>{if(!Pr(i))return{};const e=i.props||{},t=(Pr(i.type)?i.type.props:void 0)||{},n={};return Object.keys(t).forEach(r=>{Ci(t[r],"default")&&(n[r]=t[r].default)}),Object.keys(e).forEach(r=>{n[Sd(r)]=e[r]}),n},o3e=i=>{if(!st(i)||i.length>1)throw new Error("expect to receive a single Vue element child");return i[0]},gx=i=>{const e=st(i)?i:[i],t=[];return e.forEach(n=>{var r;st(n)?t.push(...gx(n)):Pr(n)&&st(n.children)?t.push(...gx(n.children)):(t.push(n),Pr(n)&&((r=n.component)!=null&&r.subTree)&&t.push(...gx(n.component.subTree)))}),t},Xj=i=>i**3,l3e=i=>i<.5?Xj(i*2)/2:1-Xj((1-i)*2)/2,Zj=i=>[...new Set(i)],Rm=i=>!i&&i!==0?[]:Array.isArray(i)?i:[i],o9=()=>Ii&&/firefox/i.test(window.navigator.userAgent),O3=i=>/([(\uAC00-\uD7AF)|(\u3130-\u318F)])+/gi.test(i),U2=i=>Ii?window.requestAnimationFrame(i):setTimeout(i,16),R3=i=>Ii?window.cancelAnimationFrame(i):clearTimeout(i),I3=()=>Math.floor(Math.random()*1e4),Ar=i=>i,c3e=["class","style"],u3e=/^on[A-Z]/,l9=(i={})=>{const{excludeListeners:e=!1,excludeKeys:t}=i,n=R(()=>((t==null?void 0:t.value)||[]).concat(c3e)),r=ti();return R(r?()=>{var s;return cae(Object.entries((s=r.proxy)==null?void 0:s.$attrs).filter(([a])=>!n.value.includes(a)&&!(e&&u3e.test(a))))}:()=>({}))},Pae=Symbol("breadcrumbKey"),Oae=Symbol("buttonGroupContextKey"),Rae=Symbol("carouselContextKey"),UC=Symbol("checkboxGroupContextKey"),Iae=Symbol("collapseContextKey"),$ae=Symbol(),Lae=Symbol("dialogInjectionKey"),Rb=Symbol("formContextKey"),uf=Symbol("formItemContextKey"),Dae=Symbol("elPaginationKey"),kae=Symbol("radioGroupKey"),Fae=Symbol("rowContextKey"),Nae=Symbol("scrollbarContextKey"),Vae=Symbol("sliderContextKey"),$3=Symbol("tabsRootContextKey"),Bae=Symbol("uploadContextKey"),c9=Symbol("popper"),zae=Symbol("popperContent"),L3=Symbol("elTooltip"),D3=Symbol("tooltipV2"),Uae=Symbol("tooltipV2Content"),vk="tooltip_v2.open",u9=Symbol(),Hae=i=>{const e=ti();return R(()=>{var t,n;return(n=((t=e.proxy)==null?void 0:t.$props)[i])!=null?n:void 0})},c$=W();function vg(i,e=void 0){const t=ti()?ht($ae,c$):c$;return i?R(()=>{var n,r;return(r=(n=t.value)==null?void 0:n[i])!=null?r:e}):t}const Gae=(i,e,t=!1)=>{var n;const r=!!ti(),s=r?vg():void 0,a=(n=e==null?void 0:e.provide)!=null?n:r?pi:void 0;if(!a)return;const o=R(()=>{const l=v(i);return s!=null&&s.value?d3e(s.value,l):l});return a($ae,o),(t||!c$.value)&&(c$.value=o.value),o},d3e=(i,e)=>{var t;const n=[...new Set([...z2(i),...z2(e)])],r={};for(const s of n)r[s]=(t=e[s])!=null?t:i[s];return r},Ql=Fh({type:String,values:gg,required:!1}),Qs=(i,e={})=>{const t=W(void 0),n=e.prop?t:Hae("size"),r=e.global?t:vg("size"),s=e.form?{size:void 0}:ht(Rb,void 0),a=e.formItem?{size:void 0}:ht(uf,void 0);return R(()=>n.value||v(i)||(a==null?void 0:a.size)||(s==null?void 0:s.size)||r.value||"")},zc=i=>{const e=Hae("disabled"),t=ht(Rb,void 0);return R(()=>e.value||v(i)||(t==null?void 0:t.disabled)||!1)},Ym=({from:i,replacement:e,scope:t,version:n,ref:r,type:s="API"},a)=>{Ve(()=>v(a),o=>{},{immediate:!0})},Wae=(i,e,t)=>{let n={offsetX:0,offsetY:0};const r=o=>{const l=o.clientX,c=o.clientY,{offsetX:u,offsetY:d}=n,h=i.value.getBoundingClientRect(),p=h.left,m=h.top,g=h.width,_=h.height,b=document.documentElement.clientWidth,x=document.documentElement.clientHeight,w=-p+u,C=-m+d,S=b-p-g+u,E=x-m-_+d,A=O=>{const M=Math.min(Math.max(u+O.clientX-l,w),S),V=Math.min(Math.max(d+O.clientY-c,C),E);n={offsetX:M,offsetY:V},i.value.style.transform=`translate(${Xs(M)}, ${Xs(V)})`},P=()=>{document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",P)};document.addEventListener("mousemove",A),document.addEventListener("mouseup",P)},s=()=>{e.value&&i.value&&e.value.addEventListener("mousedown",r)},a=()=>{e.value&&i.value&&e.value.removeEventListener("mousedown",r)};qt(()=>{Ru(()=>{t.value?s():a()})}),Vr(()=>{a()})},h3e=i=>({focus:()=>{var e,t;(t=(e=i.value)==null?void 0:e.focus)==null||t.call(e)}}),k3="el",p3e="is-",Xy=(i,e,t,n,r)=>{let s=`${i}-${e}`;return t&&(s+=`-${t}`),n&&(s+=`__${n}`),r&&(s+=`--${r}`),s},Ne=i=>{const e=vg("namespace",k3);return{namespace:e,b:(m="")=>Xy(e.value,i,m,"",""),e:m=>m?Xy(e.value,i,"",m,""):"",m:m=>m?Xy(e.value,i,"","",m):"",be:(m,g)=>m&&g?Xy(e.value,i,m,g,""):"",em:(m,g)=>m&&g?Xy(e.value,i,"",m,g):"",bm:(m,g)=>m&&g?Xy(e.value,i,m,"",g):"",bem:(m,g,_)=>m&&g&&_?Xy(e.value,i,m,g,_):"",is:(m,...g)=>{const _=g.length>=1?g[0]:!0;return m&&_?`${p3e}${m}`:""},cssVar:m=>{const g={};for(const _ in m)m[_]&&(g[`--${e.value}-${_}`]=m[_]);return g},cssVarName:m=>`--${e.value}-${m}`,cssVarBlock:m=>{const g={};for(const _ in m)m[_]&&(g[`--${e.value}-${i}-${_}`]=m[_]);return g},cssVarBlockName:m=>`--${e.value}-${i}-${m}`}},Qj={prefix:Math.floor(Math.random()*1e4),current:0},f3e=Symbol("elIdInjection"),jae=()=>ti()?ht(f3e,Qj):Qj,Ih=i=>{const e=jae(),t=vg("namespace",k3);return R(()=>v(i)||`${t.value}-id-${e.prefix}-${e.current++}`)},nc=()=>{const i=ht(Rb,void 0),e=ht(uf,void 0);return{form:i,formItem:e}},By=(i,{formItemContext:e,disableIdGeneration:t,disableIdManagement:n})=>{t||(t=W(!1)),n||(n=W(!1));const r=W();let s;const a=R(()=>{var o;return!!(!i.label&&e&&e.inputIds&&((o=e.inputIds)==null?void 0:o.length)<=1)});return qt(()=>{s=Ve([kr(i,"id"),t],([o,l])=>{const c=o??(l?void 0:Ih().value);c!==r.value&&(e!=null&&e.removeInputId&&(r.value&&e.removeInputId(r.value),!(n!=null&&n.value)&&!l&&c&&e.addInputId(c)),r.value=c)},{immediate:!0})}),ky(()=>{s&&s(),e!=null&&e.removeInputId&&r.value&&e.removeInputId(r.value)}),{isLabeledByFormItem:a,inputId:r}};var m3e={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"}}};const g3e=i=>(e,t)=>v3e(e,t,v(i)),v3e=(i,e,t)=>Tr(t,i,i).replace(/\{(\w+)\}/g,(n,r)=>{var s;return`${(s=e==null?void 0:e[r])!=null?s:`{${r}}`}`}),y3e=i=>{const e=R(()=>v(i).name),t=Vn(i)?i:W(i);return{lang:e,locale:t,t:g3e(i)}},Ki=()=>{const i=vg("locale");return y3e(R(()=>i.value||m3e))},qae=i=>{Vn(i)||ba("[useLockscreen]","You need to pass a ref param to this function");const e=Ne("popup"),t=Hre(()=>e.bm("parent","hidden"));if(!Ii||Th(document.body,t.value))return;let n=0,r=!1,s="0";const a=()=>{setTimeout(()=>{Lc(document.body,t.value),r&&(document.body.style.width=s)},200)};Ve(i,o=>{if(!o){a();return}r=!Th(document.body,t.value),r&&(s=document.body.style.width),n=yae(e.namespace.value);const l=document.documentElement.clientHeight<document.body.scrollHeight,c=Cm(document.body,"overflowY");n>0&&(l||c==="scroll")&&r&&(document.body.style.width=`calc(100% - ${n}px)`),kp(document.body,t.value)}),Ere(()=>a())},_3e=Fh({type:xe(Boolean),default:null}),b3e=Fh({type:xe(Function)}),w3e=i=>{const e=`update:${i}`,t=`onUpdate:${i}`,n=[e],r={[i]:_3e,[t]:b3e};return{useModelToggle:({indicator:a,toggleReason:o,shouldHideWhenRouteChanges:l,shouldProceed:c,onShow:u,onHide:d})=>{const h=ti(),{emit:p}=h,m=h.props,g=R(()=>Lt(m[t])),_=R(()=>m[i]===null),b=A=>{a.value!==!0&&(a.value=!0,o&&(o.value=A),Lt(u)&&u(A))},x=A=>{a.value!==!1&&(a.value=!1,o&&(o.value=A),Lt(d)&&d(A))},w=A=>{if(m.disabled===!0||Lt(c)&&!c())return;const P=g.value&&Ii;P&&p(e,!0),(_.value||!P)&&b(A)},C=A=>{if(m.disabled===!0||!Ii)return;const P=g.value&&Ii;P&&p(e,!1),(_.value||!P)&&x(A)},S=A=>{Ys(A)&&(m.disabled&&A?g.value&&p(e,!1):a.value!==A&&(A?b():x()))},E=()=>{a.value?C():w()};return Ve(()=>m[i],S),l&&h.appContext.config.globalProperties.$route!==void 0&&Ve(()=>({...h.proxy.$route}),()=>{l.value&&a.value&&C()}),qt(()=>{S(m[i])}),{hide:C,show:w,toggle:E,hasUpdateHandler:g}},useModelToggleProps:r,useModelToggleEmits:n}};var Dc="top",Ad="bottom",Md="right",kc="left",d9="auto",oM=[Dc,Ad,Md,kc],aC="start",H2="end",x3e="clippingParents",Kae="viewport",mT="popper",C3e="reference",Jj=oM.reduce(function(i,e){return i.concat([e+"-"+aC,e+"-"+H2])},[]),Ib=[].concat(oM,[d9]).reduce(function(i,e){return i.concat([e,e+"-"+aC,e+"-"+H2])},[]),T3e="beforeRead",S3e="read",E3e="afterRead",A3e="beforeMain",M3e="main",P3e="afterMain",O3e="beforeWrite",R3e="write",I3e="afterWrite",$3e=[T3e,S3e,E3e,A3e,M3e,P3e,O3e,R3e,I3e];function df(i){return i?(i.nodeName||"").toLowerCase():null}function Nh(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var e=i.ownerDocument;return e&&e.defaultView||window}return i}function oC(i){var e=Nh(i).Element;return i instanceof e||i instanceof Element}function Td(i){var e=Nh(i).HTMLElement;return i instanceof e||i instanceof HTMLElement}function h9(i){if(typeof ShadowRoot>"u")return!1;var e=Nh(i).ShadowRoot;return i instanceof e||i instanceof ShadowRoot}function L3e(i){var e=i.state;Object.keys(e.elements).forEach(function(t){var n=e.styles[t]||{},r=e.attributes[t]||{},s=e.elements[t];!Td(s)||!df(s)||(Object.assign(s.style,n),Object.keys(r).forEach(function(a){var o=r[a];o===!1?s.removeAttribute(a):s.setAttribute(a,o===!0?"":o)}))})}function D3e(i){var e=i.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(n){var r=e.elements[n],s=e.attributes[n]||{},a=Object.keys(e.styles.hasOwnProperty(n)?e.styles[n]:t[n]),o=a.reduce(function(l,c){return l[c]="",l},{});!Td(r)||!df(r)||(Object.assign(r.style,o),Object.keys(s).forEach(function(l){r.removeAttribute(l)}))})}}var Yae={name:"applyStyles",enabled:!0,phase:"write",fn:L3e,effect:D3e,requires:["computeStyles"]};function qp(i){return i.split("-")[0]}var B0=Math.max,u$=Math.min,lC=Math.round;function cC(i,e){e===void 0&&(e=!1);var t=i.getBoundingClientRect(),n=1,r=1;if(Td(i)&&e){var s=i.offsetHeight,a=i.offsetWidth;a>0&&(n=lC(t.width)/a||1),s>0&&(r=lC(t.height)/s||1)}return{width:t.width/n,height:t.height/r,top:t.top/r,right:t.right/n,bottom:t.bottom/r,left:t.left/n,x:t.left/n,y:t.top/r}}function p9(i){var e=cC(i),t=i.offsetWidth,n=i.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-n)<=1&&(n=e.height),{x:i.offsetLeft,y:i.offsetTop,width:t,height:n}}function Xae(i,e){var t=e.getRootNode&&e.getRootNode();if(i.contains(e))return!0;if(t&&h9(t)){var n=e;do{if(n&&i.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function Xm(i){return Nh(i).getComputedStyle(i)}function k3e(i){return["table","td","th"].indexOf(df(i))>=0}function zy(i){return((oC(i)?i.ownerDocument:i.document)||window.document).documentElement}function F3(i){return df(i)==="html"?i:i.assignedSlot||i.parentNode||(h9(i)?i.host:null)||zy(i)}function eq(i){return!Td(i)||Xm(i).position==="fixed"?null:i.offsetParent}function F3e(i){var e=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,t=navigator.userAgent.indexOf("Trident")!==-1;if(t&&Td(i)){var n=Xm(i);if(n.position==="fixed")return null}var r=F3(i);for(h9(r)&&(r=r.host);Td(r)&&["html","body"].indexOf(df(r))<0;){var s=Xm(r);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return r;r=r.parentNode}return null}function lM(i){for(var e=Nh(i),t=eq(i);t&&k3e(t)&&Xm(t).position==="static";)t=eq(t);return t&&(df(t)==="html"||df(t)==="body"&&Xm(t).position==="static")?e:t||F3e(i)||e}function f9(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function pE(i,e,t){return B0(i,u$(e,t))}function N3e(i,e,t){var n=pE(i,e,t);return n>t?t:n}function Zae(){return{top:0,right:0,bottom:0,left:0}}function Qae(i){return Object.assign({},Zae(),i)}function Jae(i,e){return e.reduce(function(t,n){return t[n]=i,t},{})}var V3e=function(i,e){return i=typeof i=="function"?i(Object.assign({},e.rects,{placement:e.placement})):i,Qae(typeof i!="number"?i:Jae(i,oM))};function B3e(i){var e,t=i.state,n=i.name,r=i.options,s=t.elements.arrow,a=t.modifiersData.popperOffsets,o=qp(t.placement),l=f9(o),c=[kc,Md].indexOf(o)>=0,u=c?"height":"width";if(!(!s||!a)){var d=V3e(r.padding,t),h=p9(s),p=l==="y"?Dc:kc,m=l==="y"?Ad:Md,g=t.rects.reference[u]+t.rects.reference[l]-a[l]-t.rects.popper[u],_=a[l]-t.rects.reference[l],b=lM(s),x=b?l==="y"?b.clientHeight||0:b.clientWidth||0:0,w=g/2-_/2,C=d[p],S=x-h[u]-d[m],E=x/2-h[u]/2+w,A=pE(C,E,S),P=l;t.modifiersData[n]=(e={},e[P]=A,e.centerOffset=A-E,e)}}function z3e(i){var e=i.state,t=i.options,n=t.element,r=n===void 0?"[data-popper-arrow]":n;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||!Xae(e.elements.popper,r)||(e.elements.arrow=r))}var U3e={name:"arrow",enabled:!0,phase:"main",fn:B3e,effect:z3e,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function uC(i){return i.split("-")[1]}var H3e={top:"auto",right:"auto",bottom:"auto",left:"auto"};function G3e(i){var e=i.x,t=i.y,n=window,r=n.devicePixelRatio||1;return{x:lC(e*r)/r||0,y:lC(t*r)/r||0}}function tq(i){var e,t=i.popper,n=i.popperRect,r=i.placement,s=i.variation,a=i.offsets,o=i.position,l=i.gpuAcceleration,c=i.adaptive,u=i.roundOffsets,d=i.isFixed,h=a.x,p=h===void 0?0:h,m=a.y,g=m===void 0?0:m,_=typeof u=="function"?u({x:p,y:g}):{x:p,y:g};p=_.x,g=_.y;var b=a.hasOwnProperty("x"),x=a.hasOwnProperty("y"),w=kc,C=Dc,S=window;if(c){var E=lM(t),A="clientHeight",P="clientWidth";if(E===Nh(t)&&(E=zy(t),Xm(E).position!=="static"&&o==="absolute"&&(A="scrollHeight",P="scrollWidth")),E=E,r===Dc||(r===kc||r===Md)&&s===H2){C=Ad;var O=d&&E===S&&S.visualViewport?S.visualViewport.height:E[A];g-=O-n.height,g*=l?1:-1}if(r===kc||(r===Dc||r===Ad)&&s===H2){w=Md;var M=d&&E===S&&S.visualViewport?S.visualViewport.width:E[P];p-=M-n.width,p*=l?1:-1}}var V=Object.assign({position:o},c&&H3e),L=u===!0?G3e({x:p,y:g}):{x:p,y:g};if(p=L.x,g=L.y,l){var U;return Object.assign({},V,(U={},U[C]=x?"0":"",U[w]=b?"0":"",U.transform=(S.devicePixelRatio||1)<=1?"translate("+p+"px, "+g+"px)":"translate3d("+p+"px, "+g+"px, 0)",U))}return Object.assign({},V,(e={},e[C]=x?g+"px":"",e[w]=b?p+"px":"",e.transform="",e))}function W3e(i){var e=i.state,t=i.options,n=t.gpuAcceleration,r=n===void 0?!0:n,s=t.adaptive,a=s===void 0?!0:s,o=t.roundOffsets,l=o===void 0?!0:o,c={placement:qp(e.placement),variation:uC(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,tq(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,tq(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var eoe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:W3e,data:{}},KM={passive:!0};function j3e(i){var e=i.state,t=i.instance,n=i.options,r=n.scroll,s=r===void 0?!0:r,a=n.resize,o=a===void 0?!0:a,l=Nh(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&c.forEach(function(u){u.addEventListener("scroll",t.update,KM)}),o&&l.addEventListener("resize",t.update,KM),function(){s&&c.forEach(function(u){u.removeEventListener("scroll",t.update,KM)}),o&&l.removeEventListener("resize",t.update,KM)}}var toe={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:j3e,data:{}},q3e={left:"right",right:"left",bottom:"top",top:"bottom"};function gR(i){return i.replace(/left|right|bottom|top/g,function(e){return q3e[e]})}var K3e={start:"end",end:"start"};function iq(i){return i.replace(/start|end/g,function(e){return K3e[e]})}function m9(i){var e=Nh(i),t=e.pageXOffset,n=e.pageYOffset;return{scrollLeft:t,scrollTop:n}}function g9(i){return cC(zy(i)).left+m9(i).scrollLeft}function Y3e(i){var e=Nh(i),t=zy(i),n=e.visualViewport,r=t.clientWidth,s=t.clientHeight,a=0,o=0;return n&&(r=n.width,s=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=n.offsetLeft,o=n.offsetTop)),{width:r,height:s,x:a+g9(i),y:o}}function X3e(i){var e,t=zy(i),n=m9(i),r=(e=i.ownerDocument)==null?void 0:e.body,s=B0(t.scrollWidth,t.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=B0(t.scrollHeight,t.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),o=-n.scrollLeft+g9(i),l=-n.scrollTop;return Xm(r||t).direction==="rtl"&&(o+=B0(t.clientWidth,r?r.clientWidth:0)-s),{width:s,height:a,x:o,y:l}}function v9(i){var e=Xm(i),t=e.overflow,n=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+r+n)}function ioe(i){return["html","body","#document"].indexOf(df(i))>=0?i.ownerDocument.body:Td(i)&&v9(i)?i:ioe(F3(i))}function fE(i,e){var t;e===void 0&&(e=[]);var n=ioe(i),r=n===((t=i.ownerDocument)==null?void 0:t.body),s=Nh(n),a=r?[s].concat(s.visualViewport||[],v9(n)?n:[]):n,o=e.concat(a);return r?o:o.concat(fE(F3(a)))}function I5(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function Z3e(i){var e=cC(i);return e.top=e.top+i.clientTop,e.left=e.left+i.clientLeft,e.bottom=e.top+i.clientHeight,e.right=e.left+i.clientWidth,e.width=i.clientWidth,e.height=i.clientHeight,e.x=e.left,e.y=e.top,e}function nq(i,e){return e===Kae?I5(Y3e(i)):oC(e)?Z3e(e):I5(X3e(zy(i)))}function Q3e(i){var e=fE(F3(i)),t=["absolute","fixed"].indexOf(Xm(i).position)>=0,n=t&&Td(i)?lM(i):i;return oC(n)?e.filter(function(r){return oC(r)&&Xae(r,n)&&df(r)!=="body"}):[]}function J3e(i,e,t){var n=e==="clippingParents"?Q3e(i):[].concat(e),r=[].concat(n,[t]),s=r[0],a=r.reduce(function(o,l){var c=nq(i,l);return o.top=B0(c.top,o.top),o.right=u$(c.right,o.right),o.bottom=u$(c.bottom,o.bottom),o.left=B0(c.left,o.left),o},nq(i,s));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function noe(i){var e=i.reference,t=i.element,n=i.placement,r=n?qp(n):null,s=n?uC(n):null,a=e.x+e.width/2-t.width/2,o=e.y+e.height/2-t.height/2,l;switch(r){case Dc:l={x:a,y:e.y-t.height};break;case Ad:l={x:a,y:e.y+e.height};break;case Md:l={x:e.x+e.width,y:o};break;case kc:l={x:e.x-t.width,y:o};break;default:l={x:e.x,y:e.y}}var c=r?f9(r):null;if(c!=null){var u=c==="y"?"height":"width";switch(s){case aC:l[c]=l[c]-(e[u]/2-t[u]/2);break;case H2:l[c]=l[c]+(e[u]/2-t[u]/2);break}}return l}function G2(i,e){e===void 0&&(e={});var t=e,n=t.placement,r=n===void 0?i.placement:n,s=t.boundary,a=s===void 0?x3e:s,o=t.rootBoundary,l=o===void 0?Kae:o,c=t.elementContext,u=c===void 0?mT:c,d=t.altBoundary,h=d===void 0?!1:d,p=t.padding,m=p===void 0?0:p,g=Qae(typeof m!="number"?m:Jae(m,oM)),_=u===mT?C3e:mT,b=i.rects.popper,x=i.elements[h?_:u],w=J3e(oC(x)?x:x.contextElement||zy(i.elements.popper),a,l),C=cC(i.elements.reference),S=noe({reference:C,element:b,strategy:"absolute",placement:r}),E=I5(Object.assign({},b,S)),A=u===mT?E:C,P={top:w.top-A.top+g.top,bottom:A.bottom-w.bottom+g.bottom,left:w.left-A.left+g.left,right:A.right-w.right+g.right},O=i.modifiersData.offset;if(u===mT&&O){var M=O[r];Object.keys(P).forEach(function(V){var L=[Md,Ad].indexOf(V)>=0?1:-1,U=[Dc,Ad].indexOf(V)>=0?"y":"x";P[V]+=M[U]*L})}return P}function eDe(i,e){e===void 0&&(e={});var t=e,n=t.placement,r=t.boundary,s=t.rootBoundary,a=t.padding,o=t.flipVariations,l=t.allowedAutoPlacements,c=l===void 0?Ib:l,u=uC(n),d=u?o?Jj:Jj.filter(function(m){return uC(m)===u}):oM,h=d.filter(function(m){return c.indexOf(m)>=0});h.length===0&&(h=d);var p=h.reduce(function(m,g){return m[g]=G2(i,{placement:g,boundary:r,rootBoundary:s,padding:a})[qp(g)],m},{});return Object.keys(p).sort(function(m,g){return p[m]-p[g]})}function tDe(i){if(qp(i)===d9)return[];var e=gR(i);return[iq(i),e,iq(e)]}function iDe(i){var e=i.state,t=i.options,n=i.name;if(!e.modifiersData[n]._skip){for(var r=t.mainAxis,s=r===void 0?!0:r,a=t.altAxis,o=a===void 0?!0:a,l=t.fallbackPlacements,c=t.padding,u=t.boundary,d=t.rootBoundary,h=t.altBoundary,p=t.flipVariations,m=p===void 0?!0:p,g=t.allowedAutoPlacements,_=e.options.placement,b=qp(_),x=b===_,w=l||(x||!m?[gR(_)]:tDe(_)),C=[_].concat(w).reduce(function(he,ye){return he.concat(qp(ye)===d9?eDe(e,{placement:ye,boundary:u,rootBoundary:d,padding:c,flipVariations:m,allowedAutoPlacements:g}):ye)},[]),S=e.rects.reference,E=e.rects.popper,A=new Map,P=!0,O=C[0],M=0;M<C.length;M++){var V=C[M],L=qp(V),U=uC(V)===aC,G=[Dc,Ad].indexOf(L)>=0,H=G?"width":"height",k=G2(e,{placement:V,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),D=G?U?Md:kc:U?Ad:Dc;S[H]>E[H]&&(D=gR(D));var $=gR(D),F=[];if(s&&F.push(k[L]<=0),o&&F.push(k[D]<=0,k[$]<=0),F.every(function(he){return he})){O=V,P=!1;break}A.set(V,F)}if(P)for(var Y=m?3:1,ne=function(he){var ye=C.find(function(Te){var ce=A.get(Te);if(ce)return ce.slice(0,he).every(function(ae){return ae})});if(ye)return O=ye,"break"},X=Y;X>0;X--){var J=ne(X);if(J==="break")break}e.placement!==O&&(e.modifiersData[n]._skip=!0,e.placement=O,e.reset=!0)}}var nDe={name:"flip",enabled:!0,phase:"main",fn:iDe,requiresIfExists:["offset"],data:{_skip:!1}};function rq(i,e,t){return t===void 0&&(t={x:0,y:0}),{top:i.top-e.height-t.y,right:i.right-e.width+t.x,bottom:i.bottom-e.height+t.y,left:i.left-e.width-t.x}}function sq(i){return[Dc,Md,Ad,kc].some(function(e){return i[e]>=0})}function rDe(i){var e=i.state,t=i.name,n=e.rects.reference,r=e.rects.popper,s=e.modifiersData.preventOverflow,a=G2(e,{elementContext:"reference"}),o=G2(e,{altBoundary:!0}),l=rq(a,n),c=rq(o,r,s),u=sq(l),d=sq(c);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}var sDe={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:rDe};function aDe(i,e,t){var n=qp(i),r=[kc,Dc].indexOf(n)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:i})):t,a=s[0],o=s[1];return a=a||0,o=(o||0)*r,[kc,Md].indexOf(n)>=0?{x:o,y:a}:{x:a,y:o}}function oDe(i){var e=i.state,t=i.options,n=i.name,r=t.offset,s=r===void 0?[0,0]:r,a=Ib.reduce(function(u,d){return u[d]=aDe(d,e.rects,s),u},{}),o=a[e.placement],l=o.x,c=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[n]=a}var lDe={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:oDe};function cDe(i){var e=i.state,t=i.name;e.modifiersData[t]=noe({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var roe={name:"popperOffsets",enabled:!0,phase:"read",fn:cDe,data:{}};function uDe(i){return i==="x"?"y":"x"}function dDe(i){var e=i.state,t=i.options,n=i.name,r=t.mainAxis,s=r===void 0?!0:r,a=t.altAxis,o=a===void 0?!1:a,l=t.boundary,c=t.rootBoundary,u=t.altBoundary,d=t.padding,h=t.tether,p=h===void 0?!0:h,m=t.tetherOffset,g=m===void 0?0:m,_=G2(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),b=qp(e.placement),x=uC(e.placement),w=!x,C=f9(b),S=uDe(C),E=e.modifiersData.popperOffsets,A=e.rects.reference,P=e.rects.popper,O=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,M=typeof O=="number"?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),V=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,L={x:0,y:0};if(E){if(s){var U,G=C==="y"?Dc:kc,H=C==="y"?Ad:Md,k=C==="y"?"height":"width",D=E[C],$=D+_[G],F=D-_[H],Y=p?-P[k]/2:0,ne=x===aC?A[k]:P[k],X=x===aC?-P[k]:-A[k],J=e.elements.arrow,he=p&&J?p9(J):{width:0,height:0},ye=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Zae(),Te=ye[G],ce=ye[H],ae=pE(0,A[k],he[k]),le=w?A[k]/2-Y-ae-Te-M.mainAxis:ne-ae-Te-M.mainAxis,fe=w?-A[k]/2+Y+ae+ce+M.mainAxis:X+ae+ce+M.mainAxis,Ue=e.elements.arrow&&lM(e.elements.arrow),ie=Ue?C==="y"?Ue.clientTop||0:Ue.clientLeft||0:0,oe=(U=V==null?void 0:V[C])!=null?U:0,we=D+le-oe-ie,Ae=D+fe-oe,Oe=pE(p?u$($,we):$,D,p?B0(F,Ae):F);E[C]=Oe,L[C]=Oe-D}if(o){var ve,ke=C==="x"?Dc:kc,be=C==="x"?Ad:Md,$e=E[S],Le=S==="y"?"height":"width",Ce=$e+_[ke],Be=$e-_[be],He=[Dc,kc].indexOf(b)!==-1,Xe=(ve=V==null?void 0:V[S])!=null?ve:0,Je=He?Ce:$e-A[Le]-P[Le]-Xe+M.altAxis,it=He?$e+A[Le]+P[Le]-Xe-M.altAxis:Be,Qe=p&&He?N3e(Je,$e,it):pE(p?Je:Ce,$e,p?it:Be);E[S]=Qe,L[S]=Qe-$e}e.modifiersData[n]=L}}var hDe={name:"preventOverflow",enabled:!0,phase:"main",fn:dDe,requiresIfExists:["offset"]};function pDe(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function fDe(i){return i===Nh(i)||!Td(i)?m9(i):pDe(i)}function mDe(i){var e=i.getBoundingClientRect(),t=lC(e.width)/i.offsetWidth||1,n=lC(e.height)/i.offsetHeight||1;return t!==1||n!==1}function gDe(i,e,t){t===void 0&&(t=!1);var n=Td(e),r=Td(e)&&mDe(e),s=zy(e),a=cC(i,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!t)&&((df(e)!=="body"||v9(s))&&(o=fDe(e)),Td(e)?(l=cC(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):s&&(l.x=g9(s))),{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function vDe(i){var e=new Map,t=new Set,n=[];i.forEach(function(s){e.set(s.name,s)});function r(s){t.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(o){if(!t.has(o)){var l=e.get(o);l&&r(l)}}),n.push(s)}return i.forEach(function(s){t.has(s.name)||r(s)}),n}function yDe(i){var e=vDe(i);return $3e.reduce(function(t,n){return t.concat(e.filter(function(r){return r.phase===n}))},[])}function _De(i){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(i())})})),e}}function bDe(i){var e=i.reduce(function(t,n){var r=t[n.name];return t[n.name]=r?Object.assign({},r,n,{options:Object.assign({},r.options,n.options),data:Object.assign({},r.data,n.data)}):n,t},{});return Object.keys(e).map(function(t){return e[t]})}var aq={placement:"bottom",modifiers:[],strategy:"absolute"};function oq(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];return!e.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function y9(i){i===void 0&&(i={});var e=i,t=e.defaultModifiers,n=t===void 0?[]:t,r=e.defaultOptions,s=r===void 0?aq:r;return function(a,o,l){l===void 0&&(l=s);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},aq,s),modifiersData:{},elements:{reference:a,popper:o},attributes:{},styles:{}},u=[],d=!1,h={state:c,setOptions:function(g){var _=typeof g=="function"?g(c.options):g;m(),c.options=Object.assign({},s,c.options,_),c.scrollParents={reference:oC(a)?fE(a):a.contextElement?fE(a.contextElement):[],popper:fE(o)};var b=yDe(bDe([].concat(n,c.options.modifiers)));return c.orderedModifiers=b.filter(function(x){return x.enabled}),p(),h.update()},forceUpdate:function(){if(!d){var g=c.elements,_=g.reference,b=g.popper;if(oq(_,b)){c.rects={reference:gDe(_,lM(b),c.options.strategy==="fixed"),popper:p9(b)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(P){return c.modifiersData[P.name]=Object.assign({},P.data)});for(var x=0;x<c.orderedModifiers.length;x++){if(c.reset===!0){c.reset=!1,x=-1;continue}var w=c.orderedModifiers[x],C=w.fn,S=w.options,E=S===void 0?{}:S,A=w.name;typeof C=="function"&&(c=C({state:c,options:E,name:A,instance:h})||c)}}}},update:_De(function(){return new Promise(function(g){h.forceUpdate(),g(c)})}),destroy:function(){m(),d=!0}};if(!oq(a,o))return h;h.setOptions(l).then(function(g){!d&&l.onFirstUpdate&&l.onFirstUpdate(g)});function p(){c.orderedModifiers.forEach(function(g){var _=g.name,b=g.options,x=b===void 0?{}:b,w=g.effect;if(typeof w=="function"){var C=w({state:c,name:_,instance:h,options:x}),S=function(){};u.push(C||S)}})}function m(){u.forEach(function(g){return g()}),u=[]}return h}}y9();var wDe=[toe,roe,eoe,Yae];y9({defaultModifiers:wDe});var xDe=[toe,roe,eoe,Yae,lDe,nDe,hDe,U3e,sDe],soe=y9({defaultModifiers:xDe});const CDe=(i,e)=>{let t;Ve(()=>i.value,n=>{var r,s;n?(t=document.activeElement,Vn(e)&&((s=(r=e.value).focus)==null||s.call(r))):t.focus()})},_9=i=>{if(!i)return{onClick:yn,onMousedown:yn,onMouseup:yn};let e=!1,t=!1;return{onClick:a=>{e&&t&&i(a),e=t=!1},onMousedown:a=>{e=a.target===a.currentTarget},onMouseup:a=>{t=a.target===a.currentTarget}}},TDe=(i,e=0)=>{if(e===0)return i;const t=W(!1);let n=0;const r=()=>{n&&clearTimeout(n),n=window.setTimeout(()=>{t.value=i.value},e)};return qt(r),Ve(()=>i.value,s=>{s?r():t.value=s}),t};function SDe(){let i;const e=(n,r)=>{t(),i=window.setTimeout(n,r)},t=()=>window.clearTimeout(i);return E3(()=>t()),{registerTimeout:e,cancelTimeout:t}}let Q1=[];const lq=i=>{const e=i;e.key===wt.esc&&Q1.forEach(t=>t(e))},EDe=i=>{qt(()=>{Q1.length===0&&document.addEventListener("keydown",lq),Ii&&Q1.push(i)}),Vr(()=>{Q1=Q1.filter(e=>e!==i),Q1.length===0&&Ii&&document.removeEventListener("keydown",lq)})};let cq;const aoe=()=>{const i=vg("namespace",k3),e=jae(),t=R(()=>`${i.value}-popper-container-${e.prefix}`),n=R(()=>`#${t.value}`);return{id:t,selector:n}},ADe=i=>{const e=document.createElement("div");return e.id=i,document.body.appendChild(e),e},MDe=()=>{m3(()=>{if(!Ii)return;const{id:i,selector:e}=aoe();!cq&&!document.body.querySelector(e.value)&&(cq=ADe(i.value))})},PDe=Ke({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200}}),ooe=({showAfter:i,hideAfter:e,open:t,close:n})=>{const{registerTimeout:r}=SDe();return{onOpen:o=>{r(()=>{t(o)},v(i))},onClose:o=>{r(()=>{n(o)},v(e))}}},loe=Symbol("elForwardRef"),ODe=i=>{pi(loe,{setForwardRef:t=>{i.value=t}})},RDe=i=>({mounted(e){i(e)},updated(e){i(e)},unmounted(){i(null)}}),uq=W(0),yg=()=>{const i=vg("zIndex",2e3),e=R(()=>i.value+uq.value);return{initialZIndex:i,currentZIndex:e,nextZIndex:()=>(uq.value++,e.value)}};function b9(i){return i.split("-")[1]}function coe(i){return i==="y"?"height":"width"}function w9(i){return i.split("-")[0]}function x9(i){return["top","bottom"].includes(w9(i))?"x":"y"}function dq(i,e,t){let{reference:n,floating:r}=i;const s=n.x+n.width/2-r.width/2,a=n.y+n.height/2-r.height/2,o=x9(e),l=coe(o),c=n[l]/2-r[l]/2,u=w9(e),d=o==="x";let h;switch(u){case"top":h={x:s,y:n.y-r.height};break;case"bottom":h={x:s,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:a};break;case"left":h={x:n.x-r.width,y:a};break;default:h={x:n.x,y:n.y}}switch(b9(e)){case"start":h[o]-=c*(t&&d?-1:1);break;case"end":h[o]+=c*(t&&d?-1:1);break}return h}const IDe=async(i,e,t)=>{const{placement:n="bottom",strategy:r="absolute",middleware:s=[],platform:a}=t,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:i,floating:e,strategy:r}),{x:u,y:d}=dq(c,n,l),h=n,p={},m=0;for(let g=0;g<o.length;g++){const{name:_,fn:b}=o[g],{x,y:w,data:C,reset:S}=await b({x:u,y:d,initialPlacement:n,placement:h,strategy:r,middlewareData:p,rects:c,platform:a,elements:{reference:i,floating:e}});if(u=x??u,d=w??d,p={...p,[_]:{...p[_],...C}},S&&m<=50){m++,typeof S=="object"&&(S.placement&&(h=S.placement),S.rects&&(c=S.rects===!0?await a.getElementRects({reference:i,floating:e,strategy:r}):S.rects),{x:u,y:d}=dq(c,h,l)),g=-1;continue}}return{x:u,y:d,placement:h,strategy:r,middlewareData:p}};function $De(i){return{top:0,right:0,bottom:0,left:0,...i}}function LDe(i){return typeof i!="number"?$De(i):{top:i,right:i,bottom:i,left:i}}function yk(i){return{...i,top:i.y,left:i.x,right:i.x+i.width,bottom:i.y+i.height}}const DDe=Math.min,kDe=Math.max;function FDe(i,e,t){return kDe(i,DDe(e,t))}const NDe=i=>({name:"arrow",options:i,async fn(e){const{element:t,padding:n=0}=i||{},{x:r,y:s,placement:a,rects:o,platform:l}=e;if(t==null)return{};const c=LDe(n),u={x:r,y:s},d=x9(a),h=coe(d),p=await l.getDimensions(t),m=d==="y"?"top":"left",g=d==="y"?"bottom":"right",_=o.reference[h]+o.reference[d]-u[d]-o.floating[h],b=u[d]-o.reference[d],x=await(l.getOffsetParent==null?void 0:l.getOffsetParent(t));let w=x?d==="y"?x.clientHeight||0:x.clientWidth||0:0;w===0&&(w=o.floating[h]);const C=_/2-b/2,S=c[m],E=w-p[h]-c[g],A=w/2-p[h]/2+C,P=FDe(S,A,E),M=b9(a)!=null&&A!=P&&o.reference[h]/2-(A<S?c[m]:c[g])-p[h]/2<0?A<S?S-A:E-A:0;return{[d]:u[d]-M,data:{[d]:P,centerOffset:A-P}}}});async function VDe(i,e){const{placement:t,platform:n,elements:r}=i,s=await(n.isRTL==null?void 0:n.isRTL(r.floating)),a=w9(t),o=b9(t),l=x9(t)==="x",c=["left","top"].includes(a)?-1:1,u=s&&l?-1:1,d=typeof e=="function"?e(i):e;let{mainAxis:h,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return o&&typeof m=="number"&&(p=o==="end"?m*-1:m),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const BDe=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(e){const{x:t,y:n}=e,r=await VDe(e,i);return{x:t+r.x,y:n+r.y,data:r}}}};function vd(i){var e;return((e=i.ownerDocument)==null?void 0:e.defaultView)||window}function hf(i){return vd(i).getComputedStyle(i)}const hq=Math.min,mE=Math.max,d$=Math.round;function uoe(i){const e=hf(i);let t=parseFloat(e.width),n=parseFloat(e.height);const r=i.offsetWidth,s=i.offsetHeight,a=d$(t)!==r||d$(n)!==s;return a&&(t=r,n=s),{width:t,height:n,fallback:a}}function Ey(i){return hoe(i)?(i.nodeName||"").toLowerCase():""}let YM;function doe(){if(YM)return YM;const i=navigator.userAgentData;return i&&Array.isArray(i.brands)?(YM=i.brands.map(e=>e.brand+"/"+e.version).join(" "),YM):navigator.userAgent}function pf(i){return i instanceof vd(i).HTMLElement}function Ay(i){return i instanceof vd(i).Element}function hoe(i){return i instanceof vd(i).Node}function pq(i){if(typeof ShadowRoot>"u")return!1;const e=vd(i).ShadowRoot;return i instanceof e||i instanceof ShadowRoot}function N3(i){const{overflow:e,overflowX:t,overflowY:n,display:r}=hf(i);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!["inline","contents"].includes(r)}function zDe(i){return["table","td","th"].includes(Ey(i))}function C9(i){const e=/firefox/i.test(doe()),t=hf(i),n=t.backdropFilter||t.WebkitBackdropFilter;return t.transform!=="none"||t.perspective!=="none"||(n?n!=="none":!1)||e&&t.willChange==="filter"||e&&(t.filter?t.filter!=="none":!1)||["transform","perspective"].some(r=>t.willChange.includes(r))||["paint","layout","strict","content"].some(r=>{const s=t.contain;return s!=null?s.includes(r):!1})}function poe(){return!/^((?!chrome|android).)*safari/i.test(doe())}function T9(i){return["html","body","#document"].includes(Ey(i))}function foe(i){return Ay(i)?i:i.contextElement}const moe={x:1,y:1};function vx(i){const e=foe(i);if(!pf(e))return moe;const t=e.getBoundingClientRect(),{width:n,height:r,fallback:s}=uoe(e);let a=(s?d$(t.width):t.width)/n,o=(s?d$(t.height):t.height)/r;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}function W2(i,e,t,n){var r,s;e===void 0&&(e=!1),t===void 0&&(t=!1);const a=i.getBoundingClientRect(),o=foe(i);let l=moe;e&&(n?Ay(n)&&(l=vx(n)):l=vx(i));const c=o?vd(o):window,u=!poe()&&t;let d=(a.left+(u&&((r=c.visualViewport)==null?void 0:r.offsetLeft)||0))/l.x,h=(a.top+(u&&((s=c.visualViewport)==null?void 0:s.offsetTop)||0))/l.y,p=a.width/l.x,m=a.height/l.y;if(o){const g=vd(o),_=n&&Ay(n)?vd(n):n;let b=g.frameElement;for(;b&&n&&_!==g;){const x=vx(b),w=b.getBoundingClientRect(),C=getComputedStyle(b);w.x+=(b.clientLeft+parseFloat(C.paddingLeft))*x.x,w.y+=(b.clientTop+parseFloat(C.paddingTop))*x.y,d*=x.x,h*=x.y,p*=x.x,m*=x.y,d+=w.x,h+=w.y,b=vd(b).frameElement}}return{width:p,height:m,top:h,right:d+p,bottom:h+m,left:d,x:d,y:h}}function Uy(i){return((hoe(i)?i.ownerDocument:i.document)||window.document).documentElement}function V3(i){return Ay(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.pageXOffset,scrollTop:i.pageYOffset}}function UDe(i){let{rect:e,offsetParent:t,strategy:n}=i;const r=pf(t),s=Uy(t);if(t===s)return e;let a={scrollLeft:0,scrollTop:0},o={x:1,y:1};const l={x:0,y:0};if((r||!r&&n!=="fixed")&&((Ey(t)!=="body"||N3(s))&&(a=V3(t)),pf(t))){const c=W2(t);o=vx(t),l.x=c.x+t.clientLeft,l.y=c.y+t.clientTop}return{width:e.width*o.x,height:e.height*o.y,x:e.x*o.x-a.scrollLeft*o.x+l.x,y:e.y*o.y-a.scrollTop*o.y+l.y}}function goe(i){return W2(Uy(i)).left+V3(i).scrollLeft}function HDe(i){const e=Uy(i),t=V3(i),n=i.ownerDocument.body,r=mE(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=mE(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let a=-t.scrollLeft+goe(i);const o=-t.scrollTop;return hf(n).direction==="rtl"&&(a+=mE(e.clientWidth,n.clientWidth)-r),{width:r,height:s,x:a,y:o}}function j2(i){if(Ey(i)==="html")return i;const e=i.assignedSlot||i.parentNode||pq(i)&&i.host||Uy(i);return pq(e)?e.host:e}function voe(i){const e=j2(i);return T9(e)?e.ownerDocument.body:pf(e)&&N3(e)?e:voe(e)}function yoe(i,e){var t;e===void 0&&(e=[]);const n=voe(i),r=n===((t=i.ownerDocument)==null?void 0:t.body),s=vd(n);return r?e.concat(s,s.visualViewport||[],N3(n)?n:[]):e.concat(n,yoe(n))}function GDe(i,e){const t=vd(i),n=Uy(i),r=t.visualViewport;let s=n.clientWidth,a=n.clientHeight,o=0,l=0;if(r){s=r.width,a=r.height;const c=poe();(c||!c&&e==="fixed")&&(o=r.offsetLeft,l=r.offsetTop)}return{width:s,height:a,x:o,y:l}}function WDe(i,e){const t=W2(i,!0,e==="fixed"),n=t.top+i.clientTop,r=t.left+i.clientLeft,s=pf(i)?vx(i):{x:1,y:1},a=i.clientWidth*s.x,o=i.clientHeight*s.y,l=r*s.x,c=n*s.y;return{width:a,height:o,x:l,y:c}}function fq(i,e,t){return e==="viewport"?yk(GDe(i,t)):Ay(e)?yk(WDe(e,t)):yk(HDe(Uy(i)))}function jDe(i,e){const t=e.get(i);if(t)return t;let n=yoe(i).filter(o=>Ay(o)&&Ey(o)!=="body"),r=null;const s=hf(i).position==="fixed";let a=s?j2(i):i;for(;Ay(a)&&!T9(a);){const o=hf(a),l=C9(a);(s?!l&&!r:!l&&o.position==="static"&&!!r&&["absolute","fixed"].includes(r.position))?n=n.filter(u=>u!==a):r=o,a=j2(a)}return e.set(i,n),n}function qDe(i){let{element:e,boundary:t,rootBoundary:n,strategy:r}=i;const a=[...t==="clippingAncestors"?jDe(e,this._c):[].concat(t),n],o=a[0],l=a.reduce((c,u)=>{const d=fq(e,u,r);return c.top=mE(d.top,c.top),c.right=hq(d.right,c.right),c.bottom=hq(d.bottom,c.bottom),c.left=mE(d.left,c.left),c},fq(e,o,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function KDe(i){return pf(i)?uoe(i):i.getBoundingClientRect()}function mq(i){return!pf(i)||hf(i).position==="fixed"?null:i.offsetParent}function YDe(i){let e=j2(i);for(;pf(e)&&!T9(e);){if(C9(e))return e;e=j2(e)}return null}function gq(i){const e=vd(i);let t=mq(i);for(;t&&zDe(t)&&hf(t).position==="static";)t=mq(t);return t&&(Ey(t)==="html"||Ey(t)==="body"&&hf(t).position==="static"&&!C9(t))?e:t||YDe(i)||e}function XDe(i,e,t){const n=pf(e),r=Uy(e),s=W2(i,!0,t==="fixed",e);let a={scrollLeft:0,scrollTop:0};const o={x:0,y:0};if(n||!n&&t!=="fixed")if((Ey(e)!=="body"||N3(r))&&(a=V3(e)),pf(e)){const l=W2(e,!0);o.x=l.x+e.clientLeft,o.y=l.y+e.clientTop}else r&&(o.x=goe(r));return{x:s.left+a.scrollLeft-o.x,y:s.top+a.scrollTop-o.y,width:s.width,height:s.height}}const ZDe={getClippingRect:qDe,convertOffsetParentRelativeRectToViewportRelativeRect:UDe,isElement:Ay,getDimensions:KDe,getOffsetParent:gq,getDocumentElement:Uy,getScale:vx,async getElementRects(i){let{reference:e,floating:t,strategy:n}=i;const r=this.getOffsetParent||gq,s=this.getDimensions;return{reference:XDe(e,await r(t),n),floating:{x:0,y:0,...await s(t)}}},getClientRects:i=>Array.from(i.getClientRects()),isRTL:i=>hf(i).direction==="rtl"},QDe=(i,e,t)=>{const n=new Map,r={platform:ZDe,...t},s={...r.platform,_c:n};return IDe(i,e,{...r,platform:s})};Ke({});const JDe=i=>{if(!Ii)return;if(!i)return i;const e=Mu(i);return e||(Vn(i)?e:i)},eke=({middleware:i,placement:e,strategy:t})=>{const n=W(),r=W(),s=W(),a=W(),o=W({}),l={x:s,y:a,placement:e,strategy:t,middlewareData:o},c=async()=>{if(!Ii)return;const u=JDe(n),d=Mu(r);if(!u||!d)return;const h=await QDe(u,d,{placement:v(e),strategy:v(t),middleware:v(i)});z2(l).forEach(p=>{l[p].value=h[p]})};return qt(()=>{Ru(()=>{c()})}),{...l,update:c,referenceRef:n,contentRef:r}},tke=({arrowRef:i,padding:e})=>({name:"arrow",options:{element:i,padding:e},fn(t){const n=v(i);return n?NDe({element:n,padding:e}).fn(t):{}}});function ike(i){const e=W();function t(){if(i.value==null)return;const{selectionStart:r,selectionEnd:s,value:a}=i.value;if(r==null||s==null)return;const o=a.slice(0,Math.max(0,r)),l=a.slice(Math.max(0,s));e.value={selectionStart:r,selectionEnd:s,value:a,beforeTxt:o,afterTxt:l}}function n(){if(i.value==null||e.value==null)return;const{value:r}=i.value,{beforeTxt:s,afterTxt:a,selectionStart:o}=e.value;if(s==null||a==null||o==null)return;let l=r.length;if(r.endsWith(a))l=r.length-a.length;else if(r.startsWith(s))l=s.length;else{const c=s[o-1],u=r.indexOf(c,o-1);u!==-1&&(l=u+1)}i.value.setSelectionRange(l,l)}return[t,n]}const nke=(i,e,t)=>gx(i.subTree).filter(s=>{var a;return Pr(s)&&((a=s.type)==null?void 0:a.name)===e&&!!s.component}).map(s=>s.component.uid).map(s=>t[s]).filter(s=>!!s),_oe=(i,e)=>{const t={},n=nr([]);return{children:n,addChild:a=>{t[a.uid]=a,n.value=nke(i,e,t)},removeChild:a=>{delete t[a],n.value=n.value.filter(o=>o.uid!==a)}}},rke="2.2.28",ske=(i=[])=>({version:rke,install:(t,n)=>{t[Yj]||(t[Yj]=!0,i.forEach(r=>t.use(r)),n&&Gae(n,t,!0))}}),ake=Ke({zIndex:{type:xe([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),oke={scroll:({scrollTop:i,fixed:e})=>It(i)&&Ys(e),[rr]:i=>Ys(i)};var qe=(i,e)=>{const t=i.__vccOpts||i;for(const[n,r]of e)t[n]=r;return t};const boe="ElAffix",lke=de({name:boe}),cke=de({...lke,props:ake,emits:oke,setup(i,{expose:e,emit:t}){const n=i,r=Ne("affix"),s=nr(),a=nr(),o=nr(),{height:l}=TOe(),{height:c,width:u,top:d,bottom:h,update:p}=Hj(a,{windowScroll:!1}),m=Hj(s),g=W(!1),_=W(0),b=W(0),x=R(()=>({height:g.value?`${c.value}px`:"",width:g.value?`${u.value}px`:""})),w=R(()=>{if(!g.value)return{};const E=n.offset?Xs(n.offset):0;return{height:`${c.value}px`,width:`${u.value}px`,top:n.position==="top"?E:"",bottom:n.position==="bottom"?E:"",transform:b.value?`translateY(${b.value}px)`:"",zIndex:n.zIndex}}),C=()=>{if(o.value)if(_.value=o.value instanceof Window?document.documentElement.scrollTop:o.value.scrollTop||0,n.position==="top")if(n.target){const E=m.bottom.value-n.offset-c.value;g.value=n.offset>d.value&&m.bottom.value>0,b.value=E<0?E:0}else g.value=n.offset>d.value;else if(n.target){const E=l.value-m.top.value-n.offset-c.value;g.value=l.value-n.offset<h.value&&l.value>m.top.value,b.value=E<0?-E:0}else g.value=l.value-n.offset<h.value},S=()=>{p(),t("scroll",{scrollTop:_.value,fixed:g.value})};return Ve(g,E=>t("change",E)),qt(()=>{var E;n.target?(s.value=(E=document.querySelector(n.target))!=null?E:void 0,s.value||ba(boe,`Target is not existed: ${n.target}`)):s.value=document.documentElement,o.value=i9(a.value,!0),p()}),mr(o,"scroll",S),Ru(C),e({update:C,updateRoot:p}),(E,A)=>(I(),Z("div",{ref_key:"root",ref:a,class:N(v(r).b()),style:pt(v(x))},[Q("div",{class:N({[v(r).m("fixed")]:g.value}),style:pt(v(w))},[Fe(E.$slots,"default")],6)],6))}});var uke=qe(cke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/affix/src/affix.vue"]]);const dke=ii(uke),hke=Ke({size:{type:xe([Number,String])},color:{type:String}}),pke=de({name:"ElIcon",inheritAttrs:!1}),fke=de({...pke,props:hke,setup(i){const e=i,t=Ne("icon"),n=R(()=>{const{size:r,color:s}=e;return!r&&!s?{}:{fontSize:eo(r)?void 0:Xs(r),"--color":s}});return(r,s)=>(I(),Z("i",ci({class:v(t).b(),style:v(n)},r.$attrs),[Fe(r.$slots,"default")],16))}});var mke=qe(fke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/icon/src/icon.vue"]]);const ct=ii(mke),gke=["light","dark"],vke=Ke({title:{type:String,default:""},description:{type:String,default:""},type:{type:String,values:z2(Sy),default:"info"},closable:{type:Boolean,default:!0},closeText:{type:String,default:""},showIcon:Boolean,center:Boolean,effect:{type:String,values:gke,default:"light"}}),yke={close:i=>i instanceof MouseEvent},_ke=de({name:"ElAlert"}),bke=de({..._ke,props:vke,emits:yke,setup(i,{emit:e}){const t=i,{Close:n}=a9,r=uo(),s=Ne("alert"),a=W(!0),o=R(()=>Sy[t.type]),l=R(()=>[s.e("icon"),{[s.is("big")]:!!t.description||!!r.default}]),c=R(()=>({[s.is("bold")]:t.description||r.default})),u=d=>{a.value=!1,e("close",d)};return(d,h)=>(I(),Se(Ss,{name:v(s).b("fade"),persisted:""},{default:pe(()=>[zt(Q("div",{class:N([v(s).b(),v(s).m(d.type),v(s).is("center",d.center),v(s).is(d.effect)]),role:"alert"},[d.showIcon&&v(o)?(I(),Se(v(ct),{key:0,class:N(v(l))},{default:pe(()=>[(I(),Se(hi(v(o))))]),_:1},8,["class"])):_e("v-if",!0),Q("div",{class:N(v(s).e("content"))},[d.title||d.$slots.title?(I(),Z("span",{key:0,class:N([v(s).e("title"),v(c)])},[Fe(d.$slots,"title",{},()=>[Gi(We(d.title),1)])],2)):_e("v-if",!0),d.$slots.default||d.description?(I(),Z("p",{key:1,class:N(v(s).e("description"))},[Fe(d.$slots,"default",{},()=>[Gi(We(d.description),1)])],2)):_e("v-if",!0),d.closable?(I(),Z(gt,{key:2},[d.closeText?(I(),Z("div",{key:0,class:N([v(s).e("close-btn"),v(s).is("customed")]),onClick:u},We(d.closeText),3)):(I(),Se(v(ct),{key:1,class:N(v(s).e("close-btn")),onClick:u},{default:pe(()=>[re(v(n))]),_:1},8,["class"]))],64)):_e("v-if",!0)],2)],2),[[Ei,a.value]])]),_:3},8,["name"]))}});var wke=qe(bke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/alert/src/alert.vue"]]);const xke=ii(wke);let Fd;const Cke=`
  height:0 !important;
  visibility:hidden !important;
  overflow:hidden !important;
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,Tke=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function Ske(i){const e=window.getComputedStyle(i),t=e.getPropertyValue("box-sizing"),n=Number.parseFloat(e.getPropertyValue("padding-bottom"))+Number.parseFloat(e.getPropertyValue("padding-top")),r=Number.parseFloat(e.getPropertyValue("border-bottom-width"))+Number.parseFloat(e.getPropertyValue("border-top-width"));return{contextStyle:Tke.map(a=>`${a}:${e.getPropertyValue(a)}`).join(";"),paddingSize:n,borderSize:r,boxSizing:t}}function vq(i,e=1,t){var n;Fd||(Fd=document.createElement("textarea"),document.body.appendChild(Fd));const{paddingSize:r,borderSize:s,boxSizing:a,contextStyle:o}=Ske(i);Fd.setAttribute("style",`${o};${Cke}`),Fd.value=i.value||i.placeholder||"";let l=Fd.scrollHeight;const c={};a==="border-box"?l=l+s:a==="content-box"&&(l=l-r),Fd.value="";const u=Fd.scrollHeight-r;if(It(e)){let d=u*e;a==="border-box"&&(d=d+r+s),l=Math.max(d,l),c.minHeight=`${d}px`}if(It(t)){let d=u*t;a==="border-box"&&(d=d+r+s),l=Math.min(d,l)}return c.height=`${l}px`,(n=Fd.parentNode)==null||n.removeChild(Fd),Fd=void 0,c}const Eke=Ke({id:{type:String,default:void 0},size:Ql,disabled:Boolean,modelValue:{type:xe([String,Number,Object]),default:""},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:xe([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:Zn},prefixIcon:{type:Zn},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:xe([Object,Array,String]),default:()=>Ar({})}}),Ake={[ri]:i=>Ft(i),input:i=>Ft(i),change:i=>Ft(i),focus:i=>i instanceof FocusEvent,blur:i=>i instanceof FocusEvent,clear:()=>!0,mouseleave:i=>i instanceof MouseEvent,mouseenter:i=>i instanceof MouseEvent,keydown:i=>i instanceof Event,compositionstart:i=>i instanceof CompositionEvent,compositionupdate:i=>i instanceof CompositionEvent,compositionend:i=>i instanceof CompositionEvent},Mke=["role"],Pke=["id","type","disabled","formatter","parser","readonly","autocomplete","tabindex","aria-label","placeholder","form"],Oke=["id","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form"],Rke=de({name:"ElInput",inheritAttrs:!1}),Ike=de({...Rke,props:Eke,emits:Ake,setup(i,{expose:e,emit:t}){const n=i,r=VC(),s=uo(),a=R(()=>{const Ce={};return n.containerRole==="combobox"&&(Ce["aria-haspopup"]=r["aria-haspopup"],Ce["aria-owns"]=r["aria-owns"],Ce["aria-expanded"]=r["aria-expanded"]),Ce}),o=R(()=>[n.type==="textarea"?_.b():g.b(),g.m(p.value),g.is("disabled",m.value),g.is("exceed",ne.value),{[g.b("group")]:s.prepend||s.append,[g.bm("group","append")]:s.append,[g.bm("group","prepend")]:s.prepend,[g.m("prefix")]:s.prefix||n.prefixIcon,[g.m("suffix")]:s.suffix||n.suffixIcon||n.clearable||n.showPassword,[g.bm("suffix","password-clear")]:D.value&&$.value},r.class]),l=R(()=>[g.e("wrapper"),g.is("focus",w.value)]),c=l9({excludeKeys:R(()=>Object.keys(a.value))}),{form:u,formItem:d}=nc(),{inputId:h}=By(n,{formItemContext:d}),p=Qs(),m=zc(),g=Ne("input"),_=Ne("textarea"),b=nr(),x=nr(),w=W(!1),C=W(!1),S=W(!1),E=W(!1),A=W(),P=nr(n.inputStyle),O=R(()=>b.value||x.value),M=R(()=>{var Ce;return(Ce=u==null?void 0:u.statusIcon)!=null?Ce:!1}),V=R(()=>(d==null?void 0:d.validateState)||""),L=R(()=>V.value&&Aae[V.value]),U=R(()=>E.value?kLe:UIe),G=R(()=>[r.style,n.inputStyle]),H=R(()=>[n.inputStyle,P.value,{resize:n.resize}]),k=R(()=>so(n.modelValue)?"":String(n.modelValue)),D=R(()=>n.clearable&&!m.value&&!n.readonly&&!!k.value&&(w.value||C.value)),$=R(()=>n.showPassword&&!m.value&&!n.readonly&&!!k.value&&(!!k.value||w.value)),F=R(()=>n.showWordLimit&&!!c.value.maxlength&&(n.type==="text"||n.type==="textarea")&&!m.value&&!n.readonly&&!n.showPassword),Y=R(()=>Array.from(k.value).length),ne=R(()=>!!F.value&&Y.value>Number(c.value.maxlength)),X=R(()=>!!s.suffix||!!n.suffixIcon||D.value||n.showPassword||F.value||!!V.value&&M.value),[J,he]=ike(b);fl(x,Ce=>{if(!F.value||n.resize!=="both")return;const Be=Ce[0],{width:He}=Be.contentRect;A.value={right:`calc(100% - ${He+15+6}px)`}});const ye=()=>{const{type:Ce,autosize:Be}=n;if(!(!Ii||Ce!=="textarea"))if(Be){const He=oi(Be)?Be.minRows:void 0,Xe=oi(Be)?Be.maxRows:void 0;P.value={...vq(x.value,He,Xe)}}else P.value={minHeight:vq(x.value).minHeight}},Te=()=>{const Ce=O.value;!Ce||Ce.value===k.value||(Ce.value=k.value)},ce=async Ce=>{J();let{value:Be}=Ce.target;if(n.formatter&&(Be=n.parser?n.parser(Be):Be,Be=n.formatter(Be)),!S.value){if(Be===k.value){Te();return}t(ri,Be),t("input",Be),await ut(),Te(),he()}},ae=Ce=>{t("change",Ce.target.value)},le=Ce=>{t("compositionstart",Ce),S.value=!0},fe=Ce=>{var Be;t("compositionupdate",Ce);const He=(Be=Ce.target)==null?void 0:Be.value,Xe=He[He.length-1]||"";S.value=!O3(Xe)},Ue=Ce=>{t("compositionend",Ce),S.value&&(S.value=!1,ce(Ce))},ie=()=>{E.value=!E.value,oe()},oe=async()=>{var Ce;await ut(),(Ce=O.value)==null||Ce.focus()},we=()=>{var Ce;return(Ce=O.value)==null?void 0:Ce.blur()},Ae=Ce=>{w.value=!0,t("focus",Ce)},Oe=Ce=>{var Be;w.value=!1,t("blur",Ce),n.validateEvent&&((Be=d==null?void 0:d.validate)==null||Be.call(d,"blur").catch(He=>void 0))},ve=Ce=>{C.value=!1,t("mouseleave",Ce)},ke=Ce=>{C.value=!0,t("mouseenter",Ce)},be=Ce=>{t("keydown",Ce)},$e=()=>{var Ce;(Ce=O.value)==null||Ce.select()},Le=()=>{t(ri,""),t("change",""),t("clear"),t("input","")};return Ve(()=>n.modelValue,()=>{var Ce;ut(()=>ye()),n.validateEvent&&((Ce=d==null?void 0:d.validate)==null||Ce.call(d,"change").catch(Be=>void 0))}),Ve(k,()=>Te()),Ve(()=>n.type,async()=>{await ut(),Te(),ye()}),qt(()=>{!n.formatter&&n.parser,Te(),ut(ye)}),e({input:b,textarea:x,ref:O,textareaStyle:H,autosize:kr(n,"autosize"),focus:oe,blur:we,select:$e,clear:Le,resizeTextarea:ye}),(Ce,Be)=>zt((I(),Z("div",ci(v(a),{class:v(o),style:v(G),role:Ce.containerRole,onMouseenter:ke,onMouseleave:ve}),[_e(" input "),Ce.type!=="textarea"?(I(),Z(gt,{key:0},[_e(" prepend slot "),Ce.$slots.prepend?(I(),Z("div",{key:0,class:N(v(g).be("group","prepend"))},[Fe(Ce.$slots,"prepend")],2)):_e("v-if",!0),Q("div",{class:N(v(l))},[_e(" prefix slot "),Ce.$slots.prefix||Ce.prefixIcon?(I(),Z("span",{key:0,class:N(v(g).e("prefix"))},[Q("span",{class:N(v(g).e("prefix-inner")),onClick:oe},[Fe(Ce.$slots,"prefix"),Ce.prefixIcon?(I(),Se(v(ct),{key:0,class:N(v(g).e("icon"))},{default:pe(()=>[(I(),Se(hi(Ce.prefixIcon)))]),_:1},8,["class"])):_e("v-if",!0)],2)],2)):_e("v-if",!0),Q("input",ci({id:v(h),ref_key:"input",ref:b,class:v(g).e("inner")},v(c),{type:Ce.showPassword?E.value?"text":"password":Ce.type,disabled:v(m),formatter:Ce.formatter,parser:Ce.parser,readonly:Ce.readonly,autocomplete:Ce.autocomplete,tabindex:Ce.tabindex,"aria-label":Ce.label,placeholder:Ce.placeholder,style:Ce.inputStyle,form:n.form,onCompositionstart:le,onCompositionupdate:fe,onCompositionend:Ue,onInput:ce,onFocus:Ae,onBlur:Oe,onChange:ae,onKeydown:be}),null,16,Pke),_e(" suffix slot "),v(X)?(I(),Z("span",{key:1,class:N(v(g).e("suffix"))},[Q("span",{class:N(v(g).e("suffix-inner")),onClick:oe},[!v(D)||!v($)||!v(F)?(I(),Z(gt,{key:0},[Fe(Ce.$slots,"suffix"),Ce.suffixIcon?(I(),Se(v(ct),{key:0,class:N(v(g).e("icon"))},{default:pe(()=>[(I(),Se(hi(Ce.suffixIcon)))]),_:1},8,["class"])):_e("v-if",!0)],64)):_e("v-if",!0),v(D)?(I(),Se(v(ct),{key:1,class:N([v(g).e("icon"),v(g).e("clear")]),onMousedown:Dt(v(yn),["prevent"]),onClick:Le},{default:pe(()=>[re(v(Ny))]),_:1},8,["class","onMousedown"])):_e("v-if",!0),v($)?(I(),Se(v(ct),{key:2,class:N([v(g).e("icon"),v(g).e("password")]),onClick:ie},{default:pe(()=>[(I(),Se(hi(v(U))))]),_:1},8,["class"])):_e("v-if",!0),v(F)?(I(),Z("span",{key:3,class:N(v(g).e("count"))},[Q("span",{class:N(v(g).e("count-inner"))},We(v(Y))+" / "+We(v(c).maxlength),3)],2)):_e("v-if",!0),v(V)&&v(L)&&v(M)?(I(),Se(v(ct),{key:4,class:N([v(g).e("icon"),v(g).e("validateIcon"),v(g).is("loading",v(V)==="validating")])},{default:pe(()=>[(I(),Se(hi(v(L))))]),_:1},8,["class"])):_e("v-if",!0)],2)],2)):_e("v-if",!0)],2),_e(" append slot "),Ce.$slots.append?(I(),Z("div",{key:1,class:N(v(g).be("group","append"))},[Fe(Ce.$slots,"append")],2)):_e("v-if",!0)],64)):(I(),Z(gt,{key:1},[_e(" textarea "),Q("textarea",ci({id:v(h),ref_key:"textarea",ref:x,class:v(_).e("inner")},v(c),{tabindex:Ce.tabindex,disabled:v(m),readonly:Ce.readonly,autocomplete:Ce.autocomplete,style:v(H),"aria-label":Ce.label,placeholder:Ce.placeholder,form:n.form,onCompositionstart:le,onCompositionupdate:fe,onCompositionend:Ue,onInput:ce,onFocus:Ae,onBlur:Oe,onChange:ae,onKeydown:be}),null,16,Oke),v(F)?(I(),Z("span",{key:0,style:pt(A.value),class:N(v(g).e("count"))},We(v(Y))+" / "+We(v(c).maxlength),7)):_e("v-if",!0)],64))],16,Mke)),[[Ei,Ce.type!=="hidden"]])}});var $ke=qe(Ike,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input/src/input.vue"]]);const ol=ii($ke),Rw=4,woe={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},Lke=({move:i,size:e,bar:t})=>({[t.size]:e,transform:`translate${t.axis}(${i}%)`}),Dke=Ke({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),kke="Thumb",Fke=de({__name:"thumb",props:Dke,setup(i){const e=i,t=ht(Nae),n=Ne("scrollbar");t||ba(kke,"can not inject scrollbar context");const r=W(),s=W(),a=W({}),o=W(!1);let l=!1,c=!1,u=Ii?document.onselectstart:null;const d=R(()=>woe[e.vertical?"vertical":"horizontal"]),h=R(()=>Lke({size:e.size,move:e.move,bar:d.value})),p=R(()=>r.value[d.value.offset]**2/t.wrapElement[d.value.scrollSize]/e.ratio/s.value[d.value.offset]),m=E=>{var A;if(E.stopPropagation(),E.ctrlKey||[1,2].includes(E.button))return;(A=window.getSelection())==null||A.removeAllRanges(),_(E);const P=E.currentTarget;P&&(a.value[d.value.axis]=P[d.value.offset]-(E[d.value.client]-P.getBoundingClientRect()[d.value.direction]))},g=E=>{if(!s.value||!r.value||!t.wrapElement)return;const A=Math.abs(E.target.getBoundingClientRect()[d.value.direction]-E[d.value.client]),P=s.value[d.value.offset]/2,O=(A-P)*100*p.value/r.value[d.value.offset];t.wrapElement[d.value.scroll]=O*t.wrapElement[d.value.scrollSize]/100},_=E=>{E.stopImmediatePropagation(),l=!0,document.addEventListener("mousemove",b),document.addEventListener("mouseup",x),u=document.onselectstart,document.onselectstart=()=>!1},b=E=>{if(!r.value||!s.value||l===!1)return;const A=a.value[d.value.axis];if(!A)return;const P=(r.value.getBoundingClientRect()[d.value.direction]-E[d.value.client])*-1,O=s.value[d.value.offset]-A,M=(P-O)*100*p.value/r.value[d.value.offset];t.wrapElement[d.value.scroll]=M*t.wrapElement[d.value.scrollSize]/100},x=()=>{l=!1,a.value[d.value.axis]=0,document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",x),S(),c&&(o.value=!1)},w=()=>{c=!1,o.value=!!e.size},C=()=>{c=!0,o.value=l};Vr(()=>{S(),document.removeEventListener("mouseup",x)});const S=()=>{document.onselectstart!==u&&(document.onselectstart=u)};return mr(kr(t,"scrollbarElement"),"mousemove",w),mr(kr(t,"scrollbarElement"),"mouseleave",C),(E,A)=>(I(),Se(Ss,{name:v(n).b("fade"),persisted:""},{default:pe(()=>[zt(Q("div",{ref_key:"instance",ref:r,class:N([v(n).e("bar"),v(n).is(v(d).key)]),onMousedown:g},[Q("div",{ref_key:"thumb",ref:s,class:N(v(n).e("thumb")),style:pt(v(h)),onMousedown:m},null,38)],34),[[Ei,E.always||o.value]])]),_:1},8,["name"]))}});var yq=qe(Fke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/thumb.vue"]]);const Nke=Ke({always:{type:Boolean,default:!0},width:String,height:String,ratioX:{type:Number,default:1},ratioY:{type:Number,default:1}}),Vke=de({__name:"bar",props:Nke,setup(i,{expose:e}){const t=i,n=W(0),r=W(0);return e({handleScroll:a=>{if(a){const o=a.offsetHeight-Rw,l=a.offsetWidth-Rw;r.value=a.scrollTop*100/o*t.ratioY,n.value=a.scrollLeft*100/l*t.ratioX}}}),(a,o)=>(I(),Z(gt,null,[re(yq,{move:n.value,ratio:a.ratioX,size:a.width,always:a.always},null,8,["move","ratio","size","always"]),re(yq,{move:r.value,ratio:a.ratioY,size:a.height,vertical:"",always:a.always},null,8,["move","ratio","size","always"])],64))}});var Bke=qe(Vke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/bar.vue"]]);const zke=Ke({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:xe([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20}}),Uke={scroll:({scrollTop:i,scrollLeft:e})=>[i,e].every(It)},Hke="ElScrollbar",Gke=de({name:Hke}),Wke=de({...Gke,props:zke,emits:Uke,setup(i,{expose:e,emit:t}){const n=i,r=Ne("scrollbar");let s,a;const o=W(),l=W(),c=W(),u=W("0"),d=W("0"),h=W(),p=W(1),m=W(1),g=R(()=>{const A={};return n.height&&(A.height=Xs(n.height)),n.maxHeight&&(A.maxHeight=Xs(n.maxHeight)),[n.wrapStyle,A]}),_=R(()=>[n.wrapClass,r.e("wrap"),{[r.em("wrap","hidden-default")]:!n.native}]),b=R(()=>[r.e("view"),n.viewClass]),x=()=>{var A;l.value&&((A=h.value)==null||A.handleScroll(l.value),t("scroll",{scrollTop:l.value.scrollTop,scrollLeft:l.value.scrollLeft}))};function w(A,P){oi(A)?l.value.scrollTo(A):It(A)&&It(P)&&l.value.scrollTo(A,P)}const C=A=>{It(A)&&(l.value.scrollTop=A)},S=A=>{It(A)&&(l.value.scrollLeft=A)},E=()=>{if(!l.value)return;const A=l.value.offsetHeight-Rw,P=l.value.offsetWidth-Rw,O=A**2/l.value.scrollHeight,M=P**2/l.value.scrollWidth,V=Math.max(O,n.minSize),L=Math.max(M,n.minSize);p.value=O/(A-O)/(V/(A-V)),m.value=M/(P-M)/(L/(P-L)),d.value=V+Rw<A?`${V}px`:"",u.value=L+Rw<P?`${L}px`:""};return Ve(()=>n.noresize,A=>{A?(s==null||s(),a==null||a()):({stop:s}=fl(c,E),a=mr("resize",E))},{immediate:!0}),Ve(()=>[n.maxHeight,n.height],()=>{n.native||ut(()=>{var A;E(),l.value&&((A=h.value)==null||A.handleScroll(l.value))})}),pi(Nae,Ji({scrollbarElement:o,wrapElement:l})),qt(()=>{n.native||ut(()=>{E()})}),pg(()=>E()),e({wrapRef:l,update:E,scrollTo:w,setScrollTop:C,setScrollLeft:S,handleScroll:x}),(A,P)=>(I(),Z("div",{ref_key:"scrollbarRef",ref:o,class:N(v(r).b())},[Q("div",{ref_key:"wrapRef",ref:l,class:N(v(_)),style:pt(v(g)),onScroll:x},[(I(),Se(hi(A.tag),{ref_key:"resizeRef",ref:c,class:N(v(b)),style:pt(A.viewStyle)},{default:pe(()=>[Fe(A.$slots,"default")]),_:3},8,["class","style"]))],38),A.native?_e("v-if",!0):(I(),Se(Bke,{key:0,ref_key:"barRef",ref:h,height:d.value,width:u.value,always:A.always,"ratio-x":m.value,"ratio-y":p.value},null,8,["height","width","always","ratio-x","ratio-y"]))],2))}});var jke=qe(Wke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/scrollbar/src/scrollbar.vue"]]);const _g=ii(jke),qke=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],xoe=Ke({role:{type:String,values:qke,default:"tooltip"}}),Kke=de({name:"ElPopperRoot",inheritAttrs:!1}),Yke=de({...Kke,props:xoe,setup(i,{expose:e}){const t=i,n=W(),r=W(),s=W(),a=W(),o=R(()=>t.role),l={triggerRef:n,popperInstanceRef:r,contentRef:s,referenceRef:a,role:o};return e(l),pi(c9,l),(c,u)=>Fe(c.$slots,"default")}});var Xke=qe(Yke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/popper.vue"]]);const Coe=Ke({arrowOffset:{type:Number,default:5}}),Zke=de({name:"ElPopperArrow",inheritAttrs:!1}),Qke=de({...Zke,props:Coe,setup(i,{expose:e}){const t=i,n=Ne("popper"),{arrowOffset:r,arrowRef:s}=ht(zae,void 0);return Ve(()=>t.arrowOffset,a=>{r.value=a}),Vr(()=>{s.value=void 0}),e({arrowRef:s}),(a,o)=>(I(),Z("span",{ref_key:"arrowRef",ref:s,class:N(v(n).e("arrow")),"data-popper-arrow":""},null,2))}});var Jke=qe(Qke,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/arrow.vue"]]);const eFe="ElOnlyChild",Toe=de({name:eFe,setup(i,{slots:e,attrs:t}){var n;const r=ht(loe),s=RDe((n=r==null?void 0:r.setForwardRef)!=null?n:yn);return()=>{var a;const o=(a=e.default)==null?void 0:a.call(e,t);if(!o||o.length>1)return null;const l=Soe(o);return l?zt(Km(l,t),[[s]]):null}}});function Soe(i){if(!i)return null;const e=i;for(const t of e){if(oi(t))switch(t.type){case Gl:continue;case NC:case"svg":return _q(t);case gt:return Soe(t.children);default:return t}return _q(t)}return null}function _q(i){const e=Ne("only-child");return re("span",{class:e.e("content")},[i])}const Eoe=Ke({virtualRef:{type:xe(Object)},virtualTriggering:Boolean,onMouseenter:{type:xe(Function)},onMouseleave:{type:xe(Function)},onClick:{type:xe(Function)},onKeydown:{type:xe(Function)},onFocus:{type:xe(Function)},onBlur:{type:xe(Function)},onContextmenu:{type:xe(Function)},id:String,open:Boolean}),tFe=de({name:"ElPopperTrigger",inheritAttrs:!1}),iFe=de({...tFe,props:Eoe,setup(i,{expose:e}){const t=i,{role:n,triggerRef:r}=ht(c9,void 0);ODe(r);const s=R(()=>o.value?t.id:void 0),a=R(()=>{if(n&&n.value==="tooltip")return t.open&&t.id?t.id:void 0}),o=R(()=>{if(n&&n.value!=="tooltip")return n.value}),l=R(()=>o.value?`${t.open}`:void 0);let c;return qt(()=>{Ve(()=>t.virtualRef,u=>{u&&(r.value=Mu(u))},{immediate:!0}),Ve(r,(u,d)=>{c==null||c(),c=void 0,Oh(u)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(h=>{var p;const m=t[h];m&&(u.addEventListener(h.slice(2).toLowerCase(),m),(p=d==null?void 0:d.removeEventListener)==null||p.call(d,h.slice(2).toLowerCase(),m))}),c=Ve([s,a,o,l],h=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((p,m)=>{so(h[m])?u.removeAttribute(p):u.setAttribute(p,h[m])})},{immediate:!0})),Oh(d)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(h=>d.removeAttribute(h))},{immediate:!0})}),Vr(()=>{c==null||c(),c=void 0}),e({triggerRef:r}),(u,d)=>u.virtualTriggering?_e("v-if",!0):(I(),Se(v(Toe),ci({key:0},u.$attrs,{"aria-controls":v(s),"aria-describedby":v(a),"aria-expanded":v(l),"aria-haspopup":v(o)}),{default:pe(()=>[Fe(u.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var nFe=qe(iFe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/trigger.vue"]]);const _k="focus-trap.focus-after-trapped",bk="focus-trap.focus-after-released",rFe="focus-trap.focusout-prevented",bq={cancelable:!0,bubbles:!1},sFe={cancelable:!0,bubbles:!1},wq="focusAfterTrapped",xq="focusAfterReleased",S9=Symbol("elFocusTrap"),E9=W(),B3=W(0),A9=W(0);let XM=0;const Aoe=i=>{const e=[],t=document.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e},Cq=(i,e)=>{for(const t of i)if(!aFe(t,e))return t},aFe=(i,e)=>{if(getComputedStyle(i).visibility==="hidden")return!0;for(;i;){if(e&&i===e)return!1;if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1},oFe=i=>{const e=Aoe(i),t=Cq(e,i),n=Cq(e.reverse(),i);return[t,n]},lFe=i=>i instanceof HTMLInputElement&&"select"in i,tv=(i,e)=>{if(i&&i.focus){const t=document.activeElement;i.focus({preventScroll:!0}),A9.value=window.performance.now(),i!==t&&lFe(i)&&e&&i.select()}};function Tq(i,e){const t=[...i],n=i.indexOf(e);return n!==-1&&t.splice(n,1),t}const cFe=()=>{let i=[];return{push:n=>{const r=i[0];r&&n!==r&&r.pause(),i=Tq(i,n),i.unshift(n)},remove:n=>{var r,s;i=Tq(i,n),(s=(r=i[0])==null?void 0:r.resume)==null||s.call(r)}}},uFe=(i,e=!1)=>{const t=document.activeElement;for(const n of i)if(tv(n,e),document.activeElement!==t)return},Sq=cFe(),dFe=()=>B3.value>A9.value,ZM=()=>{E9.value="pointer",B3.value=window.performance.now()},Eq=()=>{E9.value="keyboard",B3.value=window.performance.now()},hFe=()=>(qt(()=>{XM===0&&(document.addEventListener("mousedown",ZM),document.addEventListener("touchstart",ZM),document.addEventListener("keydown",Eq)),XM++}),Vr(()=>{XM--,XM<=0&&(document.removeEventListener("mousedown",ZM),document.removeEventListener("touchstart",ZM),document.removeEventListener("keydown",Eq))}),{focusReason:E9,lastUserFocusTimestamp:B3,lastAutomatedFocusTimestamp:A9}),QM=i=>new CustomEvent(rFe,{...sFe,detail:i}),pFe=de({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[wq,xq,"focusin","focusout","focusout-prevented","release-requested"],setup(i,{emit:e}){const t=W();let n,r;const{focusReason:s}=hFe();EDe(m=>{i.trapped&&!a.paused&&e("release-requested",m)});const a={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},o=m=>{if(!i.loop&&!i.trapped||a.paused)return;const{key:g,altKey:_,ctrlKey:b,metaKey:x,currentTarget:w,shiftKey:C}=m,{loop:S}=i,E=g===wt.tab&&!_&&!b&&!x,A=document.activeElement;if(E&&A){const P=w,[O,M]=oFe(P);if(O&&M){if(!C&&A===M){const L=QM({focusReason:s.value});e("focusout-prevented",L),L.defaultPrevented||(m.preventDefault(),S&&tv(O,!0))}else if(C&&[O,P].includes(A)){const L=QM({focusReason:s.value});e("focusout-prevented",L),L.defaultPrevented||(m.preventDefault(),S&&tv(M,!0))}}else if(A===P){const L=QM({focusReason:s.value});e("focusout-prevented",L),L.defaultPrevented||m.preventDefault()}}};pi(S9,{focusTrapRef:t,onKeydown:o}),Ve(()=>i.focusTrapEl,m=>{m&&(t.value=m)},{immediate:!0}),Ve([t],([m],[g])=>{m&&(m.addEventListener("keydown",o),m.addEventListener("focusin",u),m.addEventListener("focusout",d)),g&&(g.removeEventListener("keydown",o),g.removeEventListener("focusin",u),g.removeEventListener("focusout",d))});const l=m=>{e(wq,m)},c=m=>e(xq,m),u=m=>{const g=v(t);if(!g)return;const _=m.target,b=m.relatedTarget,x=_&&g.contains(_);i.trapped||b&&g.contains(b)||(n=b),x&&e("focusin",m),!a.paused&&i.trapped&&(x?r=_:tv(r,!0))},d=m=>{const g=v(t);if(!(a.paused||!g))if(i.trapped){const _=m.relatedTarget;!so(_)&&!g.contains(_)&&setTimeout(()=>{if(!a.paused&&i.trapped){const b=QM({focusReason:s.value});e("focusout-prevented",b),b.defaultPrevented||tv(r,!0)}},0)}else{const _=m.target;_&&g.contains(_)||e("focusout",m)}};async function h(){await ut();const m=v(t);if(m){Sq.push(a);const g=m.contains(document.activeElement)?n:document.activeElement;if(n=g,!m.contains(g)){const b=new Event(_k,bq);m.addEventListener(_k,l),m.dispatchEvent(b),b.defaultPrevented||ut(()=>{let x=i.focusStartEl;Ft(x)||(tv(x),document.activeElement!==x&&(x="first")),x==="first"&&uFe(Aoe(m),!0),(document.activeElement===g||x==="container")&&tv(m)})}}}function p(){const m=v(t);if(m){m.removeEventListener(_k,l);const g=new CustomEvent(bk,{...bq,detail:{focusReason:s.value}});m.addEventListener(bk,c),m.dispatchEvent(g),!g.defaultPrevented&&(s.value=="keyboard"||!dFe())&&tv(n??document.body),m.removeEventListener(bk,l),Sq.remove(a)}}return qt(()=>{i.trapped&&h(),Ve(()=>i.trapped,m=>{m?h():p()})}),Vr(()=>{i.trapped&&p()}),{onKeydown:o}}});function fFe(i,e,t,n,r,s){return Fe(i.$slots,"default",{handleKeydown:i.onKeydown})}var z3=qe(pFe,[["render",fFe],["__file","/home/runner/work/element-plus/element-plus/packages/components/focus-trap/src/focus-trap.vue"]]);const mFe=["fixed","absolute"],gFe=Ke({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:xe(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Ib,default:"bottom"},popperOptions:{type:xe(Object),default:()=>({})},strategy:{type:String,values:mFe,default:"absolute"}}),Moe=Ke({...gFe,id:String,style:{type:xe([String,Array,Object])},className:{type:xe([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:xe([String,Array,Object])},popperStyle:{type:xe([String,Array,Object])},referenceEl:{type:xe(Object)},triggerTargetEl:{type:xe(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),vFe={mouseenter:i=>i instanceof MouseEvent,mouseleave:i=>i instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},Aq=(i,e)=>{const{placement:t,strategy:n,popperOptions:r}=i,s={placement:t,strategy:n,...r,modifiers:_Fe(i)};return bFe(s,e),wFe(s,r==null?void 0:r.modifiers),s},yFe=i=>{if(Ii)return Mu(i)};function _Fe(i){const{offset:e,gpuAcceleration:t,fallbackPlacements:n}=i;return[{name:"offset",options:{offset:[0,e??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:n}},{name:"computeStyles",options:{gpuAcceleration:t}}]}function bFe(i,{arrowEl:e,arrowOffset:t}){i.modifiers.push({name:"arrow",options:{element:e,padding:t??5}})}function wFe(i,e){e&&(i.modifiers=[...i.modifiers,...e??[]])}const xFe=de({name:"ElPopperContent"}),CFe=de({...xFe,props:Moe,emits:vFe,setup(i,{expose:e,emit:t}){const n=i,{popperInstanceRef:r,contentRef:s,triggerRef:a,role:o}=ht(c9,void 0),l=ht(uf,void 0),{nextZIndex:c}=yg(),u=Ne("popper"),d=W(),h=W("first"),p=W(),m=W();pi(zae,{arrowRef:p,arrowOffset:m}),l&&(l.addInputId||l.removeInputId)&&pi(uf,{...l,addInputId:yn,removeInputId:yn});const g=W(n.zIndex||c()),_=W(!1);let b;const x=R(()=>yFe(n.referenceEl)||v(a)),w=R(()=>[{zIndex:v(g)},n.popperStyle]),C=R(()=>[u.b(),u.is("pure",n.pure),u.is(n.effect),n.popperClass]),S=R(()=>o&&o.value==="dialog"?"false":void 0),E=({referenceEl:G,popperContentEl:H,arrowEl:k})=>{const D=Aq(n,{arrowEl:k,arrowOffset:v(m)});return soe(G,H,D)},A=(G=!0)=>{var H;(H=v(r))==null||H.update(),G&&(g.value=n.zIndex||c())},P=()=>{var G,H;const k={name:"eventListeners",enabled:n.visible};(H=(G=v(r))==null?void 0:G.setOptions)==null||H.call(G,D=>({...D,modifiers:[...D.modifiers||[],k]})),A(!1),n.visible&&n.focusOnShow?_.value=!0:n.visible===!1&&(_.value=!1)},O=()=>{t("focus")},M=G=>{var H;((H=G.detail)==null?void 0:H.focusReason)!=="pointer"&&(h.value="first",t("blur"))},V=G=>{n.visible&&!_.value&&(G.target&&(h.value=G.target),_.value=!0)},L=G=>{n.trapping||(G.detail.focusReason==="pointer"&&G.preventDefault(),_.value=!1)},U=()=>{_.value=!1,t("close")};return qt(()=>{let G;Ve(x,H=>{var k;G==null||G();const D=v(r);if((k=D==null?void 0:D.destroy)==null||k.call(D),H){const $=v(d);s.value=$,r.value=E({referenceEl:H,popperContentEl:$,arrowEl:v(p)}),G=Ve(()=>H.getBoundingClientRect(),()=>A(),{immediate:!0})}else r.value=void 0},{immediate:!0}),Ve(()=>n.triggerTargetEl,(H,k)=>{b==null||b(),b=void 0;const D=v(H||d.value),$=v(k||d.value);Oh(D)&&(b=Ve([o,()=>n.ariaLabel,S,()=>n.id],F=>{["role","aria-label","aria-modal","id"].forEach((Y,ne)=>{so(F[ne])?D.removeAttribute(Y):D.setAttribute(Y,F[ne])})},{immediate:!0})),$!==D&&Oh($)&&["role","aria-label","aria-modal","id"].forEach(F=>{$.removeAttribute(F)})},{immediate:!0}),Ve(()=>n.visible,P,{immediate:!0}),Ve(()=>Aq(n,{arrowEl:v(p),arrowOffset:v(m)}),H=>{var k;return(k=r.value)==null?void 0:k.setOptions(H)})}),Vr(()=>{b==null||b(),b=void 0}),e({popperContentRef:d,popperInstanceRef:r,updatePopper:A,contentStyle:w}),(G,H)=>(I(),Z("div",{ref_key:"popperContentRef",ref:d,style:pt(v(w)),class:N(v(C)),tabindex:"-1",onMouseenter:H[0]||(H[0]=k=>G.$emit("mouseenter",k)),onMouseleave:H[1]||(H[1]=k=>G.$emit("mouseleave",k))},[re(v(z3),{trapped:_.value,"trap-on-focus-in":!0,"focus-trap-el":d.value,"focus-start-el":h.value,onFocusAfterTrapped:O,onFocusAfterReleased:M,onFocusin:V,onFocusoutPrevented:L,onReleaseRequested:U},{default:pe(()=>[Fe(G.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el"])],38))}});var TFe=qe(CFe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popper/src/content.vue"]]);const Poe=ii(Xke),SFe=Ne("tooltip"),Xa=Ke({...PDe,...Moe,appendTo:{type:xe([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:xe(Boolean),default:null},transition:{type:String,default:`${SFe.namespace.value}-fade-in-linear`},teleported:{type:Boolean,default:!0},disabled:{type:Boolean}}),q2=Ke({...Eoe,disabled:Boolean,trigger:{type:xe([String,Array]),default:"hover"},triggerKeys:{type:xe(Array),default:()=>[wt.enter,wt.space]}}),{useModelToggleProps:EFe,useModelToggleEmits:AFe,useModelToggle:MFe}=w3e("visible"),PFe=Ke({...xoe,...EFe,...Xa,...q2,...Coe,showArrow:{type:Boolean,default:!0}}),OFe=[...AFe,"before-show","before-hide","show","hide","open","close"],RFe=(i,e)=>st(i)?i.includes(e):i===e,Xb=(i,e,t)=>n=>{RFe(v(i),e)&&t(n)},IFe=de({name:"ElTooltipTrigger"}),$Fe=de({...IFe,props:q2,setup(i,{expose:e}){const t=i,n=Ne("tooltip"),{controlled:r,id:s,open:a,onOpen:o,onClose:l,onToggle:c}=ht(L3,void 0),u=W(null),d=()=>{if(v(r)||t.disabled)return!0},h=kr(t,"trigger"),p=Hr(d,Xb(h,"hover",o)),m=Hr(d,Xb(h,"hover",l)),g=Hr(d,Xb(h,"click",C=>{C.button===0&&c(C)})),_=Hr(d,Xb(h,"focus",o)),b=Hr(d,Xb(h,"focus",l)),x=Hr(d,Xb(h,"contextmenu",C=>{C.preventDefault(),c(C)})),w=Hr(d,C=>{const{code:S}=C;t.triggerKeys.includes(S)&&(C.preventDefault(),c(C))});return e({triggerRef:u}),(C,S)=>(I(),Se(v(nFe),{id:v(s),"virtual-ref":C.virtualRef,open:v(a),"virtual-triggering":C.virtualTriggering,class:N(v(n).e("trigger")),onBlur:v(b),onClick:v(g),onContextmenu:v(x),onFocus:v(_),onMouseenter:v(p),onMouseleave:v(m),onKeydown:v(w)},{default:pe(()=>[Fe(C.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var LFe=qe($Fe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/trigger.vue"]]);const DFe=de({name:"ElTooltipContent",inheritAttrs:!1}),kFe=de({...DFe,props:Xa,setup(i,{expose:e}){const t=i,{selector:n}=aoe(),r=W(null),s=W(!1),{controlled:a,id:o,open:l,trigger:c,onClose:u,onOpen:d,onShow:h,onHide:p,onBeforeShow:m,onBeforeHide:g}=ht(L3,void 0),_=R(()=>t.persistent);Vr(()=>{s.value=!0});const b=R(()=>v(_)?!0:v(l)),x=R(()=>t.disabled?!1:v(l)),w=R(()=>t.appendTo||n.value),C=R(()=>{var H;return(H=t.style)!=null?H:{}}),S=R(()=>!v(l)),E=()=>{p()},A=()=>{if(v(a))return!0},P=Hr(A,()=>{t.enterable&&v(c)==="hover"&&d()}),O=Hr(A,()=>{v(c)==="hover"&&u()}),M=()=>{var H,k;(k=(H=r.value)==null?void 0:H.updatePopper)==null||k.call(H),m==null||m()},V=()=>{g==null||g()},L=()=>{h(),G=e9(R(()=>{var H;return(H=r.value)==null?void 0:H.popperContentRef}),()=>{if(v(a))return;v(c)!=="hover"&&u()})},U=()=>{t.virtualTriggering||u()};let G;return Ve(()=>v(l),H=>{H||G==null||G()},{flush:"post"}),Ve(()=>t.content,()=>{var H,k;(k=(H=r.value)==null?void 0:H.updatePopper)==null||k.call(H)}),e({contentRef:r}),(H,k)=>(I(),Se(QA,{disabled:!H.teleported,to:v(w)},[re(Ss,{name:H.transition,onAfterLeave:E,onBeforeEnter:M,onAfterEnter:L,onBeforeLeave:V},{default:pe(()=>[v(b)?zt((I(),Se(v(TFe),ci({key:0,id:v(o),ref_key:"contentRef",ref:r},H.$attrs,{"aria-label":H.ariaLabel,"aria-hidden":v(S),"boundaries-padding":H.boundariesPadding,"fallback-placements":H.fallbackPlacements,"gpu-acceleration":H.gpuAcceleration,offset:H.offset,placement:H.placement,"popper-options":H.popperOptions,strategy:H.strategy,effect:H.effect,enterable:H.enterable,pure:H.pure,"popper-class":H.popperClass,"popper-style":[H.popperStyle,v(C)],"reference-el":H.referenceEl,"trigger-target-el":H.triggerTargetEl,visible:v(x),"z-index":H.zIndex,onMouseenter:v(P),onMouseleave:v(O),onBlur:U,onClose:v(u)}),{default:pe(()=>[s.value?_e("v-if",!0):Fe(H.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[Ei,v(x)]]):_e("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var FFe=qe(kFe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/content.vue"]]);const NFe=["innerHTML"],VFe={key:1},BFe=de({name:"ElTooltip"}),zFe=de({...BFe,props:PFe,emits:OFe,setup(i,{expose:e,emit:t}){const n=i;MDe();const r=Ih(),s=W(),a=W(),o=()=>{var b;const x=v(s);x&&((b=x.popperInstanceRef)==null||b.update())},l=W(!1),c=W(),{show:u,hide:d,hasUpdateHandler:h}=MFe({indicator:l,toggleReason:c}),{onOpen:p,onClose:m}=ooe({showAfter:kr(n,"showAfter"),hideAfter:kr(n,"hideAfter"),open:u,close:d}),g=R(()=>Ys(n.visible)&&!h.value);pi(L3,{controlled:g,id:r,open:FC(l),trigger:kr(n,"trigger"),onOpen:b=>{p(b)},onClose:b=>{m(b)},onToggle:b=>{v(l)?m(b):p(b)},onShow:()=>{t("show",c.value)},onHide:()=>{t("hide",c.value)},onBeforeShow:()=>{t("before-show",c.value)},onBeforeHide:()=>{t("before-hide",c.value)},updatePopper:o}),Ve(()=>n.disabled,b=>{b&&l.value&&(l.value=!1)});const _=()=>{var b,x;const w=(x=(b=a.value)==null?void 0:b.contentRef)==null?void 0:x.popperContentRef;return w&&w.contains(document.activeElement)};return Jre(()=>l.value&&d()),e({popperRef:s,contentRef:a,isFocusInsideContent:_,updatePopper:o,onOpen:p,onClose:m,hide:d}),(b,x)=>(I(),Se(v(Poe),{ref_key:"popperRef",ref:s,role:b.role},{default:pe(()=>[re(LFe,{disabled:b.disabled,trigger:b.trigger,"trigger-keys":b.triggerKeys,"virtual-ref":b.virtualRef,"virtual-triggering":b.virtualTriggering},{default:pe(()=>[b.$slots.default?Fe(b.$slots,"default",{key:0}):_e("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),re(FFe,{ref_key:"contentRef",ref:a,"aria-label":b.ariaLabel,"boundaries-padding":b.boundariesPadding,content:b.content,disabled:b.disabled,effect:b.effect,enterable:b.enterable,"fallback-placements":b.fallbackPlacements,"hide-after":b.hideAfter,"gpu-acceleration":b.gpuAcceleration,offset:b.offset,persistent:b.persistent,"popper-class":b.popperClass,"popper-style":b.popperStyle,placement:b.placement,"popper-options":b.popperOptions,pure:b.pure,"raw-content":b.rawContent,"reference-el":b.referenceEl,"trigger-target-el":b.triggerTargetEl,"show-after":b.showAfter,strategy:b.strategy,teleported:b.teleported,transition:b.transition,"virtual-triggering":b.virtualTriggering,"z-index":b.zIndex,"append-to":b.appendTo},{default:pe(()=>[Fe(b.$slots,"content",{},()=>[b.rawContent?(I(),Z("span",{key:0,innerHTML:b.content},null,8,NFe)):(I(),Z("span",VFe,We(b.content),1))]),b.showArrow?(I(),Se(v(Jke),{key:0,"arrow-offset":b.arrowOffset},null,8,["arrow-offset"])):_e("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var UFe=qe(zFe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip/src/tooltip.vue"]]);const Jl=ii(UFe),HFe=Ke({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:xe(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:xe([Function,Array]),default:yn},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},label:{type:String},teleported:Xa.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1}}),GFe={[ri]:i=>Ft(i),[jl]:i=>Ft(i),[rr]:i=>Ft(i),focus:i=>i instanceof FocusEvent,blur:i=>i instanceof FocusEvent,clear:()=>!0,select:i=>oi(i)},WFe=["aria-expanded","aria-owns"],jFe={key:0},qFe=["id","aria-selected","onClick"],Ooe="ElAutocomplete",KFe=de({name:Ooe,inheritAttrs:!1}),YFe=de({...KFe,props:HFe,emits:GFe,setup(i,{expose:e,emit:t}){const n=i,r=l9(),s=VC(),a=zc(),o=Ne("autocomplete"),l=W(),c=W(),u=W(),d=W();let h=!1,p=!1;const m=W([]),g=W(-1),_=W(""),b=W(!1),x=W(!1),w=W(!1),C=R(()=>o.b(String(I3()))),S=R(()=>s.style),E=R(()=>(m.value.length>0||w.value)&&b.value),A=R(()=>!n.hideLoading&&w.value),P=R(()=>l.value?Array.from(l.value.$el.querySelectorAll("input")):[]),O=async()=>{await ut(),E.value&&(_.value=`${l.value.$el.offsetWidth}px`)},M=()=>{p=!0},V=()=>{p=!1,g.value=-1},U=Zl(async ce=>{if(x.value)return;const ae=le=>{w.value=!1,!x.value&&(st(le)?(m.value=le,g.value=n.highlightFirstItem?0:-1):ba(Ooe,"autocomplete suggestions must be an array"))};if(w.value=!0,st(n.fetchSuggestions))ae(n.fetchSuggestions);else{const le=await n.fetchSuggestions(ce,ae);st(le)&&ae(le)}},n.debounce),G=ce=>{const ae=!!ce;if(t(jl,ce),t(ri,ce),x.value=!1,b.value||(b.value=ae),!n.triggerOnFocus&&!ce){x.value=!0,m.value=[];return}U(ce)},H=ce=>{var ae;a.value||(((ae=ce.target)==null?void 0:ae.tagName)!=="INPUT"||P.value.includes(document.activeElement))&&(b.value=!0)},k=ce=>{t(rr,ce)},D=ce=>{p||(b.value=!0,t("focus",ce),n.triggerOnFocus&&!h&&U(String(n.modelValue)))},$=ce=>{p||t("blur",ce)},F=()=>{b.value=!1,t(ri,""),t("clear")},Y=async()=>{E.value&&g.value>=0&&g.value<m.value.length?ye(m.value[g.value]):n.selectWhenUnmatched&&(t("select",{value:n.modelValue}),m.value=[],g.value=-1)},ne=ce=>{E.value&&(ce.preventDefault(),ce.stopPropagation(),X())},X=()=>{b.value=!1},J=()=>{var ce;(ce=l.value)==null||ce.focus()},he=()=>{var ce;(ce=l.value)==null||ce.blur()},ye=async ce=>{t(jl,ce[n.valueKey]),t(ri,ce[n.valueKey]),t("select",ce),m.value=[],g.value=-1},Te=ce=>{if(!E.value||w.value)return;if(ce<0){g.value=-1;return}ce>=m.value.length&&(ce=m.value.length-1);const ae=c.value.querySelector(`.${o.be("suggestion","wrap")}`),fe=ae.querySelectorAll(`.${o.be("suggestion","list")} li`)[ce],Ue=ae.scrollTop,{offsetTop:ie,scrollHeight:oe}=fe;ie+oe>Ue+ae.clientHeight&&(ae.scrollTop+=oe),ie<Ue&&(ae.scrollTop-=oe),g.value=ce,l.value.ref.setAttribute("aria-activedescendant",`${C.value}-item-${g.value}`)};return e9(d,()=>{E.value&&X()}),qt(()=>{l.value.ref.setAttribute("role","textbox"),l.value.ref.setAttribute("aria-autocomplete","list"),l.value.ref.setAttribute("aria-controls","id"),l.value.ref.setAttribute("aria-activedescendant",`${C.value}-item-${g.value}`),h=l.value.ref.hasAttribute("readonly")}),e({highlightedIndex:g,activated:b,loading:w,inputRef:l,popperRef:u,suggestions:m,handleSelect:ye,handleKeyEnter:Y,focus:J,blur:he,close:X,highlight:Te}),(ce,ae)=>(I(),Se(v(Jl),{ref_key:"popperRef",ref:u,visible:v(E),placement:ce.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[v(o).e("popper"),ce.popperClass],teleported:ce.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${v(o).namespace.value}-zoom-in-top`,persistent:"",onBeforeShow:O,onShow:M,onHide:V},{content:pe(()=>[Q("div",{ref_key:"regionRef",ref:c,class:N([v(o).b("suggestion"),v(o).is("loading",v(A))]),style:pt({[ce.fitInputWidth?"width":"minWidth"]:_.value,outline:"none"}),role:"region"},[re(v(_g),{id:v(C),tag:"ul","wrap-class":v(o).be("suggestion","wrap"),"view-class":v(o).be("suggestion","list"),role:"listbox"},{default:pe(()=>[v(A)?(I(),Z("li",jFe,[re(v(ct),{class:N(v(o).is("loading"))},{default:pe(()=>[re(v(Vy))]),_:1},8,["class"])])):(I(!0),Z(gt,{key:1},xi(m.value,(le,fe)=>(I(),Z("li",{id:`${v(C)}-item-${fe}`,key:fe,class:N({highlighted:g.value===fe}),role:"option","aria-selected":g.value===fe,onClick:Ue=>ye(le)},[Fe(ce.$slots,"default",{item:le},()=>[Gi(We(le[ce.valueKey]),1)])],10,qFe))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:pe(()=>[Q("div",{ref_key:"listboxRef",ref:d,class:N([v(o).b(),ce.$attrs.class]),style:pt(v(S)),role:"combobox","aria-haspopup":"listbox","aria-expanded":v(E),"aria-owns":v(C)},[re(v(ol),ci({ref_key:"inputRef",ref:l},v(r),{"model-value":ce.modelValue,onInput:G,onChange:k,onFocus:D,onBlur:$,onClear:F,onKeydown:[ae[0]||(ae[0]=Di(Dt(le=>Te(g.value-1),["prevent"]),["up"])),ae[1]||(ae[1]=Di(Dt(le=>Te(g.value+1),["prevent"]),["down"])),Di(Y,["enter"]),Di(X,["tab"]),Di(ne,["esc"])],onMousedown:H}),qm({_:2},[ce.$slots.prepend?{name:"prepend",fn:pe(()=>[Fe(ce.$slots,"prepend")])}:void 0,ce.$slots.append?{name:"append",fn:pe(()=>[Fe(ce.$slots,"append")])}:void 0,ce.$slots.prefix?{name:"prefix",fn:pe(()=>[Fe(ce.$slots,"prefix")])}:void 0,ce.$slots.suffix?{name:"suffix",fn:pe(()=>[Fe(ce.$slots,"suffix")])}:void 0]),1040,["model-value","onKeydown"])],14,WFe)]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var XFe=qe(YFe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/autocomplete/src/autocomplete.vue"]]);const ZFe=ii(XFe),QFe=Ke({size:{type:[Number,String],values:gg,default:"",validator:i=>It(i)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:Zn},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:xe(String),default:"cover"}}),JFe={error:i=>i instanceof Event},e4e=["src","alt","srcset"],t4e=de({name:"ElAvatar"}),i4e=de({...t4e,props:QFe,emits:JFe,setup(i,{emit:e}){const t=i,n=Ne("avatar"),r=W(!1),s=R(()=>{const{size:c,icon:u,shape:d}=t,h=[n.b()];return Ft(c)&&h.push(n.m(c)),u&&h.push(n.m("icon")),d&&h.push(n.m(d)),h}),a=R(()=>{const{size:c}=t;return It(c)?n.cssVarBlock({size:Xs(c)||""}):void 0}),o=R(()=>({objectFit:t.fit}));Ve(()=>t.src,()=>r.value=!1);function l(c){r.value=!0,e("error",c)}return(c,u)=>(I(),Z("span",{class:N(v(s)),style:pt(v(a))},[(c.src||c.srcSet)&&!r.value?(I(),Z("img",{key:0,src:c.src,alt:c.alt,srcset:c.srcSet,style:pt(v(o)),onError:l},null,44,e4e)):c.icon?(I(),Se(v(ct),{key:1},{default:pe(()=>[(I(),Se(hi(c.icon)))]),_:1})):Fe(c.$slots,"default",{key:2})],6))}});var n4e=qe(i4e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/avatar/src/avatar.vue"]]);const r4e=ii(n4e),s4e={visibilityHeight:{type:Number,default:200},target:{type:String,default:""},right:{type:Number,default:40},bottom:{type:Number,default:40}},a4e={click:i=>i instanceof MouseEvent},o4e=(i,e,t)=>{const n=nr(),r=nr(),s=W(!1),a=()=>{if(!n.value)return;const u=Date.now(),d=n.value.scrollTop,h=()=>{if(!n.value)return;const p=(Date.now()-u)/500;p<1?(n.value.scrollTop=d*(1-l3e(p)),requestAnimationFrame(h)):n.value.scrollTop=0};requestAnimationFrame(h)},o=()=>{n.value&&(s.value=n.value.scrollTop>=i.visibilityHeight)},l=u=>{a(),e("click",u)},c=mae(o,300,!0);return mr(r,"scroll",c),qt(()=>{var u;r.value=document,n.value=document.documentElement,i.target&&(n.value=(u=document.querySelector(i.target))!=null?u:void 0,n.value||ba(t,`target does not exist: ${i.target}`),r.value=n.value)}),{visible:s,handleClick:l}},Roe="ElBacktop",l4e=de({name:Roe}),c4e=de({...l4e,props:s4e,emits:a4e,setup(i,{emit:e}){const t=i,n=Ne("backtop"),{handleClick:r,visible:s}=o4e(t,e,Roe),a=R(()=>({right:`${t.right}px`,bottom:`${t.bottom}px`}));return(o,l)=>(I(),Se(Ss,{name:`${v(n).namespace.value}-fade-in`},{default:pe(()=>[v(s)?(I(),Z("div",{key:0,style:pt(v(a)),class:N(v(n).b()),onClick:l[0]||(l[0]=Dt((...c)=>v(r)&&v(r)(...c),["stop"]))},[Fe(o.$slots,"default",{},()=>[re(v(ct),{class:N(v(n).e("icon"))},{default:pe(()=>[re(v(wRe))]),_:1},8,["class"])])],6)):_e("v-if",!0)]),_:3},8,["name"]))}});var u4e=qe(c4e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/backtop/src/backtop.vue"]]);const d4e=ii(u4e),h4e=Ke({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),p4e=["textContent"],f4e=de({name:"ElBadge"}),m4e=de({...f4e,props:h4e,setup(i,{expose:e}){const t=i,n=Ne("badge"),r=R(()=>t.isDot?"":It(t.value)&&It(t.max)?t.max<t.value?`${t.max}+`:`${t.value}`:`${t.value}`);return e({content:r}),(s,a)=>(I(),Z("div",{class:N(v(n).b())},[Fe(s.$slots,"default"),re(Ss,{name:`${v(n).namespace.value}-zoom-in-center`,persisted:""},{default:pe(()=>[zt(Q("sup",{class:N([v(n).e("content"),v(n).em("content",s.type),v(n).is("fixed",!!s.$slots.default),v(n).is("dot",s.isDot)]),textContent:We(v(r))},null,10,p4e),[[Ei,!s.hidden&&(v(r)||s.isDot)]])]),_:1},8,["name"])],2))}});var g4e=qe(m4e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/badge/src/badge.vue"]]);const Ioe=ii(g4e),v4e=Ke({separator:{type:String,default:"/"},separatorIcon:{type:Zn}}),y4e=de({name:"ElBreadcrumb"}),_4e=de({...y4e,props:v4e,setup(i){const e=i,t=Ne("breadcrumb"),n=W();return pi(Pae,e),qt(()=>{const r=n.value.querySelectorAll(`.${t.e("item")}`);r.length&&r[r.length-1].setAttribute("aria-current","page")}),(r,s)=>(I(),Z("div",{ref_key:"breadcrumb",ref:n,class:N(v(t).b()),"aria-label":"Breadcrumb",role:"navigation"},[Fe(r.$slots,"default")],2))}});var b4e=qe(_4e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/breadcrumb/src/breadcrumb.vue"]]);const w4e=Ke({to:{type:xe([String,Object]),default:""},replace:{type:Boolean,default:!1}}),x4e=de({name:"ElBreadcrumbItem"}),C4e=de({...x4e,props:w4e,setup(i){const e=i,t=ti(),n=ht(Pae,void 0),r=Ne("breadcrumb"),{separator:s,separatorIcon:a}=_a(n),o=t.appContext.config.globalProperties.$router,l=W(),c=()=>{!e.to||!o||(e.replace?o.replace(e.to):o.push(e.to))};return(u,d)=>(I(),Z("span",{class:N(v(r).e("item"))},[Q("span",{ref_key:"link",ref:l,class:N([v(r).e("inner"),v(r).is("link",!!u.to)]),role:"link",onClick:c},[Fe(u.$slots,"default")],2),v(a)?(I(),Se(v(ct),{key:0,class:N(v(r).e("separator"))},{default:pe(()=>[(I(),Se(hi(v(a))))]),_:1},8,["class"])):(I(),Z("span",{key:1,class:N(v(r).e("separator")),role:"presentation"},We(v(s)),3))],2))}});var $oe=qe(C4e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/breadcrumb/src/breadcrumb-item.vue"]]);const T4e=ii(b4e,{BreadcrumbItem:$oe}),S4e=Wr($oe),E4e=(i,e)=>{Ym({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},R(()=>i.type==="text"));const t=ht(Oae,void 0),n=vg("button"),{form:r}=nc(),s=Qs(R(()=>t==null?void 0:t.size)),a=zc(),o=W(),l=uo(),c=R(()=>i.type||(t==null?void 0:t.type)||""),u=R(()=>{var p,m,g;return(g=(m=i.autoInsertSpace)!=null?m:(p=n.value)==null?void 0:p.autoInsertSpace)!=null?g:!1}),d=R(()=>{var p;const m=(p=l.default)==null?void 0:p.call(l);if(u.value&&(m==null?void 0:m.length)===1){const g=m[0];if((g==null?void 0:g.type)===NC){const _=g.children;return/^\p{Unified_Ideograph}{2}$/u.test(_.trim())}}return!1});return{_disabled:a,_size:s,_type:c,_ref:o,shouldAddSpace:d,handleClick:p=>{i.nativeType==="reset"&&(r==null||r.resetFields()),e("click",p)}}},$5=["default","primary","success","warning","info","danger","text",""],A4e=["button","submit","reset"],L5=Ke({size:Ql,disabled:Boolean,type:{type:String,values:$5,default:""},icon:{type:Zn},nativeType:{type:String,values:A4e,default:"button"},loading:Boolean,loadingIcon:{type:Zn,default:()=>Vy},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0}}),M4e={click:i=>i instanceof MouseEvent};function Vo(i,e){P4e(i)&&(i="100%");var t=O4e(i);return i=e===360?i:Math.min(e,Math.max(0,parseFloat(i))),t&&(i=parseInt(String(i*e),10)/100),Math.abs(i-e)<1e-6?1:(e===360?i=(i<0?i%e+e:i%e)/parseFloat(String(e)):i=i%e/parseFloat(String(e)),i)}function JM(i){return Math.min(1,Math.max(0,i))}function P4e(i){return typeof i=="string"&&i.indexOf(".")!==-1&&parseFloat(i)===1}function O4e(i){return typeof i=="string"&&i.indexOf("%")!==-1}function Loe(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}function eP(i){return i<=1?"".concat(Number(i)*100,"%"):i}function _0(i){return i.length===1?"0"+i:String(i)}function R4e(i,e,t){return{r:Vo(i,255)*255,g:Vo(e,255)*255,b:Vo(t,255)*255}}function Mq(i,e,t){i=Vo(i,255),e=Vo(e,255),t=Vo(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s=0,a=0,o=(n+r)/2;if(n===r)a=0,s=0;else{var l=n-r;switch(a=o>.5?l/(2-n-r):l/(n+r),n){case i:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-i)/l+2;break;case t:s=(i-e)/l+4;break}s/=6}return{h:s,s:a,l:o}}function wk(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*(6*t):t<1/2?e:t<2/3?i+(e-i)*(2/3-t)*6:i}function I4e(i,e,t){var n,r,s;if(i=Vo(i,360),e=Vo(e,100),t=Vo(t,100),e===0)r=t,s=t,n=t;else{var a=t<.5?t*(1+e):t+e-t*e,o=2*t-a;n=wk(o,a,i+1/3),r=wk(o,a,i),s=wk(o,a,i-1/3)}return{r:n*255,g:r*255,b:s*255}}function Pq(i,e,t){i=Vo(i,255),e=Vo(e,255),t=Vo(t,255);var n=Math.max(i,e,t),r=Math.min(i,e,t),s=0,a=n,o=n-r,l=n===0?0:o/n;if(n===r)s=0;else{switch(n){case i:s=(e-t)/o+(e<t?6:0);break;case e:s=(t-i)/o+2;break;case t:s=(i-e)/o+4;break}s/=6}return{h:s,s:l,v:a}}function $4e(i,e,t){i=Vo(i,360)*6,e=Vo(e,100),t=Vo(t,100);var n=Math.floor(i),r=i-n,s=t*(1-e),a=t*(1-r*e),o=t*(1-(1-r)*e),l=n%6,c=[t,a,s,s,o,t][l],u=[o,t,t,a,s,s][l],d=[s,s,o,t,t,a][l];return{r:c*255,g:u*255,b:d*255}}function Oq(i,e,t,n){var r=[_0(Math.round(i).toString(16)),_0(Math.round(e).toString(16)),_0(Math.round(t).toString(16))];return n&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join("")}function L4e(i,e,t,n,r){var s=[_0(Math.round(i).toString(16)),_0(Math.round(e).toString(16)),_0(Math.round(t).toString(16)),_0(D4e(n))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function D4e(i){return Math.round(parseFloat(i)*255).toString(16)}function Rq(i){return Jc(i)/255}function Jc(i){return parseInt(i,16)}function k4e(i){return{r:i>>16,g:(i&65280)>>8,b:i&255}}var D5={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function F4e(i){var e={r:0,g:0,b:0},t=1,n=null,r=null,s=null,a=!1,o=!1;return typeof i=="string"&&(i=B4e(i)),typeof i=="object"&&(Ef(i.r)&&Ef(i.g)&&Ef(i.b)?(e=R4e(i.r,i.g,i.b),a=!0,o=String(i.r).substr(-1)==="%"?"prgb":"rgb"):Ef(i.h)&&Ef(i.s)&&Ef(i.v)?(n=eP(i.s),r=eP(i.v),e=$4e(i.h,n,r),a=!0,o="hsv"):Ef(i.h)&&Ef(i.s)&&Ef(i.l)&&(n=eP(i.s),s=eP(i.l),e=I4e(i.h,n,s),a=!0,o="hsl"),Object.prototype.hasOwnProperty.call(i,"a")&&(t=i.a)),t=Loe(t),{ok:a,format:i.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}var N4e="[-\\+]?\\d+%?",V4e="[-\\+]?\\d*\\.\\d+%?",Qv="(?:".concat(V4e,")|(?:").concat(N4e,")"),xk="[\\s|\\(]+(".concat(Qv,")[,|\\s]+(").concat(Qv,")[,|\\s]+(").concat(Qv,")\\s*\\)?"),Ck="[\\s|\\(]+(".concat(Qv,")[,|\\s]+(").concat(Qv,")[,|\\s]+(").concat(Qv,")[,|\\s]+(").concat(Qv,")\\s*\\)?"),Hd={CSS_UNIT:new RegExp(Qv),rgb:new RegExp("rgb"+xk),rgba:new RegExp("rgba"+Ck),hsl:new RegExp("hsl"+xk),hsla:new RegExp("hsla"+Ck),hsv:new RegExp("hsv"+xk),hsva:new RegExp("hsva"+Ck),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function B4e(i){if(i=i.trim().toLowerCase(),i.length===0)return!1;var e=!1;if(D5[i])i=D5[i],e=!0;else if(i==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t=Hd.rgb.exec(i);return t?{r:t[1],g:t[2],b:t[3]}:(t=Hd.rgba.exec(i),t?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=Hd.hsl.exec(i),t?{h:t[1],s:t[2],l:t[3]}:(t=Hd.hsla.exec(i),t?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=Hd.hsv.exec(i),t?{h:t[1],s:t[2],v:t[3]}:(t=Hd.hsva.exec(i),t?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=Hd.hex8.exec(i),t?{r:Jc(t[1]),g:Jc(t[2]),b:Jc(t[3]),a:Rq(t[4]),format:e?"name":"hex8"}:(t=Hd.hex6.exec(i),t?{r:Jc(t[1]),g:Jc(t[2]),b:Jc(t[3]),format:e?"name":"hex"}:(t=Hd.hex4.exec(i),t?{r:Jc(t[1]+t[1]),g:Jc(t[2]+t[2]),b:Jc(t[3]+t[3]),a:Rq(t[4]+t[4]),format:e?"name":"hex8"}:(t=Hd.hex3.exec(i),t?{r:Jc(t[1]+t[1]),g:Jc(t[2]+t[2]),b:Jc(t[3]+t[3]),format:e?"name":"hex"}:!1)))))))))}function Ef(i){return Boolean(Hd.CSS_UNIT.exec(String(i)))}var Doe=function(){function i(e,t){e===void 0&&(e=""),t===void 0&&(t={});var n;if(e instanceof i)return e;typeof e=="number"&&(e=k4e(e)),this.originalInput=e;var r=F4e(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=(n=t.format)!==null&&n!==void 0?n:r.format,this.gradientType=t.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return i.prototype.isDark=function(){return this.getBrightness()<128},i.prototype.isLight=function(){return!this.isDark()},i.prototype.getBrightness=function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},i.prototype.getLuminance=function(){var e=this.toRgb(),t,n,r,s=e.r/255,a=e.g/255,o=e.b/255;return s<=.03928?t=s/12.92:t=Math.pow((s+.055)/1.055,2.4),a<=.03928?n=a/12.92:n=Math.pow((a+.055)/1.055,2.4),o<=.03928?r=o/12.92:r=Math.pow((o+.055)/1.055,2.4),.2126*t+.7152*n+.0722*r},i.prototype.getAlpha=function(){return this.a},i.prototype.setAlpha=function(e){return this.a=Loe(e),this.roundA=Math.round(100*this.a)/100,this},i.prototype.isMonochrome=function(){var e=this.toHsl().s;return e===0},i.prototype.toHsv=function(){var e=Pq(this.r,this.g,this.b);return{h:e.h*360,s:e.s,v:e.v,a:this.a}},i.prototype.toHsvString=function(){var e=Pq(this.r,this.g,this.b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.v*100);return this.a===1?"hsv(".concat(t,", ").concat(n,"%, ").concat(r,"%)"):"hsva(".concat(t,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},i.prototype.toHsl=function(){var e=Mq(this.r,this.g,this.b);return{h:e.h*360,s:e.s,l:e.l,a:this.a}},i.prototype.toHslString=function(){var e=Mq(this.r,this.g,this.b),t=Math.round(e.h*360),n=Math.round(e.s*100),r=Math.round(e.l*100);return this.a===1?"hsl(".concat(t,", ").concat(n,"%, ").concat(r,"%)"):"hsla(".concat(t,", ").concat(n,"%, ").concat(r,"%, ").concat(this.roundA,")")},i.prototype.toHex=function(e){return e===void 0&&(e=!1),Oq(this.r,this.g,this.b,e)},i.prototype.toHexString=function(e){return e===void 0&&(e=!1),"#"+this.toHex(e)},i.prototype.toHex8=function(e){return e===void 0&&(e=!1),L4e(this.r,this.g,this.b,this.a,e)},i.prototype.toHex8String=function(e){return e===void 0&&(e=!1),"#"+this.toHex8(e)},i.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},i.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),n=Math.round(this.b);return this.a===1?"rgb(".concat(e,", ").concat(t,", ").concat(n,")"):"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(this.roundA,")")},i.prototype.toPercentageRgb=function(){var e=function(t){return"".concat(Math.round(Vo(t,255)*100),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},i.prototype.toPercentageRgbString=function(){var e=function(t){return Math.round(Vo(t,255)*100)};return this.a===1?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},i.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var e="#"+Oq(this.r,this.g,this.b,!1),t=0,n=Object.entries(D5);t<n.length;t++){var r=n[t],s=r[0],a=r[1];if(e===a)return s}return!1},i.prototype.toString=function(e){var t=Boolean(e);e=e??this.format;var n=!1,r=this.a<1&&this.a>=0,s=!t&&r&&(e.startsWith("hex")||e==="name");return s?e==="name"&&this.a===0?this.toName():this.toRgbString():(e==="rgb"&&(n=this.toRgbString()),e==="prgb"&&(n=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(n=this.toHexString()),e==="hex3"&&(n=this.toHexString(!0)),e==="hex4"&&(n=this.toHex8String(!0)),e==="hex8"&&(n=this.toHex8String()),e==="name"&&(n=this.toName()),e==="hsl"&&(n=this.toHslString()),e==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},i.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},i.prototype.clone=function(){return new i(this.toString())},i.prototype.lighten=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l+=e/100,t.l=JM(t.l),new i(t)},i.prototype.brighten=function(e){e===void 0&&(e=10);var t=this.toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),new i(t)},i.prototype.darken=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.l-=e/100,t.l=JM(t.l),new i(t)},i.prototype.tint=function(e){return e===void 0&&(e=10),this.mix("white",e)},i.prototype.shade=function(e){return e===void 0&&(e=10),this.mix("black",e)},i.prototype.desaturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s-=e/100,t.s=JM(t.s),new i(t)},i.prototype.saturate=function(e){e===void 0&&(e=10);var t=this.toHsl();return t.s+=e/100,t.s=JM(t.s),new i(t)},i.prototype.greyscale=function(){return this.desaturate(100)},i.prototype.spin=function(e){var t=this.toHsl(),n=(t.h+e)%360;return t.h=n<0?360+n:n,new i(t)},i.prototype.mix=function(e,t){t===void 0&&(t=50);var n=this.toRgb(),r=new i(e).toRgb(),s=t/100,a={r:(r.r-n.r)*s+n.r,g:(r.g-n.g)*s+n.g,b:(r.b-n.b)*s+n.b,a:(r.a-n.a)*s+n.a};return new i(a)},i.prototype.analogous=function(e,t){e===void 0&&(e=6),t===void 0&&(t=30);var n=this.toHsl(),r=360/t,s=[this];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,s.push(new i(n));return s},i.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new i(e)},i.prototype.monochromatic=function(e){e===void 0&&(e=6);for(var t=this.toHsv(),n=t.h,r=t.s,s=t.v,a=[],o=1/e;e--;)a.push(new i({h:n,s:r,v:s})),s=(s+o)%1;return a},i.prototype.splitcomplement=function(){var e=this.toHsl(),t=e.h;return[this,new i({h:(t+72)%360,s:e.s,l:e.l}),new i({h:(t+216)%360,s:e.s,l:e.l})]},i.prototype.onBackground=function(e){var t=this.toRgb(),n=new i(e).toRgb();return new i({r:n.r+(t.r-n.r)*t.a,g:n.g+(t.g-n.g)*t.a,b:n.b+(t.b-n.b)*t.a})},i.prototype.triad=function(){return this.polyad(3)},i.prototype.tetrad=function(){return this.polyad(4)},i.prototype.polyad=function(e){for(var t=this.toHsl(),n=t.h,r=[this],s=360/e,a=1;a<e;a++)r.push(new i({h:(n+a*s)%360,s:t.s,l:t.l}));return r},i.prototype.equals=function(e){return this.toRgbString()===new i(e).toRgbString()},i}();function Pg(i,e=20){return i.mix("#141414",e).toString()}function z4e(i){const e=zc(),t=Ne("button");return R(()=>{let n={};const r=i.color;if(r){const s=new Doe(r),a=i.dark?s.tint(20).toString():Pg(s,20);if(i.plain)n=t.cssVarBlock({"bg-color":i.dark?Pg(s,90):s.tint(90).toString(),"text-color":r,"border-color":i.dark?Pg(s,50):s.tint(50).toString(),"hover-text-color":`var(${t.cssVarName("color-white")})`,"hover-bg-color":r,"hover-border-color":r,"active-bg-color":a,"active-text-color":`var(${t.cssVarName("color-white")})`,"active-border-color":a}),e.value&&(n[t.cssVarBlockName("disabled-bg-color")]=i.dark?Pg(s,90):s.tint(90).toString(),n[t.cssVarBlockName("disabled-text-color")]=i.dark?Pg(s,50):s.tint(50).toString(),n[t.cssVarBlockName("disabled-border-color")]=i.dark?Pg(s,80):s.tint(80).toString());else{const o=i.dark?Pg(s,30):s.tint(30).toString(),l=s.isDark()?`var(${t.cssVarName("color-white")})`:`var(${t.cssVarName("color-black")})`;if(n=t.cssVarBlock({"bg-color":r,"text-color":l,"border-color":r,"hover-bg-color":o,"hover-text-color":l,"hover-border-color":o,"active-bg-color":a,"active-border-color":a}),e.value){const c=i.dark?Pg(s,50):s.tint(50).toString();n[t.cssVarBlockName("disabled-bg-color")]=c,n[t.cssVarBlockName("disabled-text-color")]=i.dark?"rgba(255, 255, 255, 0.5)":`var(${t.cssVarName("color-white")})`,n[t.cssVarBlockName("disabled-border-color")]=c}}}return n})}const U4e=["aria-disabled","disabled","autofocus","type"],H4e=de({name:"ElButton"}),G4e=de({...H4e,props:L5,emits:M4e,setup(i,{expose:e,emit:t}){const n=i,r=z4e(n),s=Ne("button"),{_ref:a,_size:o,_type:l,_disabled:c,shouldAddSpace:u,handleClick:d}=E4e(n,t);return e({ref:a,size:o,type:l,disabled:c,shouldAddSpace:u}),(h,p)=>(I(),Z("button",{ref_key:"_ref",ref:a,class:N([v(s).b(),v(s).m(v(l)),v(s).m(v(o)),v(s).is("disabled",v(c)),v(s).is("loading",h.loading),v(s).is("plain",h.plain),v(s).is("round",h.round),v(s).is("circle",h.circle),v(s).is("text",h.text),v(s).is("link",h.link),v(s).is("has-bg",h.bg)]),"aria-disabled":v(c)||h.loading,disabled:v(c)||h.loading,autofocus:h.autofocus,type:h.nativeType,style:pt(v(r)),onClick:p[0]||(p[0]=(...m)=>v(d)&&v(d)(...m))},[h.loading?(I(),Z(gt,{key:0},[h.$slots.loading?Fe(h.$slots,"loading",{key:0}):(I(),Se(v(ct),{key:1,class:N(v(s).is("loading"))},{default:pe(()=>[(I(),Se(hi(h.loadingIcon)))]),_:1},8,["class"]))],64)):h.icon||h.$slots.icon?(I(),Se(v(ct),{key:1},{default:pe(()=>[h.icon?(I(),Se(hi(h.icon),{key:0})):Fe(h.$slots,"icon",{key:1})]),_:3})):_e("v-if",!0),h.$slots.default?(I(),Z("span",{key:2,class:N({[v(s).em("text","expand")]:v(u)})},[Fe(h.$slots,"default")],2)):_e("v-if",!0)],14,U4e))}});var W4e=qe(G4e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button.vue"]]);const j4e={size:L5.size,type:L5.type},q4e=de({name:"ElButtonGroup"}),K4e=de({...q4e,props:j4e,setup(i){const e=i;pi(Oae,Ji({size:kr(e,"size"),type:kr(e,"type")}));const t=Ne("button");return(n,r)=>(I(),Z("div",{class:N(`${v(t).b("group")}`)},[Fe(n.$slots,"default")],2))}});var koe=qe(K4e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/button/src/button-group.vue"]]);const Bo=ii(W4e,{ButtonGroup:koe}),Foe=Wr(koe);var bg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},k5={},Y4e={get exports(){return k5},set exports(i){k5=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){var t=1e3,n=6e4,r=36e5,s="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",p="year",m="date",g="Invalid Date",_=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,x={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(U){var G=["th","st","nd","rd"],H=U%100;return"["+U+(G[(H-20)%10]||G[H]||G[0])+"]"}},w=function(U,G,H){var k=String(U);return!k||k.length>=G?U:""+Array(G+1-k.length).join(H)+U},C={s:w,z:function(U){var G=-U.utcOffset(),H=Math.abs(G),k=Math.floor(H/60),D=H%60;return(G<=0?"+":"-")+w(k,2,"0")+":"+w(D,2,"0")},m:function U(G,H){if(G.date()<H.date())return-U(H,G);var k=12*(H.year()-G.year())+(H.month()-G.month()),D=G.clone().add(k,d),$=H-D<0,F=G.clone().add(k+($?-1:1),d);return+(-(k+(H-D)/($?D-F:F-D))||0)},a:function(U){return U<0?Math.ceil(U)||0:Math.floor(U)},p:function(U){return{M:d,y:p,w:u,d:c,D:m,h:l,m:o,s:a,ms:s,Q:h}[U]||String(U||"").toLowerCase().replace(/s$/,"")},u:function(U){return U===void 0}},S="en",E={};E[S]=x;var A=function(U){return U instanceof V},P=function U(G,H,k){var D;if(!G)return S;if(typeof G=="string"){var $=G.toLowerCase();E[$]&&(D=$),H&&(E[$]=H,D=$);var F=G.split("-");if(!D&&F.length>1)return U(F[0])}else{var Y=G.name;E[Y]=G,D=Y}return!k&&D&&(S=D),D||!k&&S},O=function(U,G){if(A(U))return U.clone();var H=typeof G=="object"?G:{};return H.date=U,H.args=arguments,new V(H)},M=C;M.l=P,M.i=A,M.w=function(U,G){return O(U,{locale:G.$L,utc:G.$u,x:G.$x,$offset:G.$offset})};var V=function(){function U(H){this.$L=P(H.locale,null,!0),this.parse(H)}var G=U.prototype;return G.parse=function(H){this.$d=function(k){var D=k.date,$=k.utc;if(D===null)return new Date(NaN);if(M.u(D))return new Date;if(D instanceof Date)return new Date(D);if(typeof D=="string"&&!/Z$/i.test(D)){var F=D.match(_);if(F){var Y=F[2]-1||0,ne=(F[7]||"0").substring(0,3);return $?new Date(Date.UTC(F[1],Y,F[3]||1,F[4]||0,F[5]||0,F[6]||0,ne)):new Date(F[1],Y,F[3]||1,F[4]||0,F[5]||0,F[6]||0,ne)}}return new Date(D)}(H),this.$x=H.x||{},this.init()},G.init=function(){var H=this.$d;this.$y=H.getFullYear(),this.$M=H.getMonth(),this.$D=H.getDate(),this.$W=H.getDay(),this.$H=H.getHours(),this.$m=H.getMinutes(),this.$s=H.getSeconds(),this.$ms=H.getMilliseconds()},G.$utils=function(){return M},G.isValid=function(){return this.$d.toString()!==g},G.isSame=function(H,k){var D=O(H);return this.startOf(k)<=D&&D<=this.endOf(k)},G.isAfter=function(H,k){return O(H)<this.startOf(k)},G.isBefore=function(H,k){return this.endOf(k)<O(H)},G.$g=function(H,k,D){return M.u(H)?this[k]:this.set(D,H)},G.unix=function(){return Math.floor(this.valueOf()/1e3)},G.valueOf=function(){return this.$d.getTime()},G.startOf=function(H,k){var D=this,$=!!M.u(k)||k,F=M.p(H),Y=function(ae,le){var fe=M.w(D.$u?Date.UTC(D.$y,le,ae):new Date(D.$y,le,ae),D);return $?fe:fe.endOf(c)},ne=function(ae,le){return M.w(D.toDate()[ae].apply(D.toDate("s"),($?[0,0,0,0]:[23,59,59,999]).slice(le)),D)},X=this.$W,J=this.$M,he=this.$D,ye="set"+(this.$u?"UTC":"");switch(F){case p:return $?Y(1,0):Y(31,11);case d:return $?Y(1,J):Y(0,J+1);case u:var Te=this.$locale().weekStart||0,ce=(X<Te?X+7:X)-Te;return Y($?he-ce:he+(6-ce),J);case c:case m:return ne(ye+"Hours",0);case l:return ne(ye+"Minutes",1);case o:return ne(ye+"Seconds",2);case a:return ne(ye+"Milliseconds",3);default:return this.clone()}},G.endOf=function(H){return this.startOf(H,!1)},G.$set=function(H,k){var D,$=M.p(H),F="set"+(this.$u?"UTC":""),Y=(D={},D[c]=F+"Date",D[m]=F+"Date",D[d]=F+"Month",D[p]=F+"FullYear",D[l]=F+"Hours",D[o]=F+"Minutes",D[a]=F+"Seconds",D[s]=F+"Milliseconds",D)[$],ne=$===c?this.$D+(k-this.$W):k;if($===d||$===p){var X=this.clone().set(m,1);X.$d[Y](ne),X.init(),this.$d=X.set(m,Math.min(this.$D,X.daysInMonth())).$d}else Y&&this.$d[Y](ne);return this.init(),this},G.set=function(H,k){return this.clone().$set(H,k)},G.get=function(H){return this[M.p(H)]()},G.add=function(H,k){var D,$=this;H=Number(H);var F=M.p(k),Y=function(J){var he=O($);return M.w(he.date(he.date()+Math.round(J*H)),$)};if(F===d)return this.set(d,this.$M+H);if(F===p)return this.set(p,this.$y+H);if(F===c)return Y(1);if(F===u)return Y(7);var ne=(D={},D[o]=n,D[l]=r,D[a]=t,D)[F]||1,X=this.$d.getTime()+H*ne;return M.w(X,this)},G.subtract=function(H,k){return this.add(-1*H,k)},G.format=function(H){var k=this,D=this.$locale();if(!this.isValid())return D.invalidDate||g;var $=H||"YYYY-MM-DDTHH:mm:ssZ",F=M.z(this),Y=this.$H,ne=this.$m,X=this.$M,J=D.weekdays,he=D.months,ye=function(le,fe,Ue,ie){return le&&(le[fe]||le(k,$))||Ue[fe].slice(0,ie)},Te=function(le){return M.s(Y%12||12,le,"0")},ce=D.meridiem||function(le,fe,Ue){var ie=le<12?"AM":"PM";return Ue?ie.toLowerCase():ie},ae={YY:String(this.$y).slice(-2),YYYY:this.$y,M:X+1,MM:M.s(X+1,2,"0"),MMM:ye(D.monthsShort,X,he,3),MMMM:ye(he,X),D:this.$D,DD:M.s(this.$D,2,"0"),d:String(this.$W),dd:ye(D.weekdaysMin,this.$W,J,2),ddd:ye(D.weekdaysShort,this.$W,J,3),dddd:J[this.$W],H:String(Y),HH:M.s(Y,2,"0"),h:Te(1),hh:Te(2),a:ce(Y,ne,!0),A:ce(Y,ne,!1),m:String(ne),mm:M.s(ne,2,"0"),s:String(this.$s),ss:M.s(this.$s,2,"0"),SSS:M.s(this.$ms,3,"0"),Z:F};return $.replace(b,function(le,fe){return fe||ae[le]||F.replace(":","")})},G.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},G.diff=function(H,k,D){var $,F=M.p(k),Y=O(H),ne=(Y.utcOffset()-this.utcOffset())*n,X=this-Y,J=M.m(this,Y);return J=($={},$[p]=J/12,$[d]=J,$[h]=J/3,$[u]=(X-ne)/6048e5,$[c]=(X-ne)/864e5,$[l]=X/r,$[o]=X/n,$[a]=X/t,$)[F]||X,D?J:M.a(J)},G.daysInMonth=function(){return this.endOf(d).$D},G.$locale=function(){return E[this.$L]},G.locale=function(H,k){if(!H)return this.$L;var D=this.clone(),$=P(H,k,!0);return $&&(D.$L=$),D},G.clone=function(){return M.w(this.$d,this)},G.toDate=function(){return new Date(this.valueOf())},G.toJSON=function(){return this.isValid()?this.toISOString():null},G.toISOString=function(){return this.$d.toISOString()},G.toString=function(){return this.$d.toUTCString()},U}(),L=V.prototype;return O.prototype=L,[["$ms",s],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",p],["$D",m]].forEach(function(U){L[U[1]]=function(G){return this.$g(G,U[0],U[1])}}),O.extend=function(U,G){return U.$i||(U(G,V,O),U.$i=!0),O},O.locale=P,O.isDayjs=A,O.unix=function(U){return O(1e3*U)},O.en=E[S],O.Ls=E,O.p={},O})})(Y4e);const Yt=k5;var F5={},X4e={get exports(){return F5},set exports(i){F5=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,s=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,o={},l=function(g){return(g=+g)+(g>68?1900:2e3)},c=function(g){return function(_){this[g]=+_}},u=[/[+-]\d\d:?(\d\d)?|Z/,function(g){(this.zone||(this.zone={})).offset=function(_){if(!_||_==="Z")return 0;var b=_.match(/([+-]|\d\d)/g),x=60*b[1]+(+b[2]||0);return x===0?0:b[0]==="+"?-x:x}(g)}],d=function(g){var _=o[g];return _&&(_.indexOf?_:_.s.concat(_.f))},h=function(g,_){var b,x=o.meridiem;if(x){for(var w=1;w<=24;w+=1)if(g.indexOf(x(w,0,_))>-1){b=w>12;break}}else b=g===(_?"pm":"PM");return b},p={A:[a,function(g){this.afternoon=h(g,!1)}],a:[a,function(g){this.afternoon=h(g,!0)}],S:[/\d/,function(g){this.milliseconds=100*+g}],SS:[r,function(g){this.milliseconds=10*+g}],SSS:[/\d{3}/,function(g){this.milliseconds=+g}],s:[s,c("seconds")],ss:[s,c("seconds")],m:[s,c("minutes")],mm:[s,c("minutes")],H:[s,c("hours")],h:[s,c("hours")],HH:[s,c("hours")],hh:[s,c("hours")],D:[s,c("day")],DD:[r,c("day")],Do:[a,function(g){var _=o.ordinal,b=g.match(/\d+/);if(this.day=b[0],_)for(var x=1;x<=31;x+=1)_(x).replace(/\[|\]/g,"")===g&&(this.day=x)}],M:[s,c("month")],MM:[r,c("month")],MMM:[a,function(g){var _=d("months"),b=(d("monthsShort")||_.map(function(x){return x.slice(0,3)})).indexOf(g)+1;if(b<1)throw new Error;this.month=b%12||b}],MMMM:[a,function(g){var _=d("months").indexOf(g)+1;if(_<1)throw new Error;this.month=_%12||_}],Y:[/[+-]?\d+/,c("year")],YY:[r,function(g){this.year=l(g)}],YYYY:[/\d{4}/,c("year")],Z:u,ZZ:u};function m(g){var _,b;_=g,b=o&&o.formats;for(var x=(g=_.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(O,M,V){var L=V&&V.toUpperCase();return M||b[V]||t[V]||b[L].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(U,G,H){return G||H.slice(1)})})).match(n),w=x.length,C=0;C<w;C+=1){var S=x[C],E=p[S],A=E&&E[0],P=E&&E[1];x[C]=P?{regex:A,parser:P}:S.replace(/^\[|\]$/g,"")}return function(O){for(var M={},V=0,L=0;V<w;V+=1){var U=x[V];if(typeof U=="string")L+=U.length;else{var G=U.regex,H=U.parser,k=O.slice(L),D=G.exec(k)[0];H.call(M,D),O=O.replace(D,"")}}return function($){var F=$.afternoon;if(F!==void 0){var Y=$.hours;F?Y<12&&($.hours+=12):Y===12&&($.hours=0),delete $.afternoon}}(M),M}}return function(g,_,b){b.p.customParseFormat=!0,g&&g.parseTwoDigitYear&&(l=g.parseTwoDigitYear);var x=_.prototype,w=x.parse;x.parse=function(C){var S=C.date,E=C.utc,A=C.args;this.$u=E;var P=A[1];if(typeof P=="string"){var O=A[2]===!0,M=A[3]===!0,V=O||M,L=A[2];M&&(L=A[2]),o=this.$locale(),!O&&L&&(o=b.Ls[L]),this.$d=function(k,D,$){try{if(["x","X"].indexOf(D)>-1)return new Date((D==="X"?1e3:1)*k);var F=m(D)(k),Y=F.year,ne=F.month,X=F.day,J=F.hours,he=F.minutes,ye=F.seconds,Te=F.milliseconds,ce=F.zone,ae=new Date,le=X||(Y||ne?1:ae.getDate()),fe=Y||ae.getFullYear(),Ue=0;Y&&!ne||(Ue=ne>0?ne-1:ae.getMonth());var ie=J||0,oe=he||0,we=ye||0,Ae=Te||0;return ce?new Date(Date.UTC(fe,Ue,le,ie,oe,we,Ae+60*ce.offset*1e3)):$?new Date(Date.UTC(fe,Ue,le,ie,oe,we,Ae)):new Date(fe,Ue,le,ie,oe,we,Ae)}catch{return new Date("")}}(S,P,E),this.init(),L&&L!==!0&&(this.$L=this.locale(L).$L),V&&S!=this.format(P)&&(this.$d=new Date("")),o={}}else if(P instanceof Array)for(var U=P.length,G=1;G<=U;G+=1){A[1]=P[G-1];var H=b.apply(this,A);if(H.isValid()){this.$d=H.$d,this.$L=H.$L,this.init();break}G===U&&(this.$d=new Date(""))}else w.call(this,C)}}})})(X4e);const M9=F5,Iq=["hours","minutes","seconds"],N5="HH:mm:ss",J1="YYYY-MM-DD",Z4e={date:J1,dates:J1,week:"gggg[w]ww",year:"YYYY",month:"YYYY-MM",datetime:`${J1} ${N5}`,monthrange:"YYYY-MM",daterange:J1,datetimerange:`${J1} ${N5}`},Tk=(i,e)=>[i>0?i-1:void 0,i,i<e?i+1:void 0],ly=i=>Array.from(Array.from({length:i}).keys()),Noe=i=>i.replace(/\W?m{1,2}|\W?ZZ/g,"").replace(/\W?h{1,2}|\W?s{1,3}|\W?a/gi,"").trim(),Voe=i=>i.replace(/\W?D{1,2}|\W?Do|\W?d{1,4}|\W?M{1,4}|\W?Y{2,4}/g,"").trim(),$q=function(i,e){const t=rb(i),n=rb(e);return t&&n?i.getTime()===e.getTime():!t&&!n?i===e:!1},Lq=function(i,e){const t=st(i),n=st(e);return t&&n?i.length!==e.length?!1:i.every((r,s)=>$q(r,e[s])):!t&&!n?$q(i,e):!1},Dq=function(i,e,t){const n=pd(e)||e==="x"?Yt(i).locale(t):Yt(i,e).locale(t);return n.isValid()?n:void 0},kq=function(i,e,t){return pd(e)?i:e==="x"?+i:Yt(i).locale(t).format(e)},Sk=(i,e)=>{var t;const n=[],r=e==null?void 0:e();for(let s=0;s<i;s++)n.push((t=r==null?void 0:r.includes(s))!=null?t:!1);return n},Boe=Ke({disabledHours:{type:xe(Function)},disabledMinutes:{type:xe(Function)},disabledSeconds:{type:xe(Function)}}),zoe=Ke({visible:Boolean,actualVisible:{type:Boolean,default:void 0},format:{type:String,default:""}}),P9=Ke({id:{type:xe([Array,String])},name:{type:xe([Array,String]),default:""},popperClass:{type:String,default:""},format:String,valueFormat:String,type:{type:String,default:""},clearable:{type:Boolean,default:!0},clearIcon:{type:xe([String,Object]),default:Ny},editable:{type:Boolean,default:!0},prefixIcon:{type:xe([String,Object]),default:""},size:Ql,readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},placeholder:{type:String,default:""},popperOptions:{type:xe(Object),default:()=>({})},modelValue:{type:xe([Date,Array,String,Number]),default:""},rangeSeparator:{type:String,default:"-"},startPlaceholder:String,endPlaceholder:String,defaultValue:{type:xe([Date,Array])},defaultTime:{type:xe([Date,Array])},isRange:{type:Boolean,default:!1},...Boe,disabledDate:{type:Function},cellClassName:{type:Function},shortcuts:{type:Array,default:()=>[]},arrowControl:{type:Boolean,default:!1},label:{type:String,default:void 0},tabindex:{type:xe([String,Number]),default:0},validateEvent:{type:Boolean,default:!0},unlinkPanels:Boolean}),Q4e=["id","name","placeholder","value","disabled","readonly"],J4e=["id","name","placeholder","value","disabled","readonly"],eNe=de({name:"Picker"}),tNe=de({...eNe,props:P9,emits:["update:modelValue","change","focus","blur","calendar-change","panel-change","visible-change","keydown"],setup(i,{expose:e,emit:t}){const n=i,{lang:r}=Ki(),s=Ne("date"),a=Ne("input"),o=Ne("range"),{form:l,formItem:c}=nc(),u=ht("ElPopperOptions",{}),d=W(),h=W(),p=W(!1),m=W(!1),g=W(null);let _=!1,b=!1;Ve(p,K=>{K?ut(()=>{K&&(g.value=n.modelValue)}):(ve.value=null,ut(()=>{x(n.modelValue)}))});const x=(K,se)=>{(se||!Lq(K,g.value))&&(t("change",K),n.validateEvent&&(c==null||c.validate("change").catch(Me=>void 0)))},w=K=>{if(!Lq(n.modelValue,K)){let se;st(K)?se=K.map(Me=>kq(Me,n.valueFormat,r.value)):K&&(se=kq(K,n.valueFormat,r.value)),t("update:modelValue",K&&se,r.value)}},C=K=>{t("keydown",K)},S=R(()=>{if(h.value){const K=oe.value?h.value:h.value.$el;return Array.from(K.querySelectorAll("input"))}return[]}),E=(K,se,Me)=>{const De=S.value;De.length&&(!Me||Me==="min"?(De[0].setSelectionRange(K,se),De[0].focus()):Me==="max"&&(De[1].setSelectionRange(K,se),De[1].focus()))},A=()=>{H(!0,!0),ut(()=>{b=!1})},P=(K="",se=!1)=>{se||(b=!0),p.value=se;let Me;st(K)?Me=K.map(De=>De.toDate()):Me=K&&K.toDate(),ve.value=null,w(Me)},O=()=>{m.value=!0},M=()=>{t("visible-change",!0)},V=K=>{(K==null?void 0:K.key)===wt.esc&&H(!0,!0)},L=()=>{m.value=!1,p.value=!1,b=!1,t("visible-change",!1)},U=()=>{p.value=!0},G=()=>{p.value=!1},H=(K=!0,se=!1)=>{b=se;const[Me,De]=v(S);let Tt=Me;!K&&oe.value&&(Tt=De),Tt&&Tt.focus()},k=K=>{n.readonly||F.value||p.value||b||(p.value=!0,t("focus",K))};let D;const $=K=>{const se=async()=>{setTimeout(()=>{var Me;D===se&&(!((Me=d.value)!=null&&Me.isFocusInsideContent()&&!_)&&S.value.filter(De=>De.contains(document.activeElement)).length===0&&(ke(),p.value=!1,t("blur",K),n.validateEvent&&(c==null||c.validate("blur").catch(De=>void 0))),_=!1)},0)};D=se,se()},F=R(()=>n.disabled||(l==null?void 0:l.disabled)),Y=R(()=>{let K;if(ae.value?Qe.value.getDefaultValue&&(K=Qe.value.getDefaultValue()):st(n.modelValue)?K=n.modelValue.map(se=>Dq(se,n.valueFormat,r.value)):K=Dq(n.modelValue,n.valueFormat,r.value),Qe.value.getRangeAvailableTime){const se=Qe.value.getRangeAvailableTime(K);Iu(se,K)||(K=se,w(st(K)?K.map(Me=>Me.toDate()):K.toDate()))}return st(K)&&K.some(se=>!se)&&(K=[]),K}),ne=R(()=>{if(!Qe.value.panelReady)return"";const K=$e(Y.value);return st(ve.value)?[ve.value[0]||K&&K[0]||"",ve.value[1]||K&&K[1]||""]:ve.value!==null?ve.value:!J.value&&ae.value||!p.value&&ae.value?"":K?he.value?K.join(", "):K:""}),X=R(()=>n.type.includes("time")),J=R(()=>n.type.startsWith("time")),he=R(()=>n.type==="dates"),ye=R(()=>n.prefixIcon||(X.value?wae:uRe)),Te=W(!1),ce=K=>{n.readonly||F.value||Te.value&&(K.stopPropagation(),A(),w(null),x(null,!0),Te.value=!1,p.value=!1,Qe.value.handleClear&&Qe.value.handleClear())},ae=R(()=>{const{modelValue:K}=n;return!K||st(K)&&!K.filter(Boolean).length}),le=async K=>{var se;n.readonly||F.value||(((se=K.target)==null?void 0:se.tagName)!=="INPUT"||S.value.includes(document.activeElement))&&(p.value=!0)},fe=()=>{n.readonly||F.value||!ae.value&&n.clearable&&(Te.value=!0)},Ue=()=>{Te.value=!1},ie=K=>{var se;n.readonly||F.value||(((se=K.touches[0].target)==null?void 0:se.tagName)!=="INPUT"||S.value.includes(document.activeElement))&&(p.value=!0)},oe=R(()=>n.type.includes("range")),we=Qs(),Ae=R(()=>{var K,se;return(se=(K=v(d))==null?void 0:K.popperRef)==null?void 0:se.contentRef}),Oe=R(()=>{var K;return v(oe)?v(h):(K=v(h))==null?void 0:K.$el});e9(Oe,K=>{const se=v(Ae),Me=v(Oe);se&&(K.target===se||K.composedPath().includes(se))||K.target===Me||K.composedPath().includes(Me)||(p.value=!1)});const ve=W(null),ke=()=>{if(ve.value){const K=be(ne.value);K&&Le(K)&&(w(st(K)?K.map(se=>se.toDate()):K.toDate()),ve.value=null)}ve.value===""&&(w(null),x(null),ve.value=null)},be=K=>K?Qe.value.parseUserInput(K):null,$e=K=>K?Qe.value.formatToString(K):null,Le=K=>Qe.value.isValidValue(K),Ce=async K=>{if(n.readonly||F.value)return;const{code:se}=K;if(C(K),se===wt.esc){p.value===!0&&(p.value=!1,K.preventDefault(),K.stopPropagation());return}if(se===wt.down&&(Qe.value.handleFocusPicker&&(K.preventDefault(),K.stopPropagation()),p.value===!1&&(p.value=!0,await ut()),Qe.value.handleFocusPicker)){Qe.value.handleFocusPicker();return}if(se===wt.tab){_=!0;return}if(se===wt.enter||se===wt.numpadEnter){(ve.value===null||ve.value===""||Le(be(ne.value)))&&(ke(),p.value=!1),K.stopPropagation();return}if(ve.value){K.stopPropagation();return}Qe.value.handleKeydownInput&&Qe.value.handleKeydownInput(K)},Be=K=>{ve.value=K,p.value||(p.value=!0)},He=K=>{const se=K.target;ve.value?ve.value=[se.value,ve.value[1]]:ve.value=[se.value,null]},Xe=K=>{const se=K.target;ve.value?ve.value=[ve.value[0],se.value]:ve.value=[null,se.value]},Je=()=>{var K;const se=ve.value,Me=be(se&&se[0]),De=v(Y);if(Me&&Me.isValid()){ve.value=[$e(Me),((K=ne.value)==null?void 0:K[1])||null];const Tt=[Me,De&&(De[1]||null)];Le(Tt)&&(w(Tt),ve.value=null)}},it=()=>{var K;const se=v(ve),Me=be(se&&se[1]),De=v(Y);if(Me&&Me.isValid()){ve.value=[((K=v(ne))==null?void 0:K[0])||null,$e(Me)];const Tt=[De&&De[0],Me];Le(Tt)&&(w(Tt),ve.value=null)}},Qe=W({}),te=K=>{Qe.value[K[0]]=K[1],Qe.value.panelReady=!0},me=K=>{t("calendar-change",K)},Ie=(K,se,Me)=>{t("panel-change",K,se,Me)};return pi("EP_PICKER_BASE",{props:n}),e({focus:H,handleFocusInput:k,handleBlurInput:$,handleOpen:U,handleClose:G,onPick:P}),(K,se)=>(I(),Se(v(Jl),ci({ref_key:"refPopper",ref:d,visible:p.value,effect:"light",pure:"",trigger:"click"},K.$attrs,{role:"dialog",teleported:"",transition:`${v(s).namespace.value}-zoom-in-top`,"popper-class":[`${v(s).namespace.value}-picker__popper`,K.popperClass],"popper-options":v(u),"fallback-placements":["bottom","top","right","left"],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"hide-after":0,persistent:"",onBeforeShow:O,onShow:M,onHide:L}),{default:pe(()=>[v(oe)?(I(),Z("div",{key:1,ref_key:"inputRef",ref:h,class:N([v(s).b("editor"),v(s).bm("editor",K.type),v(a).e("wrapper"),v(s).is("disabled",v(F)),v(s).is("active",p.value),v(o).b("editor"),v(we)?v(o).bm("editor",v(we)):"",K.$attrs.class]),style:pt(K.$attrs.style),onClick:k,onMouseenter:fe,onMouseleave:Ue,onTouchstart:ie,onKeydown:Ce},[v(ye)?(I(),Se(v(ct),{key:0,class:N([v(a).e("icon"),v(o).e("icon")]),onMousedown:Dt(le,["prevent"]),onTouchstart:ie},{default:pe(()=>[(I(),Se(hi(v(ye))))]),_:1},8,["class","onMousedown"])):_e("v-if",!0),Q("input",{id:K.id&&K.id[0],autocomplete:"off",name:K.name&&K.name[0],placeholder:K.startPlaceholder,value:v(ne)&&v(ne)[0],disabled:v(F),readonly:!K.editable||K.readonly,class:N(v(o).b("input")),onMousedown:le,onInput:He,onChange:Je,onFocus:k,onBlur:$},null,42,Q4e),Fe(K.$slots,"range-separator",{},()=>[Q("span",{class:N(v(o).b("separator"))},We(K.rangeSeparator),3)]),Q("input",{id:K.id&&K.id[1],autocomplete:"off",name:K.name&&K.name[1],placeholder:K.endPlaceholder,value:v(ne)&&v(ne)[1],disabled:v(F),readonly:!K.editable||K.readonly,class:N(v(o).b("input")),onMousedown:le,onFocus:k,onBlur:$,onInput:Xe,onChange:it},null,42,J4e),K.clearIcon?(I(),Se(v(ct),{key:1,class:N([v(a).e("icon"),v(o).e("close-icon"),{[v(o).e("close-icon--hidden")]:!Te.value}]),onClick:ce},{default:pe(()=>[(I(),Se(hi(K.clearIcon)))]),_:1},8,["class"])):_e("v-if",!0)],38)):(I(),Se(v(ol),{key:0,id:K.id,ref_key:"inputRef",ref:h,"container-role":"combobox","model-value":v(ne),name:K.name,size:v(we),disabled:v(F),placeholder:K.placeholder,class:N([v(s).b("editor"),v(s).bm("editor",K.type),K.$attrs.class]),style:pt(K.$attrs.style),readonly:!K.editable||K.readonly||v(he)||K.type==="week",label:K.label,tabindex:K.tabindex,"validate-event":!1,onInput:Be,onFocus:k,onBlur:$,onKeydown:Ce,onChange:ke,onMousedown:le,onMouseenter:fe,onMouseleave:Ue,onTouchstart:ie,onClick:se[0]||(se[0]=Dt(()=>{},["stop"]))},{prefix:pe(()=>[v(ye)?(I(),Se(v(ct),{key:0,class:N(v(a).e("icon")),onMousedown:Dt(le,["prevent"]),onTouchstart:ie},{default:pe(()=>[(I(),Se(hi(v(ye))))]),_:1},8,["class","onMousedown"])):_e("v-if",!0)]),suffix:pe(()=>[Te.value&&K.clearIcon?(I(),Se(v(ct),{key:0,class:N(`${v(a).e("icon")} clear-icon`),onClick:Dt(ce,["stop"])},{default:pe(()=>[(I(),Se(hi(K.clearIcon)))]),_:1},8,["class","onClick"])):_e("v-if",!0)]),_:1},8,["id","model-value","name","size","disabled","placeholder","class","style","readonly","label","tabindex","onKeydown"]))]),content:pe(()=>[Fe(K.$slots,"default",{visible:p.value,actualVisible:m.value,parsedValue:v(Y),format:K.format,unlinkPanels:K.unlinkPanels,type:K.type,defaultValue:K.defaultValue,onPick:P,onSelectRange:E,onSetPickerOption:te,onCalendarChange:me,onPanelChange:Ie,onKeydown:V,onMousedown:se[1]||(se[1]=Dt(()=>{},["stop"]))})]),_:3},16,["visible","transition","popper-class","popper-options"]))}});var Uoe=qe(tNe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/common/picker.vue"]]);const iNe=Ke({...zoe,datetimeRole:String,parsedValue:{type:xe(Object)}}),Hoe=({getAvailableHours:i,getAvailableMinutes:e,getAvailableSeconds:t})=>{const n=(a,o,l,c)=>{const u={hour:i,minute:e,second:t};let d=a;return["hour","minute","second"].forEach(h=>{if(u[h]){let p;const m=u[h];switch(h){case"minute":{p=m(d.hour(),o,c);break}case"second":{p=m(d.hour(),d.minute(),o,c);break}default:{p=m(o,c);break}}if(p!=null&&p.length&&!p.includes(d[h]())){const g=l?0:p.length-1;d=d[h](p[g])}}}),d},r={};return{timePickerOptions:r,getAvailableTime:n,onSetOption:([a,o])=>{r[a]=o}}},Ek=i=>{const e=(n,r)=>n||r,t=n=>n!==!0;return i.map(e).filter(t)},Goe=(i,e,t)=>({getHoursList:(a,o)=>Sk(24,i&&(()=>i==null?void 0:i(a,o))),getMinutesList:(a,o,l)=>Sk(60,e&&(()=>e==null?void 0:e(a,o,l))),getSecondsList:(a,o,l,c)=>Sk(60,t&&(()=>t==null?void 0:t(a,o,l,c)))}),Woe=(i,e,t)=>{const{getHoursList:n,getMinutesList:r,getSecondsList:s}=Goe(i,e,t);return{getAvailableHours:(c,u)=>Ek(n(c,u)),getAvailableMinutes:(c,u,d)=>Ek(r(c,u,d)),getAvailableSeconds:(c,u,d,h)=>Ek(s(c,u,d,h))}},joe=i=>{const e=W(i.parsedValue);return Ve(()=>i.visible,t=>{t||(e.value=i.parsedValue)}),e},iv=new Map;let Fq;Ii&&(document.addEventListener("mousedown",i=>Fq=i),document.addEventListener("mouseup",i=>{for(const e of iv.values())for(const{documentHandler:t}of e)t(i,Fq)}));function Nq(i,e){let t=[];return Array.isArray(e.arg)?t=e.arg:Oh(e.arg)&&t.push(e.arg),function(n,r){const s=e.instance.popperRef,a=n.target,o=r==null?void 0:r.target,l=!e||!e.instance,c=!a||!o,u=i.contains(a)||i.contains(o),d=i===a,h=t.length&&t.some(m=>m==null?void 0:m.contains(a))||t.length&&t.includes(o),p=s&&(s.contains(a)||s.contains(o));l||c||u||d||h||p||e.value(n,r)}}const My={beforeMount(i,e){iv.has(i)||iv.set(i,[]),iv.get(i).push({documentHandler:Nq(i,e),bindingFn:e.value})},updated(i,e){iv.has(i)||iv.set(i,[]);const t=iv.get(i),n=t.findIndex(s=>s.bindingFn===e.oldValue),r={documentHandler:Nq(i,e),bindingFn:e.value};n>=0?t.splice(n,1,r):t.push(r)},unmounted(i){iv.delete(i)}},nNe=100,rNe=600,h$={beforeMount(i,e){const t=e.value,{interval:n=nNe,delay:r=rNe}=Lt(t)?{}:t;let s,a;const o=()=>Lt(t)?t():t.handler(),l=()=>{a&&(clearTimeout(a),a=void 0),s&&(clearInterval(s),s=void 0)};i.addEventListener("mousedown",c=>{c.button===0&&(l(),o(),document.addEventListener("mouseup",()=>l(),{once:!0}),a=setTimeout(()=>{s=setInterval(()=>{o()},n)},r))})}},V5="_trap-focus-children",b0=[],Vq=i=>{if(b0.length===0)return;const e=b0[b0.length-1][V5];if(e.length>0&&i.code===wt.tab){if(e.length===1){i.preventDefault(),document.activeElement!==e[0]&&e[0].focus();return}const t=i.shiftKey,n=i.target===e[0],r=i.target===e[e.length-1];n&&t&&(i.preventDefault(),e[e.length-1].focus()),r&&!t&&(i.preventDefault(),e[0].focus())}},sNe={beforeMount(i){i[V5]=kj(i),b0.push(i),b0.length<=1&&document.addEventListener("keydown",Vq)},updated(i){ut(()=>{i[V5]=kj(i)})},unmounted(){b0.shift(),b0.length===0&&document.removeEventListener("keydown",Vq)}};var Bq=!1,n0,B5,z5,vR,yR,qoe,_R,U5,H5,G5,Koe,W5,j5,Yoe,Xoe;function rc(){if(!Bq){Bq=!0;var i=navigator.userAgent,e=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(i),t=/(Mac OS X)|(Windows)|(Linux)/.exec(i);if(W5=/\b(iPhone|iP[ao]d)/.exec(i),j5=/\b(iP[ao]d)/.exec(i),G5=/Android/i.exec(i),Yoe=/FBAN\/\w+;/i.exec(i),Xoe=/Mobile/i.exec(i),Koe=!!/Win64/.exec(i),e){n0=e[1]?parseFloat(e[1]):e[5]?parseFloat(e[5]):NaN,n0&&document&&document.documentMode&&(n0=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(i);qoe=n?parseFloat(n[1])+4:n0,B5=e[2]?parseFloat(e[2]):NaN,z5=e[3]?parseFloat(e[3]):NaN,vR=e[4]?parseFloat(e[4]):NaN,vR?(e=/(?:Chrome\/(\d+\.\d+))/.exec(i),yR=e&&e[1]?parseFloat(e[1]):NaN):yR=NaN}else n0=B5=z5=yR=vR=NaN;if(t){if(t[1]){var r=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(i);_R=r?parseFloat(r[1].replace("_",".")):!0}else _R=!1;U5=!!t[2],H5=!!t[3]}else _R=U5=H5=!1}}var q5={ie:function(){return rc()||n0},ieCompatibilityMode:function(){return rc()||qoe>n0},ie64:function(){return q5.ie()&&Koe},firefox:function(){return rc()||B5},opera:function(){return rc()||z5},webkit:function(){return rc()||vR},safari:function(){return q5.webkit()},chrome:function(){return rc()||yR},windows:function(){return rc()||U5},osx:function(){return rc()||_R},linux:function(){return rc()||H5},iphone:function(){return rc()||W5},mobile:function(){return rc()||W5||j5||G5||Xoe},nativeApp:function(){return rc()||Yoe},android:function(){return rc()||G5},ipad:function(){return rc()||j5}},aNe=q5,tP=!!(typeof window<"u"&&window.document&&window.document.createElement),oNe={canUseDOM:tP,canUseWorkers:typeof Worker<"u",canUseEventListeners:tP&&!!(window.addEventListener||window.attachEvent),canUseViewport:tP&&!!window.screen,isInWorker:!tP},Zoe=oNe,Qoe;Zoe.canUseDOM&&(Qoe=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function lNe(i,e){if(!Zoe.canUseDOM||e&&!("addEventListener"in document))return!1;var t="on"+i,n=t in document;if(!n){var r=document.createElement("div");r.setAttribute(t,"return;"),n=typeof r[t]=="function"}return!n&&Qoe&&i==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var cNe=lNe,zq=10,Uq=40,Hq=800;function Joe(i){var e=0,t=0,n=0,r=0;return"detail"in i&&(t=i.detail),"wheelDelta"in i&&(t=-i.wheelDelta/120),"wheelDeltaY"in i&&(t=-i.wheelDeltaY/120),"wheelDeltaX"in i&&(e=-i.wheelDeltaX/120),"axis"in i&&i.axis===i.HORIZONTAL_AXIS&&(e=t,t=0),n=e*zq,r=t*zq,"deltaY"in i&&(r=i.deltaY),"deltaX"in i&&(n=i.deltaX),(n||r)&&i.deltaMode&&(i.deltaMode==1?(n*=Uq,r*=Uq):(n*=Hq,r*=Hq)),n&&!e&&(e=n<1?-1:1),r&&!t&&(t=r<1?-1:1),{spinX:e,spinY:t,pixelX:n,pixelY:r}}Joe.getEventType=function(){return aNe.firefox()?"DOMMouseScroll":cNe("wheel")?"wheel":"mousewheel"};var uNe=Joe;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const dNe=function(i,e){if(i&&i.addEventListener){const t=function(n){const r=uNe(n);e&&Reflect.apply(e,this,[n,r])};i.addEventListener("wheel",t,{passive:!0})}},hNe={beforeMount(i,e){dNe(i,e.value)}},pNe=Ke({role:{type:String,required:!0},spinnerDate:{type:xe(Object),required:!0},showSeconds:{type:Boolean,default:!0},arrowControl:Boolean,amPmMode:{type:xe(String),default:""},...Boe}),fNe=["onClick"],mNe=["onMouseenter"],gNe=de({__name:"basic-time-spinner",props:pNe,emits:["change","select-range","set-option"],setup(i,{emit:e}){const t=i,n=Ne("time"),{getHoursList:r,getMinutesList:s,getSecondsList:a}=Goe(t.disabledHours,t.disabledMinutes,t.disabledSeconds);let o=!1;const l=W(),c=W(),u=W(),d=W(),h={hours:c,minutes:u,seconds:d},p=R(()=>t.showSeconds?Iq:Iq.slice(0,2)),m=R(()=>{const{spinnerDate:F}=t,Y=F.hour(),ne=F.minute(),X=F.second();return{hours:Y,minutes:ne,seconds:X}}),g=R(()=>{const{hours:F,minutes:Y}=v(m);return{hours:r(t.role),minutes:s(F,t.role),seconds:a(F,Y,t.role)}}),_=R(()=>{const{hours:F,minutes:Y,seconds:ne}=v(m);return{hours:Tk(F,23),minutes:Tk(Y,59),seconds:Tk(ne,59)}}),b=Zl(F=>{o=!1,C(F)},200),x=F=>{if(!!!t.amPmMode)return"";const ne=t.amPmMode==="A";let X=F<12?" am":" pm";return ne&&(X=X.toUpperCase()),X},w=F=>{let Y;switch(F){case"hours":Y=[0,2];break;case"minutes":Y=[3,5];break;case"seconds":Y=[6,8];break}const[ne,X]=Y;e("select-range",ne,X),l.value=F},C=F=>{A(F,v(m)[F])},S=()=>{C("hours"),C("minutes"),C("seconds")},E=F=>F.querySelector(`.${n.namespace.value}-scrollbar__wrap`),A=(F,Y)=>{if(t.arrowControl)return;const ne=v(h[F]);ne&&ne.$el&&(E(ne.$el).scrollTop=Math.max(0,Y*P(F)))},P=F=>{const Y=v(h[F]);return(Y==null?void 0:Y.$el.querySelector("li").offsetHeight)||0},O=()=>{V(1)},M=()=>{V(-1)},V=F=>{l.value||w("hours");const Y=l.value,ne=v(m)[Y],X=l.value==="hours"?24:60,J=L(Y,ne,F,X);U(Y,J),A(Y,J),ut(()=>w(Y))},L=(F,Y,ne,X)=>{let J=(Y+ne+X)%X;const he=v(g)[F];for(;he[J]&&J!==Y;)J=(J+ne+X)%X;return J},U=(F,Y)=>{if(v(g)[F][Y])return;const{hours:J,minutes:he,seconds:ye}=v(m);let Te;switch(F){case"hours":Te=t.spinnerDate.hour(Y).minute(he).second(ye);break;case"minutes":Te=t.spinnerDate.hour(J).minute(Y).second(ye);break;case"seconds":Te=t.spinnerDate.hour(J).minute(he).second(Y);break}e("change",Te)},G=(F,{value:Y,disabled:ne})=>{ne||(U(F,Y),w(F),A(F,Y))},H=F=>{o=!0,b(F);const Y=Math.min(Math.round((E(v(h[F]).$el).scrollTop-(k(F)*.5-10)/P(F)+3)/P(F)),F==="hours"?23:59);U(F,Y)},k=F=>v(h[F]).$el.offsetHeight,D=()=>{const F=Y=>{const ne=v(h[Y]);ne&&ne.$el&&(E(ne.$el).onscroll=()=>{H(Y)})};F("hours"),F("minutes"),F("seconds")};qt(()=>{ut(()=>{!t.arrowControl&&D(),S(),t.role==="start"&&w("hours")})});const $=(F,Y)=>{h[Y].value=F};return e("set-option",[`${t.role}_scrollDown`,V]),e("set-option",[`${t.role}_emitSelectRange`,w]),Ve(()=>t.spinnerDate,()=>{o||S()}),(F,Y)=>(I(),Z("div",{class:N([v(n).b("spinner"),{"has-seconds":F.showSeconds}])},[F.arrowControl?_e("v-if",!0):(I(!0),Z(gt,{key:0},xi(v(p),ne=>(I(),Se(v(_g),{key:ne,ref_for:!0,ref:X=>$(X,ne),class:N(v(n).be("spinner","wrapper")),"wrap-style":"max-height: inherit;","view-class":v(n).be("spinner","list"),noresize:"",tag:"ul",onMouseenter:X=>w(ne),onMousemove:X=>C(ne)},{default:pe(()=>[(I(!0),Z(gt,null,xi(v(g)[ne],(X,J)=>(I(),Z("li",{key:J,class:N([v(n).be("spinner","item"),v(n).is("active",J===v(m)[ne]),v(n).is("disabled",X)]),onClick:he=>G(ne,{value:J,disabled:X})},[ne==="hours"?(I(),Z(gt,{key:0},[Gi(We(("0"+(F.amPmMode?J%12||12:J)).slice(-2))+We(x(J)),1)],64)):(I(),Z(gt,{key:1},[Gi(We(("0"+J).slice(-2)),1)],64))],10,fNe))),128))]),_:2},1032,["class","view-class","onMouseenter","onMousemove"]))),128)),F.arrowControl?(I(!0),Z(gt,{key:1},xi(v(p),ne=>(I(),Z("div",{key:ne,class:N([v(n).be("spinner","wrapper"),v(n).is("arrow")]),onMouseenter:X=>w(ne)},[zt((I(),Se(v(ct),{class:N(["arrow-up",v(n).be("spinner","arrow")])},{default:pe(()=>[re(v(A3))]),_:1},8,["class"])),[[v(h$),M]]),zt((I(),Se(v(ct),{class:N(["arrow-down",v(n).be("spinner","arrow")])},{default:pe(()=>[re(v(Fy))]),_:1},8,["class"])),[[v(h$),O]]),Q("ul",{class:N(v(n).be("spinner","list"))},[(I(!0),Z(gt,null,xi(v(_)[ne],(X,J)=>(I(),Z("li",{key:J,class:N([v(n).be("spinner","item"),v(n).is("active",X===v(m)[ne]),v(n).is("disabled",v(g)[ne][X])])},[typeof X=="number"?(I(),Z(gt,{key:0},[ne==="hours"?(I(),Z(gt,{key:0},[Gi(We(("0"+(F.amPmMode?X%12||12:X)).slice(-2))+We(x(X)),1)],64)):(I(),Z(gt,{key:1},[Gi(We(("0"+X).slice(-2)),1)],64))],64)):_e("v-if",!0)],2))),128))],2)],42,mNe))),128)):_e("v-if",!0)],2))}});var K5=qe(gNe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/basic-time-spinner.vue"]]);const vNe=de({__name:"panel-time-pick",props:iNe,emits:["pick","select-range","set-picker-option"],setup(i,{emit:e}){const t=i,n=ht("EP_PICKER_BASE"),{arrowControl:r,disabledHours:s,disabledMinutes:a,disabledSeconds:o,defaultValue:l}=n.props,{getAvailableHours:c,getAvailableMinutes:u,getAvailableSeconds:d}=Woe(s,a,o),h=Ne("time"),{t:p,lang:m}=Ki(),g=W([0,2]),_=joe(t),b=R(()=>eo(t.actualVisible)?`${h.namespace.value}-zoom-in-top`:""),x=R(()=>t.format.includes("ss")),w=R(()=>t.format.includes("A")?"A":t.format.includes("a")?"a":""),C=$=>{const F=Yt($).locale(m.value),Y=G(F);return F.isSame(Y)},S=()=>{e("pick",_.value,!1)},E=($=!1,F=!1)=>{F||e("pick",t.parsedValue,$)},A=$=>{if(!t.visible)return;const F=G($).millisecond(0);e("pick",F,!0)},P=($,F)=>{e("select-range",$,F),g.value=[$,F]},O=$=>{const F=[0,3].concat(x.value?[6]:[]),Y=["hours","minutes"].concat(x.value?["seconds"]:[]),X=(F.indexOf(g.value[0])+$+F.length)%F.length;V.start_emitSelectRange(Y[X])},M=$=>{const F=$.code,{left:Y,right:ne,up:X,down:J}=wt;if([Y,ne].includes(F)){O(F===Y?-1:1),$.preventDefault();return}if([X,J].includes(F)){const he=F===X?-1:1;V.start_scrollDown(he),$.preventDefault();return}},{timePickerOptions:V,onSetOption:L,getAvailableTime:U}=Hoe({getAvailableHours:c,getAvailableMinutes:u,getAvailableSeconds:d}),G=$=>U($,t.datetimeRole||"",!0),H=$=>$?Yt($,t.format).locale(m.value):null,k=$=>$?$.format(t.format):null,D=()=>Yt(l).locale(m.value);return e("set-picker-option",["isValidValue",C]),e("set-picker-option",["formatToString",k]),e("set-picker-option",["parseUserInput",H]),e("set-picker-option",["handleKeydownInput",M]),e("set-picker-option",["getRangeAvailableTime",G]),e("set-picker-option",["getDefaultValue",D]),($,F)=>(I(),Se(Ss,{name:v(b)},{default:pe(()=>[$.actualVisible||$.visible?(I(),Z("div",{key:0,class:N(v(h).b("panel"))},[Q("div",{class:N([v(h).be("panel","content"),{"has-seconds":v(x)}])},[re(K5,{ref:"spinner",role:$.datetimeRole||"start","arrow-control":v(r),"show-seconds":v(x),"am-pm-mode":v(w),"spinner-date":$.parsedValue,"disabled-hours":v(s),"disabled-minutes":v(a),"disabled-seconds":v(o),onChange:A,onSetOption:v(L),onSelectRange:P},null,8,["role","arrow-control","show-seconds","am-pm-mode","spinner-date","disabled-hours","disabled-minutes","disabled-seconds","onSetOption"])],2),Q("div",{class:N(v(h).be("panel","footer"))},[Q("button",{type:"button",class:N([v(h).be("panel","btn"),"cancel"]),onClick:S},We(v(p)("el.datepicker.cancel")),3),Q("button",{type:"button",class:N([v(h).be("panel","btn"),"confirm"]),onClick:F[0]||(F[0]=Y=>E())},We(v(p)("el.datepicker.confirm")),3)],2)],2)):_e("v-if",!0)]),_:1},8,["name"]))}});var p$=qe(vNe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/panel-time-pick.vue"]]);const yNe=Ke({...zoe,parsedValue:{type:xe(Array)}}),_Ne=["disabled"],bNe=de({__name:"panel-time-range",props:yNe,emits:["pick","select-range","set-picker-option"],setup(i,{emit:e}){const t=i,n=(le,fe)=>{const Ue=[];for(let ie=le;ie<=fe;ie++)Ue.push(ie);return Ue},{t:r,lang:s}=Ki(),a=Ne("time"),o=Ne("picker"),l=ht("EP_PICKER_BASE"),{arrowControl:c,disabledHours:u,disabledMinutes:d,disabledSeconds:h,defaultValue:p}=l.props,m=R(()=>t.parsedValue[0]),g=R(()=>t.parsedValue[1]),_=joe(t),b=()=>{e("pick",_.value,!1)},x=R(()=>t.format.includes("ss")),w=R(()=>t.format.includes("A")?"A":t.format.includes("a")?"a":""),C=(le=!1)=>{e("pick",[m.value,g.value],le)},S=le=>{P(le.millisecond(0),g.value)},E=le=>{P(m.value,le.millisecond(0))},A=le=>{const fe=le.map(ie=>Yt(ie).locale(s.value)),Ue=F(fe);return fe[0].isSame(Ue[0])&&fe[1].isSame(Ue[1])},P=(le,fe)=>{e("pick",[le,fe],!0)},O=R(()=>m.value>g.value),M=W([0,2]),V=(le,fe)=>{e("select-range",le,fe,"min"),M.value=[le,fe]},L=R(()=>x.value?11:8),U=(le,fe)=>{e("select-range",le,fe,"max");const Ue=v(L);M.value=[le+Ue,fe+Ue]},G=le=>{const fe=x.value?[0,3,6,11,14,17]:[0,3,8,11],Ue=["hours","minutes"].concat(x.value?["seconds"]:[]),oe=(fe.indexOf(M.value[0])+le+fe.length)%fe.length,we=fe.length/2;oe<we?J.start_emitSelectRange(Ue[oe]):J.end_emitSelectRange(Ue[oe-we])},H=le=>{const fe=le.code,{left:Ue,right:ie,up:oe,down:we}=wt;if([Ue,ie].includes(fe)){G(fe===Ue?-1:1),le.preventDefault();return}if([oe,we].includes(fe)){const Ae=fe===oe?-1:1,Oe=M.value[0]<L.value?"start":"end";J[`${Oe}_scrollDown`](Ae),le.preventDefault();return}},k=(le,fe)=>{const Ue=u?u(le):[],ie=le==="start",we=(fe||(ie?g.value:m.value)).hour(),Ae=ie?n(we+1,23):n(0,we-1);return mk(Ue,Ae)},D=(le,fe,Ue)=>{const ie=d?d(le,fe):[],oe=fe==="start",we=Ue||(oe?g.value:m.value),Ae=we.hour();if(le!==Ae)return ie;const Oe=we.minute(),ve=oe?n(Oe+1,59):n(0,Oe-1);return mk(ie,ve)},$=(le,fe,Ue,ie)=>{const oe=h?h(le,fe,Ue):[],we=Ue==="start",Ae=ie||(we?g.value:m.value),Oe=Ae.hour(),ve=Ae.minute();if(le!==Oe||fe!==ve)return oe;const ke=Ae.second(),be=we?n(ke+1,59):n(0,ke-1);return mk(oe,be)},F=([le,fe])=>[he(le,"start",!0,fe),he(fe,"end",!1,le)],{getAvailableHours:Y,getAvailableMinutes:ne,getAvailableSeconds:X}=Woe(k,D,$),{timePickerOptions:J,getAvailableTime:he,onSetOption:ye}=Hoe({getAvailableHours:Y,getAvailableMinutes:ne,getAvailableSeconds:X}),Te=le=>le?st(le)?le.map(fe=>Yt(fe,t.format).locale(s.value)):Yt(le,t.format).locale(s.value):null,ce=le=>le?st(le)?le.map(fe=>fe.format(t.format)):le.format(t.format):null,ae=()=>{if(st(p))return p.map(fe=>Yt(fe).locale(s.value));const le=Yt(p).locale(s.value);return[le,le.add(60,"m")]};return e("set-picker-option",["formatToString",ce]),e("set-picker-option",["parseUserInput",Te]),e("set-picker-option",["isValidValue",A]),e("set-picker-option",["handleKeydownInput",H]),e("set-picker-option",["getDefaultValue",ae]),e("set-picker-option",["getRangeAvailableTime",F]),(le,fe)=>le.actualVisible?(I(),Z("div",{key:0,class:N([v(a).b("range-picker"),v(o).b("panel")])},[Q("div",{class:N(v(a).be("range-picker","content"))},[Q("div",{class:N(v(a).be("range-picker","cell"))},[Q("div",{class:N(v(a).be("range-picker","header"))},We(v(r)("el.datepicker.startTime")),3),Q("div",{class:N([v(a).be("range-picker","body"),v(a).be("panel","content"),v(a).is("arrow",v(c)),{"has-seconds":v(x)}])},[re(K5,{ref:"minSpinner",role:"start","show-seconds":v(x),"am-pm-mode":v(w),"arrow-control":v(c),"spinner-date":v(m),"disabled-hours":k,"disabled-minutes":D,"disabled-seconds":$,onChange:S,onSetOption:v(ye),onSelectRange:V},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2),Q("div",{class:N(v(a).be("range-picker","cell"))},[Q("div",{class:N(v(a).be("range-picker","header"))},We(v(r)("el.datepicker.endTime")),3),Q("div",{class:N([v(a).be("range-picker","body"),v(a).be("panel","content"),v(a).is("arrow",v(c)),{"has-seconds":v(x)}])},[re(K5,{ref:"maxSpinner",role:"end","show-seconds":v(x),"am-pm-mode":v(w),"arrow-control":v(c),"spinner-date":v(g),"disabled-hours":k,"disabled-minutes":D,"disabled-seconds":$,onChange:E,onSetOption:v(ye),onSelectRange:U},null,8,["show-seconds","am-pm-mode","arrow-control","spinner-date","onSetOption"])],2)],2)],2),Q("div",{class:N(v(a).be("panel","footer"))},[Q("button",{type:"button",class:N([v(a).be("panel","btn"),"cancel"]),onClick:fe[0]||(fe[0]=Ue=>b())},We(v(r)("el.datepicker.cancel")),3),Q("button",{type:"button",class:N([v(a).be("panel","btn"),"confirm"]),disabled:v(O),onClick:fe[1]||(fe[1]=Ue=>C())},We(v(r)("el.datepicker.confirm")),11,_Ne)],2)],2)):_e("v-if",!0)}});var wNe=qe(bNe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-picker/src/time-picker-com/panel-time-range.vue"]]);Yt.extend(M9);var xNe=de({name:"ElTimePicker",install:null,props:{...P9,isRange:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,e){const t=W(),[n,r]=i.isRange?["timerange",wNe]:["time",p$],s=a=>e.emit("update:modelValue",a);return pi("ElPopperOptions",i.popperOptions),e.expose({focus:a=>{var o;(o=t.value)==null||o.handleFocusInput(a)},blur:a=>{var o;(o=t.value)==null||o.handleBlurInput(a)},handleOpen:()=>{var a;(a=t.value)==null||a.handleOpen()},handleClose:()=>{var a;(a=t.value)==null||a.handleClose()}}),()=>{var a;const o=(a=i.format)!=null?a:N5;return re(Uoe,ci(i,{ref:t,type:n,format:o,"onUpdate:modelValue":s}),{default:l=>re(r,l,null)})}}});const bR=xNe;bR.install=i=>{i.component(bR.name,bR)};const CNe=bR,TNe=(i,e)=>{const t=i.subtract(1,"month").endOf("month").date();return ly(e).map((n,r)=>t-(e-r-1))},SNe=i=>{const e=i.daysInMonth();return ly(e).map((t,n)=>n+1)},ENe=i=>ly(i.length/7).map(e=>{const t=e*7;return i.slice(t,t+7)}),ANe=Ke({selectedDay:{type:xe(Object)},range:{type:xe(Array)},date:{type:xe(Object),required:!0},hideHeader:{type:Boolean}}),MNe={pick:i=>oi(i)};var Y5={},PNe={get exports(){return Y5},set exports(i){Y5=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){return function(t,n,r){var s=n.prototype,a=function(d){return d&&(d.indexOf?d:d.s)},o=function(d,h,p,m,g){var _=d.name?d:d.$locale(),b=a(_[h]),x=a(_[p]),w=b||x.map(function(S){return S.slice(0,m)});if(!g)return w;var C=_.weekStart;return w.map(function(S,E){return w[(E+(C||0))%7]})},l=function(){return r.Ls[r.locale()]},c=function(d,h){return d.formats[h]||function(p){return p.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(m,g,_){return g||_.slice(1)})}(d.formats[h.toUpperCase()])},u=function(){var d=this;return{months:function(h){return h?h.format("MMMM"):o(d,"months")},monthsShort:function(h){return h?h.format("MMM"):o(d,"monthsShort","months",3)},firstDayOfWeek:function(){return d.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):o(d,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):o(d,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):o(d,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return c(d.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};s.localeData=function(){return u.bind(this)()},r.localeData=function(){var d=l();return{firstDayOfWeek:function(){return d.weekStart||0},weekdays:function(){return r.weekdays()},weekdaysShort:function(){return r.weekdaysShort()},weekdaysMin:function(){return r.weekdaysMin()},months:function(){return r.months()},monthsShort:function(){return r.monthsShort()},longDateFormat:function(h){return c(d,h)},meridiem:d.meridiem,ordinal:d.ordinal}},r.months=function(){return o(l(),"months")},r.monthsShort=function(){return o(l(),"monthsShort","months",3)},r.weekdays=function(d){return o(l(),"weekdays",null,null,d)},r.weekdaysShort=function(d){return o(l(),"weekdaysShort","weekdays",3,d)},r.weekdaysMin=function(d){return o(l(),"weekdaysMin","weekdays",2,d)}}})})(PNe);const ele=Y5,ONe=(i,e)=>{Yt.extend(ele);const t=Yt.localeData().firstDayOfWeek(),{t:n,lang:r}=Ki(),s=Yt().locale(r.value),a=R(()=>!!i.range&&!!i.range.length),o=R(()=>{let h=[];if(a.value){const[p,m]=i.range,g=ly(m.date()-p.date()+1).map(x=>({text:p.date()+x,type:"current"}));let _=g.length%7;_=_===0?0:7-_;const b=ly(_).map((x,w)=>({text:w+1,type:"next"}));h=g.concat(b)}else{const p=i.date.startOf("month").day(),m=TNe(i.date,(p-t+7)%7).map(x=>({text:x,type:"prev"})),g=SNe(i.date).map(x=>({text:x,type:"current"}));h=[...m,...g];const _=7-(h.length%7||7),b=ly(_).map((x,w)=>({text:w+1,type:"next"}));h=h.concat(b)}return ENe(h)}),l=R(()=>{const h=t;return h===0?gk.map(p=>n(`el.datepicker.weeks.${p}`)):gk.slice(h).concat(gk.slice(0,h)).map(p=>n(`el.datepicker.weeks.${p}`))}),c=(h,p)=>{switch(p){case"prev":return i.date.startOf("month").subtract(1,"month").date(h);case"next":return i.date.startOf("month").add(1,"month").date(h);case"current":return i.date.date(h)}};return{now:s,isInRange:a,rows:o,weekDays:l,getFormattedDate:c,handlePickDay:({text:h,type:p})=>{const m=c(h,p);e("pick",m)},getSlotData:({text:h,type:p})=>{const m=c(h,p);return{isSelected:m.isSame(i.selectedDay),type:`${p}-month`,day:m.format("YYYY-MM-DD"),date:m.toDate()}}}},RNe={key:0},INe=["onClick"],$Ne=de({name:"DateTable"}),LNe=de({...$Ne,props:ANe,emits:MNe,setup(i,{expose:e,emit:t}){const n=i,{isInRange:r,now:s,rows:a,weekDays:o,getFormattedDate:l,handlePickDay:c,getSlotData:u}=ONe(n,t),d=Ne("calendar-table"),h=Ne("calendar-day"),p=({text:m,type:g})=>{const _=[g];if(g==="current"){const b=l(m,g);b.isSame(n.selectedDay,"day")&&_.push(h.is("selected")),b.isSame(s,"day")&&_.push(h.is("today"))}return _};return e({getFormattedDate:l}),(m,g)=>(I(),Z("table",{class:N([v(d).b(),v(d).is("range",v(r))]),cellspacing:"0",cellpadding:"0"},[m.hideHeader?_e("v-if",!0):(I(),Z("thead",RNe,[(I(!0),Z(gt,null,xi(v(o),_=>(I(),Z("th",{key:_},We(_),1))),128))])),Q("tbody",null,[(I(!0),Z(gt,null,xi(v(a),(_,b)=>(I(),Z("tr",{key:b,class:N({[v(d).e("row")]:!0,[v(d).em("row","hide-border")]:b===0&&m.hideHeader})},[(I(!0),Z(gt,null,xi(_,(x,w)=>(I(),Z("td",{key:w,class:N(p(x)),onClick:C=>v(c)(x)},[Q("div",{class:N(v(h).b())},[Fe(m.$slots,"date-cell",{data:v(u)(x)},()=>[Q("span",null,We(x.text),1)])],2)],10,INe))),128))],2))),128))])],2))}});var Gq=qe(LNe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/date-table.vue"]]);const DNe=(i,e)=>{const t=i.endOf("month"),n=e.startOf("month"),s=t.isSame(n,"week")?n.add(1,"week"):n;return[[i,t],[s.startOf("week"),e]]},kNe=(i,e)=>{const t=i.endOf("month"),n=i.add(1,"month").startOf("month"),r=t.isSame(n,"week")?n.add(1,"week"):n,s=r.endOf("month"),a=e.startOf("month"),o=s.isSame(a,"week")?a.add(1,"week"):a;return[[i,t],[r.startOf("week"),s],[o.startOf("week"),e]]},FNe=(i,e,t)=>{const n=uo(),{lang:r}=Ki(),s=W(),a=Yt().locale(r.value),o=R({get(){return i.modelValue?c.value:s.value},set(b){if(!b)return;s.value=b;const x=b.toDate();e(jl,x),e(ri,x)}}),l=R(()=>{if(!i.range)return[];const b=i.range.map(C=>Yt(C).locale(r.value)),[x,w]=b;return x.isAfter(w)?[]:x.isSame(w,"month")?m(x,w):x.add(1,"month").month()!==w.month()?[]:m(x,w)}),c=R(()=>i.modelValue?Yt(i.modelValue).locale(r.value):o.value||(l.value.length?l.value[0][0]:a)),u=R(()=>c.value.subtract(1,"month").date(1)),d=R(()=>c.value.add(1,"month").date(1)),h=R(()=>c.value.subtract(1,"year").date(1)),p=R(()=>c.value.add(1,"year").date(1)),m=(b,x)=>{const w=b.startOf("week"),C=x.endOf("week"),S=w.get("month"),E=C.get("month");return S===E?[[w,C]]:(S+1)%12===E?DNe(w,C):S+2===E||(S+1)%11===E?kNe(w,C):[]},g=b=>{o.value=b},_=b=>{const w={"prev-month":u.value,"next-month":d.value,"prev-year":h.value,"next-year":p.value,today:a}[b];w.isSame(c.value,"day")||g(w)};return Ym({from:'"dateCell"',replacement:'"date-cell"',scope:"ElCalendar",version:"2.3.0",ref:"https://element-plus.org/en-US/component/calendar.html#slots",type:"Slot"},R(()=>!!n.dateCell)),{calculateValidatedDateRange:m,date:c,realSelectedDay:o,pickDay:g,selectDate:_,validatedRange:l}},NNe=i=>st(i)&&i.length===2&&i.every(e=>rb(e)),VNe=Ke({modelValue:{type:Date},range:{type:xe(Array),validator:NNe}}),BNe={[ri]:i=>rb(i),[jl]:i=>rb(i)},zNe="ElCalendar",UNe=de({name:zNe}),HNe=de({...UNe,props:VNe,emits:BNe,setup(i,{expose:e,emit:t}){const n=i,r=Ne("calendar"),{calculateValidatedDateRange:s,date:a,pickDay:o,realSelectedDay:l,selectDate:c,validatedRange:u}=FNe(n,t),{t:d}=Ki(),h=R(()=>{const p=`el.datepicker.month${a.value.format("M")}`;return`${a.value.year()} ${d("el.datepicker.year")} ${d(p)}`});return e({selectedDay:l,pickDay:o,selectDate:c,calculateValidatedDateRange:s}),(p,m)=>(I(),Z("div",{class:N(v(r).b())},[Q("div",{class:N(v(r).e("header"))},[Fe(p.$slots,"header",{date:v(h)},()=>[Q("div",{class:N(v(r).e("title"))},We(v(h)),3),v(u).length===0?(I(),Z("div",{key:0,class:N(v(r).e("button-group"))},[re(v(Foe),null,{default:pe(()=>[re(v(Bo),{size:"small",onClick:m[0]||(m[0]=g=>v(c)("prev-month"))},{default:pe(()=>[Gi(We(v(d)("el.datepicker.prevMonth")),1)]),_:1}),re(v(Bo),{size:"small",onClick:m[1]||(m[1]=g=>v(c)("today"))},{default:pe(()=>[Gi(We(v(d)("el.datepicker.today")),1)]),_:1}),re(v(Bo),{size:"small",onClick:m[2]||(m[2]=g=>v(c)("next-month"))},{default:pe(()=>[Gi(We(v(d)("el.datepicker.nextMonth")),1)]),_:1})]),_:1})],2)):_e("v-if",!0)])],2),v(u).length===0?(I(),Z("div",{key:0,class:N(v(r).e("body"))},[re(Gq,{date:v(a),"selected-day":v(l),onPick:v(o)},qm({_:2},[p.$slots["date-cell"]||p.$slots.dateCell?{name:"date-cell",fn:pe(g=>[p.$slots["date-cell"]?Fe(p.$slots,"date-cell",mh(ci({key:0},g))):Fe(p.$slots,"dateCell",mh(ci({key:1},g)))])}:void 0]),1032,["date","selected-day","onPick"])],2)):(I(),Z("div",{key:1,class:N(v(r).e("body"))},[(I(!0),Z(gt,null,xi(v(u),(g,_)=>(I(),Se(Gq,{key:_,date:g[0],"selected-day":v(l),range:g,"hide-header":_!==0,onPick:v(o)},qm({_:2},[p.$slots["date-cell"]||p.$slots.dateCell?{name:"date-cell",fn:pe(b=>[p.$slots["date-cell"]?Fe(p.$slots,"date-cell",mh(ci({key:0},b))):Fe(p.$slots,"dateCell",mh(ci({key:1},b)))])}:void 0]),1032,["date","selected-day","range","hide-header","onPick"]))),128))],2))],2))}});var GNe=qe(HNe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/calendar/src/calendar.vue"]]);const WNe=ii(GNe),jNe=Ke({header:{type:String,default:""},bodyStyle:{type:xe([String,Object,Array]),default:""},shadow:{type:String,values:["always","hover","never"],default:"always"}}),qNe=de({name:"ElCard"}),KNe=de({...qNe,props:jNe,setup(i){const e=Ne("card");return(t,n)=>(I(),Z("div",{class:N([v(e).b(),v(e).is(`${t.shadow}-shadow`)])},[t.$slots.header||t.header?(I(),Z("div",{key:0,class:N(v(e).e("header"))},[Fe(t.$slots,"header",{},()=>[Gi(We(t.header),1)])],2)):_e("v-if",!0),Q("div",{class:N(v(e).e("body")),style:pt(t.bodyStyle)},[Fe(t.$slots,"default")],6)],2))}});var YNe=qe(KNe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/card/src/card.vue"]]);const XNe=ii(YNe),ZNe=Ke({initialIndex:{type:Number,default:0},height:{type:String,default:""},trigger:{type:String,values:["hover","click"],default:"hover"},autoplay:{type:Boolean,default:!0},interval:{type:Number,default:3e3},indicatorPosition:{type:String,values:["","none","outside"],default:""},indicator:{type:Boolean,default:!0},arrow:{type:String,values:["always","hover","never"],default:"hover"},type:{type:String,values:["","card"],default:""},loop:{type:Boolean,default:!0},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},pauseOnHover:{type:Boolean,default:!0}}),QNe={change:(i,e)=>[i,e].every(It)},Wq=300,JNe=(i,e,t)=>{const{children:n,addChild:r,removeChild:s}=_oe(ti(),"ElCarouselItem"),a=W(-1),o=W(null),l=W(!1),c=W(),u=R(()=>i.arrow!=="never"&&!v(p)),d=R(()=>n.value.some(k=>k.props.label.toString().length>0)),h=R(()=>i.type==="card"),p=R(()=>i.direction==="vertical"),m=V0(k=>{w(k)},Wq,{trailing:!0}),g=V0(k=>{V(k)},Wq);function _(){o.value&&(clearInterval(o.value),o.value=null)}function b(){i.interval<=0||!i.autoplay||o.value||(o.value=setInterval(()=>x(),i.interval))}const x=()=>{a.value<n.value.length-1?a.value=a.value+1:i.loop&&(a.value=0)};function w(k){if(Ft(k)){const F=n.value.filter(Y=>Y.props.name===k);F.length>0&&(k=n.value.indexOf(F[0]))}if(k=Number(k),Number.isNaN(k)||k!==Math.floor(k))return;const D=n.value.length,$=a.value;k<0?a.value=i.loop?D-1:0:k>=D?a.value=i.loop?0:D-1:a.value=k,$===a.value&&C($),G()}function C(k){n.value.forEach((D,$)=>{D.translateItem($,a.value,k)})}function S(k,D){var $,F,Y,ne;const X=v(n),J=X.length;if(J===0||!k.states.inStage)return!1;const he=D+1,ye=D-1,Te=J-1,ce=X[Te].states.active,ae=X[0].states.active,le=(F=($=X[he])==null?void 0:$.states)==null?void 0:F.active,fe=(ne=(Y=X[ye])==null?void 0:Y.states)==null?void 0:ne.active;return D===Te&&ae||le?"left":D===0&&ce||fe?"right":!1}function E(){l.value=!0,i.pauseOnHover&&_()}function A(){l.value=!1,b()}function P(k){v(p)||n.value.forEach((D,$)=>{k===S(D,$)&&(D.states.hover=!0)})}function O(){v(p)||n.value.forEach(k=>{k.states.hover=!1})}function M(k){a.value=k}function V(k){i.trigger==="hover"&&k!==a.value&&(a.value=k)}function L(){w(a.value-1)}function U(){w(a.value+1)}function G(){_(),b()}Ve(()=>a.value,(k,D)=>{C(D),D>-1&&e("change",k,D)}),Ve(()=>i.autoplay,k=>{k?b():_()}),Ve(()=>i.loop,()=>{w(a.value)}),Ve(()=>i.interval,()=>{G()}),Ve(()=>n.value,()=>{n.value.length>0&&w(i.initialIndex)});const H=nr();return qt(()=>{H.value=fl(c.value,()=>{C()}),b()}),Vr(()=>{_(),c.value&&H.value&&H.value.stop()}),pi(Rae,{root:c,isCardType:h,isVertical:p,items:n,loop:i.loop,addItem:r,removeItem:s,setActiveItem:w}),{root:c,activeIndex:a,arrowDisplay:u,hasLabel:d,hover:l,isCardType:h,items:n,handleButtonEnter:P,handleButtonLeave:O,handleIndicatorClick:M,handleMouseEnter:E,handleMouseLeave:A,setActiveItem:w,prev:L,next:U,throttledArrowClick:m,throttledIndicatorHover:g}},e5e=["onMouseenter","onClick"],t5e={key:0},i5e="ElCarousel",n5e=de({name:i5e}),r5e=de({...n5e,props:ZNe,emits:QNe,setup(i,{expose:e,emit:t}){const n=i,{root:r,activeIndex:s,arrowDisplay:a,hasLabel:o,hover:l,isCardType:c,items:u,handleButtonEnter:d,handleButtonLeave:h,handleIndicatorClick:p,handleMouseEnter:m,handleMouseLeave:g,setActiveItem:_,prev:b,next:x,throttledArrowClick:w,throttledIndicatorHover:C}=JNe(n,t),S=Ne("carousel"),E=R(()=>{const P=[S.b(),S.m(n.direction)];return v(c)&&P.push(S.m("card")),P}),A=R(()=>{const P=[S.e("indicators"),S.em("indicators",n.direction)];return v(o)&&P.push(S.em("indicators","labels")),(n.indicatorPosition==="outside"||v(c))&&P.push(S.em("indicators","outside")),P});return e({setActiveItem:_,prev:b,next:x}),(P,O)=>(I(),Z("div",{ref_key:"root",ref:r,class:N(v(E)),onMouseenter:O[6]||(O[6]=Dt((...M)=>v(m)&&v(m)(...M),["stop"])),onMouseleave:O[7]||(O[7]=Dt((...M)=>v(g)&&v(g)(...M),["stop"]))},[Q("div",{class:N(v(S).e("container")),style:pt({height:P.height})},[v(a)?(I(),Se(Ss,{key:0,name:"carousel-arrow-left",persisted:""},{default:pe(()=>[zt(Q("button",{type:"button",class:N([v(S).e("arrow"),v(S).em("arrow","left")]),onMouseenter:O[0]||(O[0]=M=>v(d)("left")),onMouseleave:O[1]||(O[1]=(...M)=>v(h)&&v(h)(...M)),onClick:O[2]||(O[2]=Dt(M=>v(w)(v(s)-1),["stop"]))},[re(v(ct),null,{default:pe(()=>[re(v(Ty))]),_:1})],34),[[Ei,(P.arrow==="always"||v(l))&&(n.loop||v(s)>0)]])]),_:1})):_e("v-if",!0),v(a)?(I(),Se(Ss,{key:1,name:"carousel-arrow-right",persisted:""},{default:pe(()=>[zt(Q("button",{type:"button",class:N([v(S).e("arrow"),v(S).em("arrow","right")]),onMouseenter:O[3]||(O[3]=M=>v(d)("right")),onMouseleave:O[4]||(O[4]=(...M)=>v(h)&&v(h)(...M)),onClick:O[5]||(O[5]=Dt(M=>v(w)(v(s)+1),["stop"]))},[re(v(ct),null,{default:pe(()=>[re(v(Wl))]),_:1})],34),[[Ei,(P.arrow==="always"||v(l))&&(n.loop||v(s)<v(u).length-1)]])]),_:1})):_e("v-if",!0),Fe(P.$slots,"default")],6),P.indicatorPosition!=="none"?(I(),Z("ul",{key:0,class:N(v(A))},[(I(!0),Z(gt,null,xi(v(u),(M,V)=>(I(),Z("li",{key:V,class:N([v(S).e("indicator"),v(S).em("indicator",P.direction),v(S).is("active",V===v(s))]),onMouseenter:L=>v(C)(V),onClick:Dt(L=>v(p)(V),["stop"])},[Q("button",{class:N(v(S).e("button"))},[v(o)?(I(),Z("span",t5e,We(M.props.label),1)):_e("v-if",!0)],2)],42,e5e))),128))],2)):_e("v-if",!0)],34))}});var s5e=qe(r5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/carousel/src/carousel.vue"]]);const a5e=Ke({name:{type:String,default:""},label:{type:[String,Number],default:""}}),o5e=(i,e)=>{const t=ht(Rae),n=ti(),r=.83,s=W(!1),a=W(0),o=W(1),l=W(!1),c=W(!1),u=W(!1),d=W(!1),{isCardType:h,isVertical:p}=t;function m(w,C,S){const E=S-1,A=C-1,P=C+1,O=S/2;return C===0&&w===E?-1:C===E&&w===0?S:w<A&&C-w>=O?S+1:w>P&&w-C>=O?-2:w}function g(w,C){var S;const E=((S=t.root.value)==null?void 0:S.offsetWidth)||0;return u.value?E*((2-r)*(w-C)+1)/4:w<C?-(1+r)*E/4:(3+r)*E/4}function _(w,C,S){const E=t.root.value;return E?((S?E.offsetHeight:E.offsetWidth)||0)*(w-C):0}const b=(w,C,S)=>{var E;const A=v(h),P=(E=t.items.value.length)!=null?E:Number.NaN,O=w===C;!A&&!eo(S)&&(d.value=O||w===S),!O&&P>2&&t.loop&&(w=m(w,C,P));const M=v(p);l.value=O,A?(u.value=Math.round(Math.abs(w-C))<=1,a.value=g(w,C),o.value=v(l)?1:r):a.value=_(w,C,M),c.value=!0};function x(){if(t&&v(h)){const w=t.items.value.findIndex(({uid:C})=>C===n.uid);t.setActiveItem(w)}}return qt(()=>{t.addItem({props:i,states:Ji({hover:s,translate:a,scale:o,active:l,ready:c,inStage:u,animating:d}),uid:n.uid,translateItem:b})}),ky(()=>{t.removeItem(n.uid)}),{active:l,animating:d,hover:s,inStage:u,isVertical:p,translate:a,isCardType:h,scale:o,ready:c,handleItemClick:x}},l5e=de({name:"ElCarouselItem"}),c5e=de({...l5e,props:a5e,setup(i){const e=i,t=Ne("carousel"),{active:n,animating:r,hover:s,inStage:a,isVertical:o,translate:l,isCardType:c,scale:u,ready:d,handleItemClick:h}=o5e(e),p=R(()=>{const g=`${`translate${v(o)?"Y":"X"}`}(${v(l)}px)`,_=`scale(${v(u)})`;return{transform:[g,_].join(" ")}});return(m,g)=>zt((I(),Z("div",{class:N([v(t).e("item"),v(t).is("active",v(n)),v(t).is("in-stage",v(a)),v(t).is("hover",v(s)),v(t).is("animating",v(r)),{[v(t).em("item","card")]:v(c)}]),style:pt(v(p)),onClick:g[0]||(g[0]=(..._)=>v(h)&&v(h)(..._))},[v(c)?zt((I(),Z("div",{key:0,class:N(v(t).e("mask"))},null,2)),[[Ei,!v(n)]]):_e("v-if",!0),Fe(m.$slots,"default")],6)),[[Ei,v(d)]])}});var tle=qe(c5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/carousel/src/carousel-item.vue"]]);const u5e=ii(s5e,{CarouselItem:tle}),d5e=Wr(tle),ile={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object]},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:Ql,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},nle={[ri]:i=>Ft(i)||It(i)||Ys(i),change:i=>Ft(i)||It(i)||Ys(i)},h5e=({model:i,isChecked:e})=>{const t=ht(UC,void 0),n=R(()=>{var s,a;const o=(s=t==null?void 0:t.max)==null?void 0:s.value,l=(a=t==null?void 0:t.min)==null?void 0:a.value;return!eo(o)&&i.value.length>=o&&!e.value||!eo(l)&&i.value.length<=l&&e.value});return{isDisabled:zc(R(()=>(t==null?void 0:t.disabled.value)||n.value)),isLimitDisabled:n}},p5e=(i,{model:e,isLimitExceeded:t,hasOwnLabel:n,isDisabled:r,isLabeledByFormItem:s})=>{const a=ht(UC,void 0),{formItem:o}=nc(),{emit:l}=ti();function c(m){var g,_;return m===i.trueLabel||m===!0?(g=i.trueLabel)!=null?g:!0:(_=i.falseLabel)!=null?_:!1}function u(m,g){l("change",c(m),g)}function d(m){if(t.value)return;const g=m.target;l("change",c(g.checked),m)}async function h(m){t.value||!n.value&&!r.value&&s.value&&(m.composedPath().some(b=>b.tagName==="LABEL")||(e.value=c([!1,i.falseLabel].includes(e.value)),await ut(),u(e.value,m)))}const p=R(()=>(a==null?void 0:a.validateEvent)||i.validateEvent);return Ve(()=>i.modelValue,()=>{p.value&&(o==null||o.validate("change").catch(m=>void 0))}),{handleChange:d,onClickRoot:h}},f5e=i=>{const e=W(!1),{emit:t}=ti(),n=ht(UC,void 0),r=R(()=>eo(n)===!1),s=W(!1);return{model:R({get(){var o,l;return r.value?(o=n==null?void 0:n.modelValue)==null?void 0:o.value:(l=i.modelValue)!=null?l:e.value},set(o){var l,c;r.value&&st(o)?(s.value=((l=n==null?void 0:n.max)==null?void 0:l.value)!==void 0&&o.length>(n==null?void 0:n.max.value),s.value===!1&&((c=n==null?void 0:n.changeEvent)==null||c.call(n,o))):(t(ri,o),e.value=o)}}),isGroup:r,isLimitExceeded:s}},m5e=(i,e,{model:t})=>{const n=ht(UC,void 0),r=W(!1),s=R(()=>{const c=t.value;return Ys(c)?c:st(c)?oi(i.label)?c.map(mn).some(u=>Iu(u,i.label)):c.map(mn).includes(i.label):c!=null?c===i.trueLabel:!!c}),a=Qs(R(()=>{var c;return(c=n==null?void 0:n.size)==null?void 0:c.value}),{prop:!0}),o=Qs(R(()=>{var c;return(c=n==null?void 0:n.size)==null?void 0:c.value})),l=R(()=>!!(e.default||i.label));return{checkboxButtonSize:a,isChecked:s,isFocused:r,checkboxSize:o,hasOwnLabel:l}},g5e=(i,{model:e})=>{function t(){st(e.value)&&!e.value.includes(i.label)?e.value.push(i.label):e.value=i.trueLabel||!0}i.checked&&t()},rle=(i,e)=>{const{formItem:t}=nc(),{model:n,isGroup:r,isLimitExceeded:s}=f5e(i),{isFocused:a,isChecked:o,checkboxButtonSize:l,checkboxSize:c,hasOwnLabel:u}=m5e(i,e,{model:n}),{isDisabled:d}=h5e({model:n,isChecked:o}),{inputId:h,isLabeledByFormItem:p}=By(i,{formItemContext:t,disableIdGeneration:u,disableIdManagement:r}),{handleChange:m,onClickRoot:g}=p5e(i,{model:n,isLimitExceeded:s,hasOwnLabel:u,isDisabled:d,isLabeledByFormItem:p});return g5e(i,{model:n}),{inputId:h,isLabeledByFormItem:p,isChecked:o,isDisabled:d,isFocused:a,checkboxButtonSize:l,checkboxSize:c,hasOwnLabel:u,model:n,handleChange:m,onClickRoot:g}},v5e=["tabindex","role","aria-checked"],y5e=["id","aria-hidden","name","tabindex","disabled","true-value","false-value"],_5e=["id","aria-hidden","disabled","value","name","tabindex"],b5e=de({name:"ElCheckbox"}),w5e=de({...b5e,props:ile,emits:nle,setup(i){const e=i,t=uo(),{inputId:n,isLabeledByFormItem:r,isChecked:s,isDisabled:a,isFocused:o,checkboxSize:l,hasOwnLabel:c,model:u,handleChange:d,onClickRoot:h}=rle(e,t),p=Ne("checkbox"),m=R(()=>[p.b(),p.m(l.value),p.is("disabled",a.value),p.is("bordered",e.border),p.is("checked",s.value)]),g=R(()=>[p.e("input"),p.is("disabled",a.value),p.is("checked",s.value),p.is("indeterminate",e.indeterminate),p.is("focus",o.value)]);return(_,b)=>(I(),Se(hi(!v(c)&&v(r)?"span":"label"),{class:N(v(m)),"aria-controls":_.indeterminate?_.controls:null,onClick:v(h)},{default:pe(()=>[Q("span",{class:N(v(g)),tabindex:_.indeterminate?0:void 0,role:_.indeterminate?"checkbox":void 0,"aria-checked":_.indeterminate?"mixed":void 0},[_.trueLabel||_.falseLabel?zt((I(),Z("input",{key:0,id:v(n),"onUpdate:modelValue":b[0]||(b[0]=x=>Vn(u)?u.value=x:null),class:N(v(p).e("original")),type:"checkbox","aria-hidden":_.indeterminate?"true":"false",name:_.name,tabindex:_.tabindex,disabled:v(a),"true-value":_.trueLabel,"false-value":_.falseLabel,onChange:b[1]||(b[1]=(...x)=>v(d)&&v(d)(...x)),onFocus:b[2]||(b[2]=x=>o.value=!0),onBlur:b[3]||(b[3]=x=>o.value=!1)},null,42,y5e)),[[a$,v(u)]]):zt((I(),Z("input",{key:1,id:v(n),"onUpdate:modelValue":b[4]||(b[4]=x=>Vn(u)?u.value=x:null),class:N(v(p).e("original")),type:"checkbox","aria-hidden":_.indeterminate?"true":"false",disabled:v(a),value:_.label,name:_.name,tabindex:_.tabindex,onChange:b[5]||(b[5]=(...x)=>v(d)&&v(d)(...x)),onFocus:b[6]||(b[6]=x=>o.value=!0),onBlur:b[7]||(b[7]=x=>o.value=!1)},null,42,_5e)),[[a$,v(u)]]),Q("span",{class:N(v(p).e("inner"))},null,2)],10,v5e),v(c)?(I(),Z("span",{key:0,class:N(v(p).e("label"))},[Fe(_.$slots,"default"),_.$slots.default?_e("v-if",!0):(I(),Z(gt,{key:0},[Gi(We(_.label),1)],64))],2)):_e("v-if",!0)]),_:3},8,["class","aria-controls","onClick"]))}});var x5e=qe(w5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox.vue"]]);const C5e=["name","tabindex","disabled","true-value","false-value"],T5e=["name","tabindex","disabled","value"],S5e=de({name:"ElCheckboxButton"}),E5e=de({...S5e,props:ile,emits:nle,setup(i){const e=i,t=uo(),{isFocused:n,isChecked:r,isDisabled:s,checkboxButtonSize:a,model:o,handleChange:l}=rle(e,t),c=ht(UC,void 0),u=Ne("checkbox"),d=R(()=>{var p,m,g,_;const b=(m=(p=c==null?void 0:c.fill)==null?void 0:p.value)!=null?m:"";return{backgroundColor:b,borderColor:b,color:(_=(g=c==null?void 0:c.textColor)==null?void 0:g.value)!=null?_:"",boxShadow:b?`-1px 0 0 0 ${b}`:void 0}}),h=R(()=>[u.b("button"),u.bm("button",a.value),u.is("disabled",s.value),u.is("checked",r.value),u.is("focus",n.value)]);return(p,m)=>(I(),Z("label",{class:N(v(h))},[p.trueLabel||p.falseLabel?zt((I(),Z("input",{key:0,"onUpdate:modelValue":m[0]||(m[0]=g=>Vn(o)?o.value=g:null),class:N(v(u).be("button","original")),type:"checkbox",name:p.name,tabindex:p.tabindex,disabled:v(s),"true-value":p.trueLabel,"false-value":p.falseLabel,onChange:m[1]||(m[1]=(...g)=>v(l)&&v(l)(...g)),onFocus:m[2]||(m[2]=g=>n.value=!0),onBlur:m[3]||(m[3]=g=>n.value=!1)},null,42,C5e)),[[a$,v(o)]]):zt((I(),Z("input",{key:1,"onUpdate:modelValue":m[4]||(m[4]=g=>Vn(o)?o.value=g:null),class:N(v(u).be("button","original")),type:"checkbox",name:p.name,tabindex:p.tabindex,disabled:v(s),value:p.label,onChange:m[5]||(m[5]=(...g)=>v(l)&&v(l)(...g)),onFocus:m[6]||(m[6]=g=>n.value=!0),onBlur:m[7]||(m[7]=g=>n.value=!1)},null,42,T5e)),[[a$,v(o)]]),p.$slots.default||p.label?(I(),Z("span",{key:2,class:N(v(u).be("button","inner")),style:pt(v(r)?v(d):void 0)},[Fe(p.$slots,"default",{},()=>[Gi(We(p.label),1)])],6)):_e("v-if",!0)],2))}});var sle=qe(E5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-button.vue"]]);const A5e=Ke({modelValue:{type:xe(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:Ql,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}}),M5e={[ri]:i=>st(i),change:i=>st(i)},P5e=de({name:"ElCheckboxGroup"}),O5e=de({...P5e,props:A5e,emits:M5e,setup(i,{emit:e}){const t=i,n=Ne("checkbox"),{formItem:r}=nc(),{inputId:s,isLabeledByFormItem:a}=By(t,{formItemContext:r}),o=async c=>{e(ri,c),await ut(),e("change",c)},l=R({get(){return t.modelValue},set(c){o(c)}});return pi(UC,{...Am(_a(t),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:l,changeEvent:o}),Ve(()=>t.modelValue,()=>{t.validateEvent&&(r==null||r.validate("change").catch(c=>void 0))}),(c,u)=>{var d;return I(),Se(hi(c.tag),{id:v(s),class:N(v(n).b("group")),role:"group","aria-label":v(a)?void 0:c.label||"checkbox-group","aria-labelledby":v(a)?(d=v(r))==null?void 0:d.labelId:void 0},{default:pe(()=>[Fe(c.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var ale=qe(O5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/checkbox/src/checkbox-group.vue"]]);const Pd=ii(x5e,{CheckboxButton:sle,CheckboxGroup:ale}),R5e=Wr(sle),ole=Wr(ale),lle=Ke({size:Ql,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),I5e=Ke({...lle,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),cle={[ri]:i=>Ft(i)||It(i)||Ys(i),[rr]:i=>Ft(i)||It(i)||Ys(i)},ule=(i,e)=>{const t=W(),n=ht(kae,void 0),r=R(()=>!!n),s=R({get(){return r.value?n.modelValue:i.modelValue},set(u){r.value?n.changeEvent(u):e&&e(ri,u),t.value.checked=i.modelValue===i.label}}),a=Qs(R(()=>n==null?void 0:n.size)),o=zc(R(()=>n==null?void 0:n.disabled)),l=W(!1),c=R(()=>o.value||r.value&&s.value!==i.label?-1:0);return{radioRef:t,isGroup:r,radioGroup:n,focus:l,size:a,disabled:o,tabIndex:c,modelValue:s}},$5e=["value","name","disabled"],L5e=de({name:"ElRadio"}),D5e=de({...L5e,props:I5e,emits:cle,setup(i,{emit:e}){const t=i,n=Ne("radio"),{radioRef:r,radioGroup:s,focus:a,size:o,disabled:l,modelValue:c}=ule(t,e);function u(){ut(()=>e("change",c.value))}return(d,h)=>{var p;return I(),Z("label",{class:N([v(n).b(),v(n).is("disabled",v(l)),v(n).is("focus",v(a)),v(n).is("bordered",d.border),v(n).is("checked",v(c)===d.label),v(n).m(v(o))])},[Q("span",{class:N([v(n).e("input"),v(n).is("disabled",v(l)),v(n).is("checked",v(c)===d.label)])},[zt(Q("input",{ref_key:"radioRef",ref:r,"onUpdate:modelValue":h[0]||(h[0]=m=>Vn(c)?c.value=m:null),class:N(v(n).e("original")),value:d.label,name:d.name||((p=v(s))==null?void 0:p.name),disabled:v(l),type:"radio",onFocus:h[1]||(h[1]=m=>a.value=!0),onBlur:h[2]||(h[2]=m=>a.value=!1),onChange:u},null,42,$5e),[[Tse,v(c)]]),Q("span",{class:N(v(n).e("inner"))},null,2)],2),Q("span",{class:N(v(n).e("label")),onKeydown:h[3]||(h[3]=Dt(()=>{},["stop"]))},[Fe(d.$slots,"default",{},()=>[Gi(We(d.label),1)])],34)],2)}}});var k5e=qe(D5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio.vue"]]);const F5e=Ke({...lle,name:{type:String,default:""}}),N5e=["value","name","disabled"],V5e=de({name:"ElRadioButton"}),B5e=de({...V5e,props:F5e,setup(i){const e=i,t=Ne("radio"),{radioRef:n,focus:r,size:s,disabled:a,modelValue:o,radioGroup:l}=ule(e),c=R(()=>({backgroundColor:(l==null?void 0:l.fill)||"",borderColor:(l==null?void 0:l.fill)||"",boxShadow:l!=null&&l.fill?`-1px 0 0 0 ${l.fill}`:"",color:(l==null?void 0:l.textColor)||""}));return(u,d)=>{var h;return I(),Z("label",{class:N([v(t).b("button"),v(t).is("active",v(o)===u.label),v(t).is("disabled",v(a)),v(t).is("focus",v(r)),v(t).bm("button",v(s))])},[zt(Q("input",{ref_key:"radioRef",ref:n,"onUpdate:modelValue":d[0]||(d[0]=p=>Vn(o)?o.value=p:null),class:N(v(t).be("button","original-radio")),value:u.label,type:"radio",name:u.name||((h=v(l))==null?void 0:h.name),disabled:v(a),onFocus:d[1]||(d[1]=p=>r.value=!0),onBlur:d[2]||(d[2]=p=>r.value=!1)},null,42,N5e),[[Tse,v(o)]]),Q("span",{class:N(v(t).be("button","inner")),style:pt(v(o)===u.label?v(c):{}),onKeydown:d[3]||(d[3]=Dt(()=>{},["stop"]))},[Fe(u.$slots,"default",{},()=>[Gi(We(u.label),1)])],38)],2)}}});var dle=qe(B5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-button.vue"]]);const z5e=Ke({id:{type:String,default:void 0},size:Ql,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),U5e=cle,H5e=["id","aria-label","aria-labelledby"],G5e=de({name:"ElRadioGroup"}),W5e=de({...G5e,props:z5e,emits:U5e,setup(i,{emit:e}){const t=i,n=Ne("radio"),r=Ih(),s=W(),{formItem:a}=nc(),{inputId:o,isLabeledByFormItem:l}=By(t,{formItemContext:a}),c=d=>{e(ri,d),ut(()=>e("change",d))};qt(()=>{const d=s.value.querySelectorAll("[type=radio]"),h=d[0];!Array.from(d).some(p=>p.checked)&&h&&(h.tabIndex=0)});const u=R(()=>t.name||r.value);return pi(kae,Ji({..._a(t),changeEvent:c,name:u})),Ve(()=>t.modelValue,()=>{t.validateEvent&&(a==null||a.validate("change").catch(d=>void 0))}),(d,h)=>(I(),Z("div",{id:v(o),ref_key:"radioGroupRef",ref:s,class:N(v(n).b("group")),role:"radiogroup","aria-label":v(l)?void 0:d.label||"radio-group","aria-labelledby":v(l)?v(a).labelId:void 0},[Fe(d.$slots,"default")],10,H5e))}});var hle=qe(W5e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-group.vue"]]);const ple=ii(k5e,{RadioButton:dle,RadioGroup:hle}),j5e=Wr(hle),q5e=Wr(dle);var K5e=de({name:"NodeContent",setup(){return{ns:Ne("cascader-node")}},render(){const{ns:i}=this,{node:e,panel:t}=this.$parent,{data:n,label:r}=e,{renderLabelFn:s}=t;return bt("span",{class:i.e("label")},s?s({node:e,data:n}):r)}});const O9=Symbol(),Y5e=de({name:"ElCascaderNode",components:{ElCheckbox:Pd,ElRadio:ple,NodeContent:K5e,ElIcon:ct,Check:sM,Loading:Vy,ArrowRight:Wl},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(i,{emit:e}){const t=ht(O9),n=Ne("cascader-node"),r=R(()=>t.isHoverMenu),s=R(()=>t.config.multiple),a=R(()=>t.config.checkStrictly),o=R(()=>{var E;return(E=t.checkedNodes[0])==null?void 0:E.uid}),l=R(()=>i.node.isDisabled),c=R(()=>i.node.isLeaf),u=R(()=>a.value&&!c.value||!l.value),d=R(()=>p(t.expandingNode)),h=R(()=>a.value&&t.checkedNodes.some(p)),p=E=>{var A;const{level:P,uid:O}=i.node;return((A=E==null?void 0:E.pathNodes[P-1])==null?void 0:A.uid)===O},m=()=>{d.value||t.expandNode(i.node)},g=E=>{const{node:A}=i;E!==A.checked&&t.handleCheckChange(A,E)},_=()=>{t.lazyLoad(i.node,()=>{c.value||m()})},b=E=>{r.value&&(x(),!c.value&&e("expand",E))},x=()=>{const{node:E}=i;!u.value||E.loading||(E.loaded?m():_())},w=()=>{r.value&&!c.value||(c.value&&!l.value&&!a.value&&!s.value?S(!0):x())},C=E=>{a.value?(g(E),i.node.loaded&&m()):S(E)},S=E=>{i.node.loaded?(g(E),!a.value&&m()):_()};return{panel:t,isHoverMenu:r,multiple:s,checkStrictly:a,checkedNodeId:o,isDisabled:l,isLeaf:c,expandable:u,inExpandingPath:d,inCheckedPath:h,ns:n,handleHoverExpand:b,handleExpand:x,handleClick:w,handleCheck:S,handleSelectCheck:C}}}),X5e=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],Z5e=Q("span",null,null,-1);function Q5e(i,e,t,n,r,s){const a=jt("el-checkbox"),o=jt("el-radio"),l=jt("check"),c=jt("el-icon"),u=jt("node-content"),d=jt("loading"),h=jt("arrow-right");return I(),Z("li",{id:`${i.menuId}-${i.node.uid}`,role:"menuitem","aria-haspopup":!i.isLeaf,"aria-owns":i.isLeaf?null:i.menuId,"aria-expanded":i.inExpandingPath,tabindex:i.expandable?-1:void 0,class:N([i.ns.b(),i.ns.is("selectable",i.checkStrictly),i.ns.is("active",i.node.checked),i.ns.is("disabled",!i.expandable),i.inExpandingPath&&"in-active-path",i.inCheckedPath&&"in-checked-path"]),onMouseenter:e[2]||(e[2]=(...p)=>i.handleHoverExpand&&i.handleHoverExpand(...p)),onFocus:e[3]||(e[3]=(...p)=>i.handleHoverExpand&&i.handleHoverExpand(...p)),onClick:e[4]||(e[4]=(...p)=>i.handleClick&&i.handleClick(...p))},[_e(" prefix "),i.multiple?(I(),Se(a,{key:0,"model-value":i.node.checked,indeterminate:i.node.indeterminate,disabled:i.isDisabled,onClick:e[0]||(e[0]=Dt(()=>{},["stop"])),"onUpdate:modelValue":i.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):i.checkStrictly?(I(),Se(o,{key:1,"model-value":i.checkedNodeId,label:i.node.uid,disabled:i.isDisabled,"onUpdate:modelValue":i.handleSelectCheck,onClick:e[1]||(e[1]=Dt(()=>{},["stop"]))},{default:pe(()=>[_e(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),Z5e]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):i.isLeaf&&i.node.checked?(I(),Se(c,{key:2,class:N(i.ns.e("prefix"))},{default:pe(()=>[re(l)]),_:1},8,["class"])):_e("v-if",!0),_e(" content "),re(u),_e(" postfix "),i.isLeaf?_e("v-if",!0):(I(),Z(gt,{key:3},[i.node.loading?(I(),Se(c,{key:0,class:N([i.ns.is("loading"),i.ns.e("postfix")])},{default:pe(()=>[re(d)]),_:1},8,["class"])):(I(),Se(c,{key:1,class:N(["arrow-right",i.ns.e("postfix")])},{default:pe(()=>[re(h)]),_:1},8,["class"]))],64))],42,X5e)}var J5e=qe(Y5e,[["render",Q5e],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/node.vue"]]);const eVe=de({name:"ElCascaderMenu",components:{Loading:Vy,ElIcon:ct,ElScrollbar:_g,ElCascaderNode:J5e},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(i){const e=ti(),t=Ne("cascader-menu"),{t:n}=Ki(),r=I3();let s=null,a=null;const o=ht(O9),l=W(null),c=R(()=>!i.nodes.length),u=R(()=>!o.initialLoaded),d=R(()=>`cascader-menu-${r}-${i.index}`),h=_=>{s=_.target},p=_=>{if(!(!o.isHoverMenu||!s||!l.value))if(s.contains(_.target)){m();const b=e.vnode.el,{left:x}=b.getBoundingClientRect(),{offsetWidth:w,offsetHeight:C}=b,S=_.clientX-x,E=s.offsetTop,A=E+s.offsetHeight;l.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${S} ${E} L${w} 0 V${E} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${S} ${A} L${w} ${C} V${A} Z" />
        `}else a||(a=window.setTimeout(g,o.config.hoverThreshold))},m=()=>{a&&(clearTimeout(a),a=null)},g=()=>{l.value&&(l.value.innerHTML="",m())};return{ns:t,panel:o,hoverZone:l,isEmpty:c,isLoading:u,menuId:d,t:n,handleExpand:h,handleMouseMove:p,clearHoverZone:g}}});function tVe(i,e,t,n,r,s){const a=jt("el-cascader-node"),o=jt("loading"),l=jt("el-icon"),c=jt("el-scrollbar");return I(),Se(c,{key:i.menuId,tag:"ul",role:"menu",class:N(i.ns.b()),"wrap-class":i.ns.e("wrap"),"view-class":[i.ns.e("list"),i.ns.is("empty",i.isEmpty)],onMousemove:i.handleMouseMove,onMouseleave:i.clearHoverZone},{default:pe(()=>{var u;return[(I(!0),Z(gt,null,xi(i.nodes,d=>(I(),Se(a,{key:d.uid,node:d,"menu-id":i.menuId,onExpand:i.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),i.isLoading?(I(),Z("div",{key:0,class:N(i.ns.e("empty-text"))},[re(l,{size:"14",class:N(i.ns.is("loading"))},{default:pe(()=>[re(o)]),_:1},8,["class"]),Gi(" "+We(i.t("el.cascader.loading")),1)],2)):i.isEmpty?(I(),Z("div",{key:1,class:N(i.ns.e("empty-text"))},We(i.t("el.cascader.noData")),3)):(u=i.panel)!=null&&u.isHoverMenu?(I(),Z("svg",{key:2,ref:"hoverZone",class:N(i.ns.e("hover-zone"))},null,2)):_e("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var iVe=qe(eVe,[["render",tVe],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/menu.vue"]]);let nVe=0;const rVe=i=>{const e=[i];let{parent:t}=i;for(;t;)e.unshift(t),t=t.parent;return e};let K2=class{constructor(e,t,n,r=!1){this.data=e,this.config=t,this.parent=n,this.root=r,this.uid=nVe++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:s,label:a,children:o}=t,l=e[o],c=rVe(this);this.level=r?0:n?n.level+1:1,this.value=e[s],this.label=e[a],this.pathNodes=c,this.pathValues=c.map(u=>u.value),this.pathLabels=c.map(u=>u.label),this.childrenData=l,this.children=(l||[]).map(u=>new K2(u,t,this)),this.loaded=!t.lazy||this.isLeaf||!pd(l)}get isDisabled(){const{data:e,parent:t,config:n}=this,{disabled:r,checkStrictly:s}=n;return(Lt(r)?r(e,this):!!e[r])||!s&&(t==null?void 0:t.isDisabled)}get isLeaf(){const{data:e,config:t,childrenData:n,loaded:r}=this,{lazy:s,leaf:a}=t,o=Lt(a)?a(e,this):e[a];return eo(o)?s&&!r?!1:!(Array.isArray(n)&&n.length):!!o}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(e){const{childrenData:t,children:n}=this,r=new K2(e,this.config,this);return Array.isArray(t)?t.push(e):this.childrenData=[e],n.push(r),r}calcText(e,t){const n=e?this.pathLabels.join(t):this.label;return this.text=n,n}broadcast(e,...t){const n=`onParent${Op(e)}`;this.children.forEach(r=>{r&&(r.broadcast(e,...t),r[n]&&r[n](...t))})}emit(e,...t){const{parent:n}=this,r=`onChild${Op(e)}`;n&&(n[r]&&n[r](...t),n.emit(e,...t))}onParentCheck(e){this.isDisabled||this.setCheckState(e)}onChildCheck(){const{children:e}=this,t=e.filter(r=>!r.isDisabled),n=t.length?t.every(r=>r.checked):!1;this.setCheckState(n)}setCheckState(e){const t=this.children.length,n=this.children.reduce((r,s)=>{const a=s.checked?1:s.indeterminate?.5:0;return r+a},0);this.checked=this.loaded&&this.children.filter(r=>!r.isDisabled).every(r=>r.loaded&&r.checked)&&e,this.indeterminate=this.loaded&&n!==t&&n>0}doCheck(e){if(this.checked===e)return;const{checkStrictly:t,multiple:n}=this.config;t||!n?this.checked=e:(this.broadcast("check",e),this.setCheckState(e),this.emit("check"))}};const X5=(i,e)=>i.reduce((t,n)=>(n.isLeaf?t.push(n):(!e&&t.push(n),t=t.concat(X5(n.children,e))),t),[]);class jq{constructor(e,t){this.config=t;const n=(e||[]).map(r=>new K2(r,this.config));this.nodes=n,this.allNodes=X5(n,!1),this.leafNodes=X5(n,!0)}getNodes(){return this.nodes}getFlattedNodes(e){return e?this.leafNodes:this.allNodes}appendNode(e,t){const n=t?t.appendChild(e):new K2(e,this.config);t||this.nodes.push(n),this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n)}appendNodes(e,t){e.forEach(n=>this.appendNode(n,t))}getNodeByValue(e,t=!1){return!e&&e!==0?null:this.getFlattedNodes(t).find(r=>Iu(r.value,e)||Iu(r.pathValues,e))||null}getSameNode(e){return e&&this.getFlattedNodes(!1).find(({value:n,level:r})=>Iu(e.value,n)&&e.level===r)||null}}const fle=Ke({modelValue:{type:xe([Number,String,Array])},options:{type:xe(Array),default:()=>[]},props:{type:xe(Object),default:()=>({})}}),sVe={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:yn,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},aVe=i=>R(()=>({...sVe,...i.props})),qq=i=>{if(!i)return 0;const e=i.id.split("-");return Number(e[e.length-2])},oVe=i=>{if(!i)return;const e=i.querySelector("input");e?e.click():hae(i)&&i.click()},lVe=(i,e)=>{const t=e.slice(0),n=t.map(s=>s.uid),r=i.reduce((s,a)=>{const o=n.indexOf(a.uid);return o>-1&&(s.push(a),t.splice(o,1),n.splice(o,1)),s},[]);return r.push(...t),r},cVe=de({name:"ElCascaderPanel",components:{ElCascaderMenu:iVe},props:{...fle,border:{type:Boolean,default:!0},renderLabel:Function},emits:[ri,rr,"close","expand-change"],setup(i,{emit:e,slots:t}){let n=!1;const r=Ne("cascader"),s=aVe(i);let a=null;const o=W(!0),l=W([]),c=W(null),u=W([]),d=W(null),h=W([]),p=R(()=>s.value.expandTrigger==="hover"),m=R(()=>i.renderLabel||t.default),g=()=>{const{options:L}=i,U=s.value;n=!1,a=new jq(L,U),u.value=[a.getNodes()],U.lazy&&pd(i.options)?(o.value=!1,_(void 0,G=>{G&&(a=new jq(G,U),u.value=[a.getNodes()]),o.value=!0,P(!1,!0)})):P(!1,!0)},_=(L,U)=>{const G=s.value;L=L||new K2({},G,void 0,!0),L.loading=!0;const H=k=>{const D=L,$=D.root?null:D;k&&(a==null||a.appendNodes(k,$)),D.loading=!1,D.loaded=!0,D.childrenData=D.childrenData||[],U&&U(k)};G.lazyLoad(L,H)},b=(L,U)=>{var G;const{level:H}=L,k=u.value.slice(0,H);let D;L.isLeaf?D=L.pathNodes[H-2]:(D=L,k.push(L.children)),((G=d.value)==null?void 0:G.uid)!==(D==null?void 0:D.uid)&&(d.value=L,u.value=k,!U&&e("expand-change",(L==null?void 0:L.pathValues)||[]))},x=(L,U,G=!0)=>{const{checkStrictly:H,multiple:k}=s.value,D=h.value[0];n=!0,!k&&(D==null||D.doCheck(!1)),L.doCheck(U),A(),G&&!k&&!H&&e("close"),!G&&!k&&!H&&w(L)},w=L=>{L&&(L=L.parent,w(L),L&&b(L))},C=L=>a==null?void 0:a.getFlattedNodes(L),S=L=>{var U;return(U=C(L))==null?void 0:U.filter(G=>G.checked!==!1)},E=()=>{h.value.forEach(L=>L.doCheck(!1)),A()},A=()=>{var L;const{checkStrictly:U,multiple:G}=s.value,H=h.value,k=S(!U),D=lVe(H,k),$=D.map(F=>F.valueByOption);h.value=D,c.value=G?$:(L=$[0])!=null?L:null},P=(L=!1,U=!1)=>{const{modelValue:G}=i,{lazy:H,multiple:k,checkStrictly:D}=s.value,$=!D;if(!(!o.value||n||!U&&Iu(G,c.value)))if(H&&!L){const Y=Zj(IPe(Rm(G))).map(ne=>a==null?void 0:a.getNodeByValue(ne)).filter(ne=>!!ne&&!ne.loaded&&!ne.loading);Y.length?Y.forEach(ne=>{_(ne,()=>P(!1,U))}):P(!0,U)}else{const F=k?Rm(G):[G],Y=Zj(F.map(ne=>a==null?void 0:a.getNodeByValue(ne,$)));O(Y,U),c.value=eae(G)}},O=(L,U=!0)=>{const{checkStrictly:G}=s.value,H=h.value,k=L.filter(F=>!!F&&(G||F.isLeaf)),D=a==null?void 0:a.getSameNode(d.value),$=U&&D||k[0];$?$.pathNodes.forEach(F=>b(F,!0)):d.value=null,H.forEach(F=>F.doCheck(!1)),k.forEach(F=>F.doCheck(!0)),h.value=k,ut(M)},M=()=>{Ii&&l.value.forEach(L=>{const U=L==null?void 0:L.$el;if(U){const G=U.querySelector(`.${r.namespace.value}-scrollbar__wrap`),H=U.querySelector(`.${r.b("node")}.${r.is("active")}`)||U.querySelector(`.${r.b("node")}.in-active-path`);_ae(G,H)}})},V=L=>{const U=L.target,{code:G}=L;switch(G){case wt.up:case wt.down:{L.preventDefault();const H=G===wt.up?-1:1;fR(pae(U,H,`.${r.b("node")}[tabindex="-1"]`));break}case wt.left:{L.preventDefault();const H=l.value[qq(U)-1],k=H==null?void 0:H.$el.querySelector(`.${r.b("node")}[aria-expanded="true"]`);fR(k);break}case wt.right:{L.preventDefault();const H=l.value[qq(U)+1],k=H==null?void 0:H.$el.querySelector(`.${r.b("node")}[tabindex="-1"]`);fR(k);break}case wt.enter:oVe(U);break}};return pi(O9,Ji({config:s,expandingNode:d,checkedNodes:h,isHoverMenu:p,initialLoaded:o,renderLabelFn:m,lazyLoad:_,expandNode:b,handleCheckChange:x})),Ve([s,()=>i.options],g,{deep:!0,immediate:!0}),Ve(()=>i.modelValue,()=>{n=!1,P()},{deep:!0}),Ve(()=>c.value,L=>{Iu(L,i.modelValue)||(e(ri,L),e(rr,L))}),tse(()=>l.value=[]),qt(()=>!pd(i.modelValue)&&P()),{ns:r,menuList:l,menus:u,checkedNodes:h,handleKeyDown:V,handleCheckChange:x,getFlattedNodes:C,getCheckedNodes:S,clearCheckedNodes:E,calculateCheckedValue:A,scrollToExpandingNode:M}}});function uVe(i,e,t,n,r,s){const a=jt("el-cascader-menu");return I(),Z("div",{class:N([i.ns.b("panel"),i.ns.is("bordered",i.border)]),onKeydown:e[0]||(e[0]=(...o)=>i.handleKeyDown&&i.handleKeyDown(...o))},[(I(!0),Z(gt,null,xi(i.menus,(o,l)=>(I(),Se(a,{key:l,ref_for:!0,ref:c=>i.menuList[l]=c,index:l,nodes:[...o]},null,8,["index","nodes"]))),128))],34)}var wR=qe(cVe,[["render",uVe],["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader-panel/src/index.vue"]]);wR.install=i=>{i.component(wR.name,wR)};const mle=wR,dVe=mle,R9=Ke({closable:Boolean,type:{type:String,values:["success","info","warning","danger",""],default:""},hit:Boolean,disableTransitions:Boolean,color:{type:String,default:""},size:{type:String,values:gg,default:""},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),hVe={close:i=>i instanceof MouseEvent,click:i=>i instanceof MouseEvent},pVe=de({name:"ElTag"}),fVe=de({...pVe,props:R9,emits:hVe,setup(i,{emit:e}){const t=i,n=Qs(),r=Ne("tag"),s=R(()=>{const{type:l,hit:c,effect:u,closable:d,round:h}=t;return[r.b(),r.is("closable",d),r.m(l),r.m(n.value),r.m(u),r.is("hit",c),r.is("round",h)]}),a=l=>{e("close",l)},o=l=>{e("click",l)};return(l,c)=>l.disableTransitions?(I(),Z("span",{key:0,class:N(v(s)),style:pt({backgroundColor:l.color}),onClick:o},[Q("span",{class:N(v(r).e("content"))},[Fe(l.$slots,"default")],2),l.closable?(I(),Se(v(ct),{key:0,class:N(v(r).e("close")),onClick:Dt(a,["stop"])},{default:pe(()=>[re(v(Rh))]),_:1},8,["class","onClick"])):_e("v-if",!0)],6)):(I(),Se(Ss,{key:1,name:`${v(r).namespace.value}-zoom-in-center`,appear:""},{default:pe(()=>[Q("span",{class:N(v(s)),style:pt({backgroundColor:l.color}),onClick:o},[Q("span",{class:N(v(r).e("content"))},[Fe(l.$slots,"default")],2),l.closable?(I(),Se(v(ct),{key:0,class:N(v(r).e("close")),onClick:Dt(a,["stop"])},{default:pe(()=>[re(v(Rh))]),_:1},8,["class","onClick"])):_e("v-if",!0)],6)]),_:3},8,["name"]))}});var mVe=qe(fVe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tag/src/tag.vue"]]);const Y2=ii(mVe),gVe=Ke({...fle,size:Ql,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:xe(Function),default:(i,e)=>i.text.includes(e)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:xe(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:Xa.teleported,tagType:{...R9.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),vVe={[ri]:i=>!!i,[rr]:i=>!!i,focus:i=>i instanceof FocusEvent,blur:i=>i instanceof FocusEvent,visibleChange:i=>Ys(i),expandChange:i=>!!i,removeTag:i=>!!i},yVe={key:0},_Ve=["placeholder","onKeydown"],bVe=["onClick"],wVe="ElCascader",xVe=de({name:wVe}),CVe=de({...xVe,props:gVe,emits:vVe,setup(i,{expose:e,emit:t}){const n=i,r={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:te})=>{const{modifiersData:me,placement:Ie}=te;["right","left","bottom","top"].includes(Ie)||(me.arrow.x=35)},requires:["arrow"]}]},s=VC();let a=0,o=0;const l=Ne("cascader"),c=Ne("input"),{t:u}=Ki(),{form:d,formItem:h}=nc(),p=W(null),m=W(null),g=W(null),_=W(null),b=W(null),x=W(!1),w=W(!1),C=W(!1),S=W(""),E=W(""),A=W([]),P=W([]),O=W([]),M=W(!1),V=R(()=>s.style),L=R(()=>n.disabled||(d==null?void 0:d.disabled)),U=R(()=>n.placeholder||u("el.cascader.placeholder")),G=R(()=>E.value||A.value.length>0||M.value?"":U.value),H=Qs(),k=R(()=>["small"].includes(H.value)?"small":"default"),D=R(()=>!!n.props.multiple),$=R(()=>!n.filterable||D.value),F=R(()=>D.value?E.value:S.value),Y=R(()=>{var te;return((te=_.value)==null?void 0:te.checkedNodes)||[]}),ne=R(()=>!n.clearable||L.value||C.value||!w.value?!1:!!Y.value.length),X=R(()=>{const{showAllLevels:te,separator:me}=n,Ie=Y.value;return Ie.length?D.value?"":Ie[0].calcText(te,me):""}),J=R({get(){return eae(n.modelValue)},set(te){t(ri,te),t(rr,te),n.validateEvent&&(h==null||h.validate("change").catch(me=>void 0))}}),he=R(()=>{var te,me;return(me=(te=p.value)==null?void 0:te.popperRef)==null?void 0:me.contentRef}),ye=R(()=>[l.b(),l.m(H.value),l.is("disabled",L.value),s.class]),Te=R(()=>[c.e("icon"),"icon-arrow-down",l.is("reverse",x.value)]),ce=te=>{var me,Ie,K;L.value||(te=te??!x.value,te!==x.value&&(x.value=te,(Ie=(me=m.value)==null?void 0:me.input)==null||Ie.setAttribute("aria-expanded",`${te}`),te?(ae(),ut((K=_.value)==null?void 0:K.scrollToExpandingNode)):n.filterable&&Le(),t("visibleChange",te)))},ae=()=>{ut(()=>{var te;(te=p.value)==null||te.updatePopper()})},le=()=>{C.value=!1},fe=te=>{const{showAllLevels:me,separator:Ie}=n;return{node:te,key:te.uid,text:te.calcText(me,Ie),hitState:!1,closable:!L.value&&!te.isDisabled,isCollapseTag:!1}},Ue=te=>{var me;const Ie=te.node;Ie.doCheck(!1),(me=_.value)==null||me.calculateCheckedValue(),t("removeTag",Ie.valueByOption)},ie=()=>{if(!D.value)return;const te=Y.value,me=[],Ie=[];if(te.forEach(K=>Ie.push(fe(K))),P.value=Ie,te.length){const[K,...se]=te,Me=se.length;me.push(fe(K)),Me&&(n.collapseTags?me.push({key:-1,text:`+ ${Me}`,closable:!1,isCollapseTag:!0}):se.forEach(De=>me.push(fe(De))))}A.value=me},oe=()=>{var te,me;const{filterMethod:Ie,showAllLevels:K,separator:se}=n,Me=(me=(te=_.value)==null?void 0:te.getFlattedNodes(!n.props.checkStrictly))==null?void 0:me.filter(De=>De.isDisabled?!1:(De.calcText(K,se),Ie(De,F.value)));D.value&&(A.value.forEach(De=>{De.hitState=!1}),P.value.forEach(De=>{De.hitState=!1})),C.value=!0,O.value=Me,ae()},we=()=>{var te;let me;C.value&&b.value?me=b.value.$el.querySelector(`.${l.e("suggestion-item")}`):me=(te=_.value)==null?void 0:te.$el.querySelector(`.${l.b("node")}[tabindex="-1"]`),me&&(me.focus(),!C.value&&me.click())},Ae=()=>{var te,me;const Ie=(te=m.value)==null?void 0:te.input,K=g.value,se=(me=b.value)==null?void 0:me.$el;if(!(!Ii||!Ie)){if(se){const Me=se.querySelector(`.${l.e("suggestion-list")}`);Me.style.minWidth=`${Ie.offsetWidth}px`}if(K){const{offsetHeight:Me}=K,De=A.value.length>0?`${Math.max(Me+6,a)}px`:`${a}px`;Ie.style.height=De,ae()}}},Oe=te=>{var me;return(me=_.value)==null?void 0:me.getCheckedNodes(te)},ve=te=>{ae(),t("expandChange",te)},ke=te=>{var me;const Ie=(me=te.target)==null?void 0:me.value;if(te.type==="compositionend")M.value=!1,ut(()=>Qe(Ie));else{const K=Ie[Ie.length-1]||"";M.value=!O3(K)}},be=te=>{if(!M.value)switch(te.code){case wt.enter:ce();break;case wt.down:ce(!0),ut(we),te.preventDefault();break;case wt.esc:x.value===!0&&(te.preventDefault(),te.stopPropagation(),ce(!1));break;case wt.tab:ce(!1);break}},$e=()=>{var te;(te=_.value)==null||te.clearCheckedNodes(),!x.value&&n.filterable&&Le(),ce(!1)},Le=()=>{const{value:te}=X;S.value=te,E.value=te},Ce=te=>{var me,Ie;const{checked:K}=te;D.value?(me=_.value)==null||me.handleCheckChange(te,!K,!1):(!K&&((Ie=_.value)==null||Ie.handleCheckChange(te,!0,!1)),ce(!1))},Be=te=>{const me=te.target,{code:Ie}=te;switch(Ie){case wt.up:case wt.down:{const K=Ie===wt.up?-1:1;fR(pae(me,K,`.${l.e("suggestion-item")}[tabindex="-1"]`));break}case wt.enter:me.click();break}},He=()=>{const te=A.value,me=te[te.length-1];o=E.value?0:o+1,!(!me||!o||n.collapseTags&&te.length>1)&&(me.hitState?Ue(me):me.hitState=!0)},Xe=te=>{t("focus",te)},Je=te=>{t("blur",te)},it=Zl(()=>{const{value:te}=F;if(!te)return;const me=n.beforeFilter(te);C2(me)?me.then(oe).catch(()=>{}):me!==!1?oe():le()},n.debounce),Qe=(te,me)=>{!x.value&&ce(!0),!(me!=null&&me.isComposing)&&(te?it():le())};return Ve(C,ae),Ve([Y,L],ie),Ve(A,()=>{ut(()=>Ae())}),Ve(X,Le,{immediate:!0}),qt(()=>{const te=m.value.input,me=Number.parseFloat(hOe(c.cssVarName("input-height"),te).value)-2;a=te.offsetHeight||me,fl(te,Ae)}),e({getCheckedNodes:Oe,cascaderPanelRef:he}),(te,me)=>(I(),Se(v(Jl),{ref_key:"tooltipRef",ref:p,visible:x.value,teleported:te.teleported,"popper-class":[v(l).e("dropdown"),te.popperClass],"popper-options":r,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${v(l).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:le},{default:pe(()=>[zt((I(),Z("div",{class:N(v(ye)),style:pt(v(V)),onClick:me[5]||(me[5]=()=>ce(v($)?void 0:!0)),onKeydown:be,onMouseenter:me[6]||(me[6]=Ie=>w.value=!0),onMouseleave:me[7]||(me[7]=Ie=>w.value=!1)},[re(v(ol),{ref_key:"input",ref:m,modelValue:S.value,"onUpdate:modelValue":me[1]||(me[1]=Ie=>S.value=Ie),placeholder:v(G),readonly:v($),disabled:v(L),"validate-event":!1,size:v(H),class:N(v(l).is("focus",x.value)),onCompositionstart:ke,onCompositionupdate:ke,onCompositionend:ke,onFocus:Xe,onBlur:Je,onInput:Qe},{suffix:pe(()=>[v(ne)?(I(),Se(v(ct),{key:"clear",class:N([v(c).e("icon"),"icon-circle-close"]),onClick:Dt($e,["stop"])},{default:pe(()=>[re(v(Ny))]),_:1},8,["class","onClick"])):(I(),Se(v(ct),{key:"arrow-down",class:N(v(Te)),onClick:me[0]||(me[0]=Dt(Ie=>ce(),["stop"]))},{default:pe(()=>[re(v(Fy))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class"]),v(D)?(I(),Z("div",{key:0,ref_key:"tagWrapper",ref:g,class:N(v(l).e("tags"))},[(I(!0),Z(gt,null,xi(A.value,Ie=>(I(),Se(v(Y2),{key:Ie.key,type:te.tagType,size:v(k),hit:Ie.hitState,closable:Ie.closable,"disable-transitions":"",onClose:K=>Ue(Ie)},{default:pe(()=>[Ie.isCollapseTag===!1?(I(),Z("span",yVe,We(Ie.text),1)):(I(),Se(v(Jl),{key:1,disabled:x.value||!te.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:pe(()=>[Q("span",null,We(Ie.text),1)]),content:pe(()=>[Q("div",{class:N(v(l).e("collapse-tags"))},[(I(!0),Z(gt,null,xi(P.value.slice(1),(K,se)=>(I(),Z("div",{key:se,class:N(v(l).e("collapse-tag"))},[(I(),Se(v(Y2),{key:K.key,class:"in-tooltip",type:te.tagType,size:v(k),hit:K.hitState,closable:K.closable,"disable-transitions":"",onClose:Me=>Ue(K)},{default:pe(()=>[Q("span",null,We(K.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),te.filterable&&!v(L)?zt((I(),Z("input",{key:0,"onUpdate:modelValue":me[2]||(me[2]=Ie=>E.value=Ie),type:"text",class:N(v(l).e("search-input")),placeholder:v(X)?"":v(U),onInput:me[3]||(me[3]=Ie=>Qe(E.value,Ie)),onClick:me[4]||(me[4]=Dt(Ie=>ce(!0),["stop"])),onKeydown:Di(He,["delete"]),onCompositionstart:ke,onCompositionupdate:ke,onCompositionend:ke},null,42,_Ve)),[[Fz,E.value]]):_e("v-if",!0)],2)):_e("v-if",!0)],38)),[[v(My),()=>ce(!1),v(he)]])]),content:pe(()=>[zt(re(v(mle),{ref_key:"panel",ref:_,modelValue:v(J),"onUpdate:modelValue":me[8]||(me[8]=Ie=>Vn(J)?J.value=Ie:null),options:te.options,props:n.props,border:!1,"render-label":te.$slots.default,onExpandChange:ve,onClose:me[9]||(me[9]=Ie=>te.$nextTick(()=>ce(!1)))},null,8,["modelValue","options","props","render-label"]),[[Ei,!C.value]]),te.filterable?zt((I(),Se(v(_g),{key:0,ref_key:"suggestionPanel",ref:b,tag:"ul",class:N(v(l).e("suggestion-panel")),"view-class":v(l).e("suggestion-list"),onKeydown:Be},{default:pe(()=>[O.value.length?(I(!0),Z(gt,{key:0},xi(O.value,Ie=>(I(),Z("li",{key:Ie.uid,class:N([v(l).e("suggestion-item"),v(l).is("checked",Ie.checked)]),tabindex:-1,onClick:K=>Ce(Ie)},[Q("span",null,We(Ie.text),1),Ie.checked?(I(),Se(v(ct),{key:0},{default:pe(()=>[re(v(sM))]),_:1})):_e("v-if",!0)],10,bVe))),128)):Fe(te.$slots,"empty",{key:1},()=>[Q("li",{class:N(v(l).e("empty-text"))},We(v(u)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[Ei,C.value]]):_e("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var xR=qe(CVe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/cascader/src/cascader.vue"]]);xR.install=i=>{i.component(xR.name,xR)};const TVe=xR,SVe=TVe,EVe=Ke({checked:{type:Boolean,default:!1}}),AVe={"update:checked":i=>Ys(i),[rr]:i=>Ys(i)},MVe=de({name:"ElCheckTag"}),PVe=de({...MVe,props:EVe,emits:AVe,setup(i,{emit:e}){const t=i,n=Ne("check-tag"),r=()=>{const s=!t.checked;e(rr,s),e("update:checked",s)};return(s,a)=>(I(),Z("span",{class:N([v(n).b(),v(n).is("checked",s.checked)]),onClick:r},[Fe(s.$slots,"default")],2))}});var OVe=qe(PVe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/check-tag/src/check-tag.vue"]]);const RVe=ii(OVe),IVe=Ke({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:xe([Number,Object]),default:()=>Ar({})},sm:{type:xe([Number,Object]),default:()=>Ar({})},md:{type:xe([Number,Object]),default:()=>Ar({})},lg:{type:xe([Number,Object]),default:()=>Ar({})},xl:{type:xe([Number,Object]),default:()=>Ar({})}}),$Ve=de({name:"ElCol"}),LVe=de({...$Ve,props:IVe,setup(i){const e=i,{gutter:t}=ht(Fae,{gutter:R(()=>0)}),n=Ne("col"),r=R(()=>{const a={};return t.value&&(a.paddingLeft=a.paddingRight=`${t.value/2}px`),a}),s=R(()=>{const a=[];return["span","offset","pull","push"].forEach(c=>{const u=e[c];It(u)&&(c==="span"?a.push(n.b(`${e[c]}`)):u>0&&a.push(n.b(`${c}-${e[c]}`)))}),["xs","sm","md","lg","xl"].forEach(c=>{It(e[c])?a.push(n.b(`${c}-${e[c]}`)):oi(e[c])&&Object.entries(e[c]).forEach(([u,d])=>{a.push(u!=="span"?n.b(`${c}-${u}-${d}`):n.b(`${c}-${d}`))})}),t.value&&a.push(n.is("guttered")),[n.b(),a]});return(a,o)=>(I(),Se(hi(a.tag),{class:N(v(s)),style:pt(v(r))},{default:pe(()=>[Fe(a.$slots,"default")]),_:3},8,["class","style"]))}});var DVe=qe(LVe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/col/src/col.vue"]]);const kVe=ii(DVe),Kq=i=>typeof It(i),FVe=Ke({accordion:Boolean,modelValue:{type:xe([Array,String,Number]),default:()=>Ar([])}}),NVe={[ri]:Kq,[rr]:Kq},VVe=(i,e)=>{const t=W(nC(i.modelValue)),n=s=>{t.value=s;const a=i.accordion?t.value[0]:t.value;e(ri,a),e(rr,a)},r=s=>{if(i.accordion)n([t.value[0]===s?"":s]);else{const a=[...t.value],o=a.indexOf(s);o>-1?a.splice(o,1):a.push(s),n(a)}};return Ve(()=>i.modelValue,()=>t.value=nC(i.modelValue),{deep:!0}),pi(Iae,{activeNames:t,handleItemClick:r}),{activeNames:t,setActiveNames:n}},BVe=()=>{const i=Ne("collapse");return{rootKls:R(()=>i.b())}},zVe=de({name:"ElCollapse"}),UVe=de({...zVe,props:FVe,emits:NVe,setup(i,{expose:e,emit:t}){const n=i,{activeNames:r,setActiveNames:s}=VVe(n,t),{rootKls:a}=BVe();return e({activeNames:r,setActiveNames:s}),(o,l)=>(I(),Z("div",{class:N(v(a)),role:"tablist","aria-multiselectable":"true"},[Fe(o.$slots,"default")],2))}});var HVe=qe(UVe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse.vue"]]);const GVe=de({name:"ElCollapseTransition"}),WVe=de({...GVe,setup(i){const e=Ne("collapse-transition"),t={beforeEnter(n){n.dataset||(n.dataset={}),n.dataset.oldPaddingTop=n.style.paddingTop,n.dataset.oldPaddingBottom=n.style.paddingBottom,n.style.maxHeight=0,n.style.paddingTop=0,n.style.paddingBottom=0},enter(n){n.dataset.oldOverflow=n.style.overflow,n.scrollHeight!==0?(n.style.maxHeight=`${n.scrollHeight}px`,n.style.paddingTop=n.dataset.oldPaddingTop,n.style.paddingBottom=n.dataset.oldPaddingBottom):(n.style.maxHeight=0,n.style.paddingTop=n.dataset.oldPaddingTop,n.style.paddingBottom=n.dataset.oldPaddingBottom),n.style.overflow="hidden"},afterEnter(n){n.style.maxHeight="",n.style.overflow=n.dataset.oldOverflow},beforeLeave(n){n.dataset||(n.dataset={}),n.dataset.oldPaddingTop=n.style.paddingTop,n.dataset.oldPaddingBottom=n.style.paddingBottom,n.dataset.oldOverflow=n.style.overflow,n.style.maxHeight=`${n.scrollHeight}px`,n.style.overflow="hidden"},leave(n){n.scrollHeight!==0&&(n.style.maxHeight=0,n.style.paddingTop=0,n.style.paddingBottom=0)},afterLeave(n){n.style.maxHeight="",n.style.overflow=n.dataset.oldOverflow,n.style.paddingTop=n.dataset.oldPaddingTop,n.style.paddingBottom=n.dataset.oldPaddingBottom}};return(n,r)=>(I(),Se(Ss,ci({name:v(e).b()},RCe(t)),{default:pe(()=>[Fe(n.$slots,"default")]),_:3},16,["name"]))}});var CR=qe(WVe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse-transition/src/collapse-transition.vue"]]);CR.install=i=>{i.component(CR.name,CR)};const U3=CR,jVe=U3,qVe=Ke({title:{type:String,default:""},name:{type:xe([String,Number]),default:()=>I3()},disabled:Boolean}),KVe=i=>{const e=ht(Iae),t=W(!1),n=W(!1),r=W(I3()),s=R(()=>e==null?void 0:e.activeNames.value.includes(i.name));return{focusing:t,id:r,isActive:s,handleFocus:()=>{setTimeout(()=>{n.value?n.value=!1:t.value=!0},50)},handleHeaderClick:()=>{i.disabled||(e==null||e.handleItemClick(i.name),t.value=!1,n.value=!0)},handleEnterClick:()=>{e==null||e.handleItemClick(i.name)}}},YVe=(i,{focusing:e,isActive:t,id:n})=>{const r=Ne("collapse"),s=R(()=>[r.b("item"),r.is("active",v(t)),r.is("disabled",i.disabled)]),a=R(()=>[r.be("item","header"),r.is("active",v(t)),{focusing:v(e)&&!i.disabled}]),o=R(()=>[r.be("item","arrow"),r.is("active",v(t))]),l=R(()=>r.be("item","wrap")),c=R(()=>r.be("item","content")),u=R(()=>r.b(`content-${v(n)}`)),d=R(()=>r.b(`head-${v(n)}`));return{arrowKls:o,headKls:a,rootKls:s,itemWrapperKls:l,itemContentKls:c,scopedContentId:u,scopedHeadId:d}},XVe=["aria-expanded","aria-controls","aria-describedby"],ZVe=["id","tabindex"],QVe=["id","aria-hidden","aria-labelledby"],JVe=de({name:"ElCollapseItem"}),e6e=de({...JVe,props:qVe,setup(i,{expose:e}){const t=i,{focusing:n,id:r,isActive:s,handleFocus:a,handleHeaderClick:o,handleEnterClick:l}=KVe(t),{arrowKls:c,headKls:u,rootKls:d,itemWrapperKls:h,itemContentKls:p,scopedContentId:m,scopedHeadId:g}=YVe(t,{focusing:n,isActive:s,id:r});return e({isActive:s}),(_,b)=>(I(),Z("div",{class:N(v(d))},[Q("div",{role:"tab","aria-expanded":v(s),"aria-controls":v(m),"aria-describedby":v(m)},[Q("div",{id:v(g),class:N(v(u)),role:"button",tabindex:_.disabled?-1:0,onClick:b[0]||(b[0]=(...x)=>v(o)&&v(o)(...x)),onKeypress:b[1]||(b[1]=Di(Dt((...x)=>v(l)&&v(l)(...x),["stop","prevent"]),["space","enter"])),onFocus:b[2]||(b[2]=(...x)=>v(a)&&v(a)(...x)),onBlur:b[3]||(b[3]=x=>n.value=!1)},[Fe(_.$slots,"title",{},()=>[Gi(We(_.title),1)]),re(v(ct),{class:N(v(c))},{default:pe(()=>[re(v(Wl))]),_:1},8,["class"])],42,ZVe)],8,XVe),re(v(U3),null,{default:pe(()=>[zt(Q("div",{id:v(m),class:N(v(h)),role:"tabpanel","aria-hidden":!v(s),"aria-labelledby":v(g)},[Q("div",{class:N(v(p))},[Fe(_.$slots,"default")],2)],10,QVe),[[Ei,v(s)]])]),_:3})],2))}});var gle=qe(e6e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/collapse/src/collapse-item.vue"]]);const t6e=ii(HVe,{CollapseItem:gle}),i6e=Wr(gle);let Ak=!1;function X2(i,e){if(!Ii)return;const t=function(s){var a;(a=e.drag)==null||a.call(e,s)},n=function(s){var a;document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",n),document.onselectstart=null,document.ondragstart=null,Ak=!1,(a=e.end)==null||a.call(e,s)},r=function(s){var a;Ak||(s.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",t),document.addEventListener("mouseup",n),document.addEventListener("touchmove",t),document.addEventListener("touchend",n),Ak=!0,(a=e.start)==null||a.call(e,s))};i.addEventListener("mousedown",r),i.addEventListener("touchstart",r)}const n6e=de({name:"ElColorAlphaSlider",props:{color:{type:Object,required:!0},vertical:{type:Boolean,default:!1}},setup(i){const e=Ne("color-alpha-slider"),t=ti(),n=nr(),r=nr(),s=W(0),a=W(0),o=W();Ve(()=>i.color.get("alpha"),()=>{p()}),Ve(()=>i.color.value,()=>{p()});function l(){if(!n.value||i.vertical)return 0;const m=t.vnode.el,g=i.color.get("alpha");return m?Math.round(g*(m.offsetWidth-n.value.offsetWidth/2)/100):0}function c(){if(!n.value)return 0;const m=t.vnode.el;if(!i.vertical)return 0;const g=i.color.get("alpha");return m?Math.round(g*(m.offsetHeight-n.value.offsetHeight/2)/100):0}function u(){if(i.color&&i.color.value){const{r:m,g,b:_}=i.color.toRgb();return`linear-gradient(to right, rgba(${m}, ${g}, ${_}, 0) 0%, rgba(${m}, ${g}, ${_}, 1) 100%)`}return""}function d(m){m.target!==n.value&&h(m)}function h(m){if(!r.value||!n.value)return;const _=t.vnode.el.getBoundingClientRect(),{clientX:b,clientY:x}=t9(m);if(i.vertical){let w=x-_.top;w=Math.max(n.value.offsetHeight/2,w),w=Math.min(w,_.height-n.value.offsetHeight/2),i.color.set("alpha",Math.round((w-n.value.offsetHeight/2)/(_.height-n.value.offsetHeight)*100))}else{let w=b-_.left;w=Math.max(n.value.offsetWidth/2,w),w=Math.min(w,_.width-n.value.offsetWidth/2),i.color.set("alpha",Math.round((w-n.value.offsetWidth/2)/(_.width-n.value.offsetWidth)*100))}}function p(){s.value=l(),a.value=c(),o.value=u()}return qt(()=>{if(!r.value||!n.value)return;const m={drag:g=>{h(g)},end:g=>{h(g)}};X2(r.value,m),X2(n.value,m),p()}),{thumb:n,bar:r,thumbLeft:s,thumbTop:a,background:o,handleClick:d,update:p,ns:e}}});function r6e(i,e,t,n,r,s){return I(),Z("div",{class:N([i.ns.b(),i.ns.is("vertical",i.vertical)])},[Q("div",{ref:"bar",class:N(i.ns.e("bar")),style:pt({background:i.background}),onClick:e[0]||(e[0]=(...a)=>i.handleClick&&i.handleClick(...a))},null,6),Q("div",{ref:"thumb",class:N(i.ns.e("thumb")),style:pt({left:i.thumbLeft+"px",top:i.thumbTop+"px"})},null,6)],2)}var s6e=qe(n6e,[["render",r6e],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/alpha-slider.vue"]]);const a6e=de({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(i){const e=Ne("color-hue-slider"),t=ti(),n=W(),r=W(),s=W(0),a=W(0),o=R(()=>i.color.get("hue"));Ve(()=>o.value,()=>{h()});function l(p){p.target!==n.value&&c(p)}function c(p){if(!r.value||!n.value)return;const g=t.vnode.el.getBoundingClientRect(),{clientX:_,clientY:b}=t9(p);let x;if(i.vertical){let w=b-g.top;w=Math.min(w,g.height-n.value.offsetHeight/2),w=Math.max(n.value.offsetHeight/2,w),x=Math.round((w-n.value.offsetHeight/2)/(g.height-n.value.offsetHeight)*360)}else{let w=_-g.left;w=Math.min(w,g.width-n.value.offsetWidth/2),w=Math.max(n.value.offsetWidth/2,w),x=Math.round((w-n.value.offsetWidth/2)/(g.width-n.value.offsetWidth)*360)}i.color.set("hue",x)}function u(){if(!n.value)return 0;const p=t.vnode.el;if(i.vertical)return 0;const m=i.color.get("hue");return p?Math.round(m*(p.offsetWidth-n.value.offsetWidth/2)/360):0}function d(){if(!n.value)return 0;const p=t.vnode.el;if(!i.vertical)return 0;const m=i.color.get("hue");return p?Math.round(m*(p.offsetHeight-n.value.offsetHeight/2)/360):0}function h(){s.value=u(),a.value=d()}return qt(()=>{if(!r.value||!n.value)return;const p={drag:m=>{c(m)},end:m=>{c(m)}};X2(r.value,p),X2(n.value,p),h()}),{bar:r,thumb:n,thumbLeft:s,thumbTop:a,hueValue:o,handleClick:l,update:h,ns:e}}});function o6e(i,e,t,n,r,s){return I(),Z("div",{class:N([i.ns.b(),i.ns.is("vertical",i.vertical)])},[Q("div",{ref:"bar",class:N(i.ns.e("bar")),onClick:e[0]||(e[0]=(...a)=>i.handleClick&&i.handleClick(...a))},null,2),Q("div",{ref:"thumb",class:N(i.ns.e("thumb")),style:pt({left:i.thumbLeft+"px",top:i.thumbTop+"px"})},null,6)],2)}var l6e=qe(a6e,[["render",o6e],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/hue-slider.vue"]]);const c6e=Ke({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Ql,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},predefine:{type:xe(Array)},validateEvent:{type:Boolean,default:!0}}),u6e={[ri]:i=>Ft(i)||so(i),[rr]:i=>Ft(i)||so(i),activeChange:i=>Ft(i)||so(i)},vle=Symbol("colorPickerContextKey"),Yq=function(i,e,t){return[i,e*t/((i=(2-e)*t)<1?i:2-i)||0,i/2]},d6e=function(i){return typeof i=="string"&&i.includes(".")&&Number.parseFloat(i)===1},h6e=function(i){return typeof i=="string"&&i.includes("%")},yx=function(i,e){d6e(i)&&(i="100%");const t=h6e(i);return i=Math.min(e,Math.max(0,Number.parseFloat(`${i}`))),t&&(i=Number.parseInt(`${i*e}`,10)/100),Math.abs(i-e)<1e-6?1:i%e/Number.parseFloat(e)},Xq={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},TR=i=>{i=Math.min(Math.round(i),255);const e=Math.floor(i/16),t=i%16;return`${Xq[e]||e}${Xq[t]||t}`},Zq=function({r:i,g:e,b:t}){return Number.isNaN(+i)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${TR(i)}${TR(e)}${TR(t)}`},Mk={A:10,B:11,C:12,D:13,E:14,F:15},Zy=function(i){return i.length===2?(Mk[i[0].toUpperCase()]||+i[0])*16+(Mk[i[1].toUpperCase()]||+i[1]):Mk[i[1].toUpperCase()]||+i[1]},p6e=function(i,e,t){e=e/100,t=t/100;let n=e;const r=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,n*=r<=1?r:2-r;const s=(t+e)/2,a=t===0?2*n/(r+n):2*e/(t+e);return{h:i,s:a*100,v:s*100}},Qq=(i,e,t)=>{i=yx(i,255),e=yx(e,255),t=yx(t,255);const n=Math.max(i,e,t),r=Math.min(i,e,t);let s;const a=n,o=n-r,l=n===0?0:o/n;if(n===r)s=0;else{switch(n){case i:{s=(e-t)/o+(e<t?6:0);break}case e:{s=(t-i)/o+2;break}case t:{s=(i-e)/o+4;break}}s/=6}return{h:s*360,s:l*100,v:a*100}},gT=function(i,e,t){i=yx(i,360)*6,e=yx(e,100),t=yx(t,100);const n=Math.floor(i),r=i-n,s=t*(1-e),a=t*(1-r*e),o=t*(1-(1-r)*e),l=n%6,c=[t,a,s,s,o,t][l],u=[o,t,t,a,s,s][l],d=[s,s,o,t,t,a][l];return{r:Math.round(c*255),g:Math.round(u*255),b:Math.round(d*255)}};class gE{constructor(e={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const t in e)Ci(e,t)&&(this[t]=e[t]);e.value?this.fromString(e.value):this.doOnChange()}set(e,t){if(arguments.length===1&&typeof e=="object"){for(const n in e)Ci(e,n)&&this.set(n,e[n]);return}this[`_${e}`]=t,this.doOnChange()}get(e){return e==="alpha"?Math.floor(this[`_${e}`]):this[`_${e}`]}toRgb(){return gT(this._hue,this._saturation,this._value)}fromString(e){if(!e){this._hue=0,this._saturation=100,this._value=100,this.doOnChange();return}const t=(n,r,s)=>{this._hue=Math.max(0,Math.min(360,n)),this._saturation=Math.max(0,Math.min(100,r)),this._value=Math.max(0,Math.min(100,s)),this.doOnChange()};if(e.includes("hsl")){const n=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(r=>r!=="").map((r,s)=>s>2?Number.parseFloat(r):Number.parseInt(r,10));if(n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3){const{h:r,s,v:a}=p6e(n[0],n[1],n[2]);t(r,s,a)}}else if(e.includes("hsv")){const n=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(r=>r!=="").map((r,s)=>s>2?Number.parseFloat(r):Number.parseInt(r,10));n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3&&t(n[0],n[1],n[2])}else if(e.includes("rgb")){const n=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(r=>r!=="").map((r,s)=>s>2?Number.parseFloat(r):Number.parseInt(r,10));if(n.length===4?this._alpha=Number.parseFloat(n[3])*100:n.length===3&&(this._alpha=100),n.length>=3){const{h:r,s,v:a}=Qq(n[0],n[1],n[2]);t(r,s,a)}}else if(e.includes("#")){const n=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(n))return;let r,s,a;n.length===3?(r=Zy(n[0]+n[0]),s=Zy(n[1]+n[1]),a=Zy(n[2]+n[2])):(n.length===6||n.length===8)&&(r=Zy(n.slice(0,2)),s=Zy(n.slice(2,4)),a=Zy(n.slice(4,6))),n.length===8?this._alpha=Zy(n.slice(6))/255*100:(n.length===3||n.length===6)&&(this._alpha=100);const{h:o,s:l,v:c}=Qq(r,s,a);t(o,l,c)}}compare(e){return Math.abs(e._hue-this._hue)<2&&Math.abs(e._saturation-this._saturation)<1&&Math.abs(e._value-this._value)<1&&Math.abs(e._alpha-this._alpha)<1}doOnChange(){const{_hue:e,_saturation:t,_value:n,_alpha:r,format:s}=this;if(this.enableAlpha)switch(s){case"hsl":{const a=Yq(e,t/100,n/100);this.value=`hsla(${e}, ${Math.round(a[1]*100)}%, ${Math.round(a[2]*100)}%, ${this.get("alpha")/100})`;break}case"hsv":{this.value=`hsva(${e}, ${Math.round(t)}%, ${Math.round(n)}%, ${this.get("alpha")/100})`;break}case"hex":{this.value=`${Zq(gT(e,t,n))}${TR(r*255/100)}`;break}default:{const{r:a,g:o,b:l}=gT(e,t,n);this.value=`rgba(${a}, ${o}, ${l}, ${this.get("alpha")/100})`}}else switch(s){case"hsl":{const a=Yq(e,t/100,n/100);this.value=`hsl(${e}, ${Math.round(a[1]*100)}%, ${Math.round(a[2]*100)}%)`;break}case"hsv":{this.value=`hsv(${e}, ${Math.round(t)}%, ${Math.round(n)}%)`;break}case"rgb":{const{r:a,g:o,b:l}=gT(e,t,n);this.value=`rgb(${a}, ${o}, ${l})`;break}default:this.value=Zq(gT(e,t,n))}}}const f6e=de({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0}},setup(i){const e=Ne("color-predefine"),{currentColor:t}=ht(vle),n=W(s(i.colors,i.color));Ve(()=>t.value,a=>{const o=new gE;o.fromString(a),n.value.forEach(l=>{l.selected=o.compare(l)})}),Ru(()=>{n.value=s(i.colors,i.color)});function r(a){i.color.fromString(i.colors[a])}function s(a,o){return a.map(l=>{const c=new gE;return c.enableAlpha=!0,c.format="rgba",c.fromString(l),c.selected=c.value===o.value,c})}return{rgbaColors:n,handleSelect:r,ns:e}}}),m6e=["onClick"];function g6e(i,e,t,n,r,s){return I(),Z("div",{class:N(i.ns.b())},[Q("div",{class:N(i.ns.e("colors"))},[(I(!0),Z(gt,null,xi(i.rgbaColors,(a,o)=>(I(),Z("div",{key:i.colors[o],class:N([i.ns.e("color-selector"),i.ns.is("alpha",a._alpha<100),{selected:a.selected}]),onClick:l=>i.handleSelect(o)},[Q("div",{style:pt({backgroundColor:a.value})},null,4)],10,m6e))),128))],2)],2)}var v6e=qe(f6e,[["render",g6e],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/predefine.vue"]]);const y6e=de({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(i){const e=Ne("color-svpanel"),t=ti(),n=W(0),r=W(0),s=W("hsl(0, 100%, 50%)"),a=R(()=>{const c=i.color.get("hue"),u=i.color.get("value");return{hue:c,value:u}});function o(){const c=i.color.get("saturation"),u=i.color.get("value"),d=t.vnode.el,{clientWidth:h,clientHeight:p}=d;r.value=c*h/100,n.value=(100-u)*p/100,s.value=`hsl(${i.color.get("hue")}, 100%, 50%)`}function l(c){const d=t.vnode.el.getBoundingClientRect(),{clientX:h,clientY:p}=t9(c);let m=h-d.left,g=p-d.top;m=Math.max(0,m),m=Math.min(m,d.width),g=Math.max(0,g),g=Math.min(g,d.height),r.value=m,n.value=g,i.color.set({saturation:m/d.width*100,value:100-g/d.height*100})}return Ve(()=>a.value,()=>{o()}),qt(()=>{X2(t.vnode.el,{drag:c=>{l(c)},end:c=>{l(c)}}),o()}),{cursorTop:n,cursorLeft:r,background:s,colorValue:a,handleDrag:l,update:o,ns:e}}}),_6e=Q("div",null,null,-1),b6e=[_6e];function w6e(i,e,t,n,r,s){return I(),Z("div",{class:N(i.ns.b()),style:pt({backgroundColor:i.background})},[Q("div",{class:N(i.ns.e("white"))},null,2),Q("div",{class:N(i.ns.e("black"))},null,2),Q("div",{class:N(i.ns.e("cursor")),style:pt({top:i.cursorTop+"px",left:i.cursorLeft+"px"})},b6e,6)],6)}var x6e=qe(y6e,[["render",w6e],["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/components/sv-panel.vue"]]);const C6e=["id","aria-label","aria-labelledby","aria-description","tabindex","onKeydown"],T6e=de({name:"ElColorPicker"}),S6e=de({...T6e,props:c6e,emits:u6e,setup(i,{expose:e,emit:t}){const n=i,{t:r}=Ki(),s=Ne("color"),{formItem:a}=nc(),o=Qs(),l=zc(),{inputId:c,isLabeledByFormItem:u}=By(n,{formItemContext:a}),d=W(),h=W(),p=W(),m=W();let g=!0;const _=Ji(new gE({enableAlpha:n.showAlpha,format:n.colorFormat||"",value:n.modelValue})),b=W(!1),x=W(!1),w=W(""),C=R(()=>!n.modelValue&&!x.value?"transparent":O(_,n.showAlpha)),S=R(()=>!n.modelValue&&!x.value?"":_.value),E=R(()=>u.value?void 0:n.label||r("el.colorpicker.defaultLabel")),A=R(()=>u.value?a==null?void 0:a.labelId:void 0),P=R(()=>[s.b("picker"),s.is("disabled",l.value),s.bm("picker",o.value)]);function O($,F){if(!($ instanceof gE))throw new TypeError("color should be instance of _color Class");const{r:Y,g:ne,b:X}=$.toRgb();return F?`rgba(${Y}, ${ne}, ${X}, ${$.get("alpha")/100})`:`rgb(${Y}, ${ne}, ${X})`}function M($){b.value=$}const V=Zl(M,100);function L(){V(!1),U()}function U(){ut(()=>{n.modelValue?_.fromString(n.modelValue):(_.value="",ut(()=>{x.value=!1}))})}function G(){l.value||V(!b.value)}function H(){_.fromString(w.value)}function k(){const $=_.value;t(ri,$),t("change",$),n.validateEvent&&(a==null||a.validate("change").catch(F=>void 0)),V(!1),ut(()=>{const F=new gE({enableAlpha:n.showAlpha,format:n.colorFormat||"",value:n.modelValue});_.compare(F)||U()})}function D(){V(!1),t(ri,null),t("change",null),n.modelValue!==null&&n.validateEvent&&(a==null||a.validate("change").catch($=>void 0)),U()}return qt(()=>{n.modelValue&&(w.value=S.value)}),Ve(()=>n.modelValue,$=>{$?$&&$!==_.value&&(g=!1,_.fromString($)):x.value=!1}),Ve(()=>S.value,$=>{w.value=$,g&&t("activeChange",$),g=!0}),Ve(()=>_.value,()=>{!n.modelValue&&!x.value&&(x.value=!0)}),Ve(()=>b.value,()=>{ut(()=>{var $,F,Y;($=d.value)==null||$.update(),(F=h.value)==null||F.update(),(Y=p.value)==null||Y.update()})}),pi(vle,{currentColor:S}),e({color:_}),($,F)=>(I(),Se(v(Jl),{ref_key:"popper",ref:m,visible:b.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[v(s).be("picker","panel"),v(s).b("dropdown"),$.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",transition:`${v(s).namespace.value}-zoom-in-top`,persistent:""},{content:pe(()=>[zt((I(),Z("div",null,[Q("div",{class:N(v(s).be("dropdown","main-wrapper"))},[re(l6e,{ref_key:"hue",ref:d,class:"hue-slider",color:v(_),vertical:""},null,8,["color"]),re(x6e,{ref:"svPanel",color:v(_)},null,8,["color"])],2),$.showAlpha?(I(),Se(s6e,{key:0,ref_key:"alpha",ref:p,color:v(_)},null,8,["color"])):_e("v-if",!0),$.predefine?(I(),Se(v6e,{key:1,ref:"predefine",color:v(_),colors:$.predefine},null,8,["color","colors"])):_e("v-if",!0),Q("div",{class:N(v(s).be("dropdown","btns"))},[Q("span",{class:N(v(s).be("dropdown","value"))},[re(v(ol),{modelValue:w.value,"onUpdate:modelValue":F[0]||(F[0]=Y=>w.value=Y),"validate-event":!1,size:"small",onKeyup:Di(H,["enter"]),onBlur:H},null,8,["modelValue","onKeyup"])],2),re(v(Bo),{class:N(v(s).be("dropdown","link-btn")),text:"",size:"small",onClick:D},{default:pe(()=>[Gi(We(v(r)("el.colorpicker.clear")),1)]),_:1},8,["class"]),re(v(Bo),{plain:"",size:"small",class:N(v(s).be("dropdown","btn")),onClick:k},{default:pe(()=>[Gi(We(v(r)("el.colorpicker.confirm")),1)]),_:1},8,["class"])],2)])),[[v(My),L]])]),default:pe(()=>[Q("div",{id:v(c),class:N(v(P)),role:"button","aria-label":v(E),"aria-labelledby":v(A),"aria-description":v(r)("el.colorpicker.description",{color:$.modelValue||""}),tabindex:$.tabindex,onKeydown:Di(G,["enter"])},[v(l)?(I(),Z("div",{key:0,class:N(v(s).be("picker","mask"))},null,2)):_e("v-if",!0),Q("div",{class:N(v(s).be("picker","trigger")),onClick:G},[Q("span",{class:N([v(s).be("picker","color"),v(s).is("alpha",$.showAlpha)])},[Q("span",{class:N(v(s).be("picker","color-inner")),style:pt({backgroundColor:v(C)})},[zt(re(v(ct),{class:N([v(s).be("picker","icon"),v(s).is("icon-arrow-down")])},{default:pe(()=>[re(v(Fy))]),_:1},8,["class"]),[[Ei,$.modelValue||x.value]]),!$.modelValue&&!x.value?(I(),Se(v(ct),{key:0,class:N([v(s).be("picker","empty"),v(s).is("icon-close")])},{default:pe(()=>[re(v(Rh))]),_:1},8,["class"])):_e("v-if",!0)],6)],2)],2)],42,C6e)]),_:1},8,["visible","popper-class","transition"]))}});var E6e=qe(S6e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/color-picker/src/color-picker.vue"]]);const A6e=ii(E6e),Z5={},M6e=Ke({a11y:{type:Boolean,default:!0},locale:{type:xe(Object)},size:Ql,button:{type:xe(Object)},experimentalFeatures:{type:xe(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:xe(Object)},zIndex:Number,namespace:{type:String,default:"el"}}),P6e=de({name:"ElConfigProvider",props:M6e,setup(i,{slots:e}){Ve(()=>i.message,n=>{Object.assign(Z5,n??{})},{immediate:!0,deep:!0});const t=Gae(i);return()=>Fe(e,"default",{config:t==null?void 0:t.value})}}),O6e=ii(P6e),R6e=de({name:"ElContainer"}),I6e=de({...R6e,props:{direction:{type:String}},setup(i){const e=i,t=uo(),n=Ne("container"),r=R(()=>e.direction==="vertical"?!0:e.direction==="horizontal"?!1:t&&t.default?t.default().some(a=>{const o=a.type.name;return o==="ElHeader"||o==="ElFooter"}):!1);return(s,a)=>(I(),Z("section",{class:N([v(n).b(),v(n).is("vertical",v(r))])},[Fe(s.$slots,"default")],2))}});var $6e=qe(I6e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/container.vue"]]);const L6e=de({name:"ElAside"}),D6e=de({...L6e,props:{width:{type:String,default:null}},setup(i){const e=i,t=Ne("aside"),n=R(()=>e.width?t.cssVarBlock({width:e.width}):{});return(r,s)=>(I(),Z("aside",{class:N(v(t).b()),style:pt(v(n))},[Fe(r.$slots,"default")],6))}});var yle=qe(D6e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/aside.vue"]]);const k6e=de({name:"ElFooter"}),F6e=de({...k6e,props:{height:{type:String,default:null}},setup(i){const e=i,t=Ne("footer"),n=R(()=>e.height?t.cssVarBlock({height:e.height}):{});return(r,s)=>(I(),Z("footer",{class:N(v(t).b()),style:pt(v(n))},[Fe(r.$slots,"default")],6))}});var _le=qe(F6e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/footer.vue"]]);const N6e=de({name:"ElHeader"}),V6e=de({...N6e,props:{height:{type:String,default:null}},setup(i){const e=i,t=Ne("header"),n=R(()=>e.height?t.cssVarBlock({height:e.height}):{});return(r,s)=>(I(),Z("header",{class:N(v(t).b()),style:pt(v(n))},[Fe(r.$slots,"default")],6))}});var ble=qe(V6e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/header.vue"]]);const B6e=de({name:"ElMain"}),z6e=de({...B6e,setup(i){const e=Ne("main");return(t,n)=>(I(),Z("main",{class:N(v(e).b())},[Fe(t.$slots,"default")],2))}});var wle=qe(z6e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/container/src/main.vue"]]);const U6e=ii($6e,{Aside:yle,Footer:_le,Header:ble,Main:wle}),H6e=Wr(yle),G6e=Wr(_le),W6e=Wr(ble),j6e=Wr(wle);var Q5={},q6e={get exports(){return Q5},set exports(i){Q5=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){return function(t,n){var r=n.prototype,s=r.format;r.format=function(a){var o=this,l=this.$locale();if(!this.isValid())return s.bind(this)(a);var c=this.$utils(),u=(a||"YYYY-MM-DDTHH:mm:ssZ").replace(/\[([^\]]+)]|Q|wo|ww|w|WW|W|zzz|z|gggg|GGGG|Do|X|x|k{1,2}|S/g,function(d){switch(d){case"Q":return Math.ceil((o.$M+1)/3);case"Do":return l.ordinal(o.$D);case"gggg":return o.weekYear();case"GGGG":return o.isoWeekYear();case"wo":return l.ordinal(o.week(),"W");case"w":case"ww":return c.s(o.week(),d==="w"?1:2,"0");case"W":case"WW":return c.s(o.isoWeek(),d==="W"?1:2,"0");case"k":case"kk":return c.s(String(o.$H===0?24:o.$H),d==="k"?1:2,"0");case"X":return Math.floor(o.$d.getTime()/1e3);case"x":return o.$d.getTime();case"z":return"["+o.offsetName()+"]";case"zzz":return"["+o.offsetName("long")+"]";default:return d}});return s.bind(this)(u)}}})})(q6e);const K6e=Q5;var J5={},Y6e={get exports(){return J5},set exports(i){J5=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){var t="week",n="year";return function(r,s,a){var o=s.prototype;o.week=function(l){if(l===void 0&&(l=null),l!==null)return this.add(7*(l-this.week()),"day");var c=this.$locale().yearStart||1;if(this.month()===11&&this.date()>25){var u=a(this).startOf(n).add(1,n).date(c),d=a(this).endOf(t);if(u.isBefore(d))return 1}var h=a(this).startOf(n).date(c).startOf(t).subtract(1,"millisecond"),p=this.diff(h,t,!0);return p<0?a(this).startOf("week").week():Math.ceil(p)},o.weeks=function(l){return l===void 0&&(l=null),this.week(l)}}})})(Y6e);const X6e=J5;var eV={},Z6e={get exports(){return eV},set exports(i){eV=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){return function(t,n){n.prototype.weekYear=function(){var r=this.month(),s=this.week(),a=this.year();return s===1&&r===11?a+1:r===0&&s>=52?a-1:a}}})})(Z6e);const Q6e=eV;var tV={},J6e={get exports(){return tV},set exports(i){tV=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){return function(t,n,r){n.prototype.dayOfYear=function(s){var a=Math.round((r(this).startOf("day")-r(this).startOf("year"))/864e5)+1;return s==null?a:this.add(s-a,"day")}}})})(J6e);const e8e=tV;var iV={},t8e={get exports(){return iV},set exports(i){iV=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){return function(t,n){n.prototype.isSameOrAfter=function(r,s){return this.isSame(r,s)||this.isAfter(r,s)}}})})(t8e);const i8e=iV;var nV={},n8e={get exports(){return nV},set exports(i){nV=i}};(function(i,e){(function(t,n){i.exports=n()})(bg,function(){return function(t,n){n.prototype.isSameOrBefore=function(r,s){return this.isSame(r,s)||this.isBefore(r,s)}}})})(n8e);const r8e=nV,s8e=Ke({type:{type:xe(String),default:"date"}}),a8e=["date","dates","year","month","week","range"],I9=Ke({disabledDate:{type:xe(Function)},date:{type:xe(Object),required:!0},minDate:{type:xe(Object)},maxDate:{type:xe(Object)},parsedValue:{type:xe([Object,Array])},rangeState:{type:xe(Object),default:()=>({endDate:null,selecting:!1})}}),xle=Ke({type:{type:xe(String),required:!0,values:t3e}}),Cle=Ke({unlinkPanels:Boolean,parsedValue:{type:xe(Array)}}),Tle=i=>({type:String,values:a8e,default:i}),o8e=Ke({...xle,parsedValue:{type:xe([Object,Array])},visible:{type:Boolean},format:{type:String,default:""}}),l8e=Ke({...I9,cellClassName:{type:xe(Function)},showWeekNumber:Boolean,selectionMode:Tle("date")}),rV=i=>{if(!st(i))return!1;const[e,t]=i;return Yt.isDayjs(e)&&Yt.isDayjs(t)&&e.isSameOrBefore(t)},Sle=(i,{lang:e,unit:t,unlinkPanels:n})=>{let r;if(st(i)){let[s,a]=i.map(o=>Yt(o).locale(e));return n||(a=s.add(1,t)),[s,a]}else i?r=Yt(i):r=Yt();return r=r.locale(e),[r,r.add(1,t)]},c8e=(i,e,{columnIndexOffset:t,startDate:n,nextEndDate:r,now:s,unit:a,relativeDateGetter:o,setCellMetadata:l,setRowMetadata:c})=>{for(let u=0;u<i.row;u++){const d=e[u];for(let h=0;h<i.column;h++){let p=d[h+t];p||(p={row:u,column:h,type:"normal",inRange:!1,start:!1,end:!1});const m=u*i.column+h,g=o(m);p.dayjs=g,p.date=g.toDate(),p.timestamp=g.valueOf(),p.type="normal",p.inRange=!!(n&&g.isSameOrAfter(n,a)&&r&&g.isSameOrBefore(r,a))||!!(n&&g.isSameOrBefore(n,a)&&r&&g.isSameOrAfter(r,a)),n!=null&&n.isSameOrAfter(r)?(p.start=!!r&&g.isSame(r,a),p.end=n&&g.isSame(n,a)):(p.start=!!n&&g.isSame(n,a),p.end=!!r&&g.isSame(r,a)),g.isSame(s,a)&&(p.type="today"),l==null||l(p,{rowIndex:u,columnIndex:h}),d[h+t]=p}c==null||c(d)}},u8e=Ke({cell:{type:xe(Object)}});var d8e=de({name:"ElDatePickerCell",props:u8e,setup(i){const e=Ne("date-table-cell"),{slots:t}=ht(u9);return()=>{const{cell:n}=i;if(t.default){const r=t.default(n).filter(s=>s.patchFlag!==-2&&s.type.toString()!=="Symbol(Comment)");if(r.length)return r}return re("div",{class:e.b()},[re("span",{class:e.e("text")},[n==null?void 0:n.text])])}}});const h8e=["aria-label","onMousedown"],p8e={key:0,scope:"col"},f8e=["aria-label"],m8e=["aria-current","aria-selected","tabindex"],g8e=de({__name:"basic-date-table",props:l8e,emits:["changerange","pick","select"],setup(i,{expose:e,emit:t}){const n=i,r=Ne("date-table"),{t:s,lang:a}=Ki(),o=W(),l=W(),c=W(),u=W(),d=W([[],[],[],[],[],[]]);let h=!1;const p=n.date.$locale().weekStart||7,m=n.date.locale("en").localeData().weekdaysShort().map(X=>X.toLowerCase()),g=R(()=>p>3?7-p:-p),_=R(()=>{const X=n.date.startOf("month");return X.subtract(X.day()||7,"day")}),b=R(()=>m.concat(m).slice(p,p+7)),x=R(()=>Use(P.value).some(X=>X.isCurrent)),w=R(()=>{const X=n.date.startOf("month"),J=X.day()||7,he=X.daysInMonth(),ye=X.subtract(1,"month").daysInMonth();return{startOfMonthDay:J,dateCountOfMonth:he,dateCountOfLastMonth:ye}}),C=R(()=>n.selectionMode==="dates"?Rm(n.parsedValue):[]),S=(X,{count:J,rowIndex:he,columnIndex:ye})=>{const{startOfMonthDay:Te,dateCountOfMonth:ce,dateCountOfLastMonth:ae}=v(w),le=v(g);if(he>=0&&he<=1){const fe=Te+le<0?7+Te+le:Te+le;if(ye+he*7>=fe)return X.text=J,!0;X.text=ae-(fe-ye%7)+1+he*7,X.type="prev-month"}else return J<=ce?X.text=J:(X.text=J-ce,X.type="next-month"),!0;return!1},E=(X,{columnIndex:J,rowIndex:he},ye)=>{const{disabledDate:Te,cellClassName:ce}=n,ae=v(C),le=S(X,{count:ye,rowIndex:he,columnIndex:J}),fe=X.dayjs.toDate();return X.selected=ae.find(Ue=>Ue.valueOf()===X.dayjs.valueOf()),X.isSelected=!!X.selected,X.isCurrent=V(X),X.disabled=Te==null?void 0:Te(fe),X.customClass=ce==null?void 0:ce(fe),le},A=X=>{if(n.selectionMode==="week"){const[J,he]=n.showWeekNumber?[1,7]:[0,6],ye=ne(X[J+1]);X[J].inRange=ye,X[J].start=ye,X[he].inRange=ye,X[he].end=ye}},P=R(()=>{const{minDate:X,maxDate:J,rangeState:he,showWeekNumber:ye}=n,Te=g.value,ce=d.value,ae="day";let le=1;if(ye)for(let fe=0;fe<6;fe++)ce[fe][0]||(ce[fe][0]={type:"week",text:_.value.add(fe*7+1,ae).week()});return c8e({row:6,column:7},ce,{startDate:X,columnIndexOffset:ye?1:0,nextEndDate:he.endDate||J||he.selecting&&X||null,now:Yt().locale(v(a)).startOf(ae),unit:ae,relativeDateGetter:fe=>_.value.add(fe-Te,ae),setCellMetadata:(...fe)=>{E(...fe,le)&&(le+=1)},setRowMetadata:A}),ce});Ve(()=>n.date,async()=>{var X,J;(X=o.value)!=null&&X.contains(document.activeElement)&&(await ut(),(J=l.value)==null||J.focus())});const O=async()=>{var X;(X=l.value)==null||X.focus()},M=(X="")=>["normal","today"].includes(X),V=X=>n.selectionMode==="date"&&M(X.type)&&L(X,n.parsedValue),L=(X,J)=>J?Yt(J).locale(a.value).isSame(n.date.date(Number(X.text)),"day"):!1,U=X=>{const J=[];return M(X.type)&&!X.disabled?(J.push("available"),X.type==="today"&&J.push("today")):J.push(X.type),V(X)&&J.push("current"),X.inRange&&(M(X.type)||n.selectionMode==="week")&&(J.push("in-range"),X.start&&J.push("start-date"),X.end&&J.push("end-date")),X.disabled&&J.push("disabled"),X.selected&&J.push("selected"),X.customClass&&J.push(X.customClass),J.join(" ")},G=(X,J)=>{const he=X*7+(J-(n.showWeekNumber?1:0))-g.value;return _.value.add(he,"day")},H=X=>{var J;if(!n.rangeState.selecting)return;let he=X.target;if(he.tagName==="SPAN"&&(he=(J=he.parentNode)==null?void 0:J.parentNode),he.tagName==="DIV"&&(he=he.parentNode),he.tagName!=="TD")return;const ye=he.parentNode.rowIndex-1,Te=he.cellIndex;P.value[ye][Te].disabled||(ye!==c.value||Te!==u.value)&&(c.value=ye,u.value=Te,t("changerange",{selecting:!0,endDate:G(ye,Te)}))},k=X=>!x.value&&(X==null?void 0:X.text)===1&&X.type==="normal"||X.isCurrent,D=X=>{h||x.value||n.selectionMode!=="date"||Y(X,!0)},$=X=>{X.target.closest("td")&&(h=!0)},F=X=>{X.target.closest("td")&&(h=!1)},Y=(X,J=!1)=>{const he=X.target.closest("td");if(!he)return;const ye=he.parentNode.rowIndex-1,Te=he.cellIndex,ce=P.value[ye][Te];if(ce.disabled||ce.type==="week")return;const ae=G(ye,Te);if(n.selectionMode==="range")!n.rangeState.selecting||!n.minDate?(t("pick",{minDate:ae,maxDate:null}),t("select",!0)):(ae>=n.minDate?t("pick",{minDate:n.minDate,maxDate:ae}):t("pick",{minDate:ae,maxDate:n.minDate}),t("select",!1));else if(n.selectionMode==="date")t("pick",ae,J);else if(n.selectionMode==="week"){const le=ae.week(),fe=`${ae.year()}w${le}`;t("pick",{year:ae.year(),week:le,value:fe,date:ae.startOf("week")})}else if(n.selectionMode==="dates"){const le=ce.selected?Rm(n.parsedValue).filter(fe=>(fe==null?void 0:fe.valueOf())!==ae.valueOf()):Rm(n.parsedValue).concat([ae]);t("pick",le)}},ne=X=>{if(n.selectionMode!=="week")return!1;let J=n.date.startOf("day");if(X.type==="prev-month"&&(J=J.subtract(1,"month")),X.type==="next-month"&&(J=J.add(1,"month")),J=J.date(Number.parseInt(X.text,10)),n.parsedValue&&!Array.isArray(n.parsedValue)){const he=(n.parsedValue.day()-p+7)%7-1;return n.parsedValue.subtract(he,"day").isSame(J,"day")}return!1};return e({focus:O}),(X,J)=>(I(),Z("table",{role:"grid","aria-label":v(s)("el.datepicker.dateTablePrompt"),cellspacing:"0",cellpadding:"0",class:N([v(r).b(),{"is-week-mode":X.selectionMode==="week"}]),onClick:Y,onMousemove:H,onMousedown:Dt($,["prevent"]),onMouseup:F},[Q("tbody",{ref_key:"tbodyRef",ref:o},[Q("tr",null,[X.showWeekNumber?(I(),Z("th",p8e,We(v(s)("el.datepicker.week")),1)):_e("v-if",!0),(I(!0),Z(gt,null,xi(v(b),(he,ye)=>(I(),Z("th",{key:ye,scope:"col","aria-label":v(s)("el.datepicker.weeksFull."+he)},We(v(s)("el.datepicker.weeks."+he)),9,f8e))),128))]),(I(!0),Z(gt,null,xi(v(P),(he,ye)=>(I(),Z("tr",{key:ye,class:N([v(r).e("row"),{current:ne(he[1])}])},[(I(!0),Z(gt,null,xi(he,(Te,ce)=>(I(),Z("td",{key:`${ye}.${ce}`,ref_for:!0,ref:ae=>k(Te)&&(l.value=ae),class:N(U(Te)),"aria-current":Te.isCurrent?"date":void 0,"aria-selected":Te.isCurrent,tabindex:k(Te)?0:-1,onFocus:D},[re(v(d8e),{cell:Te},null,8,["cell"])],42,m8e))),128))],2))),128))],512)],42,h8e))}});var sV=qe(g8e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-date-table.vue"]]);const v8e=Ke({...I9,selectionMode:Tle("month")}),y8e=["aria-label"],_8e=["aria-selected","aria-label","tabindex","onKeydown"],b8e={class:"cell"},w8e=de({__name:"basic-month-table",props:v8e,emits:["changerange","pick","select"],setup(i,{expose:e,emit:t}){const n=i,r=(C,S,E)=>{const A=Yt().locale(E).startOf("month").month(S).year(C),P=A.daysInMonth();return ly(P).map(O=>A.add(O,"day").toDate())},s=Ne("month-table"),{t:a,lang:o}=Ki(),l=W(),c=W(),u=W(n.date.locale("en").localeData().monthsShort().map(C=>C.toLowerCase())),d=W([[],[],[]]),h=W(),p=W(),m=R(()=>{var C,S;const E=d.value,A=Yt().locale(o.value).startOf("month");for(let P=0;P<3;P++){const O=E[P];for(let M=0;M<4;M++){const V=O[M]||(O[M]={row:P,column:M,type:"normal",inRange:!1,start:!1,end:!1,text:-1,disabled:!1});V.type="normal";const L=P*4+M,U=n.date.startOf("year").month(L),G=n.rangeState.endDate||n.maxDate||n.rangeState.selecting&&n.minDate||null;V.inRange=!!(n.minDate&&U.isSameOrAfter(n.minDate,"month")&&G&&U.isSameOrBefore(G,"month"))||!!(n.minDate&&U.isSameOrBefore(n.minDate,"month")&&G&&U.isSameOrAfter(G,"month")),(C=n.minDate)!=null&&C.isSameOrAfter(G)?(V.start=!!(G&&U.isSame(G,"month")),V.end=n.minDate&&U.isSame(n.minDate,"month")):(V.start=!!(n.minDate&&U.isSame(n.minDate,"month")),V.end=!!(G&&U.isSame(G,"month"))),A.isSame(U)&&(V.type="today"),V.text=L,V.disabled=((S=n.disabledDate)==null?void 0:S.call(n,U.toDate()))||!1}}return E}),g=()=>{var C;(C=c.value)==null||C.focus()},_=C=>{const S={},E=n.date.year(),A=new Date,P=C.text;return S.disabled=n.disabledDate?r(E,P,o.value).every(n.disabledDate):!1,S.current=Rm(n.parsedValue).findIndex(O=>Yt.isDayjs(O)&&O.year()===E&&O.month()===P)>=0,S.today=A.getFullYear()===E&&A.getMonth()===P,C.inRange&&(S["in-range"]=!0,C.start&&(S["start-date"]=!0),C.end&&(S["end-date"]=!0)),S},b=C=>{const S=n.date.year(),E=C.text;return Rm(n.date).findIndex(A=>A.year()===S&&A.month()===E)>=0},x=C=>{var S;if(!n.rangeState.selecting)return;let E=C.target;if(E.tagName==="A"&&(E=(S=E.parentNode)==null?void 0:S.parentNode),E.tagName==="DIV"&&(E=E.parentNode),E.tagName!=="TD")return;const A=E.parentNode.rowIndex,P=E.cellIndex;m.value[A][P].disabled||(A!==h.value||P!==p.value)&&(h.value=A,p.value=P,t("changerange",{selecting:!0,endDate:n.date.startOf("year").month(A*4+P)}))},w=C=>{var S;const E=(S=C.target)==null?void 0:S.closest("td");if((E==null?void 0:E.tagName)!=="TD"||Th(E,"disabled"))return;const A=E.cellIndex,O=E.parentNode.rowIndex*4+A,M=n.date.startOf("year").month(O);n.selectionMode==="range"?n.rangeState.selecting?(n.minDate&&M>=n.minDate?t("pick",{minDate:n.minDate,maxDate:M}):t("pick",{minDate:M,maxDate:n.minDate}),t("select",!1)):(t("pick",{minDate:M,maxDate:null}),t("select",!0)):t("pick",O)};return Ve(()=>n.date,async()=>{var C,S;(C=l.value)!=null&&C.contains(document.activeElement)&&(await ut(),(S=c.value)==null||S.focus())}),e({focus:g}),(C,S)=>(I(),Z("table",{role:"grid","aria-label":v(a)("el.datepicker.monthTablePrompt"),class:N(v(s).b()),onClick:w,onMousemove:x},[Q("tbody",{ref_key:"tbodyRef",ref:l},[(I(!0),Z(gt,null,xi(v(m),(E,A)=>(I(),Z("tr",{key:A},[(I(!0),Z(gt,null,xi(E,(P,O)=>(I(),Z("td",{key:O,ref_for:!0,ref:M=>b(P)&&(c.value=M),class:N(_(P)),"aria-selected":`${b(P)}`,"aria-label":v(a)(`el.datepicker.month${+P.text+1}`),tabindex:b(P)?0:-1,onKeydown:[Di(Dt(w,["prevent","stop"]),["space"]),Di(Dt(w,["prevent","stop"]),["enter"])]},[Q("div",null,[Q("span",b8e,We(v(a)("el.datepicker.months."+u.value[P.text])),1)])],42,_8e))),128))]))),128))],512)],42,y8e))}});var aV=qe(w8e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-month-table.vue"]]);const{date:x8e,disabledDate:C8e,parsedValue:T8e}=I9,S8e=Ke({date:x8e,disabledDate:C8e,parsedValue:T8e}),E8e=["aria-label"],A8e=["aria-selected","tabindex","onKeydown"],M8e={class:"cell"},P8e={key:1},O8e=de({__name:"basic-year-table",props:S8e,emits:["pick"],setup(i,{expose:e,emit:t}){const n=i,r=(g,_)=>{const b=Yt(String(g)).locale(_).startOf("year"),w=b.endOf("year").dayOfYear();return ly(w).map(C=>b.add(C,"day").toDate())},s=Ne("year-table"),{t:a,lang:o}=Ki(),l=W(),c=W(),u=R(()=>Math.floor(n.date.year()/10)*10),d=()=>{var g;(g=c.value)==null||g.focus()},h=g=>{const _={},b=Yt().locale(o.value);return _.disabled=n.disabledDate?r(g,o.value).every(n.disabledDate):!1,_.current=Rm(n.parsedValue).findIndex(x=>x.year()===g)>=0,_.today=b.year()===g,_},p=g=>g===u.value&&n.date.year()<u.value&&n.date.year()>u.value+9||Rm(n.date).findIndex(_=>_.year()===g)>=0,m=g=>{const b=g.target.closest("td");if(b&&b.textContent){if(Th(b,"disabled"))return;const x=b.textContent||b.innerText;t("pick",Number(x))}};return Ve(()=>n.date,async()=>{var g,_;(g=l.value)!=null&&g.contains(document.activeElement)&&(await ut(),(_=c.value)==null||_.focus())}),e({focus:d}),(g,_)=>(I(),Z("table",{role:"grid","aria-label":v(a)("el.datepicker.yearTablePrompt"),class:N(v(s).b()),onClick:m},[Q("tbody",{ref_key:"tbodyRef",ref:l},[(I(),Z(gt,null,xi(3,(b,x)=>Q("tr",{key:x},[(I(),Z(gt,null,xi(4,(w,C)=>(I(),Z(gt,{key:x+"_"+C},[x*4+C<10?(I(),Z("td",{key:0,ref_for:!0,ref:S=>p(v(u)+x*4+C)&&(c.value=S),class:N(["available",h(v(u)+x*4+C)]),"aria-selected":`${p(v(u)+x*4+C)}`,tabindex:p(v(u)+x*4+C)?0:-1,onKeydown:[Di(Dt(m,["prevent","stop"]),["space"]),Di(Dt(m,["prevent","stop"]),["enter"])]},[Q("span",M8e,We(v(u)+x*4+C),1)],42,A8e)):(I(),Z("td",P8e))],64))),64))])),64))],512)],10,E8e))}});var R8e=qe(O8e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/basic-year-table.vue"]]);const I8e=["onClick"],$8e=["aria-label"],L8e=["aria-label"],D8e=["aria-label"],k8e=["aria-label"],F8e=de({__name:"panel-date-pick",props:o8e,emits:["pick","set-picker-option","panel-change"],setup(i,{emit:e}){const t=i,n=(te,me,Ie)=>!0,r=Ne("picker-panel"),s=Ne("date-picker"),a=VC(),o=uo(),{t:l,lang:c}=Ki(),u=ht("EP_PICKER_BASE"),d=ht(L3),{shortcuts:h,disabledDate:p,cellClassName:m,defaultTime:g,arrowControl:_}=u.props,b=kr(u.props,"defaultValue"),x=W(),w=W(Yt().locale(c.value)),C=W(!1),S=R(()=>Yt(g).locale(c.value)),E=R(()=>w.value.month()),A=R(()=>w.value.year()),P=W([]),O=W(null),M=W(null),V=te=>P.value.length>0?n(te,P.value,t.format||"HH:mm:ss"):!0,L=te=>g&&!ie.value&&!C.value?S.value.year(te.year()).month(te.month()).date(te.date()):Te.value?te.millisecond(0):te.startOf("day"),U=(te,...me)=>{if(!te)e("pick",te,...me);else if(st(te)){const Ie=te.map(L);e("pick",Ie,...me)}else e("pick",L(te),...me);O.value=null,M.value=null,C.value=!1},G=(te,me)=>{if(Y.value==="date"){te=te;let Ie=t.parsedValue?t.parsedValue.year(te.year()).month(te.month()).date(te.date()):te;V(Ie)||(Ie=P.value[0][0].year(te.year()).month(te.month()).date(te.date())),w.value=Ie,U(Ie,Te.value||me)}else Y.value==="week"?U(te.date):Y.value==="dates"&&U(te,!0)},H=te=>{const me=te?"add":"subtract";w.value=w.value[me](1,"month"),Qe("month")},k=te=>{const me=w.value,Ie=te?"add":"subtract";w.value=D.value==="year"?me[Ie](10,"year"):me[Ie](1,"year"),Qe("year")},D=W("date"),$=R(()=>{const te=l("el.datepicker.year");if(D.value==="year"){const me=Math.floor(A.value/10)*10;return te?`${me} ${te} - ${me+9} ${te}`:`${me} - ${me+9}`}return`${A.value} ${te}`}),F=te=>{const me=Lt(te.value)?te.value():te.value;if(me){U(Yt(me).locale(c.value));return}te.onClick&&te.onClick({attrs:a,slots:o,emit:e})},Y=R(()=>{const{type:te}=t;return["week","month","year","dates"].includes(te)?te:"date"}),ne=R(()=>Y.value==="date"?D.value:Y.value),X=R(()=>!!h.length),J=async te=>{w.value=w.value.startOf("month").month(te),Y.value==="month"?U(w.value,!1):(D.value="date",["month","year","date","week"].includes(Y.value)&&(U(w.value,!0),await ut(),Xe())),Qe("month")},he=async te=>{Y.value==="year"?(w.value=w.value.startOf("year").year(te),U(w.value,!1)):(w.value=w.value.year(te),D.value="month",["month","year","date","week"].includes(Y.value)&&(U(w.value,!0),await ut(),Xe())),Qe("year")},ye=async te=>{D.value=te,await ut(),Xe()},Te=R(()=>t.type==="datetime"||t.type==="datetimerange"),ce=R(()=>Te.value||Y.value==="dates"),ae=()=>{if(Y.value==="dates")U(t.parsedValue);else{let te=t.parsedValue;if(!te){const me=Yt(g).locale(c.value),Ie=He();te=me.year(Ie.year()).month(Ie.month()).date(Ie.date())}w.value=te,U(te)}},le=()=>{const me=Yt().locale(c.value).toDate();C.value=!0,(!p||!p(me))&&V(me)&&(w.value=Yt().locale(c.value),U(w.value))},fe=R(()=>Voe(t.format)),Ue=R(()=>Noe(t.format)),ie=R(()=>{if(M.value)return M.value;if(!(!t.parsedValue&&!b.value))return(t.parsedValue||w.value).format(fe.value)}),oe=R(()=>{if(O.value)return O.value;if(!(!t.parsedValue&&!b.value))return(t.parsedValue||w.value).format(Ue.value)}),we=W(!1),Ae=()=>{we.value=!0},Oe=()=>{we.value=!1},ve=te=>({hour:te.hour(),minute:te.minute(),second:te.second(),year:te.year(),month:te.month(),date:te.date()}),ke=(te,me,Ie)=>{const{hour:K,minute:se,second:Me}=ve(te),De=t.parsedValue?t.parsedValue.hour(K).minute(se).second(Me):te;w.value=De,U(w.value,!0),Ie||(we.value=me)},be=te=>{const me=Yt(te,fe.value).locale(c.value);if(me.isValid()&&V(me)){const{year:Ie,month:K,date:se}=ve(w.value);w.value=me.year(Ie).month(K).date(se),M.value=null,we.value=!1,U(w.value,!0)}},$e=te=>{const me=Yt(te,Ue.value).locale(c.value);if(me.isValid()){if(p&&p(me.toDate()))return;const{hour:Ie,minute:K,second:se}=ve(w.value);w.value=me.hour(Ie).minute(K).second(se),O.value=null,U(w.value,!0)}},Le=te=>Yt.isDayjs(te)&&te.isValid()&&(p?!p(te.toDate()):!0),Ce=te=>Y.value==="dates"?te.map(me=>me.format(t.format)):te.format(t.format),Be=te=>Yt(te,t.format).locale(c.value),He=()=>{const te=Yt(b.value).locale(c.value);if(!b.value){const me=S.value;return Yt().hour(me.hour()).minute(me.minute()).second(me.second()).locale(c.value)}return te},Xe=async()=>{var te;["week","month","year","date"].includes(Y.value)&&((te=x.value)==null||te.focus(),Y.value==="week"&&it(wt.down))},Je=te=>{const{code:me}=te;[wt.up,wt.down,wt.left,wt.right,wt.home,wt.end,wt.pageUp,wt.pageDown].includes(me)&&(it(me),te.stopPropagation(),te.preventDefault()),[wt.enter,wt.space].includes(me)&&O.value===null&&M.value===null&&(te.preventDefault(),U(w.value,!1))},it=te=>{var me;const{up:Ie,down:K,left:se,right:Me,home:De,end:Tt,pageUp:Zt,pageDown:tn}=wt,vn={year:{[Ie]:-4,[K]:4,[se]:-1,[Me]:1,offset:(di,ze)=>di.setFullYear(di.getFullYear()+ze)},month:{[Ie]:-4,[K]:4,[se]:-1,[Me]:1,offset:(di,ze)=>di.setMonth(di.getMonth()+ze)},week:{[Ie]:-1,[K]:1,[se]:-1,[Me]:1,offset:(di,ze)=>di.setDate(di.getDate()+ze*7)},date:{[Ie]:-7,[K]:7,[se]:-1,[Me]:1,[De]:di=>-di.getDay(),[Tt]:di=>-di.getDay()+6,[Zt]:di=>-new Date(di.getFullYear(),di.getMonth(),0).getDate(),[tn]:di=>new Date(di.getFullYear(),di.getMonth()+1,0).getDate(),offset:(di,ze)=>di.setDate(di.getDate()+ze)}},ui=w.value.toDate();for(;Math.abs(w.value.diff(ui,"year",!0))<1;){const di=vn[ne.value];if(!di)return;if(di.offset(ui,Lt(di[te])?di[te](ui):(me=di[te])!=null?me:0),p&&p(ui))break;const ze=Yt(ui).locale(c.value);w.value=ze,e("pick",ze,!0);break}},Qe=te=>{e("panel-change",w.value.toDate(),te,D.value)};return Ve(()=>Y.value,te=>{if(["month","year"].includes(te)){D.value=te;return}D.value="date"},{immediate:!0}),Ve(()=>D.value,()=>{d==null||d.updatePopper()}),Ve(()=>b.value,te=>{te&&(w.value=He())},{immediate:!0}),Ve(()=>t.parsedValue,te=>{if(te){if(Y.value==="dates"||Array.isArray(te))return;w.value=te}else w.value=He()},{immediate:!0}),e("set-picker-option",["isValidValue",Le]),e("set-picker-option",["formatToString",Ce]),e("set-picker-option",["parseUserInput",Be]),e("set-picker-option",["handleFocusPicker",Xe]),(te,me)=>(I(),Z("div",{class:N([v(r).b(),v(s).b(),{"has-sidebar":te.$slots.sidebar||v(X),"has-time":v(Te)}])},[Q("div",{class:N(v(r).e("body-wrapper"))},[Fe(te.$slots,"sidebar",{class:N(v(r).e("sidebar"))}),v(X)?(I(),Z("div",{key:0,class:N(v(r).e("sidebar"))},[(I(!0),Z(gt,null,xi(v(h),(Ie,K)=>(I(),Z("button",{key:K,type:"button",class:N(v(r).e("shortcut")),onClick:se=>F(Ie)},We(Ie.text),11,I8e))),128))],2)):_e("v-if",!0),Q("div",{class:N(v(r).e("body"))},[v(Te)?(I(),Z("div",{key:0,class:N(v(s).e("time-header"))},[Q("span",{class:N(v(s).e("editor-wrap"))},[re(v(ol),{placeholder:v(l)("el.datepicker.selectDate"),"model-value":v(oe),size:"small","validate-event":!1,onInput:me[0]||(me[0]=Ie=>O.value=Ie),onChange:$e},null,8,["placeholder","model-value"])],2),zt((I(),Z("span",{class:N(v(s).e("editor-wrap"))},[re(v(ol),{placeholder:v(l)("el.datepicker.selectTime"),"model-value":v(ie),size:"small","validate-event":!1,onFocus:Ae,onInput:me[1]||(me[1]=Ie=>M.value=Ie),onChange:be},null,8,["placeholder","model-value"]),re(v(p$),{visible:we.value,format:v(fe),"time-arrow-control":v(_),"parsed-value":w.value,onPick:ke},null,8,["visible","format","time-arrow-control","parsed-value"])],2)),[[v(My),Oe]])],2)):_e("v-if",!0),zt(Q("div",{class:N([v(s).e("header"),(D.value==="year"||D.value==="month")&&v(s).e("header--bordered")])},[Q("span",{class:N(v(s).e("prev-btn"))},[Q("button",{type:"button","aria-label":v(l)("el.datepicker.prevYear"),class:N(["d-arrow-left",v(r).e("icon-btn")]),onClick:me[2]||(me[2]=Ie=>k(!1))},[re(v(ct),null,{default:pe(()=>[re(v(rC))]),_:1})],10,$8e),zt(Q("button",{type:"button","aria-label":v(l)("el.datepicker.prevMonth"),class:N([v(r).e("icon-btn"),"arrow-left"]),onClick:me[3]||(me[3]=Ie=>H(!1))},[re(v(ct),null,{default:pe(()=>[re(v(Ty))]),_:1})],10,L8e),[[Ei,D.value==="date"]])],2),Q("span",{role:"button",class:N(v(s).e("header-label")),"aria-live":"polite",tabindex:"0",onKeydown:me[4]||(me[4]=Di(Ie=>ye("year"),["enter"])),onClick:me[5]||(me[5]=Ie=>ye("year"))},We(v($)),35),zt(Q("span",{role:"button","aria-live":"polite",tabindex:"0",class:N([v(s).e("header-label"),{active:D.value==="month"}]),onKeydown:me[6]||(me[6]=Di(Ie=>ye("month"),["enter"])),onClick:me[7]||(me[7]=Ie=>ye("month"))},We(v(l)(`el.datepicker.month${v(E)+1}`)),35),[[Ei,D.value==="date"]]),Q("span",{class:N(v(s).e("next-btn"))},[zt(Q("button",{type:"button","aria-label":v(l)("el.datepicker.nextMonth"),class:N([v(r).e("icon-btn"),"arrow-right"]),onClick:me[8]||(me[8]=Ie=>H(!0))},[re(v(ct),null,{default:pe(()=>[re(v(Wl))]),_:1})],10,D8e),[[Ei,D.value==="date"]]),Q("button",{type:"button","aria-label":v(l)("el.datepicker.nextYear"),class:N([v(r).e("icon-btn"),"d-arrow-right"]),onClick:me[9]||(me[9]=Ie=>k(!0))},[re(v(ct),null,{default:pe(()=>[re(v(sC))]),_:1})],10,k8e)],2)],2),[[Ei,D.value!=="time"]]),Q("div",{class:N(v(r).e("content")),onKeydown:Je},[D.value==="date"?(I(),Se(sV,{key:0,ref_key:"currentViewRef",ref:x,"selection-mode":v(Y),date:w.value,"parsed-value":te.parsedValue,"disabled-date":v(p),"cell-class-name":v(m),onPick:G},null,8,["selection-mode","date","parsed-value","disabled-date","cell-class-name"])):_e("v-if",!0),D.value==="year"?(I(),Se(R8e,{key:1,ref_key:"currentViewRef",ref:x,date:w.value,"disabled-date":v(p),"parsed-value":te.parsedValue,onPick:he},null,8,["date","disabled-date","parsed-value"])):_e("v-if",!0),D.value==="month"?(I(),Se(aV,{key:2,ref_key:"currentViewRef",ref:x,date:w.value,"parsed-value":te.parsedValue,"disabled-date":v(p),onPick:J},null,8,["date","parsed-value","disabled-date"])):_e("v-if",!0)],34)],2)],2),zt(Q("div",{class:N(v(r).e("footer"))},[zt(re(v(Bo),{text:"",size:"small",class:N(v(r).e("link-btn")),onClick:le},{default:pe(()=>[Gi(We(v(l)("el.datepicker.now")),1)]),_:1},8,["class"]),[[Ei,v(Y)!=="dates"]]),re(v(Bo),{plain:"",size:"small",class:N(v(r).e("link-btn")),onClick:ae},{default:pe(()=>[Gi(We(v(l)("el.datepicker.confirm")),1)]),_:1},8,["class"])],2),[[Ei,v(ce)&&D.value==="date"]])],2))}});var N8e=qe(F8e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-date-pick.vue"]]);const V8e=Ke({...xle,...Cle}),B8e=i=>{const{emit:e}=ti(),t=VC(),n=uo();return s=>{const a=Lt(s.value)?s.value():s.value;if(a){e("pick",[Yt(a[0]).locale(i.value),Yt(a[1]).locale(i.value)]);return}s.onClick&&s.onClick({attrs:t,slots:n,emit:e})}},Ele=(i,{defaultValue:e,leftDate:t,rightDate:n,unit:r,onParsedValueChanged:s})=>{const{emit:a}=ti(),{pickerNs:o}=ht(u9),l=Ne("date-range-picker"),{t:c,lang:u}=Ki(),d=B8e(u),h=W(),p=W(),m=W({endDate:null,selecting:!1}),g=w=>{m.value=w},_=(w=!1)=>{const C=v(h),S=v(p);rV([C,S])&&a("pick",[C,S],w)},b=w=>{m.value.selecting=w,w||(m.value.endDate=null)},x=()=>{const[w,C]=Sle(v(e),{lang:v(u),unit:r,unlinkPanels:i.unlinkPanels});h.value=void 0,p.value=void 0,t.value=w,n.value=C};return Ve(e,w=>{w&&x()},{immediate:!0}),Ve(()=>i.parsedValue,w=>{if(st(w)&&w.length===2){const[C,S]=w;h.value=C,t.value=C,p.value=S,s(v(h),v(p))}else x()},{immediate:!0}),{minDate:h,maxDate:p,rangeState:m,lang:u,ppNs:o,drpNs:l,handleChangeRange:g,handleRangeConfirm:_,handleShortcutClick:d,onSelect:b,t:c}},z8e=["onClick"],U8e=["disabled"],H8e=["disabled"],G8e=["disabled"],W8e=["disabled"],iP="month",j8e=de({__name:"panel-date-range",props:V8e,emits:["pick","set-picker-option","calendar-change","panel-change"],setup(i,{emit:e}){const t=i,n=ht("EP_PICKER_BASE"),{disabledDate:r,cellClassName:s,format:a,defaultTime:o,arrowControl:l,clearable:c}=n.props,u=kr(n.props,"shortcuts"),d=kr(n.props,"defaultValue"),{lang:h}=Ki(),p=W(Yt().locale(h.value)),m=W(Yt().locale(h.value).add(1,iP)),{minDate:g,maxDate:_,rangeState:b,ppNs:x,drpNs:w,handleChangeRange:C,handleRangeConfirm:S,handleShortcutClick:E,onSelect:A,t:P}=Ele(t,{defaultValue:d,leftDate:p,rightDate:m,unit:iP,onParsedValueChanged:K}),O=W({min:null,max:null}),M=W({min:null,max:null}),V=R(()=>`${p.value.year()} ${P("el.datepicker.year")} ${P(`el.datepicker.month${p.value.month()+1}`)}`),L=R(()=>`${m.value.year()} ${P("el.datepicker.year")} ${P(`el.datepicker.month${m.value.month()+1}`)}`),U=R(()=>p.value.year()),G=R(()=>p.value.month()),H=R(()=>m.value.year()),k=R(()=>m.value.month()),D=R(()=>!!u.value.length),$=R(()=>O.value.min!==null?O.value.min:g.value?g.value.format(J.value):""),F=R(()=>O.value.max!==null?O.value.max:_.value||g.value?(_.value||g.value).format(J.value):""),Y=R(()=>M.value.min!==null?M.value.min:g.value?g.value.format(X.value):""),ne=R(()=>M.value.max!==null?M.value.max:_.value||g.value?(_.value||g.value).format(X.value):""),X=R(()=>Voe(a)),J=R(()=>Noe(a)),he=()=>{p.value=p.value.subtract(1,"year"),t.unlinkPanels||(m.value=p.value.add(1,"month")),ie("year")},ye=()=>{p.value=p.value.subtract(1,"month"),t.unlinkPanels||(m.value=p.value.add(1,"month")),ie("month")},Te=()=>{t.unlinkPanels?m.value=m.value.add(1,"year"):(p.value=p.value.add(1,"year"),m.value=p.value.add(1,"month")),ie("year")},ce=()=>{t.unlinkPanels?m.value=m.value.add(1,"month"):(p.value=p.value.add(1,"month"),m.value=p.value.add(1,"month")),ie("month")},ae=()=>{p.value=p.value.add(1,"year"),ie("year")},le=()=>{p.value=p.value.add(1,"month"),ie("month")},fe=()=>{m.value=m.value.subtract(1,"year"),ie("year")},Ue=()=>{m.value=m.value.subtract(1,"month"),ie("month")},ie=se=>{e("panel-change",[p.value.toDate(),m.value.toDate()],se)},oe=R(()=>{const se=(G.value+1)%12,Me=G.value+1>=12?1:0;return t.unlinkPanels&&new Date(U.value+Me,se)<new Date(H.value,k.value)}),we=R(()=>t.unlinkPanels&&H.value*12+k.value-(U.value*12+G.value+1)>=12),Ae=R(()=>!(g.value&&_.value&&!b.value.selecting&&rV([g.value,_.value]))),Oe=R(()=>t.type==="datetime"||t.type==="datetimerange"),ve=(se,Me)=>{if(se)return o?Yt(o[Me]||o).locale(h.value).year(se.year()).month(se.month()).date(se.date()):se},ke=(se,Me=!0)=>{const De=se.minDate,Tt=se.maxDate,Zt=ve(De,0),tn=ve(Tt,1);_.value===tn&&g.value===Zt||(e("calendar-change",[De.toDate(),Tt&&Tt.toDate()]),_.value=tn,g.value=Zt,!(!Me||Oe.value)&&S())},be=W(!1),$e=W(!1),Le=()=>{be.value=!1},Ce=()=>{$e.value=!1},Be=(se,Me)=>{O.value[Me]=se;const De=Yt(se,J.value).locale(h.value);if(De.isValid()){if(r&&r(De.toDate()))return;Me==="min"?(p.value=De,g.value=(g.value||p.value).year(De.year()).month(De.month()).date(De.date()),t.unlinkPanels||(m.value=De.add(1,"month"),_.value=g.value.add(1,"month"))):(m.value=De,_.value=(_.value||m.value).year(De.year()).month(De.month()).date(De.date()),t.unlinkPanels||(p.value=De.subtract(1,"month"),g.value=_.value.subtract(1,"month")))}},He=(se,Me)=>{O.value[Me]=null},Xe=(se,Me)=>{M.value[Me]=se;const De=Yt(se,X.value).locale(h.value);De.isValid()&&(Me==="min"?(be.value=!0,g.value=(g.value||p.value).hour(De.hour()).minute(De.minute()).second(De.second()),(!_.value||_.value.isBefore(g.value))&&(_.value=g.value)):($e.value=!0,_.value=(_.value||m.value).hour(De.hour()).minute(De.minute()).second(De.second()),m.value=_.value,_.value&&_.value.isBefore(g.value)&&(g.value=_.value)))},Je=(se,Me)=>{M.value[Me]=null,Me==="min"?(p.value=g.value,be.value=!1):(m.value=_.value,$e.value=!1)},it=(se,Me,De)=>{M.value.min||(se&&(p.value=se,g.value=(g.value||p.value).hour(se.hour()).minute(se.minute()).second(se.second())),De||(be.value=Me),(!_.value||_.value.isBefore(g.value))&&(_.value=g.value,m.value=se))},Qe=(se,Me,De)=>{M.value.max||(se&&(m.value=se,_.value=(_.value||m.value).hour(se.hour()).minute(se.minute()).second(se.second())),De||($e.value=Me),_.value&&_.value.isBefore(g.value)&&(g.value=_.value))},te=()=>{p.value=Sle(v(d),{lang:v(h),unit:"month",unlinkPanels:t.unlinkPanels})[0],m.value=p.value.add(1,"month"),e("pick",null)},me=se=>st(se)?se.map(Me=>Me.format(a)):se.format(a),Ie=se=>st(se)?se.map(Me=>Yt(Me,a).locale(h.value)):Yt(se,a).locale(h.value);function K(se,Me){if(t.unlinkPanels&&Me){const De=(se==null?void 0:se.year())||0,Tt=(se==null?void 0:se.month())||0,Zt=Me.year(),tn=Me.month();m.value=De===Zt&&Tt===tn?Me.add(1,iP):Me}else m.value=p.value.add(1,iP),Me&&(m.value=m.value.hour(Me.hour()).minute(Me.minute()).second(Me.second()))}return e("set-picker-option",["isValidValue",rV]),e("set-picker-option",["parseUserInput",Ie]),e("set-picker-option",["formatToString",me]),e("set-picker-option",["handleClear",te]),(se,Me)=>(I(),Z("div",{class:N([v(x).b(),v(w).b(),{"has-sidebar":se.$slots.sidebar||v(D),"has-time":v(Oe)}])},[Q("div",{class:N(v(x).e("body-wrapper"))},[Fe(se.$slots,"sidebar",{class:N(v(x).e("sidebar"))}),v(D)?(I(),Z("div",{key:0,class:N(v(x).e("sidebar"))},[(I(!0),Z(gt,null,xi(v(u),(De,Tt)=>(I(),Z("button",{key:Tt,type:"button",class:N(v(x).e("shortcut")),onClick:Zt=>v(E)(De)},We(De.text),11,z8e))),128))],2)):_e("v-if",!0),Q("div",{class:N(v(x).e("body"))},[v(Oe)?(I(),Z("div",{key:0,class:N(v(w).e("time-header"))},[Q("span",{class:N(v(w).e("editors-wrap"))},[Q("span",{class:N(v(w).e("time-picker-wrap"))},[re(v(ol),{size:"small",disabled:v(b).selecting,placeholder:v(P)("el.datepicker.startDate"),class:N(v(w).e("editor")),"model-value":v($),"validate-event":!1,onInput:Me[0]||(Me[0]=De=>Be(De,"min")),onChange:Me[1]||(Me[1]=De=>He(De,"min"))},null,8,["disabled","placeholder","class","model-value"])],2),zt((I(),Z("span",{class:N(v(w).e("time-picker-wrap"))},[re(v(ol),{size:"small",class:N(v(w).e("editor")),disabled:v(b).selecting,placeholder:v(P)("el.datepicker.startTime"),"model-value":v(Y),"validate-event":!1,onFocus:Me[2]||(Me[2]=De=>be.value=!0),onInput:Me[3]||(Me[3]=De=>Xe(De,"min")),onChange:Me[4]||(Me[4]=De=>Je(De,"min"))},null,8,["class","disabled","placeholder","model-value"]),re(v(p$),{visible:be.value,format:v(X),"datetime-role":"start","time-arrow-control":v(l),"parsed-value":p.value,onPick:it},null,8,["visible","format","time-arrow-control","parsed-value"])],2)),[[v(My),Le]])],2),Q("span",null,[re(v(ct),null,{default:pe(()=>[re(v(Wl))]),_:1})]),Q("span",{class:N([v(w).e("editors-wrap"),"is-right"])},[Q("span",{class:N(v(w).e("time-picker-wrap"))},[re(v(ol),{size:"small",class:N(v(w).e("editor")),disabled:v(b).selecting,placeholder:v(P)("el.datepicker.endDate"),"model-value":v(F),readonly:!v(g),"validate-event":!1,onInput:Me[5]||(Me[5]=De=>Be(De,"max")),onChange:Me[6]||(Me[6]=De=>He(De,"max"))},null,8,["class","disabled","placeholder","model-value","readonly"])],2),zt((I(),Z("span",{class:N(v(w).e("time-picker-wrap"))},[re(v(ol),{size:"small",class:N(v(w).e("editor")),disabled:v(b).selecting,placeholder:v(P)("el.datepicker.endTime"),"model-value":v(ne),readonly:!v(g),"validate-event":!1,onFocus:Me[7]||(Me[7]=De=>v(g)&&($e.value=!0)),onInput:Me[8]||(Me[8]=De=>Xe(De,"max")),onChange:Me[9]||(Me[9]=De=>Je(De,"max"))},null,8,["class","disabled","placeholder","model-value","readonly"]),re(v(p$),{"datetime-role":"end",visible:$e.value,format:v(X),"time-arrow-control":v(l),"parsed-value":m.value,onPick:Qe},null,8,["visible","format","time-arrow-control","parsed-value"])],2)),[[v(My),Ce]])],2)],2)):_e("v-if",!0),Q("div",{class:N([[v(x).e("content"),v(w).e("content")],"is-left"])},[Q("div",{class:N(v(w).e("header"))},[Q("button",{type:"button",class:N([v(x).e("icon-btn"),"d-arrow-left"]),onClick:he},[re(v(ct),null,{default:pe(()=>[re(v(rC))]),_:1})],2),Q("button",{type:"button",class:N([v(x).e("icon-btn"),"arrow-left"]),onClick:ye},[re(v(ct),null,{default:pe(()=>[re(v(Ty))]),_:1})],2),se.unlinkPanels?(I(),Z("button",{key:0,type:"button",disabled:!v(we),class:N([[v(x).e("icon-btn"),{"is-disabled":!v(we)}],"d-arrow-right"]),onClick:ae},[re(v(ct),null,{default:pe(()=>[re(v(sC))]),_:1})],10,U8e)):_e("v-if",!0),se.unlinkPanels?(I(),Z("button",{key:1,type:"button",disabled:!v(oe),class:N([[v(x).e("icon-btn"),{"is-disabled":!v(oe)}],"arrow-right"]),onClick:le},[re(v(ct),null,{default:pe(()=>[re(v(Wl))]),_:1})],10,H8e)):_e("v-if",!0),Q("div",null,We(v(V)),1)],2),re(sV,{"selection-mode":"range",date:p.value,"min-date":v(g),"max-date":v(_),"range-state":v(b),"disabled-date":v(r),"cell-class-name":v(s),onChangerange:v(C),onPick:ke,onSelect:v(A)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2),Q("div",{class:N([[v(x).e("content"),v(w).e("content")],"is-right"])},[Q("div",{class:N(v(w).e("header"))},[se.unlinkPanels?(I(),Z("button",{key:0,type:"button",disabled:!v(we),class:N([[v(x).e("icon-btn"),{"is-disabled":!v(we)}],"d-arrow-left"]),onClick:fe},[re(v(ct),null,{default:pe(()=>[re(v(rC))]),_:1})],10,G8e)):_e("v-if",!0),se.unlinkPanels?(I(),Z("button",{key:1,type:"button",disabled:!v(oe),class:N([[v(x).e("icon-btn"),{"is-disabled":!v(oe)}],"arrow-left"]),onClick:Ue},[re(v(ct),null,{default:pe(()=>[re(v(Ty))]),_:1})],10,W8e)):_e("v-if",!0),Q("button",{type:"button",class:N([v(x).e("icon-btn"),"d-arrow-right"]),onClick:Te},[re(v(ct),null,{default:pe(()=>[re(v(sC))]),_:1})],2),Q("button",{type:"button",class:N([v(x).e("icon-btn"),"arrow-right"]),onClick:ce},[re(v(ct),null,{default:pe(()=>[re(v(Wl))]),_:1})],2),Q("div",null,We(v(L)),1)],2),re(sV,{"selection-mode":"range",date:m.value,"min-date":v(g),"max-date":v(_),"range-state":v(b),"disabled-date":v(r),"cell-class-name":v(s),onChangerange:v(C),onPick:ke,onSelect:v(A)},null,8,["date","min-date","max-date","range-state","disabled-date","cell-class-name","onChangerange","onSelect"])],2)],2)],2),v(Oe)?(I(),Z("div",{key:0,class:N(v(x).e("footer"))},[v(c)?(I(),Se(v(Bo),{key:0,text:"",size:"small",class:N(v(x).e("link-btn")),onClick:te},{default:pe(()=>[Gi(We(v(P)("el.datepicker.clear")),1)]),_:1},8,["class"])):_e("v-if",!0),re(v(Bo),{plain:"",size:"small",class:N(v(x).e("link-btn")),disabled:v(Ae),onClick:Me[10]||(Me[10]=De=>v(S)(!1))},{default:pe(()=>[Gi(We(v(P)("el.datepicker.confirm")),1)]),_:1},8,["class","disabled"])],2)):_e("v-if",!0)],2))}});var q8e=qe(j8e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-date-range.vue"]]);const K8e=Ke({...Cle}),Y8e=["pick","set-picker-option"],X8e=({unlinkPanels:i,leftDate:e,rightDate:t})=>{const{t:n}=Ki(),r=()=>{e.value=e.value.subtract(1,"year"),i.value||(t.value=t.value.subtract(1,"year"))},s=()=>{i.value||(e.value=e.value.add(1,"year")),t.value=t.value.add(1,"year")},a=()=>{e.value=e.value.add(1,"year")},o=()=>{t.value=t.value.subtract(1,"year")},l=R(()=>`${e.value.year()} ${n("el.datepicker.year")}`),c=R(()=>`${t.value.year()} ${n("el.datepicker.year")}`),u=R(()=>e.value.year()),d=R(()=>t.value.year()===e.value.year()?e.value.year()+1:t.value.year());return{leftPrevYear:r,rightNextYear:s,leftNextYear:a,rightPrevYear:o,leftLabel:l,rightLabel:c,leftYear:u,rightYear:d}},Z8e=["onClick"],Q8e=["disabled"],J8e=["disabled"],nP="year",eBe=de({name:"DatePickerMonthRange"}),tBe=de({...eBe,props:K8e,emits:Y8e,setup(i,{emit:e}){const t=i,{lang:n}=Ki(),r=ht("EP_PICKER_BASE"),{shortcuts:s,disabledDate:a,format:o}=r.props,l=kr(r.props,"defaultValue"),c=W(Yt().locale(n.value)),u=W(Yt().locale(n.value).add(1,nP)),{minDate:d,maxDate:h,rangeState:p,ppNs:m,drpNs:g,handleChangeRange:_,handleRangeConfirm:b,handleShortcutClick:x,onSelect:w}=Ele(t,{defaultValue:l,leftDate:c,rightDate:u,unit:nP,onParsedValueChanged:k}),C=R(()=>!!s.length),{leftPrevYear:S,rightNextYear:E,leftNextYear:A,rightPrevYear:P,leftLabel:O,rightLabel:M,leftYear:V,rightYear:L}=X8e({unlinkPanels:kr(t,"unlinkPanels"),leftDate:c,rightDate:u}),U=R(()=>t.unlinkPanels&&L.value>V.value+1),G=(D,$=!0)=>{const F=D.minDate,Y=D.maxDate;h.value===Y&&d.value===F||(h.value=Y,d.value=F,$&&b())},H=D=>D.map($=>$.format(o));function k(D,$){if(t.unlinkPanels&&$){const F=(D==null?void 0:D.year())||0,Y=$.year();u.value=F===Y?$.add(1,nP):$}else u.value=c.value.add(1,nP)}return e("set-picker-option",["formatToString",H]),(D,$)=>(I(),Z("div",{class:N([v(m).b(),v(g).b(),{"has-sidebar":Boolean(D.$slots.sidebar)||v(C)}])},[Q("div",{class:N(v(m).e("body-wrapper"))},[Fe(D.$slots,"sidebar",{class:N(v(m).e("sidebar"))}),v(C)?(I(),Z("div",{key:0,class:N(v(m).e("sidebar"))},[(I(!0),Z(gt,null,xi(v(s),(F,Y)=>(I(),Z("button",{key:Y,type:"button",class:N(v(m).e("shortcut")),onClick:ne=>v(x)(F)},We(F.text),11,Z8e))),128))],2)):_e("v-if",!0),Q("div",{class:N(v(m).e("body"))},[Q("div",{class:N([[v(m).e("content"),v(g).e("content")],"is-left"])},[Q("div",{class:N(v(g).e("header"))},[Q("button",{type:"button",class:N([v(m).e("icon-btn"),"d-arrow-left"]),onClick:$[0]||($[0]=(...F)=>v(S)&&v(S)(...F))},[re(v(ct),null,{default:pe(()=>[re(v(rC))]),_:1})],2),D.unlinkPanels?(I(),Z("button",{key:0,type:"button",disabled:!v(U),class:N([[v(m).e("icon-btn"),{[v(m).is("disabled")]:!v(U)}],"d-arrow-right"]),onClick:$[1]||($[1]=(...F)=>v(A)&&v(A)(...F))},[re(v(ct),null,{default:pe(()=>[re(v(sC))]),_:1})],10,Q8e)):_e("v-if",!0),Q("div",null,We(v(O)),1)],2),re(aV,{"selection-mode":"range",date:c.value,"min-date":v(d),"max-date":v(h),"range-state":v(p),"disabled-date":v(a),onChangerange:v(_),onPick:G,onSelect:v(w)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2),Q("div",{class:N([[v(m).e("content"),v(g).e("content")],"is-right"])},[Q("div",{class:N(v(g).e("header"))},[D.unlinkPanels?(I(),Z("button",{key:0,type:"button",disabled:!v(U),class:N([[v(m).e("icon-btn"),{"is-disabled":!v(U)}],"d-arrow-left"]),onClick:$[2]||($[2]=(...F)=>v(P)&&v(P)(...F))},[re(v(ct),null,{default:pe(()=>[re(v(rC))]),_:1})],10,J8e)):_e("v-if",!0),Q("button",{type:"button",class:N([v(m).e("icon-btn"),"d-arrow-right"]),onClick:$[3]||($[3]=(...F)=>v(E)&&v(E)(...F))},[re(v(ct),null,{default:pe(()=>[re(v(sC))]),_:1})],2),Q("div",null,We(v(M)),1)],2),re(aV,{"selection-mode":"range",date:u.value,"min-date":v(d),"max-date":v(h),"range-state":v(p),"disabled-date":v(a),onChangerange:v(_),onPick:G,onSelect:v(w)},null,8,["date","min-date","max-date","range-state","disabled-date","onChangerange","onSelect"])],2)],2)],2)],2))}});var iBe=qe(tBe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/date-picker/src/date-picker-com/panel-month-range.vue"]]);const nBe=function(i){switch(i){case"daterange":case"datetimerange":return q8e;case"monthrange":return iBe;default:return N8e}};Yt.extend(ele);Yt.extend(K6e);Yt.extend(M9);Yt.extend(X6e);Yt.extend(Q6e);Yt.extend(e8e);Yt.extend(i8e);Yt.extend(r8e);var rBe=de({name:"ElDatePicker",install:null,props:{...P9,...s8e},emits:["update:modelValue"],setup(i,{expose:e,emit:t,slots:n}){const r=Ne("picker-panel");pi("ElPopperOptions",Ji(kr(i,"popperOptions"))),pi(u9,{slots:n,pickerNs:r});const s=W();e({focus:(l=!0)=>{var c;(c=s.value)==null||c.focus(l)},handleOpen:()=>{var l;(l=s.value)==null||l.handleOpen()},handleClose:()=>{var l;(l=s.value)==null||l.handleClose()}});const o=l=>{t("update:modelValue",l)};return()=>{var l;const c=(l=i.format)!=null?l:Z4e[i.type]||J1,u=nBe(i.type);return re(Uoe,ci(i,{format:c,type:i.type,ref:s,"onUpdate:modelValue":o}),{default:d=>re(u,d,null),"range-separator":n["range-separator"]})}}});const SR=rBe;SR.install=i=>{i.component(SR.name,SR)};const sBe=SR,$9="elDescriptions";var vT=de({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String},type:{type:String}},setup(){return{descriptions:ht($9,{})}},render(){var i,e,t,n,r,s;const a=a3e(this.cell),{border:o,direction:l}=this.descriptions,c=l==="vertical",u=((t=(e=(i=this.cell)==null?void 0:i.children)==null?void 0:e.label)==null?void 0:t.call(e))||a.label,d=(s=(r=(n=this.cell)==null?void 0:n.children)==null?void 0:r.default)==null?void 0:s.call(r),h=a.span,p=a.align?`is-${a.align}`:"",m=a.labelAlign?`is-${a.labelAlign}`:p,g=a.className,_=a.labelClassName,b={width:Xs(a.width),minWidth:Xs(a.minWidth)},x=Ne("descriptions");switch(this.type){case"label":return bt(this.tag,{style:b,class:[x.e("cell"),x.e("label"),x.is("bordered-label",o),x.is("vertical-label",c),m,_],colSpan:c?h:1},u);case"content":return bt(this.tag,{style:b,class:[x.e("cell"),x.e("content"),x.is("bordered-content",o),x.is("vertical-content",c),p,g],colSpan:c?h:h*2-1},d);default:return bt("td",{style:b,class:[x.e("cell"),p],colSpan:h},[bt("span",{class:[x.e("label"),_]},u),bt("span",{class:[x.e("content"),g]},d)])}}});const aBe=Ke({row:{type:Array,default:()=>[]}}),oBe={key:1},lBe=de({name:"ElDescriptionsRow"}),cBe=de({...lBe,props:aBe,setup(i){const e=ht($9,{});return(t,n)=>v(e).direction==="vertical"?(I(),Z(gt,{key:0},[Q("tr",null,[(I(!0),Z(gt,null,xi(t.row,(r,s)=>(I(),Se(v(vT),{key:`tr1-${s}`,cell:r,tag:"th",type:"label"},null,8,["cell"]))),128))]),Q("tr",null,[(I(!0),Z(gt,null,xi(t.row,(r,s)=>(I(),Se(v(vT),{key:`tr2-${s}`,cell:r,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(I(),Z("tr",oBe,[(I(!0),Z(gt,null,xi(t.row,(r,s)=>(I(),Z(gt,{key:`tr3-${s}`},[v(e).border?(I(),Z(gt,{key:0},[re(v(vT),{cell:r,tag:"td",type:"label"},null,8,["cell"]),re(v(vT),{cell:r,tag:"td",type:"content"},null,8,["cell"])],64)):(I(),Se(v(vT),{key:1,cell:r,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var uBe=qe(cBe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/descriptions-row.vue"]]);const dBe=Ke({border:{type:Boolean,default:!1},column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Ql,title:{type:String,default:""},extra:{type:String,default:""}}),hBe=de({name:"ElDescriptions"}),pBe=de({...hBe,props:dBe,setup(i){const e=i,t=Ne("descriptions"),n=Qs(),r=uo();pi($9,e);const s=R(()=>[t.b(),t.m(n.value)]),a=(l,c,u,d=!1)=>(l.props||(l.props={}),c>u&&(l.props.span=u),d&&(l.props.span=c),l),o=()=>{var l;const c=gx((l=r.default)==null?void 0:l.call(r)).filter(m=>{var g;return((g=m==null?void 0:m.type)==null?void 0:g.name)==="ElDescriptionsItem"}),u=[];let d=[],h=e.column,p=0;return c.forEach((m,g)=>{var _;const b=((_=m.props)==null?void 0:_.span)||1;if(g<c.length-1&&(p+=b>h?h:b),g===c.length-1){const x=e.column-p%e.column;d.push(a(m,x,h,!0)),u.push(d);return}b<h?(h-=b,d.push(m)):(d.push(a(m,b,h)),u.push(d),h=e.column,d=[])}),u};return(l,c)=>(I(),Z("div",{class:N(v(s))},[l.title||l.extra||l.$slots.title||l.$slots.extra?(I(),Z("div",{key:0,class:N(v(t).e("header"))},[Q("div",{class:N(v(t).e("title"))},[Fe(l.$slots,"title",{},()=>[Gi(We(l.title),1)])],2),Q("div",{class:N(v(t).e("extra"))},[Fe(l.$slots,"extra",{},()=>[Gi(We(l.extra),1)])],2)],2)):_e("v-if",!0),Q("div",{class:N(v(t).e("body"))},[Q("table",{class:N([v(t).e("table"),v(t).is("bordered",l.border)])},[Q("tbody",null,[(I(!0),Z(gt,null,xi(o(),(u,d)=>(I(),Se(uBe,{key:d,row:u},null,8,["row"]))),128))])],2)],2)],2))}});var fBe=qe(pBe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/descriptions/src/description.vue"]]),Ale=de({name:"ElDescriptionsItem",props:{label:{type:String,default:""},span:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},align:{type:String,default:"left"},labelAlign:{type:String,default:""},className:{type:String,default:""},labelClassName:{type:String,default:""}}});const mBe=ii(fBe,{DescriptionsItem:Ale}),gBe=Wr(Ale),vBe=Ke({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:xe([String,Array,Object])},zIndex:{type:xe([String,Number])}}),yBe={click:i=>i instanceof MouseEvent};var _Be=de({name:"ElOverlay",props:vBe,emits:yBe,setup(i,{slots:e,emit:t}){const n=Ne("overlay"),r=l=>{t("click",l)},{onClick:s,onMousedown:a,onMouseup:o}=_9(i.customMaskEvent?void 0:r);return()=>i.mask?re("div",{class:[n.b(),i.overlayClass],style:{zIndex:i.zIndex},onClick:s,onMousedown:a,onMouseup:o},[Fe(e,"default")],id.STYLE|id.CLASS|id.PROPS,["onClick","onMouseup","onMousedown"]):bt("div",{class:i.overlayClass,style:{zIndex:i.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[Fe(e,"default")])}});const L9=_Be,Mle=Ke({center:{type:Boolean,default:!1},alignCenter:{type:Boolean,default:!1},closeIcon:{type:Zn},customClass:{type:String,default:""},draggable:{type:Boolean,default:!1},fullscreen:{type:Boolean,default:!1},showClose:{type:Boolean,default:!0},title:{type:String,default:""}}),bBe={close:()=>!0},wBe=["aria-label"],xBe=["id"],CBe=de({name:"ElDialogContent"}),TBe=de({...CBe,props:Mle,emits:bBe,setup(i){const e=i,{t}=Ki(),{Close:n}=Eae,{dialogRef:r,headerRef:s,bodyId:a,ns:o,style:l}=ht(Lae),{focusTrapRef:c}=ht(S9),u=P3(c,r),d=R(()=>e.draggable);return Wae(r,s,d),(h,p)=>(I(),Z("div",{ref:v(u),class:N([v(o).b(),v(o).is("fullscreen",h.fullscreen),v(o).is("draggable",v(d)),v(o).is("align-center",h.alignCenter),{[v(o).m("center")]:h.center},h.customClass]),style:pt(v(l)),tabindex:"-1"},[Q("header",{ref_key:"headerRef",ref:s,class:N(v(o).e("header"))},[Fe(h.$slots,"header",{},()=>[Q("span",{role:"heading",class:N(v(o).e("title"))},We(h.title),3)]),h.showClose?(I(),Z("button",{key:0,"aria-label":v(t)("el.dialog.close"),class:N(v(o).e("headerbtn")),type:"button",onClick:p[0]||(p[0]=m=>h.$emit("close"))},[re(v(ct),{class:N(v(o).e("close"))},{default:pe(()=>[(I(),Se(hi(h.closeIcon||v(n))))]),_:1},8,["class"])],10,wBe)):_e("v-if",!0)],2),Q("div",{id:v(a),class:N(v(o).e("body"))},[Fe(h.$slots,"default")],10,xBe),h.$slots.footer?(I(),Z("footer",{key:0,class:N(v(o).e("footer"))},[Fe(h.$slots,"footer")],2)):_e("v-if",!0)],6))}});var SBe=qe(TBe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog-content.vue"]]);const Ple=Ke({...Mle,appendToBody:{type:Boolean,default:!1},beforeClose:{type:xe(Function)},destroyOnClose:{type:Boolean,default:!1},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:{type:Boolean,default:!1},modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1}}),Ole={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[ri]:i=>Ys(i),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},Rle=(i,e)=>{const n=ti().emit,{nextZIndex:r}=yg();let s="";const a=Ih(),o=Ih(),l=W(!1),c=W(!1),u=W(!1),d=W(i.zIndex||r());let h,p;const m=vg("namespace",k3),g=R(()=>{const G={},H=`--${m.value}-dialog`;return i.fullscreen||(i.top&&(G[`${H}-margin-top`]=i.top),i.width&&(G[`${H}-width`]=Xs(i.width))),G}),_=R(()=>i.alignCenter?{display:"flex"}:{});function b(){n("opened")}function x(){n("closed"),n(ri,!1),i.destroyOnClose&&(u.value=!1)}function w(){n("close")}function C(){p==null||p(),h==null||h(),i.openDelay&&i.openDelay>0?{stop:h}=ob(()=>P(),i.openDelay):P()}function S(){h==null||h(),p==null||p(),i.closeDelay&&i.closeDelay>0?{stop:p}=ob(()=>O(),i.closeDelay):O()}function E(){function G(H){H||(c.value=!0,l.value=!1)}i.beforeClose?i.beforeClose(G):S()}function A(){i.closeOnClickModal&&E()}function P(){Ii&&(l.value=!0)}function O(){l.value=!1}function M(){n("openAutoFocus")}function V(){n("closeAutoFocus")}function L(G){var H;((H=G.detail)==null?void 0:H.focusReason)==="pointer"&&G.preventDefault()}i.lockScroll&&qae(l);function U(){i.closeOnPressEscape&&E()}return Ve(()=>i.modelValue,G=>{G?(c.value=!1,C(),u.value=!0,d.value=i.zIndex?d.value++:r(),ut(()=>{n("open"),e.value&&(e.value.scrollTop=0)})):l.value&&S()}),Ve(()=>i.fullscreen,G=>{e.value&&(G?(s=e.value.style.transform,e.value.style.transform=""):e.value.style.transform=s)}),qt(()=>{i.modelValue&&(l.value=!0,u.value=!0,C())}),{afterEnter:b,afterLeave:x,beforeLeave:w,handleClose:E,onModalClick:A,close:S,doClose:O,onOpenAutoFocus:M,onCloseAutoFocus:V,onCloseRequested:U,onFocusoutPrevented:L,titleId:a,bodyId:o,closed:c,style:g,overlayDialogStyle:_,rendered:u,visible:l,zIndex:d}},EBe=["aria-label","aria-labelledby","aria-describedby"],ABe=de({name:"ElDialog",inheritAttrs:!1}),MBe=de({...ABe,props:Ple,emits:Ole,setup(i,{expose:e}){const t=i,n=uo();Ym({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},R(()=>!!n.title)),Ym({scope:"el-dialog",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/dialog.html#attributes",type:"Attribute"},R(()=>!!t.customClass));const r=Ne("dialog"),s=W(),a=W(),o=W(),{visible:l,titleId:c,bodyId:u,style:d,overlayDialogStyle:h,rendered:p,zIndex:m,afterEnter:g,afterLeave:_,beforeLeave:b,handleClose:x,onModalClick:w,onOpenAutoFocus:C,onCloseAutoFocus:S,onCloseRequested:E,onFocusoutPrevented:A}=Rle(t,s);pi(Lae,{dialogRef:s,headerRef:a,bodyId:u,ns:r,rendered:p,style:d});const P=_9(w),O=R(()=>t.draggable&&!t.fullscreen);return e({visible:l,dialogContentRef:o}),(M,V)=>(I(),Se(QA,{to:"body",disabled:!M.appendToBody},[re(Ss,{name:"dialog-fade",onAfterEnter:v(g),onAfterLeave:v(_),onBeforeLeave:v(b),persisted:""},{default:pe(()=>[zt(re(v(L9),{"custom-mask-event":"",mask:M.modal,"overlay-class":M.modalClass,"z-index":v(m)},{default:pe(()=>[Q("div",{role:"dialog","aria-modal":"true","aria-label":M.title||void 0,"aria-labelledby":M.title?void 0:v(c),"aria-describedby":v(u),class:N(`${v(r).namespace.value}-overlay-dialog`),style:pt(v(h)),onClick:V[0]||(V[0]=(...L)=>v(P).onClick&&v(P).onClick(...L)),onMousedown:V[1]||(V[1]=(...L)=>v(P).onMousedown&&v(P).onMousedown(...L)),onMouseup:V[2]||(V[2]=(...L)=>v(P).onMouseup&&v(P).onMouseup(...L))},[re(v(z3),{loop:"",trapped:v(l),"focus-start-el":"container",onFocusAfterTrapped:v(C),onFocusAfterReleased:v(S),onFocusoutPrevented:v(A),onReleaseRequested:v(E)},{default:pe(()=>[v(p)?(I(),Se(SBe,ci({key:0,ref_key:"dialogContentRef",ref:o},M.$attrs,{"custom-class":M.customClass,center:M.center,"align-center":M.alignCenter,"close-icon":M.closeIcon,draggable:v(O),fullscreen:M.fullscreen,"show-close":M.showClose,title:M.title,onClose:v(x)}),qm({header:pe(()=>[M.$slots.title?Fe(M.$slots,"title",{key:1}):Fe(M.$slots,"header",{key:0,close:v(x),titleId:v(c),titleClass:v(r).e("title")})]),default:pe(()=>[Fe(M.$slots,"default")]),_:2},[M.$slots.footer?{name:"footer",fn:pe(()=>[Fe(M.$slots,"footer")])}:void 0]),1040,["custom-class","center","align-center","close-icon","draggable","fullscreen","show-close","title","onClose"])):_e("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,EBe)]),_:3},8,["mask","overlay-class","z-index"]),[[Ei,v(l)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"]))}});var PBe=qe(MBe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/dialog/src/dialog.vue"]]);const OBe=ii(PBe),RBe=Ke({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:xe(String),default:"solid"}}),IBe=de({name:"ElDivider"}),$Be=de({...IBe,props:RBe,setup(i){const e=i,t=Ne("divider"),n=R(()=>t.cssVar({"border-style":e.borderStyle}));return(r,s)=>(I(),Z("div",{class:N([v(t).b(),v(t).m(r.direction)]),style:pt(v(n)),role:"separator"},[r.$slots.default&&r.direction!=="vertical"?(I(),Z("div",{key:0,class:N([v(t).e("text"),v(t).is(r.contentPosition)])},[Fe(r.$slots,"default")],2)):_e("v-if",!0)],6))}});var LBe=qe($Be,[["__file","/home/runner/work/element-plus/element-plus/packages/components/divider/src/divider.vue"]]);const Ile=ii(LBe),DBe=Ke({...Ple,direction:{type:String,default:"rtl",values:["ltr","rtl","ttb","btt"]},size:{type:[String,Number],default:"30%"},withHeader:{type:Boolean,default:!0},modalFade:{type:Boolean,default:!0}}),kBe=Ole,FBe=de({name:"ElDrawer",components:{ElOverlay:L9,ElFocusTrap:z3,ElIcon:ct,Close:Rh},inheritAttrs:!1,props:DBe,emits:kBe,setup(i,{slots:e}){Ym({scope:"el-drawer",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/drawer.html#slots"},R(()=>!!e.title)),Ym({scope:"el-drawer",from:"custom-class",replacement:"class",version:"2.3.0",ref:"https://element-plus.org/en-US/component/drawer.html#attributes",type:"Attribute"},R(()=>!!i.customClass));const t=W(),n=W(),r=Ne("drawer"),{t:s}=Ki(),a=R(()=>i.direction==="rtl"||i.direction==="ltr"),o=R(()=>Xs(i.size));return{...Rle(i,t),drawerRef:t,focusStartRef:n,isHorizontal:a,drawerSize:o,ns:r,t:s}}}),NBe=["aria-label","aria-labelledby","aria-describedby"],VBe=["id"],BBe=["aria-label"],zBe=["id"];function UBe(i,e,t,n,r,s){const a=jt("close"),o=jt("el-icon"),l=jt("el-focus-trap"),c=jt("el-overlay");return I(),Se(QA,{to:"body",disabled:!i.appendToBody},[re(Ss,{name:i.ns.b("fade"),onAfterEnter:i.afterEnter,onAfterLeave:i.afterLeave,onBeforeLeave:i.beforeLeave,persisted:""},{default:pe(()=>[zt(re(c,{mask:i.modal,"overlay-class":i.modalClass,"z-index":i.zIndex,onClick:i.onModalClick},{default:pe(()=>[re(l,{loop:"",trapped:i.visible,"focus-trap-el":i.drawerRef,"focus-start-el":i.focusStartRef,onReleaseRequested:i.onCloseRequested},{default:pe(()=>[Q("div",ci({ref:"drawerRef","aria-modal":"true","aria-label":i.title||void 0,"aria-labelledby":i.title?void 0:i.titleId,"aria-describedby":i.bodyId},i.$attrs,{class:[i.ns.b(),i.direction,i.visible&&"open",i.customClass],style:i.isHorizontal?"width: "+i.drawerSize:"height: "+i.drawerSize,role:"dialog",onClick:e[1]||(e[1]=Dt(()=>{},["stop"]))}),[Q("span",{ref:"focusStartRef",class:N(i.ns.e("sr-focus")),tabindex:"-1"},null,2),i.withHeader?(I(),Z("header",{key:0,class:N(i.ns.e("header"))},[i.$slots.title?Fe(i.$slots,"title",{key:1},()=>[_e(" DEPRECATED SLOT ")]):Fe(i.$slots,"header",{key:0,close:i.handleClose,titleId:i.titleId,titleClass:i.ns.e("title")},()=>[i.$slots.title?_e("v-if",!0):(I(),Z("span",{key:0,id:i.titleId,role:"heading",class:N(i.ns.e("title"))},We(i.title),11,VBe))]),i.showClose?(I(),Z("button",{key:2,"aria-label":i.t("el.drawer.close"),class:N(i.ns.e("close-btn")),type:"button",onClick:e[0]||(e[0]=(...u)=>i.handleClose&&i.handleClose(...u))},[re(o,{class:N(i.ns.e("close"))},{default:pe(()=>[re(a)]),_:1},8,["class"])],10,BBe)):_e("v-if",!0)],2)):_e("v-if",!0),i.rendered?(I(),Z("div",{key:1,id:i.bodyId,class:N(i.ns.e("body"))},[Fe(i.$slots,"default")],10,zBe)):_e("v-if",!0),i.$slots.footer?(I(),Z("div",{key:2,class:N(i.ns.e("footer"))},[Fe(i.$slots,"footer")],2)):_e("v-if",!0)],16,NBe)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])]),_:3},8,["mask","overlay-class","z-index","onClick"]),[[Ei,i.visible]])]),_:3},8,["name","onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["disabled"])}var HBe=qe(FBe,[["render",UBe],["__file","/home/runner/work/element-plus/element-plus/packages/components/drawer/src/drawer.vue"]]);const GBe=ii(HBe),WBe=de({inheritAttrs:!1});function jBe(i,e,t,n,r,s){return Fe(i.$slots,"default")}var qBe=qe(WBe,[["render",jBe],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection.vue"]]);const KBe=de({name:"ElCollectionItem",inheritAttrs:!1});function YBe(i,e,t,n,r,s){return Fe(i.$slots,"default")}var XBe=qe(KBe,[["render",YBe],["__file","/home/runner/work/element-plus/element-plus/packages/components/collection/src/collection-item.vue"]]);const $le="data-el-collection-item",Lle=i=>{const e=`El${i}Collection`,t=`${e}Item`,n=Symbol(e),r=Symbol(t),s={...qBe,name:e,setup(){const o=W(null),l=new Map;pi(n,{itemMap:l,getItems:()=>{const u=v(o);if(!u)return[];const d=Array.from(u.querySelectorAll(`[${$le}]`));return[...l.values()].sort((p,m)=>d.indexOf(p.ref)-d.indexOf(m.ref))},collectionRef:o})}},a={...XBe,name:t,setup(o,{attrs:l}){const c=W(null),u=ht(n,void 0);pi(r,{collectionItemRef:c}),qt(()=>{const d=v(c);d&&u.itemMap.set(d,{ref:d,...l})}),Vr(()=>{const d=v(c);u.itemMap.delete(d)})}};return{COLLECTION_INJECTION_KEY:n,COLLECTION_ITEM_INJECTION_KEY:r,ElCollection:s,ElCollectionItem:a}},ZBe=Ke({style:{type:xe([String,Array,Object])},currentTabId:{type:xe(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:xe(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:QBe,ElCollectionItem:JBe,COLLECTION_INJECTION_KEY:D9,COLLECTION_ITEM_INJECTION_KEY:eze}=Lle("RovingFocusGroup"),k9=Symbol("elRovingFocusGroup"),Dle=Symbol("elRovingFocusGroupItem"),tze={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},ize=(i,e)=>{if(e!=="rtl")return i;switch(i){case wt.right:return wt.left;case wt.left:return wt.right;default:return i}},nze=(i,e,t)=>{const n=ize(i.key,t);if(!(e==="vertical"&&[wt.left,wt.right].includes(n))&&!(e==="horizontal"&&[wt.up,wt.down].includes(n)))return tze[n]},rze=(i,e)=>i.map((t,n)=>i[(n+e)%i.length]),F9=i=>{const{activeElement:e}=document;for(const t of i)if(t===e||(t.focus(),e!==document.activeElement))return},Jq="currentTabIdChange",eK="rovingFocusGroup.entryFocus",sze={bubbles:!1,cancelable:!0},aze=de({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:ZBe,emits:[Jq,"entryFocus"],setup(i,{emit:e}){var t;const n=W((t=i.currentTabId||i.defaultCurrentTabId)!=null?t:null),r=W(!1),s=W(!1),a=W(null),{getItems:o}=ht(D9,void 0),l=R(()=>[{outline:"none"},i.style]),c=g=>{e(Jq,g)},u=()=>{r.value=!0},d=Hr(g=>{var _;(_=i.onMousedown)==null||_.call(i,g)},()=>{s.value=!0}),h=Hr(g=>{var _;(_=i.onFocus)==null||_.call(i,g)},g=>{const _=!v(s),{target:b,currentTarget:x}=g;if(b===x&&_&&!v(r)){const w=new Event(eK,sze);if(x==null||x.dispatchEvent(w),!w.defaultPrevented){const C=o().filter(O=>O.focusable),S=C.find(O=>O.active),E=C.find(O=>O.id===v(n)),P=[S,E,...C].filter(Boolean).map(O=>O.ref);F9(P)}}s.value=!1}),p=Hr(g=>{var _;(_=i.onBlur)==null||_.call(i,g)},()=>{r.value=!1}),m=(...g)=>{e("entryFocus",...g)};pi(k9,{currentTabbedId:FC(n),loop:kr(i,"loop"),tabIndex:R(()=>v(r)?-1:0),rovingFocusGroupRef:a,rovingFocusGroupRootStyle:l,orientation:kr(i,"orientation"),dir:kr(i,"dir"),onItemFocus:c,onItemShiftTab:u,onBlur:p,onFocus:h,onMousedown:d}),Ve(()=>i.currentTabId,g=>{n.value=g??null}),mr(a,eK,m)}});function oze(i,e,t,n,r,s){return Fe(i.$slots,"default")}var lze=qe(aze,[["render",oze],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group-impl.vue"]]);const cze=de({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:QBe,ElRovingFocusGroupImpl:lze}});function uze(i,e,t,n,r,s){const a=jt("el-roving-focus-group-impl"),o=jt("el-focus-group-collection");return I(),Se(o,null,{default:pe(()=>[re(a,mh(v3(i.$attrs)),{default:pe(()=>[Fe(i.$slots,"default")]),_:3},16)]),_:3})}var dze=qe(cze,[["render",uze],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-group.vue"]]);const hze=de({components:{ElRovingFocusCollectionItem:JBe},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(i,{emit:e}){const{currentTabbedId:t,loop:n,onItemFocus:r,onItemShiftTab:s}=ht(k9,void 0),{getItems:a}=ht(D9,void 0),o=Ih(),l=W(null),c=Hr(p=>{e("mousedown",p)},p=>{i.focusable?r(v(o)):p.preventDefault()}),u=Hr(p=>{e("focus",p)},()=>{r(v(o))}),d=Hr(p=>{e("keydown",p)},p=>{const{key:m,shiftKey:g,target:_,currentTarget:b}=p;if(m===wt.tab&&g){s();return}if(_!==b)return;const x=nze(p);if(x){p.preventDefault();let C=a().filter(S=>S.focusable).map(S=>S.ref);switch(x){case"last":{C.reverse();break}case"prev":case"next":{x==="prev"&&C.reverse();const S=C.indexOf(b);C=n.value?rze(C,S+1):C.slice(S+1);break}}ut(()=>{F9(C)})}}),h=R(()=>t.value===v(o));return pi(Dle,{rovingFocusGroupItemRef:l,tabIndex:R(()=>v(h)?0:-1),handleMousedown:c,handleFocus:u,handleKeydown:d}),{id:o,handleKeydown:d,handleFocus:u,handleMousedown:c}}});function pze(i,e,t,n,r,s){const a=jt("el-roving-focus-collection-item");return I(),Se(a,{id:i.id,focusable:i.focusable,active:i.active},{default:pe(()=>[Fe(i.$slots,"default")]),_:3},8,["id","focusable","active"])}var fze=qe(hze,[["render",pze],["__file","/home/runner/work/element-plus/element-plus/packages/components/roving-focus-group/src/roving-focus-item.vue"]]);const ER=Ke({trigger:q2.trigger,effect:{...Xa.effect,default:"light"},type:{type:xe(String)},placement:{type:xe(String),default:"bottom"},popperOptions:{type:xe(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:xe([Number,String]),default:0},maxHeight:{type:xe([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:xe(Object)},teleported:Xa.teleported}),kle=Ke({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:Zn}}),mze=Ke({onKeydown:{type:xe(Function)}}),gze=[wt.down,wt.pageDown,wt.home],Fle=[wt.up,wt.pageUp,wt.end],vze=[...gze,...Fle],{ElCollection:yze,ElCollectionItem:_ze,COLLECTION_INJECTION_KEY:bze,COLLECTION_ITEM_INJECTION_KEY:wze}=Lle("Dropdown"),H3=Symbol("elDropdown"),{ButtonGroup:xze}=Bo,Cze=de({name:"ElDropdown",components:{ElButton:Bo,ElButtonGroup:xze,ElScrollbar:_g,ElDropdownCollection:yze,ElTooltip:Jl,ElRovingFocusGroup:dze,ElOnlyChild:Toe,ElIcon:ct,ArrowDown:Fy},props:ER,emits:["visible-change","click","command"],setup(i,{emit:e}){const t=ti(),n=Ne("dropdown"),{t:r}=Ki(),s=W(),a=W(),o=W(null),l=W(null),c=W(null),u=W(null),d=W(!1),h=[wt.enter,wt.space,wt.down],p=R(()=>({maxHeight:Xs(i.maxHeight)})),m=R(()=>[n.m(C.value)]),g=Ih().value,_=R(()=>i.id||g);function b(){x()}function x(){var H;(H=o.value)==null||H.onClose()}function w(){var H;(H=o.value)==null||H.onOpen()}const C=Qs();function S(...H){e("command",...H)}function E(){}function A(){const H=v(l);H==null||H.focus(),u.value=null}function P(H){u.value=H}function O(H){d.value||(H.preventDefault(),H.stopImmediatePropagation())}function M(){e("visible-change",!0)}function V(H){(H==null?void 0:H.type)==="keydown"&&l.value.focus()}function L(){e("visible-change",!1)}return pi(H3,{contentRef:l,role:R(()=>i.role),triggerId:_,isUsingKeyboard:d,onItemEnter:E,onItemLeave:A}),pi("elDropdown",{instance:t,dropdownSize:C,handleClick:b,commandHandler:S,trigger:kr(i,"trigger"),hideOnClick:kr(i,"hideOnClick")}),{t:r,ns:n,scrollbar:c,wrapStyle:p,dropdownTriggerKls:m,dropdownSize:C,triggerId:_,triggerKeys:h,currentTabId:u,handleCurrentTabIdChange:P,handlerMainButtonClick:H=>{e("click",H)},handleEntryFocus:O,handleClose:x,handleOpen:w,handleBeforeShowTooltip:M,handleShowTooltip:V,handleBeforeHideTooltip:L,onFocusAfterTrapped:H=>{var k,D;H.preventDefault(),(D=(k=l.value)==null?void 0:k.focus)==null||D.call(k,{preventScroll:!0})},popperRef:o,contentRef:l,triggeringElementRef:s,referenceElementRef:a}}});function Tze(i,e,t,n,r,s){var a;const o=jt("el-dropdown-collection"),l=jt("el-roving-focus-group"),c=jt("el-scrollbar"),u=jt("el-only-child"),d=jt("el-tooltip"),h=jt("el-button"),p=jt("arrow-down"),m=jt("el-icon"),g=jt("el-button-group");return I(),Z("div",{class:N([i.ns.b(),i.ns.is("disabled",i.disabled)])},[re(d,{ref:"popperRef",role:i.role,effect:i.effect,"fallback-placements":["bottom","top"],"popper-options":i.popperOptions,"gpu-acceleration":!1,"hide-after":i.trigger==="hover"?i.hideTimeout:0,"manual-mode":!0,placement:i.placement,"popper-class":[i.ns.e("popper"),i.popperClass],"reference-element":(a=i.referenceElementRef)==null?void 0:a.$el,trigger:i.trigger,"trigger-keys":i.triggerKeys,"trigger-target-el":i.contentRef,"show-after":i.trigger==="hover"?i.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":i.triggeringElementRef,"virtual-triggering":i.splitButton,disabled:i.disabled,transition:`${i.ns.namespace.value}-zoom-in-top`,teleported:i.teleported,pure:"",persistent:"",onBeforeShow:i.handleBeforeShowTooltip,onShow:i.handleShowTooltip,onBeforeHide:i.handleBeforeHideTooltip},qm({content:pe(()=>[re(c,{ref:"scrollbar","wrap-style":i.wrapStyle,tag:"div","view-class":i.ns.e("list")},{default:pe(()=>[re(l,{loop:i.loop,"current-tab-id":i.currentTabId,orientation:"horizontal",onCurrentTabIdChange:i.handleCurrentTabIdChange,onEntryFocus:i.handleEntryFocus},{default:pe(()=>[re(o,null,{default:pe(()=>[Fe(i.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[i.splitButton?void 0:{name:"default",fn:pe(()=>[re(u,{id:i.triggerId,role:"button",tabindex:i.tabindex},{default:pe(()=>[Fe(i.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),i.splitButton?(I(),Se(g,{key:0},{default:pe(()=>[re(h,ci({ref:"referenceElementRef"},i.buttonProps,{size:i.dropdownSize,type:i.type,disabled:i.disabled,tabindex:i.tabindex,onClick:i.handlerMainButtonClick}),{default:pe(()=>[Fe(i.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),re(h,ci({id:i.triggerId,ref:"triggeringElementRef"},i.buttonProps,{role:"button",size:i.dropdownSize,type:i.type,class:i.ns.e("caret-button"),disabled:i.disabled,tabindex:i.tabindex,"aria-label":i.t("el.dropdown.toggleDropdown")}),{default:pe(()=>[re(m,{class:N(i.ns.e("icon"))},{default:pe(()=>[re(p)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):_e("v-if",!0)],2)}var Sze=qe(Cze,[["render",Tze],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown.vue"]]);const Eze=de({name:"DropdownItemImpl",components:{ElIcon:ct},props:kle,emits:["pointermove","pointerleave","click","clickimpl"],setup(i,{emit:e}){const t=Ne("dropdown"),{role:n}=ht(H3,void 0),{collectionItemRef:r}=ht(wze,void 0),{collectionItemRef:s}=ht(eze,void 0),{rovingFocusGroupItemRef:a,tabIndex:o,handleFocus:l,handleKeydown:c,handleMousedown:u}=ht(Dle,void 0),d=P3(r,s,a),h=R(()=>n.value==="menu"?"menuitem":n.value==="navigation"?"link":"button"),p=Hr(m=>{const{code:g}=m;if(g===wt.enter||g===wt.space)return m.preventDefault(),m.stopImmediatePropagation(),e("clickimpl",m),!0},c);return{ns:t,itemRef:d,dataset:{[$le]:""},role:h,tabIndex:o,handleFocus:l,handleKeydown:p,handleMousedown:u}}}),Aze=["aria-disabled","tabindex","role"];function Mze(i,e,t,n,r,s){const a=jt("el-icon");return I(),Z(gt,null,[i.divided?(I(),Z("li",ci({key:0,role:"separator",class:i.ns.bem("menu","item","divided")},i.$attrs),null,16)):_e("v-if",!0),Q("li",ci({ref:i.itemRef},{...i.dataset,...i.$attrs},{"aria-disabled":i.disabled,class:[i.ns.be("menu","item"),i.ns.is("disabled",i.disabled)],tabindex:i.tabIndex,role:i.role,onClick:e[0]||(e[0]=o=>i.$emit("clickimpl",o)),onFocus:e[1]||(e[1]=(...o)=>i.handleFocus&&i.handleFocus(...o)),onKeydown:e[2]||(e[2]=(...o)=>i.handleKeydown&&i.handleKeydown(...o)),onMousedown:e[3]||(e[3]=(...o)=>i.handleMousedown&&i.handleMousedown(...o)),onPointermove:e[4]||(e[4]=o=>i.$emit("pointermove",o)),onPointerleave:e[5]||(e[5]=o=>i.$emit("pointerleave",o))}),[i.icon?(I(),Se(a,{key:0},{default:pe(()=>[(I(),Se(hi(i.icon)))]),_:1})):_e("v-if",!0),Fe(i.$slots,"default")],16,Aze)],64)}var Pze=qe(Eze,[["render",Mze],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item-impl.vue"]]);const Nle=()=>{const i=ht("elDropdown",{}),e=R(()=>i==null?void 0:i.dropdownSize);return{elDropdown:i,_elDropdownSize:e}},Oze=de({name:"ElDropdownItem",components:{ElDropdownCollectionItem:_ze,ElRovingFocusItem:fze,ElDropdownItemImpl:Pze},inheritAttrs:!1,props:kle,emits:["pointermove","pointerleave","click"],setup(i,{emit:e,attrs:t}){const{elDropdown:n}=Nle(),r=ti(),s=W(null),a=R(()=>{var p,m;return(m=(p=v(s))==null?void 0:p.textContent)!=null?m:""}),{onItemEnter:o,onItemLeave:l}=ht(H3,void 0),c=Hr(p=>(e("pointermove",p),p.defaultPrevented),Fj(p=>{var m;i.disabled?l(p):(o(p),p.defaultPrevented||(m=p.currentTarget)==null||m.focus())})),u=Hr(p=>(e("pointerleave",p),p.defaultPrevented),Fj(p=>{l(p)})),d=Hr(p=>{if(!i.disabled)return e("click",p),p.type!=="keydown"&&p.defaultPrevented},p=>{var m,g,_;if(i.disabled){p.stopImmediatePropagation();return}(m=n==null?void 0:n.hideOnClick)!=null&&m.value&&((g=n.handleClick)==null||g.call(n)),(_=n.commandHandler)==null||_.call(n,i.command,r,p)}),h=R(()=>({...i,...t}));return{handleClick:d,handlePointerMove:c,handlePointerLeave:u,textContent:a,propsAndAttrs:h}}});function Rze(i,e,t,n,r,s){var a;const o=jt("el-dropdown-item-impl"),l=jt("el-roving-focus-item"),c=jt("el-dropdown-collection-item");return I(),Se(c,{disabled:i.disabled,"text-value":(a=i.textValue)!=null?a:i.textContent},{default:pe(()=>[re(l,{focusable:!i.disabled},{default:pe(()=>[re(o,ci(i.propsAndAttrs,{onPointerleave:i.handlePointerLeave,onPointermove:i.handlePointerMove,onClickimpl:i.handleClick}),{default:pe(()=>[Fe(i.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var Vle=qe(Oze,[["render",Rze],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-item.vue"]]);const Ize=de({name:"ElDropdownMenu",props:mze,setup(i){const e=Ne("dropdown"),{_elDropdownSize:t}=Nle(),n=t.value,{focusTrapRef:r,onKeydown:s}=ht(S9,void 0),{contentRef:a,role:o,triggerId:l}=ht(H3,void 0),{collectionRef:c,getItems:u}=ht(bze,void 0),{rovingFocusGroupRef:d,rovingFocusGroupRootStyle:h,tabIndex:p,onBlur:m,onFocus:g,onMousedown:_}=ht(k9,void 0),{collectionRef:b}=ht(D9,void 0),x=R(()=>[e.b("menu"),e.bm("menu",n==null?void 0:n.value)]),w=P3(a,c,r,d,b),C=Hr(E=>{var A;(A=i.onKeydown)==null||A.call(i,E)},E=>{const{currentTarget:A,code:P,target:O}=E;if(A.contains(O),wt.tab===P&&E.stopImmediatePropagation(),E.preventDefault(),O!==v(a)||!vze.includes(P))return;const V=u().filter(L=>!L.disabled).map(L=>L.ref);Fle.includes(P)&&V.reverse(),F9(V)});return{size:n,rovingFocusGroupRootStyle:h,tabIndex:p,dropdownKls:x,role:o,triggerId:l,dropdownListWrapperRef:w,handleKeydown:E=>{C(E),s(E)},onBlur:m,onFocus:g,onMousedown:_}}}),$ze=["role","aria-labelledby"];function Lze(i,e,t,n,r,s){return I(),Z("ul",{ref:i.dropdownListWrapperRef,class:N(i.dropdownKls),style:pt(i.rovingFocusGroupRootStyle),tabindex:-1,role:i.role,"aria-labelledby":i.triggerId,onBlur:e[0]||(e[0]=(...a)=>i.onBlur&&i.onBlur(...a)),onFocus:e[1]||(e[1]=(...a)=>i.onFocus&&i.onFocus(...a)),onKeydown:e[2]||(e[2]=(...a)=>i.handleKeydown&&i.handleKeydown(...a)),onMousedown:e[3]||(e[3]=(...a)=>i.onMousedown&&i.onMousedown(...a))},[Fe(i.$slots,"default")],46,$ze)}var Ble=qe(Ize,[["render",Lze],["__file","/home/runner/work/element-plus/element-plus/packages/components/dropdown/src/dropdown-menu.vue"]]);const Dze=ii(Sze,{DropdownItem:Vle,DropdownMenu:Ble}),kze=Wr(Vle),Fze=Wr(Ble);let Nze=0;const Vze=de({name:"ImgEmpty",setup(){return{ns:Ne("empty"),id:++Nze}}}),Bze={viewBox:"0 0 79 86",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},zze=["id"],Uze=["stop-color"],Hze=["stop-color"],Gze=["id"],Wze=["stop-color"],jze=["stop-color"],qze=["id"],Kze={id:"Illustrations",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},Yze={id:"B-type",transform:"translate(-1268.000000, -535.000000)"},Xze={id:"Group-2",transform:"translate(1268.000000, 535.000000)"},Zze=["fill"],Qze=["fill"],Jze={id:"Group-Copy",transform:"translate(34.500000, 31.500000) scale(-1, 1) rotate(-25.000000) translate(-34.500000, -31.500000) translate(7.000000, 10.000000)"},e9e=["fill"],t9e=["fill"],i9e=["fill"],n9e=["fill"],r9e=["fill"],s9e={id:"Rectangle-Copy-17",transform:"translate(53.000000, 45.000000)"},a9e=["fill","xlink:href"],o9e=["fill","mask"],l9e=["fill"];function c9e(i,e,t,n,r,s){return I(),Z("svg",Bze,[Q("defs",null,[Q("linearGradient",{id:`linearGradient-1-${i.id}`,x1:"38.8503086%",y1:"0%",x2:"61.1496914%",y2:"100%"},[Q("stop",{"stop-color":`var(${i.ns.cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,Uze),Q("stop",{"stop-color":`var(${i.ns.cssVarBlockName("fill-color-4")})`,offset:"100%"},null,8,Hze)],8,zze),Q("linearGradient",{id:`linearGradient-2-${i.id}`,x1:"0%",y1:"9.5%",x2:"100%",y2:"90.5%"},[Q("stop",{"stop-color":`var(${i.ns.cssVarBlockName("fill-color-1")})`,offset:"0%"},null,8,Wze),Q("stop",{"stop-color":`var(${i.ns.cssVarBlockName("fill-color-6")})`,offset:"100%"},null,8,jze)],8,Gze),Q("rect",{id:`path-3-${i.id}`,x:"0",y:"0",width:"17",height:"36"},null,8,qze)]),Q("g",Kze,[Q("g",Yze,[Q("g",Xze,[Q("path",{id:"Oval-Copy-2",d:"M39.5,86 C61.3152476,86 79,83.9106622 79,81.3333333 C79,78.7560045 57.3152476,78 35.5,78 C13.6847524,78 0,78.7560045 0,81.3333333 C0,83.9106622 17.6847524,86 39.5,86 Z",fill:`var(${i.ns.cssVarBlockName("fill-color-3")})`},null,8,Zze),Q("polygon",{id:"Rectangle-Copy-14",fill:`var(${i.ns.cssVarBlockName("fill-color-7")})`,transform:"translate(27.500000, 51.500000) scale(1, -1) translate(-27.500000, -51.500000) ",points:"13 58 53 58 42 45 2 45"},null,8,Qze),Q("g",Jze,[Q("polygon",{id:"Rectangle-Copy-10",fill:`var(${i.ns.cssVarBlockName("fill-color-7")})`,transform:"translate(11.500000, 5.000000) scale(1, -1) translate(-11.500000, -5.000000) ",points:"2.84078316e-14 3 18 3 23 7 5 7"},null,8,e9e),Q("polygon",{id:"Rectangle-Copy-11",fill:`var(${i.ns.cssVarBlockName("fill-color-5")})`,points:"-3.69149156e-15 7 38 7 38 43 -3.69149156e-15 43"},null,8,t9e),Q("rect",{id:"Rectangle-Copy-12",fill:`url(#linearGradient-1-${i.id})`,transform:"translate(46.500000, 25.000000) scale(-1, 1) translate(-46.500000, -25.000000) ",x:"38",y:"7",width:"17",height:"36"},null,8,i9e),Q("polygon",{id:"Rectangle-Copy-13",fill:`var(${i.ns.cssVarBlockName("fill-color-2")})`,transform:"translate(39.500000, 3.500000) scale(-1, 1) translate(-39.500000, -3.500000) ",points:"24 7 41 7 55 -3.63806207e-12 38 -3.63806207e-12"},null,8,n9e)]),Q("rect",{id:"Rectangle-Copy-15",fill:`url(#linearGradient-2-${i.id})`,x:"13",y:"45",width:"40",height:"36"},null,8,r9e),Q("g",s9e,[Q("use",{id:"Mask",fill:`var(${i.ns.cssVarBlockName("fill-color-8")})`,transform:"translate(8.500000, 18.000000) scale(-1, 1) translate(-8.500000, -18.000000) ","xlink:href":`#path-3-${i.id}`},null,8,a9e),Q("polygon",{id:"Rectangle-Copy",fill:`var(${i.ns.cssVarBlockName("fill-color-9")})`,mask:`url(#mask-4-${i.id})`,transform:"translate(12.000000, 9.000000) scale(-1, 1) translate(-12.000000, -9.000000) ",points:"7 0 24 0 20 18 7 16.5"},null,8,o9e)]),Q("polygon",{id:"Rectangle-Copy-18",fill:`var(${i.ns.cssVarBlockName("fill-color-2")})`,transform:"translate(66.000000, 51.500000) scale(-1, 1) translate(-66.000000, -51.500000) ",points:"62 45 79 45 70 58 53 58"},null,8,l9e)])])])])}var u9e=qe(Vze,[["render",c9e],["__file","/home/runner/work/element-plus/element-plus/packages/components/empty/src/img-empty.vue"]]);const d9e={image:{type:String,default:""},imageSize:Number,description:{type:String,default:""}},h9e=["src"],p9e={key:1},f9e=de({name:"ElEmpty"}),m9e=de({...f9e,props:d9e,setup(i){const e=i,{t}=Ki(),n=Ne("empty"),r=R(()=>e.description||t("el.table.emptyText")),s=R(()=>({width:e.imageSize?`${e.imageSize}px`:""}));return(a,o)=>(I(),Z("div",{class:N(v(n).b())},[Q("div",{class:N(v(n).e("image")),style:pt(v(s))},[a.image?(I(),Z("img",{key:0,src:a.image,ondragstart:"return false"},null,8,h9e)):Fe(a.$slots,"image",{key:1},()=>[re(u9e)])],6),Q("div",{class:N(v(n).e("description"))},[a.$slots.description?Fe(a.$slots,"description",{key:0}):(I(),Z("p",p9e,We(v(r)),1))],2),a.$slots.default?(I(),Z("div",{key:0,class:N(v(n).e("bottom"))},[Fe(a.$slots,"default")],2)):_e("v-if",!0)],2))}});var g9e=qe(m9e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/empty/src/empty.vue"]]);const zle=ii(g9e),v9e=Ke({model:Object,rules:{type:xe(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},size:{type:String,values:gg},disabled:Boolean,validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:{type:Boolean,default:!1},scrollToError:Boolean}),y9e={validate:(i,e,t)=>(st(i)||Ft(i))&&Ys(e)&&Ft(t)};function _9e(){const i=W([]),e=R(()=>{if(!i.value.length)return"0";const s=Math.max(...i.value);return s?`${s}px`:""});function t(s){const a=i.value.indexOf(s);return a===-1&&e.value,a}function n(s,a){if(s&&a){const o=t(a);i.value.splice(o,1,s)}else s&&i.value.push(s)}function r(s){const a=t(s);a>-1&&i.value.splice(a,1)}return{autoLabelWidth:e,registerLabelWidth:n,deregisterLabelWidth:r}}const rP=(i,e)=>{const t=nC(e);return t.length>0?i.filter(n=>n.prop&&t.includes(n.prop)):i},b9e="ElForm",w9e=de({name:b9e}),x9e=de({...w9e,props:v9e,emits:y9e,setup(i,{expose:e,emit:t}){const n=i,r=[],s=Qs(),a=Ne("form"),o=R(()=>{const{labelPosition:x,inline:w}=n;return[a.b(),a.m(s.value||"default"),{[a.m(`label-${x}`)]:x,[a.m("inline")]:w}]}),l=x=>{r.push(x)},c=x=>{x.prop&&r.splice(r.indexOf(x),1)},u=(x=[])=>{n.model&&rP(r,x).forEach(w=>w.resetField())},d=(x=[])=>{rP(r,x).forEach(w=>w.clearValidate())},h=R(()=>!!n.model),p=x=>{if(r.length===0)return[];const w=rP(r,x);return w.length?w:[]},m=async x=>_(void 0,x),g=async(x=[])=>{if(!h.value)return!1;const w=p(x);if(w.length===0)return!0;let C={};for(const S of w)try{await S.validate("")}catch(E){C={...C,...E}}return Object.keys(C).length===0?!0:Promise.reject(C)},_=async(x=[],w)=>{const C=!Lt(w);try{const S=await g(x);return S===!0&&(w==null||w(S)),S}catch(S){if(S instanceof Error)throw S;const E=S;return n.scrollToError&&b(Object.keys(E)[0]),w==null||w(!1,E),C&&Promise.reject(E)}},b=x=>{var w;const C=rP(r,x)[0];C&&((w=C.$el)==null||w.scrollIntoView())};return Ve(()=>n.rules,()=>{n.validateOnRuleChange&&m().catch(x=>void 0)},{deep:!0}),pi(Rb,Ji({..._a(n),emit:t,resetFields:u,clearValidate:d,validateField:_,addField:l,removeField:c,..._9e()})),e({validate:m,validateField:_,resetFields:u,clearValidate:d,scrollToField:b}),(x,w)=>(I(),Z("form",{class:N(v(o))},[Fe(x.$slots,"default")],2))}});var C9e=qe(x9e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);function w0(){return w0=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},w0.apply(this,arguments)}function T9e(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,Z2(i,e)}function oV(i){return oV=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oV(i)}function Z2(i,e){return Z2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Z2(i,e)}function S9e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function AR(i,e,t){return S9e()?AR=Reflect.construct.bind():AR=function(r,s,a){var o=[null];o.push.apply(o,s);var l=Function.bind.apply(r,o),c=new l;return a&&Z2(c,a.prototype),c},AR.apply(null,arguments)}function E9e(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function lV(i){var e=typeof Map=="function"?new Map:void 0;return lV=function(n){if(n===null||!E9e(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof e<"u"){if(e.has(n))return e.get(n);e.set(n,r)}function r(){return AR(n,arguments,oV(this).constructor)}return r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Z2(r,n)},lV(i)}var A9e=/%[sdj%]/g,M9e=function(){};typeof process<"u"&&process.env;function cV(i){if(!i||!i.length)return null;var e={};return i.forEach(function(t){var n=t.field;e[n]=e[n]||[],e[n].push(t)}),e}function Pu(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];var r=0,s=t.length;if(typeof i=="function")return i.apply(null,t);if(typeof i=="string"){var a=i.replace(A9e,function(o){if(o==="%%")return"%";if(r>=s)return o;switch(o){case"%s":return String(t[r++]);case"%d":return Number(t[r++]);case"%j":try{return JSON.stringify(t[r++])}catch{return"[Circular]"}break;default:return o}});return a}return i}function P9e(i){return i==="string"||i==="url"||i==="hex"||i==="email"||i==="date"||i==="pattern"}function Va(i,e){return!!(i==null||e==="array"&&Array.isArray(i)&&!i.length||P9e(e)&&typeof i=="string"&&!i)}function O9e(i,e,t){var n=[],r=0,s=i.length;function a(o){n.push.apply(n,o||[]),r++,r===s&&t(n)}i.forEach(function(o){e(o,a)})}function tK(i,e,t){var n=0,r=i.length;function s(a){if(a&&a.length){t(a);return}var o=n;n=n+1,o<r?e(i[o],s):t([])}s([])}function R9e(i){var e=[];return Object.keys(i).forEach(function(t){e.push.apply(e,i[t]||[])}),e}var iK=function(i){T9e(e,i);function e(t,n){var r;return r=i.call(this,"Async Validation Error")||this,r.errors=t,r.fields=n,r}return e}(lV(Error));function I9e(i,e,t,n,r){if(e.first){var s=new Promise(function(h,p){var m=function(b){return n(b),b.length?p(new iK(b,cV(b))):h(r)},g=R9e(i);tK(g,t,m)});return s.catch(function(h){return h}),s}var a=e.firstFields===!0?Object.keys(i):e.firstFields||[],o=Object.keys(i),l=o.length,c=0,u=[],d=new Promise(function(h,p){var m=function(_){if(u.push.apply(u,_),c++,c===l)return n(u),u.length?p(new iK(u,cV(u))):h(r)};o.length||(n(u),h(r)),o.forEach(function(g){var _=i[g];a.indexOf(g)!==-1?tK(_,t,m):O9e(_,t,m)})});return d.catch(function(h){return h}),d}function $9e(i){return!!(i&&i.message!==void 0)}function L9e(i,e){for(var t=i,n=0;n<e.length;n++){if(t==null)return t;t=t[e[n]]}return t}function nK(i,e){return function(t){var n;return i.fullFields?n=L9e(e,i.fullFields):n=e[t.field||i.fullField],$9e(t)?(t.field=t.field||i.fullField,t.fieldValue=n,t):{message:typeof t=="function"?t():t,fieldValue:n,field:t.field||i.fullField}}}function rK(i,e){if(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];typeof n=="object"&&typeof i[t]=="object"?i[t]=w0({},i[t],n):i[t]=n}}return i}var Ule=function(e,t,n,r,s,a){e.required&&(!n.hasOwnProperty(e.field)||Va(t,a||e.type))&&r.push(Pu(s.messages.required,e.fullField))},D9e=function(e,t,n,r,s){(/^\s+$/.test(t)||t==="")&&r.push(Pu(s.messages.whitespace,e.fullField))},sP,k9e=function(){if(sP)return sP;var i="[a-fA-F\\d:]",e=function(C){return C&&C.includeBoundaries?"(?:(?<=\\s|^)(?="+i+")|(?<="+i+")(?=\\s|$))":""},t="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",r=(`
(?:
(?:`+n+":){7}(?:"+n+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+n+":){6}(?:"+t+"|:"+n+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+n+":){5}(?::"+t+"|(?::"+n+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+n+":){4}(?:(?::"+n+"){0,1}:"+t+"|(?::"+n+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+n+":){3}(?:(?::"+n+"){0,2}:"+t+"|(?::"+n+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+n+":){2}(?:(?::"+n+"){0,3}:"+t+"|(?::"+n+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+n+":){1}(?:(?::"+n+"){0,4}:"+t+"|(?::"+n+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+n+"){0,5}:"+t+"|(?::"+n+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),s=new RegExp("(?:^"+t+"$)|(?:^"+r+"$)"),a=new RegExp("^"+t+"$"),o=new RegExp("^"+r+"$"),l=function(C){return C&&C.exact?s:new RegExp("(?:"+e(C)+t+e(C)+")|(?:"+e(C)+r+e(C)+")","g")};l.v4=function(w){return w&&w.exact?a:new RegExp(""+e(w)+t+e(w),"g")},l.v6=function(w){return w&&w.exact?o:new RegExp(""+e(w)+r+e(w),"g")};var c="(?:(?:[a-z]+:)?//)",u="(?:\\S+(?::\\S*)?@)?",d=l.v4().source,h=l.v6().source,p="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",m="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",g="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",_="(?::\\d{2,5})?",b='(?:[/?#][^\\s"]*)?',x="(?:"+c+"|www\\.)"+u+"(?:localhost|"+d+"|"+h+"|"+p+m+g+")"+_+b;return sP=new RegExp("(?:^"+x+"$)","i"),sP},sK={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},pS={integer:function(e){return pS.number(e)&&parseInt(e,10)===e},float:function(e){return pS.number(e)&&!pS.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch{return!1}},date:function(e){return typeof e.getTime=="function"&&typeof e.getMonth=="function"&&typeof e.getYear=="function"&&!isNaN(e.getTime())},number:function(e){return isNaN(e)?!1:typeof e=="number"},object:function(e){return typeof e=="object"&&!pS.array(e)},method:function(e){return typeof e=="function"},email:function(e){return typeof e=="string"&&e.length<=320&&!!e.match(sK.email)},url:function(e){return typeof e=="string"&&e.length<=2048&&!!e.match(k9e())},hex:function(e){return typeof e=="string"&&!!e.match(sK.hex)}},F9e=function(e,t,n,r,s){if(e.required&&t===void 0){Ule(e,t,n,r,s);return}var a=["integer","float","array","regexp","object","method","email","number","date","url","hex"],o=e.type;a.indexOf(o)>-1?pS[o](t)||r.push(Pu(s.messages.types[o],e.fullField,e.type)):o&&typeof t!==e.type&&r.push(Pu(s.messages.types[o],e.fullField,e.type))},N9e=function(e,t,n,r,s){var a=typeof e.len=="number",o=typeof e.min=="number",l=typeof e.max=="number",c=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,u=t,d=null,h=typeof t=="number",p=typeof t=="string",m=Array.isArray(t);if(h?d="number":p?d="string":m&&(d="array"),!d)return!1;m&&(u=t.length),p&&(u=t.replace(c,"_").length),a?u!==e.len&&r.push(Pu(s.messages[d].len,e.fullField,e.len)):o&&!l&&u<e.min?r.push(Pu(s.messages[d].min,e.fullField,e.min)):l&&!o&&u>e.max?r.push(Pu(s.messages[d].max,e.fullField,e.max)):o&&l&&(u<e.min||u>e.max)&&r.push(Pu(s.messages[d].range,e.fullField,e.min,e.max))},Zb="enum",V9e=function(e,t,n,r,s){e[Zb]=Array.isArray(e[Zb])?e[Zb]:[],e[Zb].indexOf(t)===-1&&r.push(Pu(s.messages[Zb],e.fullField,e[Zb].join(", ")))},B9e=function(e,t,n,r,s){if(e.pattern){if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||r.push(Pu(s.messages.pattern.mismatch,e.fullField,t,e.pattern));else if(typeof e.pattern=="string"){var a=new RegExp(e.pattern);a.test(t)||r.push(Pu(s.messages.pattern.mismatch,e.fullField,t,e.pattern))}}},Tn={required:Ule,whitespace:D9e,type:F9e,range:N9e,enum:V9e,pattern:B9e},z9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t,"string")&&!e.required)return n();Tn.required(e,t,r,a,s,"string"),Va(t,"string")||(Tn.type(e,t,r,a,s),Tn.range(e,t,r,a,s),Tn.pattern(e,t,r,a,s),e.whitespace===!0&&Tn.whitespace(e,t,r,a,s))}n(a)},U9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),t!==void 0&&Tn.type(e,t,r,a,s)}n(a)},H9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(t===""&&(t=void 0),Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),t!==void 0&&(Tn.type(e,t,r,a,s),Tn.range(e,t,r,a,s))}n(a)},G9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),t!==void 0&&Tn.type(e,t,r,a,s)}n(a)},W9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),Va(t)||Tn.type(e,t,r,a,s)}n(a)},j9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),t!==void 0&&(Tn.type(e,t,r,a,s),Tn.range(e,t,r,a,s))}n(a)},q9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),t!==void 0&&(Tn.type(e,t,r,a,s),Tn.range(e,t,r,a,s))}n(a)},K9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(t==null&&!e.required)return n();Tn.required(e,t,r,a,s,"array"),t!=null&&(Tn.type(e,t,r,a,s),Tn.range(e,t,r,a,s))}n(a)},Y9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),t!==void 0&&Tn.type(e,t,r,a,s)}n(a)},X9e="enum",Z9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s),t!==void 0&&Tn[X9e](e,t,r,a,s)}n(a)},Q9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t,"string")&&!e.required)return n();Tn.required(e,t,r,a,s),Va(t,"string")||Tn.pattern(e,t,r,a,s)}n(a)},J9e=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t,"date")&&!e.required)return n();if(Tn.required(e,t,r,a,s),!Va(t,"date")){var l;t instanceof Date?l=t:l=new Date(t),Tn.type(e,l,r,a,s),l&&Tn.range(e,l.getTime(),r,a,s)}}n(a)},eUe=function(e,t,n,r,s){var a=[],o=Array.isArray(t)?"array":typeof t;Tn.required(e,t,r,a,s,o),n(a)},Pk=function(e,t,n,r,s){var a=e.type,o=[],l=e.required||!e.required&&r.hasOwnProperty(e.field);if(l){if(Va(t,a)&&!e.required)return n();Tn.required(e,t,r,o,s,a),Va(t,a)||Tn.type(e,t,r,o,s)}n(o)},tUe=function(e,t,n,r,s){var a=[],o=e.required||!e.required&&r.hasOwnProperty(e.field);if(o){if(Va(t)&&!e.required)return n();Tn.required(e,t,r,a,s)}n(a)},vE={string:z9e,method:U9e,number:H9e,boolean:G9e,regexp:W9e,integer:j9e,float:q9e,array:K9e,object:Y9e,enum:Z9e,pattern:Q9e,date:J9e,url:Pk,hex:Pk,email:Pk,required:eUe,any:tUe};function uV(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var dV=uV(),cM=function(){function i(t){this.rules=null,this._messages=dV,this.define(t)}var e=i.prototype;return e.define=function(n){var r=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(typeof n!="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(s){var a=n[s];r.rules[s]=Array.isArray(a)?a:[a]})},e.messages=function(n){return n&&(this._messages=rK(uV(),n)),this._messages},e.validate=function(n,r,s){var a=this;r===void 0&&(r={}),s===void 0&&(s=function(){});var o=n,l=r,c=s;if(typeof l=="function"&&(c=l,l={}),!this.rules||Object.keys(this.rules).length===0)return c&&c(null,o),Promise.resolve(o);function u(g){var _=[],b={};function x(C){if(Array.isArray(C)){var S;_=(S=_).concat.apply(S,C)}else _.push(C)}for(var w=0;w<g.length;w++)x(g[w]);_.length?(b=cV(_),c(_,b)):c(null,o)}if(l.messages){var d=this.messages();d===dV&&(d=uV()),rK(d,l.messages),l.messages=d}else l.messages=this.messages();var h={},p=l.keys||Object.keys(this.rules);p.forEach(function(g){var _=a.rules[g],b=o[g];_.forEach(function(x){var w=x;typeof w.transform=="function"&&(o===n&&(o=w0({},o)),b=o[g]=w.transform(b)),typeof w=="function"?w={validator:w}:w=w0({},w),w.validator=a.getValidationMethod(w),w.validator&&(w.field=g,w.fullField=w.fullField||g,w.type=a.getType(w),h[g]=h[g]||[],h[g].push({rule:w,value:b,source:o,field:g}))})});var m={};return I9e(h,l,function(g,_){var b=g.rule,x=(b.type==="object"||b.type==="array")&&(typeof b.fields=="object"||typeof b.defaultField=="object");x=x&&(b.required||!b.required&&g.value),b.field=g.field;function w(E,A){return w0({},A,{fullField:b.fullField+"."+E,fullFields:b.fullFields?[].concat(b.fullFields,[E]):[E]})}function C(E){E===void 0&&(E=[]);var A=Array.isArray(E)?E:[E];!l.suppressWarning&&A.length&&i.warning("async-validator:",A),A.length&&b.message!==void 0&&(A=[].concat(b.message));var P=A.map(nK(b,o));if(l.first&&P.length)return m[b.field]=1,_(P);if(!x)_(P);else{if(b.required&&!g.value)return b.message!==void 0?P=[].concat(b.message).map(nK(b,o)):l.error&&(P=[l.error(b,Pu(l.messages.required,b.field))]),_(P);var O={};b.defaultField&&Object.keys(g.value).map(function(L){O[L]=b.defaultField}),O=w0({},O,g.rule.fields);var M={};Object.keys(O).forEach(function(L){var U=O[L],G=Array.isArray(U)?U:[U];M[L]=G.map(w.bind(null,L))});var V=new i(M);V.messages(l.messages),g.rule.options&&(g.rule.options.messages=l.messages,g.rule.options.error=l.error),V.validate(g.value,g.rule.options||l,function(L){var U=[];P&&P.length&&U.push.apply(U,P),L&&L.length&&U.push.apply(U,L),_(U.length?U:null)})}}var S;if(b.asyncValidator)S=b.asyncValidator(b,g.value,C,g.source,l);else if(b.validator){try{S=b.validator(b,g.value,C,g.source,l)}catch(E){console.error==null||console.error(E),l.suppressValidatorError||setTimeout(function(){throw E},0),C(E.message)}S===!0?C():S===!1?C(typeof b.message=="function"?b.message(b.fullField||b.field):b.message||(b.fullField||b.field)+" fails"):S instanceof Array?C(S):S instanceof Error&&C(S.message)}S&&S.then&&S.then(function(){return C()},function(E){return C(E)})},function(g){u(g)},o)},e.getType=function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!vE.hasOwnProperty(n.type))throw new Error(Pu("Unknown rule type %s",n.type));return n.type||"string"},e.getValidationMethod=function(n){if(typeof n.validator=="function")return n.validator;var r=Object.keys(n),s=r.indexOf("message");return s!==-1&&r.splice(s,1),r.length===1&&r[0]==="required"?vE.required:vE[this.getType(n)]||void 0},i}();cM.register=function(e,t){if(typeof t!="function")throw new Error("Cannot register a validator by type, validator is not a function");vE[e]=t};cM.warning=M9e;cM.messages=dV;cM.validators=vE;const iUe=["","error","validating","success"],nUe=Ke({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:xe([String,Array])},required:{type:Boolean,default:void 0},rules:{type:xe([Object,Array])},error:String,validateStatus:{type:String,values:iUe},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:gg}}),aK="ElLabelWrap";var rUe=de({name:aK,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(i,{slots:e}){const t=ht(Rb,void 0),n=ht(uf);n||ba(aK,"usage: <el-form-item><label-wrap /></el-form-item>");const r=Ne("form"),s=W(),a=W(0),o=()=>{var u;if((u=s.value)!=null&&u.firstElementChild){const d=window.getComputedStyle(s.value.firstElementChild).width;return Math.ceil(Number.parseFloat(d))}else return 0},l=(u="update")=>{ut(()=>{e.default&&i.isAutoWidth&&(u==="update"?a.value=o():u==="remove"&&(t==null||t.deregisterLabelWidth(a.value)))})},c=()=>l("update");return qt(()=>{c()}),Vr(()=>{l("remove")}),pg(()=>c()),Ve(a,(u,d)=>{i.updateAll&&(t==null||t.registerLabelWidth(u,d))}),fl(R(()=>{var u,d;return(d=(u=s.value)==null?void 0:u.firstElementChild)!=null?d:null}),c),()=>{var u,d;if(!e)return null;const{isAutoWidth:h}=i;if(h){const p=t==null?void 0:t.autoLabelWidth,m=n==null?void 0:n.hasLabel,g={};if(m&&p&&p!=="auto"){const _=Math.max(0,Number.parseInt(p,10)-a.value),b=t.labelPosition==="left"?"marginRight":"marginLeft";_&&(g[b]=`${_}px`)}return re("div",{ref:s,class:[r.be("item","label-wrap")],style:g},[(u=e.default)==null?void 0:u.call(e)])}else return re(gt,{ref:s},[(d=e.default)==null?void 0:d.call(e)])}}});const sUe=["role","aria-labelledby"],aUe=de({name:"ElFormItem"}),oUe=de({...aUe,props:nUe,setup(i,{expose:e}){const t=i,n=uo(),r=ht(Rb,void 0),s=ht(uf,void 0),a=Qs(void 0,{formItem:!1}),o=Ne("form-item"),l=Ih().value,c=W([]),u=W(""),d=lOe(u,100),h=W(""),p=W();let m,g=!1;const _=R(()=>{if((r==null?void 0:r.labelPosition)==="top")return{};const ce=Xs(t.labelWidth||(r==null?void 0:r.labelWidth)||"");return ce?{width:ce}:{}}),b=R(()=>{if((r==null?void 0:r.labelPosition)==="top"||r!=null&&r.inline)return{};if(!t.label&&!t.labelWidth&&O)return{};const ce=Xs(t.labelWidth||(r==null?void 0:r.labelWidth)||"");return!t.label&&!n.label?{marginLeft:ce}:{}}),x=R(()=>[o.b(),o.m(a.value),o.is("error",u.value==="error"),o.is("validating",u.value==="validating"),o.is("success",u.value==="success"),o.is("required",G.value||t.required),o.is("no-asterisk",r==null?void 0:r.hideRequiredAsterisk),(r==null?void 0:r.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[o.m("feedback")]:r==null?void 0:r.statusIcon}]),w=R(()=>Ys(t.inlineMessage)?t.inlineMessage:(r==null?void 0:r.inlineMessage)||!1),C=R(()=>[o.e("error"),{[o.em("error","inline")]:w.value}]),S=R(()=>t.prop?Ft(t.prop)?t.prop:t.prop.join("."):""),E=R(()=>!!(t.label||n.label)),A=R(()=>t.for||c.value.length===1?c.value[0]:void 0),P=R(()=>!A.value&&E.value),O=!!s,M=R(()=>{const ce=r==null?void 0:r.model;if(!(!ce||!t.prop))return mR(ce,t.prop).value}),V=R(()=>{const{required:ce}=t,ae=[];t.rules&&ae.push(...nC(t.rules));const le=r==null?void 0:r.rules;if(le&&t.prop){const fe=mR(le,t.prop).value;fe&&ae.push(...nC(fe))}if(ce!==void 0){const fe=ae.map((Ue,ie)=>[Ue,ie]).filter(([Ue])=>Object.keys(Ue).includes("required"));if(fe.length>0)for(const[Ue,ie]of fe)Ue.required!==ce&&(ae[ie]={...Ue,required:ce});else ae.push({required:ce})}return ae}),L=R(()=>V.value.length>0),U=ce=>V.value.filter(le=>!le.trigger||!ce?!0:Array.isArray(le.trigger)?le.trigger.includes(ce):le.trigger===ce).map(({trigger:le,...fe})=>fe),G=R(()=>V.value.some(ce=>ce.required)),H=R(()=>{var ce;return d.value==="error"&&t.showMessage&&((ce=r==null?void 0:r.showMessage)!=null?ce:!0)}),k=R(()=>`${t.label||""}${(r==null?void 0:r.labelSuffix)||""}`),D=ce=>{u.value=ce},$=ce=>{var ae,le;const{errors:fe,fields:Ue}=ce;(!fe||!Ue)&&console.error(ce),D("error"),h.value=fe?(le=(ae=fe==null?void 0:fe[0])==null?void 0:ae.message)!=null?le:`${t.prop} is required`:"",r==null||r.emit("validate",t.prop,!1,h.value)},F=()=>{D("success"),r==null||r.emit("validate",t.prop,!0,"")},Y=async ce=>{const ae=S.value;return new cM({[ae]:ce}).validate({[ae]:M.value},{firstFields:!0}).then(()=>(F(),!0)).catch(fe=>($(fe),Promise.reject(fe)))},ne=async(ce,ae)=>{if(g||!t.prop)return!1;const le=Lt(ae);if(!L.value)return ae==null||ae(!1),!1;const fe=U(ce);return fe.length===0?(ae==null||ae(!0),!0):(D("validating"),Y(fe).then(()=>(ae==null||ae(!0),!0)).catch(Ue=>{const{fields:ie}=Ue;return ae==null||ae(!1,ie),le?!1:Promise.reject(ie)}))},X=()=>{D(""),h.value="",g=!1},J=async()=>{const ce=r==null?void 0:r.model;if(!ce||!t.prop)return;const ae=mR(ce,t.prop);g=!0,ae.value=Rj(m),await ut(),X(),g=!1},he=ce=>{c.value.includes(ce)||c.value.push(ce)},ye=ce=>{c.value=c.value.filter(ae=>ae!==ce)};Ve(()=>t.error,ce=>{h.value=ce||"",D(ce?"error":"")},{immediate:!0}),Ve(()=>t.validateStatus,ce=>D(ce||""));const Te=Ji({..._a(t),$el:p,size:a,validateState:u,labelId:l,inputIds:c,isGroup:P,hasLabel:E,addInputId:he,removeInputId:ye,resetField:J,clearValidate:X,validate:ne});return pi(uf,Te),qt(()=>{t.prop&&(r==null||r.addField(Te),m=Rj(M.value))}),Vr(()=>{r==null||r.removeField(Te)}),e({size:a,validateMessage:h,validateState:u,validate:ne,clearValidate:X,resetField:J}),(ce,ae)=>{var le;return I(),Z("div",{ref_key:"formItemRef",ref:p,class:N(v(x)),role:v(P)?"group":void 0,"aria-labelledby":v(P)?v(l):void 0},[re(v(rUe),{"is-auto-width":v(_).width==="auto","update-all":((le=v(r))==null?void 0:le.labelWidth)==="auto"},{default:pe(()=>[v(E)?(I(),Se(hi(v(A)?"label":"div"),{key:0,id:v(l),for:v(A),class:N(v(o).e("label")),style:pt(v(_))},{default:pe(()=>[Fe(ce.$slots,"label",{label:v(k)},()=>[Gi(We(v(k)),1)])]),_:3},8,["id","for","class","style"])):_e("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),Q("div",{class:N(v(o).e("content")),style:pt(v(b))},[Fe(ce.$slots,"default"),re(Ss,{name:`${v(o).namespace.value}-zoom-in-top`},{default:pe(()=>[v(H)?Fe(ce.$slots,"error",{key:0,error:h.value},()=>[Q("div",{class:N(v(C))},We(h.value),3)]):_e("v-if",!0)]),_:3},8,["name"])],6)],10,sUe)}}});var Hle=qe(oUe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const lUe=ii(C9e,{FormItem:Hle}),cUe=Wr(Hle),uUe=Ke({urlList:{type:xe(Array),default:()=>Ar([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),dUe={close:()=>!0,switch:i=>It(i)},hUe=["src"],pUe=de({name:"ElImageViewer"}),fUe=de({...pUe,props:uUe,emits:dUe,setup(i,{expose:e,emit:t}){const n=i,r={CONTAIN:{name:"contain",icon:F0(DIe)},ORIGINAL:{name:"original",icon:F0(X$e)}},s=o9()?"DOMMouseScroll":"mousewheel",{t:a}=Ki(),o=Ne("image-viewer"),{nextZIndex:l}=yg(),c=W(),u=W([]),d=Mxe(),h=W(!0),p=W(n.initialIndex),m=nr(r.CONTAIN),g=W({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),_=R(()=>{const{urlList:$}=n;return $.length<=1}),b=R(()=>p.value===0),x=R(()=>p.value===n.urlList.length-1),w=R(()=>n.urlList[p.value]),C=R(()=>{const{scale:$,deg:F,offsetX:Y,offsetY:ne,enableTransition:X}=g.value;let J=Y/$,he=ne/$;switch(F%360){case 90:case-270:[J,he]=[he,-J];break;case 180:case-180:[J,he]=[-J,-he];break;case 270:case-90:[J,he]=[-he,J];break}const ye={transform:`scale(${$}) rotate(${F}deg) translate(${J}px, ${he}px)`,transition:X?"transform .3s":""};return m.value.name===r.CONTAIN.name&&(ye.maxWidth=ye.maxHeight="100%"),ye}),S=R(()=>It(n.zIndex)?n.zIndex:l());function E(){P(),t("close")}function A(){const $=V0(Y=>{switch(Y.code){case wt.esc:n.closeOnPressEscape&&E();break;case wt.space:U();break;case wt.left:H();break;case wt.up:D("zoomIn");break;case wt.right:k();break;case wt.down:D("zoomOut");break}}),F=V0(Y=>{(Y.wheelDelta?Y.wheelDelta:-Y.detail)>0?D("zoomIn",{zoomRate:n.zoomRate,enableTransition:!1}):D("zoomOut",{zoomRate:n.zoomRate,enableTransition:!1})});d.run(()=>{mr(document,"keydown",$),mr(document,s,F)})}function P(){d.stop()}function O(){h.value=!1}function M($){h.value=!1,$.target.alt=a("el.image.error")}function V($){if(h.value||$.button!==0||!c.value)return;g.value.enableTransition=!1;const{offsetX:F,offsetY:Y}=g.value,ne=$.pageX,X=$.pageY,J=V0(ye=>{g.value={...g.value,offsetX:F+ye.pageX-ne,offsetY:Y+ye.pageY-X}}),he=mr(document,"mousemove",J);mr(document,"mouseup",()=>{he()}),$.preventDefault()}function L(){g.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function U(){if(h.value)return;const $=z2(r),F=Object.values(r),Y=m.value.name,X=(F.findIndex(J=>J.name===Y)+1)%$.length;m.value=r[$[X]],L()}function G($){const F=n.urlList.length;p.value=($+F)%F}function H(){b.value&&!n.infinite||G(p.value-1)}function k(){x.value&&!n.infinite||G(p.value+1)}function D($,F={}){if(h.value)return;const{zoomRate:Y,rotateDeg:ne,enableTransition:X}={zoomRate:n.zoomRate,rotateDeg:90,enableTransition:!0,...F};switch($){case"zoomOut":g.value.scale>.2&&(g.value.scale=Number.parseFloat((g.value.scale/Y).toFixed(3)));break;case"zoomIn":g.value.scale<7&&(g.value.scale=Number.parseFloat((g.value.scale*Y).toFixed(3)));break;case"clockwise":g.value.deg+=ne;break;case"anticlockwise":g.value.deg-=ne;break}g.value.enableTransition=X}return Ve(w,()=>{ut(()=>{const $=u.value[0];$!=null&&$.complete||(h.value=!0)})}),Ve(p,$=>{L(),t("switch",$)}),qt(()=>{var $,F;A(),(F=($=c.value)==null?void 0:$.focus)==null||F.call($)}),e({setActiveItem:G}),($,F)=>(I(),Se(QA,{to:"body",disabled:!$.teleported},[re(Ss,{name:"viewer-fade",appear:""},{default:pe(()=>[Q("div",{ref_key:"wrapper",ref:c,tabindex:-1,class:N(v(o).e("wrapper")),style:pt({zIndex:v(S)})},[Q("div",{class:N(v(o).e("mask")),onClick:F[0]||(F[0]=Dt(Y=>$.hideOnClickModal&&E(),["self"]))},null,2),_e(" CLOSE "),Q("span",{class:N([v(o).e("btn"),v(o).e("close")]),onClick:E},[re(v(ct),null,{default:pe(()=>[re(v(Rh))]),_:1})],2),_e(" ARROW "),v(_)?_e("v-if",!0):(I(),Z(gt,{key:0},[Q("span",{class:N([v(o).e("btn"),v(o).e("prev"),v(o).is("disabled",!$.infinite&&v(b))]),onClick:H},[re(v(ct),null,{default:pe(()=>[re(v(Ty))]),_:1})],2),Q("span",{class:N([v(o).e("btn"),v(o).e("next"),v(o).is("disabled",!$.infinite&&v(x))]),onClick:k},[re(v(ct),null,{default:pe(()=>[re(v(Wl))]),_:1})],2)],64)),_e(" ACTIONS "),Q("div",{class:N([v(o).e("btn"),v(o).e("actions")])},[Q("div",{class:N(v(o).e("actions__inner"))},[re(v(ct),{onClick:F[1]||(F[1]=Y=>D("zoomOut"))},{default:pe(()=>[re(v(QLe))]),_:1}),re(v(ct),{onClick:F[2]||(F[2]=Y=>D("zoomIn"))},{default:pe(()=>[re(v(Tae))]),_:1}),Q("i",{class:N(v(o).e("actions__divider"))},null,2),re(v(ct),{onClick:U},{default:pe(()=>[(I(),Se(hi(v(m).icon)))]),_:1}),Q("i",{class:N(v(o).e("actions__divider"))},null,2),re(v(ct),{onClick:F[3]||(F[3]=Y=>D("anticlockwise"))},{default:pe(()=>[re(v(N$e))]),_:1}),re(v(ct),{onClick:F[4]||(F[4]=Y=>D("clockwise"))},{default:pe(()=>[re(v(G$e))]),_:1})],2)],2),_e(" CANVAS "),Q("div",{class:N(v(o).e("canvas"))},[(I(!0),Z(gt,null,xi($.urlList,(Y,ne)=>zt((I(),Z("img",{ref_for:!0,ref:X=>u.value[ne]=X,key:Y,src:Y,style:pt(v(C)),class:N(v(o).e("img")),onLoad:O,onError:M,onMousedown:V},null,46,hUe)),[[Ei,ne===p.value]])),128))],2),Fe($.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var mUe=qe(fUe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]]);const Gle=ii(mUe),gUe=Ke({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:xe([String,Object])},previewSrcList:{type:xe(Array),default:()=>Ar([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),vUe={load:i=>i instanceof Event,error:i=>i instanceof Event,switch:i=>It(i),close:()=>!0,show:()=>!0},yUe=["src","loading"],_Ue={key:0},bUe=de({name:"ElImage",inheritAttrs:!1}),wUe=de({...bUe,props:gUe,emits:vUe,setup(i,{emit:e}){const t=i;let n="";const{t:r}=Ki(),s=Ne("image"),a=VC(),o=l9(),l=W(),c=W(!1),u=W(!0),d=W(!1),h=W(),p=W(),m=Ii&&"loading"in HTMLImageElement.prototype;let g,_;const b=R(()=>a.style),x=R(()=>{const{fit:D}=t;return Ii&&D?{objectFit:D}:{}}),w=R(()=>{const{previewSrcList:D}=t;return Array.isArray(D)&&D.length>0}),C=R(()=>{const{previewSrcList:D,initialIndex:$}=t;let F=$;return $>D.length-1&&(F=0),F}),S=R(()=>t.loading==="eager"?!1:!m&&t.loading==="lazy"||t.lazy),E=()=>{Ii&&(u.value=!0,c.value=!1,l.value=t.src)};function A(D){u.value=!1,c.value=!1,e("load",D)}function P(D){u.value=!1,c.value=!0,e("error",D)}function O(){SOe(h.value,p.value)&&(E(),L())}const M=mae(O,200);async function V(){var D;if(!Ii)return;await ut();const{scrollContainer:$}=t;Oh($)?p.value=$:Ft($)&&$!==""?p.value=(D=document.querySelector($))!=null?D:void 0:h.value&&(p.value=i9(h.value)),p.value&&(g=mr(p,"scroll",M),setTimeout(()=>O(),100))}function L(){!Ii||!p.value||!M||(g==null||g(),p.value=void 0)}function U(D){if(D.ctrlKey){if(D.deltaY<0)return D.preventDefault(),!1;if(D.deltaY>0)return D.preventDefault(),!1}}function G(){w.value&&(_=mr("wheel",U,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",d.value=!0,e("show"))}function H(){_==null||_(),document.body.style.overflow=n,d.value=!1,e("close")}function k(D){e("switch",D)}return Ve(()=>t.src,()=>{S.value?(u.value=!0,c.value=!1,L(),V()):E()}),qt(()=>{S.value?V():E()}),(D,$)=>(I(),Z("div",{ref_key:"container",ref:h,class:N([v(s).b(),D.$attrs.class]),style:pt(v(b))},[l.value!==void 0&&!c.value?(I(),Z("img",ci({key:0},v(o),{src:l.value,loading:D.loading,style:v(x),class:[v(s).e("inner"),v(w)&&v(s).e("preview"),u.value&&v(s).is("loading")],onClick:G,onLoad:A,onError:P}),null,16,yUe)):_e("v-if",!0),u.value||c.value?(I(),Z("div",{key:1,class:N(v(s).e("wrapper"))},[u.value?Fe(D.$slots,"placeholder",{key:0},()=>[Q("div",{class:N(v(s).e("placeholder"))},null,2)]):c.value?Fe(D.$slots,"error",{key:1},()=>[Q("div",{class:N(v(s).e("error"))},We(v(r)("el.image.error")),3)]):_e("v-if",!0)],2)):_e("v-if",!0),v(w)?(I(),Z(gt,{key:2},[d.value?(I(),Se(v(Gle),{key:0,"z-index":D.zIndex,"initial-index":v(C),infinite:D.infinite,"zoom-rate":D.zoomRate,"url-list":D.previewSrcList,"hide-on-click-modal":D.hideOnClickModal,teleported:D.previewTeleported,"close-on-press-escape":D.closeOnPressEscape,onClose:H,onSwitch:k},{default:pe(()=>[D.$slots.viewer?(I(),Z("div",_Ue,[Fe(D.$slots,"viewer")])):_e("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):_e("v-if",!0)],64)):_e("v-if",!0)],6))}});var xUe=qe(wUe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]]);const CUe=ii(xUe),TUe=Ke({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Ql,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:i=>i===null||It(i)||["min","max"].includes(i),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:i=>i>=0&&i===Number.parseInt(`${i}`,10)},validateEvent:{type:Boolean,default:!0}}),SUe={[rr]:(i,e)=>e!==i,blur:i=>i instanceof FocusEvent,focus:i=>i instanceof FocusEvent,[jl]:i=>It(i)||so(i),[ri]:i=>It(i)||so(i)},EUe=["aria-label","onKeydown"],AUe=["aria-label","onKeydown"],MUe=de({name:"ElInputNumber"}),PUe=de({...MUe,props:TUe,emits:SUe,setup(i,{expose:e,emit:t}){const n=i,{t:r}=Ki(),s=Ne("input-number"),a=W(),o=Ji({currentValue:n.modelValue,userInput:null}),{formItem:l}=nc(),c=R(()=>It(n.modelValue)&&n.modelValue<=n.min),u=R(()=>It(n.modelValue)&&n.modelValue>=n.max),d=R(()=>{const U=b(n.step);return eo(n.precision)?Math.max(b(n.modelValue),U):(U>n.precision,n.precision)}),h=R(()=>n.controls&&n.controlsPosition==="right"),p=Qs(),m=zc(),g=R(()=>{if(o.userInput!==null)return o.userInput;let U=o.currentValue;if(so(U))return"";if(It(U)){if(Number.isNaN(U))return"";eo(n.precision)||(U=U.toFixed(n.precision))}return U}),_=(U,G)=>{if(eo(G)&&(G=d.value),G===0)return Math.round(U);let H=String(U);const k=H.indexOf(".");if(k===-1||!H.replace(".","").split("")[k+G])return U;const F=H.length;return H.charAt(F-1)==="5"&&(H=`${H.slice(0,Math.max(0,F-1))}6`),Number.parseFloat(Number(H).toFixed(G))},b=U=>{if(so(U))return 0;const G=U.toString(),H=G.indexOf(".");let k=0;return H!==-1&&(k=G.length-H-1),k},x=(U,G=1)=>It(U)?_(U+n.step*G):o.currentValue,w=()=>{if(n.readonly||m.value||u.value)return;const U=Number(g.value)||0,G=x(U);E(G),t(jl,o.currentValue)},C=()=>{if(n.readonly||m.value||c.value)return;const U=Number(g.value)||0,G=x(U,-1);E(G),t(jl,o.currentValue)},S=(U,G)=>{const{max:H,min:k,step:D,precision:$,stepStrictly:F,valueOnClear:Y}=n;let ne=Number(U);if(so(U)||Number.isNaN(ne))return null;if(U===""){if(Y===null)return null;ne=Ft(Y)?{min:k,max:H}[Y]:Y}return F&&(ne=_(Math.round(ne/D)*D,$)),eo($)||(ne=_(ne,$)),(ne>H||ne<k)&&(ne=ne>H?H:k,G&&t(ri,ne)),ne},E=(U,G=!0)=>{var H;const k=o.currentValue,D=S(U);if(k!==D){if(!G){t(ri,D);return}o.userInput=null,t(ri,D),t(rr,D,k),n.validateEvent&&((H=l==null?void 0:l.validate)==null||H.call(l,"change").catch($=>void 0)),o.currentValue=D}},A=U=>{o.userInput=U;const G=U===""?null:Number(U);t(jl,G),E(G,!1)},P=U=>{const G=U!==""?Number(U):"";(It(G)&&!Number.isNaN(G)||U==="")&&E(G),o.userInput=null},O=()=>{var U,G;(G=(U=a.value)==null?void 0:U.focus)==null||G.call(U)},M=()=>{var U,G;(G=(U=a.value)==null?void 0:U.blur)==null||G.call(U)},V=U=>{t("focus",U)},L=U=>{var G;t("blur",U),n.validateEvent&&((G=l==null?void 0:l.validate)==null||G.call(l,"blur").catch(H=>void 0))};return Ve(()=>n.modelValue,U=>{const G=S(o.userInput),H=S(U,!0);!It(G)&&(!G||G!==H)&&(o.currentValue=H,o.userInput=null)},{immediate:!0}),qt(()=>{var U;const{min:G,max:H,modelValue:k}=n,D=(U=a.value)==null?void 0:U.input;if(D.setAttribute("role","spinbutton"),Number.isFinite(H)?D.setAttribute("aria-valuemax",String(H)):D.removeAttribute("aria-valuemax"),Number.isFinite(G)?D.setAttribute("aria-valuemin",String(G)):D.removeAttribute("aria-valuemin"),D.setAttribute("aria-valuenow",String(o.currentValue)),D.setAttribute("aria-disabled",String(m.value)),!It(k)&&k!=null){let $=Number(k);Number.isNaN($)&&($=null),t(ri,$)}}),pg(()=>{var U;const G=(U=a.value)==null?void 0:U.input;G==null||G.setAttribute("aria-valuenow",`${o.currentValue}`)}),e({focus:O,blur:M}),(U,G)=>(I(),Z("div",{class:N([v(s).b(),v(s).m(v(p)),v(s).is("disabled",v(m)),v(s).is("without-controls",!U.controls),v(s).is("controls-right",v(h))]),onDragstart:G[0]||(G[0]=Dt(()=>{},["prevent"]))},[U.controls?zt((I(),Z("span",{key:0,role:"button","aria-label":v(r)("el.inputNumber.decrease"),class:N([v(s).e("decrease"),v(s).is("disabled",v(c))]),onKeydown:Di(C,["enter"])},[re(v(ct),null,{default:pe(()=>[v(h)?(I(),Se(v(Fy),{key:0})):(I(),Se(v(r$e),{key:1}))]),_:1})],42,EUe)),[[v(h$),C]]):_e("v-if",!0),U.controls?zt((I(),Z("span",{key:1,role:"button","aria-label":v(r)("el.inputNumber.increase"),class:N([v(s).e("increase"),v(s).is("disabled",v(u))]),onKeydown:Di(w,["enter"])},[re(v(ct),null,{default:pe(()=>[v(h)?(I(),Se(v(A3),{key:0})):(I(),Se(v(xae),{key:1}))]),_:1})],42,AUe)),[[v(h$),w]]):_e("v-if",!0),re(v(ol),{id:U.id,ref_key:"input",ref:a,type:"number",step:U.step,"model-value":v(g),placeholder:U.placeholder,readonly:U.readonly,disabled:v(m),size:v(p),max:U.max,min:U.min,name:U.name,label:U.label,"validate-event":!1,onKeydown:[Di(Dt(w,["prevent"]),["up"]),Di(Dt(C,["prevent"]),["down"])],onBlur:L,onFocus:V,onInput:A,onChange:P},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var OUe=qe(PUe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]);const Wle=ii(OUe),RUe=Ke({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},icon:{type:Zn}}),IUe={click:i=>i instanceof MouseEvent},$Ue=["href"],LUe=de({name:"ElLink"}),DUe=de({...LUe,props:RUe,emits:IUe,setup(i,{emit:e}){const t=i,n=Ne("link"),r=R(()=>[n.b(),n.m(t.type),n.is("disabled",t.disabled),n.is("underline",t.underline&&!t.disabled)]);function s(a){t.disabled||e("click",a)}return(a,o)=>(I(),Z("a",{class:N(v(r)),href:a.disabled||!a.href?void 0:a.href,onClick:s},[a.icon?(I(),Se(v(ct),{key:0},{default:pe(()=>[(I(),Se(hi(a.icon)))]),_:1})):_e("v-if",!0),a.$slots.default?(I(),Z("span",{key:1,class:N(v(n).e("inner"))},[Fe(a.$slots,"default")],2)):_e("v-if",!0),a.$slots.icon?Fe(a.$slots,"icon",{key:2}):_e("v-if",!0)],10,$Ue))}});var kUe=qe(DUe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue"]]);const FUe=ii(kUe);let NUe=class{constructor(e,t){this.parent=e,this.domNode=t,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(e){e===this.subMenuItems.length?e=0:e<0&&(e=this.subMenuItems.length-1),this.subMenuItems[e].focus(),this.subIndex=e}addListeners(){const e=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,t=>{t.addEventListener("keydown",n=>{let r=!1;switch(n.code){case wt.down:{this.gotoSubIndex(this.subIndex+1),r=!0;break}case wt.up:{this.gotoSubIndex(this.subIndex-1),r=!0;break}case wt.tab:{pR(e,"mouseleave");break}case wt.enter:case wt.space:{r=!0,n.currentTarget.click();break}}return r&&(n.preventDefault(),n.stopPropagation()),!1})})}},VUe=class{constructor(e,t){this.domNode=e,this.submenu=null,this.submenu=null,this.init(t)}init(e){this.domNode.setAttribute("tabindex","0");const t=this.domNode.querySelector(`.${e}-menu`);t&&(this.submenu=new NUe(this,t)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",e=>{let t=!1;switch(e.code){case wt.down:{pR(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),t=!0;break}case wt.up:{pR(e.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),t=!0;break}case wt.tab:{pR(e.currentTarget,"mouseleave");break}case wt.enter:case wt.space:{t=!0,e.currentTarget.click();break}}t&&e.preventDefault()})}},BUe=class{constructor(e,t){this.domNode=e,this.init(t)}init(e){const t=this.domNode.childNodes;Array.from(t).forEach(n=>{n.nodeType===1&&new VUe(n,e)})}};const zUe=de({name:"ElMenuCollapseTransition",setup(){const i=Ne("menu");return{listeners:{onBeforeEnter:t=>t.style.opacity="0.2",onEnter(t,n){kp(t,`${i.namespace.value}-opacity-transition`),t.style.opacity="1",n()},onAfterEnter(t){Lc(t,`${i.namespace.value}-opacity-transition`),t.style.opacity=""},onBeforeLeave(t){t.dataset||(t.dataset={}),Th(t,i.m("collapse"))?(Lc(t,i.m("collapse")),t.dataset.oldOverflow=t.style.overflow,t.dataset.scrollWidth=t.clientWidth.toString(),kp(t,i.m("collapse"))):(kp(t,i.m("collapse")),t.dataset.oldOverflow=t.style.overflow,t.dataset.scrollWidth=t.clientWidth.toString(),Lc(t,i.m("collapse"))),t.style.width=`${t.scrollWidth}px`,t.style.overflow="hidden"},onLeave(t){kp(t,"horizontal-collapse-transition"),t.style.width=`${t.dataset.scrollWidth}px`}}}}});function UUe(i,e,t,n,r,s){return I(),Se(Ss,ci({mode:"out-in"},i.listeners),{default:pe(()=>[Fe(i.$slots,"default")]),_:3},16)}var HUe=qe(zUe,[["render",UUe],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-collapse-transition.vue"]]);function jle(i,e){const t=R(()=>{let r=i.parent;const s=[e.value];for(;r.type.name!=="ElMenu";)r.props.index&&s.unshift(r.props.index),r=r.parent;return s});return{parentMenu:R(()=>{let r=i.parent;for(;r&&!["ElMenu","ElSubMenu"].includes(r.type.name);)r=r.parent;return r}),indexPath:t}}function GUe(i){return R(()=>{const t=i.backgroundColor;return t?new Doe(t).shade(20).toString():""})}const qle=(i,e)=>{const t=Ne("menu");return R(()=>t.cssVarBlock({"text-color":i.textColor||"","hover-text-color":i.textColor||"","bg-color":i.backgroundColor||"","hover-bg-color":GUe(i).value||"","active-color":i.activeTextColor||"",level:`${e}`}))},WUe=Ke({index:{type:String,required:!0},showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300},popperClass:String,disabled:Boolean,popperAppendToBody:{type:Boolean,default:void 0},popperOffset:{type:Number,default:6},expandCloseIcon:{type:Zn},expandOpenIcon:{type:Zn},collapseCloseIcon:{type:Zn},collapseOpenIcon:{type:Zn}}),Ok="ElSubMenu";var N9=de({name:Ok,props:WUe,setup(i,{slots:e,expose:t}){const n=ti(),{indexPath:r,parentMenu:s}=jle(n,R(()=>i.index)),a=Ne("menu"),o=Ne("sub-menu"),l=ht("rootMenu");l||ba(Ok,"can not inject root menu");const c=ht(`subMenu:${s.value.uid}`);c||ba(Ok,"can not inject sub menu");const u=W({}),d=W({});let h;const p=W(!1),m=W(),g=W(null),_=R(()=>V.value==="horizontal"&&x.value?"bottom-start":"right-start"),b=R(()=>V.value==="horizontal"&&x.value||V.value==="vertical"&&!l.props.collapse?i.expandCloseIcon&&i.expandOpenIcon?E.value?i.expandOpenIcon:i.expandCloseIcon:Fy:i.collapseCloseIcon&&i.collapseOpenIcon?E.value?i.collapseOpenIcon:i.collapseCloseIcon:Wl),x=R(()=>c.level===0),w=R(()=>i.popperAppendToBody===void 0?x.value:Boolean(i.popperAppendToBody)),C=R(()=>l.props.collapse?`${a.namespace.value}-zoom-in-left`:`${a.namespace.value}-zoom-in-top`),S=R(()=>V.value==="horizontal"&&x.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","left-start","bottom-start","bottom-end","top-start","top-end"]),E=R(()=>l.openedMenus.includes(i.index)),A=R(()=>{let F=!1;return Object.values(u.value).forEach(Y=>{Y.active&&(F=!0)}),Object.values(d.value).forEach(Y=>{Y.active&&(F=!0)}),F}),P=R(()=>l.props.backgroundColor||""),O=R(()=>l.props.activeTextColor||""),M=R(()=>l.props.textColor||""),V=R(()=>l.props.mode),L=Ji({index:i.index,indexPath:r,active:A}),U=R(()=>V.value!=="horizontal"?{color:M.value}:{borderBottomColor:A.value?l.props.activeTextColor?O.value:"":"transparent",color:A.value?O.value:M.value}),G=()=>{var F,Y,ne;return(ne=(Y=(F=g.value)==null?void 0:F.popperRef)==null?void 0:Y.popperInstanceRef)==null?void 0:ne.destroy()},H=F=>{F||G()},k=()=>{l.props.menuTrigger==="hover"&&l.props.mode==="horizontal"||l.props.collapse&&l.props.mode==="vertical"||i.disabled||l.handleSubMenuClick({index:i.index,indexPath:r.value,active:A.value})},D=(F,Y=i.showTimeout)=>{var ne;F.type!=="focus"&&(l.props.menuTrigger==="click"&&l.props.mode==="horizontal"||!l.props.collapse&&l.props.mode==="vertical"||i.disabled||(c.mouseInChild.value=!0,h==null||h(),{stop:h}=ob(()=>{l.openMenu(i.index,r.value)},Y),w.value&&((ne=s.value.vnode.el)==null||ne.dispatchEvent(new MouseEvent("mouseenter")))))},$=(F=!1)=>{var Y,ne;l.props.menuTrigger==="click"&&l.props.mode==="horizontal"||!l.props.collapse&&l.props.mode==="vertical"||(h==null||h(),c.mouseInChild.value=!1,{stop:h}=ob(()=>!p.value&&l.closeMenu(i.index,r.value),i.hideTimeout),w.value&&F&&((Y=n.parent)==null?void 0:Y.type.name)==="ElSubMenu"&&((ne=c.handleMouseleave)==null||ne.call(c,!0)))};Ve(()=>l.props.collapse,F=>H(Boolean(F)));{const F=ne=>{d.value[ne.index]=ne},Y=ne=>{delete d.value[ne.index]};pi(`subMenu:${n.uid}`,{addSubMenu:F,removeSubMenu:Y,handleMouseleave:$,mouseInChild:p,level:c.level+1})}return t({opened:E}),qt(()=>{l.addSubMenu(L),c.addSubMenu(L)}),Vr(()=>{c.removeSubMenu(L),l.removeSubMenu(L)}),()=>{var F;const Y=[(F=e.title)==null?void 0:F.call(e),bt(ct,{class:o.e("icon-arrow"),style:{transform:E.value?i.expandCloseIcon&&i.expandOpenIcon||i.collapseCloseIcon&&i.collapseOpenIcon&&l.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>Ft(b.value)?bt(n.appContext.components[b.value]):bt(b.value)})],ne=qle(l.props,c.level+1),X=l.isMenuPopup?bt(Jl,{ref:g,visible:E.value,effect:"light",pure:!0,offset:i.popperOffset,showArrow:!1,persistent:!0,popperClass:i.popperClass,placement:_.value,teleported:w.value,fallbackPlacements:S.value,transition:C.value,gpuAcceleration:!1},{content:()=>{var J;return bt("div",{class:[a.m(V.value),a.m("popup-container"),i.popperClass],onMouseenter:he=>D(he,100),onMouseleave:()=>$(!0),onFocus:he=>D(he,100)},[bt("ul",{class:[a.b(),a.m("popup"),a.m(`popup-${_.value}`)],style:ne.value},[(J=e.default)==null?void 0:J.call(e)])])},default:()=>bt("div",{class:o.e("title"),style:[U.value,{backgroundColor:P.value}],onClick:k},Y)}):bt(gt,{},[bt("div",{class:o.e("title"),style:[U.value,{backgroundColor:P.value}],ref:m,onClick:k},Y),bt(U3,{},{default:()=>{var J;return zt(bt("ul",{role:"menu",class:[a.b(),a.m("inline")],style:ne.value},[(J=e.default)==null?void 0:J.call(e)]),[[Ei,E.value]])}})]);return bt("li",{class:[o.b(),o.is("active",A.value),o.is("opened",E.value),o.is("disabled",i.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:E.value,onMouseenter:D,onMouseleave:()=>$(!0),onFocus:D},[X])}}});const jUe=Ke({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:xe(Array),default:()=>Ar([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperEffect:{type:String,values:["dark","light"],default:"dark"}}),Rk=i=>Array.isArray(i)&&i.every(e=>Ft(e)),qUe={close:(i,e)=>Ft(i)&&Rk(e),open:(i,e)=>Ft(i)&&Rk(e),select:(i,e,t,n)=>Ft(i)&&Rk(e)&&oi(t)&&(n===void 0||n instanceof Promise)};var KUe=de({name:"ElMenu",props:jUe,emits:qUe,setup(i,{emit:e,slots:t,expose:n}){const r=ti(),s=r.appContext.config.globalProperties.$router,a=W(),o=Ne("menu"),l=Ne("sub-menu"),c=W(-1),u=W(i.defaultOpeneds&&!i.collapse?i.defaultOpeneds.slice(0):[]),d=W(i.defaultActive),h=W({}),p=W({}),m=R(()=>i.mode==="horizontal"||i.mode==="vertical"&&i.collapse),g=()=>{const M=d.value&&h.value[d.value];if(!M||i.mode==="horizontal"||i.collapse)return;M.indexPath.forEach(L=>{const U=p.value[L];U&&_(L,U.indexPath)})},_=(M,V)=>{u.value.includes(M)||(i.uniqueOpened&&(u.value=u.value.filter(L=>V.includes(L))),u.value.push(M),e("open",M,V))},b=(M,V)=>{const L=u.value.indexOf(M);L!==-1&&u.value.splice(L,1),e("close",M,V)},x=({index:M,indexPath:V})=>{u.value.includes(M)?b(M,V):_(M,V)},w=M=>{(i.mode==="horizontal"||i.collapse)&&(u.value=[]);const{index:V,indexPath:L}=M;if(!(V===void 0||L===void 0))if(i.router&&s){const U=M.route||V,G=s.push(U).then(H=>(H||(d.value=V),H));e("select",V,L,{index:V,indexPath:L,route:U},G)}else d.value=V,e("select",V,L,{index:V,indexPath:L})},C=M=>{const V=h.value,L=V[M]||d.value&&V[d.value]||V[i.defaultActive];L?d.value=L.index:d.value=M},S=()=>{var M,V;if(!a.value)return-1;const L=Array.from((V=(M=a.value)==null?void 0:M.childNodes)!=null?V:[]).filter(F=>F.nodeName!=="#text"||F.nodeValue),U=64,G=Number.parseInt(getComputedStyle(a.value).paddingLeft,10),H=Number.parseInt(getComputedStyle(a.value).paddingRight,10),k=a.value.clientWidth-G-H;let D=0,$=0;return L.forEach((F,Y)=>{D+=F.offsetWidth||0,D<=k-U&&($=Y+1)}),$===L.length?-1:$},E=(M,V=33.34)=>{let L;return()=>{L&&clearTimeout(L),L=setTimeout(()=>{M()},V)}};let A=!0;const P=()=>{const M=()=>{c.value=-1,ut(()=>{c.value=S()})};A?M():E(M)(),A=!1};Ve(()=>i.defaultActive,M=>{h.value[M]||(d.value=""),C(M)}),Ve(()=>i.collapse,M=>{M&&(u.value=[])}),Ve(h.value,g);let O;Ru(()=>{i.mode==="horizontal"&&i.ellipsis?O=fl(a,P).stop:O==null||O()});{const M=G=>{p.value[G.index]=G},V=G=>{delete p.value[G.index]};pi("rootMenu",Ji({props:i,openedMenus:u,items:h,subMenus:p,activeIndex:d,isMenuPopup:m,addMenuItem:G=>{h.value[G.index]=G},removeMenuItem:G=>{delete h.value[G.index]},addSubMenu:M,removeSubMenu:V,openMenu:_,closeMenu:b,handleMenuItemClick:w,handleSubMenuClick:x})),pi(`subMenu:${r.uid}`,{addSubMenu:M,removeSubMenu:V,mouseInChild:W(!1),level:0})}return qt(()=>{i.mode==="horizontal"&&new BUe(r.vnode.el,o.namespace.value)}),n({open:V=>{const{indexPath:L}=p.value[V];L.forEach(U=>_(U,L))},close:b,handleResize:P}),()=>{var M,V;let L=(V=(M=t.default)==null?void 0:M.call(t))!=null?V:[];const U=[];if(i.mode==="horizontal"&&a.value){const k=gx(L),D=c.value===-1?k:k.slice(0,c.value),$=c.value===-1?[]:k.slice(c.value);$!=null&&$.length&&i.ellipsis&&(L=D,U.push(bt(N9,{index:"sub-menu-more",class:l.e("hide-arrow")},{title:()=>bt(ct,{class:l.e("icon-more")},{default:()=>bt(m$e)}),default:()=>$})))}const G=qle(i,0),H=bt("ul",{key:String(i.collapse),role:"menubar",ref:a,style:G.value,class:{[o.b()]:!0,[o.m(i.mode)]:!0,[o.m("collapse")]:i.collapse}},[...L,...U]);return i.collapseTransition&&i.mode==="vertical"?bt(HUe,()=>H):H}}});const YUe=Ke({index:{type:xe([String,null]),default:null},route:{type:xe([String,Object])},disabled:Boolean}),XUe={click:i=>Ft(i.index)&&Array.isArray(i.indexPath)},Ik="ElMenuItem",ZUe=de({name:Ik,components:{ElTooltip:Jl},props:YUe,emits:XUe,setup(i,{emit:e}){const t=ti(),n=ht("rootMenu"),r=Ne("menu"),s=Ne("menu-item");n||ba(Ik,"can not inject root menu");const{parentMenu:a,indexPath:o}=jle(t,kr(i,"index")),l=ht(`subMenu:${a.value.uid}`);l||ba(Ik,"can not inject sub menu");const c=R(()=>i.index===n.activeIndex),u=Ji({index:i.index,indexPath:o,active:c}),d=()=>{i.disabled||(n.handleMenuItemClick({index:i.index,indexPath:o.value,route:i.route}),e("click",u))};return qt(()=>{l.addSubMenu(u),n.addMenuItem(u)}),Vr(()=>{l.removeSubMenu(u),n.removeMenuItem(u)}),{parentMenu:a,rootMenu:n,active:c,nsMenu:r,nsMenuItem:s,handleClick:d}}});function QUe(i,e,t,n,r,s){const a=jt("el-tooltip");return I(),Z("li",{class:N([i.nsMenuItem.b(),i.nsMenuItem.is("active",i.active),i.nsMenuItem.is("disabled",i.disabled)]),role:"menuitem",tabindex:"-1",onClick:e[0]||(e[0]=(...o)=>i.handleClick&&i.handleClick(...o))},[i.parentMenu.type.name==="ElMenu"&&i.rootMenu.props.collapse&&i.$slots.title?(I(),Se(a,{key:0,effect:i.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:pe(()=>[Fe(i.$slots,"title")]),default:pe(()=>[Q("div",{class:N(i.nsMenu.be("tooltip","trigger"))},[Fe(i.$slots,"default")],2)]),_:3},8,["effect"])):(I(),Z(gt,{key:1},[Fe(i.$slots,"default"),Fe(i.$slots,"title")],64))],2)}var Kle=qe(ZUe,[["render",QUe],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item.vue"]]);const JUe={title:String},e7e="ElMenuItemGroup",t7e=de({name:e7e,props:JUe,setup(){return{ns:Ne("menu-item-group")}}});function i7e(i,e,t,n,r,s){return I(),Z("li",{class:N(i.ns.b())},[Q("div",{class:N(i.ns.e("title"))},[i.$slots.title?Fe(i.$slots,"title",{key:1}):(I(),Z(gt,{key:0},[Gi(We(i.title),1)],64))],2),Q("ul",null,[Fe(i.$slots,"default")])],2)}var Yle=qe(t7e,[["render",i7e],["__file","/home/runner/work/element-plus/element-plus/packages/components/menu/src/menu-item-group.vue"]]);const n7e=ii(KUe,{MenuItem:Kle,MenuItemGroup:Yle,SubMenu:N9}),r7e=Wr(Kle),s7e=Wr(Yle),a7e=Wr(N9),o7e=Ke({icon:{type:Zn,default:()=>rRe},title:String,content:{type:String,default:""}}),l7e={back:()=>!0},c7e=["aria-label"],u7e=de({name:"ElPageHeader"}),d7e=de({...u7e,props:o7e,emits:l7e,setup(i,{emit:e}){const t=uo(),{t:n}=Ki(),r=Ne("page-header"),s=R(()=>[r.b(),{[r.m("has-breadcrumb")]:!!t.breadcrumb,[r.m("has-extra")]:!!t.extra,[r.is("contentful")]:!!t.default}]);function a(){e("back")}return(o,l)=>(I(),Z("div",{class:N(v(s))},[o.$slots.breadcrumb?(I(),Z("div",{key:0,class:N(v(r).e("breadcrumb"))},[Fe(o.$slots,"breadcrumb")],2)):_e("v-if",!0),Q("div",{class:N(v(r).e("header"))},[Q("div",{class:N(v(r).e("left"))},[Q("div",{class:N(v(r).e("back")),role:"button",tabindex:"0",onClick:a},[o.icon||o.$slots.icon?(I(),Z("div",{key:0,"aria-label":o.title||v(n)("el.pageHeader.title"),class:N(v(r).e("icon"))},[Fe(o.$slots,"icon",{},()=>[o.icon?(I(),Se(v(ct),{key:0},{default:pe(()=>[(I(),Se(hi(o.icon)))]),_:1})):_e("v-if",!0)])],10,c7e)):_e("v-if",!0),Q("div",{class:N(v(r).e("title"))},[Fe(o.$slots,"title",{},()=>[Gi(We(o.title||v(n)("el.pageHeader.title")),1)])],2)],2),re(v(Ile),{direction:"vertical"}),Q("div",{class:N(v(r).e("content"))},[Fe(o.$slots,"content",{},()=>[Gi(We(o.content),1)])],2)],2),o.$slots.extra?(I(),Z("div",{key:0,class:N(v(r).e("extra"))},[Fe(o.$slots,"extra")],2)):_e("v-if",!0)],2),o.$slots.default?(I(),Z("div",{key:1,class:N(v(r).e("main"))},[Fe(o.$slots,"default")],2)):_e("v-if",!0)],2))}});var h7e=qe(d7e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/page-header/src/page-header.vue"]]);const p7e=ii(h7e),f7e=Ke({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:Zn}}),m7e={click:i=>i instanceof MouseEvent},g7e=["disabled","aria-disabled"],v7e={key:0},y7e=de({name:"ElPaginationPrev"}),_7e=de({...y7e,props:f7e,emits:m7e,setup(i){const e=i,t=R(()=>e.disabled||e.currentPage<=1);return(n,r)=>(I(),Z("button",{type:"button",class:"btn-prev",disabled:v(t),"aria-disabled":v(t),onClick:r[0]||(r[0]=s=>n.$emit("click",s))},[n.prevText?(I(),Z("span",v7e,We(n.prevText),1)):(I(),Se(v(ct),{key:1},{default:pe(()=>[(I(),Se(hi(n.prevIcon)))]),_:1}))],8,g7e))}});var b7e=qe(_7e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/prev.vue"]]);const w7e=Ke({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:Zn}}),x7e=["disabled","aria-disabled"],C7e={key:0},T7e=de({name:"ElPaginationNext"}),S7e=de({...T7e,props:w7e,emits:["click"],setup(i){const e=i,t=R(()=>e.disabled||e.currentPage===e.pageCount||e.pageCount===0);return(n,r)=>(I(),Z("button",{type:"button",class:"btn-next",disabled:v(t),"aria-disabled":v(t),onClick:r[0]||(r[0]=s=>n.$emit("click",s))},[n.nextText?(I(),Z("span",C7e,We(n.nextText),1)):(I(),Se(v(ct),{key:1},{default:pe(()=>[(I(),Se(hi(n.nextIcon)))]),_:1}))],8,x7e))}});var E7e=qe(S7e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/next.vue"]]);const Xle="ElSelectGroup",uM="ElSelect";function A7e(i,e){const t=ht(uM),n=ht(Xle,{disabled:!1}),r=R(()=>Object.prototype.toString.call(i.value).toLowerCase()==="[object object]"),s=R(()=>t.props.multiple?d(t.props.modelValue,i.value):h(i.value,t.props.modelValue)),a=R(()=>{if(t.props.multiple){const g=t.props.modelValue||[];return!s.value&&g.length>=t.props.multipleLimit&&t.props.multipleLimit>0}else return!1}),o=R(()=>i.label||(r.value?"":i.value)),l=R(()=>i.value||i.label||""),c=R(()=>i.disabled||e.groupDisabled||a.value),u=ti(),d=(g=[],_)=>{if(r.value){const b=t.props.valueKey;return g&&g.some(x=>mn(Tr(x,b))===Tr(_,b))}else return g&&g.includes(_)},h=(g,_)=>{if(r.value){const{valueKey:b}=t.props;return Tr(g,b)===Tr(_,b)}else return g===_},p=()=>{!i.disabled&&!n.disabled&&(t.hoverIndex=t.optionsArray.indexOf(u.proxy))};Ve(()=>o.value,()=>{!i.created&&!t.props.remote&&t.setSelected()}),Ve(()=>i.value,(g,_)=>{const{remote:b,valueKey:x}=t.props;if(Object.is(g,_)||(t.onOptionDestroy(_,u.proxy),t.onOptionCreate(u.proxy)),!i.created&&!b){if(x&&typeof g=="object"&&typeof _=="object"&&g[x]===_[x])return;t.setSelected()}}),Ve(()=>n.disabled,()=>{e.groupDisabled=n.disabled},{immediate:!0});const{queryChange:m}=mn(t);return Ve(m,g=>{const{query:_}=v(g),b=new RegExp(gae(_),"i");e.visible=b.test(o.value)||i.created,e.visible||t.filteredOptionsCount--}),{select:t,currentLabel:o,currentValue:l,itemSelected:s,isDisabled:c,hoverItem:p}}const M7e=de({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:{type:Boolean,default:!1}},setup(i){const e=Ne("select"),t=Ji({index:-1,groupDisabled:!1,visible:!0,hitState:!1,hover:!1}),{currentLabel:n,itemSelected:r,isDisabled:s,select:a,hoverItem:o}=A7e(i,t),{visible:l,hover:c}=_a(t),u=ti().proxy;a.onOptionCreate(u),Vr(()=>{const h=u.value,{selected:p}=a,g=(a.props.multiple?p:[p]).some(_=>_.value===u.value);ut(()=>{a.cachedOptions.get(h)===u&&!g&&a.cachedOptions.delete(h)}),a.onOptionDestroy(h,u)});function d(){i.disabled!==!0&&t.groupDisabled!==!0&&a.handleOptionSelect(u,!0)}return{ns:e,currentLabel:n,itemSelected:r,isDisabled:s,select:a,hoverItem:o,visible:l,hover:c,selectOptionClick:d,states:t}}});function P7e(i,e,t,n,r,s){return zt((I(),Z("li",{class:N([i.ns.be("dropdown","item"),i.ns.is("disabled",i.isDisabled),{selected:i.itemSelected,hover:i.hover}]),onMouseenter:e[0]||(e[0]=(...a)=>i.hoverItem&&i.hoverItem(...a)),onClick:e[1]||(e[1]=Dt((...a)=>i.selectOptionClick&&i.selectOptionClick(...a),["stop"]))},[Fe(i.$slots,"default",{},()=>[Q("span",null,We(i.currentLabel),1)])],34)),[[Ei,i.visible]])}var V9=qe(M7e,[["render",P7e],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option.vue"]]);const O7e=de({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const i=ht(uM),e=Ne("select"),t=R(()=>i.props.popperClass),n=R(()=>i.props.multiple),r=R(()=>i.props.fitInputWidth),s=W("");function a(){var o;s.value=`${(o=i.selectWrapper)==null?void 0:o.offsetWidth}px`}return qt(()=>{a(),fl(i.selectWrapper,a)}),{ns:e,minWidth:s,popperClass:t,isMultiple:n,isFitInputWidth:r}}});function R7e(i,e,t,n,r,s){return I(),Z("div",{class:N([i.ns.b("dropdown"),i.ns.is("multiple",i.isMultiple),i.popperClass]),style:pt({[i.isFitInputWidth?"width":"minWidth"]:i.minWidth})},[Fe(i.$slots,"default")],6)}var I7e=qe(O7e,[["render",R7e],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select-dropdown.vue"]]);function $7e(i){const{t:e}=Ki();return Ji({options:new Map,cachedOptions:new Map,createdLabel:null,createdSelected:!1,selected:i.multiple?[]:{},inputLength:20,inputWidth:0,optionsCount:0,filteredOptionsCount:0,visible:!1,softFocus:!1,selectedLabel:"",hoverIndex:-1,query:"",previousQuery:null,inputHovering:!1,cachedPlaceHolder:"",currentPlaceholder:e("el.select.placeholder"),menuVisibleOnFocus:!1,isOnComposition:!1,isSilentBlur:!1,prefixWidth:11,tagInMultiLine:!1,mouseEnter:!1})}const L7e=(i,e,t)=>{const{t:n}=Ki(),r=Ne("select");Ym({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},R(()=>i.suffixTransition===!1));const s=W(null),a=W(null),o=W(null),l=W(null),c=W(null),u=W(null),d=W(-1),h=nr({query:""}),p=nr(""),{form:m,formItem:g}=nc(),_=R(()=>!i.filterable||i.multiple||!e.visible),b=R(()=>i.disabled||(m==null?void 0:m.disabled)),x=R(()=>{const K=i.multiple?Array.isArray(i.modelValue)&&i.modelValue.length>0:i.modelValue!==void 0&&i.modelValue!==null&&i.modelValue!=="";return i.clearable&&!b.value&&e.inputHovering&&K}),w=R(()=>i.remote&&i.filterable&&!i.remoteShowSuffix?"":i.suffixIcon),C=R(()=>r.is("reverse",w.value&&e.visible&&i.suffixTransition)),S=R(()=>i.remote?300:0),E=R(()=>i.loading?i.loadingText||n("el.select.loading"):i.remote&&e.query===""&&e.options.size===0?!1:i.filterable&&e.query&&e.options.size>0&&e.filteredOptionsCount===0?i.noMatchText||n("el.select.noMatch"):e.options.size===0?i.noDataText||n("el.select.noData"):null),A=R(()=>Array.from(e.options.values())),P=R(()=>Array.from(e.cachedOptions.values())),O=R(()=>{const K=A.value.filter(se=>!se.created).some(se=>se.currentLabel===e.query);return i.filterable&&i.allowCreate&&e.query!==""&&!K}),M=Qs(),V=R(()=>["small"].includes(M.value)?"small":"default"),L=R({get(){return e.visible&&E.value!==!1},set(K){e.visible=K}});Ve([()=>b.value,()=>M.value,()=>m==null?void 0:m.size],()=>{ut(()=>{U()})}),Ve(()=>i.placeholder,K=>{e.cachedPlaceHolder=e.currentPlaceholder=K}),Ve(()=>i.modelValue,(K,se)=>{i.multiple&&(U(),K&&K.length>0||a.value&&e.query!==""?e.currentPlaceholder="":e.currentPlaceholder=e.cachedPlaceHolder,i.filterable&&!i.reserveKeyword&&(e.query="",G(e.query))),D(),i.filterable&&!i.multiple&&(e.inputLength=20),!Iu(K,se)&&i.validateEvent&&(g==null||g.validate("change").catch(Me=>void 0))},{flush:"post",deep:!0}),Ve(()=>e.visible,K=>{var se,Me,De;K?((Me=(se=o.value)==null?void 0:se.updatePopper)==null||Me.call(se),i.filterable&&(e.filteredOptionsCount=e.optionsCount,e.query=i.remote?"":e.selectedLabel,i.multiple?(De=a.value)==null||De.focus():e.selectedLabel&&(e.currentPlaceholder=`${e.selectedLabel}`,e.selectedLabel=""),G(e.query),!i.multiple&&!i.remote&&(h.value.query="",dT(h),dT(p)))):(i.filterable&&(Lt(i.filterMethod)&&i.filterMethod(""),Lt(i.remoteMethod)&&i.remoteMethod("")),a.value&&a.value.blur(),e.query="",e.previousQuery=null,e.selectedLabel="",e.inputLength=20,e.menuVisibleOnFocus=!1,F(),ut(()=>{a.value&&a.value.value===""&&e.selected.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)}),i.multiple||(e.selected&&(i.filterable&&i.allowCreate&&e.createdSelected&&e.createdLabel?e.selectedLabel=e.createdLabel:e.selectedLabel=e.selected.currentLabel,i.filterable&&(e.query=e.selectedLabel)),i.filterable&&(e.currentPlaceholder=e.cachedPlaceHolder))),t.emit("visible-change",K)}),Ve(()=>e.options.entries(),()=>{var K,se,Me;if(!Ii)return;(se=(K=o.value)==null?void 0:K.updatePopper)==null||se.call(K),i.multiple&&U();const De=((Me=c.value)==null?void 0:Me.querySelectorAll("input"))||[];Array.from(De).includes(document.activeElement)||D(),i.defaultFirstOption&&(i.filterable||i.remote)&&e.filteredOptionsCount&&k()},{flush:"post"}),Ve(()=>e.hoverIndex,K=>{It(K)&&K>-1?d.value=A.value[K]||{}:d.value={},A.value.forEach(se=>{se.hover=d.value===se})});const U=()=>{i.collapseTags&&!i.filterable||ut(()=>{var K,se;if(!s.value)return;const Me=s.value.$el.querySelector("input"),De=l.value,Tt=n3e(M.value||(m==null?void 0:m.size));Me.style.height=`${(e.selected.length===0?Tt:Math.max(De?De.clientHeight+(De.clientHeight>Tt?6:0):0,Tt))-2}px`,e.tagInMultiLine=Number.parseFloat(Me.style.height)>=Tt,e.visible&&E.value!==!1&&((se=(K=o.value)==null?void 0:K.updatePopper)==null||se.call(K))})},G=async K=>{if(!(e.previousQuery===K||e.isOnComposition)){if(e.previousQuery===null&&(Lt(i.filterMethod)||Lt(i.remoteMethod))){e.previousQuery=K;return}e.previousQuery=K,ut(()=>{var se,Me;e.visible&&((Me=(se=o.value)==null?void 0:se.updatePopper)==null||Me.call(se))}),e.hoverIndex=-1,i.multiple&&i.filterable&&ut(()=>{const se=a.value.value.length*15+20;e.inputLength=i.collapseTags?Math.min(50,se):se,H(),U()}),i.remote&&Lt(i.remoteMethod)?(e.hoverIndex=-1,i.remoteMethod(K)):Lt(i.filterMethod)?(i.filterMethod(K),dT(p)):(e.filteredOptionsCount=e.optionsCount,h.value.query=K,dT(h),dT(p)),i.defaultFirstOption&&(i.filterable||i.remote)&&e.filteredOptionsCount&&(await ut(),k())}},H=()=>{e.currentPlaceholder!==""&&(e.currentPlaceholder=a.value.value?"":e.cachedPlaceHolder)},k=()=>{const K=A.value.filter(De=>De.visible&&!De.disabled&&!De.states.groupDisabled),se=K.find(De=>De.created),Me=K[0];e.hoverIndex=fe(A.value,se||Me)},D=()=>{var K;if(i.multiple)e.selectedLabel="";else{const Me=$(i.modelValue);(K=Me.props)!=null&&K.created?(e.createdLabel=Me.props.value,e.createdSelected=!0):e.createdSelected=!1,e.selectedLabel=Me.currentLabel,e.selected=Me,i.filterable&&(e.query=e.selectedLabel);return}const se=[];Array.isArray(i.modelValue)&&i.modelValue.forEach(Me=>{se.push($(Me))}),e.selected=se,ut(()=>{U()})},$=K=>{let se;const Me=lR(K).toLowerCase()==="object",De=lR(K).toLowerCase()==="null",Tt=lR(K).toLowerCase()==="undefined";for(let vn=e.cachedOptions.size-1;vn>=0;vn--){const ui=P.value[vn];if(Me?Tr(ui.value,i.valueKey)===Tr(K,i.valueKey):ui.value===K){se={value:K,currentLabel:ui.currentLabel,isDisabled:ui.isDisabled};break}}if(se)return se;const Zt=Me?K.label:!De&&!Tt?K:"",tn={value:K,currentLabel:Zt};return i.multiple&&(tn.hitState=!1),tn},F=()=>{setTimeout(()=>{const K=i.valueKey;i.multiple?e.selected.length>0?e.hoverIndex=Math.min.apply(null,e.selected.map(se=>A.value.findIndex(Me=>Tr(Me,K)===Tr(se,K)))):e.hoverIndex=-1:e.hoverIndex=A.value.findIndex(se=>it(se)===it(e.selected))},300)},Y=()=>{var K,se;ne(),(se=(K=o.value)==null?void 0:K.updatePopper)==null||se.call(K),i.multiple&&!i.filterable&&U()},ne=()=>{var K;e.inputWidth=(K=s.value)==null?void 0:K.$el.getBoundingClientRect().width},X=()=>{i.filterable&&e.query!==e.selectedLabel&&(e.query=e.selectedLabel,G(e.query))},J=Zl(()=>{X()},S.value),he=Zl(K=>{G(K.target.value)},S.value),ye=K=>{Iu(i.modelValue,K)||t.emit(rr,K)},Te=K=>{if(K.target.value.length<=0&&!Oe()){const se=i.modelValue.slice();se.pop(),t.emit(ri,se),ye(se)}K.target.value.length===1&&i.modelValue.length===0&&(e.currentPlaceholder=e.cachedPlaceHolder)},ce=(K,se)=>{const Me=e.selected.indexOf(se);if(Me>-1&&!b.value){const De=i.modelValue.slice();De.splice(Me,1),t.emit(ri,De),ye(De),t.emit("remove-tag",se.value)}K.stopPropagation()},ae=K=>{K.stopPropagation();const se=i.multiple?[]:"";if(!Ft(se))for(const Me of e.selected)Me.isDisabled&&se.push(Me.value);t.emit(ri,se),ye(se),e.hoverIndex=-1,e.visible=!1,t.emit("clear")},le=(K,se)=>{var Me;if(i.multiple){const De=(i.modelValue||[]).slice(),Tt=fe(De,K.value);Tt>-1?De.splice(Tt,1):(i.multipleLimit<=0||De.length<i.multipleLimit)&&De.push(K.value),t.emit(ri,De),ye(De),K.created&&(e.query="",G(""),e.inputLength=20),i.filterable&&((Me=a.value)==null||Me.focus())}else t.emit(ri,K.value),ye(K.value),e.visible=!1;e.isSilentBlur=se,Ue(),!e.visible&&ut(()=>{ie(K)})},fe=(K=[],se)=>{if(!oi(se))return K.indexOf(se);const Me=i.valueKey;let De=-1;return K.some((Tt,Zt)=>mn(Tr(Tt,Me))===Tr(se,Me)?(De=Zt,!0):!1),De},Ue=()=>{e.softFocus=!0;const K=a.value||s.value;K&&(K==null||K.focus())},ie=K=>{var se,Me,De,Tt,Zt;const tn=Array.isArray(K)?K[0]:K;let vn=null;if(tn!=null&&tn.value){const ui=A.value.filter(di=>di.value===tn.value);ui.length>0&&(vn=ui[0].$el)}if(o.value&&vn){const ui=(Tt=(De=(Me=(se=o.value)==null?void 0:se.popperRef)==null?void 0:Me.contentRef)==null?void 0:De.querySelector)==null?void 0:Tt.call(De,`.${r.be("dropdown","wrap")}`);ui&&_ae(ui,vn)}(Zt=u.value)==null||Zt.handleScroll()},oe=K=>{e.optionsCount++,e.filteredOptionsCount++,e.options.set(K.value,K),e.cachedOptions.set(K.value,K)},we=(K,se)=>{e.options.get(K)===se&&(e.optionsCount--,e.filteredOptionsCount--,e.options.delete(K))},Ae=K=>{K.code!==wt.backspace&&Oe(!1),e.inputLength=a.value.value.length*15+20,U()},Oe=K=>{if(!Array.isArray(e.selected))return;const se=e.selected[e.selected.length-1];if(se)return K===!0||K===!1?(se.hitState=K,K):(se.hitState=!se.hitState,se.hitState)},ve=K=>{const se=K.target.value;if(K.type==="compositionend")e.isOnComposition=!1,ut(()=>G(se));else{const Me=se[se.length-1]||"";e.isOnComposition=!O3(Me)}},ke=()=>{ut(()=>ie(e.selected))},be=K=>{e.softFocus?e.softFocus=!1:((i.automaticDropdown||i.filterable)&&(i.filterable&&!e.visible&&(e.menuVisibleOnFocus=!0),e.visible=!0),t.emit("focus",K))},$e=()=>{var K;e.visible=!1,(K=s.value)==null||K.blur()},Le=K=>{ut(()=>{e.isSilentBlur?e.isSilentBlur=!1:t.emit("blur",K)}),e.softFocus=!1},Ce=K=>{ae(K)},Be=()=>{e.visible=!1},He=K=>{e.visible&&(K.preventDefault(),K.stopPropagation(),e.visible=!1)},Xe=K=>{var se;K&&!e.mouseEnter||b.value||(e.menuVisibleOnFocus?e.menuVisibleOnFocus=!1:(!o.value||!o.value.isFocusInsideContent())&&(e.visible=!e.visible),e.visible&&((se=a.value||s.value)==null||se.focus()))},Je=()=>{e.visible?A.value[e.hoverIndex]&&le(A.value[e.hoverIndex],void 0):Xe()},it=K=>oi(K.value)?Tr(K.value,i.valueKey):K.value,Qe=R(()=>A.value.filter(K=>K.visible).every(K=>K.disabled)),te=K=>{if(!e.visible){e.visible=!0;return}if(!(e.options.size===0||e.filteredOptionsCount===0)&&!e.isOnComposition&&!Qe.value){K==="next"?(e.hoverIndex++,e.hoverIndex===e.options.size&&(e.hoverIndex=0)):K==="prev"&&(e.hoverIndex--,e.hoverIndex<0&&(e.hoverIndex=e.options.size-1));const se=A.value[e.hoverIndex];(se.disabled===!0||se.states.groupDisabled===!0||!se.visible)&&te(K),ut(()=>ie(d.value))}};return{optionsArray:A,selectSize:M,handleResize:Y,debouncedOnInputChange:J,debouncedQueryChange:he,deletePrevTag:Te,deleteTag:ce,deleteSelected:ae,handleOptionSelect:le,scrollToOption:ie,readonly:_,resetInputHeight:U,showClose:x,iconComponent:w,iconReverse:C,showNewOption:O,collapseTagSize:V,setSelected:D,managePlaceholder:H,selectDisabled:b,emptyText:E,toggleLastOptionHitState:Oe,resetInputState:Ae,handleComposition:ve,onOptionCreate:oe,onOptionDestroy:we,handleMenuEnter:ke,handleFocus:be,blur:$e,handleBlur:Le,handleClearClick:Ce,handleClose:Be,handleKeydownEscape:He,toggleMenu:Xe,selectOption:Je,getValueKey:it,navigateOptions:te,dropMenuVisible:L,queryChange:h,groupQueryChange:p,reference:s,input:a,tooltipRef:o,tags:l,selectWrapper:c,scrollbar:u,handleMouseEnter:()=>{e.mouseEnter=!0},handleMouseLeave:()=>{e.mouseEnter=!1}}},oK="ElSelect",D7e=de({name:oK,componentName:oK,components:{ElInput:ol,ElSelectMenu:I7e,ElOption:V9,ElTag:Y2,ElScrollbar:_g,ElTooltip:Jl,ElIcon:ct},directives:{ClickOutside:My},props:{name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:{type:String,validator:aM},effect:{type:String,default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},teleported:Xa.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Zn,default:Ny},fitInputWidth:{type:Boolean,default:!1},suffixIcon:{type:Zn,default:Fy},tagType:{...R9.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:{type:Boolean,default:!1},suffixTransition:{type:Boolean,default:!0},placement:{type:String,values:Ib,default:"bottom-start"}},emits:[ri,rr,"remove-tag","clear","visible-change","focus","blur"],setup(i,e){const t=Ne("select"),n=Ne("input"),{t:r}=Ki(),s=$7e(i),{optionsArray:a,selectSize:o,readonly:l,handleResize:c,collapseTagSize:u,debouncedOnInputChange:d,debouncedQueryChange:h,deletePrevTag:p,deleteTag:m,deleteSelected:g,handleOptionSelect:_,scrollToOption:b,setSelected:x,resetInputHeight:w,managePlaceholder:C,showClose:S,selectDisabled:E,iconComponent:A,iconReverse:P,showNewOption:O,emptyText:M,toggleLastOptionHitState:V,resetInputState:L,handleComposition:U,onOptionCreate:G,onOptionDestroy:H,handleMenuEnter:k,handleFocus:D,blur:$,handleBlur:F,handleClearClick:Y,handleClose:ne,handleKeydownEscape:X,toggleMenu:J,selectOption:he,getValueKey:ye,navigateOptions:Te,dropMenuVisible:ce,reference:ae,input:le,tooltipRef:fe,tags:Ue,selectWrapper:ie,scrollbar:oe,queryChange:we,groupQueryChange:Ae,handleMouseEnter:Oe,handleMouseLeave:ve}=L7e(i,s,e),{focus:ke}=h3e(ae),{inputWidth:be,selected:$e,inputLength:Le,filteredOptionsCount:Ce,visible:Be,softFocus:He,selectedLabel:Xe,hoverIndex:Je,query:it,inputHovering:Qe,currentPlaceholder:te,menuVisibleOnFocus:me,isOnComposition:Ie,isSilentBlur:K,options:se,cachedOptions:Me,optionsCount:De,prefixWidth:Tt,tagInMultiLine:Zt}=_a(s),tn=R(()=>{const ze=[t.b()],ft=v(o);return ft&&ze.push(t.m(ft)),i.disabled&&ze.push(t.m("disabled")),ze}),vn=R(()=>({maxWidth:`${v(be)-32}px`,width:"100%"})),ui=R(()=>({maxWidth:`${v(be)>123?v(be)-123:v(be)-75}px`}));pi(uM,Ji({props:i,options:se,optionsArray:a,cachedOptions:Me,optionsCount:De,filteredOptionsCount:Ce,hoverIndex:Je,handleOptionSelect:_,onOptionCreate:G,onOptionDestroy:H,selectWrapper:ie,selected:$e,setSelected:x,queryChange:we,groupQueryChange:Ae})),qt(()=>{s.cachedPlaceHolder=te.value=i.placeholder||r("el.select.placeholder"),i.multiple&&Array.isArray(i.modelValue)&&i.modelValue.length>0&&(te.value=""),fl(ie,c),i.remote&&i.multiple&&w(),ut(()=>{const ze=ae.value&&ae.value.$el;if(ze&&(be.value=ze.getBoundingClientRect().width,e.slots.prefix)){const ft=ze.querySelector(`.${n.e("prefix")}`);Tt.value=Math.max(ft.getBoundingClientRect().width+5,30)}}),x()}),i.multiple&&!Array.isArray(i.modelValue)&&e.emit(ri,[]),!i.multiple&&Array.isArray(i.modelValue)&&e.emit(ri,"");const di=R(()=>{var ze,ft;return(ft=(ze=fe.value)==null?void 0:ze.popperRef)==null?void 0:ft.contentRef});return{tagInMultiLine:Zt,prefixWidth:Tt,selectSize:o,readonly:l,handleResize:c,collapseTagSize:u,debouncedOnInputChange:d,debouncedQueryChange:h,deletePrevTag:p,deleteTag:m,deleteSelected:g,handleOptionSelect:_,scrollToOption:b,inputWidth:be,selected:$e,inputLength:Le,filteredOptionsCount:Ce,visible:Be,softFocus:He,selectedLabel:Xe,hoverIndex:Je,query:it,inputHovering:Qe,currentPlaceholder:te,menuVisibleOnFocus:me,isOnComposition:Ie,isSilentBlur:K,options:se,resetInputHeight:w,managePlaceholder:C,showClose:S,selectDisabled:E,iconComponent:A,iconReverse:P,showNewOption:O,emptyText:M,toggleLastOptionHitState:V,resetInputState:L,handleComposition:U,handleMenuEnter:k,handleFocus:D,blur:$,handleBlur:F,handleClearClick:Y,handleClose:ne,handleKeydownEscape:X,toggleMenu:J,selectOption:he,getValueKey:ye,navigateOptions:Te,dropMenuVisible:ce,focus:ke,reference:ae,input:le,tooltipRef:fe,popperPaneRef:di,tags:Ue,selectWrapper:ie,scrollbar:oe,wrapperKls:tn,selectTagsStyle:vn,nsSelect:t,tagTextStyle:ui,handleMouseEnter:Oe,handleMouseLeave:ve}}}),k7e=["disabled","autocomplete"],F7e={style:{height:"100%",display:"flex","justify-content":"center","align-items":"center"}};function N7e(i,e,t,n,r,s){const a=jt("el-tag"),o=jt("el-tooltip"),l=jt("el-icon"),c=jt("el-input"),u=jt("el-option"),d=jt("el-scrollbar"),h=jt("el-select-menu"),p=R2("click-outside");return zt((I(),Z("div",{ref:"selectWrapper",class:N(i.wrapperKls),onMouseenter:e[22]||(e[22]=(...m)=>i.handleMouseEnter&&i.handleMouseEnter(...m)),onMouseleave:e[23]||(e[23]=(...m)=>i.handleMouseLeave&&i.handleMouseLeave(...m)),onClick:e[24]||(e[24]=Dt((...m)=>i.toggleMenu&&i.toggleMenu(...m),["stop"]))},[re(o,{ref:"tooltipRef",visible:i.dropMenuVisible,placement:i.placement,teleported:i.teleported,"popper-class":[i.nsSelect.e("popper"),i.popperClass],"fallback-placements":["bottom-start","top-start","right","left"],effect:i.effect,pure:"",trigger:"click",transition:`${i.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:i.persistent,onShow:i.handleMenuEnter},{default:pe(()=>[Q("div",{class:"select-trigger",onMouseenter:e[20]||(e[20]=m=>i.inputHovering=!0),onMouseleave:e[21]||(e[21]=m=>i.inputHovering=!1)},[i.multiple?(I(),Z("div",{key:0,ref:"tags",class:N(i.nsSelect.e("tags")),style:pt(i.selectTagsStyle)},[i.collapseTags&&i.selected.length?(I(),Z("span",{key:0,class:N([i.nsSelect.b("tags-wrapper"),{"has-prefix":i.prefixWidth&&i.selected.length}])},[re(a,{closable:!i.selectDisabled&&!i.selected[0].isDisabled,size:i.collapseTagSize,hit:i.selected[0].hitState,type:i.tagType,"disable-transitions":"",onClose:e[0]||(e[0]=m=>i.deleteTag(m,i.selected[0]))},{default:pe(()=>[Q("span",{class:N(i.nsSelect.e("tags-text")),style:pt(i.tagTextStyle)},We(i.selected[0].currentLabel),7)]),_:1},8,["closable","size","hit","type"]),i.selected.length>1?(I(),Se(a,{key:0,closable:!1,size:i.collapseTagSize,type:i.tagType,"disable-transitions":""},{default:pe(()=>[i.collapseTagsTooltip?(I(),Se(o,{key:0,disabled:i.dropMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:i.effect,placement:"bottom",teleported:i.teleported},{default:pe(()=>[Q("span",{class:N(i.nsSelect.e("tags-text"))},"+ "+We(i.selected.length-1),3)]),content:pe(()=>[Q("div",{class:N(i.nsSelect.e("collapse-tags"))},[(I(!0),Z(gt,null,xi(i.selected.slice(1),(m,g)=>(I(),Z("div",{key:g,class:N(i.nsSelect.e("collapse-tag"))},[(I(),Se(a,{key:i.getValueKey(m),class:"in-tooltip",closable:!i.selectDisabled&&!m.isDisabled,size:i.collapseTagSize,hit:m.hitState,type:i.tagType,"disable-transitions":"",style:{margin:"2px"},onClose:_=>i.deleteTag(_,m)},{default:pe(()=>[Q("span",{class:N(i.nsSelect.e("tags-text")),style:pt({maxWidth:i.inputWidth-75+"px"})},We(m.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):(I(),Z("span",{key:1,class:N(i.nsSelect.e("tags-text"))},"+ "+We(i.selected.length-1),3))]),_:1},8,["size","type"])):_e("v-if",!0)],2)):_e("v-if",!0),_e(" <div> "),i.collapseTags?_e("v-if",!0):(I(),Se(Ss,{key:1,onAfterLeave:i.resetInputHeight},{default:pe(()=>[Q("span",{class:N([i.nsSelect.b("tags-wrapper"),{"has-prefix":i.prefixWidth&&i.selected.length}])},[(I(!0),Z(gt,null,xi(i.selected,m=>(I(),Se(a,{key:i.getValueKey(m),closable:!i.selectDisabled&&!m.isDisabled,size:i.collapseTagSize,hit:m.hitState,type:i.tagType,"disable-transitions":"",onClose:g=>i.deleteTag(g,m)},{default:pe(()=>[Q("span",{class:N(i.nsSelect.e("tags-text")),style:pt({maxWidth:i.inputWidth-75+"px"})},We(m.currentLabel),7)]),_:2},1032,["closable","size","hit","type","onClose"]))),128))],2)]),_:1},8,["onAfterLeave"])),_e(" </div> "),i.filterable?zt((I(),Z("input",{key:2,ref:"input","onUpdate:modelValue":e[1]||(e[1]=m=>i.query=m),type:"text",class:N([i.nsSelect.e("input"),i.nsSelect.is(i.selectSize)]),disabled:i.selectDisabled,autocomplete:i.autocomplete,style:pt({marginLeft:i.prefixWidth&&!i.selected.length||i.tagInMultiLine?`${i.prefixWidth}px`:"",flexGrow:1,width:`${i.inputLength/(i.inputWidth-32)}%`,maxWidth:`${i.inputWidth-42}px`}),onFocus:e[2]||(e[2]=(...m)=>i.handleFocus&&i.handleFocus(...m)),onBlur:e[3]||(e[3]=(...m)=>i.handleBlur&&i.handleBlur(...m)),onKeyup:e[4]||(e[4]=(...m)=>i.managePlaceholder&&i.managePlaceholder(...m)),onKeydown:[e[5]||(e[5]=(...m)=>i.resetInputState&&i.resetInputState(...m)),e[6]||(e[6]=Di(Dt(m=>i.navigateOptions("next"),["prevent"]),["down"])),e[7]||(e[7]=Di(Dt(m=>i.navigateOptions("prev"),["prevent"]),["up"])),e[8]||(e[8]=Di((...m)=>i.handleKeydownEscape&&i.handleKeydownEscape(...m),["esc"])),e[9]||(e[9]=Di(Dt((...m)=>i.selectOption&&i.selectOption(...m),["stop","prevent"]),["enter"])),e[10]||(e[10]=Di((...m)=>i.deletePrevTag&&i.deletePrevTag(...m),["delete"])),e[11]||(e[11]=Di(m=>i.visible=!1,["tab"]))],onCompositionstart:e[12]||(e[12]=(...m)=>i.handleComposition&&i.handleComposition(...m)),onCompositionupdate:e[13]||(e[13]=(...m)=>i.handleComposition&&i.handleComposition(...m)),onCompositionend:e[14]||(e[14]=(...m)=>i.handleComposition&&i.handleComposition(...m)),onInput:e[15]||(e[15]=(...m)=>i.debouncedQueryChange&&i.debouncedQueryChange(...m))},null,46,k7e)),[[Fz,i.query]]):_e("v-if",!0)],6)):_e("v-if",!0),re(c,{id:i.id,ref:"reference",modelValue:i.selectedLabel,"onUpdate:modelValue":e[16]||(e[16]=m=>i.selectedLabel=m),type:"text",placeholder:i.currentPlaceholder,name:i.name,autocomplete:i.autocomplete,size:i.selectSize,disabled:i.selectDisabled,readonly:i.readonly,"validate-event":!1,class:N([i.nsSelect.is("focus",i.visible)]),tabindex:i.multiple&&i.filterable?-1:void 0,onFocus:i.handleFocus,onBlur:i.handleBlur,onInput:i.debouncedOnInputChange,onPaste:i.debouncedOnInputChange,onCompositionstart:i.handleComposition,onCompositionupdate:i.handleComposition,onCompositionend:i.handleComposition,onKeydown:[e[17]||(e[17]=Di(Dt(m=>i.navigateOptions("next"),["stop","prevent"]),["down"])),e[18]||(e[18]=Di(Dt(m=>i.navigateOptions("prev"),["stop","prevent"]),["up"])),Di(Dt(i.selectOption,["stop","prevent"]),["enter"]),Di(i.handleKeydownEscape,["esc"]),e[19]||(e[19]=Di(m=>i.visible=!1,["tab"]))]},qm({suffix:pe(()=>[i.iconComponent&&!i.showClose?(I(),Se(l,{key:0,class:N([i.nsSelect.e("caret"),i.nsSelect.e("icon"),i.iconReverse])},{default:pe(()=>[(I(),Se(hi(i.iconComponent)))]),_:1},8,["class"])):_e("v-if",!0),i.showClose&&i.clearIcon?(I(),Se(l,{key:1,class:N([i.nsSelect.e("caret"),i.nsSelect.e("icon")]),onClick:i.handleClearClick},{default:pe(()=>[(I(),Se(hi(i.clearIcon)))]),_:1},8,["class","onClick"])):_e("v-if",!0)]),_:2},[i.$slots.prefix?{name:"prefix",fn:pe(()=>[Q("div",F7e,[Fe(i.$slots,"prefix")])])}:void 0]),1032,["id","modelValue","placeholder","name","autocomplete","size","disabled","readonly","class","tabindex","onFocus","onBlur","onInput","onPaste","onCompositionstart","onCompositionupdate","onCompositionend","onKeydown"])],32)]),content:pe(()=>[re(h,null,{default:pe(()=>[zt(re(d,{ref:"scrollbar",tag:"ul","wrap-class":i.nsSelect.be("dropdown","wrap"),"view-class":i.nsSelect.be("dropdown","list"),class:N([i.nsSelect.is("empty",!i.allowCreate&&Boolean(i.query)&&i.filteredOptionsCount===0)])},{default:pe(()=>[i.showNewOption?(I(),Se(u,{key:0,value:i.query,created:!0},null,8,["value"])):_e("v-if",!0),Fe(i.$slots,"default")]),_:3},8,["wrap-class","view-class","class"]),[[Ei,i.options.size>0&&!i.loading]]),i.emptyText&&(!i.allowCreate||i.loading||i.allowCreate&&i.options.size===0)?(I(),Z(gt,{key:0},[i.$slots.empty?Fe(i.$slots,"empty",{key:0}):(I(),Z("p",{key:1,class:N(i.nsSelect.be("dropdown","empty"))},We(i.emptyText),3))],64)):_e("v-if",!0)]),_:3})]),_:3},8,["visible","placement","teleported","popper-class","effect","transition","persistent","onShow"])],34)),[[p,i.handleClose,i.popperPaneRef]])}var V7e=qe(D7e,[["render",N7e],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/select.vue"]]);const B7e=de({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:{type:Boolean,default:!1}},setup(i){const e=Ne("select"),t=W(!0),n=ti(),r=W([]);pi(Xle,Ji({..._a(i)}));const s=ht(uM);qt(()=>{r.value=a(n.subTree)});const a=l=>{const c=[];return Array.isArray(l.children)&&l.children.forEach(u=>{var d;u.type&&u.type.name==="ElOption"&&u.component&&u.component.proxy?c.push(u.component.proxy):(d=u.children)!=null&&d.length&&c.push(...a(u))}),c},{groupQueryChange:o}=mn(s);return Ve(o,()=>{t.value=r.value.some(l=>l.visible===!0)},{flush:"post"}),{visible:t,ns:e}}});function z7e(i,e,t,n,r,s){return zt((I(),Z("ul",{class:N(i.ns.be("group","wrap"))},[Q("li",{class:N(i.ns.be("group","title"))},We(i.label),3),Q("li",null,[Q("ul",{class:N(i.ns.b("group"))},[Fe(i.$slots,"default")],2)])],2)),[[Ei,i.visible]])}var Zle=qe(B7e,[["render",z7e],["__file","/home/runner/work/element-plus/element-plus/packages/components/select/src/option-group.vue"]]);const lb=ii(V7e,{Option:V9,OptionGroup:Zle}),f$=Wr(V9),U7e=Wr(Zle),B9=()=>ht(Dae,{}),H7e=Ke({pageSize:{type:Number,required:!0},pageSizes:{type:xe(Array),default:()=>Ar([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,size:{type:String,values:gg}}),G7e=de({name:"ElPaginationSizes"}),W7e=de({...G7e,props:H7e,emits:["page-size-change"],setup(i,{emit:e}){const t=i,{t:n}=Ki(),r=Ne("pagination"),s=B9(),a=W(t.pageSize);Ve(()=>t.pageSizes,(c,u)=>{if(!Iu(c,u)&&Array.isArray(c)){const d=c.includes(t.pageSize)?t.pageSize:t.pageSizes[0];e("page-size-change",d)}}),Ve(()=>t.pageSize,c=>{a.value=c});const o=R(()=>t.pageSizes);function l(c){var u;c!==a.value&&(a.value=c,(u=s.handleSizeChange)==null||u.call(s,Number(c)))}return(c,u)=>(I(),Z("span",{class:N(v(r).e("sizes"))},[re(v(lb),{"model-value":a.value,disabled:c.disabled,"popper-class":c.popperClass,size:c.size,"validate-event":!1,onChange:l},{default:pe(()=>[(I(!0),Z(gt,null,xi(v(o),d=>(I(),Se(v(f$),{key:d,value:d,label:d+v(n)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size"])],2))}});var j7e=qe(W7e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/sizes.vue"]]);const q7e=Ke({size:{type:String,values:gg}}),K7e=["disabled"],Y7e=de({name:"ElPaginationJumper"}),X7e=de({...Y7e,props:q7e,setup(i){const{t:e}=Ki(),t=Ne("pagination"),{pageCount:n,disabled:r,currentPage:s,changeEvent:a}=B9(),o=W(),l=R(()=>{var d;return(d=o.value)!=null?d:s==null?void 0:s.value});function c(d){o.value=+d}function u(d){d=Math.trunc(+d),a==null||a(+d),o.value=void 0}return(d,h)=>(I(),Z("span",{class:N(v(t).e("jump")),disabled:v(r)},[Q("span",{class:N([v(t).e("goto")])},We(v(e)("el.pagination.goto")),3),re(v(ol),{size:d.size,class:N([v(t).e("editor"),v(t).is("in-pagination")]),min:1,max:v(n),disabled:v(r),"model-value":v(l),"validate-event":!1,type:"number","onUpdate:modelValue":c,onChange:u},null,8,["size","class","max","disabled","model-value"]),Q("span",{class:N([v(t).e("classifier")])},We(v(e)("el.pagination.pageClassifier")),3)],10,K7e))}});var Z7e=qe(X7e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/jumper.vue"]]);const Q7e=Ke({total:{type:Number,default:1e3}}),J7e=["disabled"],eHe=de({name:"ElPaginationTotal"}),tHe=de({...eHe,props:Q7e,setup(i){const{t:e}=Ki(),t=Ne("pagination"),{disabled:n}=B9();return(r,s)=>(I(),Z("span",{class:N(v(t).e("total")),disabled:v(n)},We(v(e)("el.pagination.total",{total:r.total})),11,J7e))}});var iHe=qe(tHe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/total.vue"]]);const nHe=Ke({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),rHe=["onKeyup"],sHe=["aria-current","tabindex"],aHe=["tabindex"],oHe=["aria-current","tabindex"],lHe=["tabindex"],cHe=["aria-current","tabindex"],uHe=de({name:"ElPaginationPager"}),dHe=de({...uHe,props:nHe,emits:["change"],setup(i,{emit:e}){const t=i,n=Ne("pager"),r=Ne("icon"),s=W(!1),a=W(!1),o=W(!1),l=W(!1),c=W(!1),u=W(!1),d=R(()=>{const b=t.pagerCount,x=(b-1)/2,w=Number(t.currentPage),C=Number(t.pageCount);let S=!1,E=!1;C>b&&(w>b-x&&(S=!0),w<C-x&&(E=!0));const A=[];if(S&&!E){const P=C-(b-2);for(let O=P;O<C;O++)A.push(O)}else if(!S&&E)for(let P=2;P<b;P++)A.push(P);else if(S&&E){const P=Math.floor(b/2)-1;for(let O=w-P;O<=w+P;O++)A.push(O)}else for(let P=2;P<C;P++)A.push(P);return A}),h=R(()=>t.disabled?-1:0);Ru(()=>{const b=(t.pagerCount-1)/2;s.value=!1,a.value=!1,t.pageCount>t.pagerCount&&(t.currentPage>t.pagerCount-b&&(s.value=!0),t.currentPage<t.pageCount-b&&(a.value=!0))});function p(b=!1){t.disabled||(b?o.value=!0:l.value=!0)}function m(b=!1){b?c.value=!0:u.value=!0}function g(b){const x=b.target;if(x.tagName.toLowerCase()==="li"&&Array.from(x.classList).includes("number")){const w=Number(x.textContent);w!==t.currentPage&&e("change",w)}else x.tagName.toLowerCase()==="li"&&Array.from(x.classList).includes("more")&&_(b)}function _(b){const x=b.target;if(x.tagName.toLowerCase()==="ul"||t.disabled)return;let w=Number(x.textContent);const C=t.pageCount,S=t.currentPage,E=t.pagerCount-2;x.className.includes("more")&&(x.className.includes("quickprev")?w=S-E:x.className.includes("quicknext")&&(w=S+E)),Number.isNaN(+w)||(w<1&&(w=1),w>C&&(w=C)),w!==S&&e("change",w)}return(b,x)=>(I(),Z("ul",{class:N(v(n).b()),onClick:_,onKeyup:Di(g,["enter"])},[b.pageCount>0?(I(),Z("li",{key:0,class:N([[v(n).is("active",b.currentPage===1),v(n).is("disabled",b.disabled)],"number"]),"aria-current":b.currentPage===1,tabindex:v(h)}," 1 ",10,sHe)):_e("v-if",!0),s.value?(I(),Z("li",{key:1,class:N(["more","btn-quickprev",v(r).b(),v(n).is("disabled",b.disabled)]),tabindex:v(h),onMouseenter:x[0]||(x[0]=w=>p(!0)),onMouseleave:x[1]||(x[1]=w=>o.value=!1),onFocus:x[2]||(x[2]=w=>m(!0)),onBlur:x[3]||(x[3]=w=>c.value=!1)},[(o.value||c.value)&&!b.disabled?(I(),Se(v(rC),{key:0})):(I(),Se(v(Kj),{key:1}))],42,aHe)):_e("v-if",!0),(I(!0),Z(gt,null,xi(v(d),w=>(I(),Z("li",{key:w,class:N([[v(n).is("active",b.currentPage===w),v(n).is("disabled",b.disabled)],"number"]),"aria-current":b.currentPage===w,tabindex:v(h)},We(w),11,oHe))),128)),a.value?(I(),Z("li",{key:2,class:N(["more","btn-quicknext",v(r).b(),v(n).is("disabled",b.disabled)]),tabindex:v(h),onMouseenter:x[4]||(x[4]=w=>p()),onMouseleave:x[5]||(x[5]=w=>l.value=!1),onFocus:x[6]||(x[6]=w=>m()),onBlur:x[7]||(x[7]=w=>u.value=!1)},[(l.value||u.value)&&!b.disabled?(I(),Se(v(sC),{key:0})):(I(),Se(v(Kj),{key:1}))],42,lHe)):_e("v-if",!0),b.pageCount>1?(I(),Z("li",{key:3,class:N([[v(n).is("active",b.currentPage===b.pageCount),v(n).is("disabled",b.disabled)],"number"]),"aria-current":b.currentPage===b.pageCount,tabindex:v(h)},We(b.pageCount),11,cHe)):_e("v-if",!0)],42,rHe))}});var hHe=qe(dHe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/pagination/src/components/pager.vue"]]);const ml=i=>typeof i!="number",pHe=Ke({total:Number,pageSize:Number,defaultPageSize:Number,currentPage:Number,defaultCurrentPage:Number,pageCount:Number,pagerCount:{type:Number,validator:i=>It(i)&&Math.trunc(i)===i&&i>4&&i<22&&i%2===1,default:7},layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:xe(Array),default:()=>Ar([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:Zn,default:()=>Ty},nextText:{type:String,default:""},nextIcon:{type:Zn,default:()=>Wl},small:Boolean,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean}),fHe={"update:current-page":i=>It(i),"update:page-size":i=>It(i),"size-change":i=>It(i),"current-change":i=>It(i),"prev-click":i=>It(i),"next-click":i=>It(i)},lK="ElPagination";var mHe=de({name:lK,props:pHe,emits:fHe,setup(i,{emit:e,slots:t}){const{t:n}=Ki(),r=Ne("pagination"),s=ti().vnode.props||{},a="onUpdate:currentPage"in s||"onUpdate:current-page"in s||"onCurrentChange"in s,o="onUpdate:pageSize"in s||"onUpdate:page-size"in s||"onSizeChange"in s,l=R(()=>{if(ml(i.total)&&ml(i.pageCount)||!ml(i.currentPage)&&!a)return!1;if(i.layout.includes("sizes")){if(ml(i.pageCount)){if(!ml(i.total)&&!ml(i.pageSize)&&!o)return!1}else if(!o)return!1}return!0}),c=W(ml(i.defaultPageSize)?10:i.defaultPageSize),u=W(ml(i.defaultCurrentPage)?1:i.defaultCurrentPage),d=R({get(){return ml(i.pageSize)?c.value:i.pageSize},set(w){ml(i.pageSize)&&(c.value=w),o&&(e("update:page-size",w),e("size-change",w))}}),h=R(()=>{let w=0;return ml(i.pageCount)?ml(i.total)||(w=Math.max(1,Math.ceil(i.total/d.value))):w=i.pageCount,w}),p=R({get(){return ml(i.currentPage)?u.value:i.currentPage},set(w){let C=w;w<1?C=1:w>h.value&&(C=h.value),ml(i.currentPage)&&(u.value=C),a&&(e("update:current-page",C),e("current-change",C))}});Ve(h,w=>{p.value>w&&(p.value=w)});function m(w){p.value=w}function g(w){d.value=w;const C=h.value;p.value>C&&(p.value=C)}function _(){i.disabled||(p.value-=1,e("prev-click",p.value))}function b(){i.disabled||(p.value+=1,e("next-click",p.value))}function x(w,C){w&&(w.props||(w.props={}),w.props.class=[w.props.class,C].join(" "))}return pi(Dae,{pageCount:h,disabled:R(()=>i.disabled),currentPage:p,changeEvent:m,handleSizeChange:g}),()=>{var w,C;if(!l.value)return n("el.pagination.deprecationWarning"),null;if(!i.layout||i.hideOnSinglePage&&h.value<=1)return null;const S=[],E=[],A=bt("div",{class:r.e("rightwrapper")},E),P={prev:bt(b7e,{disabled:i.disabled,currentPage:p.value,prevText:i.prevText,prevIcon:i.prevIcon,onClick:_}),jumper:bt(Z7e,{size:i.small?"small":"default"}),pager:bt(hHe,{currentPage:p.value,pageCount:h.value,pagerCount:i.pagerCount,onChange:m,disabled:i.disabled}),next:bt(E7e,{disabled:i.disabled,currentPage:p.value,pageCount:h.value,nextText:i.nextText,nextIcon:i.nextIcon,onClick:b}),sizes:bt(j7e,{pageSize:d.value,pageSizes:i.pageSizes,popperClass:i.popperClass,disabled:i.disabled,size:i.small?"small":"default"}),slot:(C=(w=t==null?void 0:t.default)==null?void 0:w.call(t))!=null?C:null,total:bt(iHe,{total:ml(i.total)?0:i.total})},O=i.layout.split(",").map(V=>V.trim());let M=!1;return O.forEach(V=>{if(V==="->"){M=!0;return}M?E.push(P[V]):S.push(P[V])}),x(S[0],r.is("first")),x(S[S.length-1],r.is("last")),M&&E.length>0&&(x(E[0],r.is("first")),x(E[E.length-1],r.is("last")),S.push(A)),bt("div",{role:"pagination","aria-label":"pagination",class:[r.b(),r.is("background",i.background),{[r.m("small")]:i.small}]},S)}}});const gHe=ii(mHe),vHe=Ke({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:$5,default:"primary"},cancelButtonType:{type:String,values:$5,default:"text"},icon:{type:Zn,default:()=>I$e},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},onConfirm:{type:xe(Function)},onCancel:{type:xe(Function)},teleported:Xa.teleported,persistent:Xa.persistent,width:{type:[String,Number],default:150}}),yHe=de({name:"ElPopconfirm"}),_He=de({...yHe,props:vHe,setup(i){const e=i,{t}=Ki(),n=Ne("popconfirm"),r=W(),s=()=>{var d,h;(h=(d=r.value)==null?void 0:d.onClose)==null||h.call(d)},a=R(()=>({width:Xs(e.width)})),o=d=>{var h;(h=e.onConfirm)==null||h.call(e,d),s()},l=d=>{var h;(h=e.onCancel)==null||h.call(e,d),s()},c=R(()=>e.confirmButtonText||t("el.popconfirm.confirmButtonText")),u=R(()=>e.cancelButtonText||t("el.popconfirm.cancelButtonText"));return(d,h)=>(I(),Se(v(Jl),ci({ref_key:"tooltipRef",ref:r,trigger:"click",effect:"light"},d.$attrs,{"popper-class":`${v(n).namespace.value}-popover`,"popper-style":v(a),teleported:d.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":d.hideAfter,persistent:d.persistent}),{content:pe(()=>[Q("div",{class:N(v(n).b())},[Q("div",{class:N(v(n).e("main"))},[!d.hideIcon&&d.icon?(I(),Se(v(ct),{key:0,class:N(v(n).e("icon")),style:pt({color:d.iconColor})},{default:pe(()=>[(I(),Se(hi(d.icon)))]),_:1},8,["class","style"])):_e("v-if",!0),Gi(" "+We(d.title),1)],2),Q("div",{class:N(v(n).e("action"))},[re(v(Bo),{size:"small",type:d.cancelButtonType==="text"?"":d.cancelButtonType,text:d.cancelButtonType==="text",onClick:l},{default:pe(()=>[Gi(We(v(u)),1)]),_:1},8,["type","text"]),re(v(Bo),{size:"small",type:d.confirmButtonType==="text"?"":d.confirmButtonType,text:d.confirmButtonType==="text",onClick:o},{default:pe(()=>[Gi(We(v(c)),1)]),_:1},8,["type","text"])],2)],2)]),default:pe(()=>[d.$slots.reference?Fe(d.$slots,"reference",{key:0}):_e("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var bHe=qe(_He,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popconfirm/src/popconfirm.vue"]]);const wHe=ii(bHe),xHe=Ke({trigger:q2.trigger,placement:ER.placement,disabled:q2.disabled,visible:Xa.visible,transition:Xa.transition,popperOptions:ER.popperOptions,tabindex:ER.tabindex,content:Xa.content,popperStyle:Xa.popperStyle,popperClass:Xa.popperClass,enterable:{...Xa.enterable,default:!0},effect:{...Xa.effect,default:"light"},teleported:Xa.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),CHe={"update:visible":i=>Ys(i),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},THe="onUpdate:visible",SHe=de({name:"ElPopover"}),EHe=de({...SHe,props:xHe,emits:CHe,setup(i,{expose:e,emit:t}){const n=i,r=R(()=>n[THe]),s=Ne("popover"),a=W(),o=R(()=>{var _;return(_=v(a))==null?void 0:_.popperRef}),l=R(()=>[{width:Xs(n.width)},n.popperStyle]),c=R(()=>[s.b(),n.popperClass,{[s.m("plain")]:!!n.content}]),u=R(()=>n.transition===`${s.namespace.value}-fade-in-linear`),d=()=>{var _;(_=a.value)==null||_.hide()},h=()=>{t("before-enter")},p=()=>{t("before-leave")},m=()=>{t("after-enter")},g=()=>{t("update:visible",!1),t("after-leave")};return e({popperRef:o,hide:d}),(_,b)=>(I(),Se(v(Jl),ci({ref_key:"tooltipRef",ref:a},_.$attrs,{trigger:_.trigger,placement:_.placement,disabled:_.disabled,visible:_.visible,transition:_.transition,"popper-options":_.popperOptions,tabindex:_.tabindex,content:_.content,offset:_.offset,"show-after":_.showAfter,"hide-after":_.hideAfter,"auto-close":_.autoClose,"show-arrow":_.showArrow,"aria-label":_.title,effect:_.effect,enterable:_.enterable,"popper-class":v(c),"popper-style":v(l),teleported:_.teleported,persistent:_.persistent,"gpu-acceleration":v(u),"onUpdate:visible":v(r),onBeforeShow:h,onBeforeHide:p,onShow:m,onHide:g}),{content:pe(()=>[_.title?(I(),Z("div",{key:0,class:N(v(s).e("title")),role:"title"},We(_.title),3)):_e("v-if",!0),Fe(_.$slots,"default",{},()=>[Gi(We(_.content),1)])]),default:pe(()=>[_.$slots.reference?Fe(_.$slots,"reference",{key:0}):_e("v-if",!0)]),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}});var AHe=qe(EHe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popover/src/popover.vue"]]);const cK=(i,e)=>{const t=e.arg||e.value,n=t==null?void 0:t.popperRef;n&&(n.triggerRef=i)};var MHe={mounted(i,e){cK(i,e)},updated(i,e){cK(i,e)}};const PHe="popover",Qle=e3e(MHe,PHe),OHe=ii(AHe,{directive:Qle}),RHe=Ke({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:i=>i>=0&&i<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:xe(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:xe([String,Array,Function]),default:""},format:{type:xe(Function),default:i=>`${i}%`}}),IHe=["aria-valuenow"],$He={viewBox:"0 0 100 100"},LHe=["d","stroke","stroke-width"],DHe=["d","stroke","opacity","stroke-linecap","stroke-width"],kHe={key:0},FHe=de({name:"ElProgress"}),NHe=de({...FHe,props:RHe,setup(i){const e=i,t={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},n=Ne("progress"),r=R(()=>({width:`${e.percentage}%`,animationDuration:`${e.duration}s`,backgroundColor:x(e.percentage)})),s=R(()=>(e.strokeWidth/e.width*100).toFixed(1)),a=R(()=>["circle","dashboard"].includes(e.type)?Number.parseInt(`${50-Number.parseFloat(s.value)/2}`,10):0),o=R(()=>{const w=a.value,C=e.type==="dashboard";return`
          M 50 50
          m 0 ${C?"":"-"}${w}
          a ${w} ${w} 0 1 1 0 ${C?"-":""}${w*2}
          a ${w} ${w} 0 1 1 0 ${C?"":"-"}${w*2}
          `}),l=R(()=>2*Math.PI*a.value),c=R(()=>e.type==="dashboard"?.75:1),u=R(()=>`${-1*l.value*(1-c.value)/2}px`),d=R(()=>({strokeDasharray:`${l.value*c.value}px, ${l.value}px`,strokeDashoffset:u.value})),h=R(()=>({strokeDasharray:`${l.value*c.value*(e.percentage/100)}px, ${l.value}px`,strokeDashoffset:u.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),p=R(()=>{let w;return e.color?w=x(e.percentage):w=t[e.status]||t.default,w}),m=R(()=>e.status==="warning"?M3:e.type==="line"?e.status==="success"?n9:Ny:e.status==="success"?sM:Rh),g=R(()=>e.type==="line"?12+e.strokeWidth*.4:e.width*.111111+2),_=R(()=>e.format(e.percentage));function b(w){const C=100/w.length;return w.map((E,A)=>Ft(E)?{color:E,percentage:(A+1)*C}:E).sort((E,A)=>E.percentage-A.percentage)}const x=w=>{var C;const{color:S}=e;if(Lt(S))return S(w);if(Ft(S))return S;{const E=b(S);for(const A of E)if(A.percentage>w)return A.color;return(C=E[E.length-1])==null?void 0:C.color}};return(w,C)=>(I(),Z("div",{class:N([v(n).b(),v(n).m(w.type),v(n).is(w.status),{[v(n).m("without-text")]:!w.showText,[v(n).m("text-inside")]:w.textInside}]),role:"progressbar","aria-valuenow":w.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[w.type==="line"?(I(),Z("div",{key:0,class:N(v(n).b("bar"))},[Q("div",{class:N(v(n).be("bar","outer")),style:pt({height:`${w.strokeWidth}px`})},[Q("div",{class:N([v(n).be("bar","inner"),{[v(n).bem("bar","inner","indeterminate")]:w.indeterminate}]),style:pt(v(r))},[(w.showText||w.$slots.default)&&w.textInside?(I(),Z("div",{key:0,class:N(v(n).be("bar","innerText"))},[Fe(w.$slots,"default",{percentage:w.percentage},()=>[Q("span",null,We(v(_)),1)])],2)):_e("v-if",!0)],6)],6)],2)):(I(),Z("div",{key:1,class:N(v(n).b("circle")),style:pt({height:`${w.width}px`,width:`${w.width}px`})},[(I(),Z("svg",$He,[Q("path",{class:N(v(n).be("circle","track")),d:v(o),stroke:`var(${v(n).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-width":v(s),fill:"none",style:pt(v(d))},null,14,LHe),Q("path",{class:N(v(n).be("circle","path")),d:v(o),stroke:v(p),fill:"none",opacity:w.percentage?1:0,"stroke-linecap":w.strokeLinecap,"stroke-width":v(s),style:pt(v(h))},null,14,DHe)]))],6)),(w.showText||w.$slots.default)&&!w.textInside?(I(),Z("div",{key:2,class:N(v(n).e("text")),style:pt({fontSize:`${v(g)}px`})},[Fe(w.$slots,"default",{percentage:w.percentage},()=>[w.status?(I(),Se(v(ct),{key:1},{default:pe(()=>[(I(),Se(hi(v(m))))]),_:1})):(I(),Z("span",kHe,We(v(_)),1))])],6)):_e("v-if",!0)],10,IHe))}});var VHe=qe(NHe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/progress/src/progress.vue"]]);const Jle=ii(VHe),BHe=Ke({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:xe([Array,Object]),default:()=>Ar(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:xe([Array,Object]),default:()=>[qM,qM,qM]},voidIcon:{type:Zn,default:()=>SLe},disabledVoidIcon:{type:Zn,default:()=>qM},disabled:{type:Boolean},allowHalf:{type:Boolean},showText:{type:Boolean},showScore:{type:Boolean},textColor:{type:String,default:""},texts:{type:xe(Array),default:()=>Ar(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:{type:String,validator:aM},label:{type:String,default:void 0},clearable:{type:Boolean,default:!1}}),zHe={[rr]:i=>It(i),[ri]:i=>It(i)},UHe=["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"],HHe=["onMousemove","onClick"],GHe=de({name:"ElRate"}),WHe=de({...GHe,props:BHe,emits:zHe,setup(i,{expose:e,emit:t}){const n=i;function r(k,D){const $=ne=>oi(ne),F=Object.keys(D).map(ne=>+ne).filter(ne=>{const X=D[ne];return($(X)?X.excluded:!1)?k<ne:k<=ne}).sort((ne,X)=>ne-X),Y=D[F[0]];return $(Y)&&Y.value||Y}const s=ht(Rb,void 0),a=ht(uf,void 0),o=Qs(),l=Ne("rate"),{inputId:c,isLabeledByFormItem:u}=By(n,{formItemContext:a}),d=W(n.modelValue),h=W(-1),p=W(!0),m=R(()=>[l.b(),l.m(o.value)]),g=R(()=>n.disabled||(s==null?void 0:s.disabled)),_=R(()=>l.cssVarBlock({"void-color":n.voidColor,"disabled-void-color":n.disabledVoidColor,"fill-color":C.value})),b=R(()=>{let k="";return n.showScore?k=n.scoreTemplate.replace(/\{\s*value\s*\}/,g.value?`${n.modelValue}`:`${d.value}`):n.showText&&(k=n.texts[Math.ceil(d.value)-1]),k}),x=R(()=>n.modelValue*100-Math.floor(n.modelValue)*100),w=R(()=>st(n.colors)?{[n.lowThreshold]:n.colors[0],[n.highThreshold]:{value:n.colors[1],excluded:!0},[n.max]:n.colors[2]}:n.colors),C=R(()=>{const k=r(d.value,w.value);return oi(k)?"":k}),S=R(()=>{let k="";return g.value?k=`${x.value}%`:n.allowHalf&&(k="50%"),{color:C.value,width:k}}),E=R(()=>{let k=st(n.icons)?[...n.icons]:{...n.icons};return k=F0(k),st(k)?{[n.lowThreshold]:k[0],[n.highThreshold]:{value:k[1],excluded:!0},[n.max]:k[2]}:k}),A=R(()=>r(n.modelValue,E.value)),P=R(()=>g.value?Ft(n.disabledVoidIcon)?n.disabledVoidIcon:F0(n.disabledVoidIcon):Ft(n.voidIcon)?n.voidIcon:F0(n.voidIcon)),O=R(()=>r(d.value,E.value));function M(k){const D=g.value&&x.value>0&&k-1<n.modelValue&&k>n.modelValue,$=n.allowHalf&&p.value&&k-.5<=d.value&&k>d.value;return D||$}function V(k){n.clearable&&k===n.modelValue&&(k=0),t(ri,k),n.modelValue!==k&&t("change",k)}function L(k){g.value||(n.allowHalf&&p.value?V(d.value):V(k))}function U(k){if(g.value)return;let D=d.value;const $=k.code;return $===wt.up||$===wt.right?(n.allowHalf?D+=.5:D+=1,k.stopPropagation(),k.preventDefault()):($===wt.left||$===wt.down)&&(n.allowHalf?D-=.5:D-=1,k.stopPropagation(),k.preventDefault()),D=D<0?0:D,D=D>n.max?n.max:D,t(ri,D),t("change",D),D}function G(k,D){if(!g.value){if(n.allowHalf){let $=D.target;Th($,l.e("item"))&&($=$.querySelector(`.${l.e("icon")}`)),($.clientWidth===0||Th($,l.e("decimal")))&&($=$.parentNode),p.value=D.offsetX*2<=$.clientWidth,d.value=p.value?k-.5:k}else d.value=k;h.value=k}}function H(){g.value||(n.allowHalf&&(p.value=n.modelValue!==Math.floor(n.modelValue)),d.value=n.modelValue,h.value=-1)}return Ve(()=>n.modelValue,k=>{d.value=k,p.value=n.modelValue!==Math.floor(n.modelValue)}),n.modelValue||t(ri,0),e({setCurrentValue:G,resetCurrentValue:H}),(k,D)=>{var $;return I(),Z("div",{id:v(c),class:N([v(m),v(l).is("disabled",v(g))]),role:"slider","aria-label":v(u)?void 0:k.label||"rating","aria-labelledby":v(u)?($=v(a))==null?void 0:$.labelId:void 0,"aria-valuenow":d.value,"aria-valuetext":v(b)||void 0,"aria-valuemin":"0","aria-valuemax":k.max,tabindex:"0",style:pt(v(_)),onKeydown:U},[(I(!0),Z(gt,null,xi(k.max,(F,Y)=>(I(),Z("span",{key:Y,class:N(v(l).e("item")),onMousemove:ne=>G(F,ne),onMouseleave:H,onClick:ne=>L(F)},[re(v(ct),{class:N([v(l).e("icon"),{hover:h.value===F},v(l).is("active",F<=d.value)])},{default:pe(()=>[M(F)?_e("v-if",!0):(I(),Z(gt,{key:0},[zt((I(),Se(hi(v(O)),null,null,512)),[[Ei,F<=d.value]]),zt((I(),Se(hi(v(P)),null,null,512)),[[Ei,!(F<=d.value)]])],64)),M(F)?(I(),Se(v(ct),{key:1,style:pt(v(S)),class:N([v(l).e("icon"),v(l).e("decimal")])},{default:pe(()=>[(I(),Se(hi(v(A))))]),_:1},8,["style","class"])):_e("v-if",!0)]),_:2},1032,["class"])],42,HHe))),128)),k.showText||k.showScore?(I(),Z("span",{key:0,class:N(v(l).e("text"))},We(v(b)),3)):_e("v-if",!0)],46,UHe)}}});var jHe=qe(WHe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/rate/src/rate.vue"]]);const qHe=ii(jHe),Iw={success:"icon-success",warning:"icon-warning",error:"icon-error",info:"icon-info"},uK={[Iw.success]:IRe,[Iw.warning]:M3,[Iw.error]:r9,[Iw.info]:s9},KHe=Ke({title:{type:String,default:""},subTitle:{type:String,default:""},icon:{type:String,values:["success","warning","info","error"],default:"info"}}),YHe=de({name:"ElResult"}),XHe=de({...YHe,props:KHe,setup(i){const e=i,t=Ne("result"),n=R(()=>{const r=e.icon,s=r&&Iw[r]?Iw[r]:"icon-info",a=uK[s]||uK["icon-info"];return{class:s,component:a}});return(r,s)=>(I(),Z("div",{class:N(v(t).b())},[Q("div",{class:N(v(t).e("icon"))},[Fe(r.$slots,"icon",{},()=>[v(n).component?(I(),Se(hi(v(n).component),{key:0,class:N(v(n).class)},null,8,["class"])):_e("v-if",!0)])],2),r.title||r.$slots.title?(I(),Z("div",{key:0,class:N(v(t).e("title"))},[Fe(r.$slots,"title",{},()=>[Q("p",null,We(r.title),1)])],2)):_e("v-if",!0),r.subTitle||r.$slots["sub-title"]?(I(),Z("div",{key:1,class:N(v(t).e("subtitle"))},[Fe(r.$slots,"sub-title",{},()=>[Q("p",null,We(r.subTitle),1)])],2)):_e("v-if",!0),r.$slots.extra?(I(),Z("div",{key:2,class:N(v(t).e("extra"))},[Fe(r.$slots,"extra")],2)):_e("v-if",!0)],2))}});var ZHe=qe(XHe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/result/src/result.vue"]]);const QHe=ii(ZHe),JHe=["start","center","end","space-around","space-between","space-evenly"],eGe=["top","middle","bottom"],tGe=Ke({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:JHe,default:"start"},align:{type:String,values:eGe,default:"top"}}),iGe=de({name:"ElRow"}),nGe=de({...iGe,props:tGe,setup(i){const e=i,t=Ne("row"),n=R(()=>e.gutter);pi(Fae,{gutter:n});const r=R(()=>{const a={};return e.gutter&&(a.marginRight=a.marginLeft=`-${e.gutter/2}px`),a}),s=R(()=>[t.b(),t.is(`justify-${e.justify}`,e.justify!=="start"),t.is(`align-${e.align}`,e.align!=="top")]);return(a,o)=>(I(),Se(hi(a.tag),{class:N(v(s)),style:pt(v(r))},{default:pe(()=>[Fe(a.$slots,"default")]),_:3},8,["class","style"]))}});var rGe=qe(nGe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/row/src/row.vue"]]);const sGe=ii(rGe);var dK=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function aGe(i,e){return!!(i===e||dK(i)&&dK(e))}function oGe(i,e){if(i.length!==e.length)return!1;for(var t=0;t<i.length;t++)if(!aGe(i[t],e[t]))return!1;return!0}function lGe(i,e){e===void 0&&(e=oGe);var t=null;function n(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(t&&t.lastThis===this&&e(r,t.lastArgs))return t.lastResult;var a=i.apply(this,r);return t={lastResult:a,lastArgs:r,lastThis:this},a}return n.clear=function(){t=null},n}const ece=()=>{const e=ti().proxy.$props;return R(()=>{const t=(n,r,s)=>({});return e.perfMode?C3(t):lGe(t)})},hV=50,m$="itemRendered",g$="scroll",$w="forward",v$="backward",yd="auto",G3="smart",Q2="start",Fp="center",J2="end",dC="horizontal",z9="vertical",cGe="ltr",_x="rtl",eA="negative",U9="positive-ascending",H9="positive-descending",uGe={[dC]:"left",[z9]:"top"},dGe=20,hGe={[dC]:"deltaX",[z9]:"deltaY"},pGe=({atEndEdge:i,atStartEdge:e,layout:t},n)=>{let r,s=0;const a=l=>l<0&&e.value||l>0&&i.value;return{hasReachedEdge:a,onWheel:l=>{R3(r);const c=l[hGe[t.value]];a(s)&&a(s+c)||(s+=c,o9()||l.preventDefault(),r=U2(()=>{n(s),s=0}))}}},pV=Fh({type:xe([Number,Function]),required:!0}),fV=Fh({type:Number}),mV=Fh({type:Number,default:2}),fGe=Fh({type:String,values:["ltr","rtl"],default:"ltr"}),gV=Fh({type:Number,default:0}),y$=Fh({type:Number,required:!0}),tce=Fh({type:String,values:["horizontal","vertical"],default:z9}),ice=Ke({className:{type:String,default:""},containerElement:{type:xe([String,Object]),default:"div"},data:{type:xe(Array),default:()=>Ar([])},direction:fGe,height:{type:[String,Number],required:!0},innerElement:{type:[String,Object],default:"div"},style:{type:xe([Object,String,Array])},useIsScrolling:{type:Boolean,default:!1},width:{type:[Number,String],required:!1},perfMode:{type:Boolean,default:!0},scrollbarAlwaysOn:{type:Boolean,default:!1}}),nce=Ke({cache:mV,estimatedItemSize:fV,layout:tce,initScrollOffset:gV,total:y$,itemSize:pV,...ice}),vV={type:Number,default:6},rce={type:Number,default:0},sce={type:Number,default:2},z0=Ke({columnCache:mV,columnWidth:pV,estimatedColumnWidth:fV,estimatedRowHeight:fV,initScrollLeft:gV,initScrollTop:gV,itemKey:{type:xe(Function),default:({columnIndex:i,rowIndex:e})=>`${e}:${i}`},rowCache:mV,rowHeight:pV,totalColumn:y$,totalRow:y$,hScrollbarSize:vV,vScrollbarSize:vV,scrollbarStartGap:rce,scrollbarEndGap:sce,...ice}),ace=Ke({alwaysOn:Boolean,class:String,layout:tce,total:y$,ratio:{type:Number,required:!0},clientSize:{type:Number,required:!0},scrollFrom:{type:Number,required:!0},scrollbarSize:vV,startGap:rce,endGap:sce,visible:Boolean}),x0=(i,e)=>i<e?$w:v$,tA=i=>i===cGe||i===_x||i===dC,hK=i=>i===_x;let Qb=null;function _$(i=!1){if(Qb===null||i){const e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";const n=document.createElement("div"),r=n.style;return r.width="100px",r.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?Qb=H9:(e.scrollLeft=1,e.scrollLeft===0?Qb=eA:Qb=U9),document.body.removeChild(e),Qb}return Qb}function mGe({move:i,size:e,bar:t},n){const r={},s=`translate${t.axis}(${i}px)`;return r[t.size]=e,r.transform=s,r.msTransform=s,r.webkitTransform=s,n==="horizontal"?r.height="100%":r.width="100%",r}const yV=de({name:"ElVirtualScrollBar",props:ace,emits:["scroll","start-move","stop-move"],setup(i,{emit:e}){const t=R(()=>i.startGap+i.endGap),n=Ne("virtual-scrollbar"),r=Ne("scrollbar"),s=W(),a=W();let o=null,l=null;const c=Ji({isDragging:!1,traveled:0}),u=R(()=>woe[i.layout]),d=R(()=>i.clientSize-v(t)),h=R(()=>({position:"absolute",width:`${dC===i.layout?d.value:i.scrollbarSize}px`,height:`${dC===i.layout?i.scrollbarSize:d.value}px`,[uGe[i.layout]]:"2px",right:"2px",bottom:"2px",borderRadius:"4px"})),p=R(()=>{const E=i.ratio,A=i.clientSize;if(E>=100)return Number.POSITIVE_INFINITY;if(E>=50)return E*A/100;const P=A/3;return Math.floor(Math.min(Math.max(E*A,dGe),P))}),m=R(()=>{if(!Number.isFinite(p.value))return{display:"none"};const E=`${p.value}px`;return mGe({bar:u.value,size:E,move:c.traveled},i.layout)}),g=R(()=>Math.floor(i.clientSize-p.value-v(t))),_=()=>{window.addEventListener("mousemove",C),window.addEventListener("mouseup",w);const E=v(a);E&&(l=document.onselectstart,document.onselectstart=()=>!1,E.addEventListener("touchmove",C),E.addEventListener("touchend",w))},b=()=>{window.removeEventListener("mousemove",C),window.removeEventListener("mouseup",w),document.onselectstart=l,l=null;const E=v(a);E&&(E.removeEventListener("touchmove",C),E.removeEventListener("touchend",w))},x=E=>{E.stopImmediatePropagation(),!(E.ctrlKey||[1,2].includes(E.button))&&(c.isDragging=!0,c[u.value.axis]=E.currentTarget[u.value.offset]-(E[u.value.client]-E.currentTarget.getBoundingClientRect()[u.value.direction]),e("start-move"),_())},w=()=>{c.isDragging=!1,c[u.value.axis]=0,e("stop-move"),b()},C=E=>{const{isDragging:A}=c;if(!A||!a.value||!s.value)return;const P=c[u.value.axis];if(!P)return;R3(o);const O=(s.value.getBoundingClientRect()[u.value.direction]-E[u.value.client])*-1,M=a.value[u.value.offset]-P,V=O-M;o=U2(()=>{c.traveled=Math.max(i.startGap,Math.min(V,g.value)),e("scroll",V,g.value)})},S=E=>{const A=Math.abs(E.target.getBoundingClientRect()[u.value.direction]-E[u.value.client]),P=a.value[u.value.offset]/2,O=A-P;c.traveled=Math.max(0,Math.min(O,g.value)),e("scroll",O,g.value)};return Ve(()=>i.scrollFrom,E=>{c.isDragging||(c.traveled=Math.ceil(E*g.value))}),Vr(()=>{b()}),()=>bt("div",{role:"presentation",ref:s,class:[n.b(),i.class,(i.alwaysOn||c.isDragging)&&"always-on"],style:h.value,onMousedown:Dt(S,["stop","prevent"]),onTouchstartPrevent:x},bt("div",{ref:a,class:r.e("thumb"),style:m.value,onMousedown:x},[]))}}),oce=({name:i,getOffset:e,getItemSize:t,getItemOffset:n,getEstimatedTotalSize:r,getStartIndexForOffset:s,getStopIndexForStartIndex:a,initCache:o,clearCache:l,validateProps:c})=>de({name:i??"ElVirtualList",props:nce,emits:[m$,g$],setup(u,{emit:d,expose:h}){c(u);const p=ti(),m=Ne("vl"),g=W(o(u,p)),_=ece(),b=W(),x=W(),w=W(),C=W({isScrolling:!1,scrollDir:"forward",scrollOffset:It(u.initScrollOffset)?u.initScrollOffset:0,updateRequested:!1,isScrollbarDragging:!1,scrollbarAlwaysOn:u.scrollbarAlwaysOn}),S=R(()=>{const{total:J,cache:he}=u,{isScrolling:ye,scrollDir:Te,scrollOffset:ce}=v(C);if(J===0)return[0,0,0,0];const ae=s(u,ce,v(g)),le=a(u,ae,ce,v(g)),fe=!ye||Te===v$?Math.max(1,he):1,Ue=!ye||Te===$w?Math.max(1,he):1;return[Math.max(0,ae-fe),Math.max(0,Math.min(J-1,le+Ue)),ae,le]}),E=R(()=>r(u,v(g))),A=R(()=>tA(u.layout)),P=R(()=>[{position:"relative",[`overflow-${A.value?"x":"y"}`]:"scroll",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:u.direction,height:It(u.height)?`${u.height}px`:u.height,width:It(u.width)?`${u.width}px`:u.width},u.style]),O=R(()=>{const J=v(E),he=v(A);return{height:he?"100%":`${J}px`,pointerEvents:v(C).isScrolling?"none":void 0,width:he?`${J}px`:"100%"}}),M=R(()=>A.value?u.width:u.height),{onWheel:V}=pGe({atStartEdge:R(()=>C.value.scrollOffset<=0),atEndEdge:R(()=>C.value.scrollOffset>=E.value),layout:R(()=>u.layout)},J=>{var he,ye;(ye=(he=w.value).onMouseUp)==null||ye.call(he),D(Math.min(C.value.scrollOffset+J,E.value-M.value))}),L=()=>{const{total:J}=u;if(J>0){const[ce,ae,le,fe]=v(S);d(m$,ce,ae,le,fe)}const{scrollDir:he,scrollOffset:ye,updateRequested:Te}=v(C);d(g$,he,ye,Te)},U=J=>{const{clientHeight:he,scrollHeight:ye,scrollTop:Te}=J.currentTarget,ce=v(C);if(ce.scrollOffset===Te)return;const ae=Math.max(0,Math.min(Te,ye-he));C.value={...ce,isScrolling:!0,scrollDir:x0(ce.scrollOffset,ae),scrollOffset:ae,updateRequested:!1},ut(Y)},G=J=>{const{clientWidth:he,scrollLeft:ye,scrollWidth:Te}=J.currentTarget,ce=v(C);if(ce.scrollOffset===ye)return;const{direction:ae}=u;let le=ye;if(ae===_x)switch(_$()){case eA:{le=-ye;break}case H9:{le=Te-he-ye;break}}le=Math.max(0,Math.min(le,Te-he)),C.value={...ce,isScrolling:!0,scrollDir:x0(ce.scrollOffset,le),scrollOffset:le,updateRequested:!1},ut(Y)},H=J=>{v(A)?G(J):U(J),L()},k=(J,he)=>{const ye=(E.value-M.value)/he*J;D(Math.min(E.value-M.value,ye))},D=J=>{J=Math.max(J,0),J!==v(C).scrollOffset&&(C.value={...v(C),scrollOffset:J,scrollDir:x0(v(C).scrollOffset,J),updateRequested:!0},ut(Y))},$=(J,he=yd)=>{const{scrollOffset:ye}=v(C);J=Math.max(0,Math.min(J,u.total-1)),D(e(u,J,he,ye,v(g)))},F=J=>{const{direction:he,itemSize:ye,layout:Te}=u,ce=_.value(l&&ye,l&&Te,l&&he);let ae;if(Ci(ce,String(J)))ae=ce[J];else{const le=n(u,J,v(g)),fe=t(u,J,v(g)),Ue=v(A),ie=he===_x,oe=Ue?le:0;ce[J]=ae={position:"absolute",left:ie?void 0:`${oe}px`,right:ie?`${oe}px`:void 0,top:Ue?0:`${le}px`,height:Ue?"100%":`${fe}px`,width:Ue?`${fe}px`:"100%"}}return ae},Y=()=>{C.value.isScrolling=!1,ut(()=>{_.value(-1,null,null)})},ne=()=>{const J=b.value;J&&(J.scrollTop=0)};qt(()=>{if(!Ii)return;const{initScrollOffset:J}=u,he=v(b);It(J)&&he&&(v(A)?he.scrollLeft=J:he.scrollTop=J),L()}),pg(()=>{const{direction:J,layout:he}=u,{scrollOffset:ye,updateRequested:Te}=v(C),ce=v(b);if(Te&&ce)if(he===dC)if(J===_x)switch(_$()){case eA:{ce.scrollLeft=-ye;break}case U9:{ce.scrollLeft=ye;break}default:{const{clientWidth:ae,scrollWidth:le}=ce;ce.scrollLeft=le-ae-ye;break}}else ce.scrollLeft=ye;else ce.scrollTop=ye});const X={ns:m,clientSize:M,estimatedTotalSize:E,windowStyle:P,windowRef:b,innerRef:x,innerStyle:O,itemsToRender:S,scrollbarRef:w,states:C,getItemStyle:F,onScroll:H,onScrollbarScroll:k,onWheel:V,scrollTo:D,scrollToItem:$,resetScrollTop:ne};return h({windowRef:b,innerRef:x,getItemStyleCache:_,scrollTo:D,scrollToItem:$,resetScrollTop:ne,states:C}),X},render(u){var d;const{$slots:h,className:p,clientSize:m,containerElement:g,data:_,getItemStyle:b,innerElement:x,itemsToRender:w,innerStyle:C,layout:S,total:E,onScroll:A,onScrollbarScroll:P,onWheel:O,states:M,useIsScrolling:V,windowStyle:L,ns:U}=u,[G,H]=w,k=hi(g),D=hi(x),$=[];if(E>0)for(let X=G;X<=H;X++)$.push((d=h.default)==null?void 0:d.call(h,{data:_,key:X,index:X,isScrolling:V?M.isScrolling:void 0,style:b(X)}));const F=[bt(D,{style:C,ref:"innerRef"},Ft(D)?$:{default:()=>$})],Y=bt(yV,{ref:"scrollbarRef",clientSize:m,layout:S,onScroll:P,ratio:m*100/this.estimatedTotalSize,scrollFrom:M.scrollOffset/(this.estimatedTotalSize-m),total:E}),ne=bt(k,{class:[U.e("window"),p],style:L,onScroll:A,onWheel:O,ref:"windowRef",key:0},Ft(k)?[F]:{default:()=>[F]});return bt("div",{key:0,class:[U.e("wrapper"),M.scrollbarAlwaysOn?"always-on":""]},[ne,Y])}}),lce=oce({name:"ElFixedSizeList",getItemOffset:({itemSize:i},e)=>e*i,getItemSize:({itemSize:i})=>i,getEstimatedTotalSize:({total:i,itemSize:e})=>e*i,getOffset:({height:i,total:e,itemSize:t,layout:n,width:r},s,a,o)=>{const l=tA(n)?r:i,c=Math.max(0,e*t-l),u=Math.min(c,s*t),d=Math.max(0,(s+1)*t-l);switch(a===G3&&(o>=d-l&&o<=u+l?a=yd:a=Fp),a){case Q2:return u;case J2:return d;case Fp:{const h=Math.round(d+(u-d)/2);return h<Math.ceil(l/2)?0:h>c+Math.floor(l/2)?c:h}case yd:default:return o>=d&&o<=u?o:o<d?d:u}},getStartIndexForOffset:({total:i,itemSize:e},t)=>Math.max(0,Math.min(i-1,Math.floor(t/e))),getStopIndexForStartIndex:({height:i,total:e,itemSize:t,layout:n,width:r},s,a)=>{const o=s*t,l=tA(n)?r:i,c=Math.ceil((l+a-o)/t);return Math.max(0,Math.min(e-1,s+c-1))},initCache(){},clearCache:!0,validateProps(){}}),Lw=(i,e,t)=>{const{itemSize:n}=i,{items:r,lastVisitedIndex:s}=t;if(e>s){let a=0;if(s>=0){const o=r[s];a=o.offset+o.size}for(let o=s+1;o<=e;o++){const l=n(o);r[o]={offset:a,size:l},a+=l}t.lastVisitedIndex=e}return r[e]},gGe=(i,e,t)=>{const{items:n,lastVisitedIndex:r}=e;return(r>0?n[r].offset:0)>=t?cce(i,e,0,r,t):vGe(i,e,Math.max(0,r),t)},cce=(i,e,t,n,r)=>{for(;t<=n;){const s=t+Math.floor((n-t)/2),a=Lw(i,s,e).offset;if(a===r)return s;a<r?t=s+1:a>r&&(n=s-1)}return Math.max(0,t-1)},vGe=(i,e,t,n)=>{const{total:r}=i;let s=1;for(;t<r&&Lw(i,t,e).offset<n;)t+=s,s*=2;return cce(i,e,Math.floor(t/2),Math.min(t,r-1),n)},pK=({total:i},{items:e,estimatedItemSize:t,lastVisitedIndex:n})=>{let r=0;if(n>=i&&(n=i-1),n>=0){const o=e[n];r=o.offset+o.size}const a=(i-n-1)*t;return r+a},yGe=oce({name:"ElDynamicSizeList",getItemOffset:(i,e,t)=>Lw(i,e,t).offset,getItemSize:(i,e,{items:t})=>t[e].size,getEstimatedTotalSize:pK,getOffset:(i,e,t,n,r)=>{const{height:s,layout:a,width:o}=i,l=tA(a)?o:s,c=Lw(i,e,r),u=pK(i,r),d=Math.max(0,Math.min(u-l,c.offset)),h=Math.max(0,c.offset-l+c.size);switch(t===G3&&(n>=h-l&&n<=d+l?t=yd:t=Fp),t){case Q2:return d;case J2:return h;case Fp:return Math.round(h+(d-h)/2);case yd:default:return n>=h&&n<=d?n:n<h?h:d}},getStartIndexForOffset:(i,e,t)=>gGe(i,t,e),getStopIndexForStartIndex:(i,e,t,n)=>{const{height:r,total:s,layout:a,width:o}=i,l=tA(a)?o:r,c=Lw(i,e,n),u=t+l;let d=c.offset+c.size,h=e;for(;h<s-1&&d<u;)h++,d+=Lw(i,h,n).size;return h},initCache({estimatedItemSize:i=hV},e){const t={items:{},estimatedItemSize:i,lastVisitedIndex:-1};return t.clearCacheAfterIndex=(n,r=!0)=>{var s,a;t.lastVisitedIndex=Math.min(t.lastVisitedIndex,n-1),(s=e.exposed)==null||s.getItemStyleCache(-1),r&&((a=e.proxy)==null||a.$forceUpdate())},t},clearCache:!1,validateProps:({itemSize:i})=>{}}),_Ge=({atXEndEdge:i,atXStartEdge:e,atYEndEdge:t,atYStartEdge:n},r)=>{let s=null,a=0,o=0;const l=(u,d)=>{const h=u<0&&e.value||u>0&&i.value,p=d<0&&n.value||d>0&&t.value;return h&&p};return{hasReachedEdge:l,onWheel:u=>{R3(s);let d=u.deltaX,h=u.deltaY;Math.abs(d)>Math.abs(h)?h=0:d=0,u.shiftKey&&h!==0&&(d=h,h=0),!(l(a,o)&&l(a+d,o+h))&&(a+=d,o+=h,o9()||u.preventDefault(),s=U2(()=>{r(a,o),a=0,o=0}))}}},uce=({name:i,clearCache:e,getColumnPosition:t,getColumnStartIndexForOffset:n,getColumnStopIndexForStartIndex:r,getEstimatedTotalHeight:s,getEstimatedTotalWidth:a,getColumnOffset:o,getRowOffset:l,getRowPosition:c,getRowStartIndexForOffset:u,getRowStopIndexForStartIndex:d,initCache:h,injectToInstance:p,validateProps:m})=>de({name:i??"ElVirtualList",props:z0,emits:[m$,g$],setup(g,{emit:_,expose:b,slots:x}){const w=Ne("vl");m(g);const C=ti(),S=W(h(g,C));p==null||p(C,S);const E=W(),A=W(),P=W(),O=W(null),M=W({isScrolling:!1,scrollLeft:It(g.initScrollLeft)?g.initScrollLeft:0,scrollTop:It(g.initScrollTop)?g.initScrollTop:0,updateRequested:!1,xAxisScrollDir:$w,yAxisScrollDir:$w}),V=ece(),L=R(()=>Number.parseInt(`${g.height}`,10)),U=R(()=>Number.parseInt(`${g.width}`,10)),G=R(()=>{const{totalColumn:ve,totalRow:ke,columnCache:be}=g,{isScrolling:$e,xAxisScrollDir:Le,scrollLeft:Ce}=v(M);if(ve===0||ke===0)return[0,0,0,0];const Be=n(g,Ce,v(S)),He=r(g,Be,Ce,v(S)),Xe=!$e||Le===v$?Math.max(1,be):1,Je=!$e||Le===$w?Math.max(1,be):1;return[Math.max(0,Be-Xe),Math.max(0,Math.min(ve-1,He+Je)),Be,He]}),H=R(()=>{const{totalColumn:ve,totalRow:ke,rowCache:be}=g,{isScrolling:$e,yAxisScrollDir:Le,scrollTop:Ce}=v(M);if(ve===0||ke===0)return[0,0,0,0];const Be=u(g,Ce,v(S)),He=d(g,Be,Ce,v(S)),Xe=!$e||Le===v$?Math.max(1,be):1,Je=!$e||Le===$w?Math.max(1,be):1;return[Math.max(0,Be-Xe),Math.max(0,Math.min(ke-1,He+Je)),Be,He]}),k=R(()=>s(g,v(S))),D=R(()=>a(g,v(S))),$=R(()=>{var ve;return[{position:"relative",overflow:"hidden",WebkitOverflowScrolling:"touch",willChange:"transform"},{direction:g.direction,height:It(g.height)?`${g.height}px`:g.height,width:It(g.width)?`${g.width}px`:g.width},(ve=g.style)!=null?ve:{}]}),F=R(()=>{const ve=`${v(D)}px`;return{height:`${v(k)}px`,pointerEvents:v(M).isScrolling?"none":void 0,width:ve}}),Y=()=>{const{totalColumn:ve,totalRow:ke}=g;if(ve>0&&ke>0){const[He,Xe,Je,it]=v(G),[Qe,te,me,Ie]=v(H);_(m$,{columnCacheStart:He,columnCacheEnd:Xe,rowCacheStart:Qe,rowCacheEnd:te,columnVisibleStart:Je,columnVisibleEnd:it,rowVisibleStart:me,rowVisibleEnd:Ie})}const{scrollLeft:be,scrollTop:$e,updateRequested:Le,xAxisScrollDir:Ce,yAxisScrollDir:Be}=v(M);_(g$,{xAxisScrollDir:Ce,scrollLeft:be,yAxisScrollDir:Be,scrollTop:$e,updateRequested:Le})},ne=ve=>{const{clientHeight:ke,clientWidth:be,scrollHeight:$e,scrollLeft:Le,scrollTop:Ce,scrollWidth:Be}=ve.currentTarget,He=v(M);if(He.scrollTop===Ce&&He.scrollLeft===Le)return;let Xe=Le;if(hK(g.direction))switch(_$()){case eA:Xe=-Le;break;case H9:Xe=Be-be-Le;break}M.value={...He,isScrolling:!0,scrollLeft:Xe,scrollTop:Math.max(0,Math.min(Ce,$e-ke)),updateRequested:!0,xAxisScrollDir:x0(He.scrollLeft,Xe),yAxisScrollDir:x0(He.scrollTop,Ce)},ut(()=>ae()),le(),Y()},X=(ve,ke)=>{const be=v(L),$e=(k.value-be)/ke*ve;ye({scrollTop:Math.min(k.value-be,$e)})},J=(ve,ke)=>{const be=v(U),$e=(D.value-be)/ke*ve;ye({scrollLeft:Math.min(D.value-be,$e)})},{onWheel:he}=_Ge({atXStartEdge:R(()=>M.value.scrollLeft<=0),atXEndEdge:R(()=>M.value.scrollLeft>=D.value),atYStartEdge:R(()=>M.value.scrollTop<=0),atYEndEdge:R(()=>M.value.scrollTop>=k.value)},(ve,ke)=>{var be,$e,Le,Ce;($e=(be=A.value)==null?void 0:be.onMouseUp)==null||$e.call(be),(Ce=(Le=A.value)==null?void 0:Le.onMouseUp)==null||Ce.call(Le);const Be=v(U),He=v(L);ye({scrollLeft:Math.min(M.value.scrollLeft+ve,D.value-Be),scrollTop:Math.min(M.value.scrollTop+ke,k.value-He)})}),ye=({scrollLeft:ve=M.value.scrollLeft,scrollTop:ke=M.value.scrollTop})=>{ve=Math.max(ve,0),ke=Math.max(ke,0);const be=v(M);ke===be.scrollTop&&ve===be.scrollLeft||(M.value={...be,xAxisScrollDir:x0(be.scrollLeft,ve),yAxisScrollDir:x0(be.scrollTop,ke),scrollLeft:ve,scrollTop:ke,updateRequested:!0},ut(()=>ae()),le(),Y())},Te=(ve=0,ke=0,be=yd)=>{const $e=v(M);ke=Math.max(0,Math.min(ke,g.totalColumn-1)),ve=Math.max(0,Math.min(ve,g.totalRow-1));const Le=yae(w.namespace.value),Ce=v(S),Be=s(g,Ce),He=a(g,Ce);ye({scrollLeft:o(g,ke,be,$e.scrollLeft,Ce,He>g.width?Le:0),scrollTop:l(g,ve,be,$e.scrollTop,Ce,Be>g.height?Le:0)})},ce=(ve,ke)=>{const{columnWidth:be,direction:$e,rowHeight:Le}=g,Ce=V.value(e&&be,e&&Le,e&&$e),Be=`${ve},${ke}`;if(Ci(Ce,Be))return Ce[Be];{const[,He]=t(g,ke,v(S)),Xe=v(S),Je=hK($e),[it,Qe]=c(g,ve,Xe),[te]=t(g,ke,Xe);return Ce[Be]={position:"absolute",left:Je?void 0:`${He}px`,right:Je?`${He}px`:void 0,top:`${Qe}px`,height:`${it}px`,width:`${te}px`},Ce[Be]}},ae=()=>{M.value.isScrolling=!1,ut(()=>{V.value(-1,null,null)})};qt(()=>{if(!Ii)return;const{initScrollLeft:ve,initScrollTop:ke}=g,be=v(E);be&&(It(ve)&&(be.scrollLeft=ve),It(ke)&&(be.scrollTop=ke)),Y()});const le=()=>{const{direction:ve}=g,{scrollLeft:ke,scrollTop:be,updateRequested:$e}=v(M),Le=v(E);if($e&&Le){if(ve===_x)switch(_$()){case eA:{Le.scrollLeft=-ke;break}case U9:{Le.scrollLeft=ke;break}default:{const{clientWidth:Ce,scrollWidth:Be}=Le;Le.scrollLeft=Be-Ce-ke;break}}else Le.scrollLeft=Math.max(0,ke);Le.scrollTop=Math.max(0,be)}},{resetAfterColumnIndex:fe,resetAfterRowIndex:Ue,resetAfter:ie}=C.proxy;b({windowRef:E,innerRef:O,getItemStyleCache:V,scrollTo:ye,scrollToItem:Te,states:M,resetAfterColumnIndex:fe,resetAfterRowIndex:Ue,resetAfter:ie});const oe=()=>{const{scrollbarAlwaysOn:ve,scrollbarStartGap:ke,scrollbarEndGap:be,totalColumn:$e,totalRow:Le}=g,Ce=v(U),Be=v(L),He=v(D),Xe=v(k),{scrollLeft:Je,scrollTop:it}=v(M),Qe=bt(yV,{ref:A,alwaysOn:ve,startGap:ke,endGap:be,class:w.e("horizontal"),clientSize:Ce,layout:"horizontal",onScroll:J,ratio:Ce*100/He,scrollFrom:Je/(He-Ce),total:Le,visible:!0}),te=bt(yV,{ref:P,alwaysOn:ve,startGap:ke,endGap:be,class:w.e("vertical"),clientSize:Be,layout:"vertical",onScroll:X,ratio:Be*100/Xe,scrollFrom:it/(Xe-Be),total:$e,visible:!0});return{horizontalScrollbar:Qe,verticalScrollbar:te}},we=()=>{var ve;const[ke,be]=v(G),[$e,Le]=v(H),{data:Ce,totalColumn:Be,totalRow:He,useIsScrolling:Xe,itemKey:Je}=g,it=[];if(He>0&&Be>0)for(let Qe=$e;Qe<=Le;Qe++)for(let te=ke;te<=be;te++)it.push((ve=x.default)==null?void 0:ve.call(x,{columnIndex:te,data:Ce,key:Je({columnIndex:te,data:Ce,rowIndex:Qe}),isScrolling:Xe?v(M).isScrolling:void 0,style:ce(Qe,te),rowIndex:Qe}));return it},Ae=()=>{const ve=hi(g.innerElement),ke=we();return[bt(ve,{style:v(F),ref:O},Ft(ve)?ke:{default:()=>ke})]};return()=>{const ve=hi(g.containerElement),{horizontalScrollbar:ke,verticalScrollbar:be}=oe(),$e=Ae();return bt("div",{key:0,class:w.e("wrapper")},[bt(ve,{class:g.className,style:v($),onScroll:ne,onWheel:he,ref:E},Ft(ve)?$e:{default:()=>$e}),ke,be])}}}),bGe=uce({name:"ElFixedSizeGrid",getColumnPosition:({columnWidth:i},e)=>[i,e*i],getRowPosition:({rowHeight:i},e)=>[i,e*i],getEstimatedTotalHeight:({totalRow:i,rowHeight:e})=>e*i,getEstimatedTotalWidth:({totalColumn:i,columnWidth:e})=>e*i,getColumnOffset:({totalColumn:i,columnWidth:e,width:t},n,r,s,a,o)=>{t=Number(t);const l=Math.max(0,i*e-t),c=Math.min(l,n*e),u=Math.max(0,n*e-t+o+e);switch(r==="smart"&&(s>=u-t&&s<=c+t?r=yd:r=Fp),r){case Q2:return c;case J2:return u;case Fp:{const d=Math.round(u+(c-u)/2);return d<Math.ceil(t/2)?0:d>l+Math.floor(t/2)?l:d}case yd:default:return s>=u&&s<=c?s:u>c||s<u?u:c}},getRowOffset:({rowHeight:i,height:e,totalRow:t},n,r,s,a,o)=>{e=Number(e);const l=Math.max(0,t*i-e),c=Math.min(l,n*i),u=Math.max(0,n*i-e+o+i);switch(r===G3&&(s>=u-e&&s<=c+e?r=yd:r=Fp),r){case Q2:return c;case J2:return u;case Fp:{const d=Math.round(u+(c-u)/2);return d<Math.ceil(e/2)?0:d>l+Math.floor(e/2)?l:d}case yd:default:return s>=u&&s<=c?s:u>c||s<u?u:c}},getColumnStartIndexForOffset:({columnWidth:i,totalColumn:e},t)=>Math.max(0,Math.min(e-1,Math.floor(t/i))),getColumnStopIndexForStartIndex:({columnWidth:i,totalColumn:e,width:t},n,r)=>{const s=n*i,a=Math.ceil((t+r-s)/i);return Math.max(0,Math.min(e-1,n+a-1))},getRowStartIndexForOffset:({rowHeight:i,totalRow:e},t)=>Math.max(0,Math.min(e-1,Math.floor(t/i))),getRowStopIndexForStartIndex:({rowHeight:i,totalRow:e,height:t},n,r)=>{const s=n*i,a=Math.ceil((t+r-s)/i);return Math.max(0,Math.min(e-1,n+a-1))},initCache:()=>{},clearCache:!0,validateProps:({columnWidth:i,rowHeight:e})=>{}}),{max:b$,min:dce,floor:hce}=Math,wGe={column:"columnWidth",row:"rowHeight"},_V={column:"lastVisitedColumnIndex",row:"lastVisitedRowIndex"},mm=(i,e,t,n)=>{const[r,s,a]=[t[n],i[wGe[n]],t[_V[n]]];if(e>a){let o=0;if(a>=0){const l=r[a];o=l.offset+l.size}for(let l=a+1;l<=e;l++){const c=s(l);r[l]={offset:o,size:c},o+=c}t[_V[n]]=e}return r[e]},pce=(i,e,t,n,r,s)=>{for(;t<=n;){const a=t+hce((n-t)/2),o=mm(i,a,e,s).offset;if(o===r)return a;o<r?t=a+1:n=a-1}return b$(0,t-1)},xGe=(i,e,t,n,r)=>{const s=r==="column"?i.totalColumn:i.totalRow;let a=1;for(;t<s&&mm(i,t,e,r).offset<n;)t+=a,a*=2;return pce(i,e,hce(t/2),dce(t,s-1),n,r)},fK=(i,e,t,n)=>{const[r,s]=[e[n],e[_V[n]]];return(s>0?r[s].offset:0)>=t?pce(i,e,0,s,t,n):xGe(i,e,b$(0,s),t,n)},fce=({totalRow:i},{estimatedRowHeight:e,lastVisitedRowIndex:t,row:n})=>{let r=0;if(t>=i&&(t=i-1),t>=0){const o=n[t];r=o.offset+o.size}const a=(i-t-1)*e;return r+a},mce=({totalColumn:i},{column:e,estimatedColumnWidth:t,lastVisitedColumnIndex:n})=>{let r=0;if(n>i&&(n=i-1),n>=0){const o=e[n];r=o.offset+o.size}const a=(i-n-1)*t;return r+a},CGe={column:mce,row:fce},mK=(i,e,t,n,r,s,a)=>{const[o,l]=[s==="row"?i.height:i.width,CGe[s]],c=mm(i,e,r,s),u=l(i,r),d=b$(0,dce(u-o,c.offset)),h=b$(0,c.offset-o+a+c.size);switch(t===G3&&(n>=h-o&&n<=d+o?t=yd:t=Fp),t){case Q2:return d;case J2:return h;case Fp:return Math.round(h+(d-h)/2);case yd:default:return n>=h&&n<=d?n:h>d||n<h?h:d}},TGe=uce({name:"ElDynamicSizeGrid",getColumnPosition:(i,e,t)=>{const n=mm(i,e,t,"column");return[n.size,n.offset]},getRowPosition:(i,e,t)=>{const n=mm(i,e,t,"row");return[n.size,n.offset]},getColumnOffset:(i,e,t,n,r,s)=>mK(i,e,t,n,r,"column",s),getRowOffset:(i,e,t,n,r,s)=>mK(i,e,t,n,r,"row",s),getColumnStartIndexForOffset:(i,e,t)=>fK(i,t,e,"column"),getColumnStopIndexForStartIndex:(i,e,t,n)=>{const r=mm(i,e,n,"column"),s=t+i.width;let a=r.offset+r.size,o=e;for(;o<i.totalColumn-1&&a<s;)o++,a+=mm(i,e,n,"column").size;return o},getEstimatedTotalHeight:fce,getEstimatedTotalWidth:mce,getRowStartIndexForOffset:(i,e,t)=>fK(i,t,e,"row"),getRowStopIndexForStartIndex:(i,e,t,n)=>{const{totalRow:r,height:s}=i,a=mm(i,e,n,"row"),o=t+s;let l=a.size+a.offset,c=e;for(;c<r-1&&l<o;)c++,l+=mm(i,c,n,"row").size;return c},injectToInstance:(i,e)=>{const t=({columnIndex:s,rowIndex:a},o)=>{var l,c;o=eo(o)?!0:o,It(s)&&(e.value.lastVisitedColumnIndex=Math.min(e.value.lastVisitedColumnIndex,s-1)),It(a)&&(e.value.lastVisitedRowIndex=Math.min(e.value.lastVisitedRowIndex,a-1)),(l=i.exposed)==null||l.getItemStyleCache.value(-1,null,null),o&&((c=i.proxy)==null||c.$forceUpdate())},n=(s,a)=>{t({columnIndex:s},a)},r=(s,a)=>{t({rowIndex:s},a)};Object.assign(i.proxy,{resetAfterColumnIndex:n,resetAfterRowIndex:r,resetAfter:t})},initCache:({estimatedColumnWidth:i=hV,estimatedRowHeight:e=hV})=>({column:{},estimatedColumnWidth:i,estimatedRowHeight:e,lastVisitedColumnIndex:-1,lastVisitedRowIndex:-1,row:{}}),clearCache:!1,validateProps:({columnWidth:i,rowHeight:e})=>{}}),SGe=de({props:{item:{type:Object,required:!0},style:Object,height:Number},setup(){return{ns:Ne("select")}}});function EGe(i,e,t,n,r,s){return i.item.isTitle?(I(),Z("div",{key:0,class:N(i.ns.be("group","title")),style:pt([i.style,{lineHeight:`${i.height}px`}])},We(i.item.label),7)):(I(),Z("div",{key:1,class:N(i.ns.be("group","split")),style:pt(i.style)},[Q("span",{class:N(i.ns.be("group","split-dash")),style:pt({top:`${i.height/2}px`})},null,6)],6))}var AGe=qe(SGe,[["render",EGe],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/group-item.vue"]]);function MGe(i,{emit:e}){return{hoverItem:()=>{i.disabled||e("hover",i.index)},selectOptionClick:()=>{i.disabled||e("select",i.item,i.index)}}}const PGe={allowCreate:Boolean,autocomplete:{type:String,default:"none"},automaticDropdown:Boolean,clearable:Boolean,clearIcon:{type:[String,Object],default:Ny},effect:{type:String,default:"light"},collapseTags:Boolean,collapseTagsTooltip:{type:Boolean,default:!1},defaultFirstOption:Boolean,disabled:Boolean,estimatedOptionHeight:{type:Number,default:void 0},filterable:Boolean,filterMethod:Function,height:{type:Number,default:170},itemHeight:{type:Number,default:34},id:String,loading:Boolean,loadingText:String,label:String,modelValue:[Array,String,Number,Boolean,Object],multiple:Boolean,multipleLimit:{type:Number,default:0},name:String,noDataText:String,noMatchText:String,remoteMethod:Function,reserveKeyword:{type:Boolean,default:!0},options:{type:Array,required:!0},placeholder:{type:String},teleported:Xa.teleported,persistent:{type:Boolean,default:!0},popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>({})},remote:Boolean,size:{type:String,validator:aM},valueKey:{type:String,default:"value"},scrollbarAlwaysOn:{type:Boolean,default:!1},validateEvent:{type:Boolean,default:!0},placement:{type:xe(String),values:Ib,default:"bottom-start"}},OGe={data:Array,disabled:Boolean,hovering:Boolean,item:Object,index:Number,style:Object,selected:Boolean,created:Boolean},RGe=de({props:OGe,emits:["select","hover"],setup(i,{emit:e}){const t=Ne("select"),{hoverItem:n,selectOptionClick:r}=MGe(i,{emit:e});return{ns:t,hoverItem:n,selectOptionClick:r}}}),IGe=["aria-selected"];function $Ge(i,e,t,n,r,s){return I(),Z("li",{"aria-selected":i.selected,style:pt(i.style),class:N([i.ns.be("dropdown","option-item"),i.ns.is("selected",i.selected),i.ns.is("disabled",i.disabled),i.ns.is("created",i.created),{hover:i.hovering}]),onMouseenter:e[0]||(e[0]=(...a)=>i.hoverItem&&i.hoverItem(...a)),onClick:e[1]||(e[1]=Dt((...a)=>i.selectOptionClick&&i.selectOptionClick(...a),["stop"]))},[Fe(i.$slots,"default",{item:i.item,index:i.index,disabled:i.disabled},()=>[Q("span",null,We(i.item.label),1)])],46,IGe)}var LGe=qe(RGe,[["render",$Ge],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/option-item.vue"]]);const gce="ElSelectV2Injection";var DGe=de({name:"ElSelectDropdown",props:{data:{type:Array,required:!0},hoveringIndex:Number,width:Number},setup(i,{slots:e,expose:t}){const n=ht(gce),r=Ne("select"),s=W([]),a=W(),o=R(()=>i.data.length);Ve(()=>o.value,()=>{var P,O;(O=(P=n.popper.value).updatePopper)==null||O.call(P)});const l=R(()=>eo(n.props.estimatedOptionHeight)),c=R(()=>l.value?{itemSize:n.props.itemHeight}:{estimatedSize:n.props.estimatedOptionHeight,itemSize:P=>s.value[P]}),u=(P=[],O)=>{const{props:{valueKey:M}}=n;return oi(O)?P&&P.some(V=>Tr(V,M)===Tr(O,M)):P.includes(O)},d=(P,O)=>{if(oi(O)){const{valueKey:M}=n.props;return Tr(P,M)===Tr(O,M)}else return P===O},h=(P,O)=>{const{valueKey:M}=n.props;return n.props.multiple?u(P,Tr(O,M)):d(P,Tr(O,M))},p=(P,O)=>{const{disabled:M,multiple:V,multipleLimit:L}=n.props;return M||!O&&(V?L>0&&P.length>=L:!1)},m=P=>i.hoveringIndex===P;t({listRef:a,isSized:l,isItemDisabled:p,isItemHovering:m,isItemSelected:h,scrollToItem:P=>{const O=a.value;O&&O.scrollToItem(P)},resetScrollTop:()=>{const P=a.value;P&&P.resetScrollTop()}});const b=P=>{const{index:O,data:M,style:V}=P,L=v(l),{itemSize:U,estimatedSize:G}=v(c),{modelValue:H}=n.props,{onSelect:k,onHover:D}=n,$=M[O];if($.type==="Group")return re(AGe,{item:$,style:V,height:L?U:G},null);const F=h(H,$),Y=p(H,F),ne=m(O);return re(LGe,ci(P,{selected:F,disabled:$.disabled||Y,created:!!$.created,hovering:ne,item:$,onSelect:k,onHover:D}),{default:X=>{var J;return((J=e.default)==null?void 0:J.call(e,X))||re("span",null,[$.label])}})},{onKeyboardNavigate:x,onKeyboardSelect:w}=n,C=()=>{x("forward")},S=()=>{x("backward")},E=()=>{n.expanded=!1},A=P=>{const{code:O}=P,{tab:M,esc:V,down:L,up:U,enter:G}=wt;switch(O!==M&&(P.preventDefault(),P.stopPropagation()),O){case M:case V:{E();break}case L:{C();break}case U:{S();break}case G:{w();break}}};return()=>{var P;const{data:O,width:M}=i,{height:V,multiple:L,scrollbarAlwaysOn:U}=n.props;if(O.length===0)return re("div",{class:r.b("dropdown"),style:{width:`${M}px`}},[(P=e.empty)==null?void 0:P.call(e)]);const G=v(l)?lce:yGe;return re("div",{class:[r.b("dropdown"),r.is("multiple",L)]},[re(G,ci({ref:a},v(c),{className:r.be("dropdown","list"),scrollbarAlwaysOn:U,data:O,height:V,width:M,total:O.length,onKeydown:A}),{default:H=>re(b,H,null)})])}}});function kGe(i,e){const t=W(0),n=W(null),r=R(()=>i.allowCreate&&i.filterable);function s(u){const d=h=>h.value===u;return i.options&&i.options.some(d)||e.createdOptions.some(d)}function a(u){r.value&&(i.multiple&&u.created?t.value++:n.value=u)}function o(u){if(r.value)if(u&&u.length>0&&!s(u)){const d={value:u,label:u,created:!0,disabled:!1};e.createdOptions.length>=t.value?e.createdOptions[t.value]=d:e.createdOptions.push(d)}else if(i.multiple)e.createdOptions.length=t.value;else{const d=n.value;e.createdOptions.length=0,d&&d.created&&e.createdOptions.push(d)}}function l(u){if(!r.value||!u||!u.created||u.created&&i.reserveKeyword&&e.inputValue===u.label)return;const d=e.createdOptions.findIndex(h=>h.value===u.value);~d&&(e.createdOptions.splice(d,1),t.value--)}function c(){r.value&&(e.createdOptions.length=0,t.value=0)}return{createNewOption:o,removeNewOption:l,selectNewOption:a,clearAllNewOption:c}}const FGe=i=>{const e=[];return i.forEach(t=>{st(t.options)?(e.push({label:t.label,isTitle:!0,type:"Group"}),t.options.forEach(n=>{e.push(n)}),e.push({type:"Group"})):e.push(t)}),e};function NGe(i){const e=W(!1);return{handleCompositionStart:()=>{e.value=!0},handleCompositionUpdate:s=>{const a=s.target.value,o=a[a.length-1]||"";e.value=!O3(o)},handleCompositionEnd:s=>{e.value&&(e.value=!1,Lt(i)&&i(s))}}}const gK="",vK=11,VGe={larget:51,default:42,small:33},BGe=(i,e)=>{const{t}=Ki(),n=Ne("select-v2"),r=Ne("input"),{form:s,formItem:a}=nc(),o=Ji({inputValue:gK,displayInputValue:gK,calculatedWidth:0,cachedPlaceholder:"",cachedOptions:[],createdOptions:[],createdLabel:"",createdSelected:!1,currentPlaceholder:"",hoveringIndex:-1,comboBoxHovering:!1,isOnComposition:!1,isSilentBlur:!1,isComposing:!1,inputLength:20,selectWidth:200,initialInputHeight:0,previousQuery:null,previousValue:void 0,query:"",selectedLabel:"",softFocus:!1,tagInMultiLine:!1}),l=W(-1),c=W(-1),u=W(null),d=W(null),h=W(null),p=W(null),m=W(null),g=W(null),_=W(null),b=W(!1),x=R(()=>i.disabled||(s==null?void 0:s.disabled)),w=R(()=>{const ze=L.value.length*34;return ze>i.height?i.height:ze}),C=R(()=>!so(i.modelValue)),S=R(()=>{const ze=i.multiple?Array.isArray(i.modelValue)&&i.modelValue.length>0:C.value;return i.clearable&&!x.value&&o.comboBoxHovering&&ze}),E=R(()=>i.remote&&i.filterable?"":A3),A=R(()=>E.value&&n.is("reverse",b.value)),P=R(()=>(a==null?void 0:a.validateState)||""),O=R(()=>Aae[P.value]),M=R(()=>i.remote?300:0),V=R(()=>{const ze=L.value;return i.loading?i.loadingText||t("el.select.loading"):i.remote&&o.inputValue===""&&ze.length===0?!1:i.filterable&&o.inputValue&&ze.length>0?i.noMatchText||t("el.select.noMatch"):ze.length===0?i.noDataText||t("el.select.noData"):null}),L=R(()=>{const ze=ft=>{const Bt=o.inputValue,Kt=new RegExp(gae(Bt),"i");return Bt?Kt.test(ft.label||""):!0};return i.loading?[]:FGe(i.options.concat(o.createdOptions).map(ft=>{if(st(ft.options)){const Bt=ft.options.filter(ze);if(Bt.length>0)return{...ft,options:Bt}}else if(i.remote||ze(ft))return ft;return null}).filter(ft=>ft!==null))}),U=R(()=>L.value.every(ze=>ze.disabled)),G=Qs(),H=R(()=>G.value==="small"?"small":"default"),k=R(()=>{const ze=g.value,ft=H.value||"default",Bt=ze?Number.parseInt(getComputedStyle(ze).paddingLeft):0,Kt=ze?Number.parseInt(getComputedStyle(ze).paddingRight):0;return o.selectWidth-Kt-Bt-VGe[ft]}),D=()=>{var ze;c.value=((ze=m.value)==null?void 0:ze.offsetWidth)||200},$=R(()=>({width:`${o.calculatedWidth===0?vK:Math.ceil(o.calculatedWidth)+vK}px`})),F=R(()=>st(i.modelValue)?i.modelValue.length===0&&!o.displayInputValue:i.filterable?o.displayInputValue.length===0:!0),Y=R(()=>{const ze=i.placeholder||t("el.select.placeholder");return i.multiple||so(i.modelValue)?ze:o.selectedLabel}),ne=R(()=>{var ze,ft;return(ft=(ze=p.value)==null?void 0:ze.popperRef)==null?void 0:ft.contentRef}),X=R(()=>{if(i.multiple){const ze=i.modelValue.length;if(i.modelValue.length>0)return L.value.findIndex(ft=>ft.value===i.modelValue[ze-1])}else if(i.modelValue)return L.value.findIndex(ze=>ze.value===i.modelValue);return-1}),J=R({get(){return b.value&&V.value!==!1},set(ze){b.value=ze}}),{createNewOption:he,removeNewOption:ye,selectNewOption:Te,clearAllNewOption:ce}=kGe(i,o),{handleCompositionStart:ae,handleCompositionUpdate:le,handleCompositionEnd:fe}=NGe(ze=>Zt(ze)),Ue=()=>{var ze,ft,Bt;(ft=(ze=d.value).focus)==null||ft.call(ze),(Bt=p.value)==null||Bt.updatePopper()},ie=()=>{if(!i.automaticDropdown&&!x.value)return o.isComposing&&(o.softFocus=!0),ut(()=>{var ze,ft;b.value=!b.value,(ft=(ze=d.value)==null?void 0:ze.focus)==null||ft.call(ze)})},oe=()=>(i.filterable&&o.inputValue!==o.selectedLabel&&(o.query=o.selectedLabel),Ae(o.inputValue),ut(()=>{he(o.inputValue)})),we=Zl(oe,M.value),Ae=ze=>{o.previousQuery!==ze&&(o.previousQuery=ze,i.filterable&&Lt(i.filterMethod)?i.filterMethod(ze):i.filterable&&i.remote&&Lt(i.remoteMethod)&&i.remoteMethod(ze))},Oe=ze=>{Iu(i.modelValue,ze)||e(rr,ze)},ve=ze=>{e(ri,ze),Oe(ze),o.previousValue=ze==null?void 0:ze.toString()},ke=(ze=[],ft)=>{if(!oi(ft))return ze.indexOf(ft);const Bt=i.valueKey;let Kt=-1;return ze.some((wn,bi)=>Tr(wn,Bt)===Tr(ft,Bt)?(Kt=bi,!0):!1),Kt},be=ze=>oi(ze)?Tr(ze,i.valueKey):ze,$e=ze=>oi(ze)?ze.label:ze,Le=()=>{if(!(i.collapseTags&&!i.filterable))return ut(()=>{var ze,ft;if(!d.value)return;const Bt=g.value;m.value.height=Bt.offsetHeight,b.value&&V.value!==!1&&((ft=(ze=p.value)==null?void 0:ze.updatePopper)==null||ft.call(ze))})},Ce=()=>{var ze,ft;if(Be(),D(),(ft=(ze=p.value)==null?void 0:ze.updatePopper)==null||ft.call(ze),i.multiple)return Le()},Be=()=>{const ze=g.value;ze&&(o.selectWidth=ze.getBoundingClientRect().width)},He=(ze,ft,Bt=!0)=>{var Kt,wn;if(i.multiple){let bi=i.modelValue.slice();const xn=ke(bi,be(ze));xn>-1?(bi=[...bi.slice(0,xn),...bi.slice(xn+1)],o.cachedOptions.splice(xn,1),ye(ze)):(i.multipleLimit<=0||bi.length<i.multipleLimit)&&(bi=[...bi,be(ze)],o.cachedOptions.push(ze),Te(ze),Me(ft)),ve(bi),ze.created&&(o.query="",Ae(""),o.inputLength=20),i.filterable&&!i.reserveKeyword&&((wn=(Kt=d.value).focus)==null||wn.call(Kt),Ie("")),i.filterable&&(o.calculatedWidth=_.value.getBoundingClientRect().width),Le(),Tt()}else l.value=ft,o.selectedLabel=ze.label,ve(be(ze)),b.value=!1,o.isComposing=!1,o.isSilentBlur=Bt,Te(ze),ze.created||ce(),Me(ft)},Xe=(ze,ft)=>{const{valueKey:Bt}=i,Kt=i.modelValue.indexOf(Tr(ft,Bt));if(Kt>-1&&!x.value){const wn=[...i.modelValue.slice(0,Kt),...i.modelValue.slice(Kt+1)];return o.cachedOptions.splice(Kt,1),ve(wn),e("remove-tag",Tr(ft,Bt)),o.softFocus=!0,ye(ft),ut(Ue)}ze.stopPropagation()},Je=ze=>{const ft=o.isComposing;o.isComposing=!0,o.softFocus?o.softFocus=!1:ft||e("focus",ze)},it=ze=>(o.softFocus=!1,ut(()=>{var ft,Bt;(Bt=(ft=d.value)==null?void 0:ft.blur)==null||Bt.call(ft),_.value&&(o.calculatedWidth=_.value.getBoundingClientRect().width),o.isSilentBlur?o.isSilentBlur=!1:o.isComposing&&e("blur",ze),o.isComposing=!1})),Qe=()=>{o.displayInputValue.length>0?Ie(""):b.value=!1},te=ze=>{if(o.displayInputValue.length===0){ze.preventDefault();const ft=i.modelValue.slice();ft.pop(),ye(o.cachedOptions.pop()),ve(ft)}},me=()=>{let ze;return st(i.modelValue)?ze=[]:ze=void 0,o.softFocus=!0,i.multiple?o.cachedOptions=[]:o.selectedLabel="",b.value=!1,ve(ze),e("clear"),ce(),ut(Ue)},Ie=ze=>{o.displayInputValue=ze,o.inputValue=ze},K=(ze,ft=void 0)=>{const Bt=L.value;if(!["forward","backward"].includes(ze)||x.value||Bt.length<=0||U.value)return;if(!b.value)return ie();ft===void 0&&(ft=o.hoveringIndex);let Kt=-1;ze==="forward"?(Kt=ft+1,Kt>=Bt.length&&(Kt=0)):ze==="backward"&&(Kt=ft-1,(Kt<0||Kt>=Bt.length)&&(Kt=Bt.length-1));const wn=Bt[Kt];if(wn.disabled||wn.type==="Group")return K(ze,Kt);Me(Kt),ui(Kt)},se=()=>{if(b.value)~o.hoveringIndex&&L.value[o.hoveringIndex]&&He(L.value[o.hoveringIndex],o.hoveringIndex,!1);else return ie()},Me=ze=>{o.hoveringIndex=ze},De=()=>{o.hoveringIndex=-1},Tt=()=>{var ze;const ft=d.value;ft&&((ze=ft.focus)==null||ze.call(ft))},Zt=ze=>{const ft=ze.target.value;if(Ie(ft),o.displayInputValue.length>0&&!b.value&&(b.value=!0),o.calculatedWidth=_.value.getBoundingClientRect().width,i.multiple&&Le(),i.remote)we();else return oe()},tn=()=>(b.value=!1,it()),vn=()=>(o.inputValue=o.displayInputValue,ut(()=>{~X.value&&(Me(X.value),ui(o.hoveringIndex))})),ui=ze=>{h.value.scrollToItem(ze)},di=()=>{if(De(),i.multiple)if(i.modelValue.length>0){let ze=!1;o.cachedOptions.length=0,o.previousValue=i.modelValue.toString(),i.modelValue.forEach(ft=>{const Bt=L.value.findIndex(Kt=>be(Kt)===ft);~Bt&&(o.cachedOptions.push(L.value[Bt]),ze||Me(Bt),ze=!0)})}else o.cachedOptions=[],o.previousValue=void 0;else if(C.value){o.previousValue=i.modelValue;const ze=L.value,ft=ze.findIndex(Bt=>be(Bt)===be(i.modelValue));~ft?(o.selectedLabel=ze[ft].label,Me(ft)):o.selectedLabel=`${i.modelValue}`}else o.selectedLabel="",o.previousValue=void 0;ce(),D()};return Ve(b,ze=>{var ft,Bt;e("visible-change",ze),ze?(Bt=(ft=p.value).update)==null||Bt.call(ft):(o.displayInputValue="",o.previousQuery=null,he(""))}),Ve(()=>i.modelValue,(ze,ft)=>{var Bt;(!ze||ze.toString()!==o.previousValue)&&di(),!Iu(ze,ft)&&i.validateEvent&&((Bt=a==null?void 0:a.validate)==null||Bt.call(a,"change").catch(Kt=>void 0))},{deep:!0}),Ve(()=>i.options,()=>{const ze=d.value;(!ze||ze&&document.activeElement!==ze)&&di()},{deep:!0}),Ve(L,()=>ut(h.value.resetScrollTop)),qt(()=>{di()}),fl(m,Ce),{collapseTagSize:H,currentPlaceholder:Y,expanded:b,emptyText:V,popupHeight:w,debounce:M,filteredOptions:L,iconComponent:E,iconReverse:A,inputWrapperStyle:$,popperSize:c,dropdownMenuVisible:J,hasModelValue:C,shouldShowPlaceholder:F,selectDisabled:x,selectSize:G,showClearBtn:S,states:o,tagMaxWidth:k,nsSelectV2:n,nsInput:r,calculatorRef:_,controlRef:u,inputRef:d,menuRef:h,popper:p,selectRef:m,selectionRef:g,popperRef:ne,validateState:P,validateIcon:O,debouncedOnInputChange:we,deleteTag:Xe,getLabel:$e,getValueKey:be,handleBlur:it,handleClear:me,handleClickOutside:tn,handleDel:te,handleEsc:Qe,handleFocus:Je,handleMenuEnter:vn,handleResize:Ce,toggleMenu:ie,scrollTo:ui,onInput:Zt,onKeyboardNavigate:K,onKeyboardSelect:se,onSelect:He,onHover:Me,onUpdateInputValue:Ie,handleCompositionStart:ae,handleCompositionEnd:fe,handleCompositionUpdate:le}},zGe=de({name:"ElSelectV2",components:{ElSelectMenu:DGe,ElTag:Y2,ElTooltip:Jl,ElIcon:ct},directives:{ClickOutside:My,ModelText:Fz},props:PGe,emits:[ri,rr,"remove-tag","clear","visible-change","focus","blur"],setup(i,{emit:e}){const t=R(()=>{const{modelValue:r,multiple:s}=i,a=s?[]:void 0;return st(r)?s?r:a:s?a:r}),n=BGe(Ji({..._a(i),modelValue:t}),e);return pi(gce,{props:Ji({..._a(i),height:n.popupHeight,modelValue:t}),popper:n.popper,onSelect:n.onSelect,onHover:n.onHover,onKeyboardNavigate:n.onKeyboardNavigate,onKeyboardSelect:n.onKeyboardSelect}),{...n,modelValue:t}}}),UGe={key:0},HGe=["id","autocomplete","aria-expanded","aria-labelledby","disabled","readonly","name","unselectable"],GGe=["textContent"],WGe=["id","aria-labelledby","aria-expanded","autocomplete","disabled","name","readonly","unselectable"],jGe=["textContent"];function qGe(i,e,t,n,r,s){const a=jt("el-tag"),o=jt("el-tooltip"),l=jt("el-icon"),c=jt("el-select-menu"),u=R2("model-text"),d=R2("click-outside");return zt((I(),Z("div",{ref:"selectRef",class:N([i.nsSelectV2.b(),i.nsSelectV2.m(i.selectSize)]),onClick:e[25]||(e[25]=Dt((...h)=>i.toggleMenu&&i.toggleMenu(...h),["stop"])),onMouseenter:e[26]||(e[26]=h=>i.states.comboBoxHovering=!0),onMouseleave:e[27]||(e[27]=h=>i.states.comboBoxHovering=!1)},[re(o,{ref:"popper",visible:i.dropdownMenuVisible,teleported:i.teleported,"popper-class":[i.nsSelectV2.e("popper"),i.popperClass],"gpu-acceleration":!1,"stop-popper-mouse-event":!1,"popper-options":i.popperOptions,"fallback-placements":["bottom-start","top-start","right","left"],effect:i.effect,placement:i.placement,pure:"",transition:`${i.nsSelectV2.namespace.value}-zoom-in-top`,trigger:"click",persistent:i.persistent,onBeforeShow:i.handleMenuEnter,onHide:e[24]||(e[24]=h=>i.states.inputValue=i.states.displayInputValue)},{default:pe(()=>{var h;return[Q("div",{ref:"selectionRef",class:N([i.nsSelectV2.e("wrapper"),i.nsSelectV2.is("focused",i.states.isComposing||i.expanded),i.nsSelectV2.is("hovering",i.states.comboBoxHovering),i.nsSelectV2.is("filterable",i.filterable),i.nsSelectV2.is("disabled",i.selectDisabled)])},[i.$slots.prefix?(I(),Z("div",UGe,[Fe(i.$slots,"prefix")])):_e("v-if",!0),i.multiple?(I(),Z("div",{key:1,class:N(i.nsSelectV2.e("selection"))},[i.collapseTags&&i.modelValue.length>0?(I(),Z("div",{key:0,class:N(i.nsSelectV2.e("selected-item"))},[re(a,{closable:!i.selectDisabled&&!((h=i.states.cachedOptions[0])!=null&&h.disable),size:i.collapseTagSize,type:"info","disable-transitions":"",onClose:e[0]||(e[0]=p=>i.deleteTag(p,i.states.cachedOptions[0]))},{default:pe(()=>{var p;return[Q("span",{class:N(i.nsSelectV2.e("tags-text")),style:pt({maxWidth:`${i.tagMaxWidth}px`})},We((p=i.states.cachedOptions[0])==null?void 0:p.label),7)]}),_:1},8,["closable","size"]),i.modelValue.length>1?(I(),Se(a,{key:0,closable:!1,size:i.collapseTagSize,type:"info","disable-transitions":""},{default:pe(()=>[i.collapseTagsTooltip?(I(),Se(o,{key:0,disabled:i.dropdownMenuVisible,"fallback-placements":["bottom","top","right","left"],effect:i.effect,placement:"bottom",teleported:!1},{default:pe(()=>[Q("span",{class:N(i.nsSelectV2.e("tags-text")),style:pt({maxWidth:`${i.tagMaxWidth}px`})},"+ "+We(i.modelValue.length-1),7)]),content:pe(()=>[Q("div",{class:N(i.nsSelectV2.e("selection"))},[(I(!0),Z(gt,null,xi(i.states.cachedOptions.slice(1),(p,m)=>(I(),Z("div",{key:m,class:N(i.nsSelectV2.e("selected-item"))},[(I(),Se(a,{key:i.getValueKey(p),closable:!i.selectDisabled&&!p.disabled,size:i.collapseTagSize,class:"in-tooltip",type:"info","disable-transitions":"",onClose:g=>i.deleteTag(g,p)},{default:pe(()=>[Q("span",{class:N(i.nsSelectV2.e("tags-text")),style:pt({maxWidth:`${i.tagMaxWidth}px`})},We(i.getLabel(p)),7)]),_:2},1032,["closable","size","onClose"]))],2))),128))],2)]),_:1},8,["disabled","effect"])):(I(),Z("span",{key:1,class:N(i.nsSelectV2.e("tags-text")),style:pt({maxWidth:`${i.tagMaxWidth}px`})},"+ "+We(i.modelValue.length-1),7))]),_:1},8,["size"])):_e("v-if",!0)],2)):(I(!0),Z(gt,{key:1},xi(i.states.cachedOptions,(p,m)=>(I(),Z("div",{key:m,class:N(i.nsSelectV2.e("selected-item"))},[(I(),Se(a,{key:i.getValueKey(p),closable:!i.selectDisabled&&!p.disabled,size:i.collapseTagSize,type:"info","disable-transitions":"",onClose:g=>i.deleteTag(g,p)},{default:pe(()=>[Q("span",{class:N(i.nsSelectV2.e("tags-text")),style:pt({maxWidth:`${i.tagMaxWidth}px`})},We(i.getLabel(p)),7)]),_:2},1032,["closable","size","onClose"]))],2))),128)),Q("div",{class:N([i.nsSelectV2.e("selected-item"),i.nsSelectV2.e("input-wrapper")]),style:pt(i.inputWrapperStyle)},[zt(Q("input",{id:i.id,ref:"inputRef",autocomplete:i.autocomplete,"aria-autocomplete":"list","aria-haspopup":"listbox",autocapitalize:"off","aria-expanded":i.expanded,"aria-labelledby":i.label,class:N([i.nsSelectV2.is(i.selectSize),i.nsSelectV2.e("combobox-input")]),disabled:i.disabled,role:"combobox",readonly:!i.filterable,spellcheck:"false",type:"text",name:i.name,unselectable:i.expanded?"on":void 0,"onUpdate:modelValue":e[1]||(e[1]=(...p)=>i.onUpdateInputValue&&i.onUpdateInputValue(...p)),onFocus:e[2]||(e[2]=(...p)=>i.handleFocus&&i.handleFocus(...p)),onBlur:e[3]||(e[3]=(...p)=>i.handleBlur&&i.handleBlur(...p)),onInput:e[4]||(e[4]=(...p)=>i.onInput&&i.onInput(...p)),onCompositionstart:e[5]||(e[5]=(...p)=>i.handleCompositionStart&&i.handleCompositionStart(...p)),onCompositionupdate:e[6]||(e[6]=(...p)=>i.handleCompositionUpdate&&i.handleCompositionUpdate(...p)),onCompositionend:e[7]||(e[7]=(...p)=>i.handleCompositionEnd&&i.handleCompositionEnd(...p)),onKeydown:[e[8]||(e[8]=Di(Dt(p=>i.onKeyboardNavigate("backward"),["stop","prevent"]),["up"])),e[9]||(e[9]=Di(Dt(p=>i.onKeyboardNavigate("forward"),["stop","prevent"]),["down"])),e[10]||(e[10]=Di(Dt((...p)=>i.onKeyboardSelect&&i.onKeyboardSelect(...p),["stop","prevent"]),["enter"])),e[11]||(e[11]=Di(Dt((...p)=>i.handleEsc&&i.handleEsc(...p),["stop","prevent"]),["esc"])),e[12]||(e[12]=Di(Dt((...p)=>i.handleDel&&i.handleDel(...p),["stop"]),["delete"]))]},null,42,HGe),[[u,i.states.displayInputValue]]),i.filterable?(I(),Z("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:N(i.nsSelectV2.e("input-calculator")),textContent:We(i.states.displayInputValue)},null,10,GGe)):_e("v-if",!0)],6)],2)):(I(),Z(gt,{key:2},[Q("div",{class:N([i.nsSelectV2.e("selected-item"),i.nsSelectV2.e("input-wrapper")])},[zt(Q("input",{id:i.id,ref:"inputRef","aria-autocomplete":"list","aria-haspopup":"listbox","aria-labelledby":i.label,"aria-expanded":i.expanded,autocapitalize:"off",autocomplete:i.autocomplete,class:N(i.nsSelectV2.e("combobox-input")),disabled:i.disabled,name:i.name,role:"combobox",readonly:!i.filterable,spellcheck:"false",type:"text",unselectable:i.expanded?"on":void 0,onCompositionstart:e[13]||(e[13]=(...p)=>i.handleCompositionStart&&i.handleCompositionStart(...p)),onCompositionupdate:e[14]||(e[14]=(...p)=>i.handleCompositionUpdate&&i.handleCompositionUpdate(...p)),onCompositionend:e[15]||(e[15]=(...p)=>i.handleCompositionEnd&&i.handleCompositionEnd(...p)),onFocus:e[16]||(e[16]=(...p)=>i.handleFocus&&i.handleFocus(...p)),onBlur:e[17]||(e[17]=(...p)=>i.handleBlur&&i.handleBlur(...p)),onInput:e[18]||(e[18]=(...p)=>i.onInput&&i.onInput(...p)),onKeydown:[e[19]||(e[19]=Di(Dt(p=>i.onKeyboardNavigate("backward"),["stop","prevent"]),["up"])),e[20]||(e[20]=Di(Dt(p=>i.onKeyboardNavigate("forward"),["stop","prevent"]),["down"])),e[21]||(e[21]=Di(Dt((...p)=>i.onKeyboardSelect&&i.onKeyboardSelect(...p),["stop","prevent"]),["enter"])),e[22]||(e[22]=Di(Dt((...p)=>i.handleEsc&&i.handleEsc(...p),["stop","prevent"]),["esc"]))],"onUpdate:modelValue":e[23]||(e[23]=(...p)=>i.onUpdateInputValue&&i.onUpdateInputValue(...p))},null,42,WGe),[[u,i.states.displayInputValue]])],2),i.filterable?(I(),Z("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:N([i.nsSelectV2.e("selected-item"),i.nsSelectV2.e("input-calculator")]),textContent:We(i.states.displayInputValue)},null,10,jGe)):_e("v-if",!0)],64)),i.shouldShowPlaceholder?(I(),Z("span",{key:3,class:N([i.nsSelectV2.e("placeholder"),i.nsSelectV2.is("transparent",i.multiple?i.modelValue.length===0:!i.hasModelValue)])},We(i.currentPlaceholder),3)):_e("v-if",!0),Q("span",{class:N(i.nsSelectV2.e("suffix"))},[i.iconComponent?zt((I(),Se(l,{key:0,class:N([i.nsSelectV2.e("caret"),i.nsInput.e("icon"),i.iconReverse])},{default:pe(()=>[(I(),Se(hi(i.iconComponent)))]),_:1},8,["class"])),[[Ei,!i.showClearBtn]]):_e("v-if",!0),i.showClearBtn&&i.clearIcon?(I(),Se(l,{key:1,class:N([i.nsSelectV2.e("caret"),i.nsInput.e("icon")]),onClick:Dt(i.handleClear,["prevent","stop"])},{default:pe(()=>[(I(),Se(hi(i.clearIcon)))]),_:1},8,["class","onClick"])):_e("v-if",!0),i.validateState&&i.validateIcon?(I(),Se(l,{key:2,class:N([i.nsInput.e("icon"),i.nsInput.e("validateIcon")])},{default:pe(()=>[(I(),Se(hi(i.validateIcon)))]),_:1},8,["class"])):_e("v-if",!0)],2)],2)]}),content:pe(()=>[re(c,{ref:"menuRef",data:i.filteredOptions,width:i.popperSize,"hovering-index":i.states.hoveringIndex,"scrollbar-always-on":i.scrollbarAlwaysOn},{default:pe(h=>[Fe(i.$slots,"default",mh(v3(h)))]),empty:pe(()=>[Fe(i.$slots,"empty",{},()=>[Q("p",{class:N(i.nsSelectV2.e("empty"))},We(i.emptyText?i.emptyText:""),3)])]),_:3},8,["data","width","hovering-index","scrollbar-always-on"])]),_:3},8,["visible","teleported","popper-class","popper-options","effect","placement","transition","persistent","onBeforeShow"])],34)),[[d,i.handleClickOutside,i.popperRef]])}var MR=qe(zGe,[["render",qGe],["__file","/home/runner/work/element-plus/element-plus/packages/components/select-v2/src/select.vue"]]);MR.install=i=>{i.component(MR.name,MR)};const KGe=MR,YGe=KGe,XGe=Ke({animated:{type:Boolean,default:!1},count:{type:Number,default:1},rows:{type:Number,default:3},loading:{type:Boolean,default:!0},throttle:{type:Number}}),ZGe=Ke({variant:{type:String,values:["circle","rect","h1","h3","text","caption","p","image","button"],default:"text"}}),QGe=de({name:"ElSkeletonItem"}),JGe=de({...QGe,props:ZGe,setup(i){const e=Ne("skeleton");return(t,n)=>(I(),Z("div",{class:N([v(e).e("item"),v(e).e(t.variant)])},[t.variant==="image"?(I(),Se(v(w$e),{key:0})):_e("v-if",!0)],2))}});var w$=qe(JGe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/skeleton/src/skeleton-item.vue"]]);const eWe=de({name:"ElSkeleton"}),tWe=de({...eWe,props:XGe,setup(i,{expose:e}){const t=i,n=Ne("skeleton"),r=TDe(kr(t,"loading"),t.throttle);return e({uiLoading:r}),(s,a)=>v(r)?(I(),Z("div",ci({key:0,class:[v(n).b(),v(n).is("animated",s.animated)]},s.$attrs),[(I(!0),Z(gt,null,xi(s.count,o=>(I(),Z(gt,{key:o},[s.loading?Fe(s.$slots,"template",{key:o},()=>[re(w$,{class:N(v(n).is("first")),variant:"p"},null,8,["class"]),(I(!0),Z(gt,null,xi(s.rows,l=>(I(),Se(w$,{key:l,class:N([v(n).e("paragraph"),v(n).is("last",l===s.rows&&s.rows>1)]),variant:"p"},null,8,["class"]))),128))]):_e("v-if",!0)],64))),128))],16)):Fe(s.$slots,"default",mh(ci({key:1},s.$attrs)))}});var iWe=qe(tWe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/skeleton/src/skeleton.vue"]]);const nWe=ii(iWe,{SkeletonItem:w$}),rWe=Wr(w$),sWe=Ke({modelValue:{type:xe([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Ql,inputSize:Ql,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:xe(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:xe(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Ib,default:"top"},marks:{type:xe(Object)},validateEvent:{type:Boolean,default:!0}}),$k=i=>It(i)||st(i)&&i.every(It),aWe={[ri]:$k,[jl]:$k,[rr]:$k},oWe=(i,e,t)=>{const n=W();return qt(async()=>{i.range?(Array.isArray(i.modelValue)?(e.firstValue=Math.max(i.min,i.modelValue[0]),e.secondValue=Math.min(i.max,i.modelValue[1])):(e.firstValue=i.min,e.secondValue=i.max),e.oldValue=[e.firstValue,e.secondValue]):(typeof i.modelValue!="number"||Number.isNaN(i.modelValue)?e.firstValue=i.min:e.firstValue=Math.min(i.max,Math.max(i.min,i.modelValue)),e.oldValue=e.firstValue),mr(window,"resize",t),await ut(),t()}),{sliderWrapper:n}},lWe=i=>R(()=>i.marks?Object.keys(i.marks).map(Number.parseFloat).sort((t,n)=>t-n).filter(t=>t<=i.max&&t>=i.min).map(t=>({point:t,position:(t-i.min)*100/(i.max-i.min),mark:i.marks[t]})):[]),cWe=(i,e,t)=>{const{form:n,formItem:r}=nc(),s=nr(),a=W(),o=W(),l={firstButton:a,secondButton:o},c=R(()=>i.disabled||(n==null?void 0:n.disabled)||!1),u=R(()=>Math.min(e.firstValue,e.secondValue)),d=R(()=>Math.max(e.firstValue,e.secondValue)),h=R(()=>i.range?`${100*(d.value-u.value)/(i.max-i.min)}%`:`${100*(e.firstValue-i.min)/(i.max-i.min)}%`),p=R(()=>i.range?`${100*(u.value-i.min)/(i.max-i.min)}%`:"0%"),m=R(()=>i.vertical?{height:i.height}:{}),g=R(()=>i.vertical?{height:h.value,bottom:p.value}:{width:h.value,left:p.value}),_=()=>{s.value&&(e.sliderSize=s.value[`client${i.vertical?"Height":"Width"}`])},b=V=>{const L=i.min+V*(i.max-i.min)/100;if(!i.range)return a;let U;return Math.abs(u.value-L)<Math.abs(d.value-L)?U=e.firstValue<e.secondValue?"firstButton":"secondButton":U=e.firstValue>e.secondValue?"firstButton":"secondButton",l[U]},x=V=>{const L=b(V);return L.value.setPosition(V),L},w=V=>{e.firstValue=V,S(i.range?[u.value,d.value]:V)},C=V=>{e.secondValue=V,i.range&&S([u.value,d.value])},S=V=>{t(ri,V),t(jl,V)},E=async()=>{await ut(),t(rr,i.range?[u.value,d.value]:i.modelValue)},A=V=>{var L,U,G,H,k,D;if(c.value||e.dragging)return;_();let $=0;if(i.vertical){const F=(G=(U=(L=V.touches)==null?void 0:L.item(0))==null?void 0:U.clientY)!=null?G:V.clientY;$=(s.value.getBoundingClientRect().bottom-F)/e.sliderSize*100}else{const F=(D=(k=(H=V.touches)==null?void 0:H.item(0))==null?void 0:k.clientX)!=null?D:V.clientX,Y=s.value.getBoundingClientRect().left;$=(F-Y)/e.sliderSize*100}if(!($<0||$>100))return x($)};return{elFormItem:r,slider:s,firstButton:a,secondButton:o,sliderDisabled:c,minValue:u,maxValue:d,runwayStyle:m,barStyle:g,resetSize:_,setPosition:x,emitChange:E,onSliderWrapperPrevent:V=>{var L,U;((L=l.firstButton.value)!=null&&L.dragging||(U=l.secondButton.value)!=null&&U.dragging)&&V.preventDefault()},onSliderClick:V=>{A(V)&&E()},onSliderDown:async V=>{const L=A(V);L&&(await ut(),L.value.onButtonDown(V))},setFirstValue:w,setSecondValue:C}},{left:uWe,down:dWe,right:hWe,up:pWe,home:fWe,end:mWe,pageUp:gWe,pageDown:vWe}=wt,yWe=(i,e,t)=>{const n=W(),r=W(!1),s=R(()=>e.value instanceof Function),a=R(()=>s.value&&e.value(i.modelValue)||i.modelValue),o=Zl(()=>{t.value&&(r.value=!0)},50),l=Zl(()=>{t.value&&(r.value=!1)},50);return{tooltip:n,tooltipVisible:r,formatValue:a,displayTooltip:o,hideTooltip:l}},_We=(i,e,t)=>{const{disabled:n,min:r,max:s,step:a,showTooltip:o,precision:l,sliderSize:c,formatTooltip:u,emitChange:d,resetSize:h,updateDragging:p}=ht(Vae),{tooltip:m,tooltipVisible:g,formatValue:_,displayTooltip:b,hideTooltip:x}=yWe(i,u,o),w=W(),C=R(()=>`${(i.modelValue-r.value)/(s.value-r.value)*100}%`),S=R(()=>i.vertical?{bottom:C.value}:{left:C.value}),E=()=>{e.hovering=!0,b()},A=()=>{e.hovering=!1,e.dragging||x()},P=X=>{n.value||(X.preventDefault(),$(X),window.addEventListener("mousemove",F),window.addEventListener("touchmove",F),window.addEventListener("mouseup",Y),window.addEventListener("touchend",Y),window.addEventListener("contextmenu",Y),w.value.focus())},O=X=>{n.value||(e.newPosition=Number.parseFloat(C.value)+X/(s.value-r.value)*100,ne(e.newPosition),d())},M=()=>{O(-a.value)},V=()=>{O(a.value)},L=()=>{O(-a.value*4)},U=()=>{O(a.value*4)},G=()=>{n.value||(ne(0),d())},H=()=>{n.value||(ne(100),d())},k=X=>{let J=!0;[uWe,dWe].includes(X.key)?M():[hWe,pWe].includes(X.key)?V():X.key===fWe?G():X.key===mWe?H():X.key===vWe?L():X.key===gWe?U():J=!1,J&&X.preventDefault()},D=X=>{let J,he;return X.type.startsWith("touch")?(he=X.touches[0].clientY,J=X.touches[0].clientX):(he=X.clientY,J=X.clientX),{clientX:J,clientY:he}},$=X=>{e.dragging=!0,e.isClick=!0;const{clientX:J,clientY:he}=D(X);i.vertical?e.startY=he:e.startX=J,e.startPosition=Number.parseFloat(C.value),e.newPosition=e.startPosition},F=X=>{if(e.dragging){e.isClick=!1,b(),h();let J;const{clientX:he,clientY:ye}=D(X);i.vertical?(e.currentY=ye,J=(e.startY-e.currentY)/c.value*100):(e.currentX=he,J=(e.currentX-e.startX)/c.value*100),e.newPosition=e.startPosition+J,ne(e.newPosition)}},Y=()=>{e.dragging&&(setTimeout(()=>{e.dragging=!1,e.hovering||x(),e.isClick||ne(e.newPosition),d()},0),window.removeEventListener("mousemove",F),window.removeEventListener("touchmove",F),window.removeEventListener("mouseup",Y),window.removeEventListener("touchend",Y),window.removeEventListener("contextmenu",Y))},ne=async X=>{if(X===null||Number.isNaN(+X))return;X<0?X=0:X>100&&(X=100);const J=100/((s.value-r.value)/a.value);let ye=Math.round(X/J)*J*(s.value-r.value)*.01+r.value;ye=Number.parseFloat(ye.toFixed(l.value)),ye!==i.modelValue&&t(ri,ye),!e.dragging&&i.modelValue!==e.oldValue&&(e.oldValue=i.modelValue),await ut(),e.dragging&&b(),m.value.updatePopper()};return Ve(()=>e.dragging,X=>{p(X)}),{disabled:n,button:w,tooltip:m,tooltipVisible:g,showTooltip:o,wrapperStyle:S,formatValue:_,handleMouseEnter:E,handleMouseLeave:A,onButtonDown:P,onKeyDown:k,setPosition:ne}},bWe=(i,e,t,n)=>({stops:R(()=>{if(!i.showStops||i.min>i.max)return[];if(i.step===0)return[];const a=(i.max-i.min)/i.step,o=100*i.step/(i.max-i.min),l=Array.from({length:a-1}).map((c,u)=>(u+1)*o);return i.range?l.filter(c=>c<100*(t.value-i.min)/(i.max-i.min)||c>100*(n.value-i.min)/(i.max-i.min)):l.filter(c=>c>100*(e.firstValue-i.min)/(i.max-i.min))}),getStopStyle:a=>i.vertical?{bottom:`${a}%`}:{left:`${a}%`}}),wWe=(i,e,t,n,r,s)=>{const a=c=>{r(ri,c),r(jl,c)},o=()=>i.range?![t.value,n.value].every((c,u)=>c===e.oldValue[u]):i.modelValue!==e.oldValue,l=()=>{var c,u;if(i.min>i.max){ba("Slider","min should not be greater than max.");return}const d=i.modelValue;i.range&&Array.isArray(d)?d[1]<i.min?a([i.min,i.min]):d[0]>i.max?a([i.max,i.max]):d[0]<i.min?a([i.min,d[1]]):d[1]>i.max?a([d[0],i.max]):(e.firstValue=d[0],e.secondValue=d[1],o()&&(i.validateEvent&&((c=s==null?void 0:s.validate)==null||c.call(s,"change").catch(h=>void 0)),e.oldValue=d.slice())):!i.range&&typeof d=="number"&&!Number.isNaN(d)&&(d<i.min?a(i.min):d>i.max?a(i.max):(e.firstValue=d,o()&&(i.validateEvent&&((u=s==null?void 0:s.validate)==null||u.call(s,"change").catch(h=>void 0)),e.oldValue=d)))};l(),Ve(()=>e.dragging,c=>{c||l()}),Ve(()=>i.modelValue,(c,u)=>{e.dragging||Array.isArray(c)&&Array.isArray(u)&&c.every((d,h)=>d===u[h])&&e.firstValue===c[0]&&e.secondValue===c[1]||l()},{deep:!0}),Ve(()=>[i.min,i.max],()=>{l()})},xWe=Ke({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Ib,default:"top"}}),CWe={[ri]:i=>It(i)},TWe=["tabindex"],SWe=de({name:"ElSliderButton"}),EWe=de({...SWe,props:xWe,emits:CWe,setup(i,{expose:e,emit:t}){const n=i,r=Ne("slider"),s=Ji({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:n.modelValue}),{disabled:a,button:o,tooltip:l,showTooltip:c,tooltipVisible:u,wrapperStyle:d,formatValue:h,handleMouseEnter:p,handleMouseLeave:m,onButtonDown:g,onKeyDown:_,setPosition:b}=_We(n,s,t),{hovering:x,dragging:w}=_a(s);return e({onButtonDown:g,onKeyDown:_,setPosition:b,hovering:x,dragging:w}),(C,S)=>(I(),Z("div",{ref_key:"button",ref:o,class:N([v(r).e("button-wrapper"),{hover:v(x),dragging:v(w)}]),style:pt(v(d)),tabindex:v(a)?-1:0,onMouseenter:S[0]||(S[0]=(...E)=>v(p)&&v(p)(...E)),onMouseleave:S[1]||(S[1]=(...E)=>v(m)&&v(m)(...E)),onMousedown:S[2]||(S[2]=(...E)=>v(g)&&v(g)(...E)),onTouchstart:S[3]||(S[3]=(...E)=>v(g)&&v(g)(...E)),onFocus:S[4]||(S[4]=(...E)=>v(p)&&v(p)(...E)),onBlur:S[5]||(S[5]=(...E)=>v(m)&&v(m)(...E)),onKeydown:S[6]||(S[6]=(...E)=>v(_)&&v(_)(...E))},[re(v(Jl),{ref_key:"tooltip",ref:l,visible:v(u),placement:C.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":C.tooltipClass,disabled:!v(c),persistent:""},{content:pe(()=>[Q("span",null,We(v(h)),1)]),default:pe(()=>[Q("div",{class:N([v(r).e("button"),{hover:v(x),dragging:v(w)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled"])],46,TWe))}});var yK=qe(EWe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/button.vue"]]);const AWe=Ke({mark:{type:xe([String,Object]),default:void 0}});var MWe=de({name:"ElSliderMarker",props:AWe,setup(i){const e=Ne("slider"),t=R(()=>Ft(i.mark)?i.mark:i.mark.label),n=R(()=>Ft(i.mark)?void 0:i.mark.style);return()=>bt("div",{class:e.e("marks-text"),style:n.value},t.value)}});const PWe=["id","role","aria-label","aria-labelledby"],OWe={key:1},RWe=de({name:"ElSlider"}),IWe=de({...RWe,props:sWe,emits:aWe,setup(i,{expose:e,emit:t}){const n=i,r=Ne("slider"),{t:s}=Ki(),a=Ji({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:o,slider:l,firstButton:c,secondButton:u,sliderDisabled:d,minValue:h,maxValue:p,runwayStyle:m,barStyle:g,resetSize:_,emitChange:b,onSliderWrapperPrevent:x,onSliderClick:w,onSliderDown:C,setFirstValue:S,setSecondValue:E}=cWe(n,a,t),{stops:A,getStopStyle:P}=bWe(n,a,h,p),{inputId:O,isLabeledByFormItem:M}=By(n,{formItemContext:o}),V=Qs(),L=R(()=>n.inputSize||V.value),U=R(()=>n.label||s("el.slider.defaultLabel",{min:n.min,max:n.max})),G=R(()=>n.range?n.rangeStartLabel||s("el.slider.defaultRangeStartLabel"):U.value),H=R(()=>n.formatValueText?n.formatValueText(X.value):`${X.value}`),k=R(()=>n.rangeEndLabel||s("el.slider.defaultRangeEndLabel")),D=R(()=>n.formatValueText?n.formatValueText(J.value):`${J.value}`),$=R(()=>[r.b(),r.m(V.value),r.is("vertical",n.vertical),{[r.m("with-input")]:n.showInput}]),F=lWe(n);wWe(n,a,h,p,t,o);const Y=R(()=>{const Te=[n.min,n.max,n.step].map(ce=>{const ae=`${ce}`.split(".")[1];return ae?ae.length:0});return Math.max.apply(null,Te)}),{sliderWrapper:ne}=oWe(n,a,_),{firstValue:X,secondValue:J,sliderSize:he}=_a(a),ye=Te=>{a.dragging=Te};return pi(Vae,{..._a(n),sliderSize:he,disabled:d,precision:Y,emitChange:b,resetSize:_,updateDragging:ye}),e({onSliderClick:w}),(Te,ce)=>{var ae,le;return I(),Z("div",{id:Te.range?v(O):void 0,ref_key:"sliderWrapper",ref:ne,class:N(v($)),role:Te.range?"group":void 0,"aria-label":Te.range&&!v(M)?v(U):void 0,"aria-labelledby":Te.range&&v(M)?(ae=v(o))==null?void 0:ae.labelId:void 0,onTouchstart:ce[2]||(ce[2]=(...fe)=>v(x)&&v(x)(...fe)),onTouchmove:ce[3]||(ce[3]=(...fe)=>v(x)&&v(x)(...fe))},[Q("div",{ref_key:"slider",ref:l,class:N([v(r).e("runway"),{"show-input":Te.showInput&&!Te.range},v(r).is("disabled",v(d))]),style:pt(v(m)),onMousedown:ce[0]||(ce[0]=(...fe)=>v(C)&&v(C)(...fe)),onTouchstart:ce[1]||(ce[1]=(...fe)=>v(C)&&v(C)(...fe))},[Q("div",{class:N(v(r).e("bar")),style:pt(v(g))},null,6),re(yK,{id:Te.range?void 0:v(O),ref_key:"firstButton",ref:c,"model-value":v(X),vertical:Te.vertical,"tooltip-class":Te.tooltipClass,placement:Te.placement,role:"slider","aria-label":Te.range||!v(M)?v(G):void 0,"aria-labelledby":!Te.range&&v(M)?(le=v(o))==null?void 0:le.labelId:void 0,"aria-valuemin":Te.min,"aria-valuemax":Te.range?v(J):Te.max,"aria-valuenow":v(X),"aria-valuetext":v(H),"aria-orientation":Te.vertical?"vertical":"horizontal","aria-disabled":v(d),"onUpdate:modelValue":v(S)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),Te.range?(I(),Se(yK,{key:0,ref_key:"secondButton",ref:u,"model-value":v(J),vertical:Te.vertical,"tooltip-class":Te.tooltipClass,placement:Te.placement,role:"slider","aria-label":v(k),"aria-valuemin":v(X),"aria-valuemax":Te.max,"aria-valuenow":v(J),"aria-valuetext":v(D),"aria-orientation":Te.vertical?"vertical":"horizontal","aria-disabled":v(d),"onUpdate:modelValue":v(E)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):_e("v-if",!0),Te.showStops?(I(),Z("div",OWe,[(I(!0),Z(gt,null,xi(v(A),(fe,Ue)=>(I(),Z("div",{key:Ue,class:N(v(r).e("stop")),style:pt(v(P)(fe))},null,6))),128))])):_e("v-if",!0),v(F).length>0?(I(),Z(gt,{key:2},[Q("div",null,[(I(!0),Z(gt,null,xi(v(F),(fe,Ue)=>(I(),Z("div",{key:Ue,style:pt(v(P)(fe.position)),class:N([v(r).e("stop"),v(r).e("marks-stop")])},null,6))),128))]),Q("div",{class:N(v(r).e("marks"))},[(I(!0),Z(gt,null,xi(v(F),(fe,Ue)=>(I(),Se(v(MWe),{key:Ue,mark:fe.mark,style:pt(v(P)(fe.position))},null,8,["mark","style"]))),128))],2)],64)):_e("v-if",!0)],38),Te.showInput&&!Te.range?(I(),Se(v(Wle),{key:0,ref:"input","model-value":v(X),class:N(v(r).e("input")),step:Te.step,disabled:v(d),controls:Te.showInputControls,min:Te.min,max:Te.max,debounce:Te.debounce,size:v(L),"onUpdate:modelValue":v(S),onChange:v(b)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):_e("v-if",!0)],42,PWe)}}});var $We=qe(IWe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/slider/src/slider.vue"]]);const LWe=ii($We),DWe=Ke({prefixCls:{type:String}}),_K=de({name:"ElSpaceItem",props:DWe,setup(i,{slots:e}){const t=Ne("space"),n=R(()=>`${i.prefixCls||t.b()}__item`);return()=>bt("div",{class:n.value},Fe(e,"default"))}}),bK={small:8,default:12,large:16};function kWe(i){const e=Ne("space"),t=R(()=>[e.b(),e.m(i.direction),i.class]),n=W(0),r=W(0),s=R(()=>{const o=i.wrap||i.fill?{flexWrap:"wrap",marginBottom:`-${r.value}px`}:{},l={alignItems:i.alignment};return[o,l,i.style]}),a=R(()=>{const o={paddingBottom:`${r.value}px`,marginRight:`${n.value}px`},l=i.fill?{flexGrow:1,minWidth:`${i.fillRatio}%`}:{};return[o,l]});return Ru(()=>{const{size:o="small",wrap:l,direction:c,fill:u}=i;if(st(o)){const[d=0,h=0]=o;n.value=d,r.value=h}else{let d;It(o)?d=o:d=bK[o||"small"]||bK.small,(l||u)&&c==="horizontal"?n.value=r.value=d:c==="horizontal"?(n.value=d,r.value=0):(r.value=d,n.value=0)}}),{classes:t,containerStyle:s,itemStyle:a}}const FWe=Ke({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:xe([String,Object,Array]),default:""},style:{type:xe([String,Array,Object]),default:""},alignment:{type:xe(String),default:"center"},prefixCls:{type:String},spacer:{type:xe([Object,String,Number,Array]),default:null,validator:i=>Pr(i)||It(i)||Ft(i)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:gg,validator:i=>It(i)||st(i)&&i.length===2&&i.every(It)}}),NWe=de({name:"ElSpace",props:FWe,setup(i,{slots:e}){const{classes:t,containerStyle:n,itemStyle:r}=kWe(i);function s(a,o="",l=[]){const{prefixCls:c}=i;return a.forEach((u,d)=>{R5(u)?st(u.children)&&u.children.forEach((h,p)=>{R5(h)&&st(h.children)?s(h.children,`${o+p}-`,l):l.push(re(_K,{style:r.value,prefixCls:c,key:`nested-${o+p}`},{default:()=>[h]},id.PROPS|id.STYLE,["style","prefixCls"]))}):s3e(u)&&l.push(re(_K,{style:r.value,prefixCls:c,key:`LoopKey${o+d}`},{default:()=>[u]},id.PROPS|id.STYLE,["style","prefixCls"]))}),l}return()=>{var a;const{spacer:o,direction:l}=i,c=Fe(e,"default",{key:0},()=>[]);if(((a=c.children)!=null?a:[]).length===0)return null;if(st(c.children)){let u=s(c.children);if(o){const d=u.length-1;u=u.reduce((h,p,m)=>{const g=[...h,p];return m!==d&&g.push(re("span",{style:[r.value,l==="vertical"?"width: 100%":null],key:m},[Pr(o)?o:Gi(o,id.TEXT)],id.STYLE)),g},[])}return re("div",{class:t.value,style:n.value},u,id.STYLE|id.CLASS)}return c.children}}}),VWe=ii(NWe),BWe=Ke({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:xe([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:xe([String,Object,Array])}}),zWe=de({name:"ElStatistic"}),UWe=de({...zWe,props:BWe,setup(i,{expose:e}){const t=i,n=Ne("statistic"),r=R(()=>{const{value:s,formatter:a,precision:o,decimalSeparator:l,groupSeparator:c}=t;if(Lt(a))return a(s);if(!It(s))return s;let[u,d=""]=String(s).split(".");return d=d.padEnd(o,"0").slice(0,o>0?o:0),u=u.replace(/\B(?=(\d{3})+(?!\d))/g,c),[u,d].join(d?l:"")});return e({displayValue:r}),(s,a)=>(I(),Z("div",{class:N(v(n).b())},[s.$slots.title||s.title?(I(),Z("div",{key:0,class:N(v(n).e("head"))},[Fe(s.$slots,"title",{},()=>[Gi(We(s.title),1)])],2)):_e("v-if",!0),Q("div",{class:N(v(n).e("content"))},[s.$slots.prefix||s.prefix?(I(),Z("div",{key:0,class:N(v(n).e("prefix"))},[Fe(s.$slots,"prefix",{},()=>[Q("span",null,We(s.prefix),1)])],2)):_e("v-if",!0),Q("span",{class:N(v(n).e("number")),style:pt(s.valueStyle)},We(v(r)),7),s.$slots.suffix||s.suffix?(I(),Z("div",{key:1,class:N(v(n).e("suffix"))},[Fe(s.$slots,"suffix",{},()=>[Q("span",null,We(s.suffix),1)])],2)):_e("v-if",!0)],2)],2))}});var HWe=qe(UWe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/statistic/src/statistic.vue"]]);const vce=ii(HWe),GWe=Ke({format:{type:String,default:"HH:mm:ss"},prefix:String,suffix:String,title:String,value:{type:xe([Number,Object]),default:0},valueStyle:{type:xe([String,Object,Array])}}),WWe={finish:()=>!0,[rr]:i=>It(i)},jWe=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]],wK=i=>It(i)?new Date(i).getTime():i.valueOf(),xK=(i,e)=>{let t=i;const n=/\[([^\]]*)]/g;return jWe.reduce((s,[a,o])=>{const l=new RegExp(`${a}+(?![^\\[\\]]*\\])`,"g");if(l.test(s)){const c=Math.floor(t/o);return t-=c*o,s.replace(l,u=>String(c).padStart(u.length,"0"))}return s},e).replace(n,"$1")},qWe=de({name:"ElCountdown"}),KWe=de({...qWe,props:GWe,emits:WWe,setup(i,{expose:e,emit:t}){const n=i;let r;const s=W(wK(n.value)-Date.now()),a=R(()=>xK(s.value,n.format)),o=u=>xK(u,n.format),l=()=>{r&&(R3(r),r=void 0)},c=()=>{const u=wK(n.value),d=()=>{let h=u-Date.now();t("change",h),h<=0?(h=0,l(),t("finish")):r=U2(d),s.value=h};r=U2(d)};return Ve(()=>[n.value,n.format],()=>{l(),c()},{immediate:!0}),Vr(()=>{l()}),e({displayValue:a}),(u,d)=>(I(),Se(v(vce),{value:s.value,title:u.title,prefix:u.prefix,suffix:u.suffix,"value-style":u.valueStyle,formatter:o},qm({_:2},[xi(u.$slots,(h,p)=>({name:p,fn:pe(()=>[Fe(u.$slots,p)])}))]),1032,["value","title","prefix","suffix","value-style"]))}});var YWe=qe(KWe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/countdown/src/countdown.vue"]]);const XWe=ii(YWe),ZWe=Ke({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),QWe={[rr]:(i,e)=>[i,e].every(It)},JWe=de({name:"ElSteps"}),eje=de({...JWe,props:ZWe,emits:QWe,setup(i,{emit:e}){const t=i,n=Ne("steps"),r=W([]);return Ve(r,()=>{r.value.forEach((s,a)=>{s.setIndex(a)})}),pi("ElSteps",{props:t,steps:r}),Ve(()=>t.active,(s,a)=>{e(rr,s,a)}),(s,a)=>(I(),Z("div",{class:N([v(n).b(),v(n).m(s.simple?"simple":s.direction)])},[Fe(s.$slots,"default")],2))}});var tje=qe(eje,[["__file","/home/runner/work/element-plus/element-plus/packages/components/steps/src/steps.vue"]]);const ije=Ke({title:{type:String,default:""},icon:{type:Zn},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),nje=de({name:"ElStep"}),rje=de({...nje,props:ije,setup(i){const e=i,t=Ne("step"),n=W(-1),r=W({}),s=W(""),a=ht("ElSteps"),o=ti();qt(()=>{Ve([()=>a.props.active,()=>a.props.processStatus,()=>a.props.finishStatus],([S])=>{w(S)},{immediate:!0})}),Vr(()=>{a.steps.value=a.steps.value.filter(S=>S.uid!==(o==null?void 0:o.uid))});const l=R(()=>e.status||s.value),c=R(()=>{const S=a.steps.value[n.value-1];return S?S.currentStatus:"wait"}),u=R(()=>a.props.alignCenter),d=R(()=>a.props.direction==="vertical"),h=R(()=>a.props.simple),p=R(()=>a.steps.value.length),m=R(()=>{var S;return((S=a.steps.value[p.value-1])==null?void 0:S.uid)===(o==null?void 0:o.uid)}),g=R(()=>h.value?"":a.props.space),_=R(()=>{const S={flexBasis:typeof g.value=="number"?`${g.value}px`:g.value?g.value:`${100/(p.value-(u.value?0:1))}%`};return d.value||m.value&&(S.maxWidth=`${100/p.value}%`),S}),b=S=>{n.value=S},x=S=>{let E=100;const A={};A.transitionDelay=`${150*n.value}ms`,S===a.props.processStatus?E=0:S==="wait"&&(E=0,A.transitionDelay=`${-150*n.value}ms`),A.borderWidth=E&&!h.value?"1px":0,A[a.props.direction==="vertical"?"height":"width"]=`${E}%`,r.value=A},w=S=>{S>n.value?s.value=a.props.finishStatus:S===n.value&&c.value!=="error"?s.value=a.props.processStatus:s.value="wait";const E=a.steps.value[n.value-1];E&&E.calcProgress(s.value)},C=Ji({uid:R(()=>o==null?void 0:o.uid),currentStatus:l,setIndex:b,calcProgress:x});return a.steps.value=[...a.steps.value,C],(S,E)=>(I(),Z("div",{style:pt(v(_)),class:N([v(t).b(),v(t).is(v(h)?"simple":v(a).props.direction),v(t).is("flex",v(m)&&!v(g)&&!v(u)),v(t).is("center",v(u)&&!v(d)&&!v(h))])},[_e(" icon & line "),Q("div",{class:N([v(t).e("head"),v(t).is(v(l))])},[v(h)?_e("v-if",!0):(I(),Z("div",{key:0,class:N(v(t).e("line"))},[Q("i",{class:N(v(t).e("line-inner")),style:pt(r.value)},null,6)],2)),Q("div",{class:N([v(t).e("icon"),v(t).is(S.icon||S.$slots.icon?"icon":"text")])},[Fe(S.$slots,"icon",{},()=>[S.icon?(I(),Se(v(ct),{key:0,class:N(v(t).e("icon-inner"))},{default:pe(()=>[(I(),Se(hi(S.icon)))]),_:1},8,["class"])):v(l)==="success"?(I(),Se(v(ct),{key:1,class:N([v(t).e("icon-inner"),v(t).is("status")])},{default:pe(()=>[re(v(sM))]),_:1},8,["class"])):v(l)==="error"?(I(),Se(v(ct),{key:2,class:N([v(t).e("icon-inner"),v(t).is("status")])},{default:pe(()=>[re(v(Rh))]),_:1},8,["class"])):v(h)?_e("v-if",!0):(I(),Z("div",{key:3,class:N(v(t).e("icon-inner"))},We(n.value+1),3))])],2)],2),_e(" title & description "),Q("div",{class:N(v(t).e("main"))},[Q("div",{class:N([v(t).e("title"),v(t).is(v(l))])},[Fe(S.$slots,"title",{},()=>[Gi(We(S.title),1)])],2),v(h)?(I(),Z("div",{key:0,class:N(v(t).e("arrow"))},null,2)):(I(),Z("div",{key:1,class:N([v(t).e("description"),v(t).is(v(l))])},[Fe(S.$slots,"description",{},()=>[Gi(We(S.description),1)])],2))],2)],6))}});var yce=qe(rje,[["__file","/home/runner/work/element-plus/element-plus/packages/components/steps/src/item.vue"]]);const sje=ii(tje,{Step:yce}),aje=Wr(yce),oje=Ke({modelValue:{type:[Boolean,String,Number],default:!1},value:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},activeIcon:{type:Zn},inactiveIcon:{type:Zn},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},id:String,loading:{type:Boolean,default:!1},beforeChange:{type:xe(Function)},size:{type:String,validator:aM},tabindex:{type:[String,Number]}}),lje={[ri]:i=>Ys(i)||Ft(i)||It(i),[rr]:i=>Ys(i)||Ft(i)||It(i),[jl]:i=>Ys(i)||Ft(i)||It(i)},cje=["onClick"],uje=["id","aria-checked","aria-disabled","name","true-value","false-value","disabled","tabindex","onKeydown"],dje=["aria-hidden"],hje=["aria-hidden"],pje=["aria-hidden"],bV="ElSwitch",fje=de({name:bV}),mje=de({...fje,props:oje,emits:lje,setup(i,{expose:e,emit:t}){const n=i,r=ti(),{formItem:s}=nc(),a=Qs(),o=Ne("switch");Ym({from:'"value"',replacement:'"model-value" or "v-model"',scope:bV,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},R(()=>{var S;return!!((S=r.vnode.props)!=null&&S.value)}));const{inputId:l}=By(n,{formItemContext:s}),c=zc(R(()=>n.loading)),u=W(n.modelValue!==!1),d=W(),h=W(),p=R(()=>[o.b(),o.m(a.value),o.is("disabled",c.value),o.is("checked",_.value)]),m=R(()=>({width:Xs(n.width)}));Ve(()=>n.modelValue,()=>{u.value=!0}),Ve(()=>n.value,()=>{u.value=!1});const g=R(()=>u.value?n.modelValue:n.value),_=R(()=>g.value===n.activeValue);[n.activeValue,n.inactiveValue].includes(g.value)||(t(ri,n.inactiveValue),t(rr,n.inactiveValue),t(jl,n.inactiveValue)),Ve(_,S=>{var E;d.value.checked=S,n.validateEvent&&((E=s==null?void 0:s.validate)==null||E.call(s,"change").catch(A=>void 0))});const b=()=>{const S=_.value?n.inactiveValue:n.activeValue;t(ri,S),t(rr,S),t(jl,S),ut(()=>{d.value.checked=_.value})},x=()=>{if(c.value)return;const{beforeChange:S}=n;if(!S){b();return}const E=S();[C2(E),Ys(E)].includes(!0)||ba(bV,"beforeChange must return type `Promise<boolean>` or `boolean`"),C2(E)?E.then(P=>{P&&b()}).catch(P=>{}):E&&b()},w=R(()=>o.cssVarBlock({...n.activeColor?{"on-color":n.activeColor}:null,...n.inactiveColor?{"off-color":n.inactiveColor}:null,...n.borderColor?{"border-color":n.borderColor}:null})),C=()=>{var S,E;(E=(S=d.value)==null?void 0:S.focus)==null||E.call(S)};return qt(()=>{d.value.checked=_.value}),e({focus:C,checked:_}),(S,E)=>(I(),Z("div",{class:N(v(p)),style:pt(v(w)),onClick:Dt(x,["prevent"])},[Q("input",{id:v(l),ref_key:"input",ref:d,class:N(v(o).e("input")),type:"checkbox",role:"switch","aria-checked":v(_),"aria-disabled":v(c),name:S.name,"true-value":S.activeValue,"false-value":S.inactiveValue,disabled:v(c),tabindex:S.tabindex,onChange:b,onKeydown:Di(x,["enter"])},null,42,uje),!S.inlinePrompt&&(S.inactiveIcon||S.inactiveText)?(I(),Z("span",{key:0,class:N([v(o).e("label"),v(o).em("label","left"),v(o).is("active",!v(_))])},[S.inactiveIcon?(I(),Se(v(ct),{key:0},{default:pe(()=>[(I(),Se(hi(S.inactiveIcon)))]),_:1})):_e("v-if",!0),!S.inactiveIcon&&S.inactiveText?(I(),Z("span",{key:1,"aria-hidden":v(_)},We(S.inactiveText),9,dje)):_e("v-if",!0)],2)):_e("v-if",!0),Q("span",{ref_key:"core",ref:h,class:N(v(o).e("core")),style:pt(v(m))},[S.inlinePrompt?(I(),Z("div",{key:0,class:N(v(o).e("inner"))},[S.activeIcon||S.inactiveIcon?(I(),Se(v(ct),{key:0,class:N(v(o).is("icon"))},{default:pe(()=>[(I(),Se(hi(v(_)?S.activeIcon:S.inactiveIcon)))]),_:1},8,["class"])):S.activeText||S.inactiveText?(I(),Z("span",{key:1,class:N(v(o).is("text")),"aria-hidden":!v(_)},We(v(_)?S.activeText:S.inactiveText),11,hje)):_e("v-if",!0)],2)):_e("v-if",!0),Q("div",{class:N(v(o).e("action"))},[S.loading?(I(),Se(v(ct),{key:0,class:N(v(o).is("loading"))},{default:pe(()=>[re(v(Vy))]),_:1},8,["class"])):_e("v-if",!0)],2)],6),!S.inlinePrompt&&(S.activeIcon||S.activeText)?(I(),Z("span",{key:1,class:N([v(o).e("label"),v(o).em("label","right"),v(o).is("active",v(_))])},[S.activeIcon?(I(),Se(v(ct),{key:0},{default:pe(()=>[(I(),Se(hi(S.activeIcon)))]),_:1})):_e("v-if",!0),!S.activeIcon&&S.activeText?(I(),Z("span",{key:1,"aria-hidden":!v(_)},We(S.activeText),9,pje)):_e("v-if",!0)],2)):_e("v-if",!0)],14,cje))}});var gje=qe(mje,[["__file","/home/runner/work/element-plus/element-plus/packages/components/switch/src/switch.vue"]]);const vje=ii(gje);/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var yje=/["'&<>]/,_je=bje;function bje(i){var e=""+i,t=yje.exec(e);if(!t)return e;var n,r="",s=0,a=0;for(s=t.index;s<e.length;s++){switch(e.charCodeAt(s)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}a!==s&&(r+=e.substring(a,s)),a=s+1,r+=n}return a!==s?r+e.substring(a,s):r}const Lk=function(i){var e;return(e=i.target)==null?void 0:e.closest("td")},wje=function(i,e,t,n,r){if(!e&&!n&&(!r||Array.isArray(r)&&!r.length))return i;typeof t=="string"?t=t==="descending"?-1:1:t=t&&t<0?-1:1;const s=n?null:function(o,l){return r?(Array.isArray(r)||(r=[r]),r.map(c=>typeof c=="string"?Tr(o,c):c(o,l,i))):(e!=="$key"&&oi(o)&&"$value"in o&&(o=o.$value),[oi(o)?Tr(o,e):o])},a=function(o,l){if(n)return n(o.value,l.value);for(let c=0,u=o.key.length;c<u;c++){if(o.key[c]<l.key[c])return-1;if(o.key[c]>l.key[c])return 1}return 0};return i.map((o,l)=>({value:o,index:l,key:s?s(o,l):null})).sort((o,l)=>{let c=a(o,l);return c||(c=o.index-l.index),c*+t}).map(o=>o.value)},_ce=function(i,e){let t=null;return i.columns.forEach(n=>{n.id===e&&(t=n)}),t},xje=function(i,e){let t=null;for(let n=0;n<i.columns.length;n++){const r=i.columns[n];if(r.columnKey===e){t=r;break}}return t||ba("ElTable",`No column matching with column-key: ${e}`),t},CK=function(i,e,t){const n=(e.className||"").match(new RegExp(`${t}-table_[^\\s]+`,"gm"));return n?_ce(i,n[0]):null},Oo=(i,e)=>{if(!i)throw new Error("Row is required when get row identity");if(typeof e=="string"){if(!e.includes("."))return`${i[e]}`;const t=e.split(".");let n=i;for(const r of t)n=n[r];return`${n}`}else if(typeof e=="function")return e.call(null,i)},C0=function(i,e){const t={};return(i||[]).forEach((n,r)=>{t[Oo(n,e)]={row:n,index:r}}),t};function Cje(i,e){const t={};let n;for(n in i)t[n]=i[n];for(n in e)if(Ci(e,n)){const r=e[n];typeof r<"u"&&(t[n]=r)}return t}function G9(i){return i===""||i!==void 0&&(i=Number.parseInt(i,10),Number.isNaN(i)&&(i="")),i}function bce(i){return i===""||i!==void 0&&(i=G9(i),Number.isNaN(i)&&(i=80)),i}function Tje(i){return typeof i=="number"?i:typeof i=="string"?/^\d+(?:px)?$/.test(i)?Number.parseInt(i,10):i:null}function Sje(...i){return i.length===0?e=>e:i.length===1?i[0]:i.reduce((e,t)=>(...n)=>e(t(...n)))}function yE(i,e,t){let n=!1;const r=i.indexOf(e),s=r!==-1,a=o=>{o==="add"?i.push(e):i.splice(r,1),n=!0,st(e.children)&&e.children.forEach(l=>{yE(i,l,t??!s)})};return Ys(t)?t&&!s?a("add"):!t&&s&&a("remove"):a(s?"remove":"add"),n}function Eje(i,e,t="children",n="hasChildren"){const r=a=>!(Array.isArray(a)&&a.length);function s(a,o,l){e(a,o,l),o.forEach(c=>{if(c[n]){e(c,null,l+1);return}const u=c[t];r(u)||s(c,u,l+1)})}i.forEach(a=>{if(a[n]){e(a,null,0);return}const o=a[t];r(o)||s(a,o,0)})}let jf;function Aje(i,e,t,n){n=uae({enterable:!0,showArrow:!0},n);const{nextZIndex:r}=yg(),s=i==null?void 0:i.dataset.prefix,a=i==null?void 0:i.querySelector(`.${s}-scrollbar__wrap`);function o(){const _=n.effect==="light",b=document.createElement("div");return b.className=[`${s}-popper`,_?"is-light":"is-dark",n.popperClass||""].join(" "),t=_je(t),b.innerHTML=t,b.style.zIndex=String(r()),i==null||i.appendChild(b),b}function l(){const _=document.createElement("div");return _.className=`${s}-popper__arrow`,_}function c(){u&&u.update()}jf==null||jf(),jf=()=>{try{u&&u.destroy(),p&&(i==null||i.removeChild(p)),e.removeEventListener("mouseenter",d),e.removeEventListener("mouseleave",h),a==null||a.removeEventListener("scroll",jf),jf=void 0}catch{}};let u=null,d=c,h=jf;n.enterable&&({onOpen:d,onClose:h}=ooe({showAfter:n.showAfter,hideAfter:n.hideAfter,open:c,close:jf}));const p=o();p.onmouseenter=d,p.onmouseleave=h;const m=[];if(n.offset&&m.push({name:"offset",options:{offset:[0,n.offset]}}),n.showArrow){const _=p.appendChild(l());m.push({name:"arrow",options:{element:_,padding:10}})}const g=n.popperOptions||{};return u=soe(e,p,{placement:n.placement||"top",strategy:"fixed",...g,modifiers:g.modifiers?m.concat(g.modifiers):m}),e.addEventListener("mouseenter",d),e.addEventListener("mouseleave",h),a==null||a.addEventListener("scroll",jf),u}function wce(i){return i.children?OPe(i.children,wce):[i]}function TK(i,e){return i+e.colSpan}const xce=(i,e,t,n)=>{let r=0,s=i;const a=t.states.columns.value;if(n){const l=wce(n[i]);r=a.slice(0,a.indexOf(l[0])).reduce(TK,0),s=r+l.reduce(TK,0)-1}else r=i;let o;switch(e){case"left":s<t.states.fixedLeafColumnsLength.value&&(o="left");break;case"right":r>=a.length-t.states.rightFixedLeafColumnsLength.value&&(o="right");break;default:s<t.states.fixedLeafColumnsLength.value?o="left":r>=a.length-t.states.rightFixedLeafColumnsLength.value&&(o="right")}return o?{direction:o,start:r,after:s}:{}},W9=(i,e,t,n,r,s=0)=>{const a=[],{direction:o,start:l,after:c}=xce(e,t,n,r);if(o){const u=o==="left";a.push(`${i}-fixed-column--${o}`),u&&c+s===n.states.fixedLeafColumnsLength.value-1?a.push("is-last-column"):!u&&l-s===n.states.columns.value.length-n.states.rightFixedLeafColumnsLength.value&&a.push("is-first-column")}return a};function SK(i,e){return i+(e.realWidth===null||Number.isNaN(e.realWidth)?Number(e.width):e.realWidth)}const j9=(i,e,t,n)=>{const{direction:r,start:s=0,after:a=0}=xce(i,e,t,n);if(!r)return;const o={},l=r==="left",c=t.states.columns.value;return l?o.left=c.slice(0,s).reduce(SK,0):o.right=c.slice(a+1).reverse().reduce(SK,0),o},hC=(i,e)=>{i&&(Number.isNaN(i[e])||(i[e]=`${i[e]}px`))};function Mje(i){const e=ti(),t=W(!1),n=W([]);return{updateExpandRows:()=>{const l=i.data.value||[],c=i.rowKey.value;if(t.value)n.value=l.slice();else if(c){const u=C0(n.value,c);n.value=l.reduce((d,h)=>{const p=Oo(h,c);return u[p]&&d.push(h),d},[])}else n.value=[]},toggleRowExpansion:(l,c)=>{yE(n.value,l,c)&&e.emit("expand-change",l,n.value.slice())},setExpandRowKeys:l=>{e.store.assertRowKey();const c=i.data.value||[],u=i.rowKey.value,d=C0(c,u);n.value=l.reduce((h,p)=>{const m=d[p];return m&&h.push(m.row),h},[])},isRowExpanded:l=>{const c=i.rowKey.value;return c?!!C0(n.value,c)[Oo(l,c)]:n.value.includes(l)},states:{expandRows:n,defaultExpandAll:t}}}function Pje(i){const e=ti(),t=W(null),n=W(null),r=c=>{e.store.assertRowKey(),t.value=c,a(c)},s=()=>{t.value=null},a=c=>{const{data:u,rowKey:d}=i;let h=null;d.value&&(h=(v(u)||[]).find(p=>Oo(p,d.value)===c)),n.value=h,e.emit("current-change",n.value,null)};return{setCurrentRowKey:r,restoreCurrentRowKey:s,setCurrentRowByKey:a,updateCurrentRow:c=>{const u=n.value;if(c&&c!==u){n.value=c,e.emit("current-change",n.value,u);return}!c&&u&&(n.value=null,e.emit("current-change",null,u))},updateCurrentRowData:()=>{const c=i.rowKey.value,u=i.data.value||[],d=n.value;if(!u.includes(d)&&d){if(c){const h=Oo(d,c);a(h)}else n.value=null;n.value===null&&e.emit("current-change",null,d)}else t.value&&(a(t.value),s())},states:{_currentRowKey:t,currentRow:n}}}function Oje(i){const e=W([]),t=W({}),n=W(16),r=W(!1),s=W({}),a=W("hasChildren"),o=W("children"),l=ti(),c=R(()=>{if(!i.rowKey.value)return{};const b=i.data.value||[];return d(b)}),u=R(()=>{const b=i.rowKey.value,x=Object.keys(s.value),w={};return x.length&&x.forEach(C=>{if(s.value[C].length){const S={children:[]};s.value[C].forEach(E=>{const A=Oo(E,b);S.children.push(A),E[a.value]&&!w[A]&&(w[A]={children:[]})}),w[C]=S}}),w}),d=b=>{const x=i.rowKey.value,w={};return Eje(b,(C,S,E)=>{const A=Oo(C,x);Array.isArray(S)?w[A]={children:S.map(P=>Oo(P,x)),level:E}:r.value&&(w[A]={children:[],lazy:!0,level:E})},o.value,a.value),w},h=(b=!1,x=(w=>(w=l.store)==null?void 0:w.states.defaultExpandAll.value)())=>{var w;const C=c.value,S=u.value,E=Object.keys(C),A={};if(E.length){const P=v(t),O=[],M=(L,U)=>{if(b)return e.value?x||e.value.includes(U):!!(x||L!=null&&L.expanded);{const G=x||e.value&&e.value.includes(U);return!!(L!=null&&L.expanded||G)}};E.forEach(L=>{const U=P[L],G={...C[L]};if(G.expanded=M(U,L),G.lazy){const{loaded:H=!1,loading:k=!1}=U||{};G.loaded=!!H,G.loading=!!k,O.push(L)}A[L]=G});const V=Object.keys(S);r.value&&V.length&&O.length&&V.forEach(L=>{const U=P[L],G=S[L].children;if(O.includes(L)){if(A[L].children.length!==0)throw new Error("[ElTable]children must be an empty array.");A[L].children=G}else{const{loaded:H=!1,loading:k=!1}=U||{};A[L]={lazy:!0,loaded:!!H,loading:!!k,expanded:M(U,L),children:G,level:""}}})}t.value=A,(w=l.store)==null||w.updateTableScrollY()};Ve(()=>e.value,()=>{h(!0)}),Ve(()=>c.value,()=>{h()}),Ve(()=>u.value,()=>{h()});const p=b=>{e.value=b,h()},m=(b,x)=>{l.store.assertRowKey();const w=i.rowKey.value,C=Oo(b,w),S=C&&t.value[C];if(C&&S&&"expanded"in S){const E=S.expanded;x=typeof x>"u"?!S.expanded:x,t.value[C].expanded=x,E!==x&&l.emit("expand-change",b,x),l.store.updateTableScrollY()}},g=b=>{l.store.assertRowKey();const x=i.rowKey.value,w=Oo(b,x),C=t.value[w];r.value&&C&&"loaded"in C&&!C.loaded?_(b,w,C):m(b,void 0)},_=(b,x,w)=>{const{load:C}=l.props;C&&!t.value[x].loaded&&(t.value[x].loading=!0,C(b,w,S=>{if(!Array.isArray(S))throw new TypeError("[ElTable] data must be an array");t.value[x].loading=!1,t.value[x].loaded=!0,t.value[x].expanded=!0,S.length&&(s.value[x]=S),l.emit("expand-change",b,!0)}))};return{loadData:_,loadOrToggle:g,toggleTreeExpansion:m,updateTreeExpandKeys:p,updateTreeData:h,normalize:d,states:{expandRowKeys:e,treeData:t,indent:n,lazy:r,lazyTreeNodeMap:s,lazyColumnIdentifier:a,childrenColumnName:o}}}const Rje=(i,e)=>{const t=e.sortingColumn;return!t||typeof t.sortable=="string"?i:wje(i,e.sortProp,e.sortOrder,t.sortMethod,t.sortBy)},PR=i=>{const e=[];return i.forEach(t=>{t.children?e.push.apply(e,PR(t.children)):e.push(t)}),e};function Ije(){var i;const e=ti(),{size:t}=_a((i=e.proxy)==null?void 0:i.$props),n=W(null),r=W([]),s=W([]),a=W(!1),o=W([]),l=W([]),c=W([]),u=W([]),d=W([]),h=W([]),p=W([]),m=W([]),g=W(0),_=W(0),b=W(0),x=W(!1),w=W([]),C=W(!1),S=W(!1),E=W(null),A=W({}),P=W(null),O=W(null),M=W(null),V=W(null),L=W(null);Ve(r,()=>e.state&&k(!1),{deep:!0});const U=()=>{if(!n.value)throw new Error("[ElTable] prop row-key is required")},G=te=>{var me;(me=te.children)==null||me.forEach(Ie=>{Ie.fixed=te.fixed,G(Ie)})},H=()=>{o.value.forEach(se=>{G(se)}),u.value=o.value.filter(se=>se.fixed===!0||se.fixed==="left"),d.value=o.value.filter(se=>se.fixed==="right"),u.value.length>0&&o.value[0]&&o.value[0].type==="selection"&&!o.value[0].fixed&&(o.value[0].fixed=!0,u.value.unshift(o.value[0]));const te=o.value.filter(se=>!se.fixed);l.value=[].concat(u.value).concat(te).concat(d.value);const me=PR(te),Ie=PR(u.value),K=PR(d.value);g.value=me.length,_.value=Ie.length,b.value=K.length,c.value=[].concat(Ie).concat(me).concat(K),a.value=u.value.length>0||d.value.length>0},k=(te,me=!1)=>{te&&H(),me?e.state.doLayout():e.state.debouncedUpdateLayout()},D=te=>w.value.includes(te),$=()=>{x.value=!1,w.value.length&&(w.value=[],e.emit("selection-change",[]))},F=()=>{let te;if(n.value){te=[];const me=C0(w.value,n.value),Ie=C0(r.value,n.value);for(const K in me)Ci(me,K)&&!Ie[K]&&te.push(me[K].row)}else te=w.value.filter(me=>!r.value.includes(me));if(te.length){const me=w.value.filter(Ie=>!te.includes(Ie));w.value=me,e.emit("selection-change",me.slice())}},Y=()=>(w.value||[]).slice(),ne=(te,me=void 0,Ie=!0)=>{if(yE(w.value,te,me)){const se=(w.value||[]).slice();Ie&&e.emit("select",se,te),e.emit("selection-change",se)}},X=()=>{var te,me;const Ie=S.value?!x.value:!(x.value||w.value.length);x.value=Ie;let K=!1,se=0;const Me=(me=(te=e==null?void 0:e.store)==null?void 0:te.states)==null?void 0:me.rowKey.value;r.value.forEach((De,Tt)=>{const Zt=Tt+se;E.value?E.value.call(null,De,Zt)&&yE(w.value,De,Ie)&&(K=!0):yE(w.value,De,Ie)&&(K=!0),se+=ye(Oo(De,Me))}),K&&e.emit("selection-change",w.value?w.value.slice():[]),e.emit("select-all",w.value)},J=()=>{const te=C0(w.value,n.value);r.value.forEach(me=>{const Ie=Oo(me,n.value),K=te[Ie];K&&(w.value[K.index]=me)})},he=()=>{var te,me,Ie;if(((te=r.value)==null?void 0:te.length)===0){x.value=!1;return}let K;n.value&&(K=C0(w.value,n.value));const se=function(Zt){return K?!!K[Oo(Zt,n.value)]:w.value.includes(Zt)};let Me=!0,De=0,Tt=0;for(let Zt=0,tn=(r.value||[]).length;Zt<tn;Zt++){const vn=(Ie=(me=e==null?void 0:e.store)==null?void 0:me.states)==null?void 0:Ie.rowKey.value,ui=Zt+Tt,di=r.value[Zt],ze=E.value&&E.value.call(null,di,ui);if(se(di))De++;else if(!E.value||ze){Me=!1;break}Tt+=ye(Oo(di,vn))}De===0&&(Me=!1),x.value=Me},ye=te=>{var me;if(!e||!e.store)return 0;const{treeData:Ie}=e.store.states;let K=0;const se=(me=Ie.value[te])==null?void 0:me.children;return se&&(K+=se.length,se.forEach(Me=>{K+=ye(Me)})),K},Te=(te,me)=>{Array.isArray(te)||(te=[te]);const Ie={};return te.forEach(K=>{A.value[K.id]=me,Ie[K.columnKey||K.id]=me}),Ie},ce=(te,me,Ie)=>{O.value&&O.value!==te&&(O.value.order=null),O.value=te,M.value=me,V.value=Ie},ae=()=>{let te=v(s);Object.keys(A.value).forEach(me=>{const Ie=A.value[me];if(!Ie||Ie.length===0)return;const K=_ce({columns:c.value},me);K&&K.filterMethod&&(te=te.filter(se=>Ie.some(Me=>K.filterMethod.call(null,Me,se,K))))}),P.value=te},le=()=>{r.value=Rje(P.value,{sortingColumn:O.value,sortProp:M.value,sortOrder:V.value})},fe=(te=void 0)=>{te&&te.filter||ae(),le()},Ue=te=>{const{tableHeaderRef:me}=e.refs;if(!me)return;const Ie=Object.assign({},me.filterPanels),K=Object.keys(Ie);if(K.length)if(typeof te=="string"&&(te=[te]),Array.isArray(te)){const se=te.map(Me=>xje({columns:c.value},Me));K.forEach(Me=>{const De=se.find(Tt=>Tt.id===Me);De&&(De.filteredValue=[])}),e.store.commit("filterChange",{column:se,values:[],silent:!0,multi:!0})}else K.forEach(se=>{const Me=c.value.find(De=>De.id===se);Me&&(Me.filteredValue=[])}),A.value={},e.store.commit("filterChange",{column:{},values:[],silent:!0})},ie=()=>{O.value&&(ce(null,null,null),e.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:oe,toggleRowExpansion:we,updateExpandRows:Ae,states:Oe,isRowExpanded:ve}=Mje({data:r,rowKey:n}),{updateTreeExpandKeys:ke,toggleTreeExpansion:be,updateTreeData:$e,loadOrToggle:Le,states:Ce}=Oje({data:r,rowKey:n}),{updateCurrentRowData:Be,updateCurrentRow:He,setCurrentRowKey:Xe,states:Je}=Pje({data:r,rowKey:n});return{assertRowKey:U,updateColumns:H,scheduleLayout:k,isSelected:D,clearSelection:$,cleanSelection:F,getSelectionRows:Y,toggleRowSelection:ne,_toggleAllSelection:X,toggleAllSelection:null,updateSelectionByRowKey:J,updateAllSelected:he,updateFilters:Te,updateCurrentRow:He,updateSort:ce,execFilter:ae,execSort:le,execQuery:fe,clearFilter:Ue,clearSort:ie,toggleRowExpansion:we,setExpandRowKeysAdapter:te=>{oe(te),ke(te)},setCurrentRowKey:Xe,toggleRowExpansionAdapter:(te,me)=>{c.value.some(({type:K})=>K==="expand")?we(te,me):be(te,me)},isRowExpanded:ve,updateExpandRows:Ae,updateCurrentRowData:Be,loadOrToggle:Le,updateTreeData:$e,states:{tableSize:t,rowKey:n,data:r,_data:s,isComplex:a,_columns:o,originColumns:l,columns:c,fixedColumns:u,rightFixedColumns:d,leafColumns:h,fixedLeafColumns:p,rightFixedLeafColumns:m,leafColumnsLength:g,fixedLeafColumnsLength:_,rightFixedLeafColumnsLength:b,isAllSelected:x,selection:w,reserveSelection:C,selectOnIndeterminate:S,selectable:E,filters:A,filteredData:P,sortingColumn:O,sortProp:M,sortOrder:V,hoverRow:L,...Oe,...Ce,...Je}}}function wV(i,e){return i.map(t=>{var n;return t.id===e.id?e:((n=t.children)!=null&&n.length&&(t.children=wV(t.children,e)),t)})}function Cce(i){i.forEach(e=>{var t,n;e.no=(t=e.getColumnIndex)==null?void 0:t.call(e),(n=e.children)!=null&&n.length&&Cce(e.children)}),i.sort((e,t)=>e.no-t.no)}function $je(){const i=ti(),e=Ije();return{ns:Ne("table"),...e,mutations:{setData(a,o){const l=v(a._data)!==o;a.data.value=o,a._data.value=o,i.store.execQuery(),i.store.updateCurrentRowData(),i.store.updateExpandRows(),i.store.updateTreeData(i.store.states.defaultExpandAll.value),v(a.reserveSelection)?(i.store.assertRowKey(),i.store.updateSelectionByRowKey()):l?i.store.clearSelection():i.store.cleanSelection(),i.store.updateAllSelected(),i.$ready&&i.store.scheduleLayout()},insertColumn(a,o,l){const c=v(a._columns);let u=[];l?(l&&!l.children&&(l.children=[]),l.children.push(o),u=wV(c,l)):(c.push(o),u=c),Cce(u),a._columns.value=u,o.type==="selection"&&(a.selectable.value=o.selectable,a.reserveSelection.value=o.reserveSelection),i.$ready&&(i.store.updateColumns(),i.store.scheduleLayout())},removeColumn(a,o,l){const c=v(a._columns)||[];if(l)l.children.splice(l.children.findIndex(u=>u.id===o.id),1),ut(()=>{var u;((u=l.children)==null?void 0:u.length)===0&&delete l.children}),a._columns.value=wV(c,l);else{const u=c.indexOf(o);u>-1&&(c.splice(u,1),a._columns.value=c)}i.$ready&&(i.store.updateColumns(),i.store.scheduleLayout())},sort(a,o){const{prop:l,order:c,init:u}=o;if(l){const d=v(a.columns).find(h=>h.property===l);d&&(d.order=c,i.store.updateSort(d,l,c),i.store.commit("changeSortCondition",{init:u}))}},changeSortCondition(a,o){const{sortingColumn:l,sortProp:c,sortOrder:u}=a,d=v(l),h=v(c),p=v(u);p===null&&(a.sortingColumn.value=null,a.sortProp.value=null);const m={filter:!0};i.store.execQuery(m),(!o||!(o.silent||o.init))&&i.emit("sort-change",{column:d,prop:h,order:p}),i.store.updateTableScrollY()},filterChange(a,o){const{column:l,values:c,silent:u}=o,d=i.store.updateFilters(l,c);i.store.execQuery(),u||i.emit("filter-change",d),i.store.updateTableScrollY()},toggleAllSelection(){i.store.toggleAllSelection()},rowSelectedChanged(a,o){i.store.toggleRowSelection(o),i.store.updateAllSelected()},setHoverRow(a,o){a.hoverRow.value=o},setCurrentRow(a,o){i.store.updateCurrentRow(o)}},commit:function(a,...o){const l=i.store.mutations;if(l[a])l[a].apply(i,[i.store.states].concat(o));else throw new Error(`Action not found: ${a}`)},updateTableScrollY:function(){ut(()=>i.layout.updateScrollY.apply(i.layout))}}}const _E={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data",["treeProps.hasChildren"]:{key:"lazyColumnIdentifier",default:"hasChildren"},["treeProps.children"]:{key:"childrenColumnName",default:"children"}};function Lje(i,e){if(!i)throw new Error("Table is required.");const t=$je();return t.toggleAllSelection=Zl(t._toggleAllSelection,10),Object.keys(_E).forEach(n=>{Tce(Sce(e,n),n,t)}),Dje(t,e),t}function Dje(i,e){Object.keys(_E).forEach(t=>{Ve(()=>Sce(e,t),n=>{Tce(n,t,i)})})}function Tce(i,e,t){let n=i,r=_E[e];typeof _E[e]=="object"&&(r=r.key,n=n||_E[e].default),t.states[r].value=n}function Sce(i,e){if(e.includes(".")){const t=e.split(".");let n=i;return t.forEach(r=>{n=n[r]}),n}else return i[e]}class kje{constructor(e){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=W(null),this.scrollX=W(!1),this.scrollY=W(!1),this.bodyWidth=W(null),this.fixedWidth=W(null),this.rightFixedWidth=W(null),this.gutterWidth=0;for(const t in e)Ci(e,t)&&(Vn(this[t])?this[t].value=e[t]:this[t]=e[t]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const t=this.table.refs.scrollBarRef;if(this.table.vnode.el&&t){let n=!0;const r=this.scrollY.value;return n=t.wrapRef.scrollHeight>t.wrapRef.clientHeight,this.scrollY.value=n,r!==n}return!1}setHeight(e,t="height"){if(!Ii)return;const n=this.table.vnode.el;if(e=Tje(e),this.height.value=Number(e),!n&&(e||e===0))return ut(()=>this.setHeight(e,t));typeof e=="number"?(n.style[t]=`${e}px`,this.updateElsHeight()):typeof e=="string"&&(n.style[t]=e,this.updateElsHeight())}setMaxHeight(e){this.setHeight(e,"max-height")}getFlattenColumns(){const e=[];return this.table.store.states.columns.value.forEach(n=>{n.isColumnGroup?e.push.apply(e,n.columns):e.push(n)}),e}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(e){if(!e)return!0;let t=e;for(;t.tagName!=="DIV";){if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}updateColumnsWidth(){if(!Ii)return;const e=this.fit,t=this.table.vnode.el.clientWidth;let n=0;const r=this.getFlattenColumns(),s=r.filter(l=>typeof l.width!="number");if(r.forEach(l=>{typeof l.width=="number"&&l.realWidth&&(l.realWidth=null)}),s.length>0&&e){if(r.forEach(l=>{n+=Number(l.width||l.minWidth||80)}),n<=t){this.scrollX.value=!1;const l=t-n;if(s.length===1)s[0].realWidth=Number(s[0].minWidth||80)+l;else{const c=s.reduce((h,p)=>h+Number(p.minWidth||80),0),u=l/c;let d=0;s.forEach((h,p)=>{if(p===0)return;const m=Math.floor(Number(h.minWidth||80)*u);d+=m,h.realWidth=Number(h.minWidth||80)+m}),s[0].realWidth=Number(s[0].minWidth||80)+l-d}}else this.scrollX.value=!0,s.forEach(l=>{l.realWidth=Number(l.minWidth)});this.bodyWidth.value=Math.max(n,t),this.table.state.resizeState.value.width=this.bodyWidth.value}else r.forEach(l=>{!l.width&&!l.minWidth?l.realWidth=80:l.realWidth=Number(l.width||l.minWidth),n+=l.realWidth}),this.scrollX.value=n>t,this.bodyWidth.value=n;const a=this.store.states.fixedColumns.value;if(a.length>0){let l=0;a.forEach(c=>{l+=Number(c.realWidth||c.width)}),this.fixedWidth.value=l}const o=this.store.states.rightFixedColumns.value;if(o.length>0){let l=0;o.forEach(c=>{l+=Number(c.realWidth||c.width)}),this.rightFixedWidth.value=l}this.notifyObservers("columns")}addObserver(e){this.observers.push(e)}removeObserver(e){const t=this.observers.indexOf(e);t!==-1&&this.observers.splice(t,1)}notifyObservers(e){this.observers.forEach(n=>{var r,s;switch(e){case"columns":(r=n.state)==null||r.onColumnsChange(this);break;case"scrollable":(s=n.state)==null||s.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${e}.`)}})}}const{CheckboxGroup:Fje}=Pd,Nje=de({name:"ElTableFilterPanel",components:{ElCheckbox:Pd,ElCheckboxGroup:Fje,ElScrollbar:_g,ElTooltip:Jl,ElIcon:ct,ArrowDown:Fy,ArrowUp:A3},directives:{ClickOutside:My},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function}},setup(i){const e=ti(),{t}=Ki(),n=Ne("table-filter"),r=e==null?void 0:e.parent;r.filterPanels.value[i.column.id]||(r.filterPanels.value[i.column.id]=e);const s=W(!1),a=W(null),o=R(()=>i.column&&i.column.filters),l=R({get:()=>{var C;return(((C=i.column)==null?void 0:C.filteredValue)||[])[0]},set:C=>{c.value&&(typeof C<"u"&&C!==null?c.value.splice(0,1,C):c.value.splice(0,1))}}),c=R({get(){return i.column?i.column.filteredValue||[]:[]},set(C){i.column&&i.upDataColumn("filteredValue",C)}}),u=R(()=>i.column?i.column.filterMultiple:!0),d=C=>C.value===l.value,h=()=>{s.value=!1},p=C=>{C.stopPropagation(),s.value=!s.value},m=()=>{s.value=!1},g=()=>{x(c.value),h()},_=()=>{c.value=[],x(c.value),h()},b=C=>{l.value=C,x(typeof C<"u"&&C!==null?c.value:[]),h()},x=C=>{i.store.commit("filterChange",{column:i.column,values:C}),i.store.updateAllSelected()};Ve(s,C=>{i.column&&i.upDataColumn("filterOpened",C)},{immediate:!0});const w=R(()=>{var C,S;return(S=(C=a.value)==null?void 0:C.popperRef)==null?void 0:S.contentRef});return{tooltipVisible:s,multiple:u,filteredValue:c,filterValue:l,filters:o,handleConfirm:g,handleReset:_,handleSelect:b,isActive:d,t,ns:n,showFilterPanel:p,hideFilterPanel:m,popperPaneRef:w,tooltip:a}}}),Vje={key:0},Bje=["disabled"],zje=["label","onClick"];function Uje(i,e,t,n,r,s){const a=jt("el-checkbox"),o=jt("el-checkbox-group"),l=jt("el-scrollbar"),c=jt("arrow-up"),u=jt("arrow-down"),d=jt("el-icon"),h=jt("el-tooltip"),p=R2("click-outside");return I(),Se(h,{ref:"tooltip",visible:i.tooltipVisible,offset:0,placement:i.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":i.ns.b(),persistent:""},{content:pe(()=>[i.multiple?(I(),Z("div",Vje,[Q("div",{class:N(i.ns.e("content"))},[re(l,{"wrap-class":i.ns.e("wrap")},{default:pe(()=>[re(o,{modelValue:i.filteredValue,"onUpdate:modelValue":e[0]||(e[0]=m=>i.filteredValue=m),class:N(i.ns.e("checkbox-group"))},{default:pe(()=>[(I(!0),Z(gt,null,xi(i.filters,m=>(I(),Se(a,{key:m.value,label:m.value},{default:pe(()=>[Gi(We(m.text),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["wrap-class"])],2),Q("div",{class:N(i.ns.e("bottom"))},[Q("button",{class:N({[i.ns.is("disabled")]:i.filteredValue.length===0}),disabled:i.filteredValue.length===0,type:"button",onClick:e[1]||(e[1]=(...m)=>i.handleConfirm&&i.handleConfirm(...m))},We(i.t("el.table.confirmFilter")),11,Bje),Q("button",{type:"button",onClick:e[2]||(e[2]=(...m)=>i.handleReset&&i.handleReset(...m))},We(i.t("el.table.resetFilter")),1)],2)])):(I(),Z("ul",{key:1,class:N(i.ns.e("list"))},[Q("li",{class:N([i.ns.e("list-item"),{[i.ns.is("active")]:i.filterValue===void 0||i.filterValue===null}]),onClick:e[3]||(e[3]=m=>i.handleSelect(null))},We(i.t("el.table.clearFilter")),3),(I(!0),Z(gt,null,xi(i.filters,m=>(I(),Z("li",{key:m.value,class:N([i.ns.e("list-item"),i.ns.is("active",i.isActive(m))]),label:m.value,onClick:g=>i.handleSelect(m.value)},We(m.text),11,zje))),128))],2))]),default:pe(()=>[zt((I(),Z("span",{class:N([`${i.ns.namespace.value}-table__column-filter-trigger`,`${i.ns.namespace.value}-none-outline`]),onClick:e[4]||(e[4]=(...m)=>i.showFilterPanel&&i.showFilterPanel(...m))},[re(d,null,{default:pe(()=>[i.column.filterOpened?(I(),Se(c,{key:0})):(I(),Se(u,{key:1}))]),_:1})],2)),[[p,i.hideFilterPanel,i.popperPaneRef]])]),_:1},8,["visible","placement","popper-class"])}var Hje=qe(Nje,[["render",Uje],["__file","/home/runner/work/element-plus/element-plus/packages/components/table/src/filter-panel.vue"]]);function Ece(i){const e=ti();m3(()=>{t.value.addObserver(e)}),qt(()=>{n(t.value),r(t.value)}),pg(()=>{n(t.value),r(t.value)}),ky(()=>{t.value.removeObserver(e)});const t=R(()=>{const s=i.layout;if(!s)throw new Error("Can not find table layout.");return s}),n=s=>{var a;const o=((a=i.vnode.el)==null?void 0:a.querySelectorAll("colgroup > col"))||[];if(!o.length)return;const l=s.getFlattenColumns(),c={};l.forEach(u=>{c[u.id]=u});for(let u=0,d=o.length;u<d;u++){const h=o[u],p=h.getAttribute("name"),m=c[p];m&&h.setAttribute("width",m.realWidth||m.width)}},r=s=>{var a,o;const l=((a=i.vnode.el)==null?void 0:a.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let u=0,d=l.length;u<d;u++)l[u].setAttribute("width",s.scrollY.value?s.gutterWidth:"0");const c=((o=i.vnode.el)==null?void 0:o.querySelectorAll("th.gutter"))||[];for(let u=0,d=c.length;u<d;u++){const h=c[u];h.style.width=s.scrollY.value?`${s.gutterWidth}px`:"0",h.style.display=s.scrollY.value?"":"none"}};return{tableLayout:t.value,onColumnsChange:n,onScrollableChange:r}}const _f=Symbol("ElTable");function Gje(i,e){const t=ti(),n=ht(_f),r=g=>{g.stopPropagation()},s=(g,_)=>{!_.filters&&_.sortable?m(g,_,!1):_.filterable&&!_.sortable&&r(g),n==null||n.emit("header-click",_,g)},a=(g,_)=>{n==null||n.emit("header-contextmenu",_,g)},o=W(null),l=W(!1),c=W({}),u=(g,_)=>{if(Ii&&!(_.children&&_.children.length>0)&&o.value&&i.border){l.value=!0;const b=n;e("set-drag-visible",!0);const w=(b==null?void 0:b.vnode.el).getBoundingClientRect().left,C=t.vnode.el.querySelector(`th.${_.id}`),S=C.getBoundingClientRect(),E=S.left-w+30;kp(C,"noclick"),c.value={startMouseLeft:g.clientX,startLeft:S.right-w,startColumnLeft:S.left-w,tableLeft:w};const A=b==null?void 0:b.refs.resizeProxy;A.style.left=`${c.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const P=M=>{const V=M.clientX-c.value.startMouseLeft,L=c.value.startLeft+V;A.style.left=`${Math.max(E,L)}px`},O=()=>{if(l.value){const{startColumnLeft:M,startLeft:V}=c.value,U=Number.parseInt(A.style.left,10)-M;_.width=_.realWidth=U,b==null||b.emit("header-dragend",_.width,V-M,_,g),requestAnimationFrame(()=>{i.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",l.value=!1,o.value=null,c.value={},e("set-drag-visible",!1)}document.removeEventListener("mousemove",P),document.removeEventListener("mouseup",O),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{Lc(C,"noclick")},0)};document.addEventListener("mousemove",P),document.addEventListener("mouseup",O)}},d=(g,_)=>{var b;if(_.children&&_.children.length>0)return;const x=(b=g.target)==null?void 0:b.closest("th");if(!(!_||!_.resizable)&&!l.value&&i.border){const w=x.getBoundingClientRect(),C=document.body.style;w.width>12&&w.right-g.pageX<8?(C.cursor="col-resize",Th(x,"is-sortable")&&(x.style.cursor="col-resize"),o.value=_):l.value||(C.cursor="",Th(x,"is-sortable")&&(x.style.cursor="pointer"),o.value=null)}},h=()=>{Ii&&(document.body.style.cursor="")},p=({order:g,sortOrders:_})=>{if(g==="")return _[0];const b=_.indexOf(g||null);return _[b>_.length-2?0:b+1]},m=(g,_,b)=>{var x;g.stopPropagation();const w=_.order===b?null:b||p(_),C=(x=g.target)==null?void 0:x.closest("th");if(C&&Th(C,"noclick")){Lc(C,"noclick");return}if(!_.sortable)return;const S=i.store.states;let E=S.sortProp.value,A;const P=S.sortingColumn.value;(P!==_||P===_&&P.order===null)&&(P&&(P.order=null),S.sortingColumn.value=_,E=_.property),w?A=_.order=w:A=_.order=null,S.sortProp.value=E,S.sortOrder.value=A,n==null||n.store.commit("changeSortCondition")};return{handleHeaderClick:s,handleHeaderContextMenu:a,handleMouseDown:u,handleMouseMove:d,handleMouseOut:h,handleSortClick:m,handleFilterClick:r}}function Wje(i){const e=ht(_f),t=Ne("table");return{getHeaderRowStyle:o=>{const l=e==null?void 0:e.props.headerRowStyle;return typeof l=="function"?l.call(null,{rowIndex:o}):l},getHeaderRowClass:o=>{const l=[],c=e==null?void 0:e.props.headerRowClassName;return typeof c=="string"?l.push(c):typeof c=="function"&&l.push(c.call(null,{rowIndex:o})),l.join(" ")},getHeaderCellStyle:(o,l,c,u)=>{var d;let h=(d=e==null?void 0:e.props.headerCellStyle)!=null?d:{};typeof h=="function"&&(h=h.call(null,{rowIndex:o,columnIndex:l,row:c,column:u}));const p=j9(l,u.fixed,i.store,c);return hC(p,"left"),hC(p,"right"),Object.assign({},h,p)},getHeaderCellClass:(o,l,c,u)=>{const d=W9(t.b(),l,u.fixed,i.store,c),h=[u.id,u.order,u.headerAlign,u.className,u.labelClassName,...d];u.children||h.push("is-leaf"),u.sortable&&h.push("is-sortable");const p=e==null?void 0:e.props.headerCellClassName;return typeof p=="string"?h.push(p):typeof p=="function"&&h.push(p.call(null,{rowIndex:o,columnIndex:l,row:c,column:u})),h.push(t.e("cell")),h.filter(m=>Boolean(m)).join(" ")}}}const Ace=i=>{const e=[];return i.forEach(t=>{t.children?(e.push(t),e.push.apply(e,Ace(t.children))):e.push(t)}),e},jje=i=>{let e=1;const t=(s,a)=>{if(a&&(s.level=a.level+1,e<s.level&&(e=s.level)),s.children){let o=0;s.children.forEach(l=>{t(l,s),o+=l.colSpan}),s.colSpan=o}else s.colSpan=1};i.forEach(s=>{s.level=1,t(s,void 0)});const n=[];for(let s=0;s<e;s++)n.push([]);return Ace(i).forEach(s=>{s.children?(s.rowSpan=1,s.children.forEach(a=>a.isSubColumn=!0)):s.rowSpan=e-s.level+1,n[s.level-1].push(s)}),n};function qje(i){const e=ht(_f),t=R(()=>jje(i.store.states.originColumns.value));return{isGroup:R(()=>{const s=t.value.length>1;return s&&e&&(e.state.isGroup.value=!0),s}),toggleAllSelection:s=>{s.stopPropagation(),e==null||e.store.commit("toggleAllSelection")},columnRows:t}}var Kje=de({name:"ElTableHeader",components:{ElCheckbox:Pd},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(i,{emit:e}){const t=ti(),n=ht(_f),r=Ne("table"),s=W({}),{onColumnsChange:a,onScrollableChange:o}=Ece(n);qt(async()=>{await ut(),await ut();const{prop:E,order:A}=i.defaultSort;n==null||n.store.commit("sort",{prop:E,order:A,init:!0})});const{handleHeaderClick:l,handleHeaderContextMenu:c,handleMouseDown:u,handleMouseMove:d,handleMouseOut:h,handleSortClick:p,handleFilterClick:m}=Gje(i,e),{getHeaderRowStyle:g,getHeaderRowClass:_,getHeaderCellStyle:b,getHeaderCellClass:x}=Wje(i),{isGroup:w,toggleAllSelection:C,columnRows:S}=qje(i);return t.state={onColumnsChange:a,onScrollableChange:o},t.filterPanels=s,{ns:r,filterPanels:s,onColumnsChange:a,onScrollableChange:o,columnRows:S,getHeaderRowClass:_,getHeaderRowStyle:g,getHeaderCellClass:x,getHeaderCellStyle:b,handleHeaderClick:l,handleHeaderContextMenu:c,handleMouseDown:u,handleMouseMove:d,handleMouseOut:h,handleSortClick:p,handleFilterClick:m,isGroup:w,toggleAllSelection:C}},render(){const{ns:i,isGroup:e,columnRows:t,getHeaderCellStyle:n,getHeaderCellClass:r,getHeaderRowClass:s,getHeaderRowStyle:a,handleHeaderClick:o,handleHeaderContextMenu:l,handleMouseDown:c,handleMouseMove:u,handleSortClick:d,handleMouseOut:h,store:p,$parent:m}=this;let g=1;return bt("thead",{class:{[i.is("group")]:e}},t.map((_,b)=>bt("tr",{class:s(b),key:b,style:a(b)},_.map((x,w)=>(x.rowSpan>g&&(g=x.rowSpan),bt("th",{class:r(b,w,_,x),colspan:x.colSpan,key:`${x.id}-thead`,rowspan:x.rowSpan,style:n(b,w,_,x),onClick:C=>o(C,x),onContextmenu:C=>l(C,x),onMousedown:C=>c(C,x),onMousemove:C=>u(C,x),onMouseout:h},[bt("div",{class:["cell",x.filteredValue&&x.filteredValue.length>0?"highlight":""]},[x.renderHeader?x.renderHeader({column:x,$index:w,store:p,_self:m}):x.label,x.sortable&&bt("span",{onClick:C=>d(C,x),class:"caret-wrapper"},[bt("i",{onClick:C=>d(C,x,"ascending"),class:"sort-caret ascending"}),bt("i",{onClick:C=>d(C,x,"descending"),class:"sort-caret descending"})]),x.filterable&&bt(Hje,{store:p,placement:x.filterPlacement||"bottom-start",column:x,upDataColumn:(C,S)=>{x[C]=S}})])]))))))}});function Yje(i){const e=ht(_f),t=W(""),n=W(bt("div")),r=(h,p,m)=>{var g;const _=e,b=Lk(h);let x;const w=(g=_==null?void 0:_.vnode.el)==null?void 0:g.dataset.prefix;b&&(x=CK({columns:i.store.states.columns.value},b,w),x&&(_==null||_.emit(`cell-${m}`,p,x,b,h))),_==null||_.emit(`row-${m}`,p,x,h)},s=(h,p)=>{r(h,p,"dblclick")},a=(h,p)=>{i.store.commit("setCurrentRow",p),r(h,p,"click")},o=(h,p)=>{r(h,p,"contextmenu")},l=Zl(h=>{i.store.commit("setHoverRow",h)},30),c=Zl(()=>{i.store.commit("setHoverRow",null)},30);return{handleDoubleClick:s,handleClick:a,handleContextMenu:o,handleMouseEnter:l,handleMouseLeave:c,handleCellMouseEnter:(h,p,m)=>{var g;const _=e,b=Lk(h),x=(g=_==null?void 0:_.vnode.el)==null?void 0:g.dataset.prefix;if(b){const A=CK({columns:i.store.states.columns.value},b,x),P=_.hoverState={cell:b,column:A,row:p};_==null||_.emit("cell-mouse-enter",P.row,P.column,P.cell,h)}if(!m)return;const w=h.target.querySelector(".cell");if(!(Th(w,`${x}-tooltip`)&&w.childNodes.length))return;const C=document.createRange();C.setStart(w,0),C.setEnd(w,w.childNodes.length);const S=Math.round(C.getBoundingClientRect().width),E=(Number.parseInt(Cm(w,"paddingLeft"),10)||0)+(Number.parseInt(Cm(w,"paddingRight"),10)||0);(S+E>w.offsetWidth||w.scrollWidth>w.offsetWidth)&&Aje(e==null?void 0:e.refs.tableWrapper,b,b.innerText||b.textContent,m)},handleCellMouseLeave:h=>{if(!Lk(h))return;const m=e==null?void 0:e.hoverState;e==null||e.emit("cell-mouse-leave",m==null?void 0:m.row,m==null?void 0:m.column,m==null?void 0:m.cell,h)},tooltipContent:t,tooltipTrigger:n}}function Xje(i){const e=ht(_f),t=Ne("table");return{getRowStyle:(c,u)=>{const d=e==null?void 0:e.props.rowStyle;return typeof d=="function"?d.call(null,{row:c,rowIndex:u}):d||null},getRowClass:(c,u)=>{const d=[t.e("row")];e!=null&&e.props.highlightCurrentRow&&c===i.store.states.currentRow.value&&d.push("current-row"),i.stripe&&u%2===1&&d.push(t.em("row","striped"));const h=e==null?void 0:e.props.rowClassName;return typeof h=="string"?d.push(h):typeof h=="function"&&d.push(h.call(null,{row:c,rowIndex:u})),d},getCellStyle:(c,u,d,h)=>{const p=e==null?void 0:e.props.cellStyle;let m=p??{};typeof p=="function"&&(m=p.call(null,{rowIndex:c,columnIndex:u,row:d,column:h}));const g=j9(u,i==null?void 0:i.fixed,i.store);return hC(g,"left"),hC(g,"right"),Object.assign({},m,g)},getCellClass:(c,u,d,h,p)=>{const m=W9(t.b(),u,i==null?void 0:i.fixed,i.store,void 0,p),g=[h.id,h.align,h.className,...m],_=e==null?void 0:e.props.cellClassName;return typeof _=="string"?g.push(_):typeof _=="function"&&g.push(_.call(null,{rowIndex:c,columnIndex:u,row:d,column:h})),g.push(t.e("cell")),g.filter(b=>Boolean(b)).join(" ")},getSpan:(c,u,d,h)=>{let p=1,m=1;const g=e==null?void 0:e.props.spanMethod;if(typeof g=="function"){const _=g({row:c,column:u,rowIndex:d,columnIndex:h});Array.isArray(_)?(p=_[0],m=_[1]):typeof _=="object"&&(p=_.rowspan,m=_.colspan)}return{rowspan:p,colspan:m}},getColspanRealWidth:(c,u,d)=>{if(u<1)return c[d].realWidth;const h=c.map(({realWidth:p,width:m})=>p||m).slice(d,d+u);return Number(h.reduce((p,m)=>Number(p)+Number(m),-1))}}}function Zje(i){const e=ht(_f),t=Ne("table"),{handleDoubleClick:n,handleClick:r,handleContextMenu:s,handleMouseEnter:a,handleMouseLeave:o,handleCellMouseEnter:l,handleCellMouseLeave:c,tooltipContent:u,tooltipTrigger:d}=Yje(i),{getRowStyle:h,getRowClass:p,getCellStyle:m,getCellClass:g,getSpan:_,getColspanRealWidth:b}=Xje(i),x=R(()=>i.store.states.columns.value.findIndex(({type:A})=>A==="default")),w=(A,P)=>{const O=e.props.rowKey;return O?Oo(A,O):P},C=(A,P,O,M=!1)=>{const{tooltipEffect:V,tooltipOptions:L,store:U}=i,{indent:G,columns:H}=U.states,k=p(A,P);let D=!0;return O&&(k.push(t.em("row",`level-${O.level}`)),D=O.display),bt("tr",{style:[D?null:{display:"none"},h(A,P)],class:k,key:w(A,P),onDblclick:F=>n(F,A),onClick:F=>r(F,A),onContextmenu:F=>s(F,A),onMouseenter:()=>a(P),onMouseleave:o},H.value.map((F,Y)=>{const{rowspan:ne,colspan:X}=_(A,F,P,Y);if(!ne||!X)return null;const J={...F};J.realWidth=b(H.value,X,Y);const he={store:i.store,_self:i.context||e,column:J,row:A,$index:P,cellIndex:Y,expanded:M};Y===x.value&&O&&(he.treeNode={indent:O.level*G.value,level:O.level},typeof O.expanded=="boolean"&&(he.treeNode.expanded=O.expanded,"loading"in O&&(he.treeNode.loading=O.loading),"noLazyChildren"in O&&(he.treeNode.noLazyChildren=O.noLazyChildren)));const ye=`${P},${Y}`,Te=J.columnKey||J.rawColumnKey||"",ce=S(Y,F,he),ae=F.showOverflowTooltip&&uae({effect:V},L,F.showOverflowTooltip);return bt("td",{style:m(P,Y,A,F),class:g(P,Y,A,F,X-1),key:`${Te}${ye}`,rowspan:ne,colspan:X,onMouseenter:le=>l(le,A,ae),onMouseleave:c},[ce])}))},S=(A,P,O)=>P.renderCell(O);return{wrappedRowRender:(A,P)=>{const O=i.store,{isRowExpanded:M,assertRowKey:V}=O,{treeData:L,lazyTreeNodeMap:U,childrenColumnName:G,rowKey:H}=O.states,k=O.states.columns.value;if(k.some(({type:$})=>$==="expand")){const $=M(A),F=C(A,P,void 0,$),Y=e.renderExpanded;return $?Y?[[F,bt("tr",{key:`expanded-row__${F.key}`},[bt("td",{colspan:k.length,class:`${t.e("cell")} ${t.e("expanded-cell")}`},[Y({row:A,$index:P,store:O,expanded:$})])])]]:(console.error("[Element Error]renderExpanded is required."),F):[[F]]}else if(Object.keys(L.value).length){V();const $=Oo(A,H.value);let F=L.value[$],Y=null;F&&(Y={expanded:F.expanded,level:F.level,display:!0},typeof F.lazy=="boolean"&&(typeof F.loaded=="boolean"&&F.loaded&&(Y.noLazyChildren=!(F.children&&F.children.length)),Y.loading=F.loading));const ne=[C(A,P,Y)];if(F){let X=0;const J=(ye,Te)=>{ye&&ye.length&&Te&&ye.forEach(ce=>{const ae={display:Te.display&&Te.expanded,level:Te.level+1,expanded:!1,noLazyChildren:!1,loading:!1},le=Oo(ce,H.value);if(le==null)throw new Error("For nested data item, row-key is required.");if(F={...L.value[le]},F&&(ae.expanded=F.expanded,F.level=F.level||ae.level,F.display=!!(F.expanded&&ae.display),typeof F.lazy=="boolean"&&(typeof F.loaded=="boolean"&&F.loaded&&(ae.noLazyChildren=!(F.children&&F.children.length)),ae.loading=F.loading)),X++,ne.push(C(ce,P+X,ae)),F){const fe=U.value[le]||ce[G.value];J(fe,F)}})};F.display=!0;const he=U.value[$]||A[G.value];J(he,F)}return ne}else return C(A,P,void 0)},tooltipContent:u,tooltipTrigger:d}}const Qje={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var Jje=de({name:"ElTableBody",props:Qje,setup(i){const e=ti(),t=ht(_f),n=Ne("table"),{wrappedRowRender:r,tooltipContent:s,tooltipTrigger:a}=Zje(i),{onColumnsChange:o,onScrollableChange:l}=Ece(t);return Ve(i.store.states.hoverRow,(c,u)=>{if(!i.store.states.isComplex.value||!Ii)return;let d=window.requestAnimationFrame;d||(d=h=>window.setTimeout(h,16)),d(()=>{const h=e==null?void 0:e.vnode.el,p=Array.from((h==null?void 0:h.children)||[]).filter(_=>_==null?void 0:_.classList.contains(`${n.e("row")}`)),m=p[u],g=p[c];m&&Lc(m,"hover-row"),g&&kp(g,"hover-row")})}),ky(()=>{var c;(c=jf)==null||c()}),{ns:n,onColumnsChange:o,onScrollableChange:l,wrappedRowRender:r,tooltipContent:s,tooltipTrigger:a}},render(){const{wrappedRowRender:i,store:e}=this,t=e.states.data.value||[];return bt("tbody",{},[t.reduce((n,r)=>n.concat(i(r,n.length)),[])])}});function q9(i){const e=i.tableLayout==="auto";let t=i.columns||[];e&&t.every(r=>r.width===void 0)&&(t=[]);const n=r=>{const s={key:`${i.tableLayout}_${r.id}`,style:{},name:void 0};return e?s.style={width:`${r.width}px`}:s.name=r.id,s};return bt("colgroup",{},t.map(r=>bt("col",n(r))))}q9.props=["columns","tableLayout"];function eqe(){const i=ht(_f),e=i==null?void 0:i.store,t=R(()=>e.states.fixedLeafColumnsLength.value),n=R(()=>e.states.rightFixedColumns.value.length),r=R(()=>e.states.columns.value.length),s=R(()=>e.states.fixedColumns.value.length),a=R(()=>e.states.rightFixedColumns.value.length);return{leftFixedLeafCount:t,rightFixedLeafCount:n,columnsCount:r,leftFixedCount:s,rightFixedCount:a,columns:e.states.columns}}function tqe(i){const{columns:e}=eqe(),t=Ne("table");return{getCellClasses:(s,a)=>{const o=s[a],l=[t.e("cell"),o.id,o.align,o.labelClassName,...W9(t.b(),a,o.fixed,i.store)];return o.className&&l.push(o.className),o.children||l.push(t.is("leaf")),l},getCellStyles:(s,a)=>{const o=j9(a,s.fixed,i.store);return hC(o,"left"),hC(o,"right"),o},columns:e}}var iqe=de({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(i){const{getCellClasses:e,getCellStyles:t,columns:n}=tqe(i);return{ns:Ne("table"),getCellClasses:e,getCellStyles:t,columns:n}},render(){const{columns:i,getCellStyles:e,getCellClasses:t,summaryMethod:n,sumText:r,ns:s}=this,a=this.store.states.data.value;let o=[];return n?o=n({columns:i,data:a}):i.forEach((l,c)=>{if(c===0){o[c]=r;return}const u=a.map(m=>Number(m[l.property])),d=[];let h=!0;u.forEach(m=>{if(!Number.isNaN(+m)){h=!1;const g=`${m}`.split(".")[1];d.push(g?g.length:0)}});const p=Math.max.apply(null,d);h?o[c]="":o[c]=u.reduce((m,g)=>{const _=Number(g);return Number.isNaN(+_)?m:Number.parseFloat((m+g).toFixed(Math.min(p,20)))},0)}),bt("table",{class:s.e("footer"),cellspacing:"0",cellpadding:"0",border:"0"},[q9({columns:i}),bt("tbody",[bt("tr",{},[...i.map((l,c)=>bt("td",{key:c,colspan:l.colSpan,rowspan:l.rowSpan,class:t(i,c),style:e(l,c)},[bt("div",{class:["cell",l.labelClassName]},[o[c]])]))])])])}});function nqe(i){return{setCurrentRow:u=>{i.commit("setCurrentRow",u)},getSelectionRows:()=>i.getSelectionRows(),toggleRowSelection:(u,d)=>{i.toggleRowSelection(u,d,!1),i.updateAllSelected()},clearSelection:()=>{i.clearSelection()},clearFilter:u=>{i.clearFilter(u)},toggleAllSelection:()=>{i.commit("toggleAllSelection")},toggleRowExpansion:(u,d)=>{i.toggleRowExpansionAdapter(u,d)},clearSort:()=>{i.clearSort()},sort:(u,d)=>{i.commit("sort",{prop:u,order:d})}}}function rqe(i,e,t,n){const r=W(!1),s=W(null),a=W(!1),o=$=>{a.value=$},l=W({width:null,height:null,headerHeight:null}),c=W(!1),u={display:"inline-block",verticalAlign:"middle"},d=W(),h=W(0),p=W(0),m=W(0),g=W(0);Ru(()=>{e.setHeight(i.height)}),Ru(()=>{e.setMaxHeight(i.maxHeight)}),Ve(()=>[i.currentRowKey,t.states.rowKey],([$,F])=>{!v(F)||!v($)||t.setCurrentRowKey(`${$}`)},{immediate:!0}),Ve(()=>i.data,$=>{n.store.commit("setData",$)},{immediate:!0,deep:!0}),Ru(()=>{i.expandRowKeys&&t.setExpandRowKeysAdapter(i.expandRowKeys)});const _=()=>{n.store.commit("setHoverRow",null),n.hoverState&&(n.hoverState=null)},b=($,F)=>{const{pixelX:Y,pixelY:ne}=F;Math.abs(Y)>=Math.abs(ne)&&(n.refs.bodyWrapper.scrollLeft+=F.pixelX/5)},x=R(()=>i.height||i.maxHeight||t.states.fixedColumns.value.length>0||t.states.rightFixedColumns.value.length>0),w=R(()=>({width:e.bodyWidth.value?`${e.bodyWidth.value}px`:""})),C=()=>{x.value&&e.updateElsHeight(),e.updateColumnsWidth(),requestAnimationFrame(P)};qt(async()=>{await ut(),t.updateColumns(),O(),requestAnimationFrame(C);const $=n.vnode.el,F=n.refs.headerWrapper;i.flexible&&$&&$.parentElement&&($.parentElement.style.minWidth="0"),l.value={width:d.value=$.offsetWidth,height:$.offsetHeight,headerHeight:i.showHeader&&F?F.offsetHeight:null},t.states.columns.value.forEach(Y=>{Y.filteredValue&&Y.filteredValue.length&&n.store.commit("filterChange",{column:Y,values:Y.filteredValue,silent:!0})}),n.$ready=!0});const S=($,F)=>{if(!$)return;const Y=Array.from($.classList).filter(ne=>!ne.startsWith("is-scrolling-"));Y.push(e.scrollX.value?F:"is-scrolling-none"),$.className=Y.join(" ")},E=$=>{const{tableWrapper:F}=n.refs;S(F,$)},A=$=>{const{tableWrapper:F}=n.refs;return!!(F&&F.classList.contains($))},P=function(){if(!n.refs.scrollBarRef)return;if(!e.scrollX.value){const ye="is-scrolling-none";A(ye)||E(ye);return}const $=n.refs.scrollBarRef.wrapRef;if(!$)return;const{scrollLeft:F,offsetWidth:Y,scrollWidth:ne}=$,{headerWrapper:X,footerWrapper:J}=n.refs;X&&(X.scrollLeft=F),J&&(J.scrollLeft=F);const he=ne-Y-1;F>=he?E("is-scrolling-right"):E(F===0?"is-scrolling-left":"is-scrolling-middle")},O=()=>{n.refs.scrollBarRef&&(n.refs.scrollBarRef.wrapRef&&mr(n.refs.scrollBarRef.wrapRef,"scroll",P,{passive:!0}),i.fit?fl(n.vnode.el,M):mr(window,"resize",M),fl(n.refs.bodyWrapper,()=>{var $,F;M(),(F=($=n.refs)==null?void 0:$.scrollBarRef)==null||F.update()}))},M=()=>{var $,F,Y;const ne=n.vnode.el;if(!n.$ready||!ne)return;let X=!1;const{width:J,height:he,headerHeight:ye}=l.value,Te=d.value=ne.offsetWidth;J!==Te&&(X=!0);const ce=ne.offsetHeight;(i.height||x.value)&&he!==ce&&(X=!0);const ae=i.tableLayout==="fixed"?n.refs.headerWrapper:($=n.refs.tableHeaderRef)==null?void 0:$.$el;i.showHeader&&(ae==null?void 0:ae.offsetHeight)!==ye&&(X=!0),h.value=((F=n.refs.tableWrapper)==null?void 0:F.scrollHeight)||0,m.value=(ae==null?void 0:ae.scrollHeight)||0,g.value=((Y=n.refs.footerWrapper)==null?void 0:Y.offsetHeight)||0,p.value=h.value-m.value-g.value,X&&(l.value={width:Te,height:ce,headerHeight:i.showHeader&&(ae==null?void 0:ae.offsetHeight)||0},C())},V=Qs(),L=R(()=>{const{bodyWidth:$,scrollY:F,gutterWidth:Y}=e;return $.value?`${$.value-(F.value?Y:0)}px`:""}),U=R(()=>i.maxHeight?"fixed":i.tableLayout),G=R(()=>{if(i.data&&i.data.length)return null;let $="100%";i.height&&p.value&&($=`${p.value}px`);const F=d.value;return{width:F?`${F}px`:"",height:$}}),H=R(()=>i.height?{height:Number.isNaN(Number(i.height))?i.height:`${i.height}px`}:i.maxHeight?{maxHeight:Number.isNaN(Number(i.maxHeight))?i.maxHeight:`${i.maxHeight}px`}:{}),k=R(()=>{if(i.height)return{height:"100%"};if(i.maxHeight){if(Number.isNaN(Number(i.maxHeight)))return{maxHeight:`calc(${i.maxHeight} - ${m.value+g.value}px)`};{const $=i.maxHeight;if(h.value>=Number($))return{maxHeight:`${h.value-m.value-g.value}px`}}}return{}});return{isHidden:r,renderExpanded:s,setDragVisible:o,isGroup:c,handleMouseLeave:_,handleHeaderFooterMousewheel:b,tableSize:V,emptyBlockStyle:G,handleFixedMousewheel:($,F)=>{const Y=n.refs.bodyWrapper;if(Math.abs(F.spinY)>0){const ne=Y.scrollTop;F.pixelY<0&&ne!==0&&$.preventDefault(),F.pixelY>0&&Y.scrollHeight-Y.clientHeight>ne&&$.preventDefault(),Y.scrollTop+=Math.ceil(F.pixelY/5)}else Y.scrollLeft+=Math.ceil(F.pixelX/5)},resizeProxyVisible:a,bodyWidth:L,resizeState:l,doLayout:C,tableBodyStyles:w,tableLayout:U,scrollbarViewStyle:u,tableInnerStyle:H,scrollbarStyle:k}}var sqe={data:{type:Array,default:()=>[]},size:String,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:Boolean};const aqe=()=>{const i=W(),e=(s,a)=>{const o=i.value;o&&o.scrollTo(s,a)},t=(s,a)=>{const o=i.value;o&&It(a)&&["Top","Left"].includes(s)&&o[`setScroll${s}`](a)};return{scrollBarRef:i,scrollTo:e,setScrollTop:s=>t("Top",s),setScrollLeft:s=>t("Left",s)}};let oqe=1;const lqe=de({name:"ElTable",directives:{Mousewheel:hNe},components:{TableHeader:Kje,TableBody:Jje,TableFooter:iqe,ElScrollbar:_g,hColgroup:q9},props:sqe,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(i){const{t:e}=Ki(),t=Ne("table"),n=ti();pi(_f,n);const r=Lje(n,i);n.store=r;const s=new kje({store:n.store,table:n,fit:i.fit,showHeader:i.showHeader});n.layout=s;const a=R(()=>(r.states.data.value||[]).length===0),{setCurrentRow:o,getSelectionRows:l,toggleRowSelection:c,clearSelection:u,clearFilter:d,toggleAllSelection:h,toggleRowExpansion:p,clearSort:m,sort:g}=nqe(r),{isHidden:_,renderExpanded:b,setDragVisible:x,isGroup:w,handleMouseLeave:C,handleHeaderFooterMousewheel:S,tableSize:E,emptyBlockStyle:A,handleFixedMousewheel:P,resizeProxyVisible:O,bodyWidth:M,resizeState:V,doLayout:L,tableBodyStyles:U,tableLayout:G,scrollbarViewStyle:H,tableInnerStyle:k,scrollbarStyle:D}=rqe(i,s,r,n),{scrollBarRef:$,scrollTo:F,setScrollLeft:Y,setScrollTop:ne}=aqe(),X=Zl(L,50),J=`${t.namespace.value}-table_${oqe++}`;n.tableId=J,n.state={isGroup:w,resizeState:V,doLayout:L,debouncedUpdateLayout:X};const he=R(()=>i.sumText||e("el.table.sumText")),ye=R(()=>i.emptyText||e("el.table.emptyText"));return{ns:t,layout:s,store:r,handleHeaderFooterMousewheel:S,handleMouseLeave:C,tableId:J,tableSize:E,isHidden:_,isEmpty:a,renderExpanded:b,resizeProxyVisible:O,resizeState:V,isGroup:w,bodyWidth:M,tableBodyStyles:U,emptyBlockStyle:A,debouncedUpdateLayout:X,handleFixedMousewheel:P,setCurrentRow:o,getSelectionRows:l,toggleRowSelection:c,clearSelection:u,clearFilter:d,toggleAllSelection:h,toggleRowExpansion:p,clearSort:m,doLayout:L,sort:g,t:e,setDragVisible:x,context:n,computedSumText:he,computedEmptyText:ye,tableLayout:G,scrollbarViewStyle:H,tableInnerStyle:k,scrollbarStyle:D,scrollBarRef:$,scrollTo:F,setScrollLeft:Y,setScrollTop:ne}}}),cqe=["data-prefix"],uqe={ref:"hiddenColumns",class:"hidden-columns"};function dqe(i,e,t,n,r,s){const a=jt("hColgroup"),o=jt("table-header"),l=jt("table-body"),c=jt("el-scrollbar"),u=jt("table-footer"),d=R2("mousewheel");return I(),Z("div",{ref:"tableWrapper",class:N([{[i.ns.m("fit")]:i.fit,[i.ns.m("striped")]:i.stripe,[i.ns.m("border")]:i.border||i.isGroup,[i.ns.m("hidden")]:i.isHidden,[i.ns.m("group")]:i.isGroup,[i.ns.m("fluid-height")]:i.maxHeight,[i.ns.m("scrollable-x")]:i.layout.scrollX.value,[i.ns.m("scrollable-y")]:i.layout.scrollY.value,[i.ns.m("enable-row-hover")]:!i.store.states.isComplex.value,[i.ns.m("enable-row-transition")]:(i.store.states.data.value||[]).length!==0&&(i.store.states.data.value||[]).length<100,"has-footer":i.showSummary},i.ns.m(i.tableSize),i.className,i.ns.b(),i.ns.m(`layout-${i.tableLayout}`)]),style:pt(i.style),"data-prefix":i.ns.namespace.value,onMouseleave:e[0]||(e[0]=h=>i.handleMouseLeave())},[Q("div",{class:N(i.ns.e("inner-wrapper")),style:pt(i.tableInnerStyle)},[Q("div",uqe,[Fe(i.$slots,"default")],512),i.showHeader&&i.tableLayout==="fixed"?zt((I(),Z("div",{key:0,ref:"headerWrapper",class:N(i.ns.e("header-wrapper"))},[Q("table",{ref:"tableHeader",class:N(i.ns.e("header")),style:pt(i.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[re(a,{columns:i.store.states.columns.value,"table-layout":i.tableLayout},null,8,["columns","table-layout"]),re(o,{ref:"tableHeaderRef",border:i.border,"default-sort":i.defaultSort,store:i.store,onSetDragVisible:i.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])],6)],2)),[[d,i.handleHeaderFooterMousewheel]]):_e("v-if",!0),Q("div",{ref:"bodyWrapper",class:N(i.ns.e("body-wrapper"))},[re(c,{ref:"scrollBarRef","view-style":i.scrollbarViewStyle,"wrap-style":i.scrollbarStyle,always:i.scrollbarAlwaysOn},{default:pe(()=>[Q("table",{ref:"tableBody",class:N(i.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:pt({width:i.bodyWidth,tableLayout:i.tableLayout})},[re(a,{columns:i.store.states.columns.value,"table-layout":i.tableLayout},null,8,["columns","table-layout"]),i.showHeader&&i.tableLayout==="auto"?(I(),Se(o,{key:0,ref:"tableHeaderRef",border:i.border,"default-sort":i.defaultSort,store:i.store,onSetDragVisible:i.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])):_e("v-if",!0),re(l,{context:i.context,highlight:i.highlightCurrentRow,"row-class-name":i.rowClassName,"tooltip-effect":i.tooltipEffect,"tooltip-options":i.tooltipOptions,"row-style":i.rowStyle,store:i.store,stripe:i.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"])],6),i.isEmpty?(I(),Z("div",{key:0,ref:"emptyBlock",style:pt(i.emptyBlockStyle),class:N(i.ns.e("empty-block"))},[Q("span",{class:N(i.ns.e("empty-text"))},[Fe(i.$slots,"empty",{},()=>[Gi(We(i.computedEmptyText),1)])],2)],6)):_e("v-if",!0),i.$slots.append?(I(),Z("div",{key:1,ref:"appendWrapper",class:N(i.ns.e("append-wrapper"))},[Fe(i.$slots,"append")],2)):_e("v-if",!0)]),_:3},8,["view-style","wrap-style","always"])],2),i.showSummary?zt((I(),Z("div",{key:1,ref:"footerWrapper",class:N(i.ns.e("footer-wrapper"))},[re(u,{border:i.border,"default-sort":i.defaultSort,store:i.store,style:pt(i.tableBodyStyles),"sum-text":i.computedSumText,"summary-method":i.summaryMethod},null,8,["border","default-sort","store","style","sum-text","summary-method"])],2)),[[Ei,!i.isEmpty],[d,i.handleHeaderFooterMousewheel]]):_e("v-if",!0),i.border||i.isGroup?(I(),Z("div",{key:2,class:N(i.ns.e("border-left-patch"))},null,2)):_e("v-if",!0)],6),zt(Q("div",{ref:"resizeProxy",class:N(i.ns.e("column-resize-proxy"))},null,2),[[Ei,i.resizeProxyVisible]])],46,cqe)}var hqe=qe(lqe,[["render",dqe],["__file","/home/runner/work/element-plus/element-plus/packages/components/table/src/table.vue"]]);const pqe={selection:"table-column--selection",expand:"table__expand-column"},fqe={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},mqe=i=>pqe[i]||"",gqe={selection:{renderHeader({store:i}){function e(){return i.states.data.value&&i.states.data.value.length===0}return bt(Pd,{disabled:e(),size:i.states.tableSize.value,indeterminate:i.states.selection.value.length>0&&!i.states.isAllSelected.value,"onUpdate:modelValue":i.toggleAllSelection,modelValue:i.states.isAllSelected.value})},renderCell({row:i,column:e,store:t,$index:n}){return bt(Pd,{disabled:e.selectable?!e.selectable.call(null,i,n):!1,size:t.states.tableSize.value,onChange:()=>{t.commit("rowSelectedChanged",i)},onClick:r=>r.stopPropagation(),modelValue:t.isSelected(i)})},sortable:!1,resizable:!1},index:{renderHeader({column:i}){return i.label||"#"},renderCell({column:i,$index:e}){let t=e+1;const n=i.index;return typeof n=="number"?t=e+n:typeof n=="function"&&(t=n(e)),bt("div",{},[t])},sortable:!1},expand:{renderHeader({column:i}){return i.label||""},renderCell({row:i,store:e,expanded:t}){const{ns:n}=e,r=[n.e("expand-icon")];return t&&r.push(n.em("expand-icon","expanded")),bt("div",{class:r,onClick:function(a){a.stopPropagation(),e.toggleRowExpansion(i)}},{default:()=>[bt(ct,null,{default:()=>[bt(Wl)]})]})},sortable:!1,resizable:!1}};function vqe({row:i,column:e,$index:t}){var n;const r=e.property,s=r&&mR(i,r).value;return e&&e.formatter?e.formatter(i,e,s,t):((n=s==null?void 0:s.toString)==null?void 0:n.call(s))||""}function yqe({row:i,treeNode:e,store:t},n=!1){const{ns:r}=t;if(!e)return n?[bt("span",{class:r.e("placeholder")})]:null;const s=[],a=function(o){o.stopPropagation(),!e.loading&&t.loadOrToggle(i)};if(e.indent&&s.push(bt("span",{class:r.e("indent"),style:{"padding-left":`${e.indent}px`}})),typeof e.expanded=="boolean"&&!e.noLazyChildren){const o=[r.e("expand-icon"),e.expanded?r.em("expand-icon","expanded"):""];let l=Wl;e.loading&&(l=Vy),s.push(bt("div",{class:o,onClick:a},{default:()=>[bt(ct,{class:{[r.is("loading")]:e.loading}},{default:()=>[bt(l)]})]}))}else s.push(bt("span",{class:r.e("placeholder")}));return s}function EK(i,e){return i.reduce((t,n)=>(t[n]=n,t),e)}function _qe(i,e){const t=ti();return{registerComplexWatchers:()=>{const s=["fixed"],a={realWidth:"width",realMinWidth:"minWidth"},o=EK(s,a);Object.keys(o).forEach(l=>{const c=a[l];Ci(e,c)&&Ve(()=>e[c],u=>{let d=u;c==="width"&&l==="realWidth"&&(d=G9(u)),c==="minWidth"&&l==="realMinWidth"&&(d=bce(u)),t.columnConfig.value[c]=d,t.columnConfig.value[l]=d;const h=c==="fixed";i.value.store.scheduleLayout(h)})})},registerNormalWatchers:()=>{const s=["label","filters","filterMultiple","sortable","index","formatter","className","labelClassName","showOverflowTooltip"],a={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},o=EK(s,a);Object.keys(o).forEach(l=>{const c=a[l];Ci(e,c)&&Ve(()=>e[c],u=>{t.columnConfig.value[l]=u})})}}}function bqe(i,e,t){const n=ti(),r=W(""),s=W(!1),a=W(),o=W(),l=Ne("table");Ru(()=>{a.value=i.align?`is-${i.align}`:null,a.value}),Ru(()=>{o.value=i.headerAlign?`is-${i.headerAlign}`:a.value,o.value});const c=R(()=>{let w=n.vnode.vParent||n.parent;for(;w&&!w.tableId&&!w.columnId;)w=w.vnode.vParent||w.parent;return w}),u=R(()=>{const{store:w}=n.parent;if(!w)return!1;const{treeData:C}=w.states,S=C.value;return S&&Object.keys(S).length>0}),d=W(G9(i.width)),h=W(bce(i.minWidth)),p=w=>(d.value&&(w.width=d.value),h.value&&(w.minWidth=h.value),!d.value&&h.value&&(w.width=void 0),w.minWidth||(w.minWidth=80),w.realWidth=Number(w.width===void 0?w.minWidth:w.width),w),m=w=>{const C=w.type,S=gqe[C]||{};Object.keys(S).forEach(A=>{const P=S[A];A!=="className"&&P!==void 0&&(w[A]=P)});const E=mqe(C);if(E){const A=`${v(l.namespace)}-${E}`;w.className=w.className?`${w.className} ${A}`:A}return w},g=w=>{Array.isArray(w)?w.forEach(S=>C(S)):C(w);function C(S){var E;((E=S==null?void 0:S.type)==null?void 0:E.name)==="ElTableColumn"&&(S.vParent=n)}};return{columnId:r,realAlign:a,isSubColumn:s,realHeaderAlign:o,columnOrTableParent:c,setColumnWidth:p,setColumnForcedProps:m,setColumnRenders:w=>{i.renderHeader||w.type!=="selection"&&(w.renderHeader=S=>{n.columnConfig.value.label;const E=e.header;return E?E(S):w.label});let C=w.renderCell;return w.type==="expand"?(w.renderCell=S=>bt("div",{class:"cell"},[C(S)]),t.value.renderExpanded=S=>e.default?e.default(S):e.default):(C=C||vqe,w.renderCell=S=>{let E=null;if(e.default){const M=e.default(S);E=M.some(V=>V.type!==Gl)?M:C(S)}else E=C(S);const A=u.value&&S.cellIndex===0&&S.column.type!=="selection",P=yqe(S,A),O={class:"cell",style:{}};return w.showOverflowTooltip&&(O.class=`${O.class} ${v(l.namespace)}-tooltip`,O.style={width:`${(S.column.realWidth||Number(S.column.width))-1}px`}),g(E),bt("div",O,[P,E])}),w},getPropsData:(...w)=>w.reduce((C,S)=>(Array.isArray(S)&&S.forEach(E=>{C[E]=i[E]}),C),{}),getColumnElIndex:(w,C)=>Array.prototype.indexOf.call(w,C)}}var wqe={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:[Boolean,Object],fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:i=>i.every(e=>["ascending","descending",null].includes(e))}};let xqe=1;var Mce=de({name:"ElTableColumn",components:{ElCheckbox:Pd},props:wqe,setup(i,{slots:e}){const t=ti(),n=W({}),r=R(()=>{let x=t.parent;for(;x&&!x.tableId;)x=x.parent;return x}),{registerNormalWatchers:s,registerComplexWatchers:a}=_qe(r,i),{columnId:o,isSubColumn:l,realHeaderAlign:c,columnOrTableParent:u,setColumnWidth:d,setColumnForcedProps:h,setColumnRenders:p,getPropsData:m,getColumnElIndex:g,realAlign:_}=bqe(i,e,r),b=u.value;o.value=`${b.tableId||b.columnId}_column_${xqe++}`,m3(()=>{l.value=r.value!==b;const x=i.type||"default",w=i.sortable===""?!0:i.sortable,C={...fqe[x],id:o.value,type:x,property:i.prop||i.property,align:_,headerAlign:c,showOverflowTooltip:i.showOverflowTooltip,filterable:i.filters||i.filterMethod,filteredValue:[],filterPlacement:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:w,index:i.index,rawColumnKey:t.vnode.key};let O=m(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement"]);O=Cje(C,O),O=Sje(p,d,h)(O),n.value=O,s(),a()}),qt(()=>{var x;const w=u.value,C=l.value?w.vnode.el.children:(x=w.refs.hiddenColumns)==null?void 0:x.children,S=()=>g(C||[],t.vnode.el);n.value.getColumnIndex=S,S()>-1&&r.value.store.commit("insertColumn",n.value,l.value?w.columnConfig.value:null)}),Vr(()=>{r.value.store.commit("removeColumn",n.value,l.value?b.columnConfig.value:null)}),t.columnId=o.value,t.columnConfig=n},render(){var i,e,t;try{const n=(e=(i=this.$slots).default)==null?void 0:e.call(i,{row:{},column:{},$index:-1}),r=[];if(Array.isArray(n))for(const a of n)((t=a.type)==null?void 0:t.name)==="ElTableColumn"||a.shapeFlag&2?r.push(a):a.type===gt&&Array.isArray(a.children)&&a.children.forEach(o=>{(o==null?void 0:o.patchFlag)!==1024&&!Ft(o==null?void 0:o.children)&&r.push(o)});return bt("div",r)}catch{return bt("div",[])}}});const Cqe=ii(hqe,{TableColumn:Mce}),Tqe=Wr(Mce);var iA=(i=>(i.ASC="asc",i.DESC="desc",i))(iA||{}),nA=(i=>(i.CENTER="center",i.RIGHT="right",i))(nA||{}),Pce=(i=>(i.LEFT="left",i.RIGHT="right",i))(Pce||{});const xV={asc:"desc",desc:"asc"},rA=Symbol("placeholder"),Sqe=(i,e,t)=>{var n;const r={flexGrow:0,flexShrink:0,...t?{}:{flexGrow:i.flexGrow||0,flexShrink:i.flexShrink||1}};t||(r.flexShrink=1);const s={...(n=i.style)!=null?n:{},...r,flexBasis:"auto",width:i.width};return e||(i.maxWidth&&(s.maxWidth=i.maxWidth),i.minWidth&&(s.minWidth=i.minWidth)),s};function Eqe(i,e,t){const n=R(()=>v(e).filter(g=>!g.hidden)),r=R(()=>v(n).filter(g=>g.fixed==="left"||g.fixed===!0)),s=R(()=>v(n).filter(g=>g.fixed==="right")),a=R(()=>v(n).filter(g=>!g.fixed)),o=R(()=>{const g=[];return v(r).forEach(_=>{g.push({..._,placeholderSign:rA})}),v(a).forEach(_=>{g.push(_)}),v(s).forEach(_=>{g.push({..._,placeholderSign:rA})}),g}),l=R(()=>v(r).length||v(s).length),c=R(()=>v(e).reduce((_,b)=>(_[b.key]=Sqe(b,v(t),i.fixed),_),{})),u=R(()=>v(n).reduce((g,_)=>g+_.width,0)),d=g=>v(e).find(_=>_.key===g),h=g=>v(c)[g],p=(g,_)=>{g.width=_};function m(g){var _;const{key:b}=g.currentTarget.dataset;if(!b)return;const{sortState:x,sortBy:w}=i;let C=iA.ASC;oi(x)?C=xV[x[b]]:C=xV[w.order],(_=i.onColumnSort)==null||_.call(i,{column:d(b),key:b,order:C})}return{columns:e,columnsStyles:c,columnsTotalWidth:u,fixedColumnsOnLeft:r,fixedColumnsOnRight:s,hasFixedColumns:l,mainColumns:o,normalColumns:a,visibleColumns:n,getColumn:d,getColumnStyle:h,updateColumnWidth:p,onColumnSorted:m}}const Aqe=(i,{mainTableRef:e,leftTableRef:t,rightTableRef:n,onMaybeEndReached:r})=>{const s=W({scrollLeft:0,scrollTop:0});function a(p){var m,g,_;const{scrollTop:b}=p;(m=e.value)==null||m.scrollTo(p),(g=t.value)==null||g.scrollToTop(b),(_=n.value)==null||_.scrollToTop(b)}function o(p){s.value=p,a(p)}function l(p){s.value.scrollTop=p,a(v(s))}function c(p){var m,g;s.value.scrollLeft=p,(g=(m=e.value)==null?void 0:m.scrollTo)==null||g.call(m,v(s))}function u(p){var m;o(p),(m=i.onScroll)==null||m.call(i,p)}function d({scrollTop:p}){const{scrollTop:m}=v(s);p!==m&&l(p)}function h(p,m="auto"){var g;(g=e.value)==null||g.scrollToRow(p,m)}return Ve(()=>v(s).scrollTop,(p,m)=>{p>m&&r()}),{scrollPos:s,scrollTo:o,scrollToLeft:c,scrollToTop:l,scrollToRow:h,onScroll:u,onVerticalScroll:d}},Mqe=(i,{mainTableRef:e,leftTableRef:t,rightTableRef:n,onMaybeEndReached:r})=>{const s=ti(),{emit:a}=s,o=nr(!1),l=nr(null),c=W(i.defaultExpandedRowKeys||[]),u=W(-1),d=nr(null),h=W({}),p=W({}),m=nr({}),g=nr({}),_=nr({}),b=R(()=>It(i.estimatedRowHeight));function x(O){var M;(M=i.onRowsRendered)==null||M.call(i,O),O.rowCacheEnd>v(u)&&(u.value=O.rowCacheEnd)}function w({hovered:O,rowKey:M}){l.value=O?M:null}function C({expanded:O,rowData:M,rowIndex:V,rowKey:L}){var U,G;const H=[...v(c)],k=H.indexOf(L);O?k===-1&&H.push(L):k>-1&&H.splice(k,1),c.value=H,a("update:expandedRowKeys",H),(U=i.onRowExpand)==null||U.call(i,{expanded:O,rowData:M,rowIndex:V,rowKey:L}),(G=i.onExpandedRowsChange)==null||G.call(i,H)}const S=Zl(()=>{var O,M,V,L;o.value=!0,h.value={...v(h),...v(p)},E(v(d),!1),p.value={},d.value=null,(O=e.value)==null||O.forceUpdate(),(M=t.value)==null||M.forceUpdate(),(V=n.value)==null||V.forceUpdate(),(L=s.proxy)==null||L.$forceUpdate(),o.value=!1},0);function E(O,M=!1){v(b)&&[e,t,n].forEach(V=>{const L=v(V);L&&L.resetAfterRowIndex(O,M)})}function A(O,M,V){const L=v(d);(L===null||L>V)&&(d.value=V),p.value[O]=M}function P({rowKey:O,height:M,rowIndex:V},L){L?L===Pce.RIGHT?_.value[O]=M:m.value[O]=M:g.value[O]=M;const U=Math.max(...[m,_,g].map(G=>G.value[O]||0));v(h)[O]!==U&&(A(O,U,V),S())}return Ve(u,()=>r()),{hoveringRowKey:l,expandedRowKeys:c,lastRenderedRowIndex:u,isDynamic:b,isResetting:o,rowHeights:h,resetAfterIndex:E,onRowExpanded:C,onRowHovered:w,onRowsRendered:x,onRowHeightChange:P}},Pqe=(i,{expandedRowKeys:e,lastRenderedRowIndex:t,resetAfterIndex:n})=>{const r=W({}),s=R(()=>{const o={},{data:l,rowKey:c}=i,u=v(e);if(!u||!u.length)return l;const d=[],h=new Set;u.forEach(m=>h.add(m));let p=l.slice();for(p.forEach(m=>o[m[c]]=0);p.length>0;){const m=p.shift();d.push(m),h.has(m[c])&&Array.isArray(m.children)&&m.children.length>0&&(p=[...m.children,...p],m.children.forEach(g=>o[g[c]]=o[m[c]]+1))}return r.value=o,d}),a=R(()=>{const{data:o,expandColumnKey:l}=i;return l?v(s):o});return Ve(a,(o,l)=>{o!==l&&(t.value=-1,n(0,!0))}),{data:a,depthMap:r}},Oqe=(i,e)=>i+e,OR=i=>st(i)?i.reduce(Oqe,0):i,cb=(i,e,t={})=>Lt(i)?i(e):i??t,Jv=i=>(["width","maxWidth","minWidth","height"].forEach(e=>{i[e]=Xs(i[e])}),i),Oce=i=>Pr(i)?e=>bt(i,e):i,Rqe=(i,{columnsTotalWidth:e,data:t,fixedColumnsOnLeft:n,fixedColumnsOnRight:r})=>{const s=R(()=>{const{fixed:w,width:C,vScrollbarSize:S}=i,E=C-S;return w?Math.max(Math.round(v(e)),E):E}),a=R(()=>v(s)+(i.fixed?i.vScrollbarSize:0)),o=R(()=>{const{height:w=0,maxHeight:C=0,footerHeight:S,hScrollbarSize:E}=i;if(C>0){const A=v(m),P=v(l),M=v(p)+A+P+E;return Math.min(M,C-S)}return w-S}),l=R(()=>{const{rowHeight:w,estimatedRowHeight:C}=i,S=v(t);return It(C)?S.length*C:S.length*w}),c=R(()=>{const{maxHeight:w}=i,C=v(o);if(It(w)&&w>0)return C;const S=v(l)+v(p)+v(m);return Math.min(C,S)}),u=w=>w.width,d=R(()=>OR(v(n).map(u))),h=R(()=>OR(v(r).map(u))),p=R(()=>OR(i.headerHeight)),m=R(()=>{var w;return(((w=i.fixedData)==null?void 0:w.length)||0)*i.rowHeight}),g=R(()=>v(o)-v(p)-v(m)),_=R(()=>{const{style:w={},height:C,width:S}=i;return Jv({...w,height:C,width:S})}),b=R(()=>Jv({height:i.footerHeight})),x=R(()=>({top:Xs(v(p)),bottom:Xs(i.footerHeight),width:Xs(i.width)}));return{bodyWidth:s,fixedTableHeight:c,mainTableHeight:o,leftTableWidth:d,rightTableWidth:h,headerWidth:a,rowsHeight:l,windowHeight:g,footerHeight:b,emptyStyle:x,rootStyle:_,headerHeight:p}},Iqe=i=>{const e=W(),t=W(0),n=W(0);let r;return qt(()=>{r=fl(e,([s])=>{const{width:a,height:o}=s.contentRect,{paddingLeft:l,paddingRight:c,paddingTop:u,paddingBottom:d}=getComputedStyle(s.target),h=Number.parseInt(l)||0,p=Number.parseInt(c)||0,m=Number.parseInt(u)||0,g=Number.parseInt(d)||0;t.value=a-h-p,n.value=o-m-g}).stop}),Vr(()=>{r==null||r()}),Ve([t,n],([s,a])=>{var o;(o=i.onResize)==null||o.call(i,{width:s,height:a})}),{sizer:e,width:t,height:n}};function $qe(i){const e=W(),t=W(),n=W(),{columns:r,columnsStyles:s,columnsTotalWidth:a,fixedColumnsOnLeft:o,fixedColumnsOnRight:l,hasFixedColumns:c,mainColumns:u,onColumnSorted:d}=Eqe(i,kr(i,"columns"),kr(i,"fixed")),{scrollTo:h,scrollToLeft:p,scrollToTop:m,scrollToRow:g,onScroll:_,onVerticalScroll:b,scrollPos:x}=Aqe(i,{mainTableRef:e,leftTableRef:t,rightTableRef:n,onMaybeEndReached:ie}),{expandedRowKeys:w,hoveringRowKey:C,lastRenderedRowIndex:S,isDynamic:E,isResetting:A,rowHeights:P,resetAfterIndex:O,onRowExpanded:M,onRowHeightChange:V,onRowHovered:L,onRowsRendered:U}=Mqe(i,{mainTableRef:e,leftTableRef:t,rightTableRef:n,onMaybeEndReached:ie}),{data:G,depthMap:H}=Pqe(i,{expandedRowKeys:w,lastRenderedRowIndex:S,resetAfterIndex:O}),{bodyWidth:k,fixedTableHeight:D,mainTableHeight:$,leftTableWidth:F,rightTableWidth:Y,headerWidth:ne,rowsHeight:X,windowHeight:J,footerHeight:he,emptyStyle:ye,rootStyle:Te,headerHeight:ce}=Rqe(i,{columnsTotalWidth:a,data:G,fixedColumnsOnLeft:o,fixedColumnsOnRight:l}),ae=nr(!1),le=W(),fe=R(()=>{const oe=v(G).length===0;return st(i.fixedData)?i.fixedData.length===0&&oe:oe});function Ue(oe){const{estimatedRowHeight:we,rowHeight:Ae,rowKey:Oe}=i;return we?v(P)[v(G)[oe][Oe]]||we:Ae}function ie(){const{onEndReached:oe}=i;if(!oe)return;const{scrollTop:we}=v(x),Ae=v(X),Oe=v(J),ve=Ae-(we+Oe)+i.hScrollbarSize;v(S)>=0&&Ae===we+v($)-v(ce)&&oe(ve)}return Ve(()=>i.expandedRowKeys,oe=>w.value=oe,{deep:!0}),{columns:r,containerRef:le,mainTableRef:e,leftTableRef:t,rightTableRef:n,isDynamic:E,isResetting:A,isScrolling:ae,hoveringRowKey:C,hasFixedColumns:c,columnsStyles:s,columnsTotalWidth:a,data:G,expandedRowKeys:w,depthMap:H,fixedColumnsOnLeft:o,fixedColumnsOnRight:l,mainColumns:u,bodyWidth:k,emptyStyle:ye,rootStyle:Te,headerWidth:ne,footerHeight:he,mainTableHeight:$,fixedTableHeight:D,leftTableWidth:F,rightTableWidth:Y,showEmpty:fe,getRowHeight:Ue,onColumnSorted:d,onRowHovered:L,onRowExpanded:M,onRowsRendered:U,onRowHeightChange:V,scrollTo:h,scrollToLeft:p,scrollToTop:m,scrollToRow:g,onScroll:_,onVerticalScroll:b}}const K9=Symbol("tableV2"),Rce=String,dM={type:xe(Array),required:!0},Y9={type:xe(Array)},Ice={...Y9,required:!0},Lqe=String,AK={type:xe(Array),default:()=>Ar([])},r0={type:Number,required:!0},$ce={type:xe([String,Number,Symbol]),default:"id"},MK={type:xe(Object)},T0=Ke({class:String,columns:dM,columnsStyles:{type:xe(Object),required:!0},depth:Number,expandColumnKey:Lqe,estimatedRowHeight:{...z0.estimatedRowHeight,default:void 0},isScrolling:Boolean,onRowExpand:{type:xe(Function)},onRowHover:{type:xe(Function)},onRowHeightChange:{type:xe(Function)},rowData:{type:xe(Object),required:!0},rowEventHandlers:{type:xe(Object)},rowIndex:{type:Number,required:!0},rowKey:$ce,style:{type:xe(Object)}}),Dk={type:Number,required:!0},X9=Ke({class:String,columns:dM,fixedHeaderData:{type:xe(Array)},headerData:{type:xe(Array),required:!0},headerHeight:{type:xe([Number,Array]),default:50},rowWidth:Dk,rowHeight:{type:Number,default:50},height:Dk,width:Dk}),RR=Ke({columns:dM,data:Ice,fixedData:Y9,estimatedRowHeight:T0.estimatedRowHeight,width:r0,height:r0,headerWidth:r0,headerHeight:X9.headerHeight,bodyWidth:r0,rowHeight:r0,cache:nce.cache,useIsScrolling:Boolean,scrollbarAlwaysOn:z0.scrollbarAlwaysOn,scrollbarStartGap:z0.scrollbarStartGap,scrollbarEndGap:z0.scrollbarEndGap,class:Rce,style:MK,containerStyle:MK,getRowHeight:{type:xe(Function),required:!0},rowKey:T0.rowKey,onRowsRendered:{type:xe(Function)},onScroll:{type:xe(Function)}}),Dqe=Ke({cache:RR.cache,estimatedRowHeight:T0.estimatedRowHeight,rowKey:$ce,headerClass:{type:xe([String,Function])},headerProps:{type:xe([Object,Function])},headerCellProps:{type:xe([Object,Function])},headerHeight:X9.headerHeight,footerHeight:{type:Number,default:0},rowClass:{type:xe([String,Function])},rowProps:{type:xe([Object,Function])},rowHeight:{type:Number,default:50},cellProps:{type:xe([Object,Function])},columns:dM,data:Ice,dataGetter:{type:xe(Function)},fixedData:Y9,expandColumnKey:T0.expandColumnKey,expandedRowKeys:AK,defaultExpandedRowKeys:AK,class:Rce,fixed:Boolean,style:{type:xe(Object)},width:r0,height:r0,maxHeight:Number,useIsScrolling:Boolean,indentSize:{type:Number,default:12},iconSize:{type:Number,default:12},hScrollbarSize:z0.hScrollbarSize,vScrollbarSize:z0.vScrollbarSize,scrollbarAlwaysOn:ace.alwaysOn,sortBy:{type:xe(Object),default:()=>({})},sortState:{type:xe(Object),default:void 0},onColumnSort:{type:xe(Function)},onExpandedRowsChange:{type:xe(Function)},onEndReached:{type:xe(Function)},onRowExpand:T0.onRowExpand,onScroll:RR.onScroll,onRowsRendered:RR.onRowsRendered,rowEventHandlers:T0.rowEventHandlers}),Z9=(i,{slots:e})=>{var t;const{cellData:n,style:r}=i,s=((t=n==null?void 0:n.toString)==null?void 0:t.call(n))||"";return re("div",{class:i.class,title:s,style:r},[e.default?e.default(i):s])};Z9.displayName="ElTableV2Cell";Z9.inheritAttrs=!1;const Q9=(i,{slots:e})=>{var t,n;return e.default?e.default(i):re("div",{class:i.class,title:(t=i.column)==null?void 0:t.title},[(n=i.column)==null?void 0:n.title])};Q9.displayName="ElTableV2HeaderCell";Q9.inheritAttrs=!1;const kqe=Ke({class:String,columns:dM,columnsStyles:{type:xe(Object),required:!0},headerIndex:Number,style:{type:xe(Object)}}),Fqe=de({name:"ElTableV2HeaderRow",props:kqe,setup(i,{slots:e}){return()=>{const{columns:t,columnsStyles:n,headerIndex:r,style:s}=i;let a=t.map((o,l)=>e.cell({columns:t,column:o,columnIndex:l,headerIndex:r,style:n[o.key]}));return e.header&&(a=e.header({cells:a.map(o=>st(o)&&o.length===1?o[0]:o),columns:t,headerIndex:r})),re("div",{class:i.class,style:s},[a])}}}),Nqe="ElTableV2Header",Vqe=de({name:Nqe,props:X9,setup(i,{slots:e,expose:t}){const n=Ne("table-v2"),r=W(),s=R(()=>Jv({width:i.width,height:i.height})),a=R(()=>Jv({width:i.rowWidth,height:i.height})),o=R(()=>nC(v(i.headerHeight))),l=d=>{const h=v(r);ut(()=>{h!=null&&h.scroll&&h.scroll({left:d})})},c=()=>{const d=n.e("fixed-header-row"),{columns:h,fixedHeaderData:p,rowHeight:m}=i;return p==null?void 0:p.map((g,_)=>{var b;const x=Jv({height:m,width:"100%"});return(b=e.fixed)==null?void 0:b.call(e,{class:d,columns:h,rowData:g,rowIndex:-(_+1),style:x})})},u=()=>{const d=n.e("dynamic-header-row"),{columns:h}=i;return v(o).map((p,m)=>{var g;const _=Jv({width:"100%",height:p});return(g=e.dynamic)==null?void 0:g.call(e,{class:d,columns:h,headerIndex:m,style:_})})};return t({scrollToLeft:l}),()=>{if(!(i.height<=0))return re("div",{ref:r,class:i.class,style:v(s)},[re("div",{style:v(a),class:n.e("header")},[u(),c()])])}}}),Bqe=i=>{const{isScrolling:e}=ht(K9),t=W(!1),n=W(),r=R(()=>It(i.estimatedRowHeight)&&i.rowIndex>=0),s=(l=!1)=>{const c=v(n);if(!c)return;const{columns:u,onRowHeightChange:d,rowKey:h,rowIndex:p,style:m}=i,{height:g}=c.getBoundingClientRect();t.value=!0,ut(()=>{if(l||g!==Number.parseInt(m.height)){const _=u[0],b=(_==null?void 0:_.placeholderSign)===rA;d==null||d({rowKey:h,height:g,rowIndex:p},_&&!b&&_.fixed)}})},a=R(()=>{const{rowData:l,rowIndex:c,rowKey:u,onRowHover:d}=i,h=i.rowEventHandlers||{},p={};return Object.entries(h).forEach(([m,g])=>{Lt(g)&&(p[m]=_=>{g({event:_,rowData:l,rowIndex:c,rowKey:u})})}),d&&[{name:"onMouseleave",hovered:!1},{name:"onMouseenter",hovered:!0}].forEach(({name:m,hovered:g})=>{const _=p[m];p[m]=b=>{d({event:b,hovered:g,rowData:l,rowIndex:c,rowKey:u}),_==null||_(b)}}),p}),o=l=>{const{onRowExpand:c,rowData:u,rowIndex:d,rowKey:h}=i;c==null||c({expanded:l,rowData:u,rowIndex:d,rowKey:h})};return qt(()=>{v(r)&&s(!0)}),{isScrolling:e,measurable:r,measured:t,rowRef:n,eventHandlers:a,onExpand:o}},zqe="ElTableV2TableRow",Uqe=de({name:zqe,props:T0,setup(i,{expose:e,slots:t,attrs:n}){const{eventHandlers:r,isScrolling:s,measurable:a,measured:o,rowRef:l,onExpand:c}=Bqe(i);return e({onExpand:c}),()=>{const{columns:u,columnsStyles:d,expandColumnKey:h,depth:p,rowData:m,rowIndex:g,style:_}=i;let b=u.map((x,w)=>{const C=st(m.children)&&m.children.length>0&&x.key===h;return t.cell({column:x,columns:u,columnIndex:w,depth:p,style:d[x.key],rowData:m,rowIndex:g,isScrolling:v(s),expandIconProps:C?{rowData:m,rowIndex:g,onExpand:c}:void 0})});if(t.row&&(b=t.row({cells:b.map(x=>st(x)&&x.length===1?x[0]:x),style:_,columns:u,depth:p,rowData:m,rowIndex:g,isScrolling:v(s)})),v(a)){const{height:x,...w}=_||{},C=v(o);return re("div",ci({ref:l,class:i.class,style:C?_:w},n,v(r)),[b])}return re("div",ci(n,{ref:l,class:i.class,style:_},v(r)),[b])}}}),Hqe=i=>{const{sortOrder:e}=i;return re(ct,{size:14,class:i.class},{default:()=>[e===iA.ASC?re(fLe,null,null):re(lLe,null,null)]})},Gqe=i=>{const{expanded:e,expandable:t,onExpand:n,style:r,size:s}=i,a={onClick:t?()=>n(!e):void 0,class:i.class};return re(ct,ci(a,{size:s,style:r}),{default:()=>[re(Wl,null,null)]})},Wqe="ElTableV2Grid",jqe=i=>{const e=W(),t=W(),n=R(()=>{const{data:g,rowHeight:_,estimatedRowHeight:b}=i;if(!b)return g.length*_}),r=R(()=>{const{fixedData:g,rowHeight:_}=i;return((g==null?void 0:g.length)||0)*_}),s=R(()=>OR(i.headerHeight)),a=R(()=>{const{height:g}=i;return Math.max(0,g-v(s)-v(r))}),o=R(()=>v(s)+v(r)>0),l=({data:g,rowIndex:_})=>g[_][i.rowKey];function c({rowCacheStart:g,rowCacheEnd:_,rowVisibleStart:b,rowVisibleEnd:x}){var w;(w=i.onRowsRendered)==null||w.call(i,{rowCacheStart:g,rowCacheEnd:_,rowVisibleStart:b,rowVisibleEnd:x})}function u(g,_){var b;(b=t.value)==null||b.resetAfterRowIndex(g,_)}function d(g,_){const b=v(e),x=v(t);!b||!x||(oi(g)?(b.scrollToLeft(g.scrollLeft),x.scrollTo(g)):(b.scrollToLeft(g),x.scrollTo({scrollLeft:g,scrollTop:_})))}function h(g){var _;(_=v(t))==null||_.scrollTo({scrollTop:g})}function p(g,_){var b;(b=v(t))==null||b.scrollToItem(g,1,_)}function m(){var g,_;(g=v(t))==null||g.$forceUpdate(),(_=v(e))==null||_.$forceUpdate()}return{bodyRef:t,forceUpdate:m,fixedRowHeight:r,gridHeight:a,hasHeader:o,headerHeight:s,headerRef:e,totalHeight:n,itemKey:l,onItemRendered:c,resetAfterRowIndex:u,scrollTo:d,scrollToTop:h,scrollToRow:p}},J9=de({name:Wqe,props:RR,setup(i,{slots:e,expose:t}){const{ns:n}=ht(K9),{bodyRef:r,fixedRowHeight:s,gridHeight:a,hasHeader:o,headerRef:l,headerHeight:c,totalHeight:u,forceUpdate:d,itemKey:h,onItemRendered:p,resetAfterRowIndex:m,scrollTo:g,scrollToTop:_,scrollToRow:b}=jqe(i);t({forceUpdate:d,totalHeight:u,scrollTo:g,scrollToTop:_,scrollToRow:b,resetAfterRowIndex:m});const x=()=>i.bodyWidth;return()=>{const{cache:w,columns:C,data:S,fixedData:E,useIsScrolling:A,scrollbarAlwaysOn:P,scrollbarEndGap:O,scrollbarStartGap:M,style:V,rowHeight:L,bodyWidth:U,estimatedRowHeight:G,headerWidth:H,height:k,width:D,getRowHeight:$,onScroll:F}=i,Y=It(G),ne=Y?TGe:bGe,X=v(c);return re("div",{role:"table",class:[n.e("table"),i.class],style:V},[re(ne,{ref:r,data:S,useIsScrolling:A,itemKey:h,columnCache:0,columnWidth:Y?x:U,totalColumn:1,totalRow:S.length,rowCache:w,rowHeight:Y?$:L,width:D,height:v(a),class:n.e("body"),scrollbarStartGap:M,scrollbarEndGap:O,scrollbarAlwaysOn:P,onScroll:F,onItemRendered:p,perfMode:!1},{default:J=>{var he;const ye=S[J.rowIndex];return(he=e.row)==null?void 0:he.call(e,{...J,columns:C,rowData:ye})}}),v(o)&&re(Vqe,{ref:l,class:n.e("header-wrapper"),columns:C,headerData:S,headerHeight:i.headerHeight,fixedHeaderData:E,rowWidth:H,rowHeight:L,width:D,height:Math.min(X+v(s),k)},{dynamic:e.header,fixed:e.row})])}}});function qqe(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!Pr(i)}const Kqe=(i,{slots:e})=>{const{mainTableRef:t,...n}=i;return re(J9,ci({ref:t},n),qqe(e)?e:{default:()=>[e]})};function Yqe(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!Pr(i)}const Xqe=(i,{slots:e})=>{if(!i.columns.length)return;const{leftTableRef:t,...n}=i;return re(J9,ci({ref:t},n),Yqe(e)?e:{default:()=>[e]})};function Zqe(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!Pr(i)}const Qqe=(i,{slots:e})=>{if(!i.columns.length)return;const{rightTableRef:t,...n}=i;return re(J9,ci({ref:t},n),Zqe(e)?e:{default:()=>[e]})};function Jqe(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!Pr(i)}const eKe=(i,{slots:e})=>{const{columns:t,columnsStyles:n,depthMap:r,expandColumnKey:s,expandedRowKeys:a,estimatedRowHeight:o,hasFixedColumns:l,hoveringRowKey:c,rowData:u,rowIndex:d,style:h,isScrolling:p,rowProps:m,rowClass:g,rowKey:_,rowEventHandlers:b,ns:x,onRowHovered:w,onRowExpanded:C}=i,S=cb(g,{columns:t,rowData:u,rowIndex:d},""),E=cb(m,{columns:t,rowData:u,rowIndex:d}),A=u[_],P=r[A]||0,O=Boolean(s),M=d<0,V=[x.e("row"),S,{[x.e(`row-depth-${P}`)]:O&&d>=0,[x.is("expanded")]:O&&a.includes(A),[x.is("hovered")]:!p&&A===c,[x.is("fixed")]:!P&&M,[x.is("customized")]:Boolean(e.row)}],L=l?w:void 0,U={...E,columns:t,columnsStyles:n,class:V,depth:P,expandColumnKey:s,estimatedRowHeight:M?void 0:o,isScrolling:p,rowIndex:d,rowData:u,rowKey:A,rowEventHandlers:b,style:h};return re(Uqe,ci(U,{onRowHover:L,onRowExpand:C}),Jqe(e)?e:{default:()=>[e]})},CV=({columns:i,column:e,columnIndex:t,depth:n,expandIconProps:r,isScrolling:s,rowData:a,rowIndex:o,style:l,expandedRowKeys:c,ns:u,cellProps:d,expandColumnKey:h,indentSize:p,iconSize:m,rowKey:g},{slots:_})=>{const b=Jv(l);if(e.placeholderSign===rA)return re("div",{class:u.em("row-cell","placeholder"),style:b},null);const{cellRenderer:x,dataKey:w,dataGetter:C}=e,E=Oce(x)||_.default||(k=>re(Z9,k,null)),A=Lt(C)?C({columns:i,column:e,columnIndex:t,rowData:a,rowIndex:o}):Tr(a,w??""),P=cb(d,{cellData:A,columns:i,column:e,columnIndex:t,rowIndex:o,rowData:a}),O={class:u.e("cell-text"),columns:i,column:e,columnIndex:t,cellData:A,isScrolling:s,rowData:a,rowIndex:o},M=E(O),V=[u.e("row-cell"),e.align===nA.CENTER&&u.is("align-center"),e.align===nA.RIGHT&&u.is("align-right")],L=o>=0&&e.key===h,U=o>=0&&c.includes(a[g]);let G;const H=`margin-inline-start: ${n*p}px;`;return L&&(oi(r)?G=re(Gqe,ci(r,{class:[u.e("expand-icon"),u.is("expanded",U)],size:m,expanded:U,style:H,expandable:!0}),null):G=re("div",{style:[H,`width: ${m}px; height: ${m}px;`].join(" ")},null)),re("div",ci({class:V,style:b},P),[G,M])};CV.inheritAttrs=!1;function tKe(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!Pr(i)}const iKe=({columns:i,columnsStyles:e,headerIndex:t,style:n,headerClass:r,headerProps:s,ns:a},{slots:o})=>{const l={columns:i,headerIndex:t},c=[a.e("header-row"),cb(r,l,""),{[a.is("customized")]:Boolean(o.header)}],u={...cb(s,l),columnsStyles:e,class:c,columns:i,headerIndex:t,style:n};return re(Fqe,u,tKe(o)?o:{default:()=>[o]})},PK=(i,{slots:e})=>{const{column:t,ns:n,style:r,onColumnSorted:s}=i,a=Jv(r);if(t.placeholderSign===rA)return re("div",{class:n.em("header-row-cell","placeholder"),style:a},null);const{headerCellRenderer:o,headerClass:l,sortable:c}=t,u={...i,class:n.e("header-cell-text")},h=(Oce(o)||e.default||(C=>re(Q9,C,null)))(u),{sortBy:p,sortState:m,headerCellProps:g}=i;let _,b;if(m){const C=m[t.key];_=Boolean(xV[C]),b=_?C:iA.ASC}else _=t.key===p.key,b=_?p.order:iA.ASC;const x=[n.e("header-cell"),cb(l,i,""),t.align===nA.CENTER&&n.is("align-center"),t.align===nA.RIGHT&&n.is("align-right"),c&&n.is("sortable")],w={...cb(g,i),onClick:t.sortable?s:void 0,class:x,style:a,["data-key"]:t.key};return re("div",w,[h,c&&re(Hqe,{class:[n.e("sort-icon"),_&&n.is("sorting")],sortOrder:b},null)])},Lce=(i,{slots:e})=>{var t;return re("div",{class:i.class,style:i.style},[(t=e.default)==null?void 0:t.call(e)])};Lce.displayName="ElTableV2Footer";const Dce=(i,{slots:e})=>re("div",{class:i.class,style:i.style},[e.default?e.default():re(zle,null,null)]);Dce.displayName="ElTableV2Empty";const kce=(i,{slots:e})=>{var t;return re("div",{class:i.class,style:i.style},[(t=e.default)==null?void 0:t.call(e)])};kce.displayName="ElTableV2Overlay";function yT(i){return typeof i=="function"||Object.prototype.toString.call(i)==="[object Object]"&&!Pr(i)}const nKe="ElTableV2",rKe=de({name:nKe,props:Dqe,setup(i,{slots:e,expose:t}){const n=Ne("table-v2"),{columnsStyles:r,fixedColumnsOnLeft:s,fixedColumnsOnRight:a,mainColumns:o,mainTableHeight:l,fixedTableHeight:c,leftTableWidth:u,rightTableWidth:d,data:h,depthMap:p,expandedRowKeys:m,hasFixedColumns:g,hoveringRowKey:_,mainTableRef:b,leftTableRef:x,rightTableRef:w,isDynamic:C,isResetting:S,isScrolling:E,bodyWidth:A,emptyStyle:P,rootStyle:O,headerWidth:M,footerHeight:V,showEmpty:L,scrollTo:U,scrollToLeft:G,scrollToTop:H,scrollToRow:k,getRowHeight:D,onColumnSorted:$,onRowHeightChange:F,onRowHovered:Y,onRowExpanded:ne,onRowsRendered:X,onScroll:J,onVerticalScroll:he}=$qe(i);return t({scrollTo:U,scrollToLeft:G,scrollToTop:H,scrollToRow:k}),pi(K9,{ns:n,isResetting:S,hoveringRowKey:_,isScrolling:E}),()=>{const{cache:ye,cellProps:Te,estimatedRowHeight:ce,expandColumnKey:ae,fixedData:le,headerHeight:fe,headerClass:Ue,headerProps:ie,headerCellProps:oe,sortBy:we,sortState:Ae,rowHeight:Oe,rowClass:ve,rowEventHandlers:ke,rowKey:be,rowProps:$e,scrollbarAlwaysOn:Le,indentSize:Ce,iconSize:Be,useIsScrolling:He,vScrollbarSize:Xe,width:Je}=i,it=v(h),Qe={cache:ye,class:n.e("main"),columns:v(o),data:it,fixedData:le,estimatedRowHeight:ce,bodyWidth:v(A),headerHeight:fe,headerWidth:v(M),height:v(l),mainTableRef:b,rowKey:be,rowHeight:Oe,scrollbarAlwaysOn:Le,scrollbarStartGap:2,scrollbarEndGap:Xe,useIsScrolling:He,width:Je,getRowHeight:D,onRowsRendered:X,onScroll:J},te=v(u),me=v(c),Ie={cache:ye,class:n.e("left"),columns:v(s),data:it,estimatedRowHeight:ce,leftTableRef:x,rowHeight:Oe,bodyWidth:te,headerWidth:te,headerHeight:fe,height:me,rowKey:be,scrollbarAlwaysOn:Le,scrollbarStartGap:2,scrollbarEndGap:Xe,useIsScrolling:He,width:te,getRowHeight:D,onScroll:he},se=v(d)+Xe,Me={cache:ye,class:n.e("right"),columns:v(a),data:it,estimatedRowHeight:ce,rightTableRef:w,rowHeight:Oe,bodyWidth:se,headerWidth:se,headerHeight:fe,height:me,rowKey:be,scrollbarAlwaysOn:Le,scrollbarStartGap:2,scrollbarEndGap:Xe,width:se,style:`--${v(n.namespace)}-table-scrollbar-size: ${Xe}px`,useIsScrolling:He,getRowHeight:D,onScroll:he},De=v(r),Tt={ns:n,depthMap:v(p),columnsStyles:De,expandColumnKey:ae,expandedRowKeys:v(m),estimatedRowHeight:ce,hasFixedColumns:v(g),hoveringRowKey:v(_),rowProps:$e,rowClass:ve,rowKey:be,rowEventHandlers:ke,onRowHovered:Y,onRowExpanded:ne,onRowHeightChange:F},Zt={cellProps:Te,expandColumnKey:ae,indentSize:Ce,iconSize:Be,rowKey:be,expandedRowKeys:v(m),ns:n},tn={ns:n,headerClass:Ue,headerProps:ie,columnsStyles:De},vn={ns:n,sortBy:we,sortState:Ae,headerCellProps:oe,onColumnSorted:$},ui={row:ft=>re(eKe,ci(ft,Tt),{row:e.row,cell:Bt=>{let Kt;return e.cell?re(CV,ci(Bt,Zt,{style:De[Bt.column.key]}),yT(Kt=e.cell(Bt))?Kt:{default:()=>[Kt]}):re(CV,ci(Bt,Zt,{style:De[Bt.column.key]}),null)}}),header:ft=>re(iKe,ci(ft,tn),{header:e.header,cell:Bt=>{let Kt;return e["header-cell"]?re(PK,ci(Bt,vn,{style:De[Bt.column.key]}),yT(Kt=e["header-cell"](Bt))?Kt:{default:()=>[Kt]}):re(PK,ci(Bt,vn,{style:De[Bt.column.key]}),null)}})},di=[i.class,n.b(),n.e("root"),{[n.is("dynamic")]:v(C)}],ze={class:n.e("footer"),style:v(V)};return re("div",{class:di,style:v(O)},[re(Kqe,Qe,yT(ui)?ui:{default:()=>[ui]}),re(Xqe,Ie,yT(ui)?ui:{default:()=>[ui]}),re(Qqe,Me,yT(ui)?ui:{default:()=>[ui]}),e.footer&&re(Lce,ze,{default:e.footer}),v(L)&&re(Dce,{class:n.e("empty"),style:v(P)},{default:e.empty}),e.overlay&&re(kce,{class:n.e("overlay")},{default:e.overlay})])}}}),sKe=Ke({disableWidth:Boolean,disableHeight:Boolean,onResize:{type:xe(Function)}}),aKe=de({name:"ElAutoResizer",props:sKe,setup(i,{slots:e}){const t=Ne("auto-resizer"),{height:n,width:r,sizer:s}=Iqe(i),a={width:"100%",height:"100%"};return()=>{var o;return re("div",{ref:s,class:t.b(),style:a},[(o=e.default)==null?void 0:o.call(e,{height:n.value,width:r.value})])}}}),oKe=ii(rKe),lKe=ii(aKe),cKe=Ke({tabs:{type:xe(Array),default:()=>Ar([])}}),Fce="ElTabBar",uKe=de({name:Fce}),dKe=de({...uKe,props:cKe,setup(i,{expose:e}){const t=i,n=ti(),r=ht($3);r||ba(Fce,"<el-tabs><el-tab-bar /></el-tabs>");const s=Ne("tabs"),a=W(),o=W(),l=()=>{let u=0,d=0;const h=["top","bottom"].includes(r.props.tabPosition)?"width":"height",p=h==="width"?"x":"y",m=p==="x"?"left":"top";return t.tabs.every(g=>{var _,b;const x=(b=(_=n.parent)==null?void 0:_.refs)==null?void 0:b[`tab-${g.uid}`];if(!x)return!1;if(!g.active)return!0;u=x[`offset${Op(m)}`],d=x[`client${Op(h)}`];const w=window.getComputedStyle(x);return h==="width"&&(t.tabs.length>1&&(d-=Number.parseFloat(w.paddingLeft)+Number.parseFloat(w.paddingRight)),u+=Number.parseFloat(w.paddingLeft)),!1}),{[h]:`${d}px`,transform:`translate${Op(p)}(${u}px)`}},c=()=>o.value=l();return Ve(()=>t.tabs,async()=>{await ut(),c()},{immediate:!0}),fl(a,()=>c()),e({ref:a,update:c}),(u,d)=>(I(),Z("div",{ref_key:"barRef",ref:a,class:N([v(s).e("active-bar"),v(s).is(v(r).props.tabPosition)]),style:pt(o.value)},null,6))}});var hKe=qe(dKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tabs/src/tab-bar.vue"]]);const pKe=Ke({panes:{type:xe(Array),default:()=>Ar([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),fKe={tabClick:(i,e,t)=>t instanceof Event,tabRemove:(i,e)=>e instanceof Event},OK="ElTabNav",mKe=de({name:OK,props:pKe,emits:fKe,setup(i,{expose:e,emit:t}){const n=ti(),r=ht($3);r||ba(OK,"<el-tabs><tab-nav /></el-tabs>");const s=Ne("tabs"),a=pOe(),o=COe(),l=W(),c=W(),u=W(),d=W(!1),h=W(0),p=W(!1),m=W(!0),g=R(()=>["top","bottom"].includes(r.props.tabPosition)?"width":"height"),_=R(()=>({transform:`translate${g.value==="width"?"X":"Y"}(-${h.value}px)`})),b=()=>{if(!l.value)return;const P=l.value[`offset${Op(g.value)}`],O=h.value;if(!O)return;const M=O>P?O-P:0;h.value=M},x=()=>{if(!l.value||!c.value)return;const P=c.value[`offset${Op(g.value)}`],O=l.value[`offset${Op(g.value)}`],M=h.value;if(P-M<=O)return;const V=P-M>O*2?M+O:P-O;h.value=V},w=async()=>{const P=c.value;if(!d.value||!u.value||!l.value||!P)return;await ut();const O=u.value.querySelector(".is-active");if(!O)return;const M=l.value,V=["top","bottom"].includes(r.props.tabPosition),L=O.getBoundingClientRect(),U=M.getBoundingClientRect(),G=V?P.offsetWidth-U.width:P.offsetHeight-U.height,H=h.value;let k=H;V?(L.left<U.left&&(k=H-(U.left-L.left)),L.right>U.right&&(k=H+L.right-U.right)):(L.top<U.top&&(k=H-(U.top-L.top)),L.bottom>U.bottom&&(k=H+(L.bottom-U.bottom))),k=Math.max(k,0),h.value=Math.min(k,G)},C=()=>{if(!c.value||!l.value)return;const P=c.value[`offset${Op(g.value)}`],O=l.value[`offset${Op(g.value)}`],M=h.value;if(O<P){const V=h.value;d.value=d.value||{},d.value.prev=V,d.value.next=V+O<P,P-V<O&&(h.value=P-O)}else d.value=!1,M>0&&(h.value=0)},S=P=>{const O=P.code,{up:M,down:V,left:L,right:U}=wt;if(![M,V,L,U].includes(O))return;const G=Array.from(P.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)")),H=G.indexOf(P.target);let k;O===L||O===M?H===0?k=G.length-1:k=H-1:H<G.length-1?k=H+1:k=0,G[k].focus({preventScroll:!0}),G[k].click(),E()},E=()=>{m.value&&(p.value=!0)},A=()=>p.value=!1;return Ve(a,P=>{P==="hidden"?m.value=!1:P==="visible"&&setTimeout(()=>m.value=!0,50)}),Ve(o,P=>{P?setTimeout(()=>m.value=!0,50):m.value=!1}),fl(u,C),qt(()=>setTimeout(()=>w(),0)),pg(()=>C()),e({scrollToActiveTab:w,removeFocus:A}),Ve(()=>i.panes,()=>n.update(),{flush:"post"}),()=>{const P=d.value?[re("span",{class:[s.e("nav-prev"),s.is("disabled",!d.value.prev)],onClick:b},[re(ct,null,{default:()=>[re(Ty,null,null)]})]),re("span",{class:[s.e("nav-next"),s.is("disabled",!d.value.next)],onClick:x},[re(ct,null,{default:()=>[re(Wl,null,null)]})])]:null,O=i.panes.map((M,V)=>{var L,U,G,H;const k=M.uid,D=M.props.disabled,$=(U=(L=M.props.name)!=null?L:M.index)!=null?U:`${V}`,F=!D&&(M.isClosable||i.editable);M.index=`${V}`;const Y=F?re(ct,{class:"is-icon-close",onClick:J=>t("tabRemove",M,J)},{default:()=>[re(Rh,null,null)]}):null,ne=((H=(G=M.slots).label)==null?void 0:H.call(G))||M.props.label,X=!D&&M.active?0:-1;return re("div",{ref:`tab-${k}`,class:[s.e("item"),s.is(r.props.tabPosition),s.is("active",M.active),s.is("disabled",D),s.is("closable",F),s.is("focus",p.value)],id:`tab-${$}`,key:`tab-${k}`,"aria-controls":`pane-${$}`,role:"tab","aria-selected":M.active,tabindex:X,onFocus:()=>E(),onBlur:()=>A(),onClick:J=>{A(),t("tabClick",M,$,J)},onKeydown:J=>{F&&(J.code===wt.delete||J.code===wt.backspace)&&t("tabRemove",M,J)}},[ne,Y])});return re("div",{ref:u,class:[s.e("nav-wrap"),s.is("scrollable",!!d.value),s.is(r.props.tabPosition)]},[P,re("div",{class:s.e("nav-scroll"),ref:l},[re("div",{class:[s.e("nav"),s.is(r.props.tabPosition),s.is("stretch",i.stretch&&["top","bottom"].includes(r.props.tabPosition))],ref:c,style:_.value,role:"tablist",onKeydown:S},[i.type?null:re(hKe,{tabs:[...i.panes]},null),O])])])}}}),gKe=Ke({type:{type:String,values:["card","border-card",""],default:""},activeName:{type:[String,Number]},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:xe(Function),default:()=>!0},stretch:Boolean}),kk=i=>Ft(i)||It(i),vKe={[ri]:i=>kk(i),tabClick:(i,e)=>e instanceof Event,tabChange:i=>kk(i),edit:(i,e)=>["remove","add"].includes(e),tabRemove:i=>kk(i),tabAdd:()=>!0};var yKe=de({name:"ElTabs",props:gKe,emits:vKe,setup(i,{emit:e,slots:t,expose:n}){var r,s;const a=Ne("tabs"),{children:o,addChild:l,removeChild:c}=_oe(ti(),"ElTabPane"),u=W(),d=W((s=(r=i.modelValue)!=null?r:i.activeName)!=null?s:"0"),h=b=>{d.value=b,e(ri,b),e("tabChange",b)},p=async b=>{var x,w,C;if(!(d.value===b||eo(b)))try{await((x=i.beforeLeave)==null?void 0:x.call(i,b,d.value))!==!1&&(h(b),(C=(w=u.value)==null?void 0:w.removeFocus)==null||C.call(w))}catch{}},m=(b,x,w)=>{b.props.disabled||(p(x),e("tabClick",b,w))},g=(b,x)=>{b.props.disabled||eo(b.props.name)||(x.stopPropagation(),e("edit",b.props.name,"remove"),e("tabRemove",b.props.name))},_=()=>{e("edit",void 0,"add"),e("tabAdd")};return Ym({from:'"activeName"',replacement:'"model-value" or "v-model"',scope:"ElTabs",version:"2.3.0",ref:"https://element-plus.org/en-US/component/tabs.html#attributes",type:"Attribute"},R(()=>!!i.activeName)),Ve(()=>i.activeName,b=>p(b)),Ve(()=>i.modelValue,b=>p(b)),Ve(d,async()=>{var b;await ut(),(b=u.value)==null||b.scrollToActiveTab()}),pi($3,{props:i,currentName:d,registerPane:l,unregisterPane:c}),n({currentName:d}),()=>{const b=i.editable||i.addable?re("span",{class:a.e("new-tab"),tabindex:"0",onClick:_,onKeydown:C=>{C.code===wt.enter&&_()}},[re(ct,{class:a.is("icon-plus")},{default:()=>[re(xae,null,null)]})]):null,x=re("div",{class:[a.e("header"),a.is(i.tabPosition)]},[b,re(mKe,{ref:u,currentName:d.value,editable:i.editable,type:i.type,panes:o.value,stretch:i.stretch,onTabClick:m,onTabRemove:g},null)]),w=re("div",{class:a.e("content")},[Fe(t,"default")]);return re("div",{class:[a.b(),a.m(i.tabPosition),{[a.m("card")]:i.type==="card",[a.m("border-card")]:i.type==="border-card"}]},[...i.tabPosition!=="bottom"?[x,w]:[w,x]])}}});const _Ke=Ke({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),bKe=["id","aria-hidden","aria-labelledby"],Nce="ElTabPane",wKe=de({name:Nce}),xKe=de({...wKe,props:_Ke,setup(i){const e=i,t=ti(),n=uo(),r=ht($3);r||ba(Nce,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const s=Ne("tab-pane"),a=W(),o=R(()=>e.closable||r.props.closable),l=Bj(()=>{var p;return r.currentName.value===((p=e.name)!=null?p:a.value)}),c=W(l.value),u=R(()=>{var p;return(p=e.name)!=null?p:a.value}),d=Bj(()=>!e.lazy||c.value||l.value);Ve(l,p=>{p&&(c.value=!0)});const h=Ji({uid:t.uid,slots:n,props:e,paneName:u,active:l,index:a,isClosable:o});return qt(()=>{r.registerPane(h)}),ky(()=>{r.unregisterPane(h.uid)}),(p,m)=>v(d)?zt((I(),Z("div",{key:0,id:`pane-${v(u)}`,class:N(v(s).b()),role:"tabpanel","aria-hidden":!v(l),"aria-labelledby":`tab-${v(u)}`},[Fe(p.$slots,"default")],10,bKe)),[[Ei,v(l)]]):_e("v-if",!0)}});var Vce=qe(xKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tabs/src/tab-pane.vue"]]);const CKe=ii(yKe,{TabPane:Vce}),TKe=Wr(Vce),SKe=Ke({format:{type:String,default:"HH:mm"},modelValue:String,disabled:Boolean,editable:{type:Boolean,default:!0},effect:{type:String,default:"light"},clearable:{type:Boolean,default:!0},size:Ql,placeholder:String,start:{type:String,default:"09:00"},end:{type:String,default:"18:00"},step:{type:String,default:"00:30"},minTime:String,maxTime:String,name:String,prefixIcon:{type:xe([String,Object]),default:()=>wae},clearIcon:{type:xe([String,Object]),default:()=>Ny}}),Tm=i=>{const e=(i||"").split(":");if(e.length>=2){let t=Number.parseInt(e[0],10);const n=Number.parseInt(e[1],10),r=i.toUpperCase();return r.includes("AM")&&t===12?t=0:r.includes("PM")&&t!==12&&(t+=12),{hours:t,minutes:n}}return null},Fk=(i,e)=>{const t=Tm(i);if(!t)return-1;const n=Tm(e);if(!n)return-1;const r=t.minutes+t.hours*60,s=n.minutes+n.hours*60;return r===s?0:r>s?1:-1},RK=i=>`${i}`.padStart(2,"0"),ew=i=>`${RK(i.hours)}:${RK(i.minutes)}`,EKe=(i,e)=>{const t=Tm(i);if(!t)return"";const n=Tm(e);if(!n)return"";const r={hours:t.hours,minutes:t.minutes};return r.minutes+=n.minutes,r.hours+=n.hours,r.hours+=Math.floor(r.minutes/60),r.minutes=r.minutes%60,ew(r)},AKe=de({name:"ElTimeSelect"}),MKe=de({...AKe,props:SKe,emits:["change","blur","focus","update:modelValue"],setup(i,{expose:e}){const t=i;Yt.extend(M9);const{Option:n}=lb,r=Ne("input"),s=W(),a=zc(),o=R(()=>t.modelValue),l=R(()=>{const _=Tm(t.start);return _?ew(_):null}),c=R(()=>{const _=Tm(t.end);return _?ew(_):null}),u=R(()=>{const _=Tm(t.step);return _?ew(_):null}),d=R(()=>{const _=Tm(t.minTime||"");return _?ew(_):null}),h=R(()=>{const _=Tm(t.maxTime||"");return _?ew(_):null}),p=R(()=>{const _=[];if(t.start&&t.end&&t.step){let b=l.value,x;for(;b&&c.value&&Fk(b,c.value)<=0;)x=Yt(b,"HH:mm").format(t.format),_.push({value:x,disabled:Fk(b,d.value||"-1:-1")<=0||Fk(b,h.value||"100:100")>=0}),b=EKe(b,u.value)}return _});return e({blur:()=>{var _,b;(b=(_=s.value)==null?void 0:_.blur)==null||b.call(_)},focus:()=>{var _,b;(b=(_=s.value)==null?void 0:_.focus)==null||b.call(_)}}),(_,b)=>(I(),Se(v(lb),{ref_key:"select",ref:s,"model-value":v(o),disabled:v(a),clearable:_.clearable,"clear-icon":_.clearIcon,size:_.size,effect:_.effect,placeholder:_.placeholder,"default-first-option":"",filterable:_.editable,"onUpdate:modelValue":b[0]||(b[0]=x=>_.$emit("update:modelValue",x)),onChange:b[1]||(b[1]=x=>_.$emit("change",x)),onBlur:b[2]||(b[2]=x=>_.$emit("blur",x)),onFocus:b[3]||(b[3]=x=>_.$emit("focus",x))},{prefix:pe(()=>[_.prefixIcon?(I(),Se(v(ct),{key:0,class:N(v(r).e("prefix-icon"))},{default:pe(()=>[(I(),Se(hi(_.prefixIcon)))]),_:1},8,["class"])):_e("v-if",!0)]),default:pe(()=>[(I(!0),Z(gt,null,xi(v(p),x=>(I(),Se(v(n),{key:x.value,label:x.value,value:x.value,disabled:x.disabled},null,8,["label","value","disabled"]))),128))]),_:1},8,["model-value","disabled","clearable","clear-icon","size","effect","placeholder","filterable"]))}});var IR=qe(MKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/time-select/src/time-select.vue"]]);IR.install=i=>{i.component(IR.name,IR)};const PKe=IR,OKe=PKe,RKe=de({name:"ElTimeline",setup(i,{slots:e}){const t=Ne("timeline");return pi("timeline",e),()=>bt("ul",{class:[t.b()]},[Fe(e,"default")])}}),IKe=Ke({timestamp:{type:String,default:""},hideTimestamp:{type:Boolean,default:!1},center:{type:Boolean,default:!1},placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:Zn},hollow:{type:Boolean,default:!1}}),$Ke=de({name:"ElTimelineItem"}),LKe=de({...$Ke,props:IKe,setup(i){const e=Ne("timeline-item");return(t,n)=>(I(),Z("li",{class:N([v(e).b(),{[v(e).e("center")]:t.center}])},[Q("div",{class:N(v(e).e("tail"))},null,2),t.$slots.dot?_e("v-if",!0):(I(),Z("div",{key:0,class:N([v(e).e("node"),v(e).em("node",t.size||""),v(e).em("node",t.type||""),v(e).is("hollow",t.hollow)]),style:pt({backgroundColor:t.color})},[t.icon?(I(),Se(v(ct),{key:0,class:N(v(e).e("icon"))},{default:pe(()=>[(I(),Se(hi(t.icon)))]),_:1},8,["class"])):_e("v-if",!0)],6)),t.$slots.dot?(I(),Z("div",{key:1,class:N(v(e).e("dot"))},[Fe(t.$slots,"dot")],2)):_e("v-if",!0),Q("div",{class:N(v(e).e("wrapper"))},[!t.hideTimestamp&&t.placement==="top"?(I(),Z("div",{key:0,class:N([v(e).e("timestamp"),v(e).is("top")])},We(t.timestamp),3)):_e("v-if",!0),Q("div",{class:N(v(e).e("content"))},[Fe(t.$slots,"default")],2),!t.hideTimestamp&&t.placement==="bottom"?(I(),Z("div",{key:1,class:N([v(e).e("timestamp"),v(e).is("bottom")])},We(t.timestamp),3)):_e("v-if",!0)],2)],2))}});var Bce=qe(LKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/timeline/src/timeline-item.vue"]]);const DKe=ii(RKe,{TimelineItem:Bce}),kKe=Wr(Bce),zce=Ke({nowrap:Boolean});var Uce=(i=>(i.top="top",i.bottom="bottom",i.left="left",i.right="right",i))(Uce||{});const FKe=Object.values(Uce),eU=Ke({width:{type:Number,default:10},height:{type:Number,default:10},style:{type:xe(Object),default:null}}),NKe=Ke({side:{type:xe(String),values:FKe,required:!0}}),VKe=["absolute","fixed"],BKe=["top-start","top-end","top","bottom-start","bottom-end","bottom","left-start","left-end","left","right-start","right-end","right"],tU=Ke({ariaLabel:String,arrowPadding:{type:xe(Number),default:5},effect:{type:String,default:""},contentClass:String,placement:{type:xe(String),values:BKe,default:"bottom"},reference:{type:xe(Object),default:null},offset:{type:Number,default:8},strategy:{type:xe(String),values:VKe,default:"absolute"},showArrow:{type:Boolean,default:!1}}),iU=Ke({delayDuration:{type:Number,default:300},defaultOpen:Boolean,open:{type:Boolean,default:void 0},onOpenChange:{type:xe(Function)},"onUpdate:open":{type:xe(Function)}}),Jb={type:xe(Function)},nU=Ke({onBlur:Jb,onClick:Jb,onFocus:Jb,onMouseDown:Jb,onMouseEnter:Jb,onMouseLeave:Jb}),zKe=Ke({...iU,...eU,...nU,...tU,alwaysOn:Boolean,fullTransition:Boolean,transitionProps:{type:xe(Object),default:null},teleported:Boolean,to:{type:xe(String),default:"body"}}),UKe=de({name:"ElTooltipV2Root"}),HKe=de({...UKe,props:iU,setup(i,{expose:e}){const t=i,n=W(t.defaultOpen),r=W(null),s=R({get:()=>AOe(t.open)?n.value:t.open,set:_=>{var b;n.value=_,(b=t["onUpdate:open"])==null||b.call(t,_)}}),a=R(()=>It(t.delayDuration)&&t.delayDuration>0),{start:o,stop:l}=ob(()=>{s.value=!0},R(()=>t.delayDuration),{immediate:!1}),c=Ne("tooltip-v2"),u=Ih(),d=()=>{l(),s.value=!0},h=()=>{v(a)?o():d()},p=d,m=()=>{l(),s.value=!1};return Ve(s,_=>{var b;_&&(document.dispatchEvent(new CustomEvent(vk)),p()),(b=t.onOpenChange)==null||b.call(t,_)}),qt(()=>{document.addEventListener(vk,m)}),Vr(()=>{l(),document.removeEventListener(vk,m)}),pi(D3,{contentId:u,triggerRef:r,ns:c,onClose:m,onDelayOpen:h,onOpen:p}),e({onOpen:p,onClose:m}),(_,b)=>Fe(_.$slots,"default",{open:v(s)})}});var GKe=qe(HKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/root.vue"]]);const WKe=de({name:"ElTooltipV2Arrow"}),jKe=de({...WKe,props:{...eU,...NKe},setup(i){const e=i,{ns:t}=ht(D3),{arrowRef:n}=ht(Uae),r=R(()=>{const{style:s,width:a,height:o}=e,l=t.namespace.value;return{[`--${l}-tooltip-v2-arrow-width`]:`${a}px`,[`--${l}-tooltip-v2-arrow-height`]:`${o}px`,[`--${l}-tooltip-v2-arrow-border-width`]:`${a/2}px`,[`--${l}-tooltip-v2-arrow-cover-width`]:a/2-1,...s||{}}});return(s,a)=>(I(),Z("span",{ref_key:"arrowRef",ref:n,style:pt(v(r)),class:N(v(t).e("arrow"))},null,6))}});var IK=qe(jKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/arrow.vue"]]);const qKe=Ke({style:{type:xe([String,Object,Array]),default:()=>({})}}),KKe=de({name:"ElVisuallyHidden"}),YKe=de({...KKe,props:qKe,setup(i){const e=i,t=R(()=>[e.style,{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}]);return(n,r)=>(I(),Z("span",ci(n.$attrs,{style:v(t)}),[Fe(n.$slots,"default")],16))}});var XKe=qe(YKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/visual-hidden/src/visual-hidden.vue"]]);const ZKe=["data-side"],QKe=de({name:"ElTooltipV2Content"}),JKe=de({...QKe,props:{...tU,...zce},setup(i){const e=i,{triggerRef:t,contentId:n}=ht(D3),r=W(e.placement),s=W(e.strategy),a=W(null),{referenceRef:o,contentRef:l,middlewareData:c,x:u,y:d,update:h}=eke({placement:r,strategy:s,middleware:R(()=>{const w=[BDe(e.offset)];return e.showArrow&&w.push(tke({arrowRef:a})),w})}),p=yg().nextZIndex(),m=Ne("tooltip-v2"),g=R(()=>r.value.split("-")[0]),_=R(()=>({position:v(s),top:`${v(d)||0}px`,left:`${v(u)||0}px`,zIndex:p})),b=R(()=>{if(!e.showArrow)return{};const{arrow:w}=v(c);return{[`--${m.namespace.value}-tooltip-v2-arrow-x`]:`${w==null?void 0:w.x}px`||"",[`--${m.namespace.value}-tooltip-v2-arrow-y`]:`${w==null?void 0:w.y}px`||""}}),x=R(()=>[m.e("content"),m.is("dark",e.effect==="dark"),m.is(v(s)),e.contentClass]);return Ve(a,()=>h()),Ve(()=>e.placement,w=>r.value=w),qt(()=>{Ve(()=>e.reference||t.value,w=>{o.value=w||void 0},{immediate:!0})}),pi(Uae,{arrowRef:a}),(w,C)=>(I(),Z("div",{ref_key:"contentRef",ref:l,style:pt(v(_)),"data-tooltip-v2-root":""},[w.nowrap?_e("v-if",!0):(I(),Z("div",{key:0,"data-side":v(g),class:N(v(x))},[Fe(w.$slots,"default",{contentStyle:v(_),contentClass:v(x)}),re(v(XKe),{id:v(n),role:"tooltip"},{default:pe(()=>[w.ariaLabel?(I(),Z(gt,{key:0},[Gi(We(w.ariaLabel),1)],64)):Fe(w.$slots,"default",{key:1})]),_:3},8,["id"]),Fe(w.$slots,"arrow",{style:pt(v(b)),side:v(g)})],10,ZKe))],4))}});var $K=qe(JKe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/content.vue"]]);const eYe=Ke({setRef:{type:xe(Function),required:!0},onlyChild:Boolean});var tYe=de({props:eYe,setup(i,{slots:e}){const t=W(),n=P3(t,r=>{r?i.setRef(r.nextElementSibling):i.setRef(null)});return()=>{var r;const[s]=((r=e.default)==null?void 0:r.call(e))||[],a=i.onlyChild?o3e(s.children):s.children;return re(gt,{ref:n},[a])}}});const iYe=de({name:"ElTooltipV2Trigger"}),nYe=de({...iYe,props:{...zce,...nU},setup(i){const e=i,{onClose:t,onOpen:n,onDelayOpen:r,triggerRef:s,contentId:a}=ht(D3);let o=!1;const l=x=>{s.value=x},c=()=>{o=!1},u=Hr(e.onMouseEnter,r),d=Hr(e.onMouseLeave,t),h=Hr(e.onMouseDown,()=>{t(),o=!0,document.addEventListener("mouseup",c,{once:!0})}),p=Hr(e.onFocus,()=>{o||n()}),m=Hr(e.onBlur,t),g=Hr(e.onClick,x=>{x.detail===0&&t()}),_={blur:m,click:g,focus:p,mousedown:h,mouseenter:u,mouseleave:d},b=(x,w,C)=>{x&&Object.entries(w).forEach(([S,E])=>{x[C](S,E)})};return Ve(s,(x,w)=>{b(x,_,"addEventListener"),b(w,_,"removeEventListener"),x&&x.setAttribute("aria-describedby",a.value)}),Vr(()=>{b(s.value,_,"removeEventListener"),document.removeEventListener("mouseup",c)}),(x,w)=>x.nowrap?(I(),Se(v(tYe),{key:0,"set-ref":l,"only-child":""},{default:pe(()=>[Fe(x.$slots,"default")]),_:3})):(I(),Z("button",ci({key:1,ref_key:"triggerRef",ref:s},x.$attrs),[Fe(x.$slots,"default")],16))}});var rYe=qe(nYe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/trigger.vue"]]);const sYe=de({name:"ElTooltipV2"}),aYe=de({...sYe,props:zKe,setup(i){const t=_a(i),n=Ji(Am(t,Object.keys(eU))),r=Ji(Am(t,Object.keys(tU))),s=Ji(Am(t,Object.keys(iU))),a=Ji(Am(t,Object.keys(nU)));return(o,l)=>(I(),Se(GKe,mh(v3(s)),{default:pe(({open:c})=>[re(rYe,ci(a,{nowrap:""}),{default:pe(()=>[Fe(o.$slots,"trigger")]),_:3},16),(I(),Se(QA,{to:o.to,disabled:!o.teleported},[o.fullTransition?(I(),Se(Ss,mh(ci({key:0},o.transitionProps)),{default:pe(()=>[o.alwaysOn||c?(I(),Se($K,mh(ci({key:0},r)),{arrow:pe(({style:u,side:d})=>[o.showArrow?(I(),Se(IK,ci({key:0},n,{style:u,side:d}),null,16,["style","side"])):_e("v-if",!0)]),default:pe(()=>[Fe(o.$slots,"default")]),_:3},16)):_e("v-if",!0)]),_:2},1040)):(I(),Z(gt,{key:1},[o.alwaysOn||c?(I(),Se($K,mh(ci({key:0},r)),{arrow:pe(({style:u,side:d})=>[o.showArrow?(I(),Se(IK,ci({key:0},n,{style:u,side:d}),null,16,["style","side"])):_e("v-if",!0)]),default:pe(()=>[Fe(o.$slots,"default")]),_:3},16)):_e("v-if",!0)],64))],8,["to","disabled"]))]),_:3},16))}});var oYe=qe(aYe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tooltip-v2/src/tooltip.vue"]]);const lYe=ii(oYe),Hce="left-check-change",Gce="right-check-change",tw=Ke({data:{type:xe(Array),default:()=>[]},titles:{type:xe(Array),default:()=>[]},buttonTexts:{type:xe(Array),default:()=>[]},filterPlaceholder:String,filterMethod:{type:xe(Function)},leftDefaultChecked:{type:xe(Array),default:()=>[]},rightDefaultChecked:{type:xe(Array),default:()=>[]},renderContent:{type:xe(Function)},modelValue:{type:xe(Array),default:()=>[]},format:{type:xe(Object),default:()=>({})},filterable:Boolean,props:{type:xe(Object),default:()=>Ar({label:"label",key:"key",disabled:"disabled"})},targetOrder:{type:String,values:["original","push","unshift"],default:"original"},validateEvent:{type:Boolean,default:!0}}),TV=(i,e)=>[i,e].every(st)||st(i)&&so(e),cYe={[rr]:(i,e,t)=>[i,t].every(st)&&["left","right"].includes(e),[ri]:i=>st(i),[Hce]:TV,[Gce]:TV},SV="checked-change",uYe=Ke({data:tw.data,optionRender:{type:xe(Function)},placeholder:String,title:String,filterable:Boolean,format:tw.format,filterMethod:tw.filterMethod,defaultChecked:tw.leftDefaultChecked,props:tw.props}),dYe={[SV]:TV},hM=i=>{const e={label:"label",key:"key",disabled:"disabled"};return R(()=>({...e,...i.props}))},hYe=(i,e,t)=>{const n=hM(i),r=R(()=>i.data.filter(u=>Lt(i.filterMethod)?i.filterMethod(e.query,u):String(u[n.value.label]||u[n.value.key]).toLowerCase().includes(e.query.toLowerCase()))),s=R(()=>r.value.filter(u=>!u[n.value.disabled])),a=R(()=>{const u=e.checked.length,d=i.data.length,{noChecked:h,hasChecked:p}=i.format;return h&&p?u>0?p.replace(/\${checked}/g,u.toString()).replace(/\${total}/g,d.toString()):h.replace(/\${total}/g,d.toString()):`${u}/${d}`}),o=R(()=>{const u=e.checked.length;return u>0&&u<s.value.length}),l=()=>{const u=s.value.map(d=>d[n.value.key]);e.allChecked=u.length>0&&u.every(d=>e.checked.includes(d))},c=u=>{e.checked=u?s.value.map(d=>d[n.value.key]):[]};return Ve(()=>e.checked,(u,d)=>{if(l(),e.checkChangeByUser){const h=u.concat(d).filter(p=>!u.includes(p)||!d.includes(p));t(SV,u,h)}else t(SV,u),e.checkChangeByUser=!0}),Ve(s,()=>{l()}),Ve(()=>i.data,()=>{const u=[],d=r.value.map(h=>h[n.value.key]);e.checked.forEach(h=>{d.includes(h)&&u.push(h)}),e.checkChangeByUser=!1,e.checked=u}),Ve(()=>i.defaultChecked,(u,d)=>{if(d&&u.length===d.length&&u.every(m=>d.includes(m)))return;const h=[],p=s.value.map(m=>m[n.value.key]);u.forEach(m=>{p.includes(m)&&h.push(m)}),e.checkChangeByUser=!1,e.checked=h},{immediate:!0}),{filteredData:r,checkableData:s,checkedSummary:a,isIndeterminate:o,updateAllChecked:l,handleAllCheckedChange:c}},pYe=(i,e)=>({onSourceCheckedChange:(r,s)=>{i.leftChecked=r,s&&e(Hce,r,s)},onTargetCheckedChange:(r,s)=>{i.rightChecked=r,s&&e(Gce,r,s)}}),fYe=i=>{const e=hM(i),t=R(()=>i.data.reduce((s,a)=>(s[a[e.value.key]]=a)&&s,{})),n=R(()=>i.data.filter(s=>!i.modelValue.includes(s[e.value.key]))),r=R(()=>i.targetOrder==="original"?i.data.filter(s=>i.modelValue.includes(s[e.value.key])):i.modelValue.reduce((s,a)=>{const o=t.value[a];return o&&s.push(o),s},[]));return{sourceData:n,targetData:r}},mYe=(i,e,t)=>{const n=hM(i),r=(o,l,c)=>{t(ri,o),t(rr,o,l,c)};return{addToLeft:()=>{const o=i.modelValue.slice();e.rightChecked.forEach(l=>{const c=o.indexOf(l);c>-1&&o.splice(c,1)}),r(o,"left",e.rightChecked)},addToRight:()=>{let o=i.modelValue.slice();const l=i.data.filter(c=>{const u=c[n.value.key];return e.leftChecked.includes(u)&&!i.modelValue.includes(u)}).map(c=>c[n.value.key]);o=i.targetOrder==="unshift"?l.concat(o):o.concat(l),i.targetOrder==="original"&&(o=i.data.filter(c=>o.includes(c[n.value.key])).map(c=>c[n.value.key])),r(o,"right",e.leftChecked)}}},gYe=de({name:"ElTransferPanel"}),vYe=de({...gYe,props:uYe,emits:dYe,setup(i,{expose:e,emit:t}){const n=i,r=uo(),s=({option:w})=>w,{t:a}=Ki(),o=Ne("transfer"),l=Ji({checked:[],allChecked:!1,query:"",checkChangeByUser:!0}),c=hM(n),{filteredData:u,checkedSummary:d,isIndeterminate:h,handleAllCheckedChange:p}=hYe(n,l,t),m=R(()=>!pd(l.query)&&pd(u.value)),g=R(()=>!pd(r.default()[0].children)),{checked:_,allChecked:b,query:x}=_a(l);return e({query:x}),(w,C)=>(I(),Z("div",{class:N(v(o).b("panel"))},[Q("p",{class:N(v(o).be("panel","header"))},[re(v(Pd),{modelValue:v(b),"onUpdate:modelValue":C[0]||(C[0]=S=>Vn(b)?b.value=S:null),indeterminate:v(h),"validate-event":!1,onChange:v(p)},{default:pe(()=>[Gi(We(w.title)+" ",1),Q("span",null,We(v(d)),1)]),_:1},8,["modelValue","indeterminate","onChange"])],2),Q("div",{class:N([v(o).be("panel","body"),v(o).is("with-footer",v(g))])},[w.filterable?(I(),Se(v(ol),{key:0,modelValue:v(x),"onUpdate:modelValue":C[1]||(C[1]=S=>Vn(x)?x.value=S:null),class:N(v(o).be("panel","filter")),size:"default",placeholder:w.placeholder,"prefix-icon":v(iLe),clearable:"","validate-event":!1},null,8,["modelValue","class","placeholder","prefix-icon"])):_e("v-if",!0),zt(re(v(ole),{modelValue:v(_),"onUpdate:modelValue":C[2]||(C[2]=S=>Vn(_)?_.value=S:null),"validate-event":!1,class:N([v(o).is("filterable",w.filterable),v(o).be("panel","list")])},{default:pe(()=>[(I(!0),Z(gt,null,xi(v(u),S=>(I(),Se(v(Pd),{key:S[v(c).key],class:N(v(o).be("panel","item")),label:S[v(c).key],disabled:S[v(c).disabled],"validate-event":!1},{default:pe(()=>{var E;return[re(s,{option:(E=w.optionRender)==null?void 0:E.call(w,S)},null,8,["option"])]}),_:2},1032,["class","label","disabled"]))),128))]),_:1},8,["modelValue","class"]),[[Ei,!v(m)&&!v(pd)(w.data)]]),zt(Q("p",{class:N(v(o).be("panel","empty"))},We(v(m)?v(a)("el.transfer.noMatch"):v(a)("el.transfer.noData")),3),[[Ei,v(m)||v(pd)(w.data)]])],2),v(g)?(I(),Z("p",{key:0,class:N(v(o).be("panel","footer"))},[Fe(w.$slots,"default")],2)):_e("v-if",!0)],2))}});var LK=qe(vYe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer-panel.vue"]]);const yYe={key:0},_Ye={key:0},bYe=de({name:"ElTransfer"}),wYe=de({...bYe,props:tw,emits:cYe,setup(i,{expose:e,emit:t}){const n=i,r=uo(),{t:s}=Ki(),a=Ne("transfer"),{formItem:o}=nc(),l=Ji({leftChecked:[],rightChecked:[]}),c=hM(n),{sourceData:u,targetData:d}=fYe(n),{onSourceCheckedChange:h,onTargetCheckedChange:p}=pYe(l,t),{addToLeft:m,addToRight:g}=mYe(n,l,t),_=W(),b=W(),x=P=>{switch(P){case"left":_.value.query="";break;case"right":b.value.query="";break}},w=R(()=>n.buttonTexts.length===2),C=R(()=>n.titles[0]||s("el.transfer.titles.0")),S=R(()=>n.titles[1]||s("el.transfer.titles.1")),E=R(()=>n.filterPlaceholder||s("el.transfer.filterPlaceholder"));Ve(()=>n.modelValue,()=>{var P;n.validateEvent&&((P=o==null?void 0:o.validate)==null||P.call(o,"change").catch(O=>void 0))});const A=R(()=>P=>n.renderContent?n.renderContent(bt,P):r.default?r.default({option:P}):bt("span",P[c.value.label]||P[c.value.key]));return e({clearQuery:x,leftPanel:_,rightPanel:b}),(P,O)=>(I(),Z("div",{class:N(v(a).b())},[re(LK,{ref_key:"leftPanel",ref:_,data:v(u),"option-render":v(A),placeholder:v(E),title:v(C),filterable:P.filterable,format:P.format,"filter-method":P.filterMethod,"default-checked":P.leftDefaultChecked,props:n.props,onCheckedChange:v(h)},{default:pe(()=>[Fe(P.$slots,"left-footer")]),_:3},8,["data","option-render","placeholder","title","filterable","format","filter-method","default-checked","props","onCheckedChange"]),Q("div",{class:N(v(a).e("buttons"))},[re(v(Bo),{type:"primary",class:N([v(a).e("button"),v(a).is("with-texts",v(w))]),disabled:v(pd)(l.rightChecked),onClick:v(m)},{default:pe(()=>[re(v(ct),null,{default:pe(()=>[re(v(Ty))]),_:1}),v(eo)(P.buttonTexts[0])?_e("v-if",!0):(I(),Z("span",yYe,We(P.buttonTexts[0]),1))]),_:1},8,["class","disabled","onClick"]),re(v(Bo),{type:"primary",class:N([v(a).e("button"),v(a).is("with-texts",v(w))]),disabled:v(pd)(l.leftChecked),onClick:v(g)},{default:pe(()=>[v(eo)(P.buttonTexts[1])?_e("v-if",!0):(I(),Z("span",_Ye,We(P.buttonTexts[1]),1)),re(v(ct),null,{default:pe(()=>[re(v(Wl))]),_:1})]),_:1},8,["class","disabled","onClick"])],2),re(LK,{ref_key:"rightPanel",ref:b,data:v(d),"option-render":v(A),placeholder:v(E),filterable:P.filterable,format:P.format,"filter-method":P.filterMethod,title:v(S),"default-checked":P.rightDefaultChecked,props:n.props,onCheckedChange:v(p)},{default:pe(()=>[Fe(P.$slots,"right-footer")]),_:3},8,["data","option-render","placeholder","filterable","format","filter-method","title","default-checked","props","onCheckedChange"])],2))}});var xYe=qe(wYe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/transfer/src/transfer.vue"]]);const CYe=ii(xYe),bx="$treeNodeId",DK=function(i,e){!e||e[bx]||Object.defineProperty(e,bx,{value:i.id,enumerable:!1,configurable:!1,writable:!1})},rU=function(i,e){return i?e[i]:e[bx]},EV=(i,e,t)=>{const n=i.value.currentNode;t();const r=i.value.currentNode;n!==r&&e("current-change",r?r.data:null,r)},AV=i=>{let e=!0,t=!0,n=!0;for(let r=0,s=i.length;r<s;r++){const a=i[r];(a.checked!==!0||a.indeterminate)&&(e=!1,a.disabled||(n=!1)),(a.checked!==!1||a.indeterminate)&&(t=!1)}return{all:e,none:t,allWithoutDisable:n,half:!e&&!t}},$R=function(i){if(i.childNodes.length===0||i.loading)return;const{all:e,none:t,half:n}=AV(i.childNodes);e?(i.checked=!0,i.indeterminate=!1):n?(i.checked=!1,i.indeterminate=!0):t&&(i.checked=!1,i.indeterminate=!1);const r=i.parent;!r||r.level===0||i.store.checkStrictly||$R(r)},aP=function(i,e){const t=i.store.props,n=i.data||{},r=t[e];if(typeof r=="function")return r(n,i);if(typeof r=="string")return n[r];if(typeof r>"u"){const s=n[e];return s===void 0?"":s}};let TYe=0;class U0{constructor(e){this.id=TYe++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const t in e)Ci(e,t)&&(this[t]=e[t]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const e=this.store;if(!e)throw new Error("[Node]store is required!");e.registerNode(this);const t=e.props;if(t&&typeof t.isLeaf<"u"){const s=aP(this,"isLeaf");typeof s=="boolean"&&(this.isLeafByUser=s)}if(e.lazy!==!0&&this.data?(this.setData(this.data),e.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&e.lazy&&e.defaultExpandAll&&this.expand(),Array.isArray(this.data)||DK(this,this.data),!this.data)return;const n=e.defaultExpandedKeys,r=e.key;r&&n&&n.includes(this.key)&&this.expand(null,e.autoExpandParent),r&&e.currentNodeKey!==void 0&&this.key===e.currentNodeKey&&(e.currentNode=this,e.currentNode.isCurrent=!0),e.lazy&&e._initDefaultCheckedNode(this),this.updateLeafState(),this.parent&&(this.level===1||this.parent.expanded===!0)&&(this.canFocus=!0)}setData(e){Array.isArray(e)||DK(this,e),this.data=e,this.childNodes=[];let t;this.level===0&&Array.isArray(this.data)?t=this.data:t=aP(this,"children")||[];for(let n=0,r=t.length;n<r;n++)this.insertChild({data:t[n]})}get label(){return aP(this,"label")}get key(){const e=this.store.key;return this.data?this.data[e]:null}get disabled(){return aP(this,"disabled")}get nextSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return e.childNodes[t+1]}return null}get previousSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return t>0?e.childNodes[t-1]:null}return null}contains(e,t=!0){return(this.childNodes||[]).some(n=>n===e||t&&n.contains(e))}remove(){const e=this.parent;e&&e.removeChild(this)}insertChild(e,t,n){if(!e)throw new Error("InsertChild error: child is required.");if(!(e instanceof U0)){if(!n){const r=this.getChildren(!0);r.includes(e.data)||(typeof t>"u"||t<0?r.push(e.data):r.splice(t,0,e.data))}Object.assign(e,{parent:this,store:this.store}),e=Ji(new U0(e)),e instanceof U0&&e.initialize()}e.level=this.level+1,typeof t>"u"||t<0?this.childNodes.push(e):this.childNodes.splice(t,0,e),this.updateLeafState()}insertBefore(e,t){let n;t&&(n=this.childNodes.indexOf(t)),this.insertChild(e,n)}insertAfter(e,t){let n;t&&(n=this.childNodes.indexOf(t),n!==-1&&(n+=1)),this.insertChild(e,n)}removeChild(e){const t=this.getChildren()||[],n=t.indexOf(e.data);n>-1&&t.splice(n,1);const r=this.childNodes.indexOf(e);r>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(r,1)),this.updateLeafState()}removeChildByData(e){let t=null;for(let n=0;n<this.childNodes.length;n++)if(this.childNodes[n].data===e){t=this.childNodes[n];break}t&&this.removeChild(t)}expand(e,t){const n=()=>{if(t){let r=this.parent;for(;r.level>0;)r.expanded=!0,r=r.parent}this.expanded=!0,e&&e(),this.childNodes.forEach(r=>{r.canFocus=!0})};this.shouldLoadData()?this.loadData(r=>{Array.isArray(r)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||$R(this),n())}):n()}doCreateChildren(e,t={}){e.forEach(n=>{this.insertChild(Object.assign({data:n},t),void 0,!0)})}collapse(){this.expanded=!1,this.childNodes.forEach(e=>{e.canFocus=!1})}shouldLoadData(){return this.store.lazy===!0&&this.store.load&&!this.loaded}updateLeafState(){if(this.store.lazy===!0&&this.loaded!==!0&&typeof this.isLeafByUser<"u"){this.isLeaf=this.isLeafByUser;return}const e=this.childNodes;if(!this.store.lazy||this.store.lazy===!0&&this.loaded===!0){this.isLeaf=!e||e.length===0;return}this.isLeaf=!1}setChecked(e,t,n,r){if(this.indeterminate=e==="half",this.checked=e===!0,this.store.checkStrictly)return;if(!(this.shouldLoadData()&&!this.store.checkDescendants)){const{all:a,allWithoutDisable:o}=AV(this.childNodes);!this.isLeaf&&!a&&o&&(this.checked=!1,e=!1);const l=()=>{if(t){const c=this.childNodes;for(let h=0,p=c.length;h<p;h++){const m=c[h];r=r||e!==!1;const g=m.disabled?m.checked:r;m.setChecked(g,t,!0,r)}const{half:u,all:d}=AV(c);d||(this.checked=d,this.indeterminate=u)}};if(this.shouldLoadData()){this.loadData(()=>{l(),$R(this)},{checked:e!==!1});return}else l()}const s=this.parent;!s||s.level===0||n||$R(s)}getChildren(e=!1){if(this.level===0)return this.data;const t=this.data;if(!t)return null;const n=this.store.props;let r="children";return n&&(r=n.children||"children"),t[r]===void 0&&(t[r]=null),e&&!t[r]&&(t[r]=[]),t[r]}updateChildren(){const e=this.getChildren()||[],t=this.childNodes.map(s=>s.data),n={},r=[];e.forEach((s,a)=>{const o=s[bx];!!o&&t.findIndex(c=>c[bx]===o)>=0?n[o]={index:a,data:s}:r.push({index:a,data:s})}),this.store.lazy||t.forEach(s=>{n[s[bx]]||this.removeChildByData(s)}),r.forEach(({index:s,data:a})=>{this.insertChild({data:a},s)}),this.updateLeafState()}loadData(e,t={}){if(this.store.lazy===!0&&this.store.load&&!this.loaded&&(!this.loading||Object.keys(t).length)){this.loading=!0;const n=r=>{this.childNodes=[],this.doCreateChildren(r,t),this.loaded=!0,this.loading=!1,this.updateLeafState(),e&&e.call(this,r)};this.store.load(this,n)}else e&&e.call(this)}}class SYe{constructor(e){this.currentNode=null,this.currentNodeKey=null;for(const t in e)Ci(e,t)&&(this[t]=e[t]);this.nodesMap={}}initialize(){if(this.root=new U0({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){const e=this.load;e(this.root,t=>{this.root.doCreateChildren(t),this._initDefaultCheckedNodes()})}else this._initDefaultCheckedNodes()}filter(e){const t=this.filterNodeMethod,n=this.lazy,r=function(s){const a=s.root?s.root.childNodes:s.childNodes;if(a.forEach(o=>{o.visible=t.call(o,e,o.data,o),r(o)}),!s.visible&&a.length){let o=!0;o=!a.some(l=>l.visible),s.root?s.root.visible=o===!1:s.visible=o===!1}e&&s.visible&&!s.isLeaf&&!n&&s.expand()};r(this)}setData(e){e!==this.root.data?(this.root.setData(e),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(e){if(e instanceof U0)return e;const t=oi(e)?rU(this.key,e):e;return this.nodesMap[t]||null}insertBefore(e,t){const n=this.getNode(t);n.parent.insertBefore({data:e},n)}insertAfter(e,t){const n=this.getNode(t);n.parent.insertAfter({data:e},n)}remove(e){const t=this.getNode(e);t&&t.parent&&(t===this.currentNode&&(this.currentNode=null),t.parent.removeChild(t))}append(e,t){const n=t?this.getNode(t):this.root;n&&n.insertChild({data:e})}_initDefaultCheckedNodes(){const e=this.defaultCheckedKeys||[],t=this.nodesMap;e.forEach(n=>{const r=t[n];r&&r.setChecked(!0,!this.checkStrictly)})}_initDefaultCheckedNode(e){(this.defaultCheckedKeys||[]).includes(e.key)&&e.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}registerNode(e){const t=this.key;!e||!e.data||(t?e.key!==void 0&&(this.nodesMap[e.key]=e):this.nodesMap[e.id]=e)}deregisterNode(e){!this.key||!e||!e.data||(e.childNodes.forEach(n=>{this.deregisterNode(n)}),delete this.nodesMap[e.key])}getCheckedNodes(e=!1,t=!1){const n=[],r=function(s){(s.root?s.root.childNodes:s.childNodes).forEach(o=>{(o.checked||t&&o.indeterminate)&&(!e||e&&o.isLeaf)&&n.push(o.data),r(o)})};return r(this),n}getCheckedKeys(e=!1){return this.getCheckedNodes(e).map(t=>(t||{})[this.key])}getHalfCheckedNodes(){const e=[],t=function(n){(n.root?n.root.childNodes:n.childNodes).forEach(s=>{s.indeterminate&&e.push(s.data),t(s)})};return t(this),e}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map(e=>(e||{})[this.key])}_getAllNodes(){const e=[],t=this.nodesMap;for(const n in t)Ci(t,n)&&e.push(t[n]);return e}updateChildren(e,t){const n=this.nodesMap[e];if(!n)return;const r=n.childNodes;for(let s=r.length-1;s>=0;s--){const a=r[s];this.remove(a.data)}for(let s=0,a=t.length;s<a;s++){const o=t[s];this.append(o,n.data)}}_setCheckedKeys(e,t=!1,n){const r=this._getAllNodes().sort((o,l)=>l.level-o.level),s=Object.create(null),a=Object.keys(n);r.forEach(o=>o.setChecked(!1,!1));for(let o=0,l=r.length;o<l;o++){const c=r[o],u=c.data[e].toString();if(!a.includes(u)){c.checked&&!s[u]&&c.setChecked(!1,!1);continue}let h=c.parent;for(;h&&h.level>0;)s[h.data[e]]=!0,h=h.parent;if(c.isLeaf||this.checkStrictly){c.setChecked(!0,!1);continue}if(c.setChecked(!0,!0),t){c.setChecked(!1,!1);const p=function(m){m.childNodes.forEach(_=>{_.isLeaf||_.setChecked(!1,!1),p(_)})};p(c)}}}setCheckedNodes(e,t=!1){const n=this.key,r={};e.forEach(s=>{r[(s||{})[n]]=!0}),this._setCheckedKeys(n,t,r)}setCheckedKeys(e,t=!1){this.defaultCheckedKeys=e;const n=this.key,r={};e.forEach(s=>{r[s]=!0}),this._setCheckedKeys(n,t,r)}setDefaultExpandedKeys(e){e=e||[],this.defaultExpandedKeys=e,e.forEach(t=>{const n=this.getNode(t);n&&n.expand(null,this.autoExpandParent)})}setChecked(e,t,n){const r=this.getNode(e);r&&r.setChecked(!!t,n)}getCurrentNode(){return this.currentNode}setCurrentNode(e){const t=this.currentNode;t&&(t.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}setUserCurrentNode(e,t=!0){const n=e[this.key],r=this.nodesMap[n];this.setCurrentNode(r),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(e,t=!0){if(e==null){this.currentNode&&(this.currentNode.isCurrent=!1),this.currentNode=null;return}const n=this.getNode(e);n&&(this.setCurrentNode(n),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}const EYe=de({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(i){const e=Ne("tree"),t=ht("NodeInstance"),n=ht("RootTree");return()=>{const r=i.node,{data:s,store:a}=r;return i.renderContent?i.renderContent(bt,{_self:t,node:r,data:s,store:a}):n.ctx.slots.default?n.ctx.slots.default({node:r,data:s}):bt("span",{class:e.be("node","label")},[r.label])}}});var AYe=qe(EYe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node-content.vue"]]);function Wce(i){const e=ht("TreeNodeMap",null),t={treeNodeExpand:n=>{i.node!==n&&i.node.collapse()},children:[]};return e&&e.children.push(t),pi("TreeNodeMap",t),{broadcastExpanded:n=>{if(i.accordion)for(const r of t.children)r.treeNodeExpand(n)}}}const jce=Symbol("dragEvents");function MYe({props:i,ctx:e,el$:t,dropIndicator$:n,store:r}){const s=Ne("tree"),a=W({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return pi(jce,{treeNodeDragStart:({event:u,treeNode:d})=>{if(typeof i.allowDrag=="function"&&!i.allowDrag(d.node))return u.preventDefault(),!1;u.dataTransfer.effectAllowed="move";try{u.dataTransfer.setData("text/plain","")}catch{}a.value.draggingNode=d,e.emit("node-drag-start",d.node,u)},treeNodeDragOver:({event:u,treeNode:d})=>{const h=d,p=a.value.dropNode;p&&p!==h&&Lc(p.$el,s.is("drop-inner"));const m=a.value.draggingNode;if(!m||!h)return;let g=!0,_=!0,b=!0,x=!0;typeof i.allowDrop=="function"&&(g=i.allowDrop(m.node,h.node,"prev"),x=_=i.allowDrop(m.node,h.node,"inner"),b=i.allowDrop(m.node,h.node,"next")),u.dataTransfer.dropEffect=_||g||b?"move":"none",(g||_||b)&&p!==h&&(p&&e.emit("node-drag-leave",m.node,p.node,u),e.emit("node-drag-enter",m.node,h.node,u)),(g||_||b)&&(a.value.dropNode=h),h.node.nextSibling===m.node&&(b=!1),h.node.previousSibling===m.node&&(g=!1),h.node.contains(m.node,!1)&&(_=!1),(m.node===h.node||m.node.contains(h.node))&&(g=!1,_=!1,b=!1);const w=h.$el.getBoundingClientRect(),C=t.value.getBoundingClientRect();let S;const E=g?_?.25:b?.45:1:-1,A=b?_?.75:g?.55:0:1;let P=-9999;const O=u.clientY-w.top;O<w.height*E?S="before":O>w.height*A?S="after":_?S="inner":S="none";const M=h.$el.querySelector(`.${s.be("node","expand-icon")}`).getBoundingClientRect(),V=n.value;S==="before"?P=M.top-C.top:S==="after"&&(P=M.bottom-C.top),V.style.top=`${P}px`,V.style.left=`${M.right-C.left}px`,S==="inner"?kp(h.$el,s.is("drop-inner")):Lc(h.$el,s.is("drop-inner")),a.value.showDropIndicator=S==="before"||S==="after",a.value.allowDrop=a.value.showDropIndicator||x,a.value.dropType=S,e.emit("node-drag-over",m.node,h.node,u)},treeNodeDragEnd:u=>{const{draggingNode:d,dropType:h,dropNode:p}=a.value;if(u.preventDefault(),u.dataTransfer.dropEffect="move",d&&p){const m={data:d.node.data};h!=="none"&&d.node.remove(),h==="before"?p.node.parent.insertBefore(m,p.node):h==="after"?p.node.parent.insertAfter(m,p.node):h==="inner"&&p.node.insertChild(m),h!=="none"&&r.value.registerNode(m),Lc(p.$el,s.is("drop-inner")),e.emit("node-drag-end",d.node,p.node,h,u),h!=="none"&&e.emit("node-drop",d.node,p.node,h,u)}d&&!p&&e.emit("node-drag-end",d.node,null,h,u),a.value.showDropIndicator=!1,a.value.draggingNode=null,a.value.dropNode=null,a.value.allowDrop=!0}}),{dragState:a}}const PYe=de({name:"ElTreeNode",components:{ElCollapseTransition:U3,ElCheckbox:Pd,NodeContent:AYe,ElIcon:ct,Loading:Vy},props:{node:{type:U0,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(i,e){const t=Ne("tree"),{broadcastExpanded:n}=Wce(i),r=ht("RootTree"),s=W(!1),a=W(!1),o=W(null),l=W(null),c=W(null),u=ht(jce),d=ti();pi("NodeInstance",d),i.node.expanded&&(s.value=!0,a.value=!0);const h=r.props.children||"children";Ve(()=>{const O=i.node.data[h];return O&&[...O]},()=>{i.node.updateChildren()}),Ve(()=>i.node.indeterminate,O=>{g(i.node.checked,O)}),Ve(()=>i.node.checked,O=>{g(O,i.node.indeterminate)}),Ve(()=>i.node.expanded,O=>{ut(()=>s.value=O),O&&(a.value=!0)});const p=O=>rU(r.props.nodeKey,O.data),m=O=>{const M=i.props.class;if(!M)return{};let V;if(Lt(M)){const{data:L}=O;V=M(L,O)}else V=M;return Ft(V)?{[V]:!0}:V},g=(O,M)=>{(o.value!==O||l.value!==M)&&r.ctx.emit("check-change",i.node.data,O,M),o.value=O,l.value=M},_=O=>{EV(r.store,r.ctx.emit,()=>r.store.value.setCurrentNode(i.node)),r.currentNode.value=i.node,r.props.expandOnClickNode&&x(),r.props.checkOnClickNode&&!i.node.disabled&&w(null,{target:{checked:!i.node.checked}}),r.ctx.emit("node-click",i.node.data,i.node,d,O)},b=O=>{r.instance.vnode.props.onNodeContextmenu&&(O.stopPropagation(),O.preventDefault()),r.ctx.emit("node-contextmenu",O,i.node.data,i.node,d)},x=()=>{i.node.isLeaf||(s.value?(r.ctx.emit("node-collapse",i.node.data,i.node,d),i.node.collapse()):(i.node.expand(),e.emit("node-expand",i.node.data,i.node,d)))},w=(O,M)=>{i.node.setChecked(M.target.checked,!r.props.checkStrictly),ut(()=>{const V=r.store.value;r.ctx.emit("check",i.node.data,{checkedNodes:V.getCheckedNodes(),checkedKeys:V.getCheckedKeys(),halfCheckedNodes:V.getHalfCheckedNodes(),halfCheckedKeys:V.getHalfCheckedKeys()})})};return{ns:t,node$:c,tree:r,expanded:s,childNodeRendered:a,oldChecked:o,oldIndeterminate:l,getNodeKey:p,getNodeClass:m,handleSelectChange:g,handleClick:_,handleContextMenu:b,handleExpandIconClick:x,handleCheckChange:w,handleChildNodeExpand:(O,M,V)=>{n(M),r.ctx.emit("node-expand",O,M,V)},handleDragStart:O=>{r.props.draggable&&u.treeNodeDragStart({event:O,treeNode:i})},handleDragOver:O=>{O.preventDefault(),r.props.draggable&&u.treeNodeDragOver({event:O,treeNode:{$el:c.value,node:i.node}})},handleDrop:O=>{O.preventDefault()},handleDragEnd:O=>{r.props.draggable&&u.treeNodeDragEnd(O)},CaretRight:bae}}}),OYe=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],RYe=["aria-expanded"];function IYe(i,e,t,n,r,s){const a=jt("el-icon"),o=jt("el-checkbox"),l=jt("loading"),c=jt("node-content"),u=jt("el-tree-node"),d=jt("el-collapse-transition");return zt((I(),Z("div",{ref:"node$",class:N([i.ns.b("node"),i.ns.is("expanded",i.expanded),i.ns.is("current",i.node.isCurrent),i.ns.is("hidden",!i.node.visible),i.ns.is("focusable",!i.node.disabled),i.ns.is("checked",!i.node.disabled&&i.node.checked),i.getNodeClass(i.node)]),role:"treeitem",tabindex:"-1","aria-expanded":i.expanded,"aria-disabled":i.node.disabled,"aria-checked":i.node.checked,draggable:i.tree.props.draggable,"data-key":i.getNodeKey(i.node),onClick:e[1]||(e[1]=Dt((...h)=>i.handleClick&&i.handleClick(...h),["stop"])),onContextmenu:e[2]||(e[2]=(...h)=>i.handleContextMenu&&i.handleContextMenu(...h)),onDragstart:e[3]||(e[3]=Dt((...h)=>i.handleDragStart&&i.handleDragStart(...h),["stop"])),onDragover:e[4]||(e[4]=Dt((...h)=>i.handleDragOver&&i.handleDragOver(...h),["stop"])),onDragend:e[5]||(e[5]=Dt((...h)=>i.handleDragEnd&&i.handleDragEnd(...h),["stop"])),onDrop:e[6]||(e[6]=Dt((...h)=>i.handleDrop&&i.handleDrop(...h),["stop"]))},[Q("div",{class:N(i.ns.be("node","content")),style:pt({paddingLeft:(i.node.level-1)*i.tree.props.indent+"px"})},[i.tree.props.icon||i.CaretRight?(I(),Se(a,{key:0,class:N([i.ns.be("node","expand-icon"),i.ns.is("leaf",i.node.isLeaf),{expanded:!i.node.isLeaf&&i.expanded}]),onClick:Dt(i.handleExpandIconClick,["stop"])},{default:pe(()=>[(I(),Se(hi(i.tree.props.icon||i.CaretRight)))]),_:1},8,["class","onClick"])):_e("v-if",!0),i.showCheckbox?(I(),Se(o,{key:1,"model-value":i.node.checked,indeterminate:i.node.indeterminate,disabled:!!i.node.disabled,onClick:e[0]||(e[0]=Dt(()=>{},["stop"])),onChange:i.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):_e("v-if",!0),i.node.loading?(I(),Se(a,{key:2,class:N([i.ns.be("node","loading-icon"),i.ns.is("loading")])},{default:pe(()=>[re(l)]),_:1},8,["class"])):_e("v-if",!0),re(c,{node:i.node,"render-content":i.renderContent},null,8,["node","render-content"])],6),re(d,null,{default:pe(()=>[!i.renderAfterExpand||i.childNodeRendered?zt((I(),Z("div",{key:0,class:N(i.ns.be("node","children")),role:"group","aria-expanded":i.expanded},[(I(!0),Z(gt,null,xi(i.node.childNodes,h=>(I(),Se(u,{key:i.getNodeKey(h),"render-content":i.renderContent,"render-after-expand":i.renderAfterExpand,"show-checkbox":i.showCheckbox,node:h,accordion:i.accordion,props:i.props,onNodeExpand:i.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"]))),128))],10,RYe)),[[Ei,i.expanded]]):_e("v-if",!0)]),_:1})],42,OYe)),[[Ei,i.node.visible]])}var $Ye=qe(PYe,[["render",IYe],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree-node.vue"]]);function LYe({el$:i},e){const t=Ne("tree"),n=nr([]),r=nr([]);qt(()=>{a()}),pg(()=>{n.value=Array.from(i.value.querySelectorAll("[role=treeitem]")),r.value=Array.from(i.value.querySelectorAll("input[type=checkbox]"))}),Ve(r,o=>{o.forEach(l=>{l.setAttribute("tabindex","-1")})}),mr(i,"keydown",o=>{const l=o.target;if(!l.className.includes(t.b("node")))return;const c=o.code;n.value=Array.from(i.value.querySelectorAll(`.${t.is("focusable")}[role=treeitem]`));const u=n.value.indexOf(l);let d;if([wt.up,wt.down].includes(c)){if(o.preventDefault(),c===wt.up){d=u===-1?0:u!==0?u-1:n.value.length-1;const p=d;for(;!e.value.getNode(n.value[d].dataset.key).canFocus;){if(d--,d===p){d=-1;break}d<0&&(d=n.value.length-1)}}else{d=u===-1?0:u<n.value.length-1?u+1:0;const p=d;for(;!e.value.getNode(n.value[d].dataset.key).canFocus;){if(d++,d===p){d=-1;break}d>=n.value.length&&(d=0)}}d!==-1&&n.value[d].focus()}[wt.left,wt.right].includes(c)&&(o.preventDefault(),l.click());const h=l.querySelector('[type="checkbox"]');[wt.enter,wt.space].includes(c)&&h&&(o.preventDefault(),h.click())});const a=()=>{var o;n.value=Array.from(i.value.querySelectorAll(`.${t.is("focusable")}[role=treeitem]`)),r.value=Array.from(i.value.querySelectorAll("input[type=checkbox]"));const l=i.value.querySelectorAll(`.${t.is("checked")}[role=treeitem]`);if(l.length){l[0].setAttribute("tabindex","0");return}(o=n.value[0])==null||o.setAttribute("tabindex","0")}}const DYe=de({name:"ElTree",components:{ElTreeNode:$Ye},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Zn}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(i,e){const{t}=Ki(),n=Ne("tree"),r=W(new SYe({key:i.nodeKey,data:i.data,lazy:i.lazy,props:i.props,load:i.load,currentNodeKey:i.currentNodeKey,checkStrictly:i.checkStrictly,checkDescendants:i.checkDescendants,defaultCheckedKeys:i.defaultCheckedKeys,defaultExpandedKeys:i.defaultExpandedKeys,autoExpandParent:i.autoExpandParent,defaultExpandAll:i.defaultExpandAll,filterNodeMethod:i.filterNodeMethod}));r.value.initialize();const s=W(r.value.root),a=W(null),o=W(null),l=W(null),{broadcastExpanded:c}=Wce(i),{dragState:u}=MYe({props:i,ctx:e,el$:o,dropIndicator$:l,store:r});LYe({el$:o},r);const d=R(()=>{const{childNodes:D}=s.value;return!D||D.length===0||D.every(({visible:$})=>!$)});Ve(()=>i.currentNodeKey,D=>{r.value.setCurrentNodeKey(D)}),Ve(()=>i.defaultCheckedKeys,D=>{r.value.setDefaultCheckedKey(D)}),Ve(()=>i.defaultExpandedKeys,D=>{r.value.setDefaultExpandedKeys(D)}),Ve(()=>i.data,D=>{r.value.setData(D)},{deep:!0}),Ve(()=>i.checkStrictly,D=>{r.value.checkStrictly=D});const h=D=>{if(!i.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");r.value.filter(D)},p=D=>rU(i.nodeKey,D.data),m=D=>{if(!i.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const $=r.value.getNode(D);if(!$)return[];const F=[$.data];let Y=$.parent;for(;Y&&Y!==s.value;)F.push(Y.data),Y=Y.parent;return F.reverse()},g=(D,$)=>r.value.getCheckedNodes(D,$),_=D=>r.value.getCheckedKeys(D),b=()=>{const D=r.value.getCurrentNode();return D?D.data:null},x=()=>{if(!i.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const D=b();return D?D[i.nodeKey]:null},w=(D,$)=>{if(!i.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");r.value.setCheckedNodes(D,$)},C=(D,$)=>{if(!i.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");r.value.setCheckedKeys(D,$)},S=(D,$,F)=>{r.value.setChecked(D,$,F)},E=()=>r.value.getHalfCheckedNodes(),A=()=>r.value.getHalfCheckedKeys(),P=(D,$=!0)=>{if(!i.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");EV(r,e.emit,()=>r.value.setUserCurrentNode(D,$))},O=(D,$=!0)=>{if(!i.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");EV(r,e.emit,()=>r.value.setCurrentNodeKey(D,$))},M=D=>r.value.getNode(D),V=D=>{r.value.remove(D)},L=(D,$)=>{r.value.append(D,$)},U=(D,$)=>{r.value.insertBefore(D,$)},G=(D,$)=>{r.value.insertAfter(D,$)},H=(D,$,F)=>{c($),e.emit("node-expand",D,$,F)},k=(D,$)=>{if(!i.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");r.value.updateChildren(D,$)};return pi("RootTree",{ctx:e,props:i,store:r,root:s,currentNode:a,instance:ti()}),pi(uf,void 0),{ns:n,store:r,root:s,currentNode:a,dragState:u,el$:o,dropIndicator$:l,isEmpty:d,filter:h,getNodeKey:p,getNodePath:m,getCheckedNodes:g,getCheckedKeys:_,getCurrentNode:b,getCurrentKey:x,setCheckedNodes:w,setCheckedKeys:C,setChecked:S,getHalfCheckedNodes:E,getHalfCheckedKeys:A,setCurrentNode:P,setCurrentKey:O,t,getNode:M,remove:V,append:L,insertBefore:U,insertAfter:G,handleNodeExpand:H,updateKeyChildren:k}}});function kYe(i,e,t,n,r,s){var a;const o=jt("el-tree-node");return I(),Z("div",{ref:"el$",class:N([i.ns.b(),i.ns.is("dragging",!!i.dragState.draggingNode),i.ns.is("drop-not-allow",!i.dragState.allowDrop),i.ns.is("drop-inner",i.dragState.dropType==="inner"),{[i.ns.m("highlight-current")]:i.highlightCurrent}]),role:"tree"},[(I(!0),Z(gt,null,xi(i.root.childNodes,l=>(I(),Se(o,{key:i.getNodeKey(l),node:l,props:i.props,accordion:i.accordion,"render-after-expand":i.renderAfterExpand,"show-checkbox":i.showCheckbox,"render-content":i.renderContent,onNodeExpand:i.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"]))),128)),i.isEmpty?(I(),Z("div",{key:0,class:N(i.ns.e("empty-block"))},[Q("span",{class:N(i.ns.e("empty-text"))},We((a=i.emptyText)!=null?a:i.t("el.tree.emptyText")),3)],2)):_e("v-if",!0),zt(Q("div",{ref:"dropIndicator$",class:N(i.ns.e("drop-indicator"))},null,2),[[Ei,i.dragState.showDropIndicator]])],2)}var LR=qe(DYe,[["render",kYe],["__file","/home/runner/work/element-plus/element-plus/packages/components/tree/src/tree.vue"]]);LR.install=i=>{i.component(LR.name,LR)};const x$=LR,FYe=x$,NYe=(i,{attrs:e},{tree:t,key:n})=>{const r=Ne("tree-select"),s={...Am(_a(i),Object.keys(lb.props)),...e,valueKey:n,popperClass:R(()=>{const a=[r.e("popper")];return i.popperClass&&a.push(i.popperClass),a.join(" ")}),filterMethod:(a="")=>{i.filterMethod&&i.filterMethod(a),ut(()=>{var o;(o=t.value)==null||o.filter(a)})},onVisibleChange:a=>{var o;(o=e.onVisibleChange)==null||o.call(e,a),i.filterable&&a&&s.filterMethod()}};return s},VYe=de({extends:f$,setup(i,e){const t=f$.setup(i,e);delete t.selectOptionClick;const n=ti().proxy;return ut(()=>{t.select.cachedOptions.get(n.value)||t.select.onOptionCreate(n)}),t},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function MV(i){return i||i===0}function sU(i){return Array.isArray(i)&&i.length}function Nk(i){return Array.isArray(i)?i:MV(i)?[i]:[]}function DR(i,e,t,n,r){for(let s=0;s<i.length;s++){const a=i[s];if(e(a,s,i,r))return n?n(a,s,i,r):a;{const o=t(a);if(sU(o)){const l=DR(o,e,t,n,a);if(l)return l}}}}function qce(i,e,t,n){for(let r=0;r<i.length;r++){const s=i[r];e(s,r,i,n);const a=t(s);sU(a)&&qce(a,e,t,s)}}const BYe=(i,{attrs:e,slots:t,emit:n},{select:r,tree:s,key:a})=>{Ve(()=>i.modelValue,()=>{i.showCheckbox&&ut(()=>{const d=s.value;d&&!Iu(d.getCheckedKeys(),Nk(i.modelValue))&&d.setCheckedKeys(Nk(i.modelValue))})},{immediate:!0,deep:!0});const o=R(()=>({value:a.value,...i.props})),l=(d,h)=>{var p;const m=o.value[d];return Lt(m)?m(h,(p=s.value)==null?void 0:p.getNode(l("value",h))):h[m]},c=Nk(i.modelValue).map(d=>DR(i.data||[],h=>l("value",h)===d,h=>l("children",h),(h,p,m,g)=>g&&l("value",g))).filter(d=>MV(d)),u=R(()=>{if(!i.renderAfterExpand&&!i.lazy)return[];const d=[];return qce(i.data.concat(i.cacheData),h=>{const p=l("value",h);d.push({value:p,currentLabel:l("label",h),isDisabled:l("disabled",h)})},h=>l("children",h)),d});return{...Am(_a(i),Object.keys(x$.props)),...e,nodeKey:a,expandOnClickNode:R(()=>!i.checkStrictly&&i.expandOnClickNode),defaultExpandedKeys:R(()=>i.defaultExpandedKeys?i.defaultExpandedKeys.concat(c):c),renderContent:(d,{node:h,data:p,store:m})=>d(VYe,{value:l("value",p),label:l("label",p),disabled:l("disabled",p)},i.renderContent?()=>i.renderContent(d,{node:h,data:p,store:m}):t.default?()=>t.default({node:h,data:p,store:m}):void 0),filterNodeMethod:(d,h,p)=>{var m;return i.filterNodeMethod?i.filterNodeMethod(d,h,p):d?(m=l("label",h))==null?void 0:m.includes(d):!0},onNodeClick:(d,h,p)=>{var m,g,_;if((m=e.onNodeClick)==null||m.call(e,d,h,p),!(i.showCheckbox&&i.checkOnClickNode))if(!i.showCheckbox&&(i.checkStrictly||h.isLeaf)){if(!l("disabled",d)){const b=(g=r.value)==null?void 0:g.options.get(l("value",d));(_=r.value)==null||_.handleOptionSelect(b,!0)}}else i.expandOnClickNode&&p.proxy.handleExpandIconClick()},onCheck:(d,h)=>{var p;(p=e.onCheck)==null||p.call(e,d,h);const m=l("value",d);if(i.checkStrictly)n(ri,i.multiple?h.checkedKeys:h.checkedKeys.includes(m)?m:void 0);else if(i.multiple)n(ri,s.value.getCheckedKeys(!0));else{const g=DR([d],x=>!sU(l("children",x))&&!l("disabled",x),x=>l("children",x)),_=g?l("value",g):void 0,b=MV(i.modelValue)&&!!DR([d],x=>l("value",x)===i.modelValue,x=>l("children",x));n(ri,_===i.modelValue||b?void 0:_)}},cacheOptions:u}};var zYe=de({props:{data:{type:Array,default:()=>[]}},setup(i){const e=ht(uM);return Ve(()=>i.data,()=>{i.data.forEach(t=>{e.cachedOptions.has(t.value)||e.cachedOptions.set(t.value,t)}),e.setSelected()},{immediate:!0,deep:!0}),()=>{}}});const UYe=de({name:"ElTreeSelect",inheritAttrs:!1,props:{...lb.props,...x$.props,cacheData:{type:Array,default:()=>[]}},setup(i,e){const{slots:t,expose:n}=e,r=W(),s=W(),a=R(()=>i.nodeKey||i.valueKey||"value"),o=NYe(i,e,{select:r,tree:s,key:a}),{cacheOptions:l,...c}=BYe(i,e,{select:r,tree:s,key:a}),u=Ji({});return n(u),qt(()=>{Object.assign(u,{...Am(s.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"]),...Am(r.value,["focus","blur"])})}),()=>bt(lb,Ji({...o,ref:d=>r.value=d}),{...t,default:()=>[bt(zYe,{data:l.value}),bt(x$,Ji({...c,ref:d=>s.value=d}))]})}});var kR=qe(UYe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-select/src/tree-select.vue"]]);kR.install=i=>{i.component(kR.name,kR)};const HYe=kR,GYe=HYe,aU=Symbol(),WYe={key:-1,level:-1,data:{}};var fS=(i=>(i.KEY="id",i.LABEL="label",i.CHILDREN="children",i.DISABLED="disabled",i))(fS||{}),PV=(i=>(i.ADD="add",i.DELETE="delete",i))(PV||{});const jYe=Ke({data:{type:xe(Array),default:()=>Ar([])},emptyText:{type:String},height:{type:Number,default:200},props:{type:xe(Object),default:()=>Ar({children:"children",label:"label",disabled:"disabled",value:"id"})},highlightCurrent:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},defaultCheckedKeys:{type:xe(Array),default:()=>Ar([])},checkStrictly:{type:Boolean,default:!1},defaultExpandedKeys:{type:xe(Array),default:()=>Ar([])},indent:{type:Number,default:16},icon:{type:Zn},expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:{type:Boolean,default:!1},currentNodeKey:{type:xe([String,Number])},accordion:{type:Boolean,default:!1},filterMethod:{type:xe(Function)},perfMode:{type:Boolean,default:!0}}),qYe=Ke({node:{type:xe(Object),default:()=>Ar(WYe)},expanded:{type:Boolean,default:!1},checked:{type:Boolean,default:!1},indeterminate:{type:Boolean,default:!1},showCheckbox:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},current:{type:Boolean,default:!1},hiddenExpandIcon:{type:Boolean,default:!1}}),KYe=Ke({node:{type:xe(Object),required:!0}}),Kce="node-click",Yce="node-expand",Xce="node-collapse",Zce="current-change",Qce="check",Jce="check-change",eue="node-contextmenu",YYe={[Kce]:(i,e,t)=>i&&e&&t,[Yce]:(i,e)=>i&&e,[Xce]:(i,e)=>i&&e,[Zce]:(i,e)=>i&&e,[Qce]:(i,e)=>i&&e,[Jce]:(i,e)=>i&&typeof e=="boolean",[eue]:(i,e,t)=>i&&e&&t},XYe={click:(i,e)=>!!(i&&e),toggle:i=>!!i,check:(i,e)=>i&&typeof e=="boolean"};function ZYe(i,e){const t=W(new Set),n=W(new Set),{emit:r}=ti();Ve([()=>e.value,()=>i.defaultCheckedKeys],()=>ut(()=>{x(i.defaultCheckedKeys)}),{immediate:!0});const s=()=>{if(!e.value||!i.showCheckbox||i.checkStrictly)return;const{levelTreeNodeMap:w,maxLevel:C}=e.value,S=t.value,E=new Set;for(let A=C-1;A>=1;--A){const P=w.get(A);P&&P.forEach(O=>{const M=O.children;if(M){let V=!0,L=!1;for(const U of M){const G=U.key;if(S.has(G))L=!0;else if(E.has(G)){V=!1,L=!0;break}else V=!1}V?S.add(O.key):L?(E.add(O.key),S.delete(O.key)):(S.delete(O.key),E.delete(O.key))}})}n.value=E},a=w=>t.value.has(w.key),o=w=>n.value.has(w.key),l=(w,C,S=!0)=>{const E=t.value,A=(P,O)=>{E[O?PV.ADD:PV.DELETE](P.key);const M=P.children;!i.checkStrictly&&M&&M.forEach(V=>{V.disabled||A(V,O)})};A(w,C),s(),S&&c(w,C)},c=(w,C)=>{const{checkedNodes:S,checkedKeys:E}=m(),{halfCheckedNodes:A,halfCheckedKeys:P}=g();r(Qce,w.data,{checkedKeys:E,checkedNodes:S,halfCheckedKeys:P,halfCheckedNodes:A}),r(Jce,w.data,C)};function u(w=!1){return m(w).checkedKeys}function d(w=!1){return m(w).checkedNodes}function h(){return g().halfCheckedKeys}function p(){return g().halfCheckedNodes}function m(w=!1){const C=[],S=[];if(e!=null&&e.value&&i.showCheckbox){const{treeNodeMap:E}=e.value;t.value.forEach(A=>{const P=E.get(A);P&&(!w||w&&P.isLeaf)&&(S.push(A),C.push(P.data))})}return{checkedKeys:S,checkedNodes:C}}function g(){const w=[],C=[];if(e!=null&&e.value&&i.showCheckbox){const{treeNodeMap:S}=e.value;n.value.forEach(E=>{const A=S.get(E);A&&(C.push(E),w.push(A.data))})}return{halfCheckedNodes:w,halfCheckedKeys:C}}function _(w){t.value.clear(),n.value.clear(),x(w)}function b(w,C){if(e!=null&&e.value&&i.showCheckbox){const S=e.value.treeNodeMap.get(w);S&&l(S,C,!1)}}function x(w){if(e!=null&&e.value){const{treeNodeMap:C}=e.value;if(i.showCheckbox&&C&&w)for(const S of w){const E=C.get(S);E&&!a(E)&&l(E,!0,!1)}}}return{updateCheckedKeys:s,toggleCheckbox:l,isChecked:a,isIndeterminate:o,getCheckedKeys:u,getCheckedNodes:d,getHalfCheckedKeys:h,getHalfCheckedNodes:p,setChecked:b,setCheckedKeys:_}}function QYe(i,e){const t=W(new Set([])),n=W(new Set([])),r=R(()=>Lt(i.filterMethod));function s(o){var l;if(!r.value)return;const c=new Set,u=n.value,d=t.value,h=[],p=((l=e.value)==null?void 0:l.treeNodes)||[],m=i.filterMethod;d.clear();function g(_){_.forEach(b=>{h.push(b),m!=null&&m(o,b.data)?h.forEach(w=>{c.add(w.key)}):b.isLeaf&&d.add(b.key);const x=b.children;if(x&&g(x),!b.isLeaf){if(!c.has(b.key))d.add(b.key);else if(x){let w=!0;for(const C of x)if(!d.has(C.key)){w=!1;break}w?u.add(b.key):u.delete(b.key)}}h.pop()})}return g(p),c}function a(o){return n.value.has(o.key)}return{hiddenExpandIconKeySet:n,hiddenNodeKeySet:t,doFilter:s,isForceHiddenExpandIcon:a}}function JYe(i,e){const t=W(new Set(i.defaultExpandedKeys)),n=W(),r=nr();Ve(()=>i.currentNodeKey,ae=>{n.value=ae},{immediate:!0}),Ve(()=>i.data,ae=>{Te(ae)},{immediate:!0});const{isIndeterminate:s,isChecked:a,toggleCheckbox:o,getCheckedKeys:l,getCheckedNodes:c,getHalfCheckedKeys:u,getHalfCheckedNodes:d,setChecked:h,setCheckedKeys:p}=ZYe(i,r),{doFilter:m,hiddenNodeKeySet:g,isForceHiddenExpandIcon:_}=QYe(i,r),b=R(()=>{var ae;return((ae=i.props)==null?void 0:ae.value)||fS.KEY}),x=R(()=>{var ae;return((ae=i.props)==null?void 0:ae.children)||fS.CHILDREN}),w=R(()=>{var ae;return((ae=i.props)==null?void 0:ae.disabled)||fS.DISABLED}),C=R(()=>{var ae;return((ae=i.props)==null?void 0:ae.label)||fS.LABEL}),S=R(()=>{const ae=t.value,le=g.value,fe=[],Ue=r.value&&r.value.treeNodes||[];function ie(){const oe=[];for(let we=Ue.length-1;we>=0;--we)oe.push(Ue[we]);for(;oe.length;){const we=oe.pop();if(we&&(le.has(we.key)||fe.push(we),ae.has(we.key))){const Ae=we.children;if(Ae){const Oe=Ae.length;for(let ve=Oe-1;ve>=0;--ve)oe.push(Ae[ve])}}}}return ie(),fe}),E=R(()=>S.value.length>0);function A(ae){const le=new Map,fe=new Map;let Ue=1;function ie(we,Ae=1,Oe=void 0){var ve;const ke=[];for(const be of we){const $e=M(be),Le={level:Ae,key:$e,data:be};Le.label=L(be),Le.parent=Oe;const Ce=O(be);Le.disabled=V(be),Le.isLeaf=!Ce||Ce.length===0,Ce&&Ce.length&&(Le.children=ie(Ce,Ae+1,Le)),ke.push(Le),le.set($e,Le),fe.has(Ae)||fe.set(Ae,[]),(ve=fe.get(Ae))==null||ve.push(Le)}return Ae>Ue&&(Ue=Ae),ke}const oe=ie(ae);return{treeNodeMap:le,levelTreeNodeMap:fe,maxLevel:Ue,treeNodes:oe}}function P(ae){const le=m(ae);le&&(t.value=le)}function O(ae){return ae[x.value]}function M(ae){return ae?ae[b.value]:""}function V(ae){return ae[w.value]}function L(ae){return ae[C.value]}function U(ae){t.value.has(ae.key)?F(ae):$(ae)}function G(ae){t.value=new Set(ae)}function H(ae,le){e(Kce,ae.data,ae,le),k(ae),i.expandOnClickNode&&U(ae),i.showCheckbox&&i.checkOnClickNode&&!ae.disabled&&o(ae,!a(ae),!0)}function k(ae){X(ae)||(n.value=ae.key,e(Zce,ae.data,ae))}function D(ae,le){o(ae,le)}function $(ae){const le=t.value;if(r.value&&i.accordion){const{treeNodeMap:fe}=r.value;le.forEach(Ue=>{const ie=fe.get(Ue);ae&&ae.level===(ie==null?void 0:ie.level)&&le.delete(Ue)})}le.add(ae.key),e(Yce,ae.data,ae)}function F(ae){t.value.delete(ae.key),e(Xce,ae.data,ae)}function Y(ae){return t.value.has(ae.key)}function ne(ae){return!!ae.disabled}function X(ae){const le=n.value;return!!le&&le===ae.key}function J(){var ae,le;if(n.value)return(le=(ae=r.value)==null?void 0:ae.treeNodeMap.get(n.value))==null?void 0:le.data}function he(){return n.value}function ye(ae){n.value=ae}function Te(ae){ut(()=>r.value=A(ae))}function ce(ae){var le;const fe=oi(ae)?M(ae):ae;return(le=r.value)==null?void 0:le.treeNodeMap.get(fe)}return{tree:r,flattenTree:S,isNotEmpty:E,getKey:M,getChildren:O,toggleExpand:U,toggleCheckbox:o,isExpanded:Y,isChecked:a,isIndeterminate:s,isDisabled:ne,isCurrent:X,isForceHiddenExpandIcon:_,handleNodeClick:H,handleNodeCheck:D,getCurrentNode:J,getCurrentKey:he,setCurrentKey:ye,getCheckedKeys:l,getCheckedNodes:c,getHalfCheckedKeys:u,getHalfCheckedNodes:d,setChecked:h,setCheckedKeys:p,filter:P,setData:Te,getNode:ce,expandNode:$,collapseNode:F,setExpandedKeys:G}}var eXe=de({name:"ElTreeNodeContent",props:KYe,setup(i){const e=ht(aU),t=Ne("tree");return()=>{const n=i.node,{data:r}=n;return e!=null&&e.ctx.slots.default?e.ctx.slots.default({node:n,data:r}):bt("span",{class:t.be("node","label")},[n==null?void 0:n.label])}}});const tXe=["aria-expanded","aria-disabled","aria-checked","data-key","onClick"],iXe=de({name:"ElTreeNode"}),nXe=de({...iXe,props:qYe,emits:XYe,setup(i,{emit:e}){const t=i,n=ht(aU),r=Ne("tree"),s=R(()=>{var d;return(d=n==null?void 0:n.props.indent)!=null?d:16}),a=R(()=>{var d;return(d=n==null?void 0:n.props.icon)!=null?d:bae}),o=d=>{e("click",t.node,d)},l=()=>{e("toggle",t.node)},c=d=>{e("check",t.node,d)},u=d=>{var h,p,m,g;(m=(p=(h=n==null?void 0:n.instance)==null?void 0:h.vnode)==null?void 0:p.props)!=null&&m.onNodeContextmenu&&(d.stopPropagation(),d.preventDefault()),n==null||n.ctx.emit(eue,d,(g=t.node)==null?void 0:g.data,t.node)};return(d,h)=>{var p,m,g;return I(),Z("div",{ref:"node$",class:N([v(r).b("node"),v(r).is("expanded",d.expanded),v(r).is("current",d.current),v(r).is("focusable",!d.disabled),v(r).is("checked",!d.disabled&&d.checked)]),role:"treeitem",tabindex:"-1","aria-expanded":d.expanded,"aria-disabled":d.disabled,"aria-checked":d.checked,"data-key":(p=d.node)==null?void 0:p.key,onClick:Dt(o,["stop"]),onContextmenu:u},[Q("div",{class:N(v(r).be("node","content")),style:pt({paddingLeft:`${(d.node.level-1)*v(s)}px`})},[v(a)?(I(),Se(v(ct),{key:0,class:N([v(r).is("leaf",!!((m=d.node)!=null&&m.isLeaf)),v(r).is("hidden",d.hiddenExpandIcon),{expanded:!((g=d.node)!=null&&g.isLeaf)&&d.expanded},v(r).be("node","expand-icon")]),onClick:Dt(l,["stop"])},{default:pe(()=>[(I(),Se(hi(v(a))))]),_:1},8,["class","onClick"])):_e("v-if",!0),d.showCheckbox?(I(),Se(v(Pd),{key:1,"model-value":d.checked,indeterminate:d.indeterminate,disabled:d.disabled,onChange:c,onClick:h[0]||(h[0]=Dt(()=>{},["stop"]))},null,8,["model-value","indeterminate","disabled"])):_e("v-if",!0),re(v(eXe),{node:d.node},null,8,["node"])],6)],42,tXe)}}});var rXe=qe(nXe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-v2/src/tree-node.vue"]]);const sXe=26,aXe=de({name:"ElTreeV2"}),oXe=de({...aXe,props:jYe,emits:YYe,setup(i,{expose:e,emit:t}){const n=i,r=uo();pi(aU,{ctx:{emit:t,slots:r},props:n,instance:ti()}),pi(uf,void 0);const{t:s}=Ki(),a=Ne("tree"),{flattenTree:o,isNotEmpty:l,toggleExpand:c,isExpanded:u,isIndeterminate:d,isChecked:h,isDisabled:p,isCurrent:m,isForceHiddenExpandIcon:g,handleNodeClick:_,handleNodeCheck:b,toggleCheckbox:x,getCurrentNode:w,getCurrentKey:C,setCurrentKey:S,getCheckedKeys:E,getCheckedNodes:A,getHalfCheckedKeys:P,getHalfCheckedNodes:O,setChecked:M,setCheckedKeys:V,filter:L,setData:U,getNode:G,expandNode:H,collapseNode:k,setExpandedKeys:D}=JYe(n,t);return e({toggleCheckbox:x,getCurrentNode:w,getCurrentKey:C,setCurrentKey:S,getCheckedKeys:E,getCheckedNodes:A,getHalfCheckedKeys:P,getHalfCheckedNodes:O,setChecked:M,setCheckedKeys:V,filter:L,setData:U,getNode:G,expandNode:H,collapseNode:k,setExpandedKeys:D}),($,F)=>{var Y;return I(),Z("div",{class:N([v(a).b(),{[v(a).m("highlight-current")]:$.highlightCurrent}]),role:"tree"},[v(l)?(I(),Se(v(lce),{key:0,"class-name":v(a).b("virtual-list"),data:v(o),total:v(o).length,height:$.height,"item-size":sXe,"perf-mode":$.perfMode},{default:pe(({data:ne,index:X,style:J})=>[(I(),Se(rXe,{key:ne[X].key,style:pt(J),node:ne[X],expanded:v(u)(ne[X]),"show-checkbox":$.showCheckbox,checked:v(h)(ne[X]),indeterminate:v(d)(ne[X]),disabled:v(p)(ne[X]),current:v(m)(ne[X]),"hidden-expand-icon":v(g)(ne[X]),onClick:v(_),onToggle:v(c),onCheck:v(b)},null,8,["style","node","expanded","show-checkbox","checked","indeterminate","disabled","current","hidden-expand-icon","onClick","onToggle","onCheck"]))]),_:1},8,["class-name","data","total","height","perf-mode"])):(I(),Z("div",{key:1,class:N(v(a).e("empty-block"))},[Q("span",{class:N(v(a).e("empty-text"))},We((Y=$.emptyText)!=null?Y:v(s)("el.tree.emptyText")),3)],2))],2)}}});var lXe=qe(oXe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/tree-v2/src/tree.vue"]]);const cXe=ii(lXe),uXe="ElUpload";class dXe extends Error{constructor(e,t,n,r){super(e),this.name="UploadAjaxError",this.status=t,this.method=n,this.url=r}}function kK(i,e,t){let n;return t.response?n=`${t.response.error||t.response}`:t.responseText?n=`${t.responseText}`:n=`fail to ${e.method} ${i} ${t.status}`,new dXe(n,t.status,e.method,i)}function hXe(i){const e=i.responseText||i.response;if(!e)return e;try{return JSON.parse(e)}catch{return e}}const pXe=i=>{typeof XMLHttpRequest>"u"&&ba(uXe,"XMLHttpRequest is undefined");const e=new XMLHttpRequest,t=i.action;e.upload&&e.upload.addEventListener("progress",s=>{const a=s;a.percent=s.total>0?s.loaded/s.total*100:0,i.onProgress(a)});const n=new FormData;if(i.data)for(const[s,a]of Object.entries(i.data))Array.isArray(a)?n.append(s,...a):n.append(s,a);n.append(i.filename,i.file,i.file.name),e.addEventListener("error",()=>{i.onError(kK(t,i,e))}),e.addEventListener("load",()=>{if(e.status<200||e.status>=300)return i.onError(kK(t,i,e));i.onSuccess(hXe(e))}),e.open(i.method,t,!0),i.withCredentials&&"withCredentials"in e&&(e.withCredentials=!0);const r=i.headers||{};if(r instanceof Headers)r.forEach((s,a)=>e.setRequestHeader(a,s));else for(const[s,a]of Object.entries(r))so(a)||e.setRequestHeader(s,String(a));return e.send(n),e},tue=["text","picture","picture-card"];let fXe=1;const OV=()=>Date.now()+fXe++,iue=Ke({action:{type:String,default:"#"},headers:{type:xe(Object)},method:{type:String,default:"post"},data:{type:Object,default:()=>Ar({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},type:{type:String,default:"select"},fileList:{type:xe(Array),default:()=>Ar([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:tue,default:"text"},httpRequest:{type:xe(Function),default:pXe},disabled:Boolean,limit:Number}),mXe=Ke({...iue,beforeUpload:{type:xe(Function),default:yn},beforeRemove:{type:xe(Function)},onRemove:{type:xe(Function),default:yn},onChange:{type:xe(Function),default:yn},onPreview:{type:xe(Function),default:yn},onSuccess:{type:xe(Function),default:yn},onProgress:{type:xe(Function),default:yn},onError:{type:xe(Function),default:yn},onExceed:{type:xe(Function),default:yn}}),gXe=Ke({files:{type:xe(Array),default:()=>Ar([])},disabled:{type:Boolean,default:!1},handlePreview:{type:xe(Function),default:yn},listType:{type:String,values:tue,default:"text"}}),vXe={remove:i=>!!i},yXe=["onKeydown"],_Xe=["src"],bXe=["onClick"],wXe=["onClick"],xXe=["onClick"],CXe=de({name:"ElUploadList"}),TXe=de({...CXe,props:gXe,emits:vXe,setup(i,{emit:e}){const{t}=Ki(),n=Ne("upload"),r=Ne("icon"),s=Ne("list"),a=zc(),o=W(!1),l=c=>{e("remove",c)};return(c,u)=>(I(),Se(ITe,{tag:"ul",class:N([v(n).b("list"),v(n).bm("list",c.listType),v(n).is("disabled",v(a))]),name:v(s).b()},{default:pe(()=>[(I(!0),Z(gt,null,xi(c.files,d=>(I(),Z("li",{key:d.uid||d.name,class:N([v(n).be("list","item"),v(n).is(d.status),{focusing:o.value}]),tabindex:"0",onKeydown:Di(h=>!v(a)&&l(d),["delete"]),onFocus:u[0]||(u[0]=h=>o.value=!0),onBlur:u[1]||(u[1]=h=>o.value=!1),onClick:u[2]||(u[2]=h=>o.value=!1)},[Fe(c.$slots,"default",{file:d},()=>[c.listType==="picture"||d.status!=="uploading"&&c.listType==="picture-card"?(I(),Z("img",{key:0,class:N(v(n).be("list","item-thumbnail")),src:d.url,alt:""},null,10,_Xe)):_e("v-if",!0),d.status==="uploading"||c.listType!=="picture-card"?(I(),Z("div",{key:1,class:N(v(n).be("list","item-info"))},[Q("a",{class:N(v(n).be("list","item-name")),onClick:Dt(h=>c.handlePreview(d),["prevent"])},[re(v(ct),{class:N(v(r).m("document"))},{default:pe(()=>[re(v(PIe))]),_:1},8,["class"]),Q("span",{class:N(v(n).be("list","item-file-name"))},We(d.name),3)],10,bXe),d.status==="uploading"?(I(),Se(v(Jle),{key:0,type:c.listType==="picture-card"?"circle":"line","stroke-width":c.listType==="picture-card"?6:2,percentage:Number(d.percentage),style:pt(c.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):_e("v-if",!0)],2)):_e("v-if",!0),Q("label",{class:N(v(n).be("list","item-status-label"))},[c.listType==="text"?(I(),Se(v(ct),{key:0,class:N([v(r).m("upload-success"),v(r).m("circle-check")])},{default:pe(()=>[re(v(n9))]),_:1},8,["class"])):["picture-card","picture"].includes(c.listType)?(I(),Se(v(ct),{key:1,class:N([v(r).m("upload-success"),v(r).m("check")])},{default:pe(()=>[re(v(sM))]),_:1},8,["class"])):_e("v-if",!0)],2),v(a)?_e("v-if",!0):(I(),Se(v(ct),{key:2,class:N(v(r).m("close")),onClick:h=>l(d)},{default:pe(()=>[re(v(Rh))]),_:2},1032,["class","onClick"])),_e(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),_e(" This is a bug which needs to be fixed "),_e(" TODO: Fix the incorrect navigation interaction "),v(a)?_e("v-if",!0):(I(),Z("i",{key:3,class:N(v(r).m("close-tip"))},We(v(t)("el.upload.deleteTip")),3)),c.listType==="picture-card"?(I(),Z("span",{key:4,class:N(v(n).be("list","item-actions"))},[Q("span",{class:N(v(n).be("list","item-preview")),onClick:h=>c.handlePreview(d)},[re(v(ct),{class:N(v(r).m("zoom-in"))},{default:pe(()=>[re(v(Tae))]),_:1},8,["class"])],10,wXe),v(a)?_e("v-if",!0):(I(),Z("span",{key:0,class:N(v(n).be("list","item-delete")),onClick:h=>l(d)},[re(v(ct),{class:N(v(r).m("delete"))},{default:pe(()=>[re(v(CIe))]),_:1},8,["class"])],10,xXe))],2)):_e("v-if",!0)])],42,yXe))),128)),Fe(c.$slots,"append")]),_:3},8,["class","name"]))}});var FK=qe(TXe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-list.vue"]]);const SXe=Ke({disabled:{type:Boolean,default:!1}}),EXe={file:i=>st(i)},AXe=["onDrop","onDragover"],nue="ElUploadDrag",MXe=de({name:nue}),PXe=de({...MXe,props:SXe,emits:EXe,setup(i,{emit:e}){const t=ht(Bae);t||ba(nue,"usage: <el-upload><el-upload-dragger /></el-upload>");const n=Ne("upload"),r=W(!1),s=zc(),a=l=>{if(s.value)return;r.value=!1;const c=Array.from(l.dataTransfer.files),u=t.accept.value;if(!u){e("file",c);return}const d=c.filter(h=>{const{type:p,name:m}=h,g=m.includes(".")?`.${m.split(".").pop()}`:"",_=p.replace(/\/.*$/,"");return u.split(",").map(b=>b.trim()).filter(b=>b).some(b=>b.startsWith(".")?g===b:/\/\*$/.test(b)?_===b.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(b)?p===b:!1)});e("file",d)},o=()=>{s.value||(r.value=!0)};return(l,c)=>(I(),Z("div",{class:N([v(n).b("dragger"),v(n).is("dragover",r.value)]),onDrop:Dt(a,["prevent"]),onDragover:Dt(o,["prevent"]),onDragleave:c[0]||(c[0]=Dt(u=>r.value=!1,["prevent"]))},[Fe(l.$slots,"default")],42,AXe))}});var OXe=qe(PXe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-dragger.vue"]]);const RXe=Ke({...iue,beforeUpload:{type:xe(Function),default:yn},onRemove:{type:xe(Function),default:yn},onStart:{type:xe(Function),default:yn},onSuccess:{type:xe(Function),default:yn},onProgress:{type:xe(Function),default:yn},onError:{type:xe(Function),default:yn},onExceed:{type:xe(Function),default:yn}}),IXe=["onKeydown"],$Xe=["name","multiple","accept"],LXe=de({name:"ElUploadContent",inheritAttrs:!1}),DXe=de({...LXe,props:RXe,setup(i,{expose:e}){const t=i,n=Ne("upload"),r=zc(),s=nr({}),a=nr(),o=m=>{if(m.length===0)return;const{autoUpload:g,limit:_,fileList:b,multiple:x,onStart:w,onExceed:C}=t;if(_&&b.length+m.length>_){C(m,b);return}x||(m=m.slice(0,1));for(const S of m){const E=S;E.uid=OV(),w(E),g&&l(E)}},l=async m=>{if(a.value.value="",!t.beforeUpload)return c(m);let g;try{g=await t.beforeUpload(m)}catch{g=!1}if(g===!1){t.onRemove(m);return}let _=m;g instanceof Blob&&(g instanceof File?_=g:_=new File([g],m.name,{type:m.type})),c(Object.assign(_,{uid:m.uid}))},c=m=>{const{headers:g,data:_,method:b,withCredentials:x,name:w,action:C,onProgress:S,onSuccess:E,onError:A,httpRequest:P}=t,{uid:O}=m,M={headers:g||{},withCredentials:x,file:m,data:_,method:b,filename:w,action:C,onProgress:L=>{S(L,m)},onSuccess:L=>{E(L,m),delete s.value[O]},onError:L=>{A(L,m),delete s.value[O]}},V=P(M);s.value[O]=V,V instanceof Promise&&V.then(M.onSuccess,M.onError)},u=m=>{const g=m.target.files;g&&o(Array.from(g))},d=()=>{r.value||(a.value.value="",a.value.click())},h=()=>{d()};return e({abort:m=>{POe(s.value).filter(m?([_])=>String(m.uid)===_:()=>!0).forEach(([_,b])=>{b instanceof XMLHttpRequest&&b.abort(),delete s.value[_]})},upload:l}),(m,g)=>(I(),Z("div",{class:N([v(n).b(),v(n).m(m.listType),v(n).is("drag",m.drag)]),tabindex:"0",onClick:d,onKeydown:Di(Dt(h,["self"]),["enter","space"])},[m.drag?(I(),Se(OXe,{key:0,disabled:v(r),onFile:o},{default:pe(()=>[Fe(m.$slots,"default")]),_:3},8,["disabled"])):Fe(m.$slots,"default",{key:1}),Q("input",{ref_key:"inputRef",ref:a,class:N(v(n).e("input")),name:m.name,multiple:m.multiple,accept:m.accept,type:"file",onChange:u,onClick:g[0]||(g[0]=Dt(()=>{},["stop"]))},null,42,$Xe)],42,IXe))}});var NK=qe(DXe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload-content.vue"]]);const VK="ElUpload",kXe=i=>{var e;(e=i.url)!=null&&e.startsWith("blob:")&&URL.revokeObjectURL(i.url)},FXe=(i,e)=>{const t=xOe(i,"fileList",void 0,{passive:!0}),n=h=>t.value.find(p=>p.uid===h.uid);function r(h){var p;(p=e.value)==null||p.abort(h)}function s(h=["ready","uploading","success","fail"]){t.value=t.value.filter(p=>!h.includes(p.status))}const a=(h,p)=>{const m=n(p);m&&(console.error(h),m.status="fail",t.value.splice(t.value.indexOf(m),1),i.onError(h,m,t.value),i.onChange(m,t.value))},o=(h,p)=>{const m=n(p);m&&(i.onProgress(h,m,t.value),m.status="uploading",m.percentage=Math.round(h.percent))},l=(h,p)=>{const m=n(p);m&&(m.status="success",m.response=h,i.onSuccess(h,m,t.value),i.onChange(m,t.value))},c=h=>{so(h.uid)&&(h.uid=OV());const p={name:h.name,percentage:0,status:"ready",size:h.size,raw:h,uid:h.uid};if(i.listType==="picture-card"||i.listType==="picture")try{p.url=URL.createObjectURL(h)}catch(m){m.message,i.onError(m,p,t.value)}t.value=[...t.value,p],i.onChange(p,t.value)},u=async h=>{const p=h instanceof File?n(h):h;p||ba(VK,"file to be removed not found");const m=g=>{r(g);const _=t.value;_.splice(_.indexOf(g),1),i.onRemove(g,_),kXe(g)};i.beforeRemove?await i.beforeRemove(p,t.value)!==!1&&m(p):m(p)};function d(){t.value.filter(({status:h})=>h==="ready").forEach(({raw:h})=>{var p;return h&&((p=e.value)==null?void 0:p.upload(h))})}return Ve(()=>i.listType,h=>{h!=="picture-card"&&h!=="picture"||(t.value=t.value.map(p=>{const{raw:m,url:g}=p;if(!g&&m)try{p.url=URL.createObjectURL(m)}catch(_){i.onError(_,p,t.value)}return p}))}),Ve(t,h=>{for(const p of h)p.uid||(p.uid=OV()),p.status||(p.status="success")},{immediate:!0,deep:!0}),{uploadFiles:t,abort:r,clearFiles:s,handleError:a,handleProgress:o,handleStart:c,handleSuccess:l,handleRemove:u,submit:d}},NXe=de({name:"ElUpload"}),VXe=de({...NXe,props:mXe,setup(i,{expose:e}){const t=i,n=uo(),r=zc(),s=nr(),{abort:a,submit:o,clearFiles:l,uploadFiles:c,handleStart:u,handleError:d,handleRemove:h,handleSuccess:p,handleProgress:m}=FXe(t,s),g=R(()=>t.listType==="picture-card"),_=R(()=>({...t,fileList:c.value,onStart:u,onProgress:m,onSuccess:p,onError:d,onRemove:h}));return Vr(()=>{c.value.forEach(({url:b})=>{b!=null&&b.startsWith("blob:")&&URL.revokeObjectURL(b)})}),pi(Bae,{accept:kr(t,"accept")}),e({abort:a,submit:o,clearFiles:l,handleStart:u,handleRemove:h}),(b,x)=>(I(),Z("div",null,[v(g)&&b.showFileList?(I(),Se(FK,{key:0,disabled:v(r),"list-type":b.listType,files:v(c),"handle-preview":b.onPreview,onRemove:v(h)},qm({append:pe(()=>[re(NK,ci({ref_key:"uploadRef",ref:s},v(_)),{default:pe(()=>[v(n).trigger?Fe(b.$slots,"trigger",{key:0}):_e("v-if",!0),!v(n).trigger&&v(n).default?Fe(b.$slots,"default",{key:1}):_e("v-if",!0)]),_:3},16)]),_:2},[b.$slots.file?{name:"default",fn:pe(({file:w})=>[Fe(b.$slots,"file",{file:w})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):_e("v-if",!0),!v(g)||v(g)&&!b.showFileList?(I(),Se(NK,ci({key:1,ref_key:"uploadRef",ref:s},v(_)),{default:pe(()=>[v(n).trigger?Fe(b.$slots,"trigger",{key:0}):_e("v-if",!0),!v(n).trigger&&v(n).default?Fe(b.$slots,"default",{key:1}):_e("v-if",!0)]),_:3},16)):_e("v-if",!0),b.$slots.trigger?Fe(b.$slots,"default",{key:2}):_e("v-if",!0),Fe(b.$slots,"tip"),!v(g)&&b.showFileList?(I(),Se(FK,{key:3,disabled:v(r),"list-type":b.listType,files:v(c),"handle-preview":b.onPreview,onRemove:v(h)},qm({_:2},[b.$slots.file?{name:"default",fn:pe(({file:w})=>[Fe(b.$slots,"file",{file:w})])}:void 0]),1032,["disabled","list-type","files","handle-preview","onRemove"])):_e("v-if",!0)]))}});var BXe=qe(VXe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/upload/src/upload.vue"]]);const zXe=ii(BXe);var UXe=[dke,xke,ZFe,lKe,r4e,d4e,Ioe,T4e,S4e,Bo,Foe,WNe,XNe,u5e,d5e,SVe,dVe,RVe,Pd,R5e,ole,kVe,t6e,i6e,jVe,A6e,O6e,U6e,H6e,G6e,W6e,j6e,sBe,mBe,gBe,OBe,Ile,GBe,Dze,kze,Fze,zle,lUe,cUe,ct,CUe,Gle,ol,Wle,FUe,n7e,r7e,s7e,a7e,p7e,gHe,wHe,OHe,Poe,Jle,ple,q5e,j5e,qHe,QHe,sGe,_g,lb,f$,U7e,YGe,nWe,rWe,LWe,VWe,vce,XWe,sje,aje,vje,Cqe,Tqe,oKe,CKe,TKe,Y2,CNe,OKe,DKe,kKe,Jl,lYe,CYe,FYe,GYe,cXe,zXe];const nh="ElInfiniteScroll",HXe=50,GXe=200,WXe=0,jXe={delay:{type:Number,default:GXe},distance:{type:Number,default:WXe},disabled:{type:Boolean,default:!1},immediate:{type:Boolean,default:!0}},oU=(i,e)=>Object.entries(jXe).reduce((t,[n,r])=>{var s,a;const{type:o,default:l}=r,c=i.getAttribute(`infinite-scroll-${n}`);let u=(a=(s=e[c])!=null?s:c)!=null?a:l;return u=u==="false"?!1:u,u=o(u),t[n]=Number.isNaN(u)?l:u,t},{}),rue=i=>{const{observer:e}=i[nh];e&&(e.disconnect(),delete i[nh].observer)},qXe=(i,e)=>{const{container:t,containerEl:n,instance:r,observer:s,lastScrollTop:a}=i[nh],{disabled:o,distance:l}=oU(i,r),{clientHeight:c,scrollHeight:u,scrollTop:d}=n,h=d-a;if(i[nh].lastScrollTop=d,s||o||h<0)return;let p=!1;if(t===i)p=u-(c+d)<=l;else{const{clientTop:m,scrollHeight:g}=i,_=EOe(i,n);p=d+c>=_+m+g-l}p&&e.call(r)};function Vk(i,e){const{containerEl:t,instance:n}=i[nh],{disabled:r}=oU(i,n);r||t.clientHeight===0||(t.scrollHeight<=t.clientHeight?e.call(n):rue(i))}const KXe={async mounted(i,e){const{instance:t,value:n}=e;Lt(n)||ba(nh,"'v-infinite-scroll' binding value must be a function"),await ut();const{delay:r,immediate:s}=oU(i,t),a=i9(i,!0),o=a===window?document.documentElement:a,l=V0(qXe.bind(null,i,n),r);if(a){if(i[nh]={instance:t,container:a,containerEl:o,delay:r,cb:n,onScroll:l,lastScrollTop:o.scrollTop},s){const c=new MutationObserver(V0(Vk.bind(null,i,n),HXe));i[nh].observer=c,c.observe(i,{childList:!0,subtree:!0}),Vk(i,n)}a.addEventListener("scroll",l)}},unmounted(i){const{container:e,onScroll:t}=i[nh];e==null||e.removeEventListener("scroll",t),rue(i)},async updated(i){i[nh]||await ut();const{containerEl:e,cb:t,observer:n}=i[nh];e.clientHeight&&n&&Vk(i,t)}},RV=KXe;RV.install=i=>{i.directive("InfiniteScroll",RV)};const YXe=RV;function XXe(i){let e;const t=Ne("loading"),n=W(!1),r=Ji({...i,originalPosition:"",originalOverflow:"",visible:!1});function s(p){r.text=p}function a(){const p=r.parent;if(!p.vLoadingAddClassList){let m=p.getAttribute("loading-number");m=Number.parseInt(m)-1,m?p.setAttribute("loading-number",m.toString()):(Lc(p,t.bm("parent","relative")),p.removeAttribute("loading-number")),Lc(p,t.bm("parent","hidden"))}o(),d.unmount()}function o(){var p,m;(m=(p=h.$el)==null?void 0:p.parentNode)==null||m.removeChild(h.$el)}function l(){var p;i.beforeClose&&!i.beforeClose()||(n.value=!0,clearTimeout(e),e=window.setTimeout(c,400),r.visible=!1,(p=i.closed)==null||p.call(i))}function c(){if(!n.value)return;const p=r.parent;n.value=!1,p.vLoadingAddClassList=void 0,a()}const d=Mse({name:"ElLoading",setup(){return()=>{const p=r.spinner||r.svg,m=bt("svg",{class:"circular",viewBox:r.svgViewBox?r.svgViewBox:"0 0 50 50",...p?{innerHTML:p}:{}},[bt("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),g=r.text?bt("p",{class:t.b("text")},[r.text]):void 0;return bt(Ss,{name:t.b("fade"),onAfterLeave:c},{default:pe(()=>[zt(re("div",{style:{backgroundColor:r.background||""},class:[t.b("mask"),r.customClass,r.fullscreen?"is-fullscreen":""]},[bt("div",{class:t.b("spinner")},[m,g])]),[[Ei,r.visible]])])})}}}),h=d.mount(document.createElement("div"));return{..._a(r),setText:s,removeElLoadingChild:o,close:l,handleAfterLeave:c,vm:h,get $el(){return h.$el}}}let oP;const IV=function(i={}){if(!Ii)return;const e=ZXe(i);if(e.fullscreen&&oP)return oP;const t=XXe({...e,closed:()=>{var r;(r=e.closed)==null||r.call(e),e.fullscreen&&(oP=void 0)}});QXe(e,e.parent,t),BK(e,e.parent,t),e.parent.vLoadingAddClassList=()=>BK(e,e.parent,t);let n=e.parent.getAttribute("loading-number");return n?n=`${Number.parseInt(n)+1}`:n="1",e.parent.setAttribute("loading-number",n),e.parent.appendChild(t.$el),ut(()=>t.visible.value=e.visible),e.fullscreen&&(oP=t),t},ZXe=i=>{var e,t,n,r;let s;return Ft(i.target)?s=(e=document.querySelector(i.target))!=null?e:document.body:s=i.target||document.body,{parent:s===document.body||i.body?document.body:s,background:i.background||"",svg:i.svg||"",svgViewBox:i.svgViewBox||"",spinner:i.spinner||!1,text:i.text||"",fullscreen:s===document.body&&((t=i.fullscreen)!=null?t:!0),lock:(n=i.lock)!=null?n:!1,customClass:i.customClass||"",visible:(r=i.visible)!=null?r:!0,target:s}},QXe=async(i,e,t)=>{const{nextZIndex:n}=yg(),r={};if(i.fullscreen)t.originalPosition.value=Cm(document.body,"position"),t.originalOverflow.value=Cm(document.body,"overflow"),r.zIndex=n();else if(i.parent===document.body){t.originalPosition.value=Cm(document.body,"position"),await ut();for(const s of["top","left"]){const a=s==="top"?"scrollTop":"scrollLeft";r[s]=`${i.target.getBoundingClientRect()[s]+document.body[a]+document.documentElement[a]-Number.parseInt(Cm(document.body,`margin-${s}`),10)}px`}for(const s of["height","width"])r[s]=`${i.target.getBoundingClientRect()[s]}px`}else t.originalPosition.value=Cm(e,"position");for(const[s,a]of Object.entries(r))t.$el.style[s]=a},BK=(i,e,t)=>{const n=Ne("loading");["absolute","fixed","sticky"].includes(t.originalPosition.value)?Lc(e,n.bm("parent","relative")):kp(e,n.bm("parent","relative")),i.fullscreen&&i.lock?kp(e,n.bm("parent","hidden")):Lc(e,n.bm("parent","hidden"))},$V=Symbol("ElLoading"),zK=(i,e)=>{var t,n,r,s;const a=e.instance,o=h=>oi(e.value)?e.value[h]:void 0,l=h=>{const p=Ft(h)&&(a==null?void 0:a[h])||h;return p&&W(p)},c=h=>l(o(h)||i.getAttribute(`element-loading-${Dy(h)}`)),u=(t=o("fullscreen"))!=null?t:e.modifiers.fullscreen,d={text:c("text"),svg:c("svg"),svgViewBox:c("svgViewBox"),spinner:c("spinner"),background:c("background"),customClass:c("customClass"),fullscreen:u,target:(n=o("target"))!=null?n:u?void 0:i,body:(r=o("body"))!=null?r:e.modifiers.body,lock:(s=o("lock"))!=null?s:e.modifiers.lock};i[$V]={options:d,instance:IV(d)}},JXe=(i,e)=>{for(const t of Object.keys(e))Vn(e[t])&&(e[t].value=i[t])},UK={mounted(i,e){e.value&&zK(i,e)},updated(i,e){const t=i[$V];e.oldValue!==e.value&&(e.value&&!e.oldValue?zK(i,e):e.value&&e.oldValue?oi(e.value)&&JXe(e.value,t.options):t==null||t.instance.close())},unmounted(i){var e;(e=i[$V])==null||e.instance.close()}},eZe={install(i){i.directive("loading",UK),i.config.globalProperties.$loading=IV},directive:UK,service:IV},sue=["success","info","warning","error"],hc=Ar({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:Ii?document.body:void 0}),tZe=Ke({customClass:{type:String,default:hc.customClass},center:{type:Boolean,default:hc.center},dangerouslyUseHTMLString:{type:Boolean,default:hc.dangerouslyUseHTMLString},duration:{type:Number,default:hc.duration},icon:{type:Zn,default:hc.icon},id:{type:String,default:hc.id},message:{type:xe([String,Object,Function]),default:hc.message},onClose:{type:xe(Function),required:!1},showClose:{type:Boolean,default:hc.showClose},type:{type:String,values:sue,default:hc.type},offset:{type:Number,default:hc.offset},zIndex:{type:Number,default:hc.zIndex},grouping:{type:Boolean,default:hc.grouping},repeatNum:{type:Number,default:hc.repeatNum}}),iZe={destroy:()=>!0},Np=Fre([]),nZe=i=>{const e=Np.findIndex(r=>r.id===i),t=Np[e];let n;return e>0&&(n=Np[e-1]),{current:t,prev:n}},rZe=i=>{const{prev:e}=nZe(i);return e?e.vm.exposed.bottom.value:0},sZe=["id"],aZe=["innerHTML"],oZe=de({name:"ElMessage"}),lZe=de({...oZe,props:tZe,emits:iZe,setup(i,{expose:e}){const t=i,{Close:n}=a9,r=Ne("message"),s=W(),a=W(!1),o=W(0);let l;const c=R(()=>t.type?t.type==="error"?"danger":t.type:"info"),u=R(()=>{const C=t.type;return{[r.bm("icon",C)]:C&&Sy[C]}}),d=R(()=>t.icon||Sy[t.type]||""),h=R(()=>rZe(t.id)),p=R(()=>t.offset+h.value),m=R(()=>o.value+p.value),g=R(()=>({top:`${p.value}px`,zIndex:t.zIndex}));function _(){t.duration!==0&&({stop:l}=ob(()=>{x()},t.duration))}function b(){l==null||l()}function x(){a.value=!1}function w({code:C}){C===wt.esc&&x()}return qt(()=>{_(),a.value=!0}),Ve(()=>t.repeatNum,()=>{b(),_()}),mr(document,"keydown",w),fl(s,()=>{o.value=s.value.getBoundingClientRect().height}),e({visible:a,bottom:m,close:x}),(C,S)=>(I(),Se(Ss,{name:v(r).b("fade"),onBeforeLeave:C.onClose,onAfterLeave:S[0]||(S[0]=E=>C.$emit("destroy")),persisted:""},{default:pe(()=>[zt(Q("div",{id:C.id,ref_key:"messageRef",ref:s,class:N([v(r).b(),{[v(r).m(C.type)]:C.type&&!C.icon},v(r).is("center",C.center),v(r).is("closable",C.showClose),C.customClass]),style:pt(v(g)),role:"alert",onMouseenter:b,onMouseleave:_},[C.repeatNum>1?(I(),Se(v(Ioe),{key:0,value:C.repeatNum,type:v(c),class:N(v(r).e("badge"))},null,8,["value","type","class"])):_e("v-if",!0),v(d)?(I(),Se(v(ct),{key:1,class:N([v(r).e("icon"),v(u)])},{default:pe(()=>[(I(),Se(hi(v(d))))]),_:1},8,["class"])):_e("v-if",!0),Fe(C.$slots,"default",{},()=>[C.dangerouslyUseHTMLString?(I(),Z(gt,{key:1},[_e(" Caution here, message could've been compromised, never use user's input as message "),Q("p",{class:N(v(r).e("content")),innerHTML:C.message},null,10,aZe)],2112)):(I(),Z("p",{key:0,class:N(v(r).e("content"))},We(C.message),3))]),C.showClose?(I(),Se(v(ct),{key:2,class:N(v(r).e("closeBtn")),onClick:Dt(x,["stop"])},{default:pe(()=>[re(v(n))]),_:1},8,["class","onClick"])):_e("v-if",!0)],46,sZe),[[Ei,a.value]])]),_:3},8,["name","onBeforeLeave"]))}});var cZe=qe(lZe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/message/src/message.vue"]]);let uZe=1;const aue=i=>{const e=!i||Ft(i)||Pr(i)||Lt(i)?{message:i}:i,t={...hc,...e};if(!t.appendTo)t.appendTo=document.body;else if(Ft(t.appendTo)){let n=document.querySelector(t.appendTo);Oh(n)||(n=document.body),t.appendTo=n}return t},dZe=i=>{const e=Np.indexOf(i);if(e===-1)return;Np.splice(e,1);const{handler:t}=i;t.close()},hZe=({appendTo:i,...e},t)=>{const{nextZIndex:n}=yg(),r=`message_${uZe++}`,s=e.onClose,a=document.createElement("div"),o={...e,zIndex:n()+e.zIndex,id:r,onClose:()=>{s==null||s(),dZe(d)},onDestroy:()=>{tC(null,a)}},l=re(cZe,o,Lt(o.message)||Pr(o.message)?{default:Lt(o.message)?o.message:()=>o.message}:null);l.appContext=t||pC._context,tC(l,a),i.appendChild(a.firstElementChild);const c=l.component,d={id:r,vnode:l,vm:c,handler:{close:()=>{c.exposed.visible.value=!1}},props:l.component.props};return d},pC=(i={},e)=>{if(!Ii)return{close:()=>{}};if(It(Z5.max)&&Np.length>=Z5.max)return{close:()=>{}};const t=aue(i);if(t.grouping&&Np.length){const r=Np.find(({vnode:s})=>{var a;return((a=s.props)==null?void 0:a.message)===t.message});if(r)return r.props.repeatNum+=1,r.props.type=t.type,r.handler}const n=hZe(t,e);return Np.push(n),n.handler};sue.forEach(i=>{pC[i]=(e={},t)=>{const n=aue(e);return pC({...n,type:i},t)}});function pZe(i){for(const e of Np)(!i||i===e.props.type)&&e.handler.close()}pC.closeAll=pZe;pC._context=null;const eu=Mae(pC,"$message"),fZe=de({name:"ElMessageBox",directives:{TrapFocus:sNe},components:{ElButton:Bo,ElFocusTrap:z3,ElInput:ol,ElOverlay:L9,ElIcon:ct,...a9},inheritAttrs:!1,props:{buttonSize:{type:String,validator:aM},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(i,{emit:e}){const{t}=Ki(),n=Ne("message-box"),r=W(!1),{nextZIndex:s}=yg(),a=Ji({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:s()}),o=R(()=>{const U=a.type;return{[n.bm("icon",U)]:U&&Sy[U]}}),l=Ih(),c=Ih(),u=Qs(R(()=>i.buttonSize),{prop:!0,form:!0,formItem:!0}),d=R(()=>a.icon||Sy[a.type]||""),h=R(()=>!!a.message),p=W(),m=W(),g=W(),_=W(),b=W(),x=R(()=>a.confirmButtonClass);Ve(()=>a.inputValue,async U=>{await ut(),i.boxType==="prompt"&&U!==null&&O()},{immediate:!0}),Ve(()=>r.value,U=>{var G,H;U&&(i.boxType!=="prompt"&&(a.autofocus?g.value=(H=(G=b.value)==null?void 0:G.$el)!=null?H:p.value:g.value=p.value),a.zIndex=s()),i.boxType==="prompt"&&(U?ut().then(()=>{var k;_.value&&_.value.$el&&(a.autofocus?g.value=(k=M())!=null?k:p.value:g.value=p.value)}):(a.editorErrorMessage="",a.validateError=!1))});const w=R(()=>i.draggable);Wae(p,m,w),qt(async()=>{await ut(),i.closeOnHashChange&&window.addEventListener("hashchange",C)}),Vr(()=>{i.closeOnHashChange&&window.removeEventListener("hashchange",C)});function C(){r.value&&(r.value=!1,ut(()=>{a.action&&e("action",a.action)}))}const S=()=>{i.closeOnClickModal&&P(a.distinguishCancelAndClose?"close":"cancel")},E=_9(S),A=U=>{if(a.inputType!=="textarea")return U.preventDefault(),P("confirm")},P=U=>{var G;i.boxType==="prompt"&&U==="confirm"&&!O()||(a.action=U,a.beforeClose?(G=a.beforeClose)==null||G.call(a,U,a,C):C())},O=()=>{if(i.boxType==="prompt"){const U=a.inputPattern;if(U&&!U.test(a.inputValue||""))return a.editorErrorMessage=a.inputErrorMessage||t("el.messagebox.error"),a.validateError=!0,!1;const G=a.inputValidator;if(typeof G=="function"){const H=G(a.inputValue);if(H===!1)return a.editorErrorMessage=a.inputErrorMessage||t("el.messagebox.error"),a.validateError=!0,!1;if(typeof H=="string")return a.editorErrorMessage=H,a.validateError=!0,!1}}return a.editorErrorMessage="",a.validateError=!1,!0},M=()=>{const U=_.value.$refs;return U.input||U.textarea},V=()=>{P("close")},L=()=>{i.closeOnPressEscape&&V()};return i.lockScroll&&qae(r),CDe(r),{..._a(a),ns:n,overlayEvent:E,visible:r,hasMessage:h,typeClass:o,contentId:l,inputId:c,btnSize:u,iconComponent:d,confirmButtonClasses:x,rootRef:p,focusStartRef:g,headerRef:m,inputRef:_,confirmRef:b,doClose:C,handleClose:V,onCloseRequested:L,handleWrapperClick:S,handleInputEnter:A,handleAction:P,t}}}),mZe=["aria-label","aria-describedby"],gZe=["aria-label"],vZe=["id"];function yZe(i,e,t,n,r,s){const a=jt("el-icon"),o=jt("close"),l=jt("el-input"),c=jt("el-button"),u=jt("el-focus-trap"),d=jt("el-overlay");return I(),Se(Ss,{name:"fade-in-linear",onAfterLeave:e[11]||(e[11]=h=>i.$emit("vanish")),persisted:""},{default:pe(()=>[zt(re(d,{"z-index":i.zIndex,"overlay-class":[i.ns.is("message-box"),i.modalClass],mask:i.modal},{default:pe(()=>[Q("div",{role:"dialog","aria-label":i.title,"aria-modal":"true","aria-describedby":i.showInput?void 0:i.contentId,class:N(`${i.ns.namespace.value}-overlay-message-box`),onClick:e[8]||(e[8]=(...h)=>i.overlayEvent.onClick&&i.overlayEvent.onClick(...h)),onMousedown:e[9]||(e[9]=(...h)=>i.overlayEvent.onMousedown&&i.overlayEvent.onMousedown(...h)),onMouseup:e[10]||(e[10]=(...h)=>i.overlayEvent.onMouseup&&i.overlayEvent.onMouseup(...h))},[re(u,{loop:"",trapped:i.visible,"focus-trap-el":i.rootRef,"focus-start-el":i.focusStartRef,onReleaseRequested:i.onCloseRequested},{default:pe(()=>[Q("div",{ref:"rootRef",class:N([i.ns.b(),i.customClass,i.ns.is("draggable",i.draggable),{[i.ns.m("center")]:i.center}]),style:pt(i.customStyle),tabindex:"-1",onClick:e[7]||(e[7]=Dt(()=>{},["stop"]))},[i.title!==null&&i.title!==void 0?(I(),Z("div",{key:0,ref:"headerRef",class:N(i.ns.e("header"))},[Q("div",{class:N(i.ns.e("title"))},[i.iconComponent&&i.center?(I(),Se(a,{key:0,class:N([i.ns.e("status"),i.typeClass])},{default:pe(()=>[(I(),Se(hi(i.iconComponent)))]),_:1},8,["class"])):_e("v-if",!0),Q("span",null,We(i.title),1)],2),i.showClose?(I(),Z("button",{key:0,type:"button",class:N(i.ns.e("headerbtn")),"aria-label":i.t("el.messagebox.close"),onClick:e[0]||(e[0]=h=>i.handleAction(i.distinguishCancelAndClose?"close":"cancel")),onKeydown:e[1]||(e[1]=Di(Dt(h=>i.handleAction(i.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[re(a,{class:N(i.ns.e("close"))},{default:pe(()=>[re(o)]),_:1},8,["class"])],42,gZe)):_e("v-if",!0)],2)):_e("v-if",!0),Q("div",{id:i.contentId,class:N(i.ns.e("content"))},[Q("div",{class:N(i.ns.e("container"))},[i.iconComponent&&!i.center&&i.hasMessage?(I(),Se(a,{key:0,class:N([i.ns.e("status"),i.typeClass])},{default:pe(()=>[(I(),Se(hi(i.iconComponent)))]),_:1},8,["class"])):_e("v-if",!0),i.hasMessage?(I(),Z("div",{key:1,class:N(i.ns.e("message"))},[Fe(i.$slots,"default",{},()=>[i.dangerouslyUseHTMLString?(I(),Se(hi(i.showInput?"label":"p"),{key:1,for:i.showInput?i.inputId:void 0,innerHTML:i.message},null,8,["for","innerHTML"])):(I(),Se(hi(i.showInput?"label":"p"),{key:0,for:i.showInput?i.inputId:void 0},{default:pe(()=>[Gi(We(i.dangerouslyUseHTMLString?"":i.message),1)]),_:1},8,["for"]))])],2)):_e("v-if",!0)],2),zt(Q("div",{class:N(i.ns.e("input"))},[re(l,{id:i.inputId,ref:"inputRef",modelValue:i.inputValue,"onUpdate:modelValue":e[2]||(e[2]=h=>i.inputValue=h),type:i.inputType,placeholder:i.inputPlaceholder,"aria-invalid":i.validateError,class:N({invalid:i.validateError}),onKeydown:Di(i.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),Q("div",{class:N(i.ns.e("errormsg")),style:pt({visibility:i.editorErrorMessage?"visible":"hidden"})},We(i.editorErrorMessage),7)],2),[[Ei,i.showInput]])],10,vZe),Q("div",{class:N(i.ns.e("btns"))},[i.showCancelButton?(I(),Se(c,{key:0,loading:i.cancelButtonLoading,class:N([i.cancelButtonClass]),round:i.roundButton,size:i.btnSize,onClick:e[3]||(e[3]=h=>i.handleAction("cancel")),onKeydown:e[4]||(e[4]=Di(Dt(h=>i.handleAction("cancel"),["prevent"]),["enter"]))},{default:pe(()=>[Gi(We(i.cancelButtonText||i.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):_e("v-if",!0),zt(re(c,{ref:"confirmRef",type:"primary",loading:i.confirmButtonLoading,class:N([i.confirmButtonClasses]),round:i.roundButton,disabled:i.confirmButtonDisabled,size:i.btnSize,onClick:e[5]||(e[5]=h=>i.handleAction("confirm")),onKeydown:e[6]||(e[6]=Di(Dt(h=>i.handleAction("confirm"),["prevent"]),["enter"]))},{default:pe(()=>[Gi(We(i.confirmButtonText||i.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[Ei,i.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,mZe)]),_:3},8,["z-index","overlay-class","mask"]),[[Ei,i.visible]])]),_:3})}var _Ze=qe(fZe,[["render",yZe],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const sA=new Map,bZe=i=>{let e=document.body;return i.appendTo&&(Ft(i.appendTo)&&(e=document.querySelector(i.appendTo)),Oh(i.appendTo)&&(e=i.appendTo),Oh(e)||(e=document.body)),e},wZe=(i,e,t=null)=>{const n=re(_Ze,i,Lt(i.message)||Pr(i.message)?{default:Lt(i.message)?i.message:()=>i.message}:null);return n.appContext=t,tC(n,e),bZe(i).appendChild(e.firstElementChild),n.component},xZe=()=>document.createElement("div"),CZe=(i,e)=>{const t=xZe();i.onVanish=()=>{tC(null,t),sA.delete(r)},i.onAction=s=>{const a=sA.get(r);let o;i.showInput?o={value:r.inputValue,action:s}:o=s,i.callback?i.callback(o,n.proxy):s==="cancel"||s==="close"?i.distinguishCancelAndClose&&s!=="cancel"?a.reject("close"):a.reject("cancel"):a.resolve(o)};const n=wZe(i,t,e),r=n.proxy;for(const s in i)Ci(i,s)&&!Ci(r.$props,s)&&(r[s]=i[s]);return r.visible=!0,r};function HC(i,e=null){if(!Ii)return Promise.reject();let t;return Ft(i)||Pr(i)?i={message:i}:t=i.callback,new Promise((n,r)=>{const s=CZe(i,e??HC._context);sA.set(s,{options:i,callback:t,resolve:n,reject:r})})}const TZe=["alert","confirm","prompt"],SZe={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};TZe.forEach(i=>{HC[i]=EZe(i)});function EZe(i){return(e,t,n,r)=>{let s="";return oi(t)?(n=t,s=""):eo(t)?s="":s=t,HC(Object.assign({title:s,message:e,type:"",...SZe[i]},n,{boxType:i}),r)}}HC.close=()=>{sA.forEach((i,e)=>{e.doClose()}),sA.clear()};HC._context=null;const nv=HC;nv.install=i=>{nv._context=i._context,i.config.globalProperties.$msgbox=nv,i.config.globalProperties.$messageBox=nv,i.config.globalProperties.$alert=nv.alert,i.config.globalProperties.$confirm=nv.confirm,i.config.globalProperties.$prompt=nv.prompt};const AZe=nv,oue=["success","info","warning","error"],MZe=Ke({customClass:{type:String,default:""},dangerouslyUseHTMLString:{type:Boolean,default:!1},duration:{type:Number,default:4500},icon:{type:Zn},id:{type:String,default:""},message:{type:xe([String,Object]),default:""},offset:{type:Number,default:0},onClick:{type:xe(Function),default:()=>{}},onClose:{type:xe(Function),required:!0},position:{type:String,values:["top-right","top-left","bottom-right","bottom-left"],default:"top-right"},showClose:{type:Boolean,default:!0},title:{type:String,default:""},type:{type:String,values:[...oue,""],default:""},zIndex:{type:Number,default:0}}),PZe={destroy:()=>!0},OZe=["id"],RZe=["textContent"],IZe={key:0},$Ze=["innerHTML"],LZe=de({name:"ElNotification"}),DZe=de({...LZe,props:MZe,emits:PZe,setup(i,{expose:e}){const t=i,n=Ne("notification"),{Close:r}=Eae,s=W(!1);let a;const o=R(()=>{const _=t.type;return _&&Sy[t.type]?n.m(_):""}),l=R(()=>t.type&&Sy[t.type]||t.icon),c=R(()=>t.position.endsWith("right")?"right":"left"),u=R(()=>t.position.startsWith("top")?"top":"bottom"),d=R(()=>({[u.value]:`${t.offset}px`,zIndex:t.zIndex}));function h(){t.duration>0&&({stop:a}=ob(()=>{s.value&&m()},t.duration))}function p(){a==null||a()}function m(){s.value=!1}function g({code:_}){_===wt.delete||_===wt.backspace?p():_===wt.esc?s.value&&m():h()}return qt(()=>{h(),s.value=!0}),mr(document,"keydown",g),e({visible:s,close:m}),(_,b)=>(I(),Se(Ss,{name:v(n).b("fade"),onBeforeLeave:_.onClose,onAfterLeave:b[1]||(b[1]=x=>_.$emit("destroy")),persisted:""},{default:pe(()=>[zt(Q("div",{id:_.id,class:N([v(n).b(),_.customClass,v(c)]),style:pt(v(d)),role:"alert",onMouseenter:p,onMouseleave:h,onClick:b[0]||(b[0]=(...x)=>_.onClick&&_.onClick(...x))},[v(l)?(I(),Se(v(ct),{key:0,class:N([v(n).e("icon"),v(o)])},{default:pe(()=>[(I(),Se(hi(v(l))))]),_:1},8,["class"])):_e("v-if",!0),Q("div",{class:N(v(n).e("group"))},[Q("h2",{class:N(v(n).e("title")),textContent:We(_.title)},null,10,RZe),zt(Q("div",{class:N(v(n).e("content")),style:pt(_.title?void 0:{margin:0})},[Fe(_.$slots,"default",{},()=>[_.dangerouslyUseHTMLString?(I(),Z(gt,{key:1},[_e(" Caution here, message could've been compromised, never use user's input as message "),Q("p",{innerHTML:_.message},null,8,$Ze)],2112)):(I(),Z("p",IZe,We(_.message),1))])],6),[[Ei,_.message]]),_.showClose?(I(),Se(v(ct),{key:0,class:N(v(n).e("closeBtn")),onClick:Dt(m,["stop"])},{default:pe(()=>[re(v(r))]),_:1},8,["class","onClick"])):_e("v-if",!0)],2)],46,OZe),[[Ei,s.value]])]),_:3},8,["name","onBeforeLeave"]))}});var kZe=qe(DZe,[["__file","/home/runner/work/element-plus/element-plus/packages/components/notification/src/notification.vue"]]);const C$={"top-left":[],"top-right":[],"bottom-left":[],"bottom-right":[]},LV=16;let FZe=1;const fC=function(i={},e=null){if(!Ii)return{close:()=>{}};(typeof i=="string"||Pr(i))&&(i={message:i});const t=i.position||"top-right";let n=i.offset||0;C$[t].forEach(({vm:d})=>{var h;n+=(((h=d.el)==null?void 0:h.offsetHeight)||0)+LV}),n+=LV;const{nextZIndex:r}=yg(),s=`notification_${FZe++}`,a=i.onClose,o={zIndex:r(),...i,offset:n,id:s,onClose:()=>{NZe(s,t,a)}};let l=document.body;Oh(i.appendTo)?l=i.appendTo:Ft(i.appendTo)&&(l=document.querySelector(i.appendTo)),Oh(l)||(l=document.body);const c=document.createElement("div"),u=re(kZe,o,Pr(o.message)?{default:()=>o.message}:null);return u.appContext=e??fC._context,u.props.onDestroy=()=>{tC(null,c)},tC(u,c),C$[t].push({vm:u}),l.appendChild(c.firstElementChild),{close:()=>{u.component.exposed.visible.value=!1}}};oue.forEach(i=>{fC[i]=(e={})=>((typeof e=="string"||Pr(e))&&(e={message:e}),fC({...e,type:i}))});function NZe(i,e,t){const n=C$[e],r=n.findIndex(({vm:c})=>{var u;return((u=c.component)==null?void 0:u.props.id)===i});if(r===-1)return;const{vm:s}=n[r];if(!s)return;t==null||t(s);const a=s.el.offsetHeight,o=e.split("-")[0];n.splice(r,1);const l=n.length;if(!(l<1))for(let c=r;c<l;c++){const{el:u,component:d}=n[c].vm,h=Number.parseInt(u.style[o],10)-a-LV;d.props.offset=h}}function VZe(){for(const i of Object.values(C$))i.forEach(({vm:e})=>{e.component.exposed.visible.value=!1})}fC.closeAll=VZe;fC._context=null;const lue=Mae(fC,"$notify");var BZe=[YXe,eZe,eu,AZe,lue,Qle],zZe=ske([...UXe,...BZe]);const UZe=""+new URL("title-0332cbc4.png",import.meta.url).href;var DV;let FR=DV=class extends Wo{constructor(i){super(i),this.type="none"}clone(){return new DV({type:this.type})}};f([bb({none:"none",stayAbove:"stay-above"})],FR.prototype,"type",void 0),FR=DV=f([ge("esri.ground.NavigationConstraint")],FR);let Br=class extends et{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1,this.TERRAIN_USE_LEGACY_SHADING=!1}};f([y()],Br.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),f([y()],Br.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),f([y()],Br.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),f([y()],Br.prototype,"DECONFLICTOR_SHOW_GRID",void 0),f([y()],Br.prototype,"LABELS_SHOW_BORDER",void 0),f([y()],Br.prototype,"TEXT_SHOW_BASELINE",void 0),f([y()],Br.prototype,"TEXT_SHOW_BORDER",void 0),f([y()],Br.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),f([y()],Br.prototype,"OVERLAY_SHOW_CENTER",void 0),f([y()],Br.prototype,"SHOW_POI",void 0),f([y()],Br.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),f([y()],Br.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),f([y()],Br.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),f([y()],Br.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),f([y()],Br.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),f([y()],Br.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),f([y()],Br.prototype,"I3S_TREE_SHOW_TILES",void 0),f([y()],Br.prototype,"I3S_SHOW_MODIFICATIONS",void 0),f([y()],Br.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),f([y()],Br.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),f([y()],Br.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),f([y()],Br.prototype,"LINE_WIREFRAMES",void 0),f([y()],Br.prototype,"TERRAIN_USE_LEGACY_SHADING",void 0),Br=f([ge("esri.views.3d.support.DebugFlags")],Br);const cn=new Br;var kV;let np=kV=class extends rie(q0){constructor(i){super(i),this.opacity=1,this.shading=!cn.TERRAIN_USE_LEGACY_SHADING,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new _i;const e=n=>{n.parent&&n.parent!==this&&"remove"in n.parent&&n.parent.remove(n),n.parent=this,n.type!=="elevation"&&n.type!=="base-elevation"&&tt.getLogger(this.declaredClass).error(`Layer '${n.title}, id:${n.id}' of type '${n.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},t=n=>{n.parent=null};this.layers.on("after-add",n=>e(n.item)),this.layers.on("after-remove",n=>t(n.item))}initialize(){this.when().catch(i=>{tt.getLogger(this.declaredClass).error("#load()","Failed to load ground",i)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const i=this.layers.removeAll();for(const e of i)e.destroy();this.layers.destroy()}normalizeCtorArgs(i){return i&&"resourceInfo"in i&&(this._set("resourceInfo",i.resourceInfo),delete(i={...i}).resourceInfo),i}set layers(i){this._set("layers",cye(i,this._get("layers")))}writeLayers(i,e,t,n){const r=[];i&&(n={...n,layerContainerType:"ground"},i.forEach(s=>{if("write"in s){const a={};uye(s)().write(a,n)&&r.push(a)}else n&&n.messages&&n.messages.push(new Ze("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),e.layers=r}load(i){return this.addResolvingPromise(this._loadFromSource(i)),Promise.resolve(this)}loadAll(){return dye(this,i=>{i(this.layers)})}async queryElevation(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await Ee(()=>import("./ElevationQuery-f4eb8505.js"),["./ElevationQuery-f4eb8505.js","./asyncUtils-62e8a185.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./ElevationSamplerData-7decf898.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./TileInfo-34f80a8e.js"],import.meta.url);Cn(e);const n=new t,r=this.layers.filter(HK).toArray();return n.queryAll(r,i,e)}async createElevationSampler(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await Ee(()=>import("./ElevationQuery-f4eb8505.js"),["./ElevationQuery-f4eb8505.js","./asyncUtils-62e8a185.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./ElevationSamplerData-7decf898.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./TileInfo-34f80a8e.js"],import.meta.url);Cn(e);const n=new t,r=this.layers.filter(HK).toArray();return n.createSamplerAll(r,i,e)}clone(){const i={opacity:this.opacity,surfaceColor:ko(this.surfaceColor),navigationConstraint:ko(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(i.loadStatus="loaded"),new kV({resourceInfo:this.resourceInfo}).set(i)}read(i,e){this.resourceInfo||this._set("resourceInfo",{data:i,context:e}),super.read(i,e)}_loadFromSource(i){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,i):Promise.resolve()}_loadLayersFromJSON(i,e,t){const n=e&&e.origin||"web-scene",r=e&&e.portal||null,s=e&&e.url||null;return Ee(()=>import("./layersCreator-6fae5758.js"),["./layersCreator-6fae5758.js","./Collection-78126e82.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./lazyLayerLoader-c3848c13.js","./preload-helper-41c905a7.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./request-d3e98716.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./portalLayers-ea9cba81.js","./layersLoader-6e370ed5.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./arcgisLayerUrl-0b2b7691.js","./persistableUrlUtils-a16d0f55.js","./jsonContext-c2303d72.js","./portalItemUtils-e098e7d9.js","./projection-d7b57a6c.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./styleUtils-da81b13f.js","./asyncUtils-62e8a185.js"],import.meta.url).then(({populateOperationalLayers:a})=>{Cn(t);const o=[];if(i.layers&&Array.isArray(i.layers)){const l={context:{origin:n,url:s,portal:r,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};o.push(a(this.layers,i.layers,l))}return Ra(o)}).then(()=>{})}};function HZe(i){return i&&"createElevationSampler"in i}function HK(i){return i.type==="elevation"||HZe(i)}f([y({json:{read:!1}})],np.prototype,"layers",null),f([eE("layers")],np.prototype,"writeLayers",null),f([y({readOnly:!0})],np.prototype,"resourceInfo",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:CG,read:{reader:Mye,source:"transparency"},write:{writer:(i,e)=>{e.transparency=Pye(i)},target:"transparency"}}})],np.prototype,"opacity",void 0),f([y({type:Boolean,nonNullable:!0,json:{read:!1}})],np.prototype,"shading",void 0),f([y({type:Xt,json:{type:[CG],write:(i,e)=>{e.surfaceColor=i.toJSON().slice(0,3)}}})],np.prototype,"surfaceColor",void 0),f([y({type:FR,json:{write:!0}})],np.prototype,"navigationConstraint",void 0),np=kV=f([ge("esri.Ground")],np);const T$=np;function cue(i){var e;return!!(i&&i.loaded&&"capabilities"in i&&((e=i==null?void 0:i.capabilities)!=null&&e.operations)&&"supportsEditing"in i.capabilities.operations&&i.capabilities.operations.supportsEditing===!0)&&!("editingEnabled"in i&&!i.editingEnabled)}const GK=tt.getLogger("esri.support.basemapUtils");function GZe(){return{}}function WZe(i){for(const e in i){const t=i[e];(t==null?void 0:t.destroyed)===!1&&t.destroy(),delete i[e]}}function jZe(i,e){let t;if(typeof i=="string"){if(!(i in wG)){const n=Object.entries(wG).filter(([r,s])=>QE.apiKey&&!s.classic||!QE.apiKey&&s.classic&&!s.deprecated).map(([r])=>`"${r}"`).join(", ");return GK.warn(`Unable to find basemap definition for: ${i}. Try one of these: ${n}`),null}e&&(t=e[i]),t||(t=Dx.fromId(i),e&&(e[i]=t))}else t=kL(Dx,i);return t!=null&&t.destroyed&&(GK.warn("The provided basemap is already destroyed",{basemap:t}),t=null),t}function qZe(i,e){return i===e?!0:QZe(WK(i),WK(e),{mustMatchReferences:!0})==="equal"}function KZe(i,e){var r;if(B(e)||B(i))return{spatialReference:null,updating:!1};if(e.loadStatus==="not-loaded")return e.load(),{spatialReference:null,updating:!0};if(e.spatialReference)return{spatialReference:e.spatialReference,updating:!1};if(e.baseLayers.length===0)return{spatialReference:null,updating:!1};const t=e.baseLayers.getItemAt(0);switch(t.loadStatus){case"not-loaded":t.load();case"loading":return{spatialReference:null,updating:!0};case"failed":return{spatialReference:null,updating:!1}}const n=(("supportedSpatialReferences"in t?t.supportedSpatialReferences:null)||["tileInfo"in t?(r=t.tileInfo)==null?void 0:r.spatialReference:t.spatialReference]).filter(Boolean);return i.spatialReference?{spatialReference:n.find(s=>i.spatialReference.equals(s))??n[0]??null,updating:!1}:{spatialReference:n[0],updating:!1}}function WK(i){return i?!i.loaded&&i.resourceInfo?XZe(i.resourceInfo.data):{baseLayers:jK(i.baseLayers),referenceLayers:jK(i.referenceLayers)}:null}function jK(i){return(_i.isCollection(i)?i.toArray():i).map(YZe)}function YZe(i){var e,t;return{type:i.type,url:uue("urlTemplate"in i&&i.urlTemplate||i.url||"styleUrl"in i&&i.styleUrl),minScale:"minScale"in i&&i.minScale!=null?i.minScale:0,maxScale:"maxScale"in i&&i.maxScale!=null?i.maxScale:0,opacity:i.opacity!=null?i.opacity:1,visible:i.visible==null||!!i.visible,sublayers:i.type!=="map-image"&&i.type!=="wms"||!T(i.sublayers)||(e=i.sublayers)==null?void 0:e.map(n=>({id:n.id,visible:n.visible})),activeLayerId:i.type==="wmts"?(t=i.activeLayer)==null?void 0:t.id:void 0}}function XZe(i){return i?{baseLayers:qK(i.baseMapLayers.filter(e=>!e.isReference)),referenceLayers:qK(i.baseMapLayers.filter(e=>e.isReference))}:null}function qK(i){return i.map(e=>ZZe(e))}function ZZe(i){let e;switch(i.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;default:e="unknown"}return{type:e,url:uue(i.templateUrl||i.urlTemplate||i.styleUrl||i.url),minScale:i.minScale!=null?i.minScale:0,maxScale:i.maxScale!=null?i.maxScale:0,opacity:i.opacity!=null?i.opacity:1,visible:i.visibility==null||!!i.visibility,sublayers:void 0,activeLayerId:void 0}}function QZe(i,e,t){return i!=null!=(e!=null)?"not-equal":i?KK(i.baseLayers,e.baseLayers)?KK(i.referenceLayers,e.referenceLayers)?"equal":t.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function KK(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!JZe(i[t],e[t]))return!1;return!0}function JZe(i,e){if(i.type!==e.type||i.url!==e.url||i.minScale!==e.minScale||i.maxScale!==e.maxScale||i.visible!==e.visible||i.opacity!==e.opacity)return!1;if(T(i.activeLayerId)||T(e.activeLayerId))return i.activeLayerId===e.activeLayerId;if(T(i.sublayers)||T(e.sublayers)){if(B(i.sublayers)||B(e.sublayers)||i.sublayers.length!==e.sublayers.length)return!1;for(let t=0;t<i.sublayers.length;t++){const n=i.sublayers.at(t),r=e.sublayers.at(t);if(n.id!==r.id||n.visible!==r.visible)return!1}}return!0}function uue(i){return i?Oye(i).replace(/^\s*https?:/i,"").toLowerCase():""}const YK={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function eQe(i){let e=null;if(typeof i=="string")if(i in YK){const t=YK[i];e=new T$({resourceInfo:{data:{layers:[t]}}})}else tt.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${i}. Try "world-elevation"`);else e=kL(T$,i);return e}let rp=class extends Lye(Dye(Pn.EventedMixin(et))){constructor(e){super(e),this.allLayers=new t2({getCollections:()=>{var t,n,r;return[(t=this.basemap)==null?void 0:t.baseLayers,(n=this.ground)==null?void 0:n.layers,this.layers,(r=this.basemap)==null?void 0:r.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=kye(this),this.basemap=null,this.editableLayers=new t2({getCollections:()=>[this.allLayers],itemFilterFunction:cue}),this.ground=new T$,this._basemapCache=GZe()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(t=this.basemap)==null||t.destroy(),WZe(this._basemapCache),this._basemapCache=null}castBasemap(e){return jZe(e,this._basemapCache)}castGround(e){const t=eQe(e);return B(t)?this._get("ground"):t}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};f([y({readOnly:!0,dependsOn:[]})],rp.prototype,"allLayers",void 0),f([y({readOnly:!0})],rp.prototype,"allTables",void 0),f([y({type:Dx})],rp.prototype,"basemap",void 0),f([Mr("basemap")],rp.prototype,"castBasemap",null),f([y({readOnly:!0})],rp.prototype,"editableLayers",void 0),f([y({type:T$,nonNullable:!0})],rp.prototype,"ground",void 0),f([Mr("ground")],rp.prototype,"castGround",null),rp=f([ge("esri.Map")],rp);const due=rp;let qf=class extends _ie(Wo){constructor(...e){super(...e),this.position=new Wt([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,n,r){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const s={position:e};return t!=null&&(s.heading=t),n!=null&&(s.tilt=n),r!=null&&(s.fov=r),s}return e}writePosition(e,t,n,r){const s=e.clone();s.x=Pv(e.x||0),s.y=Pv(e.y||0),s.z=e.hasZ?Pv(e.z||0):e.z,t[n]=s.write({},r)}readPosition(e,t){const n=new Wt;return n.read(e,t),n.x=Pv(n.x||0),n.y=Pv(n.y||0),n.z=n.hasZ?Pv(n.z||0):n.z,n}equals(e){return!B(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};f([y({type:Wt,json:{write:{isRequired:!0}}})],qf.prototype,"position",void 0),f([eE("position")],qf.prototype,"writePosition",null),f([PN("position")],qf.prototype,"readPosition",null),f([y({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Mr(i=>BL.normalize(Pv(i)))],qf.prototype,"heading",void 0),f([y({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Mr(i=>lt(Pv(i),-180,180))],qf.prototype,"tilt",void 0),f([y({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],qf.prototype,"fov",void 0),qf=f([ge("esri.Camera")],qf);const ku=qf;var FV;let rv=FV=class extends Wo{constructor(i){super(i),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(i){return(i%=360)<0&&(i+=360),i}clone(){return new FV({rotation:this.rotation,scale:this.scale,targetGeometry:T(this.targetGeometry)?this.targetGeometry.clone():null,camera:T(this.camera)?this.camera.clone():null})}};function Bk(){return{enabled:!this.camera}}f([y({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Bk}}}}})],rv.prototype,"rotation",void 0),f([Mr("rotation")],rv.prototype,"castRotation",null),f([y({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:Bk}}}}})],rv.prototype,"scale",void 0),f([y({types:zye,json:{read:$N,write:!0,origins:{"web-scene":{read:$N,write:{overridePolicy:Bk}}}}})],rv.prototype,"targetGeometry",void 0),f([y({type:ku,json:{write:!0}})],rv.prototype,"camera",void 0),rv=FV=f([ge("esri.Viewpoint")],rv);const ga=rv,NR={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,n=this.values;return e<=t.xsmall?n.xsmall:e<=t.small?n.small:e<=t.medium?n.medium:e<=t.large?n.large:n.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],n=e[1],r=this.values;return n>=t?r.portrait:r.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},zk={xsmall:544,small:768,medium:992,large:1200};function tQe(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Uk(i,e){return e?NR[i].valueToClassName[e].split(" "):[]}const hue=i=>{let e=class extends i{constructor(...t){super(...t),this._breakpointsHandles=new mi,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=zk}initialize(){this._breakpointsHandles.add(ue(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),At))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=_t(this._breakpointsHandles))}set breakpoints(t){if(t===this._get("breakpoints"))return;const n=tQe(t);if(!n){const r=JSON.stringify(zk,null,2);console.warn("provided breakpoints are not valid, using defaults:"+r)}t=n?t:zk,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=$M.acquire(),n=$M.acquire();let r,s=!1;for(r in NR){const a=this[r],o=NR[r].getValue({viewSize:this.size,breakpoints:this.breakpoints});a!==o&&(s=!0,this[r]=o,Uk(r,a).forEach(l=>n.push(l)),Uk(r,o).forEach(l=>t.push(l)))}s&&(this._applyClassNameChanges(t,n),$M.release(t),$M.release(n))}_applyClassNameChanges(t,n){const r=this.container;r&&(n.forEach(s=>r.classList.remove(s)),t.forEach(s=>r.classList.add(s)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let n;for(n in NR)Uk(n,this[n]).forEach(r=>t.classList.remove(r))}};return f([y()],e.prototype,"breakpoints",null),f([y()],e.prototype,"orientation",void 0),f([y()],e.prototype,"widthBreakpoint",void 0),f([y()],e.prototype,"heightBreakpoint",void 0),e=f([ge("esri.views.BreakpointsOwner")],e),e};let sv=class extends et{constructor(){super(...arguments),this.items=new _i,this._watchUpdatingTracking=new wb,this._callbacks=new Map,this._projector=zI(),this._hiddenProjector=zI()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const n of t.added){const r=()=>n.render();this._callbacks.set(n,r),this._projector.append(this.surface,r)}for(const n of t.removed){const r=this._projector.detach(this._callbacks.get(n));this.surface.removeChild(r.domNode),this._callbacks.delete(n)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,n=this._hiddenProjector;let r=null;const s=()=>(r=e.render(),r);n.append(t,s),n.renderNow();const a={left:0,top:0,right:0,bottom:0};if(r&&r.domNode){const o=r.domNode.getBoundingClientRect();a.left=o.left,a.top=o.top,a.right=o.right,a.bottom=o.bottom}for(n.detach(s);t.firstChild;)t.removeChild(t.firstChild);return a}overlaps(e,t){const n=this.computeBoundingRect(e),r=this.computeBoundingRect(t);return Math.max(n.left,r.left)<=Math.min(n.right,r.right)&&Math.max(n.top,r.top)<=Math.min(n.bottom,r.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(n=>n.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(n=>{t.save(),n.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};f([y({readOnly:!0})],sv.prototype,"surface",void 0),f([y({readOnly:!0})],sv.prototype,"items",void 0),f([y({readOnly:!0})],sv.prototype,"needsRender",null),f([y({readOnly:!0})],sv.prototype,"_watchUpdatingTracking",void 0),f([y({readOnly:!0})],sv.prototype,"updating",null),sv=f([ge("esri.views.overlay.ViewOverlay")],sv);const XK=sv;function wx(i,e,t,n){let r=null,s=1e3;typeof e=="number"?(s=e,n=t):(r=e??null,s=t);let a,o=0;const l=()=>{o=0,i.apply(n,a)},c=(...u)=>{r&&r.apply(n,u),a=u,s?o||(o=setTimeout(l,s)):l()};return c.remove=()=>{o&&(clearTimeout(o),o=0)},c.forceUpdate=()=>{o&&(clearTimeout(o),l())},c.hasPendingUpdates=()=>!!o,c}function pue(i,e,t){return i.units[e][t]}function GC(i,e,t,n=2,r="abbr"){return`${lg(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:e>0?"never":"exceptZero"})} ${pue(i,t,r)}`}function W3(i,e,t,n=2,r="abbr"){return`${lg(e,{minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:"exceptZero"})} ${pue(i,t,r)}`}function uRt(i,e,t,n=2,r="abbr"){const s=Mie(e,t);return GC(i,ec(e,t,s),s,n,r)}function dRt(i,e,t,n=2,r="abbr"){const s=Mie(e,t);return W3(i,ec(e,t,s),s,n,r)}function hRt(i,e,t,n=2,r="abbr"){const s=Pie(e,t);return GC(i,ec(e,t,s),s,n,r)}function pRt(i,e,t,n=2,r="abbr"){const s=Pie(e,t);return W3(i,ec(e,t,s),s,n,r)}function fRt(i,e,t,n=2,r="abbr"){const s=Oie(e,t);return GC(i,ec(e,t,s),s,n,r)}function mRt(i,e,t,n=2,r="abbr"){const s=Oie(e,t);return W3(i,ec(e,t,s),s,n,r)}function gRt(i,e,t,n=2,r="abbr"){const s=Rie(e,t);return GC(i,ec(e,t,s),s,n,r)}function vRt(i,e,t,n=2,r="abbr"){const s=Rie(e,t);return W3(i,ec(e,t,s),s,n,r)}function yRt(i,e,t,n=2,r="abbr"){const s=Qye(e,t);return GC(i,ec(e,t,s),s,n,r)}function _Rt(i,e,t,n=2,r="abbr"){const s=Jye(e,t);return GC(i,ec(e,t,s),s,n,r)}function bRt(i,e,t,n,r){r=Jt(r,2);let s=BL.normalize(iQe(ec(i,e,"degrees"),t,n),0,!0);const a={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,signDisplay:s>0?"never":"exceptZero"};return s=fue(s,a),lg(s,a)}function wRt(i,e,t,n,r){t!==n&&(i=-i);const s={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r=Jt(r,2),minimumFractionDigits:r,signDisplay:"exceptZero"};let a=ec(i,e,"degrees")%360;return a=fue(a,s),lg(a,s)}const ZK=new Map;function fue(i,e){const t=JSON.stringify(e);let n=ZK.get(t);return n||(n=new Intl.NumberFormat("en-US",e),ZK.set(t,n)),/\-?\+?360/.test(n.format(i))?0:i}function iQe(i,e,t){if(e===t)return i;switch(t){case"arithmetic":return nQe(i);case"geographic":return rQe(i)}}function nQe(i){return 90-i}function rQe(i){return-i-90}const QK=["B","kB","MB","GB","TB"];function sQe(i,e){let t=e===0?0:Math.floor(Math.log(e)/Math.log(LN.KILOBYTES));t=lt(t,0,QK.length-1);const n=lg(e/LN.KILOBYTES**t,{maximumFractionDigits:2});return kx(i.units.bytes[QK[t]],{fileSize:n})}const aQe="esri.widgets.Feature.support.featureUtils",JK=tt.getLogger(aQe),oQe=/href=(""|'')/gi,lQe=/(\{([^\{\r\n]+)\})/g,cQe=/\'/g,mue=/^\s*expression\//i,uQe=/(\n)/gi,dQe=/[\u00A0-\u9999<>\&]/gim,hQe=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,pQe=/^(?:mailto:|tel:)/,gue="relationships/",NV=Iie("short-date-short-time");function vue(i){if(!B(i))return i.get("sourceLayer")||i.get("layer")}async function S$(i,e){return typeof i=="function"?i.call(null,e):i}function yue(i=""){if(i)return!pQe.test(i.trim().toLowerCase())}function lU(i){return!!i&&mue.test(i)}function fQe(i,e){if(!lU(e)||!i)return null;const t=e.replace(mue,"").toLowerCase();let n;return i.some(r=>r.name.toLowerCase()===t&&(n=r,!0)),n}function _ue(i,e){const t=fQe(e,i==null?void 0:i.fieldName);return t?t.title||null:i?i.label||i.fieldName:null}function mQe(i,e){const t=e.get(i.toLowerCase());return`{${t&&t.fieldName||i}}`}function gQe(i){return i.replace(oQe,"")}function aA(i,e){const t=cU(e,i);return t?t.name:i}function vQe(i,e){return i&&i.map(t=>aA(t,e))}function cU(i,e){return i&&typeof i.getField=="function"?i.getField(e):null}function bue(i){return`${i}`.trim()}function S0({attributes:i,globalAttributes:e,layer:t,text:n,expressionAttributes:r,fieldInfoMap:s}){return n?VV({formattedAttributes:e,template:wQe(n,{...e,...r,...i},t),fieldInfoMap:s}):""}function VV({formattedAttributes:i,template:e,fieldInfoMap:t}){return bue(gQe(kx(kx(e,n=>mQe(n,t)),i)))}function yQe(i,e,t=!1){const n=e[i];if(typeof n=="string"){const r="%27",s=(t?encodeURIComponent(n):n).replace(cQe,r);e[i]=s}}function _Qe(i,e=!1){const t={...i};return Object.keys(t).forEach(n=>yQe(n,t,e)),t}function bQe(i,e,t){const n=(e=bue(e))&&e[0]!=="{";return kx(i,_Qe(t,n))}function BV(i,e){return i.replace(lQe,(t,n,r)=>{const s=cU(e,r);return s?`{${s.name}}`:n})}function wQe(i,e,t){const n=BV(i,t);return n&&n.replace(hQe,(r,s,a)=>bQe(r,s||a,e))}function xQe(i,e){if(typeof i=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const t=Number(i);if(!isNaN(t))return t}return i}function CQe(i){return(i==null?void 0:i.type)==="feature"}function eY(i){return!!(i!=null&&i.layer)}function TQe(i){return(i==null?void 0:i.type)==="map-image"}function SQe(i,e){var c;const t=e.fieldInfos,n=e.fieldName,r=(c=wue(t,n))==null?void 0:c.clone(),s=e.preventPlacesFormatting,a=e.layer,o=cU(a,n);if(r&&(o==null?void 0:o.type)==="date"){const u=r.format||new f_e;u.dateFormat=u.dateFormat||"short-date-short-time",u.dateTimeFormatOptions=!eY(a)&&CQe(a)&&a.datesInUnknownTimezone||eY(a)&&TQe(a.layer)&&a.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,r.format=u}const l=r&&r.format;return typeof i=="string"&&a_e(n)&&l?l.formatRasterPixelValue(i):typeof(i=xQe(i,l))=="string"||i==null||l==null?pM(i):s?lg(i,{...n_e(l),minimumFractionDigits:0,maximumFractionDigits:20}):l.format(i)}function wue(i,e){if(!i||!i.length||!e)return;const t=e.toLowerCase();let n;return i.some(r=>!(!r.fieldName||r.fieldName.toLowerCase()!==t)&&(n=r,!0)),n}function EQe({fieldName:i,graphic:e,layer:t}){if(Mm(i)||!t||typeof t.getFeatureType!="function")return null;const{typeIdField:n}=t;if(!n||i!==n)return null;const r=t.getFeatureType(e);return r?r.name:null}function AQe({fieldName:i,value:e,graphic:t,layer:n}){if(Mm(i)||!n||typeof n.getFieldDomain!="function")return null;const r=n.getFieldDomain(i,{feature:t});return r&&r.type==="coded-value"?r.getName(e):null}function MQe(i,e){const{creatorField:t,creationDateField:n,editorField:r,editDateField:s}=i;if(!e)return;const a=e[s];if(typeof a=="number"){const l=e[r];return{type:"edit",date:HI(a,NV),user:l}}const o=e[n];if(typeof o=="number"){const l=e[t];return{type:"create",date:HI(o,NV),user:l}}return null}function PQe(i,e){const t=new Map;return i&&i.forEach(n=>{const r=aA(n.fieldName,e);n.fieldName=r,t.set(r.toLowerCase(),n)}),t}function tY(i){const e=[];if(!i)return e;const{fieldInfos:t,content:n}=i;return t&&e.push(...t),n&&Array.isArray(n)&&n.forEach(r=>{if(r.type==="fields"){const s=r&&r.fieldInfos;s&&e.push(...s)}}),e}function uU(i){return i.replace(dQe,e=>`&#${e.charCodeAt(0)};`)}function pM(i){return typeof i=="string"?i.replace(uQe,'<br class="esri-text-new-line" />'):i}function xue(i){const{value:e,fieldName:t,fieldInfos:n,fieldInfoMap:r,layer:s,graphic:a}=i;if(e==null)return"";const o=AQe({fieldName:t,value:e,graphic:a,layer:s});if(o)return o;const l=EQe({fieldName:t,graphic:a,layer:s});if(l)return l;if(r.get(t.toLowerCase()))return SQe(e,{fieldInfos:n||Array.from(r.values()),fieldName:t,layer:s});const c=s&&s.fieldsIndex;return c&&c.isDateField(t)?HI(e,NV):pM(e)}function Hk({fieldInfos:i,attributes:e,layer:t,graphic:n,fieldInfoMap:r,relatedInfos:s}){const a={};return s==null||s.forEach(o=>LQe({attributes:a,relatedInfo:o,fieldInfoMap:r,fieldInfos:i,layer:t})),Object.keys(e).forEach(o=>{const l=e[o];a[o]=xue({fieldName:o,fieldInfos:i,fieldInfoMap:r,layer:t,value:l,graphic:n})}),a}async function OQe(i,e){var u,d;const{layer:t,graphic:n,outFields:r,objectIds:s,returnGeometry:a,spatialReference:o}=i,l=s[0];if(typeof l!="number"&&typeof l!="string"){const h="Could not query required fields for the specified feature. The feature's ID is invalid.",p={layer:t,graphic:n,objectId:l,requiredFields:r};return JK.warn(h,p),null}if(!((d=(u=t.capabilities)==null?void 0:u.operations)!=null&&d.supportsQuery)){const h="The specified layer cannot be queried. The following fields will not be available.",p={layer:t,graphic:n,requiredFields:r,returnGeometry:a};return JK.warn(h,p),null}const c=t.createQuery();return c.objectIds=s,c.outFields=r!=null&&r.length?r:[t.objectIdField],c.returnGeometry=!!a,c.returnZ=!!a,c.returnM=!!a,c.outSpatialReference=o,(await t.queryFeatures(c,e)).features[0]}async function RQe(i){var n;if(!((n=i.expressionInfos)!=null&&n.length))return!1;const e=await UL(),{arcadeUtils:{hasGeometryFunctions:t}}=e;return t(i)}async function IQe({graphic:i,popupTemplate:e,layer:t,spatialReference:n},r){if(!t||!e||(typeof t.load=="function"&&await t.load(r),!i.attributes))return;const s=i.attributes[t.objectIdField];if(s==null)return;const a=[s],o=await e.getRequiredFields(t.fieldsIndex),l=s_e(o,i),c=l?[]:o,u=e.returnGeometry||await RQe(e);if(l&&!u)return;const d=await OQe({layer:t,graphic:i,outFields:c,objectIds:a,returnGeometry:u,spatialReference:n},r);d&&(d.geometry&&(i.geometry=d.geometry),d.attributes&&(i.attributes={...i.attributes,...d.attributes}))}function Mm(i=""){return!!i&&i.includes(gue)}function $Qe(i){return i?`${gue}${i.layerId}/${i.fieldName}`:""}function iY({attributes:i,graphic:e,relatedInfo:t,fieldInfos:n,fieldInfoMap:r,layer:s}){i&&e&&t&&Object.keys(e.attributes).forEach(a=>{const o=$Qe({layerId:t.relation.id.toString(),fieldName:a}),l=e.attributes[a];i[o]=xue({fieldName:o,fieldInfos:n,fieldInfoMap:r,layer:s,value:l,graphic:e})})}function LQe({attributes:i,relatedInfo:e,fieldInfoMap:t,fieldInfos:n,layer:r}){i&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(s=>iY({attributes:i,graphic:s,relatedInfo:e,fieldInfoMap:t,fieldInfos:n,layer:r})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(s=>iY({attributes:i,graphic:s,relatedInfo:e,fieldInfoMap:t,fieldInfos:n,layer:r})))}const nY=i=>{if(!i)return!1;const e=i.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},Cue=({layer:i,method:e,query:t,definitionExpression:n})=>{var a,o;if(!((o=(a=i.capabilities)==null?void 0:a.query)!=null&&o.supportsCacheHint)||e==="attachments")return;const r=T(t.where)&&t.where,s=T(t.geometry)&&t.geometry;nY(n)||nY(r)||(s==null?void 0:s.type)==="extent"||t.resultType==="tile"||(t.cacheHint=!0)},DQe=({query:i,layer:e,method:t})=>{Cue({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},kQe=({queryPayload:i,layer:e,method:t})=>{Cue({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function FQe(i,e,t){return i&&e&&t?rY(i.allLayers,e,t)||rY(i.allTables,e,t):null}function rY(i,e,t){return i.find(n=>n!==e&&n.type==="feature"&&n.url===e.url&&n.layerId===t.relatedTableId)}const sY={editing:!1,operations:{add:!0,update:!0,delete:!0}},Tue=_i.ofType(r_e);let pc=class extends et{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...sY},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new Tue,this.fileInfos=new _i,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(ue(()=>this.graphic,()=>this._graphicChanged(),At))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...sY,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new Ze("invalid-layer","getAttachments(): A valid layer is required.");const n=this._getObjectId(),r=new PG({objectIds:[n],returnMetadata:!0}),s=[],a=e.queryAttachments(r).then(l=>l[n]||s).catch(()=>s);this._getAttachmentsPromise=a,this.notifyChange("state");const o=await a;return t.removeAll(),o.length&&t.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(e,t=this.graphic){const{_attachmentLayer:n,attachmentInfos:r,abilities:s}=this;if(!t)throw new Ze("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new Ze("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!s.operations.add)throw new Ze("invalid-abilities","addAttachment(): add abilities are required.");if(!n||typeof n.addAttachment!="function")throw new Ze("invalid-layer","addAttachment(): A valid layer is required.");const a=n.addAttachment(t,e).then(l=>this._queryAttachment(l.objectId,t)),o=await a;return r.add(o),o}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:n,graphic:r,abilities:s}=this;if(!e)throw new Ze("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.delete)throw new Ze("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new Ze("invalid-layer","deleteAttachment(): A valid layer is required.");const a=t.deleteAttachments(r,[e.id]).then(()=>e),o=await a;return n.remove(o),o}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:n,attachmentInfos:r,graphic:s,abilities:a}=this;if(!e)throw new Ze("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new Ze("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!a.operations.update)throw new Ze("invalid-abilities","updateAttachment(): Update abilities are required.");const o=r.findIndex(u=>u===t);if(!n||typeof n.updateAttachment!="function")throw new Ze("invalid-layer","updateAttachment(): A valid layer is required.");const l=n.updateAttachment(s,t.id,e).then(u=>this._queryAttachment(u.objectId)),c=await l;return r.splice(o,1,c),c}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const n={file:e,form:t};return this.fileInfos.add(n),n}updateFile(e,t,n=this.activeFileInfo){if(!e||!t||!n)return null;const r=this.fileInfos.findIndex(s=>n===s);return r>-1&&this.fileInfos.splice(r,1,{file:e,form:t}),this.fileInfos.items[r]}deleteFile(e){const t=this.fileInfos.find(n=>n.file===e);return this.fileInfos.remove(t)??null}async _queryAttachment(e,t){if(!e)throw new Ze("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:n}=this,r=this._getObjectId(t),s=new PG({objectIds:[r],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return n.queryAttachments(s).then(a=>a[r][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=vue(e);this._attachmentLayer=t?t.type==="scene"&&T(t.associatedLayer)?t.associatedLayer:t:null}};f([y()],pc.prototype,"abilities",void 0),f([Mr("abilities")],pc.prototype,"castAbilities",null),f([y()],pc.prototype,"activeAttachmentInfo",void 0),f([y()],pc.prototype,"activeFileInfo",void 0),f([y({readOnly:!0,type:Tue})],pc.prototype,"attachmentInfos",void 0),f([y()],pc.prototype,"fileInfos",void 0),f([y({type:ao})],pc.prototype,"graphic",void 0),f([y()],pc.prototype,"mode",void 0),f([y({readOnly:!0})],pc.prototype,"state",null),f([y()],pc.prototype,"filesEnabled",void 0),f([y({readOnly:!0})],pc.prototype,"supportsResizeAttachments",null),pc=f([ge("esri.widgets.Attachments.AttachmentsViewModel")],pc);const j3=pc;function aY(i){const e=i.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function NQe(i){const e=zx("esri/themes/base/images/files/");return i?i==="text/plain"?`${e}text-32.svg`:i==="application/pdf"?`${e}pdf-32.svg`:i==="text/csv"?`${e}csv-32.svg`:i==="application/gpx+xml"?`${e}gpx-32.svg`:i==="application/x-dwf"?`${e}cad-32.svg`:i==="application/postscript"||i==="application/json"||i==="text/xml"||i==="model/vrml"?`${e}code-32.svg`:i==="application/x-zip-compressed"||i==="application/x-7z-compressed"||i==="application/x-gzip"||i==="application/x-tar"||i==="application/x-gtar"||i==="application/x-bzip2"||i==="application/gzip"||i==="application/x-compress"||i==="application/x-apple-diskimage"||i==="application/x-rar-compressed"||i==="application/zip"?`${e}zip-32.svg`:i.includes("image/")?`${e}image-32.svg`:i.includes("audio/")?`${e}sound-32.svg`:i.includes("video/")?`${e}video-32.svg`:i.includes("msexcel")||i.includes("ms-excel")||i.includes("spreadsheetml")?`${e}excel-32.svg`:i.includes("msword")||i.includes("ms-word")||i.includes("wordprocessingml")?`${e}word-32.svg`:i.includes("powerpoint")||i.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const oY={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},Mt={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},Gk=window.CSS;let Xo=class extends gr{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new j3,this.visibleElements={...oY},this._supportsImageOrientation=Gk&&Gk.supports&&Gk.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.addHandles([Sn(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),Sn(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),ue(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),At)])}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-icon-5dd27db1.js"),["./calcite-icon-5dd27db1.js","./icon-1a289254.js","./dom-5b7af1bf.js","./observers-c77bfda3.js"],import.meta.url)])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...oY,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(n=>(this._set("submitting",!1),this._set("error",null),t.mode="view",n)).catch(n=>{throw this._set("submitting",!1),this._set("error",new Ze("attachments:add-attachment",this.messages.addErrorMessage,n)),n})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(n=>(this._set("submitting",!1),this._set("error",null),t.mode="view",n)).catch(n=>{throw this._set("submitting",!1),this._set("error",new Ze("attachments:delete-attachment",this.messages.deleteErrorMessage,n)),n})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(n=>(this._set("submitting",!1),this._set("error",null),e.mode="view",n)).catch(n=>{throw this._set("submitting",!1),this._set("error",new Ze("attachments:update-attachment",this.messages.updateErrorMessage,n)),n})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){const t=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo.file);return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:n}=t;return z("div",{class:this.classes(Mt.base,Mt.esriWidget)},e?this.renderProgressBar():null,n==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?z("div",{key:"error-message",class:Mt.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:n}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(n||e):this.renderAttachmentContainer()}renderLoading(){return z("div",{class:Mt.loaderContainer,key:"loader"},z("div",{class:Mt.loader}))}renderProgressBar(){return this.visibleElements.progressBar?z("div",{class:Mt.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,n=e||!t,r=this.visibleElements.cancelAddButton?z("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(Mt.esriButton,Mt.esriButtonTertiary,Mt.esriButtonSmall,Mt.esriButtonHalf,e&&Mt.buttonDisabled)},this.messages.cancel):null,s=this.visibleElements.addSubmitButton?z("button",{type:"submit",disabled:n,class:this.classes(Mt.esriButton,Mt.esriButtonSecondary,Mt.esriButtonSmall,Mt.esriButtonHalf,{[Mt.buttonDisabled]:n})},this.messages.add):null,a=t?z("span",{key:"file-name",class:Mt.fileName},t.name):null,o=z("form",{bind:this,afterCreate:UI,afterRemoved:EG,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},z("fieldset",{class:Mt.fileFieldset},a,z("label",{class:this.classes(Mt.fileLabel,Mt.esriButton,Mt.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,z("input",{class:Mt.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),s,r);return z("div",{key:"add-form-container",class:Mt.formNode},o)}renderDetailsForm(e){const{visibleElements:t,viewModel:n,selectedFile:r,submitting:s}=this,{abilities:a}=n,o=s||!r;let l,c,u,d;r?(l=r.type,c=r.name,u=r.size):"file"in e?(l=e.file.type,c=e.file.name,u=e.file.size):(l=e.contentType,c=e.name,u=e.size,d=e.url);const h=a.editing&&a.operations.delete&&t.deleteButton?z("button",{key:"delete-button",type:"button",disabled:s,bind:this,onclick:C=>this._submitDeleteAttachment(C,e),class:this.classes(Mt.esriButton,Mt.esriButtonSmall,Mt.esriButtonTertiary,Mt.deleteButton,{[Mt.buttonDisabled]:s})},this.messages.delete):void 0,p=a.editing&&a.operations.update&&t.updateButton?z("button",{disabled:o,key:"update-button",type:"submit",class:this.classes(Mt.esriButton,Mt.esriButtonSmall,Mt.esriButtonThird,{[Mt.buttonDisabled]:o})},this.messages.update):void 0,m=this.visibleElements.cancelUpdateButton?z("button",{disabled:s,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(Mt.esriButton,Mt.esriButtonSmall,Mt.esriButtonTertiary,Mt.esriButtonThird,{[Mt.buttonDisabled]:s})},this.messages.cancel):void 0,g=a.editing&&a.operations.update?z("fieldset",{key:"file",class:Mt.fileFieldset},z("span",{key:"file-name",class:Mt.fileName},c),z("label",{class:this.classes(Mt.fileLabel,Mt.esriButton,Mt.esriButtonSecondary)},this.messages.changeFile,z("input",{class:Mt.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,_=z("fieldset",{key:"size",class:Mt.metadataFieldset},z("label",null,sQe(this.messagesUnits,u))),b=z("fieldset",{key:"content-type",class:Mt.metadataFieldset},z("label",null,l)),x=T(d)?z("a",{class:Mt.itemLink,href:d,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),z("div",{class:Mt.itemLinkOverlay},z("span",{class:Mt.itemLinkOverlayIcon},z("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),w=z("form",{bind:this,afterCreate:UI,afterRemoved:EG,"data-node-ref":"_updateAttachmentForm",onsubmit:C=>this._submitUpdateAttachment(C,e)},z("div",{class:Mt.metadata},_,b),g,z("div",{class:Mt.actions},h,m,p));return z("div",{key:"edit-form-container",class:Mt.formNode},x,w)}renderImageMask(e,t){return"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t)}renderGenericImageMask(e,t){const{supportsResizeAttachments:n}=this.viewModel,r=NQe(t),s={[Mt.itemImageResizable]:n};return z("div",{class:this.classes(Mt.itemMaskIcon,Mt.itemMask)},z("img",{title:e,alt:e,src:r,class:this.classes(s,Mt.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:n}=this.viewModel,{contentType:r,name:s,url:a}=e;if(!n||!aY(r))return this.renderGenericImageMask(s,r);const o=this._getCSSTransform(e),l=o?{transform:o,"image-orientation":"none"}:{},c=`${a}${a.includes("?")?"&":"?"}w=${t}`,u={[Mt.itemImageResizable]:n};return z("div",{class:this.classes(Mt.itemMask)},z("img",{styles:l,alt:s,title:s,src:c,class:this.classes(u,Mt.itemImage)}))}renderFile(e){const{file:t}=e;return z("li",{class:Mt.item,key:t},z("button",{key:"details-button",bind:this,class:Mt.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),z("label",{class:Mt.itemLabel},z("span",{class:Mt.itemFilename},t.name||this.messages.noTitle),z("span",{"aria-hidden":"true",class:this.classes(Mt.itemChevronIcon,Su(this.container)?Mt.iconLeft:Mt.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:n,effectiveDisplayType:r}=this,{abilities:s,supportsResizeAttachments:a}=n,{contentType:o,name:l,url:c}=e,u=this.renderImageMask(e,t==="list"?48:400),d=s.editing?z("span",{"aria-hidden":"true",class:this.classes(Mt.itemChevronIcon,Su(this.container)?Mt.iconLeft:Mt.iconRight)}):null,h=[u,r==="preview"&&a&&aY(o)?null:z("label",{class:Mt.itemLabel},z("span",{class:Mt.itemFilename},l||this.messages.noTitle),d)],p=s.editing?z("button",{key:"details-button",bind:this,class:Mt.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},h):z("a",{key:"details-link",class:Mt.itemButton,href:c,target:"_blank"},h);return z("li",{class:Mt.item,key:e},p)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:n}=this,{attachmentInfos:r,abilities:s,fileInfos:a}=t,o=!!(r!=null&&r.length),l=!!(a!=null&&a.length),c={[Mt.containerList]:e!=="preview",[Mt.containerPreview]:e==="preview"},u=s.editing&&s.operations.add&&n.addButton?z("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(Mt.esriButton,Mt.esriButtonTertiary,Mt.addAttachmentButton),type:"button"},z("span",{"aria-hidden":"true",class:this.classes(Mt.itemAddIcon,Mt.iconPlus)}),this.messages.add):void 0,d=o?z("ul",{key:"attachments-list",class:Mt.items},r.toArray().map(m=>this.renderAttachmentInfo({attachmentInfo:m,displayType:e}))):void 0,h=l?z("ul",{key:"file-list",class:Mt.items},a.toArray().map(m=>this.renderFile(m))):void 0,p=l||o?void 0:z("div",{class:Mt.empty},this.messages.noAttachments);return z("div",{key:"attachments-container",class:this.classes(Mt.container,c)},d,h,p,u)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,n=t&&t.files&&t.files.item(0);this._set("selectedFile",n)}_submitDeleteAttachment(e,t){e.preventDefault(),"file"in t?this.deleteFile(t.file):this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};f([y()],Xo.prototype,"abilities",null),f([y()],Xo.prototype,"displayType",void 0),f([y({readOnly:!0})],Xo.prototype,"effectiveDisplayType",null),f([y()],Xo.prototype,"graphic",null),f([y()],Xo.prototype,"label",null),f([y(),En("esri/widgets/Attachments/t9n/Attachments")],Xo.prototype,"messages",void 0),f([y(),En("esri/core/t9n/Units")],Xo.prototype,"messagesUnits",void 0),f([y({readOnly:!0})],Xo.prototype,"selectedFile",void 0),f([y({readOnly:!0})],Xo.prototype,"submitting",void 0),f([y({readOnly:!0})],Xo.prototype,"error",void 0),f([y({type:j3})],Xo.prototype,"viewModel",void 0),f([y()],Xo.prototype,"visibleElements",void 0),f([Mr("visibleElements")],Xo.prototype,"castVisibleElements",null),Xo=f([ge("esri.widgets.Attachments")],Xo);const Sue=Xo;let mS=class extends j3{constructor(e){super(e),this.description=null,this.title=null}};f([y()],mS.prototype,"description",void 0),f([y()],mS.prototype,"title",void 0),mS=f([ge("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],mS);const dU=mS,VQe={heading:"esri-widget__heading"};function Ul(i,e){const t=Eue(i.level),n=`h${t}`;return delete i.level,z(n,{...i,class:Ow(VQe.heading,i.class),role:"heading","aria-level":String(t)},e)}function Eue(i){return lt(Math.ceil(i),1,6)}function s0(i,e=1){return Eue(i+e)}const Wk={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let iw=class extends gr{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return z("div",{class:Wk.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?z(Ul,{level:this.headingLevel,class:Wk.title},e):null}renderDescription(){const{description:e}=this;return e?z("div",{key:"description",class:Wk.description},e):null}};f([y()],iw.prototype,"description",void 0),f([y()],iw.prototype,"headingLevel",void 0),f([y()],iw.prototype,"title",void 0),iw=f([ge("esri.widgets.Feature.support.FeatureElementInfo")],iw);const q3=iw,BQe={base:"esri-feature-attachments"};let sp=class extends gr{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new Sue,this.headingLevel=2,this.viewModel=new dU}initialize(){this._featureElementInfo=new q3,this.addHandles([ue(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),At),ue(()=>{var e;return(e=this.viewModel)==null?void 0:e.graphic},e=>this.attachmentsWidget.graphic=e,At)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return z("div",{class:BQe.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:n}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:n})}};f([y({readOnly:!0})],sp.prototype,"attachmentsWidget",void 0),f([y()],sp.prototype,"description",null),f([y()],sp.prototype,"displayType",null),f([y()],sp.prototype,"graphic",null),f([y()],sp.prototype,"headingLevel",void 0),f([y()],sp.prototype,"title",null),f([y({type:dU})],sp.prototype,"viewModel",void 0),sp=f([ge("esri.widgets.Feature.FeatureAttachments")],sp);const zQe=sp;let av=class extends Ba(et){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(ue(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},At))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:n}=this;e&&(S$(n,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const{graphic:t}=this,n=S$(e,{graphic:t}).catch(()=>null);this._loadingPromise=n,this.notifyChange("state");const r=await n;n===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",r))}};f([y({readOnly:!0})],av.prototype,"created",void 0),f([y()],av.prototype,"creator",void 0),f([y()],av.prototype,"destroyer",void 0),f([y({type:ao})],av.prototype,"graphic",void 0),f([y({readOnly:!0})],av.prototype,"state",null),av=f([ge("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],av);const E$=av;function dr(){return function(i,e){if(!i[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:HQe(i[e])}}}function UQe(i){const{type:e}=i;return i instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function HQe(i){return function(e,...t){UQe(e)?Sie(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):i.call(this,e,...t)}}function WC(i){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const t=e._delegatedEventNames,n=Array.isArray(i)?i:GQe(i);t.push(...n)}}function GQe(i){return i.split(",").map(e=>e.trim())}const Aue="calcite-theme-";function WQe(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function oA(){return WQe().startsWith("dark")}function jQe(){return`${Aue}${oA()?"dark":"light"}`}function qQe(i){KQe(i),i.classList.add(jQe())}function KQe(i){Array.from(i.classList).forEach(e=>{e.startsWith(Aue)&&i.classList.remove(e)})}const jk={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let nw=class extends gr{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=n=>{Array.from(n.querySelectorAll("a")).forEach(r=>{yue(r.href)&&!r.hasAttribute("target")&&r.setAttribute("target","_blank")})}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return z("div",{class:jk.loaderContainer,key:"loader"},z("div",{class:jk.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?z("div",{key:e,bind:e,afterCreate:this._attachToNode}):Bx(e)?z("div",{key:e},!e.destroyed&&e.render()):z("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return z("div",{class:jk.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};f([y()],nw.prototype,"creator",null),f([y()],nw.prototype,"graphic",null),f([y({type:E$})],nw.prototype,"viewModel",void 0),nw=f([ge("esri.widgets.Feature.FeatureContent")],nw);const VR=nw;let Kf=class extends et{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,n=[];return t==null||t.forEach(r=>{if(!(!r.hasOwnProperty("visible")||r.visible))return;const s=r.clone();s.label=_ue(s,e),n.push(s)}),n}};f([y()],Kf.prototype,"attributes",void 0),f([y({type:[m_e]})],Kf.prototype,"expressionInfos",void 0),f([y()],Kf.prototype,"description",void 0),f([y({type:[Die]})],Kf.prototype,"fieldInfos",void 0),f([y({readOnly:!0})],Kf.prototype,"formattedFieldInfos",null),f([y()],Kf.prototype,"title",void 0),Kf=f([ge("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],Kf);const K3=Kf,YQe=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function XQe(i){let e=null;return YQe.some(t=>(t.pattern.test(i)&&(e=t),!!e)),e}function ZQe(i,e){if(typeof e!="string"||!e)return e;const t=XQe(e);if(!t)return e;const n=e.match(t.pattern),r=n&&n[2],s=kx(kx(t.label,{messages:i,hierPart:r}),{appName:t.appName}),a=t.target?` target="${t.target}"`:"",o=t.target==="_blank"?' rel="noreferrer"':"";return e.replace(t.pattern,`<a${a} href="$1"${o}>${s}</a>`)}const _T={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let Gd=class extends gr{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new K3,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new q3,this.addHandles(ue(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),At))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:n}=this.viewModel,r=e.fieldName,s=e.label||r,a=n?n[r]==null?"":n[r]:"",o=!(!e.format||!e.format.dateFormat),l=typeof a=="number"&&!o?this._forceLTR(a):ZQe(this.messagesURIUtils,a),c={[_T.fieldDataDate]:o};return z("tr",{key:`fields-element-info-row-${r}-${t}`},z("th",{key:`fields-element-info-row-header-${r}-${t}`,class:_T.fieldHeader,innerHTML:s}),z("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes(_T.fieldData,c),innerHTML:l}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?z("table",{class:_T.esriTable,summary:this.messages.fieldsSummary},z("tbody",null,e.map((t,n)=>this.renderFieldInfo(t,n)))):null}render(){var e;return z("div",{class:_T.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};f([y()],Gd.prototype,"attributes",null),f([y()],Gd.prototype,"description",null),f([y()],Gd.prototype,"expressionInfos",null),f([y()],Gd.prototype,"fieldInfos",null),f([y()],Gd.prototype,"title",null),f([y({type:K3,nonNullable:!0})],Gd.prototype,"viewModel",void 0),f([y(),En("esri/widgets/Feature/t9n/Feature")],Gd.prototype,"messages",void 0),f([y(),En("esri/widgets/support/t9n/uriUtils")],Gd.prototype,"messagesURIUtils",void 0),Gd=f([ge("esri.widgets.Feature.FeatureFields")],Gd);const Mue=Gd,QQe=/^-?(\d+)(\.(\d+))?$/i;function JQe(i,e){return i-e}function eJe(i,e){let t,n;return t=Number(i.toFixed(e)),t<i?n=t+1/10**e:(n=t,t-=1/10**e),t=Number(t.toFixed(e)),n=Number(n.toFixed(e)),[t,n]}function tJe(i,e,t,n,r){const s=BR(i,e,t,n),a=s.previous==null||s.previous<=r,o=s.next==null||s.next<=r;return a&&o||s.previous+s.next<=2*r}function A$(i){const e=String(i),t=e.match(QQe);if(t&&t[1])return{integer:t[1].split("").length,fractional:t[3]?t[3].split("").length:0};if(e.toLowerCase().includes("e")){const n=e.split("e"),r=n[0],s=n[1];if(r&&s){const a=Number(r);let o=Number(s);const l=o>0;l||(o=Math.abs(o));const c=A$(a);return l?(c.integer+=o,o>c.fractional?c.fractional=0:c.fractional-=o):(c.fractional+=o,o>c.integer?c.integer=1:c.integer-=o),c}}return{integer:0,fractional:0}}function BR(i,e,t,n){const r={previous:null,next:null};if(t!=null){const s=i-t,a=e-t-s;r.previous=Math.floor(Math.abs(100*a/s))}if(n!=null){const s=n-i,a=n-e-s;r.next=Math.floor(Math.abs(100*a/s))}return r}function M$(i,e={}){const t=i.slice(0),{tolerance:n=2,strictBounds:r=!1,indexes:s=t.map((a,o)=>o)}=e;s.sort(JQe);for(let a=0;a<s.length;a++){const o=s[a],l=t[o],c=o===0?null:t[o-1],u=o===t.length-1?null:t[o+1],d=A$(l).fractional;if(d){let h,p=0,m=!1;for(;p<=d&&!m;){const g=eJe(l,p);h=r&&a===0?g[1]:g[0],m=tJe(l,h,c,u,n),p++}m&&(t[o]=h)}}return t}const iJe={maximumFractionDigits:20};function nJe(i){return lg(i,iJe)}const Pue="<",Oue=">",rJe=Iie("short-date");function Rue(i,e,t,n){let r="";e===0?r=`${Pue} `:e===t&&(r=`${Oue} `);let s=null;return s=n?HI(i,rJe):nJe(i),r+s}const sJe=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function zV(i){if(!("visualVariables"in i)||!i.visualVariables)return null;const e=i.visualVariables.find(a=>a.type==="color");if(!e)return null;let t=null,n=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;t=e.stops[0].value,n=e.stops[e.stops.length-1].value}const r=t+(n-t)/2,{getColor:s}=await Ee(()=>import("./visualVariableUtils-c59ab38d.js"),["./visualVariableUtils-c59ab38d.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./Graphic-b46e2684.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url);return s(e,r)}async function Iue(i,e){const t=i.trailCap,n=i.trailWidth||1,r=e||await zV(i)||i.color;return new s2({cap:t,color:r,width:n})}const aJe=new Xt([64,64,64]);function $ue(i,e){const t=[],n=i.length-1;return i.length===5?t.push(0,2,4):t.push(0,n),i.map((r,s)=>t.includes(s)?Rue(r,s,n,e):null)}async function UV(i,e,t){let n=!1,r=[],s=[];if(i.stops){const c=i.stops;r=c.map(u=>u.value),n=c.some(u=>!!u.label),n&&(s=c.map(u=>u.label))}const a=r[0],o=r[r.length-1];if(a==null&&o==null)return null;const l=n?null:$ue(r,t);return(await Promise.all(r.map(async(c,u)=>({value:c,color:i.type==="opacity"?await oJe(c,i,e):(await Ee(()=>import("./visualVariableUtils-c59ab38d.js"),["./visualVariableUtils-c59ab38d.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./Graphic-b46e2684.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url)).getColor(i,c),label:n?s[u]:l[u]})))).reverse()}async function oJe(i,e,t=aJe){const n=new Xt(t),r=(await Ee(()=>import("./visualVariableUtils-c59ab38d.js"),["./visualVariableUtils-c59ab38d.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./Graphic-b46e2684.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url)).getOpacity(e,i);return r!=null&&(n.a=r),n}function lJe(i){let e=!1,t=[],n=[];t=i.map(o=>o.value),e=i.some(o=>!!o.label),e&&(n=i.map(o=>o.label));const r=t[0],s=t[t.length-1];if(r==null&&s==null)return null;const a=e?null:$ue(t,!1);return t.map((o,l)=>({value:o,color:Lue(o,i),label:e?n[l]:a[l]})).reverse()}function Lue(i,e){const{startIndex:t,endIndex:n,weight:r}=cJe(i,e);if(t===n)return e[t].color;const s=Xt.blendColors(e[t].color,e[n].color,r);return new Xt(s)}function cJe(i,e){let t=0,n=e.length-1;return e.some((r,s)=>i<r.value?(n=s,!0):(t=s,!1)),{startIndex:t,endIndex:n,weight:(i-e[t].value)/(e[n].value-e[t].value)}}function uJe(i,e){let t=[];if(i&&i.type==="multipart")i.colorRamps.reverse().forEach((n,r)=>{r===0?t.push({value:e.max,color:new Xt(n.toColor),label:"high"}):t.push({value:null,color:new Xt(n.toColor),label:""}),r===i.colorRamps.length-1?t.push({value:e.min,color:new Xt(n.fromColor),label:"low"}):t.push({value:null,color:new Xt(n.fromColor),label:""})});else{let n,r;i&&i.type==="algorithmic"?(n=i.fromColor,r=i.toColor):(n=[0,0,0,1],r=[255,255,255,1]),t=[{value:e.max,color:new Xt(r),label:"high"},{value:e.min,color:new Xt(n),label:"low"}]}return t}function Due(i){if(!i.colorStops)return[];const e=[...i.colorStops].filter(n=>{var r;return((r=n.color)==null?void 0:r.a)>0});let t=e.length-1;if(e&&e[0]){const n=e[t];n&&n.ratio!==1&&(e.push(new $_e({ratio:1,color:n.color})),t++)}return e.map((n,r)=>{var a,o;let s="";return r===0?s=((a=i.legendOptions)==null?void 0:a.minLabel)||"low":r===t&&(s=((o=i.legendOptions)==null?void 0:o.maxLabel)||"high"),{color:n.color,label:s,ratio:n.ratio}}).reverse()}tt.getLogger("esri.renderers.support.utils");async function Gc(i,e,t){uS(i,e,()=>[]).push(...t)}async function dJe(i){var t,n;const e=new Map;if(!i)return e;if("visualVariables"in i&&i.visualVariables){const r=i.visualVariables.filter(s=>s.type==="color");for(const s of r){const a=(await UV(s)).map(o=>o.color);await Gc(e,s.field||s.valueExpression,a)}}if(i.type==="heatmap"){const r=Due(i).map(s=>s.color);await Gc(e,i.field||i.valueExpression,r)}else if(i.type==="pie-chart"){for(const r of i.attributes)await Gc(e,r.field||r.valueExpression,[r.color]);await Gc(e,"default",[(t=i==null?void 0:i.othersCategory)==null?void 0:t.color,Kb(i.backgroundFillSymbol,null)])}else if(i.type==="dot-density"){for(const r of i.attributes)await Gc(e,r.field||r.valueExpression,[r.color]);await Gc(e,"default",[i.backgroundColor])}else if(i.type==="unique-value")if(((n=i.authoringInfo)==null?void 0:n.type)==="predominance")for(const r of i.uniqueValueInfos??[])await Gc(e,r.value.toString(),[Kb(r.symbol,null)]);else{const r=(i.uniqueValueInfos??[]).map(c=>Kb(c.symbol,null)),{field:s,field2:a,field3:o,valueExpression:l}=i;(s||l)&&await Gc(e,s||l,r),a&&await Gc(e,a,r),o&&await Gc(e,o,r)}else if(i.type==="class-breaks"){const r=i.classBreakInfos.map(o=>Kb(o.symbol,null)),{field:s,valueExpression:a}=i;await Gc(e,s??a,r)}else i.type==="simple"&&await Gc(e,"default",[Kb(i.symbol,null)]);return"defaultSymbol"in i&&i.defaultSymbol&&await Gc(e,"default",[Kb(i.defaultSymbol,null)]),e.forEach((r,s)=>{const a=HA(r.filter(Boolean),(o,l)=>JSON.stringify(o)===JSON.stringify(l));e.set(s,a)}),e}const hJe="esri.widgets.Feature.support.relatedFeatureUtils",lY=tt.getLogger(hJe),cY=new Map;function HV(i){if(!Mm(i))return null;const[e,t]=i.split("/").slice(1);return{layerId:e,fieldName:t}}function pJe(i,e){if(!e.relationships)return null;let t=null;const{relationships:n}=e;return n.some(r=>r.id===parseInt(i,10)&&(t=r,!0)),t}function fJe({originRelationship:i,relationships:e,layerId:t}){let n;return e&&e.some(r=>(`${r.relatedTableId}`===t&&r.id===i.id&&(n=r),!!n)),n}function mJe(i,e){const t=e.toLowerCase();for(const n in i)if(n.toLowerCase()===t)return i[n];return null}function gJe(i,e){const t=pJe(i,e);if(t)return{url:`${e.url}/${t.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:t,relatedFields:[],outStatistics:[]}}function vJe(i,e){if(!e||!i)return;const{features:t,statsFeatures:n}=i,r=t&&t.value;e.relatedFeatures=r?r.features:[];const s=n&&n.value;e.relatedStatsFeatures=s?s.features:[]}function yJe(i,e,t,n){const r=new DN;return r.outFields=["*"],r.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),r.objectIds=[i.attributes[t.objectIdField]],t.queryRelatedFeatures(r,n)}function _Je(i,e,t){let n=0;const r=[];for(;n<e.length;)r.push(`${i} IN (${e.slice(n,t+n)})`),n+=t;return r.join(" OR ")}async function bJe(i,e,t,n){const r=t.layerId.toString(),{layerInfo:s,relation:a,relatedFields:o,outStatistics:l,url:c,sourceSpatialReference:u}=e,d=fJe({originRelationship:a,relationships:s.relationships,layerId:r});if(d.relationshipTableId&&d.keyFieldInRelationshipTable){const p=(await yJe(i,d,t,n))[i.attributes[t.objectIdField]];if(!p)return null;const m=p.features.map(g=>g.attributes[s.objectIdField]);if((l==null?void 0:l.length)>0&&s.supportsStatistics){const g=new eR;g.where=_Je(s.objectIdField,m,1e3),g.outFields=o,g.outStatistics=l,g.sourceSpatialReference=u;const _={features:Promise.resolve(p),statsFeatures:QD(c,g)};return Ra(_)}}const h=d==null?void 0:d.keyField;if(h){const p=JO(SJe(s.fields,h)),m=mJe(i.attributes,a.keyField),g=p?`${h}=${m}`:`${h}='${m}'`,_=QD(c,new eR({where:g,outFields:e.relatedFields,sourceSpatialReference:u}),n),b=e.outStatistics&&e.outStatistics.length>0&&s.supportsStatistics?QD(c,new eR({where:g,outFields:e.relatedFields,outStatistics:e.outStatistics,sourceSpatialReference:u}),n):null,x={features:_};return b&&(x.statsFeatures=b),Ra(x)}return null}function wJe(i,e){return Mc(i,{query:{f:"json"},signal:e&&e.signal})}function xJe({relatedInfos:i,layer:e},t){const n={};return i.forEach((r,s)=>{const{relation:a}=r;if(!a){const d=new Ze("relation-required","A relation is required on a layer to retrieve related records.");throw lY.error(d),d}const{relatedTableId:o}=a;if(typeof o!="number"){const d=new Ze("A related table ID is required on a layer to retrieve related records.");throw lY.error(d),d}const l=`${e.url}/${o}`,c=cY.get(l),u=c||wJe(l,t);c||cY.set(l,u),n[s]=u}),Ra(n)}function CJe({graphic:i,relatedInfos:e,layer:t},n){const r={};return e.forEach((s,a)=>{s.layerInfo&&(r[a]=bJe(i,s,t,n))}),Ra(r)}function TJe({relatedInfo:i,fieldName:e,fieldInfo:t}){if(i.relatedFields.push(e),t.statisticType){const n=new D_e({statisticType:t.statisticType,onStatisticField:e,outStatisticFieldName:e});i.outStatistics.push(n)}}function SJe(i,e){if(i!=null){e=e.toLowerCase();for(const t of i)if(t&&t.name.toLowerCase()===e)return t}return null}const uY={chartAnimation:!0};let Ta=class extends et{constructor(e){super(e),this.abilities={...uY},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...uY,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,n=(e+t)%t;this.activeMediaInfoIndex=n}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,n=t+e;this._setContentElementMedia(n)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:n,expressionAttributes:r,fieldInfoMap:s,layer:a}=this;return t==null?void 0:t.map(o=>{const l=o==null?void 0:o.clone();if(!l)return null;if(l.title=S0({attributes:e,fieldInfoMap:s,globalAttributes:n,expressionAttributes:r,layer:a,text:l.title}),l.caption=S0({attributes:e,fieldInfoMap:s,globalAttributes:n,expressionAttributes:r,layer:a,text:l.caption}),l.altText=S0({attributes:e,fieldInfoMap:s,globalAttributes:n,expressionAttributes:r,layer:a,text:l.altText}),l.type==="image"){const{value:c}=l;return this._setImageValue({value:c,formattedAttributes:n,layer:a}),l.value.sourceURL?l:void 0}if(l.type==="pie-chart"||l.type==="line-chart"||l.type==="column-chart"||l.type==="bar-chart"){const{value:c}=l;return this._setChartValue({value:c,chartType:l.type,attributes:e,formattedAttributes:n,layer:a,expressionAttributes:r}),l}return null}).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:n,formattedAttributes:r,layer:s}=e,{linkURL:a,sourceURL:o}=n;if(o){const l=BV(o,s);n.sourceURL=VV({formattedAttributes:r,template:l,fieldInfoMap:t})}if(a){const l=BV(a,s);n.linkURL=VV({formattedAttributes:r,template:l,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:n,formattedAttributes:r,chartType:s,layer:a,expressionAttributes:o}=e,{popupTemplate:l,relatedInfos:c}=this,{fields:u,normalizeField:d}=t;if(t.fields=vQe(u,a),d&&(t.normalizeField=aA(d,a)),!u.some(p=>!!(r[p]!=null||Mm(p)&&c.size)))return;const h=l==null?void 0:l.fieldInfos;u.forEach(p=>{if(Mm(p))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:h,fieldName:p,formattedAttributes:r,chartType:s,value:t})]);const m=this._getChartOption({value:t,attributes:n,chartType:s,formattedAttributes:r,expressionAttributes:o,fieldName:p,fieldInfos:h});t.series.push(m)})}_getRelatedChartInfos(e){var g;const{fieldInfos:t,fieldName:n,formattedAttributes:r,chartType:s,value:a}=e,o=[],l=HV(n),{layerId:c,fieldName:u}=l,d=(g=this.relatedInfos)==null?void 0:g.get(c.toString());if(!d)return o;const{relatedFeatures:h,relation:p}=d;if(!p||!h)return o;const{cardinality:m}=p;return h.forEach(_=>{const{attributes:b}=_;b&&Object.keys(b).forEach(x=>{x===u&&o.push(this._getChartOption({value:a,attributes:b,formattedAttributes:r,fieldName:n,chartType:s,relatedFieldName:x,fieldInfos:t}))})}),m==="one-to-many"||m==="many-to-many"?o:[o[0]]}_getTooltip({label:e,value:t,chartType:n}){return n==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var S;const{value:t,attributes:n,formattedAttributes:r,expressionAttributes:s,fieldName:a,relatedFieldName:o,fieldInfos:l,chartType:c}=e,{layer:u,fieldInfoMap:d}=this,{normalizeField:h,tooltipField:p}=t,m=h?Mm(h)?n[HV(h).fieldName]:n[h]:null,g=lU(a)&&s&&s[a]!==void 0?s[a]:o&&n[o]!==void 0?n[o]:n[a]!==void 0?n[a]:r[a],_=new g_e({fieldName:a,value:g===void 0?null:g&&m?g/m:g});if(Mm(a)){const E=d.get(a.toLowerCase()),A=d.get(p.toLowerCase()),P=(E==null?void 0:E.fieldName)??a,O=r[(A==null?void 0:A.fieldName)??p]??(E==null?void 0:E.label)??(E==null?void 0:E.fieldName)??o,M=r[P];return _.tooltip=this._getTooltip({label:O,value:M,chartType:c}),_}const b=wue(l,a),x=aA(a,u),w=p&&r[p]!==void 0?r[p]:_ue(b||new Die({fieldName:x}),(S=this.popupTemplate)==null?void 0:S.expressionInfos),C=r[x];return _.tooltip=this._getTooltip({label:w,value:C,chartType:c}),_}};f([y()],Ta.prototype,"abilities",void 0),f([Mr("abilities")],Ta.prototype,"castAbilities",null),f([y()],Ta.prototype,"activeMediaInfoIndex",void 0),f([y({readOnly:!0})],Ta.prototype,"activeMediaInfo",null),f([y()],Ta.prototype,"attributes",void 0),f([y()],Ta.prototype,"description",void 0),f([y()],Ta.prototype,"fieldInfoMap",void 0),f([y()],Ta.prototype,"formattedAttributes",void 0),f([y()],Ta.prototype,"expressionAttributes",void 0),f([y({readOnly:!0})],Ta.prototype,"formattedMediaInfos",null),f([y()],Ta.prototype,"layer",void 0),f([y({readOnly:!0})],Ta.prototype,"formattedMediaInfoCount",null),f([y()],Ta.prototype,"mediaInfos",void 0),f([y()],Ta.prototype,"popupTemplate",void 0),f([y()],Ta.prototype,"relatedInfos",void 0),f([y()],Ta.prototype,"title",void 0),Ta=f([ge("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],Ta);const E0=Ta;var dY=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],EJe=[].concat(dY.slice(30,39),dY.slice(28,30).reverse()),AJe=[{name:"default",colors:EJe},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const hY="en-us",hU=new Map([["ar",()=>Ee(()=>import("./ar-7e4d7001.js"),["./ar-7e4d7001.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.a)],["bg-bg",()=>Ee(()=>import("./bg_BG-fa0eaeae.js"),["./bg_BG-fa0eaeae.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.b)],["bs-ba",()=>Ee(()=>import("./bs_BA-4f949e9b.js"),["./bs_BA-4f949e9b.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.b)],["ca-es",()=>Ee(()=>import("./ca_ES-ac250c21.js"),["./ca_ES-ac250c21.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.c)],["cs-cz",()=>Ee(()=>import("./cs_CZ-41aa2dde.js"),["./cs_CZ-41aa2dde.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.c)],["da-dk",()=>Ee(()=>import("./da_DK-3cc83778.js"),["./da_DK-3cc83778.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.d)],["de-de",()=>Ee(()=>import("./de_DE-7cf156b8.js"),["./de_DE-7cf156b8.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.d)],["de-ch",()=>Ee(()=>import("./de_CH-b40119c2.js"),["./de_CH-b40119c2.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.d)],["el-gr",()=>Ee(()=>import("./el_GR-f5b4e421.js"),["./el_GR-f5b4e421.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.e)],["en-us",()=>Ee(()=>import("./en_US-b653138f.js"),["./en_US-b653138f.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.e)],["en-ca",()=>Ee(()=>import("./en_CA-b653138f.js"),["./en_CA-b653138f.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.e)],["es-es",()=>Ee(()=>import("./es_ES-21713ea8.js"),["./es_ES-21713ea8.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.e)],["et-ee",()=>Ee(()=>import("./et_EE-7e4a5525.js"),["./et_EE-7e4a5525.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.e)],["fi-fi",()=>Ee(()=>import("./fi_FI-9ff24319.js"),["./fi_FI-9ff24319.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.f)],["fr-fr",()=>Ee(()=>import("./fr_FR-51c37695.js"),["./fr_FR-51c37695.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.f)],["he-il",()=>Ee(()=>import("./he_IL-5c441159.js"),["./he_IL-5c441159.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.h)],["hr-hr",()=>Ee(()=>import("./hr_HR-f42ffa87.js"),["./hr_HR-f42ffa87.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.h)],["hu-hu",()=>Ee(()=>import("./hu_HU-5fba6ab9.js"),["./hu_HU-5fba6ab9.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.h)],["id-id",()=>Ee(()=>import("./id_ID-981fbb86.js"),["./id_ID-981fbb86.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.i)],["it-it",()=>Ee(()=>import("./it_IT-c635b784.js"),["./it_IT-c635b784.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.i)],["ja-jp",()=>Ee(()=>import("./ja_JP-e2cf7b21.js"),["./ja_JP-e2cf7b21.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.j)],["ko-kr",()=>Ee(()=>import("./ko_KR-32aae4f2.js"),["./ko_KR-32aae4f2.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.k)],["lt-lt",()=>Ee(()=>import("./lt_LT-3c0b9d54.js"),["./lt_LT-3c0b9d54.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.l)],["lv-lv",()=>Ee(()=>import("./lv_LV-c1cc4a4c.js"),["./lv_LV-c1cc4a4c.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.l)],["nb-no",()=>Ee(()=>import("./nb_NO-5958d98d.js"),["./nb_NO-5958d98d.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.n)],["nl-nl",()=>Ee(()=>import("./nl_NL-004b20fd.js"),["./nl_NL-004b20fd.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.n)],["pl-pl",()=>Ee(()=>import("./pl_PL-d6d01c5e.js"),["./pl_PL-d6d01c5e.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.p)],["pt-br",()=>Ee(()=>import("./pt_BR-a08a6ce1.js"),["./pt_BR-a08a6ce1.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.p)],["pt-pt",()=>Ee(()=>import("./pt_PT-d532c840.js"),["./pt_PT-d532c840.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.p)],["ro-ro",()=>Ee(()=>import("./ro_RO-e4007f77.js"),["./ro_RO-e4007f77.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.r)],["ru-ru",()=>Ee(()=>import("./ru_RU-905ac2e8.js"),["./ru_RU-905ac2e8.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.r)],["sk-sk",()=>Ee(()=>import("./sk_SK-cae815ce.js"),["./sk_SK-cae815ce.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.s)],["sl-sl",()=>Ee(()=>import("./sl_SL-50353bbe.js"),["./sl_SL-50353bbe.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.s)],["sr-rs",()=>Ee(()=>import("./sr_RS-9a9b8450.js"),["./sr_RS-9a9b8450.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.s)],["sv-se",()=>Ee(()=>import("./sv_SE-346c1643.js"),["./sv_SE-346c1643.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.s)],["th-th",()=>Ee(()=>import("./th_TH-210af5ed.js"),["./th_TH-210af5ed.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.t)],["tr-tr",()=>Ee(()=>import("./tr_TR-855c517f.js"),["./tr_TR-855c517f.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.t)],["uk-ua",()=>Ee(()=>import("./uk_UA-7de21af4.js"),["./uk_UA-7de21af4.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.u)],["vi-vn",()=>Ee(()=>import("./vi_VN-f87f03fa.js"),["./vi_VN-f87f03fa.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.v)],["zh-cn",()=>Ee(()=>import("./zh_Hans-79f10982.js"),["./zh_Hans-79f10982.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.z)],["zh-hk",()=>Ee(()=>import("./zh_Hant-abc409cd.js"),["./zh_Hant-abc409cd.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.z)],["zh-tw",()=>Ee(()=>import("./zh_Hant-abc409cd.js"),["./zh_Hant-abc409cd.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(i=>i.z)]]);function MJe(i){const e=i.split("-")[0].toLowerCase();let t=null;for(const n of hU.keys())if(n.startsWith(e)){t=n;break}return t}function PJe(i){return i?hU.has(i.toLowerCase())?i.toLowerCase():MJe(i)||hY:hY}let e1,bT;async function OJe(i=NN()){if(i=PJe(i),e1&&i===bT)return e1;e1=Ee(()=>import("./index-3c8f1bc3.js"),["./index-3c8f1bc3.js","./_commonjsHelpers-a430e9ea.js"],import.meta.url).then(e=>e.i),bT=i;try{const[e,t]=await Promise.all([e1,hU.get(bT)()]);bT===i&&(e.am4core.options.defaultLocale=t.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return e1=null,bT=null,null}return e1}function RJe(i,e="default"){const t=AJe.find(n=>n.name===e);return t?t.colors.map(n=>i.color(n)):null}const vs={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},qk=.05,Kk=.95,Yk=15,Af="color",Og="tooltip",wT="value",pY="default-line-value";let fc=class extends gr{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new E0,this.messages=null,this._getChartDependencies=async n=>{const r=await OJe(),{destroyed:s,viewModel:a}=this;if(s||!a||!n)return;const{activeMediaInfo:o}=a,l=await this._getRendererColors(r);this._renderChart({chartDiv:n,mediaInfo:o,chartsModule:r,colorMap:l})}}initialize(){this._featureElementInfo=new q3,this.addHandles([ue(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(t=this.viewModel)==null?void 0:t.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),At),ue(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),At)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return z("div",{bind:this,class:vs.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?z("div",{key:"media-element-container",class:vs.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:n,formattedMediaInfoCount:r}=this.viewModel,{value:s,refreshInterval:a,altText:o,title:l,type:c}=e,{sourceURL:u,linkURL:d}=s,h=yue(d)?"_blank":"_self",p=h==="_blank"?"noreferrer":"",m=a?t:null,g=m?m.timestamp:0,_=m?m.sourceURL:u,b=z("img",{alt:o||l,key:`media-${c}-${n}-${r}-${g}`,src:_});return(d?z("a",{title:l,href:d,rel:p,target:h},b):null)||b}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:n}=this.viewModel;return z("div",{key:`media-${e.type}-${t}-${n}`,bind:this,class:vs.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?z("div",{key:"media-title",class:vs.mediaItemTitle,innerHTML:e.title}):null,n=e.caption?z("div",{key:"media-caption",class:vs.mediaItemCaption,innerHTML:e.caption}):null;return z("div",{key:"media-container",class:vs.mediaItemContainer},z("div",{key:"media-item-container",class:vs.mediaItem},this.renderMediaInfoType()),t,n)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=e==="previous",n=t?this.messages.previous:this.messages.next,r=t?this.classes(vs.mediaButton,vs.mediaPrevious):this.classes(vs.mediaButton,vs.mediaNext),s=t?this.classes(vs.mediaIcon,vs.mediaPreviousIconLTR,vs.iconLeftTriangleArrow):this.classes(vs.mediaIcon,vs.mediaNextIconLTR,vs.iconRightTriangleArrow),a=t?this.classes(vs.mediaIcon,vs.mediaPreviousIconRTL,vs.iconRightTriangleArrow):this.classes(vs.mediaIcon,vs.mediaNextIconRTL,vs.iconLeftTriangleArrow),o=t?"media-previous":"media-next",l=t?this._previous:this._next;return z("button",{type:"button",key:o,title:n,"aria-label":n,tabIndex:0,class:r,bind:this,onclick:l},z("span",{"aria-hidden":"true",class:s}),z("span",{"aria-hidden":"true",class:a}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){var o,l;const{am4core:t}=e,n=new Map,r=(l=(o=this.viewModel)==null?void 0:o.layer)==null?void 0:l.renderer,s="default";if(!r)return n;const a=await dJe(r);return a.delete(s),Array.from(a.values()).every(c=>(c==null?void 0:c.length)===1)&&(n.set(pY,t.color({r:50,g:50,b:50,a:1})),Array.from(a.keys()).forEach(c=>{c&&n.set(c,t.color(a.get(c)[0].toCss(!0)))})),n}_handleMediaKeyup(e){const t=Uv(e);t==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:n,chartDiv:r,mediaInfo:s,colorMap:a}=e,{value:o,type:l}=s,{am4core:c}=n,u=RJe(c);function d(m){m instanceof c.ColorSet&&u&&(m.list=u)}oA()&&c.useTheme(n.am4themes_dark);const h=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!h.matches?c.useTheme(n.am4themes_animated):c.unuseTheme(n.am4themes_animated),c.useTheme(d);const p=l==="pie-chart"?this._createPieChart(e):this._createXYChart(e);r.setAttribute("aria-label",s.altText||s.title),p.data=o.series.map(m=>({[Og]:m.tooltip,[wT]:m.value,[Af]:a.get(m.fieldName)})).filter(m=>l!=="pie-chart"||m.value>0)}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:n}=e,{am4core:r,am4charts:s}=n,a=r.create(t,s.PieChart);a.rtl=Su(this.container);const o=a.series.push(new s.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value=wT,o.dataFields.category=Og,this._customizeChartTooltip(o.tooltip,r),o.slices.template.propertyFields.fill=Af,o.slices.template.propertyFields.stroke=Af,a}_getMinSeriesValue(e){let t=0;return e.forEach(n=>t=Math.min(n.value,t)),t}_createColumnChart(e,t){const{chartsModule:n,mediaInfo:r}=t,{value:s}=r,{am4core:a,am4charts:o}=n,l=e.xAxes.push(new o.CategoryAxis);l.dataFields.category=Og,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,a),l.tooltip.events.on("sizechanged",()=>{l.tooltip.dy=-l.tooltip.contentHeight});const c=e.yAxes.push(new o.ValueAxis),u=c.renderer.labels.template;c.renderer.minLabelPosition=qk,c.renderer.maxLabelPosition=Kk,c.min=this._getMinSeriesValue(s.series),this._customizeChartTooltip(c.tooltip,a),u.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueY=wT,d.dataFields.categoryX=Og,d.columns.template.propertyFields.fill=Af,d.columns.template.propertyFields.stroke=Af,e.cursor=new o.XYCursor,s.series.length>Yk&&(e.scrollbarX=new a.Scrollbar)}_createBarChart(e,t){const{chartsModule:n,mediaInfo:r}=t,{value:s}=r,{am4core:a,am4charts:o}=n,l=e.yAxes.push(new o.CategoryAxis);l.dataFields.category=Og,l.renderer.inversed=!0,l.renderer.labels.template.disabled=!0,this._customizeChartTooltip(l.tooltip,a),l.tooltip.events.on("sizechanged",()=>{l.tooltip.dx=l.tooltip.contentWidth});const c=e.xAxes.push(new o.ValueAxis),u=c.renderer.labels.template;c.renderer.minLabelPosition=qk,c.renderer.maxLabelPosition=Kk,c.min=this._getMinSeriesValue(s.series),this._customizeChartTooltip(c.tooltip,a),u.wrap=!0;const d=e.series.push(new o.ColumnSeries);d.dataFields.valueX=wT,d.dataFields.categoryY=Og,d.columns.template.propertyFields.fill=Af,d.columns.template.propertyFields.stroke=Af,e.cursor=new o.XYCursor,s.series.length>Yk&&(e.scrollbarY=new a.Scrollbar)}_createLineChart(e,t){const{chartsModule:n,mediaInfo:r,colorMap:s}=t,{value:a}=r,{am4core:o,am4charts:l}=n,c=e.xAxes.push(new l.CategoryAxis);c.dataFields.category=Og,c.renderer.labels.template.disabled=!0,this._customizeChartTooltip(c.tooltip,o),c.tooltip.events.on("sizechanged",()=>{c.tooltip.dy=-c.tooltip.contentHeight});const u=e.yAxes.push(new l.ValueAxis),d=u.renderer.labels.template;u.renderer.minLabelPosition=qk,u.renderer.maxLabelPosition=Kk,u.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(u.tooltip,o),d.wrap=!0;const h=e.series.push(new l.LineSeries);h.dataFields.categoryX=Og,h.dataFields.valueY=wT,h.strokeWidth=1;const p=s.get(pY);p&&(h.stroke=p);const m=h.bullets.push(new l.CircleBullet);m.propertyFields.fill=Af,m.propertyFields.stroke=Af,e.cursor=new l.XYCursor,a.series.length>Yk&&(e.scrollbarX=new o.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:n,mediaInfo:r}=e,{type:s}=r,{am4core:a,am4charts:o}=n,l=a.create(t,o.XYChart);return l.rtl=Su(this.container),s==="column-chart"&&this._createColumnChart(l,e),s==="bar-chart"&&this._createBarChart(l,e),s==="line-chart"&&this._createLineChart(l,e),l}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&e.type==="image"&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:n}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(n.sourceURL);const s=setInterval(()=>{this._updateMediaInfoTimestamp(n.sourceURL)},r);this._refreshTimer=s}_getImageSource(e,t){const n=e.includes("?")?"&":"?",[r,s=""]=e.split("#");return`${r}${n}timestamp=${t}${s?"#":""}${s}`}};f([y()],fc.prototype,"attributes",null),f([y()],fc.prototype,"activeMediaInfoIndex",null),f([y()],fc.prototype,"description",null),f([y()],fc.prototype,"fieldInfoMap",null),f([y()],fc.prototype,"layer",null),f([y()],fc.prototype,"mediaInfos",null),f([y()],fc.prototype,"popupTemplate",null),f([y()],fc.prototype,"relatedInfos",null),f([y()],fc.prototype,"title",null),f([y({type:E0})],fc.prototype,"viewModel",void 0),f([y(),En("esri/widgets/Feature/t9n/Feature")],fc.prototype,"messages",void 0),fc=f([ge("esri.widgets.Feature.FeatureMedia")],fc);const kue=fc,IJe=["$datastore","$map","$layer","$aggregatedfeatures"],$Je="esri.widgets.Feature.support.arcadeFeatureUtils",LJe=tt.getLogger($Je);function DJe(i){return typeof i=="string"?pM(uU(i)):Array.isArray(i)?kJe(i):(i==null?void 0:i.declaredClass)==="esri.arcade.Dictionary"?FJe(i):i}function kJe(i){return`<ul class="esri-widget__list">${i.map(e=>`<li>${typeof e=="string"?pM(uU(e)):e}</li>`).join("")}</ul>`}function FJe(i){return`<table class="esri-widget__table">${i.keys().map(e=>{const t=i.field(e);return`<tr><th>${e}</th><td>${typeof t=="string"?pM(uU(t)):t}</td></tr>`}).join("")}</table>`}function NJe({aggregatedFeatures:i,arcadeUtils:e,featureSetVars:t,context:n,viewInfo:r,map:s,graphic:a,interceptor:o}){t.forEach(l=>{const c=l.toLowerCase(),u={map:s,spatialReference:r.sr,interceptor:o};if(c==="$map"&&(n.vars[c]=e.convertMapToFeatureSetCollection(u)),c==="$layer"&&(n.vars[c]=e.convertFeatureLayerToFeatureSet({layer:a.sourceLayer,spatialReference:r.sr,interceptor:o})),c==="$datastore"&&(n.vars[c]=e.convertServiceUrlToWorkspace({url:a.sourceLayer.url,spatialReference:r.sr,interceptor:o})),c==="$aggregatedfeatures"){const d=a.layer,{fields:h,objectIdField:p,geometryType:m,spatialReference:g,displayField:_}=d,b=new gp({fields:h,objectIdField:p,geometryType:m,spatialReference:g,displayField:_,...d.type==="feature"?{templates:d.templates,typeIdField:d.typeIdField,types:d.types}:null,source:i});n.vars[c]=e.convertFeatureLayerToFeatureSet({layer:b,spatialReference:r.sr,interceptor:o})}})}function Fue(){return Ee(()=>import("./arcadeUtils-b28b36c7.js").then(i=>i.aw),["./arcadeUtils-b28b36c7.js","./geometry-5a216427.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./Extent-69509002.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./preload-helper-41c905a7.js","./datetime-4f774298.js","./number-bd3c06fb.js","./locale-30120714.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./jsonUtils-03c4af61.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./request-d3e98716.js","./unitUtils-47abac71.js","./hash-0ddfbf4b.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url)}function VJe(i){return"createQuery"in i&&"queryFeatures"in i}async function BJe({graphic:i,view:e}){const{isAggregate:t,layer:n}=i;if(!t||!n||(e==null?void 0:e.type)!=="2d")return[];const r=await e.whenLayerView(n);if(!VJe(r))return[];const s=r.createQuery();s.aggregateIds=[i.getObjectId()];const{features:a}=await r.queryFeatures(s);return a}async function Nue({expressionInfo:i,arcadeUtils:e,interceptor:t,spatialReference:n,map:r,graphic:s,view:a}){if(!i||!i.expression)return null;const o=e.createSyntaxTree(i.expression),l=IJe.filter(p=>e.hasVariable(o,p)),[c]=await Promise.all([BJe({graphic:s,view:a}),e.loadScriptDependencies(o,!0,l)]),u=e.getViewInfo({spatialReference:n}),d=e.createExecContext(s,u);d.interceptor=t,d.useAsync=!0,NJe({aggregatedFeatures:c,arcadeUtils:e,featureSetVars:l,context:d,viewInfo:u,map:r,graphic:s,interceptor:t});const h=e.createFunction(o,d);return e.executeAsyncFunction(h,d).catch(p=>LJe.error("arcade-execution-error",{error:p,graphic:s,expressionInfo:i}))}async function zJe({expressionInfos:i,spatialReference:e,graphic:t,interceptor:n,map:r,view:s}){if(!i||!i.length)return{};const a=await Fue(),o={};for(const u of i)o[`expression/${u.name}`]=Nue({expressionInfo:u,arcadeUtils:a,interceptor:n,spatialReference:e,map:r,graphic:t,view:s});const l=await Ra(o),c={};for(const u in l)c[u]=DJe(l[u].value);return c}const UJe=1;let tu=class extends Ba(et){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:t}=this;t&&t.abort(),this._abortController=null},this._createVM=()=>{var r,s;const t=(r=this.contentElement)==null?void 0:r.type;(s=this.contentElementViewModel)==null||s.destroy();const n=t==="fields"?new K3:t==="media"?new E0:t==="text"?new E$:null;this._set("contentElementViewModel",n)},this._compile=async()=>{this._cancelQuery();const t=new AbortController;this._abortController=t,await this._compileExpression(),this._abortController===t&&(this._abortController=null)},this._compileThrottled=wx(this._compile,UJe,this),this._compileExpression=async()=>{const{expressionInfo:t,graphic:n,interceptor:r,spatialReference:s,map:a,view:o,_abortController:l}=this;if(!(t&&n&&s&&a))return void this._set("contentElement",null);const c=await Fue();if(l!==this._abortController)return;const u=await Nue({arcadeUtils:c,expressionInfo:t,graphic:n,interceptor:r,map:a,spatialReference:s,view:o});if(!u||u.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const d=await u.castAsJsonAsync(l.signal),h=d==null?void 0:d.type,p=h==="media"?v_e.fromJSON(d):h==="text"?kie.fromJSON(d):h==="fields"?y_e.fromJSON(d):null;this._set("contentElement",p)},this.handles.add([ue(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),At),ue(()=>[this.contentElement],()=>this._createVM(),At)])}destroy(){var e;this._cancelQuery(),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:n}=this;return e?"loading":t||n?"ready":"disabled"}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}};f([y()],tu.prototype,"_abortController",void 0),f([y({type:__e})],tu.prototype,"expressionInfo",void 0),f([y({type:ao})],tu.prototype,"graphic",void 0),f([y({readOnly:!0})],tu.prototype,"contentElement",void 0),f([y({readOnly:!0})],tu.prototype,"contentElementViewModel",void 0),f([y()],tu.prototype,"interceptor",void 0),f([y()],tu.prototype,"spatialReference",null),f([y({readOnly:!0})],tu.prototype,"state",null),f([y()],tu.prototype,"map",null),f([y()],tu.prototype,"view",void 0),tu=f([ge("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],tu);const pU=tu,lP={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let zR=class extends gr{constructor(e,t){super(e,t),this.viewModel=new pU}initialize(){this.addHandles(ue(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),At))}destroy(){this._destroyContentWidget()}renderLoading(){return z("div",{key:"loading-container",class:lP.loadingSpinnerContainer},z("span",{class:this.classes(lP.iconLoading,lP.spinner)}))}render(){var t;const{state:e}=this.viewModel;return z("div",{class:lP.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,n=t==null?void 0:t.type;this._destroyContentWidget();const r=e?n==="fields"?new Mue({viewModel:e}):n==="media"?new kue({viewModel:e}):n==="text"?new VR({viewModel:e}):null:null;this._contentWidget=r,this.scheduleRender()}};f([y({type:pU})],zR.prototype,"viewModel",void 0),zR=f([ge("esri.widgets.Feature.FeatureExpression")],zR);const HJe=zR,Xk=100;let Or=class extends _ie(RC(Ba(et))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await iy(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await iy(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await iy(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=wx(this._queryController,Xk,this),this._queryFeatureCountThrottled=wx(this._queryFeatureCountController,Xk,this),this._queryPageThrottled=wx(this._queryPageController,Xk,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:n}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,n.removeAll(),n.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([ue(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled],()=>this._queryThrottled(),At),ue(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),ue(()=>[this.layer,this.relationshipId,this.objectId],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:n}=this,r=1,s=Math.ceil(n/t)||1;this._set("featurePage",Math.min(Math.max(e,r),s))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t!=null&&t.loaded)?e.map(n=>{const r=n.clone(),s=aA(n.field,t);return r.field=s,r}):e}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return((t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField])??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new _i}get relatedLayer(){const{layer:e,map:t,relationship:n}=this;return e!=null&&e.loaded?FQe(t,e,n):null}get relationship(){var n;const{relationshipId:e,layer:t}=this;return typeof e=="number"?((n=t==null?void 0:t.relationships)==null?void 0:n.find(({id:r})=>r===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new _i}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:n,graphic:r,relatedLayer:s}=this;return t?"loading":e||n?"querying":r&&s?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var u,d,h,p;const{layer:e,relatedLayer:t,relationshipId:n,objectId:r,_queryFeatureCountAbortController:s}=this;if(await(e==null?void 0:e.load()),!t||typeof r!="number"||!((d=(u=e==null?void 0:e.capabilities)==null?void 0:u.queryRelated)!=null&&d.supportsCount))return void this._set("featureCount",0);await t.load();const a=t.createQuery(),o=((p=(h=e.capabilities)==null?void 0:h.queryRelated)==null?void 0:p.supportsCacheHint)??!1,l=new DN({cacheHint:o,relationshipId:n,returnGeometry:!1,objectIds:[r],where:a.where}),c=await e.queryRelatedFeaturesCount(l,{signal:s==null?void 0:s.signal});this._set("featureCount",c[r]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:n}=this;return t?e:n?e.slice(0,n):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:n,_queryPageAbortController:r}=this;!n||t<2||e.addMany(await this._queryRelatedFeatures({signal:r==null?void 0:r.signal}))}async _queryRelatedFeatures(e){var E,A,P,O,M;const{orderByFieldsFixedCasing:t,showAllEnabled:n,featuresPerPage:r,displayCount:s,layer:a,relationshipId:o,featurePage:l,featureCount:c,relatedLayer:u}=this;await(a==null?void 0:a.load());const{relationship:d,objectId:h}=this;if(!d||typeof h!="number"||!((A=(E=a==null?void 0:a.capabilities)==null?void 0:E.queryRelated)!=null&&A.supportsPagination))return[];const p=n?((l-1)*r+c)%c:0,m=n?r:s;if(!u)return[];await u.load();const g=u.objectIdField,_=[...t==null?void 0:t.map(V=>V.field),g],b=t==null?void 0:t.map(V=>`${V.field} ${V.order}`),x=((O=(P=a.capabilities)==null?void 0:P.queryRelated)==null?void 0:O.supportsCacheHint)||!1,w=u.createQuery(),C=new DN({orderByFields:b,start:p,num:m,outFields:_,cacheHint:x,relationshipId:o,returnGeometry:!1,objectIds:[h],where:w.where}),S=((M=(await a.queryRelatedFeatures(C,{signal:e==null?void 0:e.signal}))[h])==null?void 0:M.features)||[];return S.forEach(V=>V.sourceLayer=u),S}};f([y()],Or.prototype,"_queryAbortController",void 0),f([y()],Or.prototype,"_queryPageAbortController",void 0),f([y()],Or.prototype,"_queryFeatureCountAbortController",void 0),f([y({value:1})],Or.prototype,"featurePage",null),f([y()],Or.prototype,"featuresPerPage",void 0),f([y({readOnly:!0})],Or.prototype,"orderByFieldsFixedCasing",null),f([y()],Or.prototype,"description",void 0),f([y({readOnly:!0})],Or.prototype,"itemDescriptionFieldName",null),f([y({value:3})],Or.prototype,"displayCount",null),f([y({type:ao})],Or.prototype,"graphic",void 0),f([y()],Or.prototype,"layer",void 0),f([y()],Or.prototype,"map",void 0),f([y({readOnly:!0})],Or.prototype,"objectId",null),f([y({readOnly:!0})],Or.prototype,"objectIdField",null),f([y()],Or.prototype,"orderByFields",void 0),f([y({readOnly:!0})],Or.prototype,"relatedFeatures",null),f([y({readOnly:!0})],Or.prototype,"relatedLayer",null),f([y({readOnly:!0})],Or.prototype,"relationship",null),f([y({readOnly:!0})],Or.prototype,"featureCount",void 0),f([y({readOnly:!0})],Or.prototype,"relatedFeatureViewModels",null),f([y()],Or.prototype,"relationshipId",void 0),f([y()],Or.prototype,"showAllEnabled",void 0),f([y({readOnly:!0})],Or.prototype,"state",null),f([y()],Or.prototype,"title",void 0),Or=f([ge("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],Or);const fU=Or,Mf={base:"esri-feature-relationship",esriWidget:"esri-widget",listContainer:"esri-feature-relationship__list",listContainerQuerying:"esri-feature-relationship__list--querying",featureObserver:"esri-feature__feature-observer",stickySpinnerContainer:"esri-feature__sticky-loading-container",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner",iconLoading:"esri-icon-loading-indicator esri-rotating"},fY={title:!0,description:!0};let El=class extends gr{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([n])=>{n!=null&&n.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new fU,this.messages=null,this.messagesCommon=null,this.visibleElements={...fY},this._increaseFeaturePage=()=>{const{state:n,showAllEnabled:r,relatedFeatures:s,featuresPerPage:a,featurePage:o}=this.viewModel;n==="ready"&&r&&s.length>=a*o&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new q3,this.addHandles([ue(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),At),ue(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),Sn(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-list-637f1ba8.js"),["./calcite-list-637f1ba8.js","./dom-5b7af1bf.js","./interactive-52dcf836.js"],import.meta.url),Ee(()=>import("./calcite-list-item-2b0d81b3.js"),["./calcite-list-item-2b0d81b3.js","./dom-5b7af1bf.js","./conditionalSlot-e2a39862.js","./observers-c77bfda3.js","./interactive-52dcf836.js"],import.meta.url),Ee(()=>import("./calcite-icon-5dd27db1.js"),["./calcite-icon-5dd27db1.js","./icon-1a289254.js","./dom-5b7af1bf.js","./observers-c77bfda3.js"],import.meta.url),Ee(()=>import("./calcite-notice-4f7be2b2.js"),["./calcite-notice-4f7be2b2.js","./dom-5b7af1bf.js","./conditionalSlot-e2a39862.js","./observers-c77bfda3.js","./icon-1a289254.js"],import.meta.url)])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=_t(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:n}=this.viewModel;return!e&&(t>n||n===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return ua(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...fY,...e}}renderStickyLoading(){return this.viewModel.state==="querying"?z("div",{key:"sticky-loader",class:Mf.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return z("span",{class:this.classes(Mf.iconLoading,Mf.spinner)})}renderLoading(){return z("div",{key:"loading-container",class:Mf.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return z("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=Su(this.container)?"chevron-left":"chevron-right";return z("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var s,a;const{itemDescriptionFieldName:t}=this.viewModel,n=e.title;e.description=t&&((s=e.formattedAttributes)==null?void 0:s.global[t]);const r=e.state==="loading";return z("calcite-list-item",{key:e.uid,label:r?`${(a=this.messagesCommon)==null?void 0:a.loading}`:n,description:r?"":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?z("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return z("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},z("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return z("div",{key:"feature-observer",class:Mf.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return z("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return z("div",{key:"list-container",class:this.classes(Mf.listContainer,{[Mf.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return z("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},z("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return z("div",{class:this.classes(Mf.base,Mf.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(n=>{this.addHandles(ue(()=>[n.title,n.state],()=>this.scheduleRender(),At),t)}),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,n=t.description&&this.description,r=t.title&&this.title;this._featureElementInfo.set({description:n,title:r,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await Fx(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};f([y()],El.prototype,"_relatedFeatureIntersectionObserverNode",void 0),f([y({readOnly:!0})],El.prototype,"displayShowAllButton",null),f([y({readOnly:!0})],El.prototype,"displayListItems",null),f([y()],El.prototype,"description",null),f([y({readOnly:!0})],El.prototype,"featureCountDescription",null),f([y()],El.prototype,"headingLevel",void 0),f([y()],El.prototype,"title",null),f([y({type:fU})],El.prototype,"viewModel",void 0),f([y(),En("esri/widgets/Feature/t9n/Feature")],El.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],El.prototype,"messagesCommon",void 0),f([y()],El.prototype,"visibleElements",void 0),f([Mr("visibleElements")],El.prototype,"castVisibleElements",null),El=f([ge("esri.widgets.Feature.FeatureRelationship")],El);const mY=El;let GJe=class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=n=>{}),this.preRequestCallback||(this.preLayerQueryCallback=n=>{})}};var gS;const WJe=1,gY="content-view-models",vY="relationship-view-models",yY={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let qr=gS=class extends RC(et){constructor(i){super(i),this._handles=new mi,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=wx(this._graphicChanged,WJe,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...yY},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return e.type==="attachments"&&t.attachmentsContent||e.type==="custom"&&t.customContent||e.type==="fields"&&t.fieldsContent||e.type==="media"&&t.mediaContent||e.type==="text"&&t.textContent||e.type==="expression"&&t.expressionContent||e.type==="relationship"&&t.relationshipContent},this._handles.add(ue(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),At))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return T(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return PQe(tY(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return vue(this.graphic)}castAbilities(i){return{...yY,...i}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(i){this._set("graphic",i?i.clone():null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get map(){var i;return((i=this.view)==null?void 0:i.map)||null}set map(i){this._override("map",i)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(i,e){const t=this.contentViewModels[i];t instanceof E0&&t.setActiveMedia(e)}nextMedia(i){const e=this.contentViewModels[i];e instanceof E0&&e.next()}previousMedia(i){const e=this.contentViewModels[i];e instanceof E0&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:i}=this;if(!i)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(t){zo(t)||(this._error=t,tt.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:t,graphic:i,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:i}=this;i&&i.abort(),this._featureAbortController=null}_compileContentElement(i,e){return i.type==="attachments"?this._compileAttachments(i,e):i.type==="custom"?this._compileCustom(i,e):i.type==="fields"?this._compileFields(i,e):i.type==="media"?this._compileMedia(i,e):i.type==="text"?this._compileText(i,e):i.type==="expression"?this._compileExpression(i,e):i.type==="relationship"?this._compileRelationship(i,e):void 0}_compileContent(i){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(i)?i.filter(this._isAllowedContentType).map((e,t)=>this._compileContentElement(e,t)):typeof i=="string"?this._compileText(new kie({text:i}),0).text:i}_destroyContentViewModels(){var i,e;(i=this._handles)==null||i.remove(vY),(e=this._handles)==null||e.remove(gY),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(i,e){var r;const t=(r=i==null?void 0:i.graphic)==null?void 0:r.getObjectId(),n=e==null?void 0:e.getObjectId();return T(t)&&T(n)&&t===n}_setRelatedFeaturesViewModels({relatedFeatureViewModels:i,relatedFeatures:e,map:t}){e==null||e.filter(Boolean).forEach(n=>{i.find(r=>this._matchesFeature(r,n))||i.add(new gS({abilities:{relationshipContent:!1},map:t,graphic:n}))}),i.forEach(n=>{(e==null?void 0:e.find(s=>this._matchesFeature(n,s)))||i.remove(n)})}_setExpressionContentVM(i,e){const{formattedAttributes:t}=this,{contentElement:n,contentElementViewModel:r}=i,s=n==null?void 0:n.type;r&&s&&(s==="fields"&&(this._createFieldsFormattedAttributes({contentElement:n,contentElementIndex:e,formattedAttributes:t}),r.set(this._createFieldsVMParams(n,e))),s==="media"&&(this._createMediaFormattedAttributes({contentElement:n,contentElementIndex:e,formattedAttributes:t}),r.set(this._createMediaVMParams(n,e))),s==="text"&&r.set(this._createTextVMParams(n)))}_compileRelationship(i,e){const{displayCount:t,orderByFields:n,relationshipId:r,title:s,description:a}=i,{_sourceLayer:o,graphic:l,map:c}=this,u=new fU({displayCount:t,graphic:l,orderByFields:n,relationshipId:r,layer:o,map:c,...this._compileTitleAndDesc({title:s,description:a})});return this.contentViewModels[e]=u,this._handles.add(Sn(()=>u.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(u)),vY),i}_compileExpression(i,e){const{expressionInfo:t}=i,{graphic:n,map:r,spatialReference:s,view:a}=this,o=new pU({expressionInfo:t,graphic:n,interceptor:gS.interceptor,map:r,spatialReference:s,view:a});return this.contentViewModels[e]=o,this._handles.add(ue(()=>o.contentElementViewModel,()=>this._setExpressionContentVM(o,e),At),gY),i}_compileAttachments(i,e){const{graphic:t}=this,{description:n,title:r}=i;return this.contentViewModels[e]=new dU({graphic:t,...this._compileTitleAndDesc({title:r,description:n})}),i}_compileCustom(i,e){const{graphic:t}=this,{creator:n,destroyer:r}=i;return this.contentViewModels[e]=new E$({graphic:t,creator:n,destroyer:r}),i}_compileTitleAndDesc({title:i,description:e}){const{_fieldInfoMap:t,_sourceLayer:n,graphic:r,formattedAttributes:s,_expressionAttributes:a}=this,{attributes:o}=r,l=s.global;return{title:S0({attributes:o,fieldInfoMap:t,globalAttributes:l,expressionAttributes:a,layer:n,text:i}),description:S0({attributes:o,fieldInfoMap:t,globalAttributes:l,expressionAttributes:a,layer:n,text:e})}}_createFieldsVMParams(i,e){var c;const{_effectivePopupTemplate:t,formattedAttributes:n}=this,r={...n.global,...n.content[e]},s=(c=(i==null?void 0:i.fieldInfos)||(t==null?void 0:t.fieldInfos))==null?void 0:c.filter(({fieldName:u})=>lU(u)||Mm(u)||r.hasOwnProperty(u)),a=t==null?void 0:t.expressionInfos,{description:o,title:l}=i;return{attributes:r,expressionInfos:a,fieldInfos:s,...this._compileTitleAndDesc({title:l,description:o})}}_compileFields(i,e){const t=i.clone(),n=new K3(this._createFieldsVMParams(i,e));return this.contentViewModels[e]=n,t.fieldInfos=n.formattedFieldInfos.slice(0),t}_createMediaVMParams(i,e){const{abilities:t,graphic:n,_fieldInfoMap:r,formattedAttributes:s,_effectivePopupTemplate:a,relatedInfos:o,_sourceLayer:l,_expressionAttributes:c}=this,{attributes:u}=n,{description:d,mediaInfos:h,title:p}=i;return{abilities:{chartAnimation:t.chartAnimation},activeMediaInfoIndex:i.activeMediaInfoIndex||0,attributes:u,layer:l,fieldInfoMap:r,formattedAttributes:{...s.global,...s.content[e]},expressionAttributes:c,mediaInfos:h,popupTemplate:a,relatedInfos:o,...this._compileTitleAndDesc({title:p,description:d})}}_compileMedia(i,e){const t=i.clone(),n=new E0(this._createMediaVMParams(i,e));return t.mediaInfos=n.formattedMediaInfos.slice(0),this.contentViewModels[e]=n,t}_createTextVMParams(i){const{graphic:e,_fieldInfoMap:t,_sourceLayer:n,_expressionAttributes:r}=this;if(i&&i.text){const{attributes:s}=e,a=this.formattedAttributes.global;i.text=S0({attributes:s,fieldInfoMap:t,globalAttributes:a,expressionAttributes:r,layer:n,text:i.text})}return{graphic:e,creator:i.text}}_compileText(i,e){const t=i.clone();return this.contentViewModels[e]=new E$(this._createTextVMParams(t)),t}_compileLastEditInfo(){const{_effectivePopupTemplate:i,_sourceLayer:e,graphic:t}=this;if(!i)return;const{lastEditInfoEnabled:n}=i,r=e==null?void 0:e.editFieldsInfo;return n&&r?MQe(r,t.attributes):void 0}_compileTitle(i){const{_fieldInfoMap:e,_sourceLayer:t,graphic:n,_expressionAttributes:r}=this,{attributes:s}=n,a=this.formattedAttributes.global;return S0({attributes:s,fieldInfoMap:e,globalAttributes:a,expressionAttributes:r,layer:t,text:i})}async _getTitle(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.title;return S$(t,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.content;return S$(t,{graphic:e})}async _queryFeature(i){const{_featureAbortController:e,_sourceLayer:t,graphic:n,_effectivePopupTemplate:r,spatialReference:s,map:a,view:o}=this;if(e!==this._featureAbortController||!n)return;await IQe({graphic:n,popupTemplate:r,layer:t,spatialReference:s},i);const{content:{value:l},title:{value:c}}=await Ra({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:u}}=await Ra({checkForRelatedFeatures:this._checkForRelatedFeatures(i),expressionAttributes:zJe({expressionInfos:r==null?void 0:r.expressionInfos,spatialReference:s,graphic:n,map:a,interceptor:gS.interceptor,view:o})});e===this._featureAbortController&&n&&(this._expressionAttributes=u,this._graphicExpressionAttributes={...n.attributes,...u},this._set("formattedAttributes",this._createFormattedAttributes(l)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(l)||null))}_createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){const{_effectivePopupTemplate:n,graphic:r,relatedInfos:s,_sourceLayer:a,_fieldInfoMap:o,_graphicExpressionAttributes:l}=this;t.content[e]=Hk({fieldInfos:n==null?void 0:n.fieldInfos,graphic:r,attributes:{...l,...i.attributes},layer:a,fieldInfoMap:o,relatedInfos:s})}_createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){if(i.fieldInfos){const{graphic:n,relatedInfos:r,_sourceLayer:s,_fieldInfoMap:a,_graphicExpressionAttributes:o}=this;t.content[e]=Hk({fieldInfos:i.fieldInfos,graphic:n,attributes:{...o,...i.attributes},layer:s,fieldInfoMap:a,relatedInfos:r})}}_createFormattedAttributes(i){const{_effectivePopupTemplate:e,graphic:t,relatedInfos:n,_sourceLayer:r,_fieldInfoMap:s,_graphicExpressionAttributes:a}=this,o=e==null?void 0:e.fieldInfos,l={global:Hk({fieldInfos:o,graphic:t,attributes:a,layer:r,fieldInfoMap:s,relatedInfos:n}),content:[]};return Array.isArray(i)&&i.forEach((c,u)=>{c.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:c,contentElementIndex:u,formattedAttributes:l}),c.type==="media"&&this._createMediaFormattedAttributes({contentElement:c,contentElementIndex:u,formattedAttributes:l})}),l}_checkForRelatedFeatures(i){const{graphic:e,_effectivePopupTemplate:t}=this;return this._queryRelatedInfos(e,tY(t),i)}async _queryRelatedInfos(i,e,t){const{relatedInfos:n,_sourceLayer:r}=this;n.clear();const s=T(r.associatedLayer)?await r.associatedLayer.load(t):r;if(!s)return;const a=e.filter(c=>c&&Mm(c.fieldName));if(!a||!a.length)return;e.forEach(c=>this._configureRelatedInfo(c,s));const o=await xJe({relatedInfos:n,layer:s},t);Object.keys(o).forEach(c=>{var h;const u=n.get(c.toString()),d=(h=o[c])==null?void 0:h.value;u&&d&&(u.layerInfo=d.data)});const l=await CJe({graphic:i,relatedInfos:n,layer:s},t);Object.keys(l).forEach(c=>{var u;vJe((u=l[c])==null?void 0:u.value,n.get(c.toString()))})}_configureRelatedInfo(i,e){const{relatedInfos:t}=this,n=HV(i.fieldName);if(!n)return;const{layerId:r,fieldName:s}=n;if(!r)return;const a=t.get(r.toString())||gJe(r,e);a&&(TJe({relatedInfo:a,fieldName:s,fieldInfo:i}),this.relatedInfos.set(r,a))}};qr.interceptor=new GJe(DQe,kQe),f([y()],qr.prototype,"_error",void 0),f([y()],qr.prototype,"_featureAbortController",void 0),f([y({readOnly:!0})],qr.prototype,"_effectivePopupTemplate",null),f([y({readOnly:!0})],qr.prototype,"_fieldInfoMap",null),f([y({readOnly:!0})],qr.prototype,"_sourceLayer",null),f([y()],qr.prototype,"abilities",void 0),f([Mr("abilities")],qr.prototype,"castAbilities",null),f([y({readOnly:!0})],qr.prototype,"content",void 0),f([y({readOnly:!0})],qr.prototype,"contentViewModels",void 0),f([y()],qr.prototype,"description",void 0),f([y({type:Boolean})],qr.prototype,"defaultPopupTemplateEnabled",void 0),f([y({readOnly:!0})],qr.prototype,"state",null),f([y({readOnly:!0})],qr.prototype,"formattedAttributes",void 0),f([y({type:ao,value:null})],qr.prototype,"graphic",null),f([y({readOnly:!0})],qr.prototype,"lastEditInfo",void 0),f([y({readOnly:!0})],qr.prototype,"relatedInfos",void 0),f([y()],qr.prototype,"spatialReference",null),f([y({readOnly:!0})],qr.prototype,"title",void 0),f([y()],qr.prototype,"map",null),f([y({readOnly:!0})],qr.prototype,"waitingForContent",null),f([y()],qr.prototype,"view",void 0),qr=gS=f([ge("esri.widgets.FeatureViewModel")],qr);const mU=qr,ls={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},Vue=i=>{let e=class extends i{constructor(){super(...arguments),this.renderNodeContent=t=>Bx(t)&&!t.destroyed?z("div",{class:ls.contentNode,key:t},t.render()):t instanceof HTMLElement?z("div",{class:ls.contentNode,key:t,bind:t,afterCreate:this._attachToNode}):Eie(t)?z("div",{class:ls.contentNode,key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){const n=this;t.appendChild(n)}};return e=f([ge("esri.widgets.Feature.ContentMixin")],e),e};var GV;const _Y={title:!0,content:!0,lastEditedInfo:!0},bY="relationship-handles";let Ha=GV=class extends Vue(gr){constructor(i,e){super(i,e),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={..._Y},this.viewModel=new mU}initialize(){this.addHandles(ue(()=>{var i;return(i=this.viewModel)==null?void 0:i.contentViewModels},()=>this._setupContentWidgets(),At))}loadDependencies(){return Ee(()=>import("./calcite-notice-4f7be2b2.js"),["./calcite-notice-4f7be2b2.js","./dom-5b7af1bf.js","./conditionalSlot-e2a39862.js","./observers-c77bfda3.js","./icon-1a289254.js"],import.meta.url)}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(i){this.viewModel.defaultPopupTemplateEnabled=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(i){this.viewModel.spatialReference=i}get title(){return this.viewModel.title}castVisibleElements(i){return{..._Y,...i}}get map(){return this.viewModel.map}set map(i){this.viewModel.map=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const{state:i}=this.viewModel,e=z("div",{class:ls.container,key:"container"},this.renderTitle(),i==="error"?this.renderError():i==="loading"?this.renderLoading():this.renderContentContainer());return z("div",{class:this.classes(ls.base,ls.esriWidget)},e)}setActiveMedia(i,e){return this.viewModel.setActiveMedia(i,e)}nextMedia(i){return this.viewModel.nextMedia(i)}previousMedia(i){return this.viewModel.previousMedia(i)}renderError(){const{messagesCommon:i,messages:e,visibleElements:t}=this;return z("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},t.title?z("div",{key:"error-title",slot:"title"},i.errorMessage):null,z("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return z("div",{key:"loading-container",class:ls.loadingSpinnerContainer},z("span",{class:this.classes(ls.iconLoading,ls.spinner)}))}renderContentContainer(){const{visibleElements:i}=this;return i.content?z("div",{class:ls.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:i,title:e}=this;return i.title?z(Ul,{level:this.headingLevel,class:ls.title,innerHTML:e}):null}renderContent(){const i=this.viewModel.content,e="content";if(!i)return null;if(Array.isArray(i))return i.length?z("div",{class:ls.contentNode,key:`${e}-content-elements`},i.map(this.renderContentElement,this)):null;if(typeof i=="string"){const t=this._contentWidgets[0];return!t||t.destroyed?null:z("div",{class:ls.contentNode,key:`${e}-content`},t.render())}return this.renderNodeContent(i)}renderContentElement(i,e){const{visibleElements:t}=this;if(typeof t.content!="boolean"&&!t.content[i.type])return null;switch(i.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(i,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(i,e);case"expression":return this.renderExpression(e);case"relationship":return this.renderRelationship(e);default:return null}}renderAttachments(i){const e=this._contentWidgets[i];if(!e||e.destroyed)return null;const{state:t,attachmentInfos:n}=e.viewModel;return t==="loading"||n.length>0?z("div",{key:this._buildKey("attachments-element",i),class:this.classes(ls.contentElement)},e.render()):null}renderRelationship(i){const e=this._contentWidgets[i];return e&&!e.destroyed&&this.flowItems?z("div",{key:this._buildKey("relationship-element",i),class:ls.contentElement},e.render()):null}renderExpression(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:z("div",{key:this._buildKey("expression-element",i),class:ls.contentElement},e.render())}renderCustom(i,e){const{creator:t}=i,n=this._contentWidgets[e];return!n||n.destroyed?null:t?z("div",{key:this._buildKey("custom-element",e),class:ls.contentElement},n.render()):null}renderFields(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:z("div",{key:this._buildKey("fields-element",i),class:ls.contentElement},e.render())}renderMedia(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:z("div",{key:this._buildKey("media-element",i),class:ls.contentElement},e.render())}renderLastEditInfo(){const{visibleElements:i,messages:e}=this,{lastEditInfo:t}=this.viewModel;if(!t||!i.lastEditedInfo)return null;const{date:n,user:r}=t,s=t.type==="edit"?r?e.lastEditedByUser:e.lastEdited:r?e.lastCreatedByUser:e.lastCreated,a=ua(s,{date:n,user:r});return z("div",{key:"edit-info-element",class:this.classes(ls.lastEditedInfo,ls.contentElement)},a)}renderText(i,e){const t=i.text,n=this._contentWidgets[e];return!n||n.destroyed?null:t?z("div",{key:this._buildKey("text-element",e),class:this.classes(ls.contentElement,ls.text)},n.render()):null}_buildKey(i,...e){return`${i}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidget(i){i&&(i.viewModel=null,!i.destroyed&&i.destroy())}_destroyContentWidgets(){this.removeHandles(bY),this._contentWidgets.forEach(i=>this._destroyContentWidget(i)),this._contentWidgets=[]}_addFeatureRelationshipHandles(i){const{flowItems:e,visibleElements:t}=this;this.addHandles([Sn(()=>i,"select-record",({featureViewModel:n})=>{e&&(n.abilities={relationshipContent:!0},e.push(new GV({flowItems:e,viewModel:n,visibleElements:t})))}),Sn(()=>i,"show-all-records",()=>{if(!e)return;const{viewModel:n}=i;n.showAllEnabled=!0;const r=new mY({visibleElements:{title:!1,description:!1},viewModel:n});this._addFeatureRelationshipHandles(r),e.push(r)})],bY)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:i,visibleElements:e}=this,t=this.get("viewModel.content"),{contentViewModels:n}=this.viewModel;if(Array.isArray(t))t.forEach((r,s)=>{if(r.type==="attachments"&&(this._contentWidgets[s]=new zQe({displayType:r.displayType,headingLevel:e.title?i+1:i,viewModel:n[s]})),r.type==="fields"&&(this._contentWidgets[s]=new Mue({viewModel:n[s]})),r.type==="media"&&(this._contentWidgets[s]=new kue({viewModel:n[s]})),r.type==="text"&&(this._contentWidgets[s]=new VR({viewModel:n[s]})),r.type==="custom"&&(this._contentWidgets[s]=new VR({viewModel:n[s]})),r.type==="expression"&&(this._contentWidgets[s]=new HJe({viewModel:n[s]})),r.type==="relationship"){const a=new mY({viewModel:n[s]});this._addFeatureRelationshipHandles(a),this._contentWidgets[s]=a}},this);else{const r=n[0];r&&!r.destroyed&&(this._contentWidgets[0]=new VR({viewModel:r}))}this.scheduleRender()}};f([y()],Ha.prototype,"graphic",null),f([y()],Ha.prototype,"defaultPopupTemplateEnabled",null),f([y()],Ha.prototype,"flowItems",void 0),f([y()],Ha.prototype,"headingLevel",void 0),f([y()],Ha.prototype,"label",null),f([y(),En("esri/widgets/Feature/t9n/Feature")],Ha.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],Ha.prototype,"messagesCommon",void 0),f([y(),En("esri/widgets/support/t9n/uriUtils")],Ha.prototype,"messagesURIUtils",void 0),f([y()],Ha.prototype,"spatialReference",null),f([y({readOnly:!0})],Ha.prototype,"title",null),f([y()],Ha.prototype,"visibleElements",void 0),f([Mr("visibleElements")],Ha.prototype,"castVisibleElements",null),f([y()],Ha.prototype,"map",null),f([y()],Ha.prototype,"view",null),f([y({type:mU})],Ha.prototype,"viewModel",void 0),Ha=GV=f([ge("esri.widgets.Feature")],Ha);const jJe=Ha;var Bue;const UR=Symbol("anchorHandles");let M_=class extends Pn.EventedAccessor{constructor(e){super(e),this[Bue]=new mi,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[UR].add([rs(()=>Qa(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),ue(()=>this.screenLocation,(t,n)=>{T(t)&&T(n)&&this.emit("view-change")})])}destroy(){this.view=null,this[UR]=_t(this[UR])}get screenLocation(){const{location:e,view:t,screenLocationEnabled:n}=this;return n&&T(e)&&T(t)&&t.ready?t.toScreen(e):null}};Bue=UR,f([y()],M_.prototype,"location",void 0),f([y()],M_.prototype,"screenLocation",null),f([y()],M_.prototype,"screenLocationEnabled",void 0),f([y()],M_.prototype,"view",void 0),M_=f([ge("esri.widgets.support.AnchorElementViewModel")],M_);const zue=M_,qJe="esri.widgets.CompassViewModel";let HR=class extends zue{constructor(e){super(e),this.visible=!1}};f([y()],HR.prototype,"visible",void 0),HR=f([ge(qJe)],HR);const gU=HR,Zk={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let P_=class extends gr{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new gU}initialize(){this.addHandles(ue(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:n}=e;t&&(this.viewModel.location=t),this.visible=!0;const r=()=>this.hide();n&&n.catch(()=>{}).then(r)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,n=!!t,r=e&&n,s=!e&&n,a={[Zk.spinnerStart]:r,[Zk.spinnerFinish]:s},o=this._getPositionStyles();return z("div",{class:this.classes(Zk.base,a),styles:o})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=Fx(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if(B(t)||B(e))return{};const{padding:n}=t;return{left:e.x-n.left+"px",top:e.y-n.top+"px"}}};f([y()],P_.prototype,"location",null),f([y()],P_.prototype,"view",null),f([y({type:gU})],P_.prototype,"viewModel",void 0),f([y()],P_.prototype,"visible",null),P_=f([ge("esri.widgets.Spinner")],P_);const Uue=P_,Hue="OBJECTID";var wa;(function(i){i[i.size=22]="size",i[i.lineWidth=50]="lineWidth",i[i.maxSize=120]="maxSize",i[i.maxOutlineSize=80]="maxOutlineSize",i[i.tallSymbolWidth=20]="tallSymbolWidth"})(wa||(wa={}));const WV={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};function KJe(i,e,t){const n=wa.size;let r=n,s=n;i<1?r*=.75:i>1&&(s*=1.25);const a=0,o=0;let l=n,c=n;return e&&t&&(r=s=l=c=0),[{type:"path",path:[{command:"M",values:[l,a]},{command:"L",values:[t?l:.875*l,a]},{command:"L",values:[t?r-.5*l:o,s-.5*c]},{command:"L",values:[r-.5*l,s-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[l,a]},{command:"L",values:[l,e?a:.125*c]},{command:"L",values:[r-.5*l,e?s-.5*c:c]},{command:"L",values:[r-.5*l,s-.5*c]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[r-.5*l,s-.5*c]},{command:"L",values:[t?r-.5*l:o,s-.5*c]},{command:"L",values:[t?r-.5*l:o,e?s-.5*c:c]},{command:"L",values:[r-.5*l,e?s-.5*c:c]},{command:"Z",values:[]}]}]}function YJe(i){const e=wa.size,t=.5*i,n=0,r=0;return[{type:"path",path:[{command:"M",values:[r,.7*e*.5]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+t]},{command:"L",values:[r,.7*e+t-.7*e*.5]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,.7*e]},{command:"L",values:[.3*e,.7*e+t]},{command:"L",values:[e,t]},{command:"L",values:[e,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*e,n]},{command:"L",values:[e,n]},{command:"L",values:[.3*e,.7*e]},{command:"L",values:[r,.7*e*.5]},{command:"Z",values:[]}]}]}function XJe(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]}function ZJe(i,e){let t=e?wa.tallSymbolWidth:i;const n=i,r=e?4:6;t<=wa.size?t-=.5*r:t-=r;const s=0,a=0,o=e?.35*t:.5*t;return[{type:"path",path:[{command:"M",values:[.5*t,s]},{command:"L",values:[t,.5*o]},{command:"L",values:[.5*t,o]},{command:"L",values:[a,.5*o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*o]},{command:"L",values:[.5*t,o]},{command:"L",values:[.5*t,n]},{command:"L",values:[a,n-.5*o]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*t,o]},{command:"L",values:[.5*t,n]},{command:"L",values:[t,n-.5*o]},{command:"L",values:[t,.5*o]},{command:"Z",values:[]}]}]}function QJe(i,e){let t=e?wa.tallSymbolWidth:i;const n=i,r=e?4:6;t<=wa.size?t-=.5*r:t-=r;const s=.5*t,a=.15*t,o=0,l=n-a;return[{type:"ellipse",cx:.5*t,cy:l,rx:s,ry:a},{type:"path",path:[{command:"M",values:[o,a]},{command:"L",values:[o,l]},{command:"L",values:[t,l]},{command:"L",values:[t,a]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:a,rx:s,ry:a}]}function JJe(i,e){let t=e?wa.tallSymbolWidth:i;const n=i,r=e?4:6;t<=wa.size?t-=.5*r:t-=r;const s=.15*t,a=n-s;return[{type:"ellipse",cx:.5*t,cy:a,rx:.5*t,ry:s},{type:"path",path:[{command:"M",values:[.5*t,0]},{command:"L",values:[t,a]},{command:"L",values:[0,a]},{command:"Z",values:[]}]}]}function eet(i){let e=i;const t=i,n=6;e<wa.size?e-=.5*n:e-=n;const r=.15*e,s=0;return[{type:"path",path:[{command:"M",values:[0,s]},{command:"L",values:[e,s]},{command:"L",values:[.5*e,t-r]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:s,rx:.5*e,ry:r}]}function tet(i){let e=i;const t=i,n=4;e<wa.size?e-=.5*n:e-=n;const r=0,s=0,a=e,o=t,l=Math.floor(i/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*a,r]},{command:"L",values:[a,.5*o-l]},{command:"L",values:[.45*a-l,.5*o+l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*a,r]},{command:"L",values:[.45*a-l,.5*o+l]},{command:"L",values:[s,.5*o-l]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,.5*o-l]},{command:"L",values:[.45*a-l,.5*o+l]},{command:"L",values:[.45*a,t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*a,t]},{command:"L",values:[a,.5*o-l]},{command:"L",values:[.45*a-l,.5*o+l]},{command:"Z",values:[]}]}]}function iet(i){const e=i,t=2;let n=i;n<wa.size?n-=.5*t:n-=t;const r=0,s=0;return[{type:"path",path:[{command:"M",values:[.45*e,r]},{command:"L",values:[e,n]},{command:"L",values:[.45*e,.6*n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*e,r]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[s,n]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[s,n]},{command:"L",values:[.45*e,.6*n]},{command:"L",values:[e,n]},{command:"Z",values:[]}]}]}function cy(i,e){return Math.round(Math.min(Math.max(i+255*e*.75,0),255))}function zRt(i,e){if(i==null)return new Xt;if("type"in i&&(i.type==="linear"||i.type==="pattern"))return i;const t=new Xt(i);return new Xt([cy(t.r,e),cy(t.g,e),cy(t.b,e),t.a])}const net="http://www.w3.org/2000/svg";let ret=0,set=0;const wY=Fi("android"),aet=Fi("chrome")||wY&&wY>=4?"auto":"optimizeLegibility",oet={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},cet=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let cs={},Bn={};const xY={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},uet=Math.PI;let det=1;function Dw(i,e){const t=i*(uet/180);return Math.abs(e*Math.sin(t))+Math.abs(e*Math.cos(t))}function Gue(i){return i.map(e=>`${e.command} ${e.values.join(" ")}`).join(" ").trim()}function vU(i,e,t,n){if(i){if(i.type==="circle")return z("circle",{fill:e,"fill-rule":"evenodd",stroke:t.color,"stroke-width":t.width,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-dasharray":t.dashArray,"stroke-dashoffset":t.dashOffset,"stroke-miterlimit":"4",cx:i.cx,cy:i.cy,r:i.r});if(i.type==="ellipse")return z("ellipse",{fill:e,"fill-rule":"evenodd",stroke:t.color,"stroke-width":t.width,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-dasharray":t.dashArray,"stroke-miterlimit":"4",cx:i.cx,cy:i.cy,rx:i.rx,ry:i.ry});if(i.type==="rect")return z("rect",{fill:e,"fill-rule":"evenodd",stroke:t.color,"stroke-width":t.width,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-dasharray":t.dashArray,"stroke-miterlimit":"4",x:i.x,y:i.y,width:i.width,height:i.height});if(i.type==="image")return z("image",{href:i.src,x:i.x,y:i.y,width:i.width,height:i.height,preserveAspectRatio:"none"});if(i.type==="path"){const r=typeof i.path!="string"?Gue(i.path):i.path;return z("path",{fill:e,"fill-rule":"evenodd",stroke:t.color,"stroke-width":t.width,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-dasharray":t.dashArray,"stroke-miterlimit":"4",d:r})}if(i.type==="text")return VL(n),z("text",{"dominant-baseline":n.dominantBaseline,fill:e,"fill-rule":"evenodd",stroke:t.color,"stroke-width":t.width,"stroke-linecap":t.cap,"stroke-linejoin":t.join,"stroke-dasharray":t.dashArray,"stroke-miterlimit":"4","text-anchor":n.align,"text-decoration":n.decoration,kerning:n.kerning,rotate:n.rotate,"text-rendering":aet,"font-style":n.font.style,"font-variant":n.font.variant,"font-weight":n.font.weight,"font-size":n.font.size,"font-family":n.font.family,x:i.x,y:i.y},i.text)}return null}function yU(i){const e={fill:"none",pattern:null,linearGradient:null};if(i){if("type"in i&&i.type==="pattern"){const t="patternId-"+ ++ret;e.fill=`url(#${t})`,e.pattern={id:t,x:i.x,y:i.y,width:i.width,height:i.height,image:{x:0,y:0,width:i.width,height:i.height,href:i.src}}}else if("type"in i&&i.type==="linear"){const t="linearGradientId-"+ ++set;e.fill=`url(#${t})`,e.linearGradient={id:t,x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2,stops:i.colors.map(n=>({offset:n.offset,color:n.color&&new Xt(n.color).toString()}))}}else if(i){const t=new Xt(i);e.fill=t.toString()}}return e}function _U(i){const e={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};if(i&&(i.width!=null&&(e.width=i.width),i.cap&&(e.cap=i.cap),i.join&&(e.join=i.join.toString()),i.color&&(e.color=new Xt(i.color).toString()),i.dashArray&&(e.dashArray=i.dashArray),i.dashArray&&(e.dashOffset=i.dashoffset),i.style)){let t=null;if(i.style in xY&&(t=xY[i.style]),Array.isArray(t)){t=t.slice(0);const n=i.width??0;for(let r=0;r<t.length;++r)t[r]*=n;if(i.cap!=="butt"){for(let r=0;r<t.length;r+=2)t[r]-=n,t[r]<1&&(t[r]=1);for(let r=1;r<t.length;r+=2)t[r]+=n}t=t.join(",")}e.dashArray=t}return e}function Wue(i,e){const t={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(i){const n=i.alignBaseline,r=n==="baseline"?"auto":n==="top"?"text-top":n==="bottom"?"hanging":n;t.align=i.align,t.dominantBaseline=r,t.decoration=i.decoration,t.kerning=i.kerning?"auto":"0",t.rotate=i.rotated?"90":"0",VL(e),t.font.style=e.style||"normal",t.font.variant=e.variant||"normal",t.font.weight=e.weight||"normal",t.font.size=e.size&&e.size.toString()||"10pt",t.font.family=e.family||"serif"}return t}function jue(i){const{pattern:e,linearGradient:t}=i;if(e)return z("pattern",{id:e.id,patternUnits:"userSpaceOnUse",x:e.x,y:e.y,width:e.width,height:e.height},z("image",{x:e.image.x,y:e.image.y,width:e.image.width,height:e.image.height,href:e.image.href}));if(t){const n=t.stops.map((r,s)=>z("stop",{key:`${s}-stop`,offset:r.offset,"stop-color":r.color}));return z("linearGradient",{id:t.id,gradientUnits:"userSpaceOnUse",x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},n)}return null}function het(i,e){if(!i)return null;const t=[];for(const n of i){const{shape:r,fill:s,stroke:a,font:o}=n,l=yU(s),c=_U(a),u=r.type==="text"?Wue(r,o):null,d=vU(r,l.fill,c,u);d&&t.push(d)}return z("mask",{id:e,maskUnits:"userSpaceOnUse"},z("g",null,t))}function CY(i,e,t){return o2(i,gB(i),[e,t])}function TY(i,e,t,n,r){return vB(i,gB(i),[e,t]),i[4]=i[4]*e-n*e+n,i[5]=i[5]*t-r*t+r,i}function pet(i,e,t,n){const r=e%360*Math.PI/180;GL(i,gB(i),r);const s=Math.cos(r),a=Math.sin(r),o=i[4],l=i[5];return i[4]=o*s-l*a+n*a-t*s+t,i[5]=l*s+o*a-t*a-n*s+n,i}function gl(i,e){cs&&"left"in cs?(cs.left!=null&&cs.left>i&&(cs.left=i),(cs.right==null||cs.right<i)&&(cs.right=i),(cs.top==null||cs.top>e)&&(cs.top=e),(cs.bottom==null||cs.bottom<e)&&(cs.bottom=e)):cs={left:i,bottom:e,right:i,top:e}}function SY(i){const e=i.args,t=e.length;let n;switch(i.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(n=0;n<t;n+=2)gl(e[n],e[n+1]);Bn.x=e[t-2],Bn.y=e[t-1];break;case"H":for(n=0;n<t;++n)gl(e[n],Bn.y);Bn.x=e[t-1];break;case"V":for(n=0;n<t;++n)gl(Bn.x,e[n]);Bn.y=e[t-1];break;case"m":{let r=0;for(("x"in Bn)||(gl(Bn.x=e[0],Bn.y=e[1]),r=2),n=r;n<t;n+=2)gl(Bn.x+=e[n],Bn.y+=e[n+1]);break}case"l":case"t":for(n=0;n<t;n+=2)gl(Bn.x+=e[n],Bn.y+=e[n+1]);break;case"h":for(n=0;n<t;++n)gl(Bn.x+=e[n],Bn.y);break;case"v":for(n=0;n<t;++n)gl(Bn.x,Bn.y+=e[n]);break;case"c":for(n=0;n<t;n+=6)gl(Bn.x+e[n],Bn.y+e[n+1]),gl(Bn.x+e[n+2],Bn.y+e[n+3]),gl(Bn.x+=e[n+4],Bn.y+=e[n+5]);break;case"s":case"q":for(n=0;n<t;n+=4)gl(Bn.x+e[n],Bn.y+e[n+1]),gl(Bn.x+=e[n+2],Bn.y+=e[n+3]);break;case"A":for(n=0;n<t;n+=7)gl(e[n+5],e[n+6]);Bn.x=e[t-2],Bn.y=e[t-1];break;case"a":for(n=0;n<t;n+=7)gl(Bn.x+=e[n+5],Bn.y+=e[n+6])}}function EY(i,e,t){const n=oet[i.toLowerCase()];let r;typeof n=="number"&&(n?e.length>=n&&(r={action:i,args:e.slice(0,e.length-e.length%n)},t.push(r),SY(r)):(r={action:i,args:[]},t.push(r),SY(r)))}function fet(i){const e=(typeof i.path!="string"?Gue(i.path):i.path).match(cet),t=[];if(cs={},Bn={},!e)return null;let n="",r=[];const s=e.length;for(let o=0;o<s;++o){const l=e[o],c=parseFloat(l);isNaN(c)?(n&&EY(n,r,t),r=[],n=l):r.push(c)}EY(n,r,t);const a={x:0,y:0,width:0,height:0};return cs&&"left"in cs&&(a.x=cs.left,a.y=cs.top,a.width=cs.right-cs.left,a.height=cs.bottom-cs.top),a}function que(i){const e={x:0,y:0,width:0,height:0};if(i.type==="circle")e.x=i.cx-i.r,e.y=i.cy-i.r,e.width=2*i.r,e.height=2*i.r;else if(i.type==="ellipse")e.x=i.cx-i.rx,e.y=i.cy-i.ry,e.width=2*i.rx,e.height=2*i.ry;else if(i.type==="image"||i.type==="rect")e.x=i.x,e.y=i.y,e.width=i.width,e.height=i.height;else if(i.type==="path"){const t=NL(fet(i));e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height}return e}function Kue(i){const e={x:0,y:0,width:0,height:0};let t=null,n=Number.NEGATIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(const s of i)t?(t.x=Math.min(t.x,s.x),t.y=Math.min(t.y,s.y),n=Math.max(n,s.x+s.width),r=Math.max(r,s.y+s.height)):(t=e,t.x=s.x,t.y=s.y,n=s.x+s.width,r=s.y+s.height);return t&&(t.width=n-t.x,t.height=r-t.y),t}function jV(i,e,t,n,r,s,a,o,l){let c=(a&&s?Dw(s,e):e)/2,u=(a&&s?Dw(s,t):t)/2;if(l){const x=l[0],w=l[1];c=(a&&s?Dw(s,x):x)/2,u=(a&&s?Dw(s,w):w)/2}const d=i.width+n,h=i.height+n,p=VN(),m=VN();let g=!1;if(r&&d!==0&&h!==0){const x=e!==t?e/t:d/h,w=e>t?e:t;let C=1,S=1;isNaN(w)||(x>1?(C=w/d,S=w/x/h):(S=w/h,C=w*x/d)),cT(m,m,TY(p,C,S,c,u)),g=!0}const _=i.x+(d-n)/2,b=i.y+(h-n)/2;if(cT(m,m,CY(p,c-_,u-b)),!g&&(d>e||h>t)){const x=d/e>h/t,w=(x?e:t)/(x?d:h);cT(m,m,TY(p,w,w,_,b))}return s&&cT(m,m,pet(p,s,_,b)),o&&cT(m,m,CY(p,o[0],o[1])),`matrix(${m[0]},${m[1]},${m[2]},${m[3]},${m[4]},${m[5]})`}function met(i,e,t){const n=i==null?void 0:i.effects.find(c=>c.type==="bloom");if(!n)return null;const{strength:r,radius:s}=n,a=r>0?s:0,o=(r+a)*e,l=4*r+1;return z("filter",{id:`bloom${t}`,x:"-100%",y:"-100%",width:"300%",height:"300%",filterUnits:"userSpaceOnUse"},z("feMorphology",{operator:"dilate",radius:(r+.5*a)*(5**(e/100)*(.4+e/100)),in:"SourceGraphic",result:"dilate"}),z("feGaussianBlur",{in:"dilate",stdDeviation:o/25,result:"blur"}),z("feGaussianBlur",{in:"blur",stdDeviation:o/50,result:"intensityBlur"}),z("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},z("feFuncR",{type:"linear",slope:l}),z("feFuncG",{type:"linear",slope:l}),z("feFuncB",{type:"linear",slope:l})),z("feMerge",null,z("feMergeNode",{in:"intensityBlur"}),z("feMergeNode",{in:"intensityBrightness"}),z("feGaussianBlur",{stdDeviation:r/10})))}function Yue(i,e,t,n={}){var c;const r=[],s=[],a=++det,o=met(n.effectView,e,a);let l=null;if(o){const u=(c=n.effectView)==null?void 0:c.effects.find(m=>m.type==="bloom"),d=(u.strength?u.strength+u.radius/2:0)/3,h=e+e*d,p=t+t*d;l=[Math.max(h,10),Math.max(p,10)]}for(let u=0;u<i.length;u++){const d=i[u],h=[],p=[];let m=0,g=0,_=0;for(const w of d){const{shape:C,fill:S,stroke:E,font:A,offset:P}=w;n.ignoreStrokeWidth||(m+=E&&E.width||0);const O=yU(S),M=_U(E),V=C.type==="text"?Wue(C,A):null;r.push(jue(O)),h.push(vU(C,O.fill,M,V)),p.push(que(C)),P&&(g+=P[0],_+=P[1])}const b=jV(NL(Kue(p)),e,t,m,n.scale??!1,n.rotation,n.useRotationSize??!1,[g,_],l);let x=null;if(n.masking){const w=`mask-${u}`,C=n.masking[u];r.push(het(C,w)),x=`url(#${w})`}s.push(x?z("g",{mask:x},z("g",{transform:b},h)):z("g",{transform:b},h))}return n.useRotationSize&&n.rotation&&(e=Dw(n.rotation,e),t=Dw(n.rotation,t)),o&&(VL(l),e=l[0],t=l[1]),z("svg",{xmlns:net,width:e,height:t,style:"display: block;"},o,z("defs",null,r),o?z("g",{filter:`url(#bloom${a})`},s):s)}const get=zI();function fM(i,e,t){const n=Math.ceil(e[0]),r=Math.ceil(e[1]);if(!i.some(a=>!!a.length))return null;const s=t&&t.node||document.createElement("div");return t.opacity!=null&&(s.style.opacity=t.opacity.toString()),t.effectView!=null&&(s.style.filter=r2(t.effectView)),get.append(s,Yue.bind(null,i,n,r,t)),s}function vet(i,e){i=Math.ceil(i),e=Math.ceil(e);const t=document.createElement("canvas");t.width=i,t.height=e,t.style.width=i+"px",t.style.height=e+"px";const n=t.getContext("2d");return n.clearRect(0,0,i,e),n}function yet(i,e,t){return i?Mc(i,{responseType:"image"}).then(n=>{const r=n.data,s=r.width,a=r.height,o=s/a;let l=e;if(t){const c=Math.max(s,a);l=Math.min(l,c)}return{image:r,width:o<=1?Math.ceil(l*o):l,height:o<=1?l:Math.ceil(l/o)}}):Promise.reject(new Ze("renderUtils: imageDataSize","href not provided."))}function _et(i,e){return!(!i||e==="ignore")&&(e!=="multiply"||i.r!==255||i.g!==255||i.b!==255||i.a!==1)}function bet(i,e,t,n,r){switch(r){case"multiply":i[e+0]*=t[0],i[e+1]*=t[1],i[e+2]*=t[2],i[e+3]*=t[3];break;default:{const s=mB({r:i[e+0],g:i[e+1],b:i[e+2]});s.h=n.h,s.s=n.s,s.v=s.v/100*n.v;const a=jie(s);i[e+0]=a.r,i[e+1]=a.g,i[e+2]=a.b,i[e+3]*=t[3];break}}}function wet(i,e,t,n,r){return yet(i,e,r).then(s=>{const a=s.width?s.width:e,o=s.height?s.height:e;if(s.image&&_et(t,n)){let l=s.image.width,c=s.image.height;Fi("edge")&&/\.svg$/i.test(i)&&(l-=1,c-=1);const u=vet(a,o);u.drawImage(s.image,0,0,l,c,0,0,a,o);const d=u.getImageData(0,0,a,o),h=[t.r/255,t.g/255,t.b/255,t.a],p=mB(t);for(let m=0;m<d.data.length;m+=4)bet(d.data,m,h,p,n);u.putImageData(d,0,0),i=u.canvas.toDataURL("image/png")}else{const l=SG&&SG.findCredential(i);if(l&&l.token){const c=i.includes("?")?"&":"?";i=`${i}${c}token=${l.token}`}}return{url:i,width:a,height:o}}).catch(()=>({url:i,width:e,height:e}))}let t1=null;const AY=[255,255,255];function MY(i,e){return Math.floor(Math.random()*(e-i+1)+i)}function xet(i,e,t){const{backgroundColor:n,outline:r,dotSize:s}=i,a=t&&t.swatchSize||wa.size,o=.8,l=Math.round(a*a/s**2*o),c=window.devicePixelRatio,u=document.createElement("canvas"),d=a*c;u.width=d,u.height=d,u.style.width=u.width/c+"px",u.style.height=u.height/c+"px";const h=u.getContext("2d");if(n&&(h.fillStyle=n.toCss(!0),h.fillRect(0,0,d,d),h.fill()),h.fillStyle=e.toCss(!0),t1&&t1.length/2===l)for(let m=0;m<2*l;m+=2){const g=t1[m],_=t1[m+1];h.fillRect(g,_,s*c,s*c),h.fill()}else{t1=[];for(let m=0;m<2*l;m+=2){const g=MY(0,d),_=MY(0,d);t1.push(g,_),h.fillRect(g,_,s*c,s*c),h.fill()}}r&&(r.color&&(h.strokeStyle=r.color.toCss(!0)),h.lineWidth=r.width,h.strokeRect(0,0,d,d));const p=new Image(a,a);return p.src=u.toDataURL(),p}function Cet(i,e={}){const t=e.radius||40,n=2*Math.PI*t,r=i.length,s=n/r,a=[],o=FN(e.outline);(o==null?void 0:o.width)!=null&&(o.width*=2),(o||e.backgroundColor)&&a.push({shape:{type:"circle",cx:t,cy:t,r:t},fill:e.backgroundColor,stroke:o,offset:[0,0]});const l=e.values,c=l&&l.length===r&&l.reduce((m,g)=>m+g,0)===100,u=[0];for(let m=0;m<r;m++){let g=null;c&&(g=l[m]*n/100,u.push(g+u[m])),a.push({shape:{type:"circle",cx:t,cy:t,r:t/2},fill:[0,0,0,0],stroke:{width:t,dashArray:`${(g??s)/2} ${n}`,dashoffset:"-"+(c?u[m]/2:m*(s/2)),color:i[m]},offset:[0,0]})}let d=null;const h=2*t+((o==null?void 0:o.width)||0),p=e.holePercentage;if(p){o&&a.push({shape:{type:"circle",cx:t,cy:t,r:t*p},fill:null,stroke:o,offset:[0,0]});const m=h/2;d=[[{shape:{type:"circle",cx:m,cy:m,r:m},fill:AY,stroke:o?{...o,color:AY}:null,offset:[0,0]},{shape:{type:"circle",cx:m,cy:m,r:t*p},fill:[0,0,0],stroke:null,offset:[0,0]}]]}return fM([a],[h,h],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:d,rotation:-90})}function O_(i,e={}){const r=e.align==="horizontal",s=r?75:24,a=r?24:75,{width:o=s,height:l=a,gradient:c=!0}=e,u=window.devicePixelRatio,d=o*u,h=l*u,p=document.createElement("canvas");p.width=d,p.height=h,p.style.width=`${o}px`,p.style.height=`${l}px`;const m=p.getContext("2d"),g=r?d:0,_=r?0:h;if(c){const x=m.createLinearGradient(0,0,g,_),w=i.length,C=w===1?0:1/(w-1);i.forEach((S,E)=>x.addColorStop(E*C,S.toString())),m.fillStyle=x,m.fillRect(0,0,d,h)}else{const x=r?d/i.length:d,w=r?h:h/i.length;let C=0,S=0;for(const E of i)m.fillStyle=E.toString(),m.fillRect(C,S,x,w),C=r?C+x:0,S=r?0:S+w}const b=document.createElement("div");return b.style.width=`${o}px`,b.style.height=`${l}px`,Tet(b,e==null?void 0:e.effectList),b.appendChild(p),b}function Tet(i,e){if(!e)return;i.style.filter=r2(e);const t=e.effects;if(t){for(const n of t)if((n==null?void 0:n.type)==="drop-shadow"){n.offsetX<0?i.style.marginLeft=`${Math.abs(n.offsetX)}px`:i.style.marginRight=`${n.offsetX}px`;break}}}async function bU(i,e){switch(i.type){case"web-style":{const{previewWebStyleSymbol:t}=await Ee(()=>import("./previewWebStyleSymbol-9414c78a.js"),["./previewWebStyleSymbol-9414c78a.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./promiseUtils-6684e352.js","./screenUtils-410d12c0.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url);return t(i,bU,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:t}=await Ee(()=>Promise.resolve().then(()=>HCt),void 0,import.meta.url);return t(i,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:t}=await Ee(()=>import("./previewSymbol2D-d6507dbd.js"),["./previewSymbol2D-d6507dbd.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./fontUtils-b94d5e06.js","./screenUtils-410d12c0.js","./utils-725f8b4e.js","./preload-helper-41c905a7.js","./symbols-fa594797.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./CIMSymbol-1379245a.js","./enumeration-3c281341.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./Clonable-ba795b08.js","./asyncUtils-62e8a185.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./assets-0b172f07.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./colorUtils-4aa5b1d6.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url);return t(i,e)}case"cim":{const{previewCIMSymbol:t}=await Ee(()=>import("./previewCIMSymbol-a8efb41e.js"),["./previewCIMSymbol-a8efb41e.js","./screenUtils-410d12c0.js","./cimAnalyzer-721530a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./fontUtils-b94d5e06.js","./arcadeOnDemand-c6d1b9f2.js","./preload-helper-41c905a7.js","./geometry-5a216427.js","./Extent-69509002.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./BidiEngine-836b7ef6.js","./aaBoundingRect-4a760199.js","./jsonUtils-03c4af61.js","./enums-4b2a86a0.js","./utils-c81a5c52.js","./alignmentUtils-ae955d28.js","./definitions-2d0dd0cd.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./number-954e4ab6.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./CIMSymbolRasterizer-f4829d04.js","./request-d3e98716.js","./Rasterizer-c5722a70.js","./_commonjsHelpers-a430e9ea.js","./imageutils-b39249d8.js","./rasterizingUtils-133923fb.js","./cimSymbolUtils-2e4dde89.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./persistableUrlUtils-a16d0f55.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./dehydratedFeatures-4eeb381a.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url);return t(i,e)}default:return}}function Xue(i){return i&&"opacity"in i?i.opacity*Xue(i.parent):1}async function P$(i,e){if(!i)return;const t=i.sourceLayer,n=(T(e)&&e.useSourceLayer?t:i.layer)??t,r=Xue(n);if(T(i.symbol)&&(!T(e)||e.ignoreGraphicSymbol!==!0)){const _=i.symbol.type==="web-style"?await i.symbol.fetchSymbol({...e,cache:T(e)?e.webStyleCache:null}):i.symbol.clone();return JD(_,null,r),_}const s=(T(e)?e.renderer:null)??(n&&"renderer"in n?n.renderer:null);let a=s&&"getSymbolAsync"in s?await s.getSymbolAsync(i,e):null;if(!a)return;if(a=a.type==="web-style"?await a.fetchSymbol({...e,cache:T(e)?e.webStyleCache:null}):a.clone(),!(s&&"visualVariables"in s&&s.visualVariables&&s.visualVariables.length))return JD(a,null,r),a;if("arcadeRequiredForVisualVariables"in s&&s.arcadeRequiredForVisualVariables&&(B(e)||B(e.arcade))){const _={...kt(e)};_.arcade=await UL(),e=_}const o=await Ee(()=>import("./visualVariableUtils-c59ab38d.js"),["./visualVariableUtils-c59ab38d.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./Graphic-b46e2684.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url),l=[],c=[],u=[],d=[];for(const _ of s.visualVariables)switch(_.type){case"color":l.push(_);break;case"opacity":c.push(_);break;case"rotation":d.push(_);break;case"size":_.target||u.push(_)}const h=!!l.length&&l[l.length-1],p=h?o.getColor(h,i,e):null,m=!!c.length&&c[c.length-1];let g=m?o.getOpacity(m,i,e):null;if(r!=null&&(g=g!=null?g*r:r),JD(a,p,g),u.length){const _=o.getAllSizes(u,i,e);await C_e(a,_)}for(const _ of d)T_e(a,o.getRotationAngle(_,i,e),_.axis);return a}let Zm=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const n in e){const r=e[n],s=new rye(r,void 0,void 0,2,2);this._properties[n]={pool:s,acquired:[]}}this._afterDispatchHandle=sie(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const n of t.acquired)_G(n)||t.pool.release(n);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),n=this._properties[e];let r=n.pool.acquire();for(n.acquired.push(r);r===t;)n.acquired.push(r),r=n.pool.acquire();return r}_release(){for(const e in this._properties){const t=this._properties[e];let n=0;for(const r of t.acquired)_G(r)?t.acquired[n++]=r:t.pool.release(r);t.acquired.length=n}}};const Eet=Fi("mac")?"Meta":"Ctrl",Y3={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let i=48;i<58;i++)Y3[i]=String.fromCharCode(i);for(let i=1;i<25;i++)Y3[111+i]=`F${i}`;for(let i=65;i<91;i++)Y3[i]=[String.fromCharCode(i+32),String.fromCharCode(i)];function Aet(i){if(i.key!==void 0)return Uv(i);const e=Y3[i.keyCode];return Array.isArray(e)?i.shiftKey?e[1]:e[0]:e}function Met(i){switch(i){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let Pet=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const n of this.keyModifiers)if(!t.has(n))return!1;return!0}};const PY=tt.getLogger("esri.views.input.InputHandler");let sr=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const n of t)this._incomingEventMatches.push(n.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?PY.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,n){let r;typeof t=="function"?(n=t,r=[]):r=t||[];const s=typeof e=="string"?new Pet(e,r):e,a=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=u=>{const d=this._incoming[u.match.eventType];if(d){const h=d.indexOf(u);d.splice(h,1),a(),this._manager&&this._manager.updateDependencies()}},l=new Oet(s,n,{onPause:o,onRemove:o,onResume:u=>{const d=this._incoming[u.match.eventType];d&&!d.includes(u)&&(d.push(u),a(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(l),a(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new Ret(e,{onEmit:(n,r,s,a)=>{var o;(o=this._manager)==null||o.emit(n.eventType,r,s,a)},onRemove:n=>{var r;delete this._outgoing[n.eventType],(r=this._manager)==null||r.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):PY.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var n;const t=this._incoming[e.type];if(t){for(const r of t)if(r.match.matches(e)&&((n=r.callback)==null||n.call(r,e),e.shouldStopPropagation()))break}}},Oet=class{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},Ret=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n)}remove(){this._removed=!0,this._handler.onRemove(this)}},Iet=class extends sr{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>{this._update(t.data)})}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:n,y:r}=e;t===this._value&&this._x===n&&this._y===r||(this._value=t,this._x=n,this._y=r,this._onChange(t,n,r))}},$et=class extends sr{constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new q_e(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}get multiTouchActive(){return this._multiTouchActive.get()}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}},Zd=class extends et{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=Eet,this._latestPointerType="mouse",this._propertiesPool=new Zm({latestPointerLocation:Det},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,n=Pt.INTERNAL){if(this._nameToGroup[e])return void tt.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void tt.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const r={name:e,handlers:t.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:n,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=r;for(let s=r.handlers.length-1;s>=0;s--){const a=r.handlers[s];this._handlers.push(a),a.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(o,l,c,u,d)=>{this._emitInputEvent(a.priorityIndex+1,o,l,c,d,u)},setPointerCapture:(o,l)=>{this._setPointerCapture(r,a,o,l)},setEventCallback:o=>{a.eventCallback=o},setUninstallCallback:o=>{a.uninstallCallback=o},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(n=>{var r;n.removed=!0,(r=n.uninstallCallback)==null||r.call(n)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):tt.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let n=this._handlers.length-1;n>=0;n--){const r=this._handlers[n];r.priorityIndex=n,this._handlersPriority.push(r)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let n=this._handlersPriority.length-1;n>=0;n--){const r=this._handlersPriority[n];r.priorityIndex=n;let s=r.handler.hasSideEffects;if(!s){for(const a of r.handler.outgoingEventTypes)if(e.has(a)){s=!0;break}}if(s)for(const a of r.handler.incomingEventMatches){e.add(a.eventType);for(const o of a.keyModifiers)Met(o)||t.add(o)}r.active=s}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,n){this._latestPointerType=e;const r=this._get("latestPointerLocation");if(B(r)||r.x!==t||r.y!==n){const s=this._propertiesPool.get("latestPointerLocation");s.x=t,s.y=n,this._set("latestPointerLocation",s)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const s=t;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(e,t);const n=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,r=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,n,r)}_updateKeyModifiers(e,t){if(!t)return;let n=!1;const r=()=>{if(!n){const o=new Set;this._activeKeyModifiers.forEach(l=>{o.add(l)}),this._activeKeyModifiers=o,n=!0}},s=(o,l)=>{l&&!this._activeKeyModifiers.has(o)?(r(),this._activeKeyModifiers.add(o)):!l&&this._activeKeyModifiers.has(o)&&(r(),this._activeKeyModifiers.delete(o))};if(e==="key-down"||e==="key-up"){const o=t.key;this._keyModifiers.has(o)&&s(o,e==="key-down")}const a=t.native;s("Alt",!(!a||!a.altKey)),s("Ctrl",!(!a||!a.ctrlKey)),s("Shift",!(!a||!a.shiftKey)),s("Meta",!(!a||!a.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new Iet((e,t,n)=>this._setLatestPointer(e,t,n)),this._multiTouchHandler=new $et,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Pt.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Pt.INTERNAL)}_setPointerCapture(e,t,n,r){const s=e.name+"-"+t.priorityIndex,a=this._pointerCaptures.get(n.pointerId)||new Set;this._pointerCaptures.set(n.pointerId,a),r?(a.add(s),a.size===1&&this.eventSource&&this.eventSource.setPointerCapture(n,!0)):a.has(s)&&(a.delete(s),a.size===0&&(this._pointerCaptures.delete(n.pointerId),this.eventSource&&this.eventSource.setPointerCapture(n,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,n,r){this._emitInputEvent(0,e,t,n,r)}_emitInputEvent(e,t,n,r,s,a){const o=r!==void 0?r:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=s!==void 0&&s,c={event:new Let(t,n,o,a||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(e){this._currentPropagation={events:new DG,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,n;const e=NL(this._currentPropagation);for(;e.events.length>0;){const{event:r,priorityIndex:s}=e.events.pop(),a=r.data&&r.data.eventId;if(!(a!=null&&this._stoppedPropagationEventIds.has(a)))for(e.currentHandler=this._handlersPriority[s];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&((n=(t=e.currentHandler).eventCallback)==null||n.call(t,r)),r.shouldStopPropagation()){a!=null&&this._stoppedPropagationEventIds.add(a);break}if(r.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new DG;t.push(e);const n=this._currentPropagation;if(n){for(;n.events.length;)t.push(n.events.pop());n.events=t,n.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const n of e.handler.incomingEventMatches)for(const r of t.handler.incomingEventMatches){if(n.eventType!==r.eventType)continue;const s=n.keyModifiers.filter(a=>r.keyModifiers.includes(a));if(s.length===n.keyModifiers.length!=(s.length===r.keyModifiers.length))return n.keyModifiers.length>r.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const n of e){let r=0;for(;r<t.length&&this._compareHandlerPriority(n,t[r])>=0;)r++;t.splice(r,0,n)}return t}get debug(){const e=t=>{const n=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=n};return{injectEvent:(t,n)=>{e(()=>{this._onEventReceived(t,n)})},disablePointerCapture:e}}};f([y({readOnly:!0})],Zd.prototype,"hasPendingInputs",null),f([y({constructOnly:!0})],Zd.prototype,"eventSource",void 0),f([y({constructOnly:!0})],Zd.prototype,"recognizers",void 0),f([y()],Zd.prototype,"_latestPointerType",void 0),f([y()],Zd.prototype,"latestPointerType",null),f([y()],Zd.prototype,"multiTouchActive",null),f([y({readOnly:!0})],Zd.prototype,"latestPointerLocation",void 0),Zd=f([ge("esri.views.input.InputManager")],Zd);let Let=class{constructor(e,t,n,r,s){this.type=e,this.data=t,this.timestamp=n,this.modifiers=r,this.cancelable=s,this._propagationState=Lv.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Lv.STOPPED}shouldStopPropagation(){return(this._propagationState&Lv.STOPPED)!=0}async(e){this._propagationState|=Lv.PAUSED;const t=(n,r)=>{this._propagationState&=~Lv.PAUSED;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),r)throw n;return n};return(typeof e=="function"?e():e).then(n=>t(n,!1),n=>t(n,!0))}shouldPausePropagation(e){return!!(this._propagationState&Lv.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Lv;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(Lv||(Lv={}));const Pt={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Det=class{};function qV(i){return i&&typeof i.highlight=="function"}function ket(i){return i&&typeof i.maskOccludee=="function"}function QRt(i,e,t){return B(i)||i>t&&(e===0||i<e)}function JRt(i,e){return i>0||e>0}function eIt(i){const e=i.effectiveScaleRange;return{minScale:(e==null?void 0:e.minScale)??0,maxScale:(e==null?void 0:e.maxScale)??0}}const X3={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},A0=new OC({id:"zoom-to-feature",title:"{messages.zoom}",className:X3.iconZoom}),OY=new OC({id:"remove-selected-feature",title:"{messages.remove}",className:X3.iconTrash}),kw=new OC({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:X3.iconZoom}),Fw=new OC({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:X3.iconBrowseClusteredFeatures}),Fet="esri.widgets.Popup.PopupViewModel",O$=tt.getLogger(Fet),Net=i=>{const{event:e,view:t}=i,{action:n}=e,r=t&&t.popup;if(!n)return Promise.reject(new Ze("trigger-action:missing-arguments","Event has no action"));if(!r)return Promise.reject(new Ze("trigger-action:missing-arguments","view.popup is missing"));const{disabled:s,id:a}=n;if(!a)return Promise.reject(new Ze("trigger-action:invalid-action","action.id is missing"));if(s)return Promise.reject(new Ze("trigger-action:invalid-action","Action is disabled"));if(a===A0.id)return Bet(r.viewModel).catch(hye);if(a===kw.id)return zet(r.viewModel);if(a===Fw.id)return r.featureMenuOpen=!r.featureMenuOpen,r.viewModel.browseClusterEnabled=!r.viewModel.browseClusterEnabled,Promise.resolve();if(r.viewModel.browseClusterEnabled=!1,a===OY.id){r.close();const{selectedFeature:o}=r;if(!o)return Promise.reject(new Ze(`trigger-action:${OY.id}`,"selectedFeature is required",{selectedFeature:o}));const{sourceLayer:l}=o;return l?l.remove(o):t.graphics.remove(o),Promise.resolve()}return Promise.resolve()};function Zue(i){const{selectedFeature:e,location:t,view:n}=i;return n?n.type==="3d"?e||t:i.get("selectedFeature.geometry")||t:null}function a0(i){var e,t;return(i==null?void 0:i.isAggregate)&&((t=(e=i==null?void 0:i.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:t.type)==="cluster"}async function Vet(i,e){if((e==null?void 0:e.type)!=="3d"||!i||i.declaredClass!=="esri.Graphic")return!0;const t=e.getViewForGraphic(i);if(t&&"whenGraphicBounds"in t){let n;try{n=await t.whenGraphicBounds(i,{useViewElevation:!0})}catch{}return!n||!n.boundingBox||n.boundingBox[0]===n.boundingBox[3]&&n.boundingBox[1]===n.boundingBox[4]&&n.boundingBox[2]===n.boundingBox[5]}return!0}async function Bet(i){const{location:e,selectedFeature:t,view:n,zoomFactor:r}=i,s=Zue(i);if(!s){const c=new Ze("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:s,view:n});throw O$.error(c),c}const a=n.scale/r,o=i.get("selectedFeature.geometry")||e,l=o&&o.type==="point"&&await Vet(t,n);A0.active=!0,A0.disabled=!0;try{await i.zoomTo({target:{target:s,scale:l?a:void 0}})}catch{const u=new Ze("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});O$.error(u)}finally{A0.active=!1,A0.disabled=!1,i.zoomToLocation=null,l&&(i.location=o)}}async function zet(i){const{selectedFeature:e,view:t}=i;if((t==null?void 0:t.type)!=="2d"){const o=new Ze("zoomToCluster:invalid-view","View must be 2d MapView.",{view:t});throw O$.error(o),o}if(!a0(e)){const o=new Ze("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw O$.error(o),o}const n=e.sourceLayer,r=await t.whenLayerView(n),s=r.createQuery();s.aggregateIds=[e.getObjectId()],kw.active=!0,kw.disabled=!0;const{extent:a}=await r.queryExtent(s);await i.zoomTo({target:a}),kw.active=!1,kw.disabled=!1}async function Uet(i){const{selectedFeature:e,view:t}=i,n=e.sourceLayer,r=await t.whenLayerView(n),s=r.createQuery();s.aggregateIds=[e.getObjectId()];const{extent:a}=await r.queryExtent(s);i.selectedClusterBoundaryFeature.geometry=a,t.graphics.add(i.selectedClusterBoundaryFeature)}async function Het(i){const{selectedFeature:e,view:t}=i,n=e.sourceLayer,r=await t.whenLayerView(n),s=r.createQuery();s.aggregateIds=[e.getObjectId()],Fw.active=!0,Fw.disabled=!0;const{features:a}=await r.queryFeatures(s);Fw.active=!1,Fw.disabled=!1,t.popup.open({features:[e].concat(a),featureMenuOpen:!0})}function Get(i){const e=i.features.filter(t=>a0(t));e.length&&(i.features=e)}const wU=i=>{let e=class extends i{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:n}=this;return this.goToOverride?this.goToOverride(n,t):n.goTo(t.target,t.options)}};return f([y()],e.prototype,"goToOverride",void 0),f([y()],e.prototype,"view",void 0),e=f([ge("esri.widgets.support.GoTo")],e),e},bE=_i.ofType({key:"type",defaultKeyValue:"button",base:dB,typeMap:{button:OC,toggle:Fie}}),Wet=()=>[A0.clone()],jet=()=>[kw.clone(),Fw.clone()];let an=class extends wU(zue){constructor(e){super(e),this._handles=new mi,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new bE,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new ao({symbol:new a2({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}initialize(){this._handles.add([ue(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),ue(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),ue(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),ue(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),ue(()=>this.location,e=>this._locationChange(e)),ue(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),ue(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),ue(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),ue(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>Net({event:e,view:this.view})),rs(()=>!this.waitingForResult,()=>this._waitingForResultChange(),on),ue(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),ue(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),rs(()=>!this.visible,()=>this.browseClusterEnabled=!1),ue(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new bE;e.removeAll();const{actions:t,defaultActions:n,defaultPopupTemplateEnabled:r,includeDefaultActions:s,selectedFeature:a}=this,o=s?n.concat(t):t,l=a&&(typeof a.getEffectivePopupTemplate=="function"&&a.getEffectivePopupTemplate(r)||a.popupTemplate),c=l&&l.actions,u=l&&l.overwriteActions?c:c?c.concat(o):o;return u&&u.filter(Boolean).forEach(d=>e.add(d)),e}get defaultActions(){const e=this._get("defaultActions")||new bE;return e.removeAll(),e.addMany(a0(this.selectedFeature)?jet():Wet()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:n,promiseCount:r,selectedFeatureIndex:s}=this,a=r&&t.length;a&&n&&s===-1?this.selectedFeatureIndex=0:a&&s!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=FL(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const n=s=>{this._pendingPromises.has(t)&&this._updateFeatures(s),this._updatePendingPromises(t)},r=()=>this._updatePendingPromises(t);t.then(n,r)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=Zue(this);return t?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new Ze("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:n}=this;if(!n||!e)throw new Ze("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:n});return n.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:n}=t;delete t.fetchFeatures,n&&this._setFetchFeaturesPromises(t.location);const r=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const s of r)delete t[s];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){Get(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?a0(t)?(await Uet(this),await Het(this)):tt.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):tt.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(A0.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(a0(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:n}=this;n&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:n,featuresPerPage:r,featureViewModels:s}=this;if(n===null)return;const a=((n-1)*r+t)%t,o=a+r;s.slice(a,o).forEach((l,c)=>{l&&!l.graphic&&(l.graphic=e[a+c])})}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:n,view:r}=this;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(r.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),a0(e)?void 0:(e.symbol=await P$(e),this._selectedClusterFeature=e,void r.graphics.add(this._selectedClusterFeature));!n&&t||!e.geometry?n&&!e.geometry&&this.centerAtLocation().then(()=>{this.location=r.center.clone()}):this.location=kt(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:n,promisesPerLayerView:r}=t,s=Promise.resolve(n),a=r.map(o=>o.promise);this.promises=[s,...a]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:n}=this;if(a0(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const r=n.slice(0),s=[];t.forEach((a,o)=>{var c,u;if(!a)return;let l=null;if(r.some((d,h)=>(d&&d.graphic===a&&(l=d,r.splice(h,1)),!!l)),l)s[o]=l;else{const d=new mU({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(c=this.view)==null?void 0:c.spatialReference,graphic:a===e?a:null,map:(u=this.view)==null?void 0:u.map,view:this.view});s[o]=d}}),r.forEach(a=>a&&!a.destroyed&&a.destroy()),this._set("featureViewModels",s)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:n}=this;if(t.remove(e),n&&this.view){const r=this.view.on("click",s=>{s.pointerType==="mouse"&&s.button!==0||this._fetchFeaturesAndOpen(s)},Pt.WIDGET);t.add(r,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const n=new AbortController,{signal:r}=n;this._fetchFeaturesController=n,this.notifyChange("waitingForResult");const s=this.fetchFeatures(e,{signal:r,event:t});return s.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),s}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:n}=e,{view:r}=this;this._fetchFeaturesWithController(t,e).then(s=>{const{clientOnlyGraphics:a,promisesPerLayerView:o,location:l}=s,c=[Promise.resolve(a),...o.map(u=>u.promise)];return r.popup.open({location:l||n,promises:c}),s})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){var t;return B(e)?null:e.type==="point"?e:e.type==="extent"?e.center:e.type==="polygon"?e.centroid:e.type==="multipoint"||e.type==="polyline"?(t=e.extent)==null?void 0:t.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:n}=e;return n&&"layer"in n&&n.layer?n.layer:(n==null?void 0:n.type)==="map-notes"||(n==null?void 0:n.type)==="subtype-group"?n:t}_getHighlightTarget(e,t){const n=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||Hue:null,r=e.attributes;return r&&n&&r[n]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:n,activeFeature:r,visible:s}=this;if(!(r&&n&&t&&s))return;const a=this._getHighlightLayer(r);if(!(a&&a instanceof LG))return;const o=this._getLayerView(n,a);this._highlightActiveFeaturePromise=o;const l=await o;if(!(l&&qV(l)&&this._highlightActiveFeaturePromise===o&&this.activeFeature&&this.highlightEnabled))return;const c=l.highlight(this._getHighlightTarget(r,a));this._handles.add(c,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:n,view:r,visible:s}=this;if(!(t&&r&&n&&s))return;const a=this._getHighlightLayer(t);if(!(a&&a instanceof LG))return;const o=this._getLayerView(r,a);this._highlightSelectedFeaturePromise=o;const l=await o;if(!(l&&qV(l)&&this._highlightSelectedFeaturePromise===o&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const c=l.highlight(this._getHighlightTarget(t,a));this._handles.add(c,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const n=e.filter(r=>!t.includes(r));this.features=t.concat(n)}};f([y()],an.prototype,"featurePage",void 0),f([y()],an.prototype,"isLoadingFeature",null),f([y({type:bE})],an.prototype,"actions",void 0),f([y({readOnly:!0})],an.prototype,"active",null),f([y()],an.prototype,"activeFeature",void 0),f([y({readOnly:!0})],an.prototype,"allActions",null),f([y({type:Boolean})],an.prototype,"defaultPopupTemplateEnabled",void 0),f([y()],an.prototype,"autoCloseEnabled",void 0),f([y()],an.prototype,"autoOpenEnabled",void 0),f([y()],an.prototype,"browseClusterEnabled",void 0),f([y()],an.prototype,"content",void 0),f([y({type:bE,readOnly:!0})],an.prototype,"defaultActions",null),f([y({readOnly:!0})],an.prototype,"featureCount",null),f([y()],an.prototype,"features",null),f([y()],an.prototype,"featuresPerPage",void 0),f([y()],an.prototype,"featureViewModelAbilities",void 0),f([y({readOnly:!0})],an.prototype,"featureViewModels",void 0),f([y()],an.prototype,"highlightEnabled",void 0),f([y()],an.prototype,"includeDefaultActions",void 0),f([y({type:Wt})],an.prototype,"location",null),f([y({readOnly:!0})],an.prototype,"pendingPromisesCount",null),f([y({readOnly:!0})],an.prototype,"selectedClusterBoundaryFeature",void 0),f([y({readOnly:!0})],an.prototype,"waitingForResult",null),f([y({readOnly:!0})],an.prototype,"promiseCount",null),f([y()],an.prototype,"promises",null),f([y({value:null,readOnly:!0})],an.prototype,"selectedFeature",null),f([y({value:-1})],an.prototype,"selectedFeatureIndex",null),f([y({readOnly:!0})],an.prototype,"selectedFeatureViewModel",null),f([y({readOnly:!0})],an.prototype,"state",null),f([y()],an.prototype,"title",void 0),f([y()],an.prototype,"updateLocationEnabled",void 0),f([y()],an.prototype,"view",void 0),f([y()],an.prototype,"visible",void 0),f([y()],an.prototype,"zoomFactor",void 0),f([y()],an.prototype,"zoomToLocation",void 0),f([y()],an.prototype,"centerAtLocation",null),an=f([ge("esri.widgets.Popup.PopupViewModel")],an);const Que=an,RY="selected-index",qet=0,IY="popup-spinner",ot={calciteThemeLight:"calcite-theme-light",calciteThemeDark:"calcite-theme-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",actionExit:"esri-popup__action--exit",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button",collapseIcon:"esri-popup__collapse-icon"},$Y={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},LY="esri-popup";function Pf(i,e){return e===void 0?`${LY}__${i}`:`${LY}__${i}-${e}`}const DY={closeButton:!0,featureNavigation:!0};let ai=class extends Vue(gr){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new mi,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([n])=>{n!=null&&n.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=wx(()=>this._displaySpinner(),qet),this._exitRelatedRecordsActions=new WeakMap,this._flowItems=new _i,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new Que,this.visibleElements={...DY},this._addSelectedFeatureIndexHandle(),this.addHandles([ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.screenLocation},()=>this._positionContainer()),ue(()=>{var n;return[(n=this.viewModel)==null?void 0:n.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.screenLocation},(n,r)=>{!!n!=!!r&&this.reposition()}),ue(()=>{var n,r,s,a,o,l;return[(r=(n=this.viewModel)==null?void 0:n.view)==null?void 0:r.padding,(a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.size,(o=this.viewModel)==null?void 0:o.active,(l=this.viewModel)==null?void 0:l.location,this.alignment]},()=>this.reposition()),ue(()=>this.spinnerEnabled,n=>this._spinnerEnabledChange(n)),ue(()=>{var n,r;return(r=(n=this.viewModel)==null?void 0:n.view)==null?void 0:r.size},(n,r)=>this._updateDockEnabledForViewSize(n,r)),ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.view},(n,r)=>this._viewChange(n,r)),ue(()=>{var n,r;return(r=(n=this.viewModel)==null?void 0:n.view)==null?void 0:r.ready},(n,r)=>this._viewReadyChange(n,r)),ue(()=>{var n,r;return[(n=this.viewModel)==null?void 0:n.waitingForResult,(r=this.viewModel)==null?void 0:r.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),ue(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),ue(()=>{var n,r,s,a;return[(r=(n=this.selectedFeatureWidget)==null?void 0:n.viewModel)==null?void 0:r.title,(a=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:a.state]},()=>this._setTitleFromFeatureWidget()),ue(()=>{var n,r,s,a;return[(r=(n=this.selectedFeatureWidget)==null?void 0:n.viewModel)==null?void 0:r.content,(a=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:a.state]},()=>this._setContentFromFeatureWidget()),rs(()=>!this.collapsed,()=>{var n,r;((r=(n=this.viewModel)==null?void 0:n.view)==null?void 0:r.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),Sn(()=>{var n;return(n=this.viewModel)==null?void 0:n.allActions},"change",()=>this._watchActions()),ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.allActions},()=>this._watchActions(),At),ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.featureViewModels},()=>this._featureMenuViewportScrollTop()),Sn(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),ue(()=>{var n,r,s,a;return[(r=(n=this._activeFlowItemWidget)==null?void 0:n.viewModel)==null?void 0:r.state,(a=(s=this._activeFlowItemWidget)==null?void 0:s.viewModel)==null?void 0:a.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-flow-67c8e2bc.js"),["./calcite-flow-67c8e2bc.js","./dom-5b7af1bf.js","./observers-c77bfda3.js"],import.meta.url),Ee(()=>import("./calcite-flow-item-8eba8c39.js"),["./calcite-flow-item-8eba8c39.js","./dom-5b7af1bf.js","./panel-ae4dd30c.js","./popover-dcfb3586.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js","./guid-e49c4e43.js","./openCloseComponent-587e936b.js","./key-1fec8108.js","./action-ae390733.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./loader-632408c9.js","./action-menu-d50c4d74.js","./scrim-41440f97.js","./tooltip-87951009.js"],import.meta.url),Ee(()=>import("./calcite-action-9d25f314.js"),["./calcite-action-9d25f314.js","./action-ae390733.js","./dom-5b7af1bf.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./loader-632408c9.js","./guid-e49c4e43.js"],import.meta.url),Ee(()=>import("./calcite-tooltip-2c1ea5a7.js"),["./calcite-tooltip-2c1ea5a7.js","./tooltip-87951009.js","./dom-5b7af1bf.js","./guid-e49c4e43.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js"],import.meta.url),Ee(()=>import("./calcite-icon-5dd27db1.js"),["./calcite-icon-5dd27db1.js","./icon-1a289254.js","./dom-5b7af1bf.js","./observers-c77bfda3.js"],import.meta.url)])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect(),this._handles=null}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t!=null&&t.content);const n=e.viewModel;if(n!=null&&n.waitingForContent||(n==null?void 0:n.state)==="error")return!0;const r=n==null?void 0:n.content;return Array.isArray(r)?!!r.length:!!r}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||$Y}set dockOptions(e){const t={...$Y},n=this.get("viewModel.view.breakpoints"),r={};n&&(r.width=n.xsmall,r.height=n.xsmall);const s={...t,...e},a={...t.breakpoint,...r},{breakpoint:o}=s;o===!0?s.breakpoint=a:typeof o=="object"&&(s.breakpoint={...a,...o}),this._set("dockOptions",s),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:n,_flowItems:r}=this,{selectedFeatureViewModel:s}=this.viewModel,a={...t,title:!1};return s?(e?(e.viewModel=s,e.visibleElements=a):this._feature=new jJe({flowItems:r,headingLevel:n+1,viewModel:s,visibleElements:a}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return{...DY,...e}}blur(){const{active:e}=this.viewModel;e||tt.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||tt.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var s,a;this._handles.remove(RY);const t=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,r={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:t};((a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.widthBreakpoint)==="xsmall"&&(r.collapsed=!0),this.set(r),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var g,_,b,x;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:n,dividedActions:r,currentAlignment:s,currentDockPosition:a}=this,{active:o}=this.viewModel,{menuActions:l}=r,c=o&&l.length>1&&e,u=o&&t,d=o&&!t,h=(_=(g=this.selectedFeature)==null?void 0:g.layer)==null?void 0:_.title,p=(x=(b=this.selectedFeature)==null?void 0:b.layer)==null?void 0:x.id,m={[ot.alignTopCenter]:s==="top-center",[ot.alignBottomCenter]:s==="bottom-center",[ot.alignTopLeft]:s==="top-left",[ot.alignBottomLeft]:s==="bottom-left",[ot.alignTopRight]:s==="top-right",[ot.alignBottomRight]:s==="bottom-right",[ot.isDocked]:u,[ot.shadow]:d,[ot.isDockedTopLeft]:a==="top-left",[ot.isDockedTopCenter]:a==="top-center",[ot.isDockedTopRight]:a==="top-right",[ot.isDockedBottomLeft]:a==="bottom-left",[ot.isDockedBottomCenter]:a==="bottom-center",[ot.isDockedBottomRight]:a==="bottom-right",[ot.isFeatureMenuOpen]:n,[ot.isActionsMenuOpen]:c};return z("div",{class:this.classes(ot.base,m),role:"presentation","data-layer-title":h,"data-layer-id":p,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},o?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return z("span",{"aria-hidden":"true",class:this.classes(ot.icon,ot.iconLoading,ot.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?z("div",{key:Pf("loading-container"),role:"presentation",class:ot.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=Su(this.container),t={[ot.iconRightTriangleArrow]:e,[ot.paginationPreviousIconRTL]:e,[ot.iconLeftTriangleArrow]:!e,[ot.paginationPreviousIconLTR]:!e};return z("span",{"aria-hidden":"true",class:this.classes(ot.icon,t)})}renderPreviousButton(){const{messages:e}=this;return z("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(ot.button,ot.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=Su(this.container),t={[ot.iconLeftTriangleArrow]:e,[ot.paginationNextIconRTL]:e,[ot.iconRightTriangleArrow]:!e,[ot.paginationNextIconLTR]:!e};return z("span",{"aria-hidden":"true",class:this.classes(ot.icon,t)})}renderNextButton(){const{messages:e}=this;return z("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(ot.button,ot.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:n}=this,{featureCount:r,selectedFeatureIndex:s}=this.viewModel;return z("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(ot.button,ot.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":n.menu,title:n.menu},this._getPageText(r,s))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),n={[ot.iconUndock]:e,[ot.iconDock]:!e,[ot.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[ot.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[ot.iconDockToTop]:!e&&t==="top-center",[ot.iconDockToBottom]:!e&&t==="bottom-center"};return z("span",{"aria-hidden":"true",class:this.classes(n,ot.icon)})}renderDockButton(){var s,a,o;const{dockEnabled:e,messages:t}=this,n=(a=(s=this.viewModel)==null?void 0:s.view)==null?void 0:a.widthBreakpoint,r=e?t.undock:t.dock;return n!=="xsmall"&&((o=this.dockOptions)!=null&&o.buttonEnabled)?z("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(ot.button,ot.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:n,contentCollapsed:r,messagesCommon:s}=this,a={[ot.headerContainerButton]:n},o=z(Ul,{level:this.headingLevel,class:ot.headerTitle,innerHTML:e}),l=n?z("button",{key:`${e}--collapsible`,id:t,title:r?s.expand:s.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(ot.headerContainer,a),"aria-expanded":r?"false":"true",onclick:this._toggleCollapsed,type:"button"},o,z("calcite-icon",{class:ot.collapseIcon,key:"collapse-icon",icon:r?"chevron-down":"chevron-up",scale:"m"})):z("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(ot.headerContainer,a)},o);return e?l:null}renderCloseIcon(){return z("span",{"aria-hidden":"true",class:this.classes(ot.icon,ot.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?z("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:ot.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return z("header",{class:ot.header},this.renderTitle(),z("div",{class:ot.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:n,_flowItems:r,messagesCommon:s}=this,{content:a}=this.viewModel,o=r.toArray(),l={[ot.contentHasFlows]:!!o.length};return t&&!n?z("div",{key:a,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(ot.content,l)},z("calcite-flow",{bind:this,onCalciteFlowItemBack:this._handleBackClick},z("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode","intl-back":s.back,afterCreate:UI,key:"root-flow-item"},this.renderContent()),o.map(c=>this.renderFlowItem(c))),o.map(c=>this.renderFlowItemTooltip(c))):null}renderFlowItem(e){const{messages:t,messagesCommon:n}=this,r=oA();return z("calcite-flow-item",{class:this.classes({[ot.calciteThemeDark]:!r,[ot.calciteThemeLight]:r}),heading:e.title,"intl-back":n.back,description:this._getFlowItemDescription(e),key:`flow-item-${e.viewModel.uid}`},z("calcite-action",{class:ot.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:s=>this._storeExitRelatedRecordsAction(e,s),onclick:this._destroyFlowItemWidgets}),z("div",{class:this.classes(ot.contentFlowItem,{[ot.calciteThemeDark]:r,[ot.calciteThemeLight]:!r})},e.render()))}renderFlowItemTooltip(e){const{messages:t,_exitRelatedRecordsActions:n}=this,r=oA();return z("calcite-tooltip",{class:this.classes({[ot.calciteThemeDark]:!r,[ot.calciteThemeLight]:r}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:n.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords)}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:n,dividedActions:r,messagesCommon:s}=this,a=n?s.close:s.open,{menuActions:o}=r;return o.length?z("div",{key:Pf("actions-menu-button"),class:this.classes(ot.button,ot.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":n?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":a,title:a},z("span",{"aria-hidden":"true",class:ot.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:n,dividedActions:r}=this,{menuActions:s}=r;return s.length&&n?z("ul",{id:e,role:"menu","aria-labelledby":t,key:Pf("actions"),class:ot.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},s.toArray().map(a=>this.renderAction({action:a,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(t=>this.renderAction({action:t,type:"inline"}))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,n=!!e.length,r=!!t.length;return n||r?z("div",{key:"inline-actions-container","data-inline-actions":n.toString(),"data-menu-actions":r.toString(),class:ot.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?z("section",{key:Pf("navigation"),class:this.classes(ot.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:n,menuActions:r}=t,s=!!n.length,a=!!r.length,o={[ot.footerHasPagination]:e,[ot.footerHasActions]:s,[ot.footerHasActionsMenu]:a};return e||s?z("div",{key:Pf("feature-buttons"),class:this.classes(ot.footer,o)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:n}=this.viewModel,r=ua(e.selectedFeatures,{total:t.length});return z("section",{key:Pf("menu"),class:ot.featureMenu},z("strong",{class:ot.featureMenuHeader},r),z("nav",{bind:this,class:ot.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:UI},this.renderFeatureMenu(),z("div",{class:ot.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),n?z("div",{class:ot.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:z("div",{key:Pf("pointer"),class:ot.pointer,role:"presentation"},z("div",{class:this.classes(ot.pointerDirection,ot.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:n,titleId:r,contentId:s,collapsible:a,hasContent:o,contentCollapsed:l,visibleElements:c}=this,{title:u}=this.viewModel,d=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||n==="top-left"||n==="top-center"||n==="top-right",h=t==="top-left"||t==="top-center"||t==="top-right"||n==="bottom-left"||n==="bottom-center"||n==="bottom-right",p={[ot.shadow]:e,[ot.isCollapsible]:a,[ot.isCollapsed]:l};return z("div",{class:this.classes(ot.main,ot.widget,p),tabIndex:c.closeButton?null:-1,role:"dialog","aria-labelledby":u?r:"","aria-describedby":o&&!l?s:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),h?this.renderFooter():null,h?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?z("div",{class:ls.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return z("span",{key:"text",class:ot.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),n=this._getActionImage(e),r={[ot.iconLoading]:e.active,[ot.rotating]:e.active,[ot.icon]:!!t,[ot.actionImage]:!e.active&&!!n};return t&&(r[t]=!e.active),z("span",{key:"icon","aria-hidden":"true",class:this.classes(ot.icon,r),styles:this._getIconStyles(n)})}renderAction(e){const{action:t,type:n}=e,r=this._getActionTitle(t),s={[ot.action]:t.type!=="toggle",[ot.actionToggle]:t.type==="toggle",[ot.actionToggleOn]:t.type==="toggle"&&t.value,[ot.buttonDisabled]:t.disabled},a=[this.renderActionIcon(t),this.renderActionText(r)],o=n==="menu-item"?z("li",{key:t.uid,role:"menuitem",tabIndex:0,title:r,"aria-label":r,class:this.classes(ot.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},a):z("div",{key:t.uid,role:"button",tabIndex:0,title:r,"aria-label":r,class:this.classes(ot.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},a);return t.visible?o:null}renderFeatureMenuItem(e,t){const{messages:n,messagesCommon:r}=this,{selectedFeatureIndex:s,selectedFeatureViewModel:a}=this.viewModel,o=e===a,l={[ot.featureMenuSelected]:o},c=o?z("span",{key:Pf(`feature-menu-selected-feature-${s}`),title:n.selectedFeature,"aria-label":n.selectedFeature,class:ot.iconCheckMark}):null,u=z("span",{innerHTML:e.title||r.untitled});return z("li",{role:"menuitem",tabIndex:-1,key:Pf(`feature-menu-feature-${s}`),class:this.classes(l,ot.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},z("span",{class:ot.featureMenuTitle},u,c))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?z("ol",{class:ot.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(n=>!!n.graphic).map((n,r)=>this.renderFeatureMenuItem(n,r))):null}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();this._exitRelatedRecordsActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy())}_getActionTitle(e){const{messages:t,selectedFeature:n,messagesCommon:r}=this,{id:s}=e,a=n==null?void 0:n.attributes,o=s==="zoom-to-feature"?ua(e.title,{messages:t}):s==="remove-selected-feature"?ua(e.title,{messages:r}):s==="zoom-to-clustered-features"||s==="browse-clustered-features"?ua(e.title,{messages:t}):e.title;return o&&a?ua(o,a):o}_getActionClass(e){const{selectedFeature:t}=this,n=t==null?void 0:t.attributes,{className:r,image:s}=e,a=s||r?r:ot.iconDefaultAction;return a&&n?ua(a,n):a}_getActionImage(e){const{selectedFeature:t}=this,n=t==null?void 0:t.attributes,{image:r}=e;return r&&n?ua(r,n):r}_createFeatureUpdatedAnimation(){return Xye("enter",ot.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const n=Math.round(e);return Math.max(t?n-1:n,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(n=>{this._handles.add(ue(()=>[n.uid,n.active,n.className,n.disabled,n.id,n.title,n.image,n.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(a=>a.visible),n=this._getInlineActionCount(),r=n===null,s=n===0;return{inlineActions:r?t.slice(0):s?new _i:t.slice(0,n),menuActions:r?new _i:s?t.slice(0):t.slice(n)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var n,r;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((n=e.viewModel)==null?void 0:n.state)==="error"?t.errorMessage:((r=e.viewModel)==null?void 0:r.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){Uv(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){Uv(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,n=e.currentTarget["data-feature-index"];t.activeFeature=t.features[n]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=Uv(e),{_featureMenuNode:n}=this,r=e.currentTarget["data-feature-index"];if(!n)return;const s=n.querySelectorAll("li"),a=s.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),s[s.length-1].focus()):(e.stopPropagation(),s[0].focus()):(e.stopPropagation(),s[(r+1+a)%a].focus()):(e.stopPropagation(),s[(r-1+a)%a].focus())}_handleActionMenuItemKeyup(e){const t=Uv(e),{_actionsMenuNode:n}=this,r=e.currentTarget.dataset.actionUid,{menuActions:s}=this.dividedActions,a=s.findIndex(c=>c.uid===r);if(!n)return;const o=n.querySelectorAll("li"),l=o.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),o[o.length-1].focus()):(e.stopPropagation(),o[0].focus()):(e.stopPropagation(),o[(a+1+l)%l].focus()):(e.stopPropagation(),o[(a-1+l)%l].focus())}_handleMainKeyup(e){const t=Uv(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:n}=this.viewModel;n?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await $u(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=ue(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,n)=>this._selectedFeatureIndexUpdated(t,n));this._handles.add(e,RY)}_selectedFeatureIndexUpdated(e,t){const{featureCount:n}=this;n&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:n,screenLocation:r,side:s,view:a}=e;if(isNaN(n)||isNaN(t)||!a||!r)return!1;const o=a.padding;return s==="right"&&r.x+n/2>a.width-o.right||s==="left"&&r.x-n/2<o.left||s==="top"&&r.y-t<o.top||s==="bottom"&&r.y+t>a.height-o.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:n,_mainContainerNode:r,viewModel:s}=this,{screenLocation:a,view:o}=s;if(B(a)||!o||!n)return"top-center";if(!this._isScreenLocationWithinView(a,o))return this._get("currentAlignment")||"top-center";function l(C){return parseInt(C.replace(/[^-\d\.]/g,""),10)}const c=r?window.getComputedStyle(r,null):null,u=c?l(c.getPropertyValue("max-height")):0,d=c?l(c.getPropertyValue("height")):0,{height:h,width:p}=n.getBoundingClientRect(),m=p+t,g=Math.max(h,u,d)+t,_=this._isOutsideView({popupHeight:g,popupWidth:m,screenLocation:a,side:"right",view:o}),b=this._isOutsideView({popupHeight:g,popupWidth:m,screenLocation:a,side:"left",view:o}),x=this._isOutsideView({popupHeight:g,popupWidth:m,screenLocation:a,side:"top",view:o}),w=this._isOutsideView({popupHeight:g,popupWidth:m,screenLocation:a,side:"bottom",view:o});return b?x?"bottom-right":"top-right":_?x?"bottom-left":"top-left":x?w?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return Su(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var o;if(e!=="auto")return e;const t=(o=this.viewModel)==null?void 0:o.view,n=Su(this.container)?"top-left":"top-right";if(!t)return n;const r=t.padding||{left:0,right:0,top:0,bottom:0},s=t.width-r.left-r.right,{breakpoints:a}=t;return a&&s<=a.xsmall?"bottom-center":n}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:n}=e.getBoundingClientRect(),r=this._calculatePositionStyle(t,n);r&&(e.style.top=r.top,e.style.left=r.left,e.style.bottom=r.bottom,e.style.right=r.right)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:n}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+n:e}_calculateAlignmentPosition(e,t,n,r){const{currentAlignment:s,_pointerOffsetInPx:a}=this,o=r/2,l=n.height-t,c=n.width-e,{padding:u}=this.view;return s==="bottom-center"?{top:t+a-u.top,left:e-o-u.left}:s==="top-left"?{bottom:l+a-u.bottom,right:c+a-u.right}:s==="bottom-left"?{top:t+a-u.top,right:c+a-u.right}:s==="top-right"?{bottom:l+a-u.bottom,left:e+a-u.left}:s==="bottom-right"?{top:t+a-u.top,left:e+a-u.left}:s==="top-center"?{bottom:l+a-u.bottom,left:e-o-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:n,view:r}=this;if(!r)return;if(n)return{left:"",top:"",right:"",bottom:""};if(B(e)||!t)return;const s=this._calculateFullWidth(t),a=this._calculateAlignmentPosition(e.x,e.y,r,s);return a?{top:a.top!==void 0?`${a.top}px`:"auto",left:a.left!==void 0?`${a.left}px`:"auto",bottom:a.bottom!==void 0?`${a.bottom}px`:"auto",right:a.right!==void 0?`${a.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const n=this.get("viewModel.view");this._wireUpView(n)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,n){const[r,s]=e,[a,o]=t,{width:l,height:c}=n;return r<=l&&a>l||r>l&&a<=l||s<=c&&o>c||s>c&&o<=c}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const n=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},r=n.left+n.right,s=n.top+n.bottom,a=[],o=[];a[0]=e[0]-r,a[1]=e[1]-s,o[0]=t[0]-r,o[1]=t[1]-s;const{dockOptions:l}=this,c=l.breakpoint;this._dockingThresholdCrossed(a,o,c)&&this._setDockEnabledForViewSize(l),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const n=t.active&&!e;t.screenLocationEnabled=n}_shouldDockAtCurrentViewSize(e){var l,c;const t=e.breakpoint,n=(c=(l=this.viewModel)==null?void 0:l.view)==null?void 0:c.ui;if(!n)return!1;const{width:r,height:s}=n;if(isNaN(r)||isNaN(s))return!1;const a=t.hasOwnProperty("width")&&r<=t.width,o=t.hasOwnProperty("height")&&s<=t.height;return a||o}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?ua(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,IY),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new Uue({view:e}),e.ui.add(this._spinner,{key:IY,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:n}=this.viewModel,r=n.findIndex(a=>a.uid===t),s=n.getItemAt(r);s&&s.type==="toggle"&&(s.value=!s.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(r)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};f([y({readOnly:!0})],ai.prototype,"actionsMenuId",null),f([y({readOnly:!0})],ai.prototype,"actionsMenuButtonId",null),f([y({readOnly:!0})],ai.prototype,"featureMenuId",null),f([y({readOnly:!0})],ai.prototype,"titleId",null),f([y({readOnly:!0})],ai.prototype,"contentId",null),f([y({readOnly:!0})],ai.prototype,"hasContent",null),f([y({readOnly:!0})],ai.prototype,"featureNavigationVisible",null),f([y({readOnly:!0})],ai.prototype,"collapsible",null),f([y({readOnly:!0})],ai.prototype,"featureMenuVisible",null),f([y({readOnly:!0})],ai.prototype,"contentCollapsed",null),f([y({readOnly:!0})],ai.prototype,"dividedActions",null),f([y({readOnly:!0,dependsOn:["_flowItems.length"]})],ai.prototype,"_activeFlowItemWidget",null),f([y()],ai.prototype,"actions",null),f([y()],ai.prototype,"actionsMenuOpen",null),f([y()],ai.prototype,"alignment",void 0),f([y()],ai.prototype,"autoCloseEnabled",null),f([y()],ai.prototype,"autoOpenEnabled",null),f([y()],ai.prototype,"defaultPopupTemplateEnabled",null),f([y()],ai.prototype,"content",null),f([y()],ai.prototype,"collapsed",void 0),f([y()],ai.prototype,"collapseEnabled",void 0),f([y({readOnly:!0})],ai.prototype,"currentAlignment",null),f([y({readOnly:!0})],ai.prototype,"currentDockPosition",null),f([y()],ai.prototype,"dockOptions",null),f([y()],ai.prototype,"dockEnabled",void 0),f([y({readOnly:!0})],ai.prototype,"featureCount",null),f([y()],ai.prototype,"featureMenuOpen",void 0),f([y()],ai.prototype,"features",null),f([y()],ai.prototype,"goToOverride",null),f([y()],ai.prototype,"headingLevel",void 0),f([y()],ai.prototype,"highlightEnabled",null),f([y()],ai.prototype,"location",null),f([y()],ai.prototype,"label",null),f([y()],ai.prototype,"maxInlineActions",void 0),f([y(),En("esri/widgets/Popup/t9n/Popup")],ai.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],ai.prototype,"messagesCommon",void 0),f([y()],ai.prototype,"promises",null),f([y({readOnly:!0})],ai.prototype,"selectedFeature",null),f([y()],ai.prototype,"selectedFeatureIndex",null),f([y({readOnly:!0})],ai.prototype,"selectedFeatureWidget",null),f([y()],ai.prototype,"spinnerEnabled",void 0),f([y()],ai.prototype,"title",null),f([y()],ai.prototype,"updateLocationEnabled",null),f([y()],ai.prototype,"view",null),f([y({type:Que}),WC(["triggerAction","trigger-action"])],ai.prototype,"viewModel",void 0),f([y()],ai.prototype,"visible",null),f([y()],ai.prototype,"visibleElements",void 0),f([Mr("visibleElements")],ai.prototype,"castVisibleElements",null),f([dr()],ai.prototype,"_close",null),f([dr()],ai.prototype,"_toggleDockEnabled",null),f([dr()],ai.prototype,"_toggleFeatureMenu",null),f([dr()],ai.prototype,"_toggleActionsMenu",null),f([dr()],ai.prototype,"_triggerAction",null),f([dr()],ai.prototype,"_selectFeature",null),f([dr()],ai.prototype,"_next",null),f([dr()],ai.prototype,"_previous",null),ai=f([ge("esri.widgets.Popup")],ai);const kY=ai,Qk=[0,0];function Ket(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return Qk[0]=t.left+((e==null?void 0:e.pageXOffset)??0),Qk[1]=t.top+((e==null?void 0:e.pageYOffset)??0),Qk}function FY(i){i&&(Aie(i),i.parentNode&&i.parentNode.removeChild(i))}function Yet(i){const e=document.createElement("div");return i.appendChild(e),e}const xT=16,cP=750,Xet=512,Zet=2,Jue=i=>{let e=class extends i{constructor(...t){var n;super(...t),this._freqInfo={freq:xT,time:cP},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,t.length!==0&&((n=t[0])==null?void 0:n.popup)!==void 0||(this.popup=new kY({view:this})),this.handles.add([ue(()=>this.cursor,r=>{const{surface:s}=this;s&&s.setAttribute("data-cursor",r)}),ue(()=>this.interacting,r=>{const{surface:s}=this;s&&s.setAttribute("data-interacting",r.toString())})])}initialize(){this.handles.add(ue(()=>this.ui,(t,n)=>this._handleUIChange(t,n))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=_t(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const n=this._get("container"),r=uB(t),s=r instanceof HTMLDivElement?r:null;if(s||typeof t!="string"||tt.getLogger(this.declaredClass).error("#container",`element with id '${t}' not found`),n===s)return;const a="dom-size";if(this.handles.remove(a),this._stopMeasuring(),n&&(n.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(FY(this.root),this._set("root",null)),this.userContent&&(AG(this.userContent,n),FY(this.userContent),this._set("userContent",null))),!s)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);s.classList.add("esri-view");const o=document.createElement("div");o.className="esri-view-user-storage",AG(s,o),s.appendChild(o),this._set("userContent",o);const l=document.createElement("div");l.className="esri-view-root",s.insertBefore(l,s.firstChild),this._set("root",l);const c=document.createElement("div");c.className="esri-view-surface",c.setAttribute("role","application"),c.tabIndex=0,l.appendChild(c),this._set("surface",c);const u=new XK;l.appendChild(u.surface),this._set("overlay",u),ue(()=>u.needsRender,d=>{d&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Vm({render:()=>{var h;return(h=this.overlay)==null?void 0:h.render()}}):this._overlayRenderTaskHandle=Gr(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(ue(()=>this.size,d=>{const[h,p]=d,m="esri-view-surface--inset-outline";h>=document.body.clientWidth||p>=document.body.clientHeight?c.classList.add(m):c.classList.remove(m)},At),a),this._set("container",s),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}set popup(t){const n=this._get("popup");n&&n!==t&&n.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,n,r){const s=this.position;return t-=s?s[0]:0,n-=s?s[1]:0,r?(r[0]=t,r[1]=n):r=[t,n],r}containerToPage(t,n,r){const s=this.position;return t+=s?s[0]:0,n+=s?s[1]:0,r?(r[0]=t,r[1]=n):r=[t,n],r}_handleUIChange(t,n){n&&(this.handles.remove("ui"),n.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([ue(()=>this.root,n=>{t.container=n?Yet(n):null},At),ue(()=>this.popup,(n,r)=>{const s="popup",a="manual";r&&t.remove(r,s),n&&(n.view=t.view,t.add(n,{key:s,position:a}))},At)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=xT,t.time=cP,this.handles.add([(()=>{const n=()=>{t.freq=xT,t.time=cP};return window.addEventListener("resize",n),{remove(){window.removeEventListener("resize",n)}}})(),Vm({prepare:n=>{const r=this._measure(),s=this._freqInfo;if(s.time+=n.deltaTime,r&&(s.freq=xT,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const a=this._position();s.freq=a||r?xT:Math.min(cP,s.freq*Zet),!r&&s.freq>=Xet&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,n=t?t.clientWidth:0,r=t?t.clientHeight:0;if(n===0||r===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,a=this.height;return n===s&&r===a?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",n),this._set("height",r),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:a,width:n,height:r}),!0)}_position(){const t=this.container,n=this.position,r=t&&Ket(t);return!!r&&(!n||r[0]!==n[0]||r[1]!==n[1])&&(this._set("position",[r[0],r[1]]),!0)}forceDOMReadyCycle(){}};return f([y()],e.prototype,"container",null),f([y({readOnly:!0})],e.prototype,"focused",null),f([y({readOnly:!0})],e.prototype,"height",void 0),f([y({type:kY})],e.prototype,"popup",null),f([y({type:XK})],e.prototype,"overlay",void 0),f([y({readOnly:!0})],e.prototype,"position",void 0),f([y({readOnly:!0})],e.prototype,"resizing",void 0),f([y({readOnly:!0})],e.prototype,"root",void 0),f([y({value:null,readOnly:!0})],e.prototype,"size",null),f([y({readOnly:!0})],e.prototype,"surface",void 0),f([y({readOnly:!0})],e.prototype,"suspended",void 0),f([y()],e.prototype,"ui",void 0),f([y({readOnly:!0})],e.prototype,"userContent",void 0),f([y({readOnly:!0})],e.prototype,"width",void 0),f([y()],e.prototype,"widthBreakpoint",void 0),e=f([ge("esri.views.DOMContainer")],e),e},ede=i=>{let e=class extends i{async fetchPopupFeatures(t,n){await this.when();const{location:r,queryArea:s,layerViewsAndGraphics:a,clientOnlyGraphics:o}=await this._prepareFetchPopupFeatures(t,n),l=Promise.resolve(o),c=this._queryLayerPopupFeatures(s,a,n),u=c.map(d=>d.promise);return{location:r,clientOnlyGraphics:o,allGraphicsPromise:lie([l,...u]).then(d=>Array.from(new Set(d.flat()))),promisesPerLayerView:c}}_queryLayerPopupFeatures(t,n,r){return n.map(({layerView:s,graphics:a})=>{const o={clientGraphics:a,event:T(r)?r.event:null,signal:T(r)?r.signal:null,defaultPopupTemplateEnabled:!!T(r)&&!!r.defaultPopupTemplateEnabled},l=s.fetchPopupFeatures(t,o);return{layerView:s,promise:l}})}_isValidPopupGraphic(t,n){return t&&!!t.getEffectivePopupTemplate(T(n)&&n.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,n){const{clientGraphics:r,queryArea:s,location:a}=await this._popupHitTestGraphics(t,n),o=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:l,clientOnlyGraphics:c}=this._graphicsPerFetchPopupLayerView(r,o);return{clientOnlyGraphics:c,layerViewsAndGraphics:l,queryArea:s,location:a}}async _popupHitTestGraphics(t,n){const{results:r,mapPoint:s}=await this.popupHitTest(t),a=r.filter(l=>l.type==="graphic"&&this._isValidPopupGraphic(l.graphic,n)),o=a.length?a[0].mapPoint:null;return{clientGraphics:a.map(l=>l.graphic),queryArea:s,location:s||o}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach(n=>{this._isValidPopupLayerView(n)&&t.push(n)}),T(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return T(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,n){const r=[],s=new Map,a=n.map(o=>{const l=[];return"layer"in o?s.set(o.layer,l):s.set(o.graphics,l),{layerView:o,graphics:l}});for(const o of t){const l=s.get(o.layer)||s.get(o.sourceLayer)||null;l?l.push(o):r.push(o)}return{layerViewsAndGraphics:a,clientOnlyGraphics:r}}};return e=f([ge("esri.views.PopupView")],e),e};let mC=class extends Z_e{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{B(t.item)||t.item.parent===this.owner&&(tt.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};mC=f([ge("esri.support.AnalysesCollection")],mC);let ov=class extends et{constructor(e){super(e),this.view=null,this.baseLayerViews=new _i,this.referenceLayerViews=new _i,this._loadingHandle=ue(()=>{var t,n;return(n=(t=this.view)==null?void 0:t.map)==null?void 0:n.basemap},t=>{t&&t.load().catch(()=>{})},At)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,n;if(this.view&&this.view.suspended)return!1;const e=(n=(t=this.view)==null?void 0:t.map)==null?void 0:n.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(r=>r.updating)||this.referenceLayerViews.some(r=>r.updating))}};f([y({constructOnly:!0})],ov.prototype,"view",void 0),f([y({readOnly:!0})],ov.prototype,"baseLayerViews",void 0),f([y({readOnly:!0})],ov.prototype,"referenceLayerViews",void 0),f([y({readOnly:!0})],ov.prototype,"suspended",null),f([y({type:Boolean,readOnly:!0})],ov.prototype,"updating",null),ov=f([ge("esri.views.BasemapView")],ov);let Qet=class{constructor(e,t,n){this.layer=e,this.view=t,this.layerViewImporter=n,this._controller=new AbortController,this._deferred=cie(),this._started=!1,this.done=!1,Bm(this._controller.signal,()=>{const r=new Ze("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r)})}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:t,view:n}=this;t.emit("layerview-destroy",{view:n,layerView:e}),n.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var r,s;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:n}=this;this._map=n.map;try{let a,o;if(await t.load({signal:e}),"prefetchResources"in t&&await t.prefetchResources({signal:e}),t.createLayerView)a=await t.createLayerView(n,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new Ze("layer:view-not-supported","No layerview implementation was found");const u=await this.layerViewImporter.importLayerView(t);Cn(e),a="default"in u?new u.default({layer:t,view:n}):new u({layer:t,view:n})}const l=()=>{o=Gr(o),a.destroyed||a.destroy(),a.layer=null,a.parent=null,a.view=null,this.done=!0};o=Bm(e,l),Cn(e);try{await a.when()}catch(u){throw l(),u}if(!((s=(r=this._map)==null?void 0:r.allLayers)==null?void 0:s.includes(t)))return l(),void this._deferred.reject(new Ze("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=a,t.emit("layerview-create",{view:n,layerView:a}),n.emit("layerview-create",{layer:t,layerView:a}),this.done=!0,this._deferred.resolve(a)}catch(a){t.emit("layerview-create-error",{view:n,error:a}),n.emit("layerview-create-error",{layer:t,error:a}),this.done=!0,this._deferred.reject(new Ze("layerview:create-error","layerview creation failed",{layer:t,error:a}))}}},Gu=class extends et{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new wb,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var n;const t=(n=this.view.map)==null?void 0:n.allLayers;if(t)for(const r of t)this.layerViewImporter.hasLayerViewModule(r)&&this.layerViewImporter.importLayerView(r)},this._reschedule=()=>(B(this._workPromise)&&(this._workPromise=cie(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(aie(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var o,l,c;const t=this.view.map;if(this._map!==t&&(this.clear(),this._map=t),B(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const n=[],r=u=>{if(!B(u))for(const d of u)d&&(n.push(d),this._createLayerView(d),"layers"in d&&d.layers&&r(d.layers))};for(const u of this._rootCollectionNames)r(this.get(u));this._refreshCollections();for(const[u,d]of this._layerLayerViewInfoMap)n.includes(u)||(this._layerLayerViewInfoMap.delete(d.layer),d.destroy());const s=n.filter(u=>u.type==="group").map(u=>u.layers),a=[(o=t==null?void 0:t.ground)==null?void 0:o.layers,(l=t==null?void 0:t.basemap)==null?void 0:l.baseLayers,(c=t==null?void 0:t.basemap)==null?void 0:c.referenceLayers,t==null?void 0:t.layers,...s].filter(u=>!!u);this.addHandles(a.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([Sn(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),ue(()=>{const e=this.view,t=e==null?void 0:e.map;return[t==null?void 0:t.basemap,t==null?void 0:t.ground,t==null?void 0:t.layers,e==null?void 0:e.ready]},()=>this._reschedule(),hn)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,T(this._workPromise)&&(this._workPromise.reject(js()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return T(this._workPromise)||this._watchUpdatingTracking.updating||ps(this._layerLayerViewInfoMap,e=>!e.done)}get updatingRemaining(){let e=0;for(const t of this._layerLayerViewInfoMap.values())t.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new Ze("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,t]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(t),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,t,n){if(!e||!t)return void(t&&t.removeAll());let r=0;for(const s of e){const a=this._layerLayerViewInfoMap.get(s);if(!a||!a.layerView)continue;const o=a.layerView;o.layer=s,o.parent=n,t.getItemAt(r)!==o&&t.splice(r,0,o),s.layers&&this._populateLayerViewsOwners(s.layers,o.layerViews,o),r+=1}r<t.length&&t.splice(r,t.length)}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const t=new Qet(e,this.view,this.layerViewImporter);t.promise.then(()=>this._refreshCollections(),n=>{n&&(zo(n)||n.name==="cancelled:layerview-create")||tt.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:n}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,t),this.view.ready&&t.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};f([y()],Gu.prototype,"_workPromise",void 0),f([y({readOnly:!0})],Gu.prototype,"_watchUpdatingTracking",void 0),f([y({readOnly:!0})],Gu.prototype,"_layersToLayerViews",null),f([y({readOnly:!0})],Gu.prototype,"_rootCollectionNames",null),f([y()],Gu.prototype,"layerViewImporter",void 0),f([y()],Gu.prototype,"supportsGround",void 0),f([y({readOnly:!0})],Gu.prototype,"updating",null),f([y({readOnly:!0})],Gu.prototype,"updatingRemaining",null),f([y({constructOnly:!0})],Gu.prototype,"view",void 0),Gu=f([ge("esri.views.LayerViewManager")],Gu);const Jet=Gu;let iu=class extends et{constructor(e){super(e),this.factor=1.5,this.offset=Cs(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};f([y({type:Number})],iu.prototype,"factor",void 0),f([y({nonNullable:!0})],iu.prototype,"offset",void 0),f([y()],iu.prototype,"position",void 0),f([y({type:Number,range:{min:0}})],iu.prototype,"size",void 0),f([y()],iu.prototype,"maskUrl",void 0),f([y()],iu.prototype,"maskEnabled",void 0),f([y()],iu.prototype,"overlayUrl",void 0),f([y()],iu.prototype,"overlayEnabled",void 0),f([y({readOnly:!0})],iu.prototype,"version",null),f([y({type:Boolean})],iu.prototype,"visible",void 0),iu=f([ge("esri.views.Magnifier")],iu);const tde=iu;let Nw=class extends et{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(t==null?void 0:t.registerTask($r.TEXTURE_UNLOAD))??GA}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,n){const r=this.makeUid(e);let s=this._textureRequests.get(r);return s||(s={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:n},this._stage&&(this._stage.add(s.texture),this._stage.loadImmediate(s.texture)),this._textureRequests.set(r,s)),s.referenceCount++,{uid:r,texture:s.texture,release:()=>this._release(r)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return T(t)?`${e}.${t}px`:e}};f([y()],Nw.prototype,"_frameTask",void 0),f([y()],Nw.prototype,"updating",null),Nw=f([ge("esri.views.3d.support.TextureCollection")],Nw);var NY;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(NY||(NY={}));const ide=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],nde={};function rde(i){return!!nde[i]}function ett(i){for(const e of i)if(!rde(e))return!1;return!0}ide.forEach(i=>{nde[i]=!0});let ttt=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:n},r)=>this.inputManager.installHandlers(r,[t],n))}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>this.inputManager.uninstallHandlers(t)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,n,r){const s=Array.isArray(e)?e:e.split(",");if(!ett(s))return s.some(rde)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let a,o;Array.isArray(t)?o=t:(a=t,o=[]),typeof n=="function"?a=n:r=n,r=r??Pt.DEFAULT;const l=this._createUniqueGroupName(),c=new itt(this.view,s,o,a);this._handlers.set(l,{handler:c,priority:r});for(const u of s){const d=this._handlerCounts.get(u)||0;this._handlerCounts.set(u,d+1)}return this.inputManager&&this.inputManager.installHandlers(l,[c],r),{remove:()=>this._removeHandler(l,s)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const n of t){const r=this._handlerCounts.get(n);r===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",n):r===1?this._handlerCounts.delete(n):this._handlerCounts.set(n,r-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},itt=class extends sr{constructor(e,t,n,r){super(!0),this.view=e;for(const s of t)switch(s){case"click":this.registerIncoming("click",n,a=>r(this._wrapClick(a)));break;case"double-click":this.registerIncoming("double-click",n,a=>r(this._wrapDoubleClick(a)));break;case"immediate-click":this.registerIncoming("immediate-click",n,a=>r(this._wrapImmediateClick(a)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",n,a=>r(this._wrapImmediateDoubleClick(a)));break;case"hold":this.registerIncoming("hold",n,a=>r(this._wrapHold(a)));break;case"drag":this.registerIncoming("drag",n,a=>{const o=this._wrapDrag(a);o&&r(o)});break;case"key-down":this.registerIncoming("key-down",n,a=>r(this._wrapKeyDown(a)));break;case"key-up":this.registerIncoming("key-up",n,a=>r(this._wrapKeyUp(a)));break;case"pointer-down":this.registerIncoming("pointer-down",n,a=>r(this._wrapPointer(a,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",n,a=>r(this._wrapPointer(a,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",n,a=>r(this._wrapPointer(a,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",n,a=>r(this._wrapPointerDrag(a)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",n,a=>r(this._wrapMouseWheel(a)));break;case"pointer-enter":this.registerIncoming("pointer-enter",n,a=>r(this._wrapPointer(a,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",n,a=>r(this._wrapPointer(a,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",n,a=>{r(this._wrapGamepad(a))});break;case"focus":this.registerIncoming("focus",n,a=>{r(this._wrapFocus(a))});break;case"blur":this.registerIncoming("blur",n,a=>{r(this._wrapBlur(a))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:n,buttons:r,x:s,y:a,native:o,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"click",pointerType:t,button:n,buttons:r,x:s,y:a,native:o,timestamp:u,screenPoint:Cs(s,a),mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:n,buttons:r,x:s,y:a,native:o,eventId:l}=e.data,{cancelable:c,timestamp:u}=e;return{type:"double-click",pointerType:t,button:n,buttons:r,x:s,y:a,native:o,timestamp:u,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:n,buttons:r,x:s,y:a,native:o,eventId:l}=e.data,c=o.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-click",pointerId:c,pointerType:t,button:n,buttons:r,x:s,y:a,native:o,timestamp:d,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:n,buttons:r,x:s,y:a,native:o,eventId:l}=e.data,c=o.pointerId,{cancelable:u,timestamp:d}=e;return{type:"immediate-double-click",pointerId:c,pointerType:t,button:n,buttons:r,x:s,y:a,native:o,timestamp:d,mapPoint:this._getMapPoint(s,a),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:n,buttons:r,x:s,y:a,native:o}=e.data,{cancelable:l,timestamp:c}=e;return{type:"hold",pointerType:t,button:n,buttons:r,x:s,y:a,native:o,timestamp:c,mapPoint:this._getMapPoint(s,a),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(Cs(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:n,y:r}=t.center,{action:s,pointerType:a,button:o}=t;if(s==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const l=t.pointer.native,c=t.buttons,{cancelable:u,timestamp:d}=e,h={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:n,y:r,origin:h,pointerType:a,button:o,buttons:c,radius:t.radius,angle:ql(t.angle),native:l,timestamp:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:n,native:r}=e.data,{cancelable:s,timestamp:a}=e;return{type:"key-down",key:t,repeat:n,native:r,timestamp:a,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:o=>e.async(o),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:n}=e.data,{cancelable:r,timestamp:s}=e;return{type:"key-up",key:t,native:n,timestamp:s,cancelable:r,stopPropagation:()=>e.stopPropagation(),async:a=>e.async(a),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:n,y:r,button:s,buttons:a,native:o,eventId:l}=e.data,c=o.pointerId,u=o.pointerType,{cancelable:d,timestamp:h}=e;return{type:t,x:n,y:r,pointerId:c,pointerType:u,button:s,buttons:a,native:o,timestamp:h,eventId:l,cancelable:d,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:n,buttons:r,native:s,eventId:a}=e.data.currentEvent,{button:o}=e.data.startEvent,l=e.data.startEvent.native.pointerId,c=e.data.startEvent.native.pointerType,u=e.data.action,d={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:h,timestamp:p}=e;return{type:"pointer-drag",x:t,y:n,pointerId:l,pointerType:c,button:o,buttons:r,action:u,origin:d,native:s,timestamp:p,eventId:a,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:n,timestamp:r}=e,{x:s,y:a,deltaY:o,native:l}=n;return{type:"mouse-wheel",x:s,y:a,deltaY:o,native:l,timestamp:r,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:n,device:r}=e.data,{cancelable:s,timestamp:a}=e,{buttons:o,axes:l}=n;return{type:"gamepad",device:r,timestamp:a,action:t,buttons:o,axes:l,cancelable:s,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}};var ad,VY,BY;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})(ad||(ad={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(VY||(VY={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(BY||(BY={}));function ntt(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return tt.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function KV(i){return i.visible&&i.getEditableFlag(ad.USER)&&i.getEditableFlag(ad.MANAGER)}function Cr(i){return Cs(i.x,i.y)}function dIt(i){return Fn(i.x,i.y)}function sde(i,e){const t=(i instanceof HTMLElement?i:i.surface).getBoundingClientRect();return Cs(e.clientX-t.left,e.clientY-t.top)}function R$(i,e){return e instanceof Event?sde(i,e):Cr(e)}function I$(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let rtt=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(e,t){const n=()=>e.stopPropagation();switch(e.type){case"pointer-move":zY(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(n(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!UY(e))break;const r=Cr(e),s=this._intersect(r,e.pointerType,t.forEachTool);if(B(s))break;const a=s.manipulator,o=s.tool;!(T(a)&&T(o)&&a.interactive)||a.grabbable&&a.grabbableForEvent(e)||!a.grabbing||a.dragging||this._ungrabManipulatorBeforeDragging(a,e,t),T(a)&&T(o)&&a.interactive&&a.grabbable&&a.grabbableForEvent(e)&&!a.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:a,tool:o,start:r,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&B(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(s.tool)),a.grabbing=!0,a.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:r}),n());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!UY(e))break;const r=this._grabbedManipulators.get(e.pointerId),s=Qa(r,({manipulator:u})=>u),a=Qa(r,({tool:u})=>u);if(B(s)||B(a))break;const o=Cr(e);o.x=lt(o.x,0,t.view.width),o.y=lt(o.y,0,t.view.height);const l=kt(r).start,c=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:l,screenPoint:o}):s.events.emit("drag",{action:"start",start:l,screenPoint:o,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:a,manipulator:s,start:l}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:l,screenPoint:o}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}n();break}case"immediate-click":{const r=Cr(e),s=this._intersect(r,e.pointerType,t.forEachTool);if(stt(e)||t.forEachTool(c=>{if((!T(s)||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let u=!1;c.manipulators.forEach(({manipulator:d})=>{d.selected&&(d.selected=!1,u=!0)}),u&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}),B(s))break;const{manipulator:a,tool:o}=s;if(!a.interactive)break;a.selectable&&o.automaticManipulatorSelection&&(a.selected=!a.selected,o.onManipulatorSelectionChanged&&o.onManipulatorSelectionChanged());const l=e.native.shiftKey;a.events.emit("immediate-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:n});break}case"click":{const r=Cr(e),s=this._intersect(r,e.pointerType,t.forEachTool),a=T(s)?s.manipulator:null;if(B(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit(e.type,{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:o}),n();break}case"double-click":{const r=Cr(e),s=this._intersect(r,e.pointerType,t.forEachTool),a=T(s)?s.manipulator:null;if(B(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit("double-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:o,stopPropagation:n});break}case"immediate-double-click":{const r=Cr(e),s=this._intersect(r,e.pointerType,t.forEachTool),a=T(s)?s.manipulator:null;if(B(a)||!a.interactive)break;const o=e.native.shiftKey;a.events.emit("immediate-double-click",{screenPoint:r,button:e.button,pointerType:e.pointerType,shiftKey:o,stopPropagation:n});break}}this._onFocusChange(t.forEachTool)}_ungrabManipulatorBeforeDragging(e,t,n){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:Cr(t)}),this._grabbedManipulators.forEach(({manipulator:r},s)=>{r===e&&this._grabbedManipulators.delete(s)}),this._afterManipulatorUngrab(n.setActiveTool)}_handlePointerEnd(e,t){const n=Qa(this._grabbedManipulators.get(e.pointerId),({manipulator:r})=>r);B(n)||n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:Cr(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}_cursorFromMap(e){let t=null;return ps(e,({manipulator:n})=>!(B(n)||!n.interactive)&&(n.grabbing&&n.grabCursor?(t=n.grabCursor,!0):!!n.cursor&&(t=n.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,n=new Set;this._grabbedManipulators.forEach(({tool:r})=>{t.add(r)}),this._hoveredManipulators.forEach(({tool:r})=>{n.add(r)}),e(r=>{r.hasGrabbedManipulators=t.has(r),r.hasHoveredManipulators=n.has(r);const s=this._grabbedManipulators.values(),a=sye(s,({tool:o})=>o===r);r.firstGrabbedManipulator=T(a)?a.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:n},r=!0,s){const a=(o,l)=>o===e&&(B(s)||s===l);this._grabbedManipulators.forEach(({tool:o,manipulator:l,pointerType:c},u)=>{a(o,l)&&(this._grabbedManipulators.delete(u),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:o,manipulator:l},c)=>{a(o,l)&&(this._draggedManipulators.delete(c),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),r&&this._hoveredManipulators.forEach(({tool:o,manipulator:l},c)=>{a(o,l)&&(this._hoveredManipulators.delete(c),l.hovering=!1)}),this._afterManipulatorUngrab(n),this._onFocusChange(t)}_intersect(e,t,n){let r=null;return n(s=>{if(s.manipulators==null||!KV(s))return!1;const a=s.manipulators.intersect(e,t);return!B(a)&&(r={tool:s,manipulator:a},!0)}),r}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,n)=>{this._updateHoveredStateForPointerAtScreenPosition(Cs(t.x,t.y),n,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!zY(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(Cr(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,n,r){let s=this._intersect(e,n,r);const a=Qa(this._hoveredManipulators.get(t),({manipulator:o})=>o);T(s)&&!s.manipulator.interactive&&(s=null),T(s)&&a===s.manipulator||(T(a)&&(a.hovering=!1),T(s)?(s.manipulator.hovering=!0,this._hoveredManipulators.set(t,s)):this._hoveredManipulators.delete(t),this._onFocusChange(r))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function zY(i){return i==="mouse"}function UY(i){return i.pointerType!=="mouse"||i.button===0}function stt(i){return!!i.native.shiftKey}const HY="attached",Jk="tools";let Yf=class extends PC{constructor(e){super(e),this._manipulatorState=new rtt,this.tools=new _i,this.cursor=null,this._forEachTool=t=>{for(const n of this.tools.items)if(t(n))return}}initialize(){this.handles.add([this.view.on(ide,e=>{this._handleInputEvent(e)},Pt.TOOL),...ntt(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(T(e)&&!this.view.ready)return void tt.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),T(t)&&t.deactivate(),T(e)&&e.activate(),this._removeIncompleteTools(e);for(const n of this.tools){this._updateToolEditableFlag(n);const r=KV(n);!B(this.activeTool)&&r||this._manipulatorState.clearPointers(n,this._manipulatorStateEventArgs,!r)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(t=>t.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}attach(){this.view.type==="3d"?(this._set("textures",new Nw(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([ue(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}),this.view.elevationProvider.on("elevation-change",e=>{this._forEachManipulator(t=>{t.onElevationChange!=null&&t.onElevationChange(e)})}),bh(()=>this._set("textures",_t(this.textures)))],HY)):this.handles.add(ue(()=>this.view.extent,()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}))}detach(){T(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(HY)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:n})=>e(n,t))})}_handleInputEvent(e){let t=!1;const n={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};T(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(n):this._forEachTool(r=>{!t&&r.visible&&r.handleInputEvent(n)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(n,this._manipulatorStateEventArgs),!t&&T(this.activeTool)&&this.activeTool.handleInputEventAfter(n),this._manipulatorState.handleHoverEvent(n,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(Jk),this._forEachTool(e=>{if(e instanceof et){const t=ue(()=>[e.cursor,e.visible,e.editable],()=>{KV(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,Jk)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Jk)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag(ad.MANAGER,B(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;B(e)&&this._forEachTool(t=>!(!T(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(B(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};f([y({constructOnly:!0,nonNullable:!0})],Yf.prototype,"view",void 0),f([y({readOnly:!0,nonNullable:!0})],Yf.prototype,"textures",void 0),f([y({value:null})],Yf.prototype,"activeTool",null),f([y({readOnly:!0,type:_i})],Yf.prototype,"tools",void 0),f([y({readOnly:!0})],Yf.prototype,"cursor",void 0),f([y({readOnly:!0})],Yf.prototype,"updating",null),Yf=f([ge("esri.views.ToolViewManager")],Yf);const att=Yf;let rw=class extends et{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":ott.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return ltt[this.deviceType]}};f([y({nonNullable:!0,readOnly:!0})],rw.prototype,"nativeIndex",void 0),f([y({type:String,readOnly:!0})],rw.prototype,"deviceType",null),f([y({type:Number,readOnly:!0})],rw.prototype,"axisThreshold",null),rw=f([ge("esri.views.input.gamepad.GamepadInputDevice")],rw);const ott=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),ltt={standard:.15,spacemouse:.025,unknown:0},xU=rw;let vS=class extends et{constructor(...e){super(...e),this.devices=new _i,this.enabledFocusMode="document"}};f([y({type:_i.ofType(xU),readOnly:!0})],vS.prototype,"devices",void 0),f([y({type:["document","view","none"]})],vS.prototype,"enabledFocusMode",void 0),vS=f([ge("esri.views.input.gamepad.GamepadSettings")],vS);const ctt=vS;let GR=class extends et{constructor(){super(...arguments),this.gamepad=new ctt}};f([y({readOnly:!0})],GR.prototype,"gamepad",void 0),GR=f([ge("esri.views.input.Input")],GR);const utt=GR;let lv=class extends et{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};f([y({type:Boolean,nonNullable:!0})],lv.prototype,"enabled",void 0),f([y({type:xU})],lv.prototype,"device",void 0),f([y({type:["pan","zoom"],nonNullable:!0})],lv.prototype,"mode",void 0),f([y({type:["forward-down","forward-up"],nonNullable:!0})],lv.prototype,"tiltDirection",void 0),f([y({type:Number,nonNullable:!0})],lv.prototype,"velocityFactor",void 0),lv=f([ge("esri.views.navigation.gamepad.GamepadSettings")],lv);const ade=lv;let R_=class extends et{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new ade,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};f([y({type:Boolean})],R_.prototype,"browserTouchPanEnabled",void 0),f([y({type:ade,nonNullable:!0})],R_.prototype,"gamepad",void 0),f([y({type:Boolean})],R_.prototype,"momentumEnabled",void 0),f([y({type:Boolean})],R_.prototype,"mouseWheelZoomEnabled",void 0),R_=f([ge("esri.views.navigation.Navigation")],R_);const ode=R_;function _It(i,e,t){const n=lde(i),r=e,s=dtt(n,r,t);if(n){const a=jA.deriveUnitFromSR(n,i.spatialReference).heightUnit;if(!t&&a!==n.heightUnit){const o=new Ze("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${a})`,{horizontalUnit:a});return new Ze("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n,error:o})}}if(!htt(i)||s===Sc.Unsupported)return new Ze("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:n});switch(s){case Sc.Units:{const a=(n==null?void 0:n.heightUnit)||"unknown",o=(r==null?void 0:r.heightUnit)||"unknown",l=new Ze("layerview:incompatible-height-unit",`The vertical units of the layer (${a}) must match the vertical units of the scene (${o})`,{layerUnit:a,sceneUnit:o});return new Ze("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:r,error:l})}case Sc.HeightModel:{const a=(n==null?void 0:n.heightModel)||"unknown",o=(r==null?void 0:r.heightModel)||"unknown",l=new Ze("layerview:incompatible-height-model",`The height model of the layer (${a}) must match the height model of the scene (${o})`,{layerHeightModel:a,sceneHeightModel:o});return new Ze("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:r,error:l})}case Sc.CRS:{const a=(n==null?void 0:n.vertCRS)||"unknown",o=(r==null?void 0:r.vertCRS)||"unknown",l=new Ze("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${a}) must match the vertical datum of the scene (${o})`,{layerDatum:a,sceneDatum:o});return new Ze("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:n,sceneHeightModelInfo:r,error:l})}}return null}function dtt(i,e,t){if(!GY(i)||!GY(e))return Sc.Unsupported;if(i==null||e==null)return Sc.Ok;if(!t&&i.heightUnit!==e.heightUnit)return Sc.Units;if(i.heightModel!==e.heightModel)return Sc.HeightModel;switch(i.heightModel){case"gravity-related-height":return Sc.Ok;case"ellipsoidal":return i.vertCRS===e.vertCRS?Sc.Ok:Sc.CRS;default:return Sc.Unsupported}}var Sc;function GY(i){return i==null||i.heightModel!=null&&i.heightUnit!=null}function htt(i){return"heightModelInfo"in i&&i.heightModelInfo!=null||i.spatialReference!=null||!dde(i)}function lde(i){var n;const e=i.url?tR(i.url):void 0;return!(((n=i.spatialReference)==null?void 0:n.vcsWkid)==null&&T(e)&&e.serverType==="ImageServer")&&cde(i)&&i.heightModelInfo?i.heightModelInfo:dde(i)?jA.deriveUnitFromSR(ftt,i.spatialReference):null}function cde(i){return"heightModelInfo"in i}function ude(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function dde(i){return ude(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):hde(i)}function ptt(i){return i.layers!=null||hde(i)||ude(i)||cde(i)}function hde(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(Sc||(Sc={}));const ftt=new jA({heightModel:"gravity-related-height"});let YV,eF=null;async function mtt(i){eF||(eF=Ee(()=>Promise.resolve().then(()=>Ymt),void 0,import.meta.url).then(e=>YV=e)),await eF,Cn(i)}async function pde(i,e,t,n){if(!i)return null;const r=i.spatialReference;return Y0()||$y(r,e)?Bc(i,e):YV?YV.projectGeometry(i,e,t,n):(await Promise.race([mtt(n),MC(n)]),pde(i,e,t,n))}let ar=class extends et{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=ll(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return T(this.userSpatialReference)?this.userSpatialReference:kt(this._spatialReferenceTask.spatialReference)}get extent(){return kt(this._extentTask.extent)}get heightModelInfo(){return kt(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return kt(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return kt(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return B(this.userSpatialReference)||this.userSpatialReference.equals(kt(this._spatialReferenceTask.spatialReference))?kt(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return kt(this._tileInfoTask.tileInfo)}get mapCollections(){var n,r,s,a;const e=(n=this.map)==null?void 0:n.call(this),t=[];return T(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(r=e==null?void 0:e.basemap)==null?void 0:r.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(s=e==null?void 0:e.ground)==null?void 0:s.layers},{parent:e==null?void 0:e.basemap,layers:(a=e==null?void 0:e.basemap)==null?void 0:a.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let n=null;for(const s of e){const a=this._getSupportedSpatialReferences(s);if(a.length>0){const o=this._narrowDownSpatialReferenceCandidates(n,a);T(o)&&(n=o)}if(T(n)&&n.length===1)break}if(t&&(B(n)||n.length!==1))return{updating:!0};const r=this._pickSpatialReferenceCandidate(n);return{spatialReference:T(r)?r.spatialReference:null,viewingMode:T(r)?r.viewingMode:null,updating:!1}}get _tileInfoTask(){var n,r,s,a,o,l,c;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(r=(n=this.map)==null?void 0:n.call(this))==null?void 0:r.basemap,layers:(o=(a=(s=this.map)==null?void 0:s.call(this))==null?void 0:a.basemap)==null?void 0:o.baseLayers},{layers:(c=(l=this.map)==null?void 0:l.call(this))==null?void 0:c.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const u=e[0].tileInfo;return{tileInfo:u&&u.spatialReference.equals(this.spatialReference)?u:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var n,r,s;if(!this.required.heightModelInfo||this.suspended&&((n=this._get("_heightModelInfoTask"))!=null&&n.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const a of e)if(ptt(a)){const o=lde(a);if(o)return{heightModelInfo:o,vcsWkid:(r=a.spatialReference)==null?void 0:r.vcsWkid,latestVcsWkid:(s=a.spatialReference)==null?void 0:s.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,n=[];for(const r of e.layers){const s="fullExtents"in r&&r.fullExtents||(T(r.fullExtent)?[r.fullExtent]:[]),a=this.requiresExtentInSpatialReference?null:s[0],o=s.find(l=>l.spatialReference.equals(this.spatialReference))??a;if(o)return{candidates:[{extent:o,layer:r}],updating:!1};if(this._getSupportedSpatialReferences(r).length>0)for(const l of s)n.push({extent:l,layer:r})}return{candidates:n,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(B(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const n=this._pickExtentCandidate(e),r=this.spatialReference;return n.extent.equals(this._projectExtentTask.input)&&r.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:T(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(T(this._projectExtentTask.task)&&(this._projectExtentTask.task=ll(this._projectExtentTask.task)),this._projectExtentTask={input:n.extent.clone(),output:null,spatialReference:r.clone(),task:WA(async s=>{try{const a=await pde(n.extent,r,n.layer.portalItem,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:a}}catch{if(bu(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(B(e))return t;const n=[],r=(s,a)=>T(s)?T(a)?s===a&&s:s:a;for(const s of e)for(const a of t){if(!s.spatialReference.equals(a.spatialReference))continue;const o=r(s.viewingMode,a.viewingMode);if(o!==!1){n.push({spatialReference:s.spatialReference,viewingMode:o});break}}return n.length>0?n:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return B(e)||e.length<1?T(t)?{spatialReference:t,viewingMode:null}:null:(T(t)&&e.length>1&&e.some(({spatialReference:n})=>n.equals(t))&&(e=e.filter(({spatialReference:n})=>n.equals(t))),e.length>1&&e.some(({viewingMode:n})=>n!==Ot.Local)&&(e=e.filter(({viewingMode:n})=>n!==Ot.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const n=[];for(const r of t){const s=this.getSpatialReferenceSupport({spatialReference:r,layer:e});if(T(s)){const a=T(s.constraints)?s.constraints:[{spatialReference:r,viewingMode:null}];for(const{spatialReference:o,viewingMode:l}of a)(!this.requiresExtentInSpatialReference||B(this.userSpatialReference)||o.equals(this.userSpatialReference))&&n.push({spatialReference:o,viewingMode:l})}}return n}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:n})=>t.equals(n.spatialReference))||e[0]}_collectLayers(e){var n;if(this._loadMaybe((n=this.map)==null?void 0:n.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const r of e)if(this._collectCollection(r,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const n of e.layers){switch(this._loadMaybe(n)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(n),"layers"in n&&this._collectCollection({layers:n.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};f([y()],ar.prototype,"required",void 0),f([y({constructOnly:!0})],ar.prototype,"map",void 0),f([y({constructOnly:!0})],ar.prototype,"getSpatialReferenceSupport",void 0),f([y()],ar.prototype,"defaultSpatialReference",void 0),f([y()],ar.prototype,"userSpatialReference",void 0),f([y()],ar.prototype,"sourcePreloadCount",void 0),f([y()],ar.prototype,"priorityCollection",void 0),f([y()],ar.prototype,"requiresExtentInSpatialReference",void 0),f([y()],ar.prototype,"suspended",void 0),f([y({readOnly:!0})],ar.prototype,"ready",null),f([y({readOnly:!0})],ar.prototype,"heightModelInfoReady",null),f([y({readOnly:!0})],ar.prototype,"spatialReference",null),f([y({readOnly:!0})],ar.prototype,"extent",null),f([y({readOnly:!0})],ar.prototype,"heightModelInfo",null),f([y({readOnly:!0})],ar.prototype,"vcsWkid",null),f([y({readOnly:!0})],ar.prototype,"latestVcsWkid",null),f([y({readOnly:!0})],ar.prototype,"viewingMode",null),f([y({readOnly:!0})],ar.prototype,"tileInfo",null),f([y({readOnly:!0})],ar.prototype,"mapCollections",null),f([y({readOnly:!0})],ar.prototype,"_allLayers",null),f([y({readOnly:!0})],ar.prototype,"_spatialReferenceTask",null),f([y({readOnly:!0})],ar.prototype,"_tileInfoTask",null),f([y({readOnly:!0})],ar.prototype,"_heightModelInfoTask",null),f([y({readOnly:!0})],ar.prototype,"_extentCandidatesTask",null),f([y()],ar.prototype,"_extentTask",null),f([y()],ar.prototype,"_projectExtentTask",void 0),ar=f([ge("esri.views.support.DefaultsFromMap")],ar);var WR;let gi=WR=class extends Ba(Pn.EventedMixin(bB(et))){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new t2({getCollections:()=>{var e,t,n;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new Kie,this.analyses=new mC,this.typeSpecificPreconditionsReady=!0,this.layerViews=new _i,this.magnifier=new tde,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new utt,this.navigation=new ode,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new ttt(this),this.persistableViewModels=new _i,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(ue(()=>this.preconditionsReady,e=>{var t,n;e?(this._currentSpatialReference=this.spatialReference,WR.views.add(this)):(this._currentSpatialReference=null,WR.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((t=this.toolViewManager)==null||t.detach(),T(this.analysisViewManager)&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown()):e&&!this.ready&&(this._startup(),T(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},on))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,$u(()=>this.ready)))),this.basemapView=new ov({view:this}),this.layerViewManager=new Jet({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new att({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([ue(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},{sync:!0,initial:!0}),ue(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},{sync:!0}),ue(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let i=null;this.handles.add([ue(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var n;const t=((n=this.map)==null?void 0:n.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(T(i))return;const r=bh(()=>i=ll(i));i=WA(async s=>{try{await Fx(this.spatialReferenceWarningDelay,null,s)}catch{return}finally{i=null}tt.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(r,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=_t(this.graphics),this.analyses=_t(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),_t(this.analysisViewManager),this.toolViewManager=_t(this.toolViewManager),this.layerViewManager=_t(this.layerViewManager),this.basemapView=_t(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const i=this.map;this.map=null,i==null||i.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return tt.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new ar({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||q0.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(tt.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:i}),i=null),q0.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;let i=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)&&(i=i.clone(),i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),i}set spatialReference(i){const e=!Vc(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){const i=this.toolViewManager?this.toolViewManager.cursor:null;return T(i)?i:this._cursor||"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(i){return this.layerViewManager.whenLayerView(i)}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}importLayerView(i){throw new Ze("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return T(this.getSpatialReferenceSupport({spatialReference:i}))}when(i,e){return this.isResolved()&&!this.ready&&tt.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(rs(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};gi.views=new _i,f([y()],gi.prototype,"_userSpatialReference",void 0),f([y()],gi.prototype,"activeTool",null),f([y({readOnly:!0})],gi.prototype,"allLayerViews",void 0),f([y()],gi.prototype,"groundView",void 0),f([y()],gi.prototype,"animation",null),f([y()],gi.prototype,"basemapView",void 0),f([y({readOnly:!0})],gi.prototype,"_defaultsFromMapSettings",null),f([y()],gi.prototype,"defaultsFromMap",null),f([y()],gi.prototype,"fatalError",void 0),f([y({type:fs})],gi.prototype,"extent",null),f([y(BN(Kie,"graphics"))],gi.prototype,"graphics",void 0),f([y(BN(mC,"analyses"))],gi.prototype,"analyses",void 0),f([y({readOnly:!0,type:jA})],gi.prototype,"heightModelInfo",null),f([y({readOnly:!0})],gi.prototype,"interacting",null),f([y({readOnly:!0})],gi.prototype,"navigating",null),f([y({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],gi.prototype,"preconditionsReady",null),f([y({readOnly:!0})],gi.prototype,"typeSpecificPreconditionsReady",void 0),f([y({type:_i,readOnly:!0})],gi.prototype,"layerViews",void 0),f([y({type:tde})],gi.prototype,"magnifier",void 0),f([y({value:null,type:due})],gi.prototype,"map",null),f([y()],gi.prototype,"padding",void 0),f([y({readOnly:!0})],gi.prototype,"ready",void 0),f([y({type:$n})],gi.prototype,"spatialReference",null),f([y()],gi.prototype,"spatialReferenceWarningDelay",void 0),f([y()],gi.prototype,"stationary",null),f([y({readOnly:!0})],gi.prototype,"supportsGround",void 0),f([y({type:Y_e})],gi.prototype,"timeExtent",void 0),f([y()],gi.prototype,"tools",null),f([y()],gi.prototype,"toolViewManager",void 0),f([y({readOnly:!0})],gi.prototype,"type",void 0),f([y({type:Number})],gi.prototype,"scale",void 0),f([y({readOnly:!0})],gi.prototype,"updating",void 0),f([y({readOnly:!0})],gi.prototype,"initialExtentRequired",void 0),f([y({readOnly:!0})],gi.prototype,"initialExtent",null),f([y()],gi.prototype,"cursor",null),f([y({readOnly:!0})],gi.prototype,"input",void 0),f([y({type:ode,nonNullable:!0})],gi.prototype,"navigation",void 0),f([y()],gi.prototype,"layerViewManager",void 0),f([y()],gi.prototype,"analysisViewManager",void 0),f([y()],gi.prototype,"width",void 0),f([y()],gi.prototype,"height",void 0),f([y({readOnly:!0})],gi.prototype,"resizing",void 0),f([y({value:null,readOnly:!0})],gi.prototype,"size",null),f([y({readOnly:!0})],gi.prototype,"suspended",void 0),f([y({readOnly:!0})],gi.prototype,"viewEvents",void 0),f([y({readOnly:!0})],gi.prototype,"persistableViewModels",void 0),f([y()],gi.prototype,"_isValid",void 0),f([y()],gi.prototype,"_readyCycleForced",void 0),f([y()],gi.prototype,"_currentSpatialReference",void 0),gi=WR=f([ge("esri.views.View")],gi);const fde=gi;let cv=class extends X_e{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new Ze("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=BA(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};f([y({readOnly:!0})],cv.prototype,"done",null),f([y({readOnly:!0,type:String})],cv.prototype,"state",void 0),f([y()],cv.prototype,"target",void 0),cv=f([ge("esri.views.ViewAnimation")],cv),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(cv||(cv={}));const Qm=cv;function Kp(){return[1,0,0,1,0,0]}function mde(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function gtt(i,e,t,n,r,s){return[i,e,t,n,r,s]}function vtt(i,e){return new Float64Array(i,e,6)}Object.freeze(Object.defineProperty({__proto__:null,create:Kp,clone:mde,fromValues:gtt,createView:vtt},Symbol.toStringTag,{value:"Module"}));const gde=96,vde=39.37,ytt=180/Math.PI;function yde(i){return i.wkid?i:i.spatialReference||$n.WGS84}function CU(i,e){return e.type?Bi(i,e.x,e.y):Zs(i,e)}function _de(i){return rf(i)}function wE(i,e){const t=Math.max(1,e[0]),n=Math.max(1,e[1]);return Math.max(i.width/t,i.height/n)*Att(i.spatialReference)}async function yS(i,e,t,n){let r,s;if(!i||Array.isArray(i)&&!i.length)return null;if(_i.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const o=i.every(u=>"attributes"in u),l=i.some(u=>!u.geometry);let c=i;if(o&&l&&e&&e.allLayerViews){const u=new Map;for(const m of i){const g=m.layer,_=u.get(g)||[],b=m.attributes[g.objectIdField];b!=null&&_.push(b),u.set(g,_)}const d=[];u.forEach((m,g)=>{const _=e.allLayerViews.find(b=>b.layer.id===g.id);if("queryFeatures"in _){const b=g.createQuery();b.objectIds=m,b.returnGeometry=!0,d.push(_.queryFeatures(b))}});const h=await Promise.all(d),p=[];for(const m of h)if(m&&m.features&&m.features.length)for(const g of m.features)T(g.geometry)&&p.push(g.geometry);c=p}for(const u of c)n=await yS(u,e,t,n);return n}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")r=new Wt(i);else if(i instanceof die)r=i;else if("geometry"in i){if(i.geometry)r=i.geometry;else if(i.layer){const o=i.layer,l=e.allLayerViews.find(c=>c.layer.id===o.id);if("queryFeatures"in l){const c=o.createQuery();c.objectIds=[i.attributes[o.objectIdField]],c.returnGeometry=!0;const u=await l.queryFeatures(c);r=ms(u,"features",0,"geometry")}}}if(B(r)||(s=r.type==="point"?new fs({xmin:r.x,ymin:r.y,xmax:r.x,ymax:r.y,spatialReference:r.spatialReference}):r.extent,!s))return null;Y0()||$y(s.spatialReference,t)||await MC();const a=Bc(s,t);return a?n=n?n.union(a):a:null}function _tt(i){if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&i.layer&&i.layer.minScale&&i.layer.maxScale){const e=i.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(i)&&i.length&&i.every(e=>"layer"in e)){let e=0,t=0;for(const n of i){const r=n.layer;r&&r.minScale&&r.maxScale&&(e=r.minScale<e?r.minScale:e,t=r.maxScale>t?r.maxScale:t)}return e&&t?{min:e,max:t}:null}}}function tF(i,e){return Vc(yde(i),e)?i:Bc(i,e)}async function btt(i,e){if(!i||!e)return new ga({targetGeometry:new Wt,scale:0,rotation:0});let t=e.spatialReference;const{constraints:n,padding:r,viewpoint:s,size:a}=e,o=[r?a[0]-r.left-r.right:a[0],r?a[1]-r.top-r.bottom:a[1]];let l=null;i instanceof ga?l=i:i.viewpoint?l=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(l=i.target);let c=null;l&&l.targetGeometry?c=l.targetGeometry:i instanceof fs?c=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(c=await yS(i.center,e,t)||await yS(i.extent,e,t)||await yS(i.target,e,t)||await yS(i,e,t)),!c&&s&&s.targetGeometry?c=s.targetGeometry:!c&&e.extent&&(c=e.extent),t||(t=yde(e.spatialReference||e.extent||c)),Y0()||Vc(c.spatialReference,t)||$y(c,t)||await MC();const u=tF(c.center?c.center:c,t);let d=null;if(l&&T(l.targetGeometry)&&l.targetGeometry.type==="point")d=l.scale;else if("scale"in i&&i.scale)d=i.scale;else if("zoom"in i&&i.zoom!==-1&&n&&n.effectiveLODs)d=n.zoomToScale(i.zoom);else if(Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0){const g=tF(e.extent,t);d=T(g)?wE(g,o):e.extent?wE(e.extent,o):s.scale}else d=wE(tF(c.extent,t),o);const h=_tt(i);h&&(h.min&&h.min>d?d=h.min:h.max&&h.max<d&&(d=h.max));let p=0;l?p=l.rotation:i.hasOwnProperty("rotation")?p=i.rotation:s&&(p=s.rotation);let m=new ga({targetGeometry:u,scale:d,rotation:p});return n&&(m=n.fit(m),n.constrainByGeometry(m),n.rotationEnabled||(m.rotation=p)),m}function Vh(i,e){const t=i.targetGeometry,n=e.targetGeometry;return t.x=n.x,t.y=n.y,t.spatialReference=n.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function wtt(i,e,t){return t?Bi(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):Po(i,e,.5)}const xtt=function(){const i=xt();return function(e,t,n){const r=t.targetGeometry;CU(i,r);const s=.5*jC(t);return e.xmin=i[0]-s*n[0],e.ymin=i[1]-s*n[1],e.xmax=i[0]+s*n[0],e.ymax=i[1]+s*n[1],e.spatialReference=r.spatialReference,e}}();function Ctt(i,e,t,n,r){return XV(i,e,t.center),i.scale=wE(t,n),r&&r.constraints&&r.constraints.constrain(i),i}function Ttt(i,e,t,n){return EU(i,e,t,n),yB(i,i)}const bde=function(){const i=xt();return function(e,t,n){return TB(e,Mtt(e,t),wtt(i,t,n))}}(),Stt=function(){const i=Kp(),e=xt();return function(t,n,r,s){const a=jC(n),o=TU(n);return Bi(e,a,a),j_e(i,e),GL(i,i,o),o2(i,i,bde(e,r,s)),o2(i,i,[0,s.top-s.bottom]),Bi(t,i[4],i[5])}}();function jC(i){return i.scale*Ett(i.targetGeometry)}function Ett(i){return T(i)&&uie(i.spatialReference)?1/(_de(i.spatialReference)*vde*gde):1}function TU(i){return xB(i.rotation)||0}function Att(i){return uie(i)?_de(i)*vde*gde:1}function Mtt(i,e){return Po(i,e,.5)}const SU=function(){const i=xt(),e=xt(),t=xt();return function(n,r,s,a,o,l){return Xie(i,r),Po(e,s,.5*l),Bi(t,1/a*l,-1/a*l),qie(n,e),o&&GL(n,n,o),vB(n,n,t),o2(n,n,i),n}}(),EU=function(){const i=xt();return function(e,t,n,r){const s=jC(t),a=TU(t);return CU(i,t.targetGeometry),SU(e,i,n,s,a,r)}}(),Ptt=function(){const i=xt();return function(e,t,n,r){const s=jC(t);return CU(i,t.targetGeometry),SU(e,i,n,s,0,r)}}();function Ott(i){const e=aB(i);return e?e.valid[1]-e.valid[0]:0}function Rtt(i,e){return Math.round(Ott(i)/e)}const Itt=function(){const i=xt(),e=xt(),t=[0,0,0];return function(n,r,s){Yn(i,n,r),my(i,i),Yn(e,n,s),my(e,e),Yie(t,i,e);let a=Math.acos(cr(i,e)/(GI(i)*GI(e)))*ytt;return t[2]<0&&(a=-a),isNaN(a)&&(a=0),a}}(),$tt=function(){const i=xt();return function(e,t,n,r){const s=e.targetGeometry;return Vh(e,t),Stt(i,t,n,r),s.x+=i[0],s.y+=i[1],e}}(),XV=function(i,e,t){Vh(i,e);const n=i.targetGeometry;return n.x=t.x,n.y=t.y,n.spatialReference=t.spatialReference,i},Ltt=function(){const i=xt();return function(e,t,n,r,s){s||(s="center"),TB(i,n,r),Po(i,i,.5);const a=i[0],o=i[1];switch(s){case"center":Bi(i,0,0);break;case"left":Bi(i,-a,0);break;case"top":Bi(i,0,o);break;case"right":Bi(i,a,0);break;case"bottom":Bi(i,0,-o);break;case"top-left":Bi(i,-a,o);break;case"bottom-left":Bi(i,-a,-o);break;case"top-right":Bi(i,a,o);break;case"bottom-right":Bi(i,a,-o)}return Z3(e,t,i),e}}();function xIt(i,e,t){return Vh(i,e),i.rotation+=t,i}function Dtt(i,e,t){return Vh(i,e),i.rotation=t,i}const ktt=function(){const i=xt();return function(e,t,n,r,s){return Vh(e,t),isNaN(n)||n===0||(xde(i,r,t,s),e.scale=t.scale*n,Cde(i,i,e,s),Z3(e,e,Bi(i,i[0]-r[0],r[1]-i[1]))),e}}();function WY(i,e,t){return Vh(i,e),i.scale=t,i}const wde=function(){const i=xt();return function(e,t,n,r,s,a){return Vh(e,t),isNaN(n)||n===0||(xde(i,s,t,a),e.scale=t.scale*n,e.rotation+=r,Cde(i,i,e,a),Z3(e,e,Bi(i,i[0]-s[0],s[1]-i[1]))),e}}(),CIt=function(){const i=xt(),e=xt();return function(t,n,r,s,a,o,l){return bde(e,o,l),sd(i,a,e),s?wde(t,n,r,s,i,o):ktt(t,n,r,i,o)}}(),xde=function(){const i=Kp();return function(e,t,n,r){return fm(e,t,Ttt(i,n,r,1))}}(),Cde=function(){const i=Kp();return function(e,t,n,r){return fm(e,t,EU(i,n,r,1))}}(),Z3=function(){const i=xt(),e=Kp();return function(t,n,r){Vh(t,n);const s=jC(n),a=t.targetGeometry;return W_e(e,TU(n)),vB(e,e,dn(s,s)),fm(i,r,e),a.x+=i[0],a.y+=i[1],t}}();let Ftt=class{constructor(e,t,n,r){const s=e.targetGeometry,a=t.targetGeometry;r?typeof r=="string"&&(r=Q_e(r)||zN.ease):r=zN.ease,this.easing=r,this.duration=n,this.sCenterX=s.x,this.sCenterY=s.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=a.x,this.tCenterY=a.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const n=this.easing(t);let r,s,a,o;t>=1?(r=this.tCenterX,s=this.tCenterY,a=this.tRotation,o=this.tScale):(r=this.sCenterX+n*this.dCenterX,s=this.sCenterY+n*this.dCenterY,a=this.sRotation+n*this.dRotation,o=this.sScale+n*this.dScale),e.targetGeometry.x=r,e.targetGeometry.y=s,e.scale=o,e.rotation=a}},Xf=class extends et{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=zN.ease,this.view=null,this.viewpoint=null,this.viewpoint=new ga({targetGeometry:new Wt,scale:0,rotation:0}),this._updateTask=Vm({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,n){this.stop();const r=this.viewpoint;Vh(r,t),this.transition=new Ftt(this.viewpoint,e.target,n&&n.duration||this.duration,n&&n.easing||this.easing);const s=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const n=new Qm({target:e.clone()}),r=()=>{this.animation===n&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return n.when(r,r),this._startTime=performance.now(),this._updateTask.resume(),this.animation=n,n}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==Qm.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const n=(performance.now()-this._startTime)/this.transition.duration,r=n>=1;this.transition.applyRatio(this.viewpoint,n),r&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};f([y()],Xf.prototype,"animation",void 0),f([y()],Xf.prototype,"duration",void 0),f([y()],Xf.prototype,"transition",void 0),f([y()],Xf.prototype,"easing",void 0),f([y()],Xf.prototype,"view",void 0),f([y()],Xf.prototype,"viewpoint",void 0),Xf=f([ge("esri.views.2d.AnimationManager")],Xf);const Ntt=Xf;let Vtt=class{constructor(e){this.view=e,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:t,graphicsView:n,labelManager:r,layerViews:s,state:{id:a}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),s.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),T(r)&&(r.lastUpdateId!==a&&(r.viewChange(),r.lastUpdateId=a),r.updateRequested&&r.processUpdate(this._updateParameters)),T(n)&&(n.lastUpdateId!==a&&(n.viewChange(),n.lastUpdateId=a),n.updateRequested&&n.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=ue(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=Vm(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,n=e.lastUpdateId;n!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),n!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}};function oa(){return Promise.all([Ee(()=>import("./webglDeps-eec0a475.js"),["./webglDeps-eec0a475.js","./FramebufferObject-50e1b68f.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./context-util-1e3c8cfc.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ShaderCompiler-77d0dcb6.js","./programUtils-f035fe8a.js","./ProgramTemplate-afbd57f8.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),Ee(()=>import("./mapViewDeps-dacc67ec.js"),["./mapViewDeps-dacc67ec.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./mat3f32-d3d088e8.js","./Rasterizer-c5722a70.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./_commonjsHelpers-a430e9ea.js","./imageutils-b39249d8.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./cimAnalyzer-721530a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./fontUtils-b94d5e06.js","./screenUtils-410d12c0.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./BidiEngine-836b7ef6.js","./aaBoundingRect-4a760199.js","./jsonUtils-03c4af61.js","./enums-4b2a86a0.js","./utils-c81a5c52.js","./alignmentUtils-ae955d28.js","./definitions-2d0dd0cd.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./number-954e4ab6.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./rasterizingUtils-133923fb.js","./utils-26560131.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./Utils-b2b4cf0c.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./BufferPool-f19f4e1f.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./VTLMaterialManager-2c63b5e3.js","./enums-0fc02184.js","./programUtils-f035fe8a.js","./MaterialPrograms-42724b3b.js","./pbf-e1a6c35b.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./assets-0b172f07.js","./Geometry-daada628.js","./defaultsJSON-59981e75.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./persistableUrlUtils-a16d0f55.js","./styleUtils-4adfed9e.js","./CircularArray-cf56c6b0.js","./MeshComponent-f50df6af.js","./deduplicate-b0bc48cc.js","./HandleOwner-e1406413.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js","./BaseGraphicContainer-aa7dd916.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./zscale-1e1fc911.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./fieldUtils-31bfecd2.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./collectionUtils-3831b7c4.js","./labelUtils-a194a22a.js","./jsonUtils-d7db3dc7.js","./FeatureContainer-f14037ae.js","./TileContainer-07bccb79.js","./capabilities-3636c6a4.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./diffUtils-1ac65748.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./Identifiable-aa6d459d.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./visualVariableUtils-c59ab38d.js","./Graphic-b46e2684.js","./compilerUtils-034cacb8.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./deprecate-b9088bd3.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./GraphicContainer-66edeaa1.js","./asyncUtils-62e8a185.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./dehydratedFeatures-4eeb381a.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)])}const CT=()=>oa().then(()=>Ee(()=>import("./TileLayerView2D-0baf2ee4.js"),["./TileLayerView2D-0baf2ee4.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./imageUtils-8298e401.js","./BitmapTileContainer-6fc690f1.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./mat3f32-d3d088e8.js","./Bitmap-c332c5e6.js","./mat3-3fc68e72.js","./vec2f32-461e65a9.js","./EffectView-d3bf37ed.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Color-a42a8267.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./jsonUtils-03c4af61.js","./Polyline-bf268e7b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./TileContainer-07bccb79.js","./LayerView2D-9c021b91.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./TileStrategy-4189758f.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./TileLayerView-71fcdeb9.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)),TT=()=>oa().then(()=>Ee(()=>import("./FeatureLayerView2D-0577ada3.js"),["./FeatureLayerView2D-0577ada3.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./TimeExtent-744afd75.js","./Query-ff8c2cfb.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./FeatureSet-0573546e.js","./definitions-2d0dd0cd.js","./LayerView2D-9c021b91.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./visualVariablesUtils-496ec144.js","./createSymbolSchema-41fdd7db.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./ExpandedCIM-676cf2ac.js","./rendererUtils-3275688e.js","./capabilities-3636c6a4.js","./util-38c30a14.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./assets-0b172f07.js","./intl-f1e98361.js","./messages-be07754e.js","./FeatureLayerView-dbb9730b.js","./ExportImageParameters-f328a234.js","./HandleOwner-e1406413.js","./sublayerUtils-ba7f61bc.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js"],import.meta.url)),jY={"base-dynamic":()=>oa().then(()=>Ee(()=>import("./BaseDynamicLayerView2D-be389e88.js"),["./BaseDynamicLayerView2D-be389e88.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./BitmapContainer-e31790f9.js","./WGLContainer-14075e1a.js","./mat3f32-d3d088e8.js","./WGLBrushVTLSymbol-dcfd88b4.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Color-a42a8267.js","./heatmapTextureUtils-d1d96768.js","./reactiveUtils-f41a4e00.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./jsonUtils-03c4af61.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./ExportStrategy-94329c70.js","./aaBoundingRect-4a760199.js","./TileInfo-34f80a8e.js","./unitUtils-47abac71.js","./Bitmap-c332c5e6.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js"],import.meta.url)),"base-tile":CT,"bing-maps":CT,csv:TT,"geo-rss":()=>oa().then(()=>Ee(()=>import("./GeoRSSLayerView2D-7973b374.js"),["./GeoRSSLayerView2D-7973b374.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./reactiveUtils-f41a4e00.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./Graphic-b46e2684.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./LayerView2D-9c021b91.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./definitions-2d0dd0cd.js","./GraphicContainer-66edeaa1.js","./BaseGraphicContainer-aa7dd916.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./HandleOwner-e1406413.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./FramebufferObject-50e1b68f.js","./FeatureContainer-f14037ae.js","./Queue-3a0c055d.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./TileContainer-07bccb79.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./StyleDefinition-7d58136b.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./capabilities-3636c6a4.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./Geometry-daada628.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./LayerView-b83ced89.js"],import.meta.url)),feature:TT,geojson:TT,graphics:()=>oa().then(()=>Ee(()=>import("./GraphicsLayerView2D-39b4958c.js"),["./GraphicsLayerView2D-39b4958c.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./LayerView2D-9c021b91.js","./reactiveUtils-f41a4e00.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./definitions-2d0dd0cd.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./GraphicContainer-66edeaa1.js","./BaseGraphicContainer-aa7dd916.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./HandleOwner-e1406413.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./unitUtils-47abac71.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./FramebufferObject-50e1b68f.js","./FeatureContainer-f14037ae.js","./Queue-3a0c055d.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./TileContainer-07bccb79.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./StyleDefinition-7d58136b.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./lengthUtils-d2d33f94.js","./capabilities-3636c6a4.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./Geometry-daada628.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./styleUtils-4adfed9e.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./diffUtils-1ac65748.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./deprecate-b9088bd3.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./LayerView-b83ced89.js"],import.meta.url)),group:()=>oa().then(()=>Ee(()=>import("./GroupLayerView2D-23bc48dc.js"),["./GroupLayerView2D-23bc48dc.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./GroupContainer-3e969041.js","./WGLContainer-14075e1a.js","./mat3f32-d3d088e8.js","./WGLBrushVTLSymbol-dcfd88b4.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Color-a42a8267.js","./heatmapTextureUtils-d1d96768.js","./reactiveUtils-f41a4e00.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./jsonUtils-03c4af61.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./GroupLayerView-e2c80272.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js"],import.meta.url)),imagery:()=>oa().then(()=>Ee(()=>import("./ImageryLayerView2D-a0f08400.js"),["./ImageryLayerView2D-a0f08400.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./GraphicsLayer-10573c27.js","./HandleOwner-e1406413.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ScaleRangeLayer-271178b7.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./RasterVFDisplayObject-96332116.js","./FramebufferObject-50e1b68f.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./VertexElementDescriptor-2925c6af.js","./dataUtils-a4eff43b.js","./pixelUtils-c27b13a1.js","./WGLContainer-14075e1a.js","./mat3f32-d3d088e8.js","./WGLBrushVTLSymbol-dcfd88b4.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./BaseGraphicContainer-aa7dd916.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./FeatureContainer-f14037ae.js","./Queue-3a0c055d.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./TileContainer-07bccb79.js","./capabilities-3636c6a4.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./Geometry-daada628.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./styleUtils-4adfed9e.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./diffUtils-1ac65748.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./deprecate-b9088bd3.js","./OperationalLayer-24e6fa34.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./HighlightGraphicContainer-c5f26b65.js","./BitmapContainer-e31790f9.js","./Bitmap-c332c5e6.js","./ExportStrategy-94329c70.js","./TileInfo-34f80a8e.js","./rasterProjectionHelper-967d22a7.js","./ImageryLayerView-a754e4c1.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js"],import.meta.url)),"imagery-tile":()=>oa().then(()=>Ee(()=>import("./ImageryTileLayerView2D-b7038fda.js"),["./ImageryTileLayerView2D-b7038fda.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./multidimensionalUtils-0cd7c92c.js","./RasterVFDisplayObject-96332116.js","./HandleOwner-e1406413.js","./FramebufferObject-50e1b68f.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./VertexElementDescriptor-2925c6af.js","./dataUtils-a4eff43b.js","./pixelUtils-c27b13a1.js","./WGLContainer-14075e1a.js","./mat3f32-d3d088e8.js","./WGLBrushVTLSymbol-dcfd88b4.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./TileContainer-07bccb79.js","./TileInfo-34f80a8e.js","./unitUtils-47abac71.js","./RawBlockCache-0f6e3c3f.js","./rasterProjectionHelper-967d22a7.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./capabilities-3636c6a4.js","./util-38c30a14.js","./ImageryTileLayerView-283faa2a.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)),kml:()=>oa().then(()=>Ee(()=>import("./KMLLayerView2D-5d37e4c5.js"),["./KMLLayerView2D-5d37e4c5.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./reactiveUtils-f41a4e00.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./projection-d7b57a6c.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./mat4-44a0988f.js","./Polyline-bf268e7b.js","./assets-0b172f07.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./kmlUtils-8fb30744.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./aaBoundingBox-fc742a4e.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./Graphic-b46e2684.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./normalizeUtils-ee4bf39f.js","./GraphicsLayer-10573c27.js","./HandleOwner-e1406413.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ScaleRangeLayer-271178b7.js","./ElevationInfo-ce9cacc2.js","./Bitmap-c332c5e6.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./EffectView-d3bf37ed.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./BitmapContainer-e31790f9.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./GraphicContainer-66edeaa1.js","./BaseGraphicContainer-aa7dd916.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./normalizeUtilsSync-9c84b89e.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./FeatureContainer-f14037ae.js","./Queue-3a0c055d.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./TileContainer-07bccb79.js","./capabilities-3636c6a4.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./Geometry-daada628.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./LayerView-b83ced89.js","./rasterProjectionHelper-967d22a7.js","./MaterialPrograms-42724b3b.js","./programUtils-f035fe8a.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./Scheduler-8433672d.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./dehydratedFeatures-4eeb381a.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)),"map-image":()=>oa().then(()=>Ee(()=>import("./MapImageLayerView2D-9045df92.js"),["./MapImageLayerView2D-9045df92.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./BitmapContainer-e31790f9.js","./WGLContainer-14075e1a.js","./mat3f32-d3d088e8.js","./WGLBrushVTLSymbol-dcfd88b4.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./BaseGraphicContainer-aa7dd916.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./HandleOwner-e1406413.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./unitUtils-47abac71.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./FeatureContainer-f14037ae.js","./Queue-3a0c055d.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./TileContainer-07bccb79.js","./lengthUtils-d2d33f94.js","./capabilities-3636c6a4.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./Geometry-daada628.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./styleUtils-4adfed9e.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./diffUtils-1ac65748.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./deprecate-b9088bd3.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./HighlightGraphicContainer-c5f26b65.js","./ExportStrategy-94329c70.js","./TileInfo-34f80a8e.js","./Bitmap-c332c5e6.js","./LayerView-b83ced89.js","./MapImageLayerView-d2265098.js","./scaleUtils-b32a50d8.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./ScaleRangeLayer-271178b7.js","./popupUtils-e8f3d062.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./Scheduler-8433672d.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./dehydratedFeatures-4eeb381a.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)),"map-notes":()=>oa().then(()=>Ee(()=>import("./MapNotesLayerView2D-ce305c09.js"),["./MapNotesLayerView2D-ce305c09.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./definitions-2d0dd0cd.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./GroupContainer-3e969041.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./GraphicContainer-66edeaa1.js","./BaseGraphicContainer-aa7dd916.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./HandleOwner-e1406413.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./unitUtils-47abac71.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./FeatureContainer-f14037ae.js","./Queue-3a0c055d.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./TileContainer-07bccb79.js","./lengthUtils-d2d33f94.js","./capabilities-3636c6a4.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./Geometry-daada628.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./styleUtils-4adfed9e.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./diffUtils-1ac65748.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./deprecate-b9088bd3.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./LayerView-b83ced89.js"],import.meta.url)),media:()=>oa().then(()=>Ee(()=>import("./MediaLayerView2D-cee17627.js"),["./MediaLayerView2D-cee17627.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./reactiveUtils-f41a4e00.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./mediaUtils-d2f5e3a2.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./assets-0b172f07.js","./request-d3e98716.js","./zscale-1e1fc911.js","./normalizeUtilsSync-9c84b89e.js","./jsonUtils-03c4af61.js","./normalizeUtils-ee4bf39f.js","./TileStrategy-4189758f.js","./vec2-2cef68de.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./mat3-3fc68e72.js","./mat3f64-c6305894.js","./vec2f64-30dc1443.js","./EffectView-d3bf37ed.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./FramebufferObject-50e1b68f.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./vec3f32-c9aa289f.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Color-a42a8267.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./collectionUtils-3831b7c4.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)),"ogc-feature":()=>oa().then(()=>Ee(()=>import("./OGCFeatureLayerView2D-3f591834.js"),["./OGCFeatureLayerView2D-3f591834.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./FeatureLayerView2D-0577ada3.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./TimeExtent-744afd75.js","./Query-ff8c2cfb.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./FeatureSet-0573546e.js","./definitions-2d0dd0cd.js","./LayerView2D-9c021b91.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./visualVariablesUtils-496ec144.js","./createSymbolSchema-41fdd7db.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./ExpandedCIM-676cf2ac.js","./rendererUtils-3275688e.js","./capabilities-3636c6a4.js","./util-38c30a14.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./assets-0b172f07.js","./intl-f1e98361.js","./messages-be07754e.js","./FeatureLayerView-dbb9730b.js","./ExportImageParameters-f328a234.js","./HandleOwner-e1406413.js","./sublayerUtils-ba7f61bc.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./OGCFeatureLayerView-848f8dcf.js"],import.meta.url)),"open-street-map":CT,"oriented-imagery":TT,route:()=>oa().then(()=>Ee(()=>import("./RouteLayerView2D-5a4ed32c.js"),["./RouteLayerView2D-5a4ed32c.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./CollectionFlattener-3dd1f479.js","./reactiveUtils-f41a4e00.js","./Stop-ac044e9e.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./LayerView2D-9c021b91.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./definitions-2d0dd0cd.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./GraphicContainer-66edeaa1.js","./BaseGraphicContainer-aa7dd916.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./HandleOwner-e1406413.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./unitUtils-47abac71.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./FramebufferObject-50e1b68f.js","./FeatureContainer-f14037ae.js","./Queue-3a0c055d.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./TileContainer-07bccb79.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./StyleDefinition-7d58136b.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./lengthUtils-d2d33f94.js","./capabilities-3636c6a4.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./Geometry-daada628.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./styleUtils-4adfed9e.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./diffUtils-1ac65748.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./deprecate-b9088bd3.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./LayerView-b83ced89.js"],import.meta.url)),stream:()=>oa().then(()=>Ee(()=>import("./StreamLayerView2D-9d9617c0.js"),["./StreamLayerView2D-9d9617c0.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./FeatureSet-0573546e.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./FeatureLayerView2D-0577ada3.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./TimeExtent-744afd75.js","./Query-ff8c2cfb.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./definitions-2d0dd0cd.js","./LayerView2D-9c021b91.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./visualVariablesUtils-496ec144.js","./createSymbolSchema-41fdd7db.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./ExpandedCIM-676cf2ac.js","./rendererUtils-3275688e.js","./capabilities-3636c6a4.js","./util-38c30a14.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./assets-0b172f07.js","./intl-f1e98361.js","./messages-be07754e.js","./FeatureLayerView-dbb9730b.js","./ExportImageParameters-f328a234.js","./HandleOwner-e1406413.js","./sublayerUtils-ba7f61bc.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js"],import.meta.url)),"subtype-group":()=>oa().then(()=>Ee(()=>import("./SubtypeGroupLayerView2D-11a9b305.js"),["./SubtypeGroupLayerView2D-11a9b305.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./TimeExtent-744afd75.js","./Query-ff8c2cfb.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./PopupTemplate-6eb885db.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./UniqueValueRenderer-103ec66d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec4-790471c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./Graphic-b46e2684.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./FeatureLayerView2D-0577ada3.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./FeatureSet-0573546e.js","./definitions-2d0dd0cd.js","./LayerView2D-9c021b91.js","./utils-26560131.js","./mat3f32-d3d088e8.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./Utils-b2b4cf0c.js","./number-954e4ab6.js","./enums-4b2a86a0.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./visualVariablesUtils-496ec144.js","./createSymbolSchema-41fdd7db.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./BidiEngine-836b7ef6.js","./utils-c81a5c52.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./ExpandedCIM-676cf2ac.js","./rendererUtils-3275688e.js","./capabilities-3636c6a4.js","./util-38c30a14.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./assets-0b172f07.js","./intl-f1e98361.js","./messages-be07754e.js","./FeatureLayerView-dbb9730b.js","./ExportImageParameters-f328a234.js","./HandleOwner-e1406413.js","./sublayerUtils-ba7f61bc.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js"],import.meta.url)),tile:CT,"vector-tile":()=>oa().then(()=>Ee(()=>import("./VectorTileLayerView2D-8ccacd1c.js"),["./VectorTileLayerView2D-8ccacd1c.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./diffUtils-1ac65748.js","./enums-0fc02184.js","./TileInfoViewPOT-de1d9d50.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./assets-0b172f07.js","./intl-f1e98361.js","./messages-be07754e.js","./Rect-ea14f53a.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./pbf-e1a6c35b.js","./rasterizingUtils-133923fb.js","./floatRGBA-fa8308d2.js","./TileKey-0750ad58.js","./mat3f32-d3d088e8.js","./config-1337d16e.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./TileInfo-34f80a8e.js","./unitUtils-47abac71.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./enums-4ca4641f.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./vec2f64-30dc1443.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./TileContainer-07bccb79.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./definitions-2d0dd0cd.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./vec2f32-461e65a9.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./StyleRepository-14d163c2.js","./colorUtils-82440b70.js","./GeometryUtils-eebff0a0.js","./Geometry-daada628.js","./LayerView2D-9c021b91.js","./TileStrategy-4189758f.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)),wcs:()=>oa().then(()=>Ee(()=>import("./ImageryTileLayerView2D-b7038fda.js"),["./ImageryTileLayerView2D-b7038fda.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./multidimensionalUtils-0cd7c92c.js","./RasterVFDisplayObject-96332116.js","./HandleOwner-e1406413.js","./FramebufferObject-50e1b68f.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./VertexElementDescriptor-2925c6af.js","./dataUtils-a4eff43b.js","./pixelUtils-c27b13a1.js","./WGLContainer-14075e1a.js","./mat3f32-d3d088e8.js","./WGLBrushVTLSymbol-dcfd88b4.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./TileContainer-07bccb79.js","./TileInfo-34f80a8e.js","./unitUtils-47abac71.js","./RawBlockCache-0f6e3c3f.js","./rasterProjectionHelper-967d22a7.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./capabilities-3636c6a4.js","./util-38c30a14.js","./ImageryTileLayerView-283faa2a.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)),"web-tile":CT,wfs:TT,wms:()=>oa().then(()=>Ee(()=>import("./WMSLayerView2D-be32ab7c.js"),["./WMSLayerView2D-be32ab7c.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./BitmapContainer-e31790f9.js","./WGLContainer-14075e1a.js","./mat3f32-d3d088e8.js","./WGLBrushVTLSymbol-dcfd88b4.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./vec2f32-461e65a9.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Color-a42a8267.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./jsonUtils-03c4af61.js","./Polyline-bf268e7b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./LayerView2D-9c021b91.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./ExportStrategy-94329c70.js","./aaBoundingRect-4a760199.js","./TileInfo-34f80a8e.js","./unitUtils-47abac71.js","./Bitmap-c332c5e6.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./WMSLayerView-90570b56.js","./OperationalLayer-24e6fa34.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./persistableUrlUtils-a16d0f55.js","./ElevationInfo-ce9cacc2.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./lengthUtils-d2d33f94.js","./opacityUtils-243aae26.js","./ExportWMSImageParameters-3c811106.js"],import.meta.url)),wmts:()=>oa().then(()=>Ee(()=>import("./WMTSLayerView2D-6eb38951.js"),["./WMTSLayerView2D-6eb38951.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./imageUtils-8298e401.js","./BitmapTileContainer-6fc690f1.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./mat3f32-d3d088e8.js","./Bitmap-c332c5e6.js","./mat3-3fc68e72.js","./vec2f32-461e65a9.js","./EffectView-d3bf37ed.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./Utils-b2b4cf0c.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./MaterialKey-406a59ab.js","./alignmentUtils-ae955d28.js","./utils-26560131.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Color-a42a8267.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./vec2-2cef68de.js","./featureConversionUtils-01cdde8a.js","./jsonUtils-03c4af61.js","./Polyline-bf268e7b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./TileContainer-07bccb79.js","./LayerView2D-9c021b91.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./TileStrategy-4189758f.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js"],import.meta.url)),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Btt(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Ze(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const qY={hasLayerViewModule:i=>T(jY[i.type]),importLayerView:i=>{const e=jY[i.type];if(B(e))throw Btt(i);return e(i)}};function ztt(i,e){const{spatialReference:t}=e,n=[e.x,e.y];let r=Number.POSITIVE_INFINITY,s=0,a=0;const o=[0,0],l=i.type==="extent"?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:i.rings;for(const c of l)for(let u=0;u<c.length-1;u++){F_e(o,n,c,u);const d=sf(n,o);d<r&&(r=d,s=o[0],a=o[1])}return{coordinate:new Wt({x:s,y:a,spatialReference:t}),distance:r}}var ZV;let o0=ZV=class extends fB(et){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(B(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Bc(this.geometry,this.spatialReference)}catch(i){return tt.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if(B(this.normalizedGeometry))return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?hie(this.normalizedGeometry,t):vye(this.normalizedGeometry,t))return i;const{coordinate:n}=ztt(this.normalizedGeometry,t);return n&&(i.targetGeometry=n),i}clone(){var i,e;return new ZV({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};f([y({constructOnly:!0})],o0.prototype,"geometry",void 0),f([y({readOnly:!0})],o0.prototype,"normalizedGeometry",null),f([y({constructOnly:!0})],o0.prototype,"spatialReference",void 0),o0=ZV=f([ge("esri.views.2d.constraints.GeometryConstraint")],o0);var QV;let _S=QV=class extends fB(et){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new QV({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};f([y()],_S.prototype,"enabled",void 0),f([y()],_S.prototype,"rotationEnabled",void 0),_S=QV=f([ge("esri.views.2d.constraints.RotationConstraint")],_S);const Tde=_S;var JV;let mc=JV=class extends fB(et){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:n,minZoom:r,maxZoom:s}=this,a=-1,o=-1,l=!1,c=!1;if(t!==0&&n!==0&&t<n&&([t,n]=[n,t]),!e||!e.length)return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",n);e=e.map(u=>u.clone()),e.sort((u,d)=>d.scale-u.scale),e.forEach((u,d)=>u.level=d);for(const u of e)!l&&t>0&&t>=u.scale&&(a=u.level,l=!0),!c&&n>0&&n>=u.scale&&(o=i?i.level:-1,c=!0),i=u;r===-1&&(r=t===0?0:a),s===-1&&(s=n===0?e.length-1:o),r=Math.max(r,0),r=Math.min(r,e.length-1),s=Math.max(s,0),s=Math.min(s,e.length-1),r>s&&([r,s]=[s,r]),t=e[r].scale,n=e[s].scale,e.splice(0,r),e.splice(s-r+1,e.length),e.forEach((u,d)=>{this._lodByScale[u.scale]=u,this._scales[d]=u.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",r),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",n)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,n=this.effectiveMaxScale,r=i.targetGeometry,s=e&&e.targetGeometry,a=n!==0&&i.scale<n,o=t!==0&&i.scale>t;if(a||o){const l=o?t:n;if(e&&s){const c=(l-e.scale)/(i.scale-e.scale);r.x=s.x+(r.x-s.x)*c,r.y=s.y+(r.y-s.y)*c}i.scale=l}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.round(i-.5),n=Math.round(i);return e[n]+(n-i)*(e[t]-e[n])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,n;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let r=0;r<e.length-1;r++){if(t=e[r],n=e[r+1],n===i)return r+this.effectiveMinZoom+1;if(t>i&&n<i)return r+this.effectiveMinZoom+1-(i-n)/(t-n)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new JV({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};f([y({readOnly:!0})],mc.prototype,"effectiveLODs",void 0),f([y({readOnly:!0})],mc.prototype,"effectiveMinZoom",void 0),f([y({readOnly:!0})],mc.prototype,"effectiveMaxZoom",void 0),f([y({readOnly:!0})],mc.prototype,"effectiveMinScale",void 0),f([y({readOnly:!0})],mc.prototype,"effectiveMaxScale",void 0),f([y()],mc.prototype,"lods",void 0),f([y()],mc.prototype,"minZoom",void 0),f([y()],mc.prototype,"maxZoom",void 0),f([y()],mc.prototype,"minScale",void 0),f([y()],mc.prototype,"maxScale",void 0),f([y()],mc.prototype,"snapToZoom",void 0),mc=JV=f([ge("esri.views.2d.constraints.ZoomConstraint")],mc);const Sde=mc,Utt={base:null,key:"type",typeMap:{extent:fs,polygon:Om}};let Ms=class extends et{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,n;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(n=this._geometry)==null?void 0:n.uid}`}get _defaultLODs(){var n,r,s;const e=(r=(n=this.view)==null?void 0:n.defaultsFromMap)==null?void 0:r.tileInfo,t=(s=this.view)==null?void 0:s.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new o0({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new Tde({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,n=this.minZoom,r=this.maxZoom,s=this.minScale,a=this.maxScale,o=this.snapToZoom;return e&&e.lods===t&&e.minZoom===n&&e.maxZoom===r&&e.minScale===s&&e.maxScale===a&&e.snapToZoom===o?e:new Sde({lods:t,minZoom:n,maxZoom:r,minScale:s,maxScale:a,snapToZoom:o})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};f([y({readOnly:!0})],Ms.prototype,"effectiveLODs",null),f([y({readOnly:!0})],Ms.prototype,"effectiveMinScale",null),f([y({readOnly:!0})],Ms.prototype,"effectiveMaxScale",null),f([y({readOnly:!0})],Ms.prototype,"effectiveMinZoom",null),f([y({readOnly:!0})],Ms.prototype,"effectiveMaxZoom",null),f([y({types:Utt,value:null})],Ms.prototype,"geometry",null),f([y({type:[Yye]})],Ms.prototype,"lods",void 0),f([y()],Ms.prototype,"minScale",void 0),f([y()],Ms.prototype,"maxScale",void 0),f([y()],Ms.prototype,"minZoom",void 0),f([y()],Ms.prototype,"maxZoom",void 0),f([y()],Ms.prototype,"rotationEnabled",void 0),f([y()],Ms.prototype,"snapToZoom",void 0),f([y()],Ms.prototype,"view",void 0),f([y({readOnly:!0})],Ms.prototype,"version",null),f([y()],Ms.prototype,"_defaultLODs",null),f([y({type:o0})],Ms.prototype,"_geometry",null),f([y({type:Tde})],Ms.prototype,"_rotation",null),f([y({readOnly:!0,type:Sde})],Ms.prototype,"_zoom",null),Ms=f([ge("esri.views.2d.MapViewConstraints")],Ms);const Ede=Ms;function Htt(i){return i instanceof Float32Array&&i.length>=2}function Gtt(i){return Array.isArray(i)&&i.length>=2}function iF(i){return Htt(i)||Gtt(i)}var e6;const Of=[0,0];let uv=e6=class extends Wo{constructor(i){super(i),this._viewpoint2D={center:xt(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new fs,this.id=0,this.inverseTransform=Kp(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Kp(),this.transformNoRotation=Kp(),this.displayMat3=ny(),this.displayViewMat3=ny(),this.viewMat3=ny(),this.viewMat2d=VN(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=Vh(t,i.viewpoint),this._set("size",Zs(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new e6({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return iF(e)?fm(i,e,this.inverseTransform):(Of[0]=e,Of[1]=t,fm(i,Of,this.inverseTransform))}toScreen(i,e,t){return iF(e)?fm(i,e,this.transform):(Of[0]=e,Of[1]=t,fm(i,Of,this.transform))}toScreenNoRotation(i,e,t){return iF(e)?fm(i,e,this.transformNoRotation):(Of[0]=e,Of[1]=t,fm(i,Of,this.transformNoRotation))}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,n=this._get("pixelRatio")||1,r=this._get("size");return SU(i,t,r,e,0,n),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:n}=this._viewpoint2D,r=this._get("pixelRatio")||1,s=this._get("size"),a=new ga({targetGeometry:new Wt(i[0],i[1],e),scale:t,rotation:n});if(this._set("viewpoint",a),!s||!e||!t)return;this.resolution=jC(a),this.rotation=n,this.scale=t,this.spatialReference=e,Zs(this.center,i);const o=s[0]!==0?2/s[0]:0,l=s[1]!==0?-2/s[1]:0;i0e(this.displayMat3,o,0,0,0,l,0,-1,1,1);const c=Qie(this.viewMat3),u=Rv(s[0]/2,s[1]/2),d=Rv(-s[0]/2,-s[1]/2),h=xB(n);UN(c,c,u),Jie(c,c,h),UN(c,c,d),n0e(this.displayViewMat3,this.displayMat3,c);const p=qie(this.viewMat2d,u);return GL(p,p,h),o2(p,p,d),xtt(this.extent,a,s),EU(this.transform,a,s,r),yB(this.inverseTransform,this.transform),Ptt(this.transformNoRotation,a,s,r),this.worldScreenWidth=Rtt(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};f([y({readOnly:!0})],uv.prototype,"id",void 0),f([y({value:1,json:{write:!0}})],uv.prototype,"pixelRatio",null),f([y({json:{write:!0}})],uv.prototype,"size",null),f([y()],uv.prototype,"spatialReference",void 0),f([y({type:ga,json:{write:!0}})],uv.prototype,"viewpoint",null),uv=e6=f([ge("esri.views.2d.ViewState")],uv);const t6=uv;var i6,n6;let gm=i6=class extends et{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new i6({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};f([y()],gm.prototype,"left",void 0),f([y()],gm.prototype,"top",void 0),f([y()],gm.prototype,"right",void 0),f([y()],gm.prototype,"bottom",void 0),gm=i6=f([ge("esri.views.2d.PaddedViewState.Padding")],gm);let sw=n6=class extends t6{constructor(...i){super(...i),this.paddedViewState=new t6,this._updateContent=(()=>{const e=xt();return()=>{const t=this._get("size"),n=this._get("padding");if(!t||!n)return;const r=this.paddedViewState;Bi(e,n.left+n.right,n.top+n.bottom),Yn(e,t,e),Zs(r.size,e);const s=r.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(ue(()=>[this.size,this.padding],()=>this._updateContent(),on)),this.padding=new gm,this.size=[0,0]}set padding(i){this._set("padding",i||new gm)}set viewpoint(i){if(i){const e=i.clone();this.paddedViewState.viewpoint=i,$tt(e,i,this._get("size"),this._get("padding"));const t=this._viewpoint2D,n=e.targetGeometry;t.center[0]=n.x,t.center[1]=n.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=n.spatialReference,this._update()}}clone(){return new n6({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};f([y()],sw.prototype,"paddedViewState",void 0),f([y({type:gm})],sw.prototype,"padding",null),f([y()],sw.prototype,"viewpoint",null),sw=n6=f([ge("esri.views.2d.PaddedViewState")],sw);const Wtt=sw;function Q3(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}function AU(i,e){if(i.pointerType==="touch")return!1;switch(e){case"primary":return i.button===0;case"secondary":return i.button===2;case"tertiary":return i.button===1}}let KY=class extends sr{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,n=>this._handleDoubleClick(n,t))}_handleDoubleClick(e,t){Q3(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},jtt=class extends sr{constructor(e,t,n){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",n,r=>this._handleDoubleTapDrag(r))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:n}=t;if(n!==this.pointerType)return;e.stopPropagation();const{action:r,delta:s}=t,{view:a}=this,{mapViewNavigation:o}=a;switch(r){case"begin":{const{scale:l}=a;this._startScale=l,this._currentScale=l,this._previousDelta=s,o.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const l=1.015**s.y,c=this._startScale*l,u=c/this._currentScale;o.setViewpointImmediate(u),this._currentScale=c;break}case"end":{const{constraints:l}=a,{effectiveLODs:c,snapToZoom:u}=l;if(!u||!c)return void o.end();const d=l.snapScale(this._currentScale),h=(s.y>0?Math.max(d,l.snapToPreviousScale(this._startScale)):Math.min(d,l.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(h);break}}}},mM=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,n=t.pointers.size;switch(t.action){case"start":this._currentCount=n,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=n,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,n;this._startEvent=e,(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,n;(n=(t=this._callbacks).condition)!=null&&n.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},qtt=class extends sr{constructor(e,t,n){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",n,r=>this._handleDrag(r)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new mM({start:(t,n)=>{this.view.mapViewNavigation.pan.begin(this.view,n.data),n.stopPropagation()},update:(t,n)=>{this.view.mapViewNavigation.pan.update(this.view,n.data),n.stopPropagation()},end:(t,n)=>{this.view.mapViewNavigation.pan.end(this.view,n.data),n.stopPropagation()},condition:(t,n)=>t===1&&Q3(n.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Ktt=class extends sr{constructor(e,t,n){super(!0),this._view=e,this.pointerAction=t;const r=this._view.mapViewNavigation;this._dragEventSeparator=new mM({start:(s,a)=>{r.rotate.begin(this._view,a.data),a.stopPropagation()},update:(s,a)=>{r.rotate.update(this._view,a.data),a.stopPropagation()},end:(s,a)=>{r.rotate.end(),a.stopPropagation()},condition:(s,a)=>s===1&&Q3(a.data,this.pointerAction)}),this.registerIncoming("drag",n,s=>this._dragEventSeparator.handle(s))}};function Nd(i){let e=i*i;return i<0&&(e*=-1),e}function Ytt(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function r6(i,e,t){const n=t,r=i.state,s=i.device,a=e.tiltDirection==="forward-down"?1:-1,o=1;return s.deviceType==="standard"?(n.translation[0]=Nd(r.axes[0]),n.translation[1]=Nd(r.axes[1]),n.translation[2]=Nd(r.buttons[7])-Nd(r.buttons[6]),n.heading=Nd(r.axes[2]),n.tilt=Nd(r.axes[3])):s.deviceType==="spacemouse"&&(n.translation[0]=1.2*Nd(r.axes[0]),n.translation[1]=1.2*Nd(r.axes[1]),n.translation[2]=2*-Nd(r.axes[2]),n.heading=1.2*Nd(r.axes[5]),n.tilt=1.2*Nd(r.axes[3])),n.tilt*=a,Ye(n.translation,n.translation,o),n}function YY(i,e){const t=e;return t.translation[0]=i[1]-i[0],t.translation[1]=i[3]-i[2],t.translation[2]=i[4]-i[5],t.heading=i[7]-i[6],t.tilt=i[8]-i[9],t.zoom=i[10]-i[11],t}function jR(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let Xtt=class extends sr{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new mi,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([ue(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=Vm({update:n=>this._frameUpdate(n.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},At)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,Ytt(this._transformation)):(this._currentDevice=e.data.device,r6(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if(jR(t))return;const n=this._view.viewpoint.clone(),r=this._view.navigation.gamepad.velocityFactor,s=Qtt*r*e;Z3(n,n,[t.translation[0]*s,-t.translation[1]*s]);const a=1+t.translation[2]*Jtt*e,o=this._view.constraints.rotationEnabled?-t.heading*Ztt*e:0,l=this._view.size,c=[l[0]/2,l[1]];wde(n,n,a,o,c,l);const u=this._view.constraints.constrain(n,this._view.viewpoint);this._view.viewpoint=u}};const Ztt=.06,Qtt=.7,Jtt=6e-4;let eit=class extends sr{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",n,r=>this._handleKeyDown(r)),this.registerIncoming("key-up",n,r=>this._handleKeyUp(r)),this.registerIncoming("blur",n,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const n=this._keyMap[e.data.key];if(this._pressed=n!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},tit=class extends sr{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",n,r=>this._handleKeyDown(r)),this.registerIncoming("key-up",n,r=>this._handleKeyUp(r)),this.registerIncoming("blur",n,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const n=e.modifiers;if(n.size>0&&!n.has("Shift")||!this.view.constraints.rotationEnabled)return;const r=this._keyToDirection[e.data.key];if(this._pressed=r!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),r){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var Vw;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(Vw||(Vw={}));let iit=class extends sr{constructor(e,t,n){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",n,r=>this._handleKeyDown(r)),t.zoomIn.forEach(r=>this._keysToZoomAction[r]=Vw.IN),t.zoomOut.forEach(r=>this._keysToZoomAction[r]=Vw.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:n}=e.data;if(!(n in this._keysToZoomAction))return;const r=this._keysToZoomAction[n],{mapViewNavigation:s}=this.view;let a=null;switch(r){case Vw.IN:a=s.zoomIn();break;case Vw.OUT:a=s.zoomOut();break;default:return}s.begin(),a.then(()=>s.end()),e.stopPropagation()}};const nit=.6;let rit=class extends sr{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,n=>this._handleMouseWheel(n))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:n,y:r,deltaY:s}=e.data,a=1/nit**(1/60*s),o=t.zoom(a,[n,r]);o&&(this._canZoom=!1,o.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},sit=class extends sr{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new mM({start:(n,r)=>{t.pinch.begin(this.view,r.data),r.stopPropagation()},update:(n,r)=>{t.pinch.update(this.view,r.data),r.stopPropagation()},end:(n,r)=>{t.pinch.end(this.view),r.stopPropagation()},condition:n=>n>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function XY(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value?t.value:1:0),axes:e.axes.map(t=>lit(t,i.axisThreshold))}:{buttons:[],axes:[]}}function ait(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function oit(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function lit(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let cit=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const a=s.gamepad,o=a.index,l=this._inputDevices[o];l&&(this._emitGamepadEvent(a,XY(l),!1),this._inputDevices.splice(o,1),this._latestUpdate.splice(o,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const n="getGamepads"in window.navigator,r=window.isSecureContext;this.supported=n&&r,this.supported&&(this._forEachGamepad(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new xU(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=Vm({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),n=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(r=>{const s=this._inputDevices[r.index];if(!s)return;const a=this._latestUpdate[r.index],o=XY(s),l=n||oit(o);a&&(a.timestamp===r.timestamp||!a.active&&l||ait(a.state,o))||this._emitGamepadEvent(r,o,!l)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let n=0;n<t.length;n++){const r=t[n];this._validate(r)&&e(r)}}_emitGamepadEvent(e,t,n){const r=this._latestUpdate[e.index],s=r&&r.active;if(!s&&!n)return;const a=!s&&n?"start":s&&n?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:n},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:a})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const ZY=Fi("trident"),QY=Fi("edge"),uit=Fi("chrome"),dit=Fi("ff"),hit=Fi("safari"),i1={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};let J3=class{constructor(e,t){this._input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new cit(e,this._input),this._gamepadSource.onEvent=n=>this._callback("gamepad",n)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=_t(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const n=this._active[t];this._element.removeEventListener(nF[t],n),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&nF[t]){const n=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(nF[t],n),this._active[t]=n}}),this._gamepadSource.hasEventListeners=e&&e.has("gamepad")}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?i1.touchNone:i1.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?i1.touchPan:i1.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(i1.touchNone),this._element.classList.remove(i1.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const n=sde(this._element,e);return J3.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,t){const n=Aet(t);n&&e==="key-up"&&this._keyDownState.delete(n);const r={native:t,key:n,repeat:n&&this._keyDownState.has(n)};n&&e==="key-down"&&this._keyDownState.add(r.key),this._callback(e,r)}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n)}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n)}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(ZY||QY)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900}ZY||QY?n*=.7:uit||hit?n*=.6:dit&&(n*=1.375);const r=100,s=Math.abs(n);s>r&&(n=n/s*200/(1+Math.exp(-.02*(s-r))));const a=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,a)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};J3.test={disableSubpixelCoordinates:!1};const nF={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Ade=class extends sr{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function MU(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function pit(i,e){const t=e.x-i.x,n=e.y-i.y;return Math.sqrt(t*t+n*n)}function fit(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:Cs()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[w,C]=i,[S,E]=[C.x-w.x,C.y-w.y];return e.radius=Math.sqrt(S*S+E*E)/2,e.center.x=(w.x+C.x)/2,e.center.y=(w.y+C.y)/2,e}let t=0,n=0;for(let w=0;w<i.length;w++)t+=i[w].x,n+=i[w].y;t/=i.length,n/=i.length;const r=i.map(w=>w.x-t),s=i.map(w=>w.y-n);let a=0,o=0,l=0,c=0,u=0,d=0,h=0;for(let w=0;w<r.length;w++){const C=r[w],S=s[w],E=C*C,A=S*S;a+=E,o+=A,l+=C*S,c+=E*C,u+=A*S,d+=C*A,h+=S*E}const p=.5*(c+d),m=.5*(u+h),g=a*o-l*l,_=(p*o-m*l)/g,b=(a*m-l*p)/g,x=Cs(_+t,b+n);return{radius:Math.sqrt(_*_+b*b+(a+o)/i.length),center:x}}function H0(i){const{native:e}=i,{pointerId:t,button:n,pointerType:r}=e;return r==="mouse"?`${t}:${n}`:`${r}`}const _d={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let Mde=class extends sr{constructor(e=_d.maximumDoubleClickDelay,t=_d.maximumDoubleClickDistance,n=_d.maximumDoubleTouchDelay,r=_d.maximumDoubleTouchDistance,s=LL){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=r,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=Gr(e.doubleClickTimer))}get hasPendingInputs(){return ps(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const n=this._pointerState.get(e);n&&(n.doubleClickTimer=Gr(n.doubleClickTimer),t&&this._click.emit(n.event.data,void 0,n.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:n,button:r}=e.native;return n==="mouse"?`${t}:${r}`:`${n}`}_handleImmediateClick(e){const t=e.data,{pointerType:n}=t.native,r=this._getPointerId(t);if(!this._pointerState.has(r))return void this._startClick(e);const s=this._pointerState.get(r),{data:a,modifiers:o}=s.event,l=n==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;MU(a,t)>l?(this._clearDoubleClickTimer(r,!0),this._startClick(e)):(this._clearDoubleClickTimer(r,!1),s.pointerDownCount===2&&this._doubleClick.emit(a,void 0,o))}_handlePointerDown(e){const t=H0(e.data),n=this._pointerState.get(t);n&&(n.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:n}}=t,r=H0(t),s=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(r),s),o=1;this._pointerState.set(r,{event:e,doubleClickTimer:a,pointerDownCount:o}),this.refreshHasPendingInputs()}},mit=class extends sr{constructor(e=_d.maximumDoubleClickDelay,t=_d.maximumDoubleClickDistance,n=_d.maximumDoubleTouchDelay,r=_d.maximumDoubleTouchDistance,s=LL){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=r,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Cs(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new mM({start:(a,o)=>this._dragStart(a,o),update:(a,o)=>this._dragUpdate(o),end:(a,o)=>this._dragEnd(o)}),this.registerIncoming("drag",a=>this._dragEventSeparator.handle(a)),this.registerIncoming("pointer-down",a=>this._handlePointerDown(a)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=Gr(e.doubleTapTimeout)})}get hasPendingInputs(){return ps(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=Gr(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,n){const{button:r,buttons:s,pointer:a,pointers:o,pointerType:l,timestamp:c}=n;return{action:e,delta:t,button:r,buttons:s,pointer:a,pointers:o,pointerType:l,timestamp:c}}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:n,modifiers:r}=t,{center:s}=n;this._dragStartCenter=s;const a=this._createDoubleTapDragData("begin",Cs(0,0),n);this._doubleTapDrag.emit(a,void 0,r),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:n}=e,{center:r}=t,s=Cs(r.x-this._dragStartCenter.x,r.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("update",s,t);this._doubleTapDrag.emit(a,void 0,n),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:n}=e,{center:r}=t,s=Cs(r.x-this._dragStartCenter.x,r.y-this._dragStartCenter.y),a=this._createDoubleTapDragData("end",s,t);this._doubleTapDrag.emit(a,void 0,n),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,n=H0(t),r=this._pointerState.get(n),{pointerType:s}=t.native;if(r){const a=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(n),MU(r.event.data,t)>a?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:n}=t.native,r=H0(t),s=n==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,a=this._clock.setTimeout(()=>this._clearPointerDown(r),s);this._pointerState.set(r,{event:e,doubleTapTimeout:a}),this.refreshHasPendingInputs()}},Pde=class extends sr{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,n,r){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:r,pointers:git(this._activePointerMap),pointer:t,angle:n.angle,radius:n.radius,center:n.center}}_addPointer(e){const t=e.native.pointerId,n=uP(this._activePointerMap).angle,r={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,r);const s=qR(r,Ode(this._activePointerMap));r.initialAngle=s,r.lastAngle=s,this._updatePointerAngles(n)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,n=this._activePointerMap.get(t);n?n.event=e:this._addPointer(e)}_removePointer(e){const t=uP(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=uP(this._activePointerMap);this._activePointerMap.forEach(n=>{n.initialAngle=qR(n,t)-e,n.lastAngle=qR(n,t)-e})}_emitEvent(e,t,n){const r=uP(this._activePointerMap);this._drag.emit(this._createPayload(e,t,r,n),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,n=Wi(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,n),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,Wi(e.timestamp))))}_handlePointerDrag(e){const t=e.data,n=t.currentEvent,r=Wi(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(n.native.pointerId)?(this._updatePointer(n),!this._isCurrentDragSuppressed&&this._emitEvent("update",n,r)):(this._addPointer(n),this._emitEvent("added",n,r),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(n),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",n,r))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function Ode(i){const e=[];return i.forEach(t=>{e.push(Cs(t.event.x,t.event.y))}),fit(e)}function uP(i){const e=Ode(i);let t=0;return i.forEach(n=>{let r=qR(n,e),s=r-n.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;r=n.lastAngle+s,n.lastAngle=r;const a=r-n.initialAngle;t+=a}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function git(i){const e=new Map;return i.forEach((t,n)=>e.set(n,t.event)),e}function qR(i,e){const t=i.event,n=t.x-e.center.x,r=t.y-e.center.y;return Math.atan2(r,n)}var JY;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(JY||(JY={}));let Rde=class extends sr{constructor(e=_d.maximumDoubleClickDelay,t=_d.maximumDoubleClickDistance,n=_d.maximumDoubleTouchDelay,r=_d.maximumDoubleTouchDistance,s=LL){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=n,this._maximumDoubleTouchDistance=r,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=H0(t);if(!this._pointerState.has(n)){const r={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(n,r),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,n=H0(t),r=this._pointerState.get(n);if(r&&r.downButton===t.native.button){const s=r.immediateDoubleClick;if(s){s.timeoutHandle.remove();const a=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;MU(s,e.data)>a?this._startImmediateDoubleClick(e,r):(this._immediateDoubleClick.emit(e.data,void 0,s.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,r)}}_startImmediateDoubleClick(e,t){const n=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),n)}}_removeState(e){const t=H0(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const ST={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let Ide=class extends sr{constructor(e=ST.maximumClickDelay,t=ST.movementUntilMouseDrag,n=ST.movementUntilPenDrag,r=ST.movementUntilTouchDrag,s=ST.holdDelay,a=LL){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=n,this._movementUntilTouchDrag=r,this._holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",o=>{this._handlePointerLoss(o,"pointer-up")}),this.registerIncoming("pointer-capture-lost",o=>{this._handlePointerLoss(o,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",o=>{this._handlePointerLoss(o,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=Gr(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,n=t.native.pointerId;let r=null;this._pointerState.size===0&&(r=this._clock.setTimeout(()=>{const a=this._pointerState.get(n);if(a){if(!a.isDragging){const o=a.previousEvent;this._pointerHold.emit(o,void 0,e.modifiers),a.holdEmitted=!0}a.holdTimeout=null}},this._holdDelay));const s={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:r,modifiers:new Set};this._pointerState.set(n,s),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,n){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:n}}_handlePointerMove(e){const t=e.data,n=t.native.pointerId,r=this._pointerState.get(n);r&&(r.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",r,t),void 0,r.modifiers):pit(t,r.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),r.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,n=t.native.pointerId;this._pointerState.forEach(r=>{r.holdTimeout!=null&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging||(r.modifiers=e.modifiers,r.isDragging=!0,n===r.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",r,t)):this._pointerDrag.emit(this._createPointerDragData("start",r,r.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const n=e.data,r=n.native.pointerId,s=this._pointerState.get(r);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",s,t==="pointer-up"?n:s.previousEvent),void 0,s.modifiers):t==="pointer-up"&&s.downButton===n.native.button&&e.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(n),this._pointerState.delete(r),this.stopCapturingPointer(n.native),this._pointerState.size===0&&this._moveHandle.pause())}};const dP={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let I_=class extends et{constructor(){super(...arguments),this._handles=new mi}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([rs(()=>!e(),()=>this._disconnect()),rs(e,()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=_t(this._inputManager)}_connect(){const e=this.view.surface,t=new J3(e,this.view.input),n=[new Rde,new Ide,new Mde,new Pde(this.view.navigation),new mit],r=new Zd({eventSource:t,recognizers:n});r.installHandlers("prevent-context-menu",[new Ade],Pt.INTERNAL),r.installHandlers("navigation",[new sit(this.view),new Xtt(this.view),new rit(this.view),new KY(this.view),new KY(this.view,[dP.counter]),new qtt(this.view,"primary"),new eit(this.view,dP.pan),new iit(this.view,dP.zoom),new tit(this.view,dP.rotate),new Ktt(this.view,"secondary"),new jtt(this.view,"touch")],Pt.INTERNAL),this.view.viewEvents.connect(r),this._source=t,this._inputManager=r,ue(()=>{var s,a;return(a=(s=this.view)==null?void 0:s.navigation)==null?void 0:a.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},At)}get test(){return{inputManager:this._inputManager}}};f([y()],I_.prototype,"view",void 0),f([y()],I_.prototype,"latestPointerType",null),f([y()],I_.prototype,"latestPointerLocation",null),f([y()],I_.prototype,"multiTouchActive",null),I_=f([ge("esri.views.2d.input.MapViewInputManager")],I_);const vit=I_;let yit=0,dv=class extends et{constructor(){super(...arguments),this.color=new Xt([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return yit++}};f([y({readOnly:!0})],dv.prototype,"version",null),f([y({type:Xt})],dv.prototype,"color",void 0),f([y({type:Xt})],dv.prototype,"haloColor",void 0),f([y()],dv.prototype,"haloOpacity",void 0),f([y()],dv.prototype,"fillOpacity",void 0),dv=f([ge("esri.views.2d.support.HighlightOptions")],dv);const $de=dv,_it=i=>i.includes("Brush");let Lde=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),_it(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function bit(i,e,t,n,r,s,a,o){let l;i.ignorePadding&&(n={left:0,right:0,top:0,bottom:0}),i.width!=null&&i.height!=null?l=[i.width,i.height]:i.width==null&&i.height!=null?l=[i.height,i.height]:i.width!=null&&i.height==null?l=[i.width,i.width]:i.width==null&&i.height==null&&(l=null);const c=t[0]-(n.left+n.right),u=t[1]-(n.top+n.bottom);let d,h,p=i.area||{x:0,y:0,width:c,height:u};if(l){const m=c/u,g=l[0]/l[1];if(g>m){const _=p.width/g;p={x:p.x,y:Math.round(p.y+(p.height-_)/2),width:p.width,height:Math.round(_)}}else{const _=p.height*g;p={x:Math.round(p.x+(p.width-_)/2),y:p.y,width:Math.round(_),height:p.height}}}else l=[p.width,p.height];return l[0]>p.width?(d=Math.min(l[0]/p.width,e),h=l[0]/p.width/d):(d=1,h=l[0]/p.width),{resolutionScale:d,cropArea:{x:Math.round((p.x+n.left)*d),y:Math.round((p.y+n.top)*d),width:Math.round(p.width*d),height:Math.round(p.height*d)},outputScale:h,format:r,quality:s,children:a,rotation:o}}const eX=2048,wit=1.5,xit=8;function Cit(i,e){const{format:t,quality:n,rotation:r,disableDecorations:s}=i||{},a=PU(i,e.padding),o=Iit(i,{width:e.width-a.left-a.right,height:e.height-a.top-a.bottom}),{width:l,height:c}=Rit(i,o),u=Nde(t),d=Vde[u];return{format:u,quality:lt(n??d,0,100),area:o,width:l,height:c,rotation:r,disableDecorations:!!s,ignoreBackground:!(!i||!i.ignoreBackground),ignorePadding:!(!i||!i.ignorePadding)}}function Tit(i,e){const t=Cit(i,e),n=t.area,r=t.width/n.width,s=PU(t,e.padding),a=s.left+s.right,o=s.top+s.bottom,l=e.width-a,c=e.height-o,u=Math.floor(l*r+a),d=Math.floor(c*r+o),h=i&&i.layers?i.layers:[],p=t.ignoreBackground,m=t.ignorePadding;return{framebufferWidth:u,framebufferHeight:d,region:{x:Math.floor(n.x*r)+s.left,y:Math.floor(n.y*r)+s.top,width:t.width,height:t.height},format:t.format,quality:t.quality,rotation:t.rotation,pixelRatio:r,layers:h,disableDecorations:t.disableDecorations,ignoreBackground:p,ignorePadding:m,objectAndLayerIdColor:!1}}function KR(i,e,t){const{ctx:n,canvas:r}=kde(i,t),s=n.getImageData(0,0,i.width,i.height),a=Eit(r,e);return Fde(r),{dataUrl:a,data:s}}function Dde(i,e){const{ctx:t,canvas:n}=kde(i,e),r=t.getImageData(0,0,i.width,i.height);return Fde(n),r}function kde(i,e){const t=Sit();e.premultipliedAlpha&&kit(i),t.width=i.width,t.height=i.height;const n=t.getContext("2d");return n.putImageData(i,0,0),e.flipY&&Dit(n),{ctx:n,canvas:t}}function Fde(i){i.width=0,i.height=0}function Sit(){return B(rF)&&(rF=document.createElement("canvas")),rF}let rF=null;function Eit(i,e){const t=Fit[e.format],n=e.quality/100;return i.toDataURL(t,n)}function Ait(i,e){const t=Nde(i),n=Vde[t];return{format:t,quality:lt(e??n,0,100)}}function Mit(i,e){return e/Math.max(i[0],i[1])}function Pit(i,e,t,n=0,r=0,s=i.width-n,a=i.height-r,o=!1){const{data:l}=i,{width:c,height:u,data:d}=e,h=s/c,p=a/u,m=Math.ceil(h/2),g=Math.ceil(p/2),_=i.width;for(let b=0;b<u;b++)for(let x=0;x<c;x++){const w=4*(x+(o?u-b-1:b)*c);let C=0,S=0,E=0,A=0,P=0,O=0;const M=(b+.5)*p;for(let V=Math.floor(b*p);V<(b+1)*p;V++){const L=Math.abs(M-(V+.5))/g,U=(x+.5)*h,G=L*L;for(let H=Math.floor(x*h);H<(x+1)*h;H++){const k=Math.abs(U-(H+.5))/m,D=Math.sqrt(G+k*k);if(D>=1)continue;let $=2*D*D*D-3*D*D+1;const F=4*(n+H+(r+V)*_);O+=$*l[F+3],S+=$,!t&&l[F+3]<255&&($=$*l[F+3]/255),E+=$*l[F],A+=$*l[F+1],P+=$*l[F+2],C+=$}}d[w]=E/C,d[w+1]=A/C,d[w+2]=P/C,d[w+3]=O/S}return e}function Oit(i,e,t){if(!e)return i;const{framebufferWidth:n,framebufferHeight:r,pixelRatio:s,region:a}=i,o=PU(i,t),l=o.left+o.right,c=o.top+o.bottom,u=n-l,d=r-c,h=Math.min(xit,Math.min((eX-l)/u,(eX-c)/d));return h<wit?i:{...i,framebufferWidth:Math.round(u*h)+l,framebufferHeight:Math.round(d*h)+c,pixelRatio:s*h,resample:{region:{x:Math.round((a.x-o.left)*h)+o.left,y:Math.round((a.y-o.top)*h)+o.top,width:Math.round(a.width*h),height:Math.round(a.height*h)},width:n,height:r}}}function Rit(i,e){if(!i)return e;const t=i.width,n=i.height;if(t!=null&&n!=null)return{width:Math.floor(t),height:Math.floor(n)};if(t==null&&n==null)return e;const r=e.width/e.height;return n==null?{width:Math.floor(t),height:Math.floor(t/r)}:{width:Math.floor(n*r),height:Math.floor(n)}}function Iit(i,e){const t={x:0,y:0,width:e.width,height:e.height};if(i&&i.area){i.area.x!=null&&(t.x=Math.floor(i.area.x)),i.area.y!=null&&(t.y=Math.floor(i.area.y));const n=i.area.width!=null?Math.floor(i.area.width):null,r=i.area.height!=null?Math.floor(i.area.height):null;if(t.width=e.width-t.x,t.height=e.height-t.y,n!=null&&r!=null)t.width=Math.min(t.width,n),t.height=Math.min(t.height,r);else if(n==null&&r!=null){const s=Math.min(t.width,n);t.height=s/t.width*t.height,t.width=s}else if(n!=null&&r==null){const s=Math.min(t.height,r);t.width=s/t.height*t.width,t.height=s}}return $it(Lit(t,i),e)}function $it(i,e){const t=Math.floor(Math.max(i.x,0)),n=Math.floor(Math.max(i.y,0)),r={x:t,y:n,width:Math.floor(Math.min(i.width,e.width-t)),height:Math.floor(Math.min(i.height,e.height-n))},s=r.width/r.height,a=i.width/i.height;if(a===s)return r;if(a>s){const c=Math.floor(r.width/a),u=r.height-c;return{x:r.x,y:Math.floor(r.y+u/2),width:r.width,height:c}}const o=Math.floor(r.height*a),l=r.width-o;return{x:Math.floor(r.x+l/2),y:r.y,width:o,height:r.height}}function Lit(i,e){if(!e||e.width==null||e.height==null)return i;const t=e.width/e.height,n=i.width/i.height;if(n===t)return i;if(n<t){const s=Math.floor(i.height*t);return i.x-=(s-i.width)/2,i.width=s,i}const r=Math.floor(i.width/t);return i.y-=(r-i.height)/2,i.height=r,i}function PU(i,e){return!e||i&&i.ignorePadding?Vit:e}function Nde(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return Nit}}function Dit(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function kit(i){const e=i.data,t=e.length;for(let n=0;n<t;n+=4){const r=e[n+3];if(r!==255&&r>0){const s=255/r;e[n+0]=e[n+0]*s,e[n+1]=e[n+1]*s,e[n+2]=e[n+2]*s}}}const Fit={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},tX=98,Nit="png",Vde={png:100,jpg:tX,jpeg:tX},Vit={top:0,right:0,bottom:0,left:0};function Bde(i){const e=h0e(i);if(!e.available)return new Ze("webgl:required","WebGL is required but not supported.");if(i==="3d"&&e.majorPerformanceCaveat)return new Ze("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new Ze("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new Ze("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===La.WEBGL1){if(!e.supportsElementIndexUint)return new Ze("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new Ze("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new Ze("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function Bit(i){return i&&"nodeType"in i}function zit(i){return i&&typeof i.render=="function"}const iX={component:"esri-component"};let $_=class extends et{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(iX.component),t&&t.classList.remove(iX.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||Bit(e)?(this._set("widget",null),uB(e)):(zit(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};f([y({dependsOn:[]})],$_.prototype,"id",null),f([y()],$_.prototype,"node",null),f([Mr("node")],$_.prototype,"castNode",null),f([y({readOnly:!0})],$_.prototype,"widget",void 0),$_=f([ge("esri.views.ui.Component")],$_);const YR=$_,Uit={left:0,top:0,bottom:0,right:0},zde={bottom:30,top:15,right:15,left:15},sF="manual",vl={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function Hit(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function aF(i){const e=i,t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?i:null}function oF(i,{top:e,bottom:t,left:n,right:r}){i.style.top=e,i.style.bottom=t,i.style.left=n,i.style.right=r}let Zf=class extends Pn.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new mi,this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&oF(t,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&oF(t,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([ue(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,At),ue(()=>this.padding,this._applyUIPadding,At)])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(vl.ui),qQe(e),this._attachContainers(e)),t&&(t.classList.remove(vl.ui),oF(t,{top:"",bottom:"",left:"",right:""}),Aie(t)),this._set("container",e))}get height(){const e=this.get("view.height")||0;if(e===0)return e;const t=this._getViewPadding(),n=t.top+t.bottom;return Math.max(e-n,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...zde,...e}}get width(){const e=this.get("view.width")||0;if(e===0)return e;const t=this._getViewPadding(),n=t.left+t.right;return Math.max(e-n,0)}add(e,t){let n,r;if(Array.isArray(e))return void e.forEach(a=>this.add(a,t));const s=aF(e);s&&({index:n,position:t,component:e,key:r}=s),t&&typeof t=="object"&&({index:n,key:r,position:t}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,n,r)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map(r=>this.remove(r,t));const n=this._find(e);if(n){const r=this._componentToKey;if(r.has(e)&&r.get(e)!==t)return;const s=this._components.indexOf(n);return n.node.parentNode&&n.node.parentNode.removeChild(n.node),this._componentToKey.delete(e),this._components.splice(s,1)[0]}}empty(e){return Array.isArray(e)?e.map(t=>this.empty(t)).reduce((t,n)=>t.concat(n)):(e=e||sF)===sF?Array.prototype.slice.call(this._manualContainer.children).filter(t=>!t.classList.contains(vl.corner)).map(t=>this.remove(t)):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}move(e,t){if(Array.isArray(e)&&e.forEach(a=>this.move(a,t)),!e)return;let n;const r=aF(e)||aF(t);if(r&&(n=r.index,t=r.position,e=r.component||e),t&&!this._isValidPosition(t))return;const s=this.remove(e);s&&this.add(s,{position:t,index:n})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,n,r){e instanceof YR||(e=new YR({node:e})),this._place({component:e,position:t,index:n}),this._components.push(e),r&&this._componentToKey.set(e,r)}_find(e){return e?e instanceof YR?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.get("view.padding")||Uit}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(vl.innerContainer),e.classList.add(vl.cornerContainer);const t=document.createElement("div");t.classList.add(vl.innerContainer),t.classList.add(vl.manualContainer);const n=document.createElement("div");n.classList.add(vl.topLeft),n.classList.add(vl.corner),e.appendChild(n);const r=document.createElement("div");r.classList.add(vl.topRight),r.classList.add(vl.corner),e.appendChild(r);const s=document.createElement("div");s.classList.add(vl.bottomLeft),s.classList.add(vl.corner),e.appendChild(s);const a=document.createElement("div");a.classList.add(vl.bottomRight),a.classList.add(vl.corner),e.appendChild(a),this._innerContainer=e,this._manualContainer=t;const o=Su();this._cornerNameToContainerLookup={"top-left":n,"top-right":r,"bottom-left":s,"bottom-right":a,"top-leading":o?r:n,"top-trailing":o?n:r,"bottom-leading":o?a:s,"bottom-trailing":o?s:a},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.component,n=e.position||sF,r=e.index,s=this._positionNameToContainerLookup[n],a=r>-1;if(Hit(t.widget)&&t.widget.startup(),!a)return void s.appendChild(t.node);const o=Array.prototype.slice.call(s.children);if(r===0)return void(s.firstChild?MG(t.node,s.firstChild):s.appendChild(t.node));r>=o.length?s.appendChild(t.node):MG(t.node,o[r])}_toPxPosition(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}_toPxUnit(e){return e===0?"0":e+"px"}_findByComponent(e){let t,n=null;return this._components.some(r=>(t=r===e,t&&(n=r),t)),n}_findById(e){let t,n=null;return this._components.some(r=>(t=r.id===e,t&&(n=r),t)),n}_findByNode(e){let t,n=null;return this._components.some(r=>(t=r.node===e,t&&(n=r),t)),n}};f([y()],Zf.prototype,"container",null),f([y()],Zf.prototype,"height",null),f([y({value:zde})],Zf.prototype,"padding",null),f([Mr("padding")],Zf.prototype,"castPadding",null),f([y()],Zf.prototype,"view",void 0),f([y()],Zf.prototype,"width",null),Zf=f([ge("esri.views.ui.UI")],Zf);const Git=Zf;function nX(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function Wit(i,e){return i.length!==e.length||i.some((t,n)=>t.text!==e[n].text)}function hP(i,e,t){!t||!e||i.find(n=>n.layerView===e&&n.text===t)||i.push({text:t,layerView:e})}function jit(i){return i.type==="bing-maps"}const Rg=[];let aw=class extends PC{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new _i,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const n=this.get("view.allLayerViews");n&&this.handles.add(n.map(r=>ue(()=>{var s;return[r.suspended,(s=r.layer)==null?void 0:s.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.handles.add([Sn(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),rs(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.get("view.allLayerViews");Rg.length=0,e?(e.forEach(t=>{var s;if(t.suspended||!((s=t.layer)!=null&&s.attributionVisible))return;const n=t.layer;if(nX(n,"user"))return void hP(Rg,t,n.copyright);if(n.hasAttributionData){if(this._fetchedAttributionData.has(t)){const a=this._fetchedAttributionData.get(t);return void(a?hP(Rg,t,this._getDynamicAttribution(a,this.view,n)):nX(n)&&hP(Rg,t,n.copyright))}return void this._fetchAttributionData(t)}const r=n.get("portalItem.accessInformation");hP(Rg,t,r||n.copyright)}),Wit(this.items,Rg)&&(this.items.removeAll(),this.items.addMany(Rg)),Rg.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await l2(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const n=t.ok?this._createContributionIndex(t.value,jit(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,n)}this._updateAttributionItems()}_createContributionIndex(e,t){const n=e.contributors,r={};if(!n)return r;for(let s=0;s<n.length;s++){const a=n[s],o=a.coverageAreas;if(!o)return;for(const l of o){const c=l.bbox,u=l.zoomMin-(t&&l.zoomMin?1:0),d=l.zoomMax-(t&&l.zoomMax?1:0),h={xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:$n.WGS84},p={extent:FL(h),attribution:a.attribution||"",score:l.score!=null?l.score:100,id:s};for(let m=u;m<=d;m++)r[m]=r[m]||[],r[m].push(p)}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(e,t,n){const{extent:r,scale:s}=t;let a=n.tileInfo.scaleToZoom(s);if(a=Math.min(e.maxKey,Math.round(a)),!r||a==null||a<=-1)return"";const o=e[a],l=oB(r.center.clone().normalize(),t.spatialReference),c={};return o?o.filter(u=>{const d=!c[u.id]&&l&&hie(u.extent,l);return d&&(c[u.id]=!0),d}).sort((u,d)=>d.score-u.score||u.objectId-d.objectId).map(u=>u.attribution).join(", "):""}};f([y({readOnly:!0,type:_i})],aw.prototype,"items",void 0),f([y({readOnly:!0})],aw.prototype,"state",null),f([y()],aw.prototype,"view",void 0),aw=f([ge("esri.widgets.Attribution.AttributionViewModel")],aw);const Ude=aw,Ig={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let Al=class extends gr{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(n=>n.forEach(({target:r})=>this._checkSourceTextOverflow(r))),this.iconClass=Ig.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Ude}initialize(){this.addHandles(Sn(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[Ig.open]:this._isOpen};return z("div",{bind:this,class:this.classes(Ig.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return z("div",{class:Ig.poweredBy},"Powered by"," ",z("a",{class:Ig.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,n=t?"0":"",{attributionText:r}=this,s={[Ig.sourcesOpen]:e,[Ig.interactive]:t};return z("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Ig.sources,s),innerHTML:r,tabindex:n})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:n,clientWidth:r,scrollWidth:s}=e,a=s>r,o=this._attributionTextOverflowed!==a;if(this._attributionTextOverflowed=a,o&&(t=!0),this._isOpen){const l=n<this._prevSourceNodeHeight;this._prevSourceNodeHeight=n,l&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};f([y()],Al.prototype,"_isOpen",void 0),f([y()],Al.prototype,"_isInteractive",null),f([y()],Al.prototype,"_attributionTextOverflowed",void 0),f([y()],Al.prototype,"_prevSourceNodeHeight",void 0),f([y({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Al.prototype,"attributionText",null),f([y()],Al.prototype,"iconClass",void 0),f([y()],Al.prototype,"itemDelimiter",void 0),f([y()],Al.prototype,"label",null),f([y(),En("esri/widgets/Attribution/t9n/Attribution")],Al.prototype,"messages",void 0),f([y()],Al.prototype,"view",null),f([y({type:Ude})],Al.prototype,"viewModel",void 0),f([dr()],Al.prototype,"_toggleState",null),Al=f([ge("esri.widgets.Attribution")],Al);const qit=Al,Kit="esri.widgets.CompassViewModel";let L_=class extends wU(et){constructor(e){super(e),this._handles=new mi,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(ue(()=>this.view,this._updateRotationWatcher,At))}destroy(){this._handles=Gr(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const e={};this.view.type==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?ue(()=>e==null?void 0:e.rotation,this._updateForRotation,At):ue(()=>e==null?void 0:e.camera,this._updateForCamera,At))}};f([y({readOnly:!0})],L_.prototype,"canShowNorth",null),f([y()],L_.prototype,"orientation",void 0),f([y({readOnly:!0})],L_.prototype,"state",null),f([y()],L_.prototype,"view",void 0),L_=f([ge(Kit)],L_);const Hde=L_,$g={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let ap=class extends gr{constructor(e,t){super(e,t),this.iconClass=$g.widgetIcon,this.messages=null,this.viewModel=new Hde}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,n=t==="disabled",r=(t==="rotation"?"rotation":"compass")=="compass",s=n?-1:0,a={[$g.disabled]:n,[$g.interactive]:!n},o={[$g.northIcon]:r,[$g.rotationIcon]:!r},{messages:l}=this;return z("div",{bind:this,class:this.classes($g.base,a),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:s,"aria-label":l.reset,title:l.reset},z("span",{"aria-hidden":"true",class:this.classes($g.icon,o),styles:this._toRotationTransform(e)}),z("span",{class:$g.text},l.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};f([y()],ap.prototype,"goToOverride",null),f([y()],ap.prototype,"iconClass",void 0),f([y()],ap.prototype,"label",null),f([y(),En("esri/widgets/Compass/t9n/Compass")],ap.prototype,"messages",void 0),f([y()],ap.prototype,"view",null),f([y({type:Hde})],ap.prototype,"viewModel",void 0),f([dr()],ap.prototype,"_reset",null),ap=f([ge("esri.widgets.Compass")],ap);const Gde=ap;let ow=class extends et{constructor(e){super(e),this.navigationMode="pan",this.view=null}initialize(){this.own(rs(()=>{var e;return(e=this.view)==null?void 0:e.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.get("view.ready")&&this.view.type==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};f([y({readOnly:!0})],ow.prototype,"state",null),f([y()],ow.prototype,"navigationMode",void 0),f([y()],ow.prototype,"view",void 0),ow=f([ge("esri.widgets.NavigationToggleViewModel")],ow);const Wde=ow,Vu={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let op=class extends gr{constructor(e,t){super(e,t),this.iconClass=Vu.widgetIcon,this.messages=null,this.viewModel=new Wde}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",t=this.get("viewModel.navigationMode")==="pan",n={[Vu.disabled]:e,[Vu.isLayoutHorizontal]:this.layout==="horizontal"},r={[Vu.activeButton]:t},s={[Vu.activeButton]:!t},a=e?-1:0,o=this.messages.toggle;return z("div",{bind:this,class:this.classes(Vu.base,n),onclick:this._toggle,onkeydown:this._toggle,tabIndex:a,"aria-label":o,title:o},z("div",{class:this.classes(Vu.button,Vu.panButton,r)},z("span",{class:Vu.panIcon})),z("div",{class:this.classes(Vu.button,Vu.rotateButton,s)},z("span",{class:Vu.rotationIcon})))}_toggle(){this.toggle()}};f([y()],op.prototype,"iconClass",void 0),f([y()],op.prototype,"label",null),f([y({value:"vertical"})],op.prototype,"layout",null),f([y(),En("esri/widgets/NavigationToggle/t9n/NavigationToggle")],op.prototype,"messages",void 0),f([y()],op.prototype,"view",null),f([y({type:Wde})],op.prototype,"viewModel",void 0),f([dr()],op.prototype,"_toggle",null),op=f([ge("esri.widgets.NavigationToggle")],op);const Yit=op,ET={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let hv=class extends gr{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const e=this.enabled?0:-1,t={[ET.disabled]:!this.enabled,[ET.interactive]:this.enabled},n={[this.iconClass]:!!this.iconClass};return z("div",{bind:this,class:this.classes(ET.button,t),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},z("span",{"aria-hidden":"true",role:"presentation",class:this.classes(ET.icon,n)}),z("span",{class:ET.iconText},this.title))}_triggerAction(){this.action.call(this)}};f([y()],hv.prototype,"action",void 0),f([y()],hv.prototype,"enabled",void 0),f([y()],hv.prototype,"iconClass",void 0),f([y()],hv.prototype,"title",void 0),f([dr()],hv.prototype,"_triggerAction",null),hv=f([ge("esri.widgets.IconButton")],hv);const rX=hv;let lw=class extends et{get canZoomIn(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return t===0||e>t}get canZoomOut(){if(!this.get("view.ready"))return!1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return t===0||e<t}};f([y({readOnly:!0})],lw.prototype,"canZoomIn",null),f([y({readOnly:!0})],lw.prototype,"canZoomOut",null),f([y()],lw.prototype,"view",void 0),lw=f([ge("esri.widgets.Zoom.ZoomConditions2D")],lw);const Xit=lw;let cw=class extends et{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};f([y({readOnly:!0})],cw.prototype,"canZoomIn",null),f([y({readOnly:!0})],cw.prototype,"canZoomOut",null),f([y()],cw.prototype,"view",void 0),cw=f([ge("esri.widgets.Zoom.ZoomConditions3D")],cw);const Zit=cw;let pv=class extends et{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return T(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return T(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Xit({view:e}):e.type==="3d"&&(this._zoomConditions=new Zit({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():iy(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():iy(e.goTo({zoomFactor:.5}))}};f([y()],pv.prototype,"_zoomConditions",void 0),f([y()],pv.prototype,"canZoomIn",null),f([y()],pv.prototype,"canZoomOut",null),f([y({readOnly:!0})],pv.prototype,"state",null),f([y()],pv.prototype,"view",null),pv=f([ge("esri.widgets.Zoom.ZoomViewModel")],pv);const jde=pv,AT={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let Qf=class extends gr{constructor(e,t){super(e,t),this.iconClass=AT.widgetIcon,this.messages=null,this.viewModel=new jde}initialize(){this._zoomInButton=new rX({action:this.zoomIn.bind(this),iconClass:AT.zoomInIcon}),this._zoomOutButton=new rX({action:this.zoomOut.bind(this),iconClass:AT.zoomOutIcon})}destroy(){this._zoomInButton=_t(this._zoomInButton),this._zoomOutButton=_t(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[AT.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:n,canZoomOut:r}=e;this._zoomInButton.enabled=n,this._zoomOutButton.enabled=r;const{zoomIn:s,zoomOut:a}=this.messages;return this._zoomInButton.title=s,this._zoomOutButton.title=a,z("div",{class:this.classes(AT.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};f([y()],Qf.prototype,"iconClass",void 0),f([y()],Qf.prototype,"label",null),f([y({value:"vertical"})],Qf.prototype,"layout",null),f([y(),En("esri/widgets/Zoom/t9n/Zoom")],Qf.prototype,"messages",void 0),f([y()],Qf.prototype,"view",null),f([y({type:jde})],Qf.prototype,"viewModel",void 0),Qf=f([ge("esri.widgets.Zoom")],Qf);const qde=Qf;function Qit(i){return i&&i.view!==void 0}let XR=class extends Git{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this._handles.add([ue(()=>this.components,this._componentsWatcher.bind(this),At),ue(()=>this.view,this._updateViewAwareWidgets.bind(this),At)])}_add(e,t,n,r){if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;e=this._createComponent(e)}super._add(e,t,n,r)}_removeComponents(e){e.forEach(t=>{const n=this._find(t);n&&(this.remove(n),n.destroy())})}_updateViewAwareWidgets(e){this.components.forEach(t=>{const n=this._find(t),r=n&&n.widget;Qit(r)&&(r.view=e)})}_componentsWatcher(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(e){this.constructed&&e.forEach(t=>this.add(this._createComponent(t),this._defaultPositionLookup[t]))}_createComponent(e){const t=this._createWidget(e);if(t)return new YR({id:e,node:t})}_createWidget(e){return e==="attribution"?this._createAttribution():e==="compass"?this._createCompass():e==="navigation-toggle"?this._createNavigationToggle():e==="zoom"?this._createZoom():void 0}_createAttribution(){return new qit({view:this.view})}_createCompass(){return new Gde({view:this.view})}_createNavigationToggle(){return new Yit({view:this.view})}_createZoom(){return new qde({view:this.view})}};f([y()],XR.prototype,"components",void 0),XR=f([ge("esri.views.ui.DefaultUI")],XR);const Kde=XR;let ZR=class extends Kde{constructor(e){super(e),this.components=["attribution","zoom"]}};f([y()],ZR.prototype,"components",void 0),ZR=f([ge("esri.views.ui.2d.DefaultUI2D")],ZR);const Yde=ZR;var s6;let QR=s6=class extends Wo{constructor(i){super(i),this.color=new Xt([0,0,0,1])}clone(){return new s6(ko({color:this.color}))}};f([y({type:Xt,json:{write:!0}})],QR.prototype,"color",void 0),QR=s6=f([ge("esri.webmap.background.ColorBackground")],QR);const Jit=QR;let Xde,Zde,Qde,Jde,ehe,the;async function ent(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:n,MagnifierView2D:r,Stage:s}]=await Promise.all([Ee(()=>import("./webglDeps-eec0a475.js"),["./webglDeps-eec0a475.js","./FramebufferObject-50e1b68f.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./context-util-1e3c8cfc.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ShaderCompiler-77d0dcb6.js","./programUtils-f035fe8a.js","./ProgramTemplate-afbd57f8.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),Ee(()=>import("./mapViewDeps-dacc67ec.js"),["./mapViewDeps-dacc67ec.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./mat3f32-d3d088e8.js","./Rasterizer-c5722a70.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./_commonjsHelpers-a430e9ea.js","./imageutils-b39249d8.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./cimAnalyzer-721530a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./fontUtils-b94d5e06.js","./screenUtils-410d12c0.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./BidiEngine-836b7ef6.js","./aaBoundingRect-4a760199.js","./jsonUtils-03c4af61.js","./enums-4b2a86a0.js","./utils-c81a5c52.js","./alignmentUtils-ae955d28.js","./definitions-2d0dd0cd.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./number-954e4ab6.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./rasterizingUtils-133923fb.js","./utils-26560131.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./enums-4ca4641f.js","./MaterialKey-406a59ab.js","./Utils-b2b4cf0c.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./BufferPool-f19f4e1f.js","./WGLContainer-14075e1a.js","./WGLBrushVTLSymbol-dcfd88b4.js","./FramebufferObject-50e1b68f.js","./StyleDefinition-7d58136b.js","./config-1337d16e.js","./GeometryUtils-c093d234.js","./pixelUtils-c27b13a1.js","./ShaderCompiler-77d0dcb6.js","./ProgramTemplate-afbd57f8.js","./heatmapTextureUtils-d1d96768.js","./earcut-58237617.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./VTLMaterialManager-2c63b5e3.js","./enums-0fc02184.js","./programUtils-f035fe8a.js","./MaterialPrograms-42724b3b.js","./pbf-e1a6c35b.js","./Matcher-1892b043.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./Queue-3a0c055d.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./visualVariablesUtils-8295a400.js","./visualVariablesUtils-496ec144.js","./tileUtils-caf0c827.js","./TileClipper-5dae42c4.js","./assets-0b172f07.js","./Geometry-daada628.js","./defaultsJSON-59981e75.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./ExpandedCIM-676cf2ac.js","./devEnvironmentUtils-5002a058.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./persistableUrlUtils-a16d0f55.js","./styleUtils-4adfed9e.js","./CircularArray-cf56c6b0.js","./MeshComponent-f50df6af.js","./deduplicate-b0bc48cc.js","./HandleOwner-e1406413.js","./FeatureSetReader-2d27cc52.js","./centroid-13995b22.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js","./BaseGraphicContainer-aa7dd916.js","./normalizeUtilsSync-9c84b89e.js","./normalizeUtils-ee4bf39f.js","./utils-1f4fcfec.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./zscale-1e1fc911.js","./json-48e3ea08.js","./labelingInfo-5c3a46f6.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./fieldUtils-31bfecd2.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./collectionUtils-3831b7c4.js","./labelUtils-a194a22a.js","./jsonUtils-d7db3dc7.js","./FeatureContainer-f14037ae.js","./TileContainer-07bccb79.js","./capabilities-3636c6a4.js","./schemaUtils-615a0d3f.js","./LayerFloorInfo-2cd5e8ae.js","./diffUtils-1ac65748.js","./createSymbolSchema-41fdd7db.js","./rendererUtils-3275688e.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./Identifiable-aa6d459d.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./visualVariableUtils-c59ab38d.js","./Graphic-b46e2684.js","./compilerUtils-034cacb8.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./deprecate-b9088bd3.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./util-38c30a14.js","./ComputedAttributeStorage-58146ac4.js","./FieldsIndex-aa6dd3fa.js","./GraphicsView-935faaa9.js","./vec3f32-c9aa289f.js","./GraphicContainer-66edeaa1.js","./asyncUtils-62e8a185.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./dehydratedFeatures-4eeb381a.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url)]);Zde=i,Qde=e,Jde=t,ehe=n,the=r,Xde=s}const sX=160;function tnt(i){return i&&i.declaredClass==="esri.Viewpoint"}let Ai=class extends hue(Jue(ede(fde))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new t2({getCollections:()=>{var t,n;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,this.layerViews,(n=this.basemapView)==null?void 0:n.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new Vtt(this),this._pePromise=null,this.floors=new _i,this.highlightOptions=new $de,this.inputManager=new vit({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new Lde,this.type="2d",this.ui=new Yde,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new Ede,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([ue(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(sX)},on),this.on("resize",t=>this._resizeHandler(t)),ue(()=>{var t;return(t=this.animationManager)==null?void 0:t.animation},t=>{this.animation=t})]),xie()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new l0e(this.featuresTilingScheme)}get initialExtentRequired(){var o;const{scale:e,constraints:t,center:n,viewpoint:r,extent:s}=this;let a=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((o=this.map.initialViewProperties)!=null&&o.viewpoint))&&!s&&(t!=null&&t.effectiveLODs||(a=-1),(!n||e===0&&a===-1)&&(!r||!T(r.targetGeometry)||r.targetGeometry.type!=="extent"&&!r.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!Y0()||(this._pePromise||(this._pePromise=MC().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=this.spatialReference,n=kt(e.targetGeometry);return!!$y(n.spatialReference,t)||this._projectionEngineLoaded}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),!e||e.isFulfilled())return void this._set("animation",null);this._set("animation",e),this.frameTask.animationInProgress=!0;const n=()=>{var r;e===this._get("animation")&&(this._set("animation",null),(r=this.frameTask)==null||r.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};e.when(n,n)}get background(){return int(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:t}=this.state.paddedViewState;return new Wt({x:e[0],y:e[1],spatialReference:t})}set center(e){if(e==null)return;if(!this.ready)return this._set("center",e),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(r){return void tt.getLogger(this.declaredClass).error(new Ze("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:r}))}const n=this.viewpoint;XV(n,n,t),this.viewpoint=n}set constraints(e){const t=this._get("constraints");t&&(this.handles.remove("map-view-constraints"),t.destroy()),this._set("constraints",e),e&&(e.view=this,this.ready&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint)),this.handles.add(ue(()=>e.version,()=>{this.ready&&this.state&&(this.state.viewpoint=e.fit(this.state.paddedViewState.viewpoint))},on),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void tt.getLogger(this.declaredClass).error(new Ze("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let t;try{t=this._project(e,this.spatialReference)}catch(r){return void tt.getLogger(this.declaredClass).error(new Ze("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:r}))}const n=this.viewpoint;Ctt(n,n,t,this.size,{constraints:this.constraints}),this.viewpoint=n}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const t=this.viewpoint;Dtt(t,t,e),this.viewpoint=t}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",-1);const n=this._get("extent");return n&&(this._set("extent",null),this._set("center",n.center)),void this.notifyChange("initialExtentRequired")}const t=this.viewpoint;WY(t,t,e),this.viewpoint=t}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var t,n,r;const e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(s=>!s.destroyed&&!("layerViews"in s)&&s.updating===!0));if(Fi("esri-2d-log-updating")){const s=this.allLayerViews.reduce((a,o)=>({...a,[o.layer.id]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(t=this.layerViewManager)==null?void 0:t.updating}
-> labelManager.updating: ${(n=this.labelManager)==null?void 0:n.updating}
-> graphicsView.updating: ${(r=this.graphicsView)==null?void 0:r.updating}
-> allLayerViews: ${JSON.stringify(s)}
`)}return e}get viewpoint(){if(!this.ready)return this._get("viewpoint");const e=this.state.paddedViewState;return e&&e.viewpoint.clone()}set viewpoint(e){if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let t,n;try{t=this._project(e,this.spatialReference),!e.scale||isNaN(e.scale)?n=new Ze("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):B(e.targetGeometry)&&(n=new Ze("mapview:invalid-viewpoint","geometry not defined"))}catch(s){n=new Ze("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:s})}if(n)return void tt.getLogger(this.declaredClass).error(n);this._scaleBeforeChangingSpatialReference=null;const r=new ga({targetGeometry:new Wt,scale:0,rotation:0});Vh(r,t),this.constraints.constrain(r,this.state.paddedViewState.viewpoint),this.state.viewpoint=r,this.frameTask.requestFrame(),this._set("viewpoint",r)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(e){if(e==null)return;if(!this.ready){this._set("zoom",e),this._set("scale",0);const n=this._get("extent");return n&&(this._set("extent",null),this._set("center",n.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const t=this.viewpoint;WY(t,t,this.constraints.zoomToScale(e)),this.viewpoint=t,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(e,t){if(e)return this.animation&&(this.animation=null),this._createAnimation(),$u(()=>this.ready,t).then(()=>{const n={animate:!0,...t},r=btt(e,this);return this.animation.update(r),this._gotoTask={},n.animate?this._gotoAnimated(r,n):this._gotoImmediate(r,n)});tt.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(e,t){const n=I$(e)?R$(this,e):e;if(!this.ready||isNaN(n.x)||isNaN(n.y))return{screenPoint:n,results:[]};let r=new Set,s=!1,a=null,o=null;t!=null&&t.include?oX(t.include,aX(this,d=>r.add(d),d=>{a||(a=new Set),a.add(d)},d=>r.add(d),()=>s=!0)):(s=!0,r=new Set(this.allLayerViews)),t!=null&&t.exclude&&oX(t.exclude,aX(this,d=>r.delete(d),d=>{o||(o=new Set),o.add(d)}));const l=this.allLayerViews.filter(d=>!d.suspended&&r.has(d)).reverse(),c=this.toMap(n);let u=[...s?this.graphicsView.hitTest(c).map(d=>({type:"graphic",graphic:d,layer:null,mapPoint:c})):[],...await Promise.all(l.map(d=>d.hitTest(c,n)).toArray())].filter(T).flat().filter(T);return a&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||a.has(a6(d.graphic)))),o&&(u=u.filter(d=>!("graphic"in d)||!d.graphic||o.has(a6(d.graphic)))),{screenPoint:n,results:u}}async takeScreenshot(e){const t=this._createScreenshotPlan(e),n=await this._stage.takeScreenshot(t);return KR(n,{format:t.format,quality:t.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(e){const t=this._createScreenshotPlan(e),n=await this._stage.takeScreenshot(t);return Dde(n,this._pixelFormat)}_createScreenshotPlan(e){e=e||{};const t=this.supersampleScreenshotsEnabled?Math.min(4,Mit(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let n;e.layers?(n=[],e.layers.forEach(a=>{const o=this.allLayerViews.find(l=>l.layer.id===a.id);o&&"container"in o&&o.container&&n.push(o.container)})):n=this._stage.children;const{format:r,quality:s}=Ait(e.format,e.quality);return bit(e,t,this.size,this.padding,r,s,n,e.rotation)}get test(){return{takeScreenshot:e=>this._takeScreenshot(e)}}toMap(e){if(!this.ready)return null;const t=I$(e)?R$(this,e):e,n=[0,0],[r,s]=this.state.toMap(n,[t.x,t.y]),a=this.spatialReference;return new Wt({x:r,y:s,spatialReference:a})}toScreen(e){if(!this.ready)return null;const t=this._project(e,this.spatialReference),n=[t.x,t.y];return this.state.toScreen(n,n),Cs(n[0],n[1])}on(e,t,n,r){return this.inputManager&&this.viewEvents.on(e,t,n,r)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,t,n;return this.map&&"initialViewProperties"in this.map&&((t=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:t.spatialReference)||((n=this.defaultsFromMap)==null?void 0:n.spatialReference)||null}hasLayerViewModule(e){return qY.hasLayerViewModule(e)}importLayerView(e){return qY.importLayerView(e)}pixelSizeAt(){return this.ready?this.state.resolution:(tt.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(e){return this.hitTest(e).then(t=>({...t,mapPoint:this.toMap(e)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let e=Bde(this.type);return Fi("safari")&&Fi("safari")<9&&(e=new Ze("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Fi("safari")})),T(e)?(tt.getLogger(this.declaredClass).warn("#validate()",e.message),Promise.reject(e)):ent()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new Qm),this.animation}_cancellableGoTo(e,t,n){const r=()=>e===this._gotoTask,s=n.then(()=>{r()&&(this.animation=null)}).catch(o=>{throw r()&&(this.animation=null,t.done||(t.stop(),this.frameTask.animationInProgress=!1)),o}),a=new Promise(o=>o(s));return t.when().catch(()=>{r()&&a.cancel&&a.cancel()}),a}_gotoImmediate(e,t){const n=this._gotoTask,r=this.animation,s=e.then(a=>{if(Cn(t),n!==this._gotoTask)throw new Ze("view:goto-interrupted","Goto was interrupted");this.viewpoint=r.target=a,r.finish()});return this._cancellableGoTo(n,r,s)}_flipStationary(e){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<sX&&(this._stationaryTimer=this._flipStationary(t))},e)),this._stationaryTimer}_getDefaultViewpoint(){var b,x,w,C;const{constraints:e,initialExtent:t,map:n,padding:r,size:s}=this;if(!e)return null;const a=n&&"initialViewProperties"in n&&n.initialViewProperties,o={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};e.effectiveLODs?o.zoom!==-1&&(o.scale=e.zoomToScale(o.zoom)):o.zoom=-1;let l=null,c=null,u=0;const d=o.viewpoint&&o.viewpoint.rotation,h=o.viewpoint&&o.viewpoint.targetGeometry;T(h)&&(h.type==="extent"?l=h:h.type==="point"&&(c=h,u=o.viewpoint.scale));const p=o.extent||l||((x=kt((b=a==null?void 0:a.viewpoint)==null?void 0:b.targetGeometry))==null?void 0:x.extent)||t,m=o.center||c||(p==null?void 0:p.center),g=o.scale||u||((w=a==null?void 0:a.viewpoint)==null?void 0:w.scale)||p&&wE(p,[s[0]-r.left-r.right,s[1]-r.top-r.bottom]),_=o.rotation||d||((C=a==null?void 0:a.viewpoint)==null?void 0:C.rotation)||0;return m&&g?new ga({targetGeometry:m,scale:g,rotation:_}):null}_gotoAnimated(e,t){const n=this._gotoTask,r=this.animation,s=e.then(a=>{if(Cn(t),n!==this._gotoTask)throw new Ze("view:goto-interrupted","Goto was interrupted");return r.update(a),this.animationManager.animate(r,this.viewpoint,t),r.when().then(()=>{},()=>{})});return this._cancellableGoTo(n,r,s)}_project(e,t){var s;const n=e&&e.targetGeometry||e;if(!t)return e;if(!n)return null;if(t.imageCoordinateSystem||(s=n.spatialReference)!=null&&s.imageCoordinateSystem||Vc(t,n.spatialReference))return e;const r=Bc(n,t);if(!r)throw new Ze("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:n,spatialReference:t});return tnt(e)?(e.targetGeometry=r,e):r}_resizeHandler(e){if(!this.ready)return;const t=this.state;let n=this.state.paddedViewState.viewpoint;const r=this.state.paddedViewState.size.concat();t.size=[e.width,e.height],Ltt(n,n,r,this.state.paddedViewState.size,this.resizeAlign),n=this.constraints.constrain(n,null),this.state.viewpoint=n}_startup(){var l,c;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint(),t=e.targetGeometry;try{this._project(e,this.spatialReference)}catch(u){tt.getLogger(this.declaredClass).warn(new bG("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:t.toJSON(),spatialReference:this.spatialReference,error:u})),e.targetGeometry=((l=this.defaultsFromMap.extent)==null?void 0:l.center)||new Wt({x:0,y:0,spatialReference:this.spatialReference})}(c=this.constraints)==null||c.fit(e),this._set("state",new Wtt({padding:this._get("padding"),size:this.size,viewpoint:e})),this.graphics.owner=this;const n=new Xde(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=n,this._magnifierView=new the,this._magnifierView.magnifier=this.magnifier;const r=new Jde({view:this});this._set("labelManager",r);const s=new Ntt({view:this});this._set("animationManager",s);const a=new ehe({view:this,animationManager:s});this._set("mapViewNavigation",a),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),n.on("post-render",()=>this._set("rendering",n.renderRequested)),n.on("will-render",()=>this._set("rendering",n.renderRequested)),n.on("webgl-error",u=>this.fatalError=u.error),ue(()=>this.stationary,u=>n.stationary=u,hn),ue(()=>this.background,u=>{n.background=u,this._magnifierView.background=u},hn),ue(()=>this.magnifier,u=>this._magnifierView.magnifier=u,hn),ue(()=>this.renderingOptions,u=>n.renderingOptions=u,hn),ue(()=>this.highlightOptions,u=>n.highlightOptions=u,hn),ue(()=>this.state.id,()=>n.state=this.state,hn)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[e,t],spatialReference:n,rotation:r,scale:s}=this.state.paddedViewState,a=new Wt({x:e,y:t,spatialReference:n});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",r),this._set("scale",s),this._set("spatialReference",n),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(t=>{this._stage.addChild(t.container)});const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new c0e(tE.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new Zde({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Qde(e)});this.frameTask.graphicsView=t,this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,e.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(e){if(!this.ready)return;this.frameTask.stop();for(const l of this.allLayerViews)l.processDetach();this._destroySpatialReferenceDependentProperties();const t=this.state.paddedViewState.clone();if(B(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=t.scale;else{const l=t.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,t.viewpoint=l}const n=t.clone(),[r,s]=t.center;let a=null;try{a=this._project(new Wt({x:r,y:s,spatialReference:t.spatialReference}),e)}catch(l){Y0()||tt.getLogger(this.declaredClass).warn(new bG("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:a.toJSON(),spatialReference:e,error:l}))}a||(a=new Wt({x:0,y:0,spatialReference:e}));const o=XV(new ga({targetGeometry:new Wt,scale:0,rotation:0}),t.viewpoint,a);n.viewpoint=o;try{const c=[t.size[0]/2,t.size[1]/2],u=[c[0]+20,c[1]],d=t.toMap([0,0],u),{x:h,y:p}=this._project(new Wt({x:d[0],y:d[1],spatialReference:t.spatialReference}),e);d[0]=h,d[1]=p,n.toScreen(d,d);const m=Itt(c,d,u),g=Math.hypot(d[0]-c[0],d[1]-c[1])/20;!Number.isFinite(g)||Math.abs(g)>4?(o.rotation=0,o.targetGeometry=new Wt({x:0,y:0,spatialReference:e})):(o.scale*=g,o.scale>Fi("mapview-srswitch-adjust-rotation-scale-threshold")?o.rotation=0:o.rotation+=Number.isFinite(m)?m:0)}catch{}this._get("constraints").constrain(o,null),this._get("state").viewpoint=o,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const l of this.allLayerViews)l.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};Ai.type="2d",f([y({readOnly:!0})],Ai.prototype,"animationManager",void 0),f([y({constructOnly:!0})],Ai.prototype,"deactivatedWebGLExtensions",void 0),f([y({constructOnly:!0})],Ai.prototype,"debugWebGLExtensions",void 0),f([y({readOnly:!0})],Ai.prototype,"featuresTilingScheme",void 0),f([y({readOnly:!0})],Ai.prototype,"fullOpacity",void 0),f([y({readOnly:!0})],Ai.prototype,"graphicsTileStore",null),f([y()],Ai.prototype,"graphicsView",void 0),f([y({readOnly:!0})],Ai.prototype,"state",void 0),f([y()],Ai.prototype,"initialExtentRequired",null),f([y()],Ai.prototype,"labelManager",void 0),f([y({readOnly:!0})],Ai.prototype,"resourceManager",null),f([y({readOnly:!0})],Ai.prototype,"textureManager",null),f([y({readOnly:!0})],Ai.prototype,"mapViewNavigation",void 0),f([y({constructOnly:!0})],Ai.prototype,"renderCanvas",void 0),f([y()],Ai.prototype,"renderingOptions",void 0),f([y({readOnly:!0})],Ai.prototype,"rendering",void 0),f([y({constructOnly:!0})],Ai.prototype,"supersampleScreenshotsEnabled",void 0),f([y({readOnly:!0})],Ai.prototype,"supportsGround",void 0),f([y()],Ai.prototype,"_stationaryTimer",void 0),f([y()],Ai.prototype,"_defaultsFromMapSettings",null),f([y()],Ai.prototype,"_pePromise",void 0),f([y({readOnly:!0})],Ai.prototype,"typeSpecificPreconditionsReady",null),f([y()],Ai.prototype,"animation",null),f([y({type:Jit})],Ai.prototype,"background",null),f([y({value:null,type:Wt,dependsOn:["state.id","ready"]})],Ai.prototype,"center",null),f([y({type:Ede})],Ai.prototype,"constraints",null),f([y({value:null,type:fs,dependsOn:["state.id","ready"]})],Ai.prototype,"extent",null),f([y()],Ai.prototype,"floors",void 0),f([y({type:$de})],Ai.prototype,"highlightOptions",void 0),f([y({readOnly:!0})],Ai.prototype,"inputManager",void 0),f([y()],Ai.prototype,"map",void 0),f([y({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],Ai.prototype,"padding",null),f([y()],Ai.prototype,"resizeAlign",void 0),f([y({readOnly:!0,dependsOn:["state.id"]})],Ai.prototype,"resolution",null),f([y({value:0,type:Number,dependsOn:["state.id","ready"]})],Ai.prototype,"rotation",null),f([y({value:0,type:Number,dependsOn:["state.id","ready"]})],Ai.prototype,"scale",null),f([y({constructOnly:!0})],Ai.prototype,"spatialReferenceLocked",void 0),f([y()],Ai.prototype,"stationary",null),f([y({type:Lde,readOnly:!0})],Ai.prototype,"timeline",void 0),f([y({readOnly:!0})],Ai.prototype,"type",void 0),f([y({readOnly:!0})],Ai.prototype,"updating",null),f([y({value:null,type:ga,dependsOn:["state.id","ready"]})],Ai.prototype,"viewpoint",null),f([y({value:-1,dependsOn:["state.id","ready"]})],Ai.prototype,"zoom",null),f([y({readOnly:!0})],Ai.prototype,"navigating",null),f([y({type:Yde})],Ai.prototype,"ui",void 0),Ai=f([ge("esri.views.MapView")],Ai);function a6(i){var t,n;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((n=i.sourceLayer)==null?void 0:n.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function aX(i,e,t,n,r){return s=>{if(s instanceof ao){if(s.layer===i)r==null||r();else{const a=i.allLayerViews.find(o=>o.layer===s.layer);a&&(n==null||n(a))}t(a6(s))}else{const a=i.allLayerViews.find(o=>o.layer===s);a&&e(a)}}}function oX(i,e){if(i)if(MN(i))for(const t of i)if(MN(t))for(const n of t)e(n);else e(t);else e(i)}function int(i){return(i==null?void 0:i.declaredClass)==="esri.WebMap"}const lF=tt.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");let ihe=class{constructor(){this.plane=Dr(),this.origin=q(),this.basis1=q(),this.basis2=q()}};function wg(i=phe){return{plane:Dr(i.plane),origin:Ts(i.origin),basis1:Ts(i.basis1),basis2:Ts(i.basis2)}}function nnt(i,e,t){const n=mnt.get();return n.origin=i,n.basis1=e,n.basis2=t,n.plane=F0e(0,0,0,0),eD(n),n}function $b(i,e=wg()){return OU(i.origin,i.basis1,i.basis2,e)}function rnt(i,e){Ge(e.origin,i.origin),Ge(e.basis1,i.basis1),Ge(e.basis2,i.basis2),nE(e.plane,i.plane)}function OU(i,e,t,n=wg()){return Ge(n.origin,i),Ge(n.basis1,e),Ge(n.basis2,t),eD(n),pnt(n,"fromValues()"),n}function eD(i){p2(i.basis2,i.basis1,i.origin,i.plane)}function nhe(i,e,t){i!==t&&$b(i,t);const n=Ye(si.get(),Jm(i),e);return rt(t.origin,t.origin,n),t.plane[3]-=e,t}function snt(i,e,t){return rhe(e,t),nhe(t,LU(i,i.origin),t),t}function rhe(i,e=wg()){const t=(i[2]-i[0])/2,n=(i[3]-i[1])/2;return je(e.origin,i[0]+t,i[1]+n,0),je(e.basis1,t,0,0),je(e.basis2,0,n,0),N0e(0,0,1,0,e.plane),e}function RU(i,e,t){return!!xb(i.plane,e,t)&&dhe(i,t)}function ant(i,e,t){if(RU(i,e,t))return t;const n=she(i,e,si.get());return rt(t,e.origin,Ye(si.get(),e.direction,Gn(e.origin,n)/Et(e.direction))),t}function she(i,e,t){const n=$$.get();hhe(i,e,n,$$.get());let r=Number.POSITIVE_INFINITY;for(const s of kU){const a=DU(i,s,tD.get()),o=si.get();if(V0e(n,a,o)){const l=Hm(si.get(),e.origin,o),c=Math.abs(Uo(dt(e.direction,l)));c<r&&(r=c,Ge(t,o))}}return r===Number.POSITIVE_INFINITY?ahe(i,e,t):t}function ahe(i,e,t){if(RU(i,e,t))return t;const n=$$.get(),r=$$.get();hhe(i,e,n,r);let s=Number.POSITIVE_INFINITY;for(const a of kU){const o=DU(i,a,tD.get()),l=si.get();if(B0e(n,o,l)){const c=w0e(e,l);if(!FB(r,l))continue;c<s&&(s=c,Ge(t,l))}}return IU(i,e.origin)<s&&ohe(i,e.origin,t),t}function ohe(i,e,t){const n=z0e(i.plane,e,si.get()),r=UG(lX(i,i.basis1),n,-1,1,si.get()),s=UG(lX(i,i.basis2),n,-1,1,si.get());return nt(t,rt(si.get(),r,s),i.origin),t}function lhe(i,e,t){const{origin:n,basis1:r,basis2:s}=i,a=nt(si.get(),e,n),o=L0(r,a),l=L0(s,a),c=L0(Jm(i),a);return je(t,o,l,c)}function IU(i,e){const t=lhe(i,e,si.get()),{basis1:n,basis2:r}=i,s=Et(n),a=Et(r),o=Math.max(Math.abs(t[0])-s,0),l=Math.max(Math.abs(t[1])-a,0),c=t[2];return o*o+l*l+c*c}function ont(i,e){return Math.sqrt(IU(i,e))}function lnt(i,e){let t=Number.NEGATIVE_INFINITY;for(const n of kU){const r=DU(i,n,tD.get()),s=kB(r,e);s>t&&(t=s)}return Math.sqrt(t)}function $U(i,e){return FB(i.plane,e)&&dhe(i,e)}function cnt(i,e,t,n){return hnt(i,t,n)}function LU(i,e){const t=-i.plane[3];return L0(Jm(i),e)-t}function unt(i,e,t,n){const r=LU(i,e),s=Ye(fnt,Jm(i),t-r);return rt(n,e,s),n}function che(i,e){return uh(i.basis1,e.basis1)&&uh(i.basis2,e.basis2)&&uh(i.origin,e.origin)}function uhe(i,e,t){return i!==t&&$b(i,t),Da(n1,e),$B(n1,n1),$t(t.basis1,i.basis1,n1),$t(t.basis2,i.basis2,n1),$t(ro(t.plane),ro(i.plane),n1),$t(t.origin,i.origin,e),qN(t.plane,t.plane,t.origin),t}function dnt(i,e,t,n){return i!==n&&$b(i,n),Mh(cF,e,t),$t(n.basis1,i.basis1,cF),$t(n.basis2,i.basis2,cF),eD(n),n}function Jm(i){return ro(i.plane)}function hnt(i,e,t){switch(e){case dh.X:Ge(t,i.basis1),mt(t,t);break;case dh.Y:Ge(t,i.basis2),mt(t,t);break;case dh.Z:Ge(t,Jm(i))}return t}function dhe(i,e){const t=nt(si.get(),e,i.origin),n=dd(i.basis1),r=dd(i.basis2),s=dt(i.basis1,t),a=dt(i.basis2,t);return-s-n<0&&s-n<0&&-a-r<0&&a-r<0}function lX(i,e){const t=tD.get();return Ge(t.origin,i.origin),Ge(t.vector,e),t}function DU(i,e,t){const{basis1:n,basis2:r,origin:s}=i,a=Ye(si.get(),n,e.origin[0]),o=Ye(si.get(),r,e.origin[1]);rt(t.origin,a,o),rt(t.origin,t.origin,s);const l=Ye(si.get(),n,e.direction[0]),c=Ye(si.get(),r,e.direction[1]);return Ye(t.vector,rt(l,l,c),2),t}function pnt(i,e){Math.abs(dt(i.basis1,i.basis2)/(Et(i.basis1)*Et(i.basis2)))>1e-6&&lF.warn(e,"Provided basis vectors are not perpendicular"),Math.abs(dt(i.basis1,Jm(i)))>1e-6&&lF.warn(e,"Basis vectors and plane normal are not perpendicular"),Math.abs(-dt(Jm(i),i.origin)-i.plane[3])>1e-6&&lF.warn(e,"Plane offset is not consistent with plane origin")}function hhe(i,e,t,n){const r=Jm(i);p2(r,e.direction,e.origin,t),p2(ro(t),r,e.origin,n)}const phe={plane:Dr(),origin:Gt(0,0,0),basis1:Gt(1,0,0),basis2:Gt(0,1,0)},$$=new MB(Dr),tD=new MB($C),fnt=q(),mnt=new MB(()=>wg()),kU=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],n1=St(),cF=St(),gnt=Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:ihe,create:wg,wrap:nnt,copy:$b,copyWithoutVerify:rnt,fromValues:OU,updateUnboundedPlane:eD,elevate:nhe,setExtent:snt,fromAABoundingRect:rhe,intersectRay:RU,intersectRayClosestSilhouette:ant,closestPointOnSilhouette:she,closestPoint:ahe,projectPoint:ohe,projectPointLocal:lhe,distance2:IU,distance:ont,distanceToSilhouette:lnt,extrusionContainsPoint:$U,axisAt:cnt,altitudeAt:LU,setAltitudeAt:unt,equals:che,transform:uhe,rotate:dnt,normal:Jm,UP:phe},Symbol.toStringTag,{value:"Module"}));function vnt(i){const{value:e,operations:t}=i;return{operations:t,value:t.create(e)}}function ynt(i,e,t){return i.operations.setExtent(i.value,e,t.value),t}function _nt(i){return{operations:i,value:i.create()}}function fhe(i,e,t=_nt(i)){return t.operations=i,i.copy(e,t.value),t}function bnt(i){return fhe(C0e,x0e(0,0,0,rn(i).radius))}const cX=2**50;function wnt(){return fhe(gnt,OU([0,0,0],[cX,0,0],[0,cX,0]))}function xnt(i,e,t){return i.operations.axisAt(i.value,e,dh.Z,t)}function Cnt(i,e,t,n){return i.operations.axisAt(i.value,e,t,n)}function Tnt(i,e,t){return i.operations.intersectRay(i.value,e,t)}function Snt(i,e,t){return i.operations.intersectRayClosestSilhouette(i.value,e,t)}function Ent(i,e){return i.operations.altitudeAt(i.value,e)}function mhe(i,e,t,n){return i.operations.setAltitudeAt(i.value,e,t,n)}function Ant(i,e,t,n){return e!==n&&da(n,e),je(r1,n[12],n[13],n[14]),mhe(i,r1,t,r1),n[12]=r1[0],n[13]=r1[1],n[14]=r1[2],n}function uF(i,e,t){return i.operations.elevate(i.value,e,t.value)}const r1=q();function uX(i,e,t,n,r){return r[0]=dt(i,e),r[1]=dt(i,t),r[2]=dt(i,n),r}function o6(i,e,t,n,r){Ge(t,i),Ge(pP,e),mt(pP,pP),vi(n,pP,t),vi(r,n,t)}function ghe(i,e){return i?e_e(e):e.isGeographic?$n.PlateCarree:e}const pP=q(),Mnt=12;let ur=class{constructor(e){const t=ur.checkUnsupported(e);if(T(t))throw t;const n=kt(e);this.spatialReference=n.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=X0(this.spatialReference)||zA(this.spatialReference)||UA(this.spatialReference),this.origin=[n.origin.x,n.origin.y],this.pixelSize=n.size[0],this.dpi=n.dpi;const r=n.lods.reduce((c,u,d)=>(u.level<c.min&&(c.min=u.level,c.minIndex=d),c.max=Math.max(c.max,u.level),c),{min:1/0,minIndex:0,max:-1/0}),s=n.lods[r.minIndex],a=2**s.level;let o=s.resolution*a,l=s.scale*a;this.levels=new Array(r.max+1);for(let c=0;c<this.levels.length;c++)this.levels[c]={resolution:o,scale:l,tileSize:[o*n.size[0],o*n.size[1]]},o/=2,l/=2}clone(){return new ur(this.toTileInfo())}toTileInfo(){return new tE({dpi:this.dpi,origin:{x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference},size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map((e,t)=>({level:t,scale:e.scale,resolution:e.resolution}))})}getExtent(e,t,n,r){const s=this.levels[e],a=s.tileSize[0],o=s.tileSize[1];r[0]=this.origin[0]+n*a,r[2]=this.origin[0]+(n+1)*a,r[3]=this.origin[1]-t*o,r[1]=this.origin[1]-(t+1)*o}convertExtentToRadians(e,t){this._isWebMercator?(t[0]=TG(e[0]),t[1]=ON(e[1]),t[2]=TG(e[2]),t[3]=ON(e[3])):this._isGCS&&(t[0]=zi(e[0]),t[1]=zi(e[1]),t[2]=zi(e[2]),t[3]=zi(e[3]))}getExtentGeometry(e,t,n,r=new fs){return this.getExtent(e,t,n,Gh),r.spatialReference=this.spatialReference,r.xmin=Gh[0],r.ymin=Gh[1],r.xmax=Gh[2],r.ymax=Gh[3],r.zmin=void 0,r.zmax=void 0,r}ensureMaxLod(e){if(e==null)return!1;let t=!1;for(;this.levels.length<=e;){const n=this.levels[this.levels.length-1],r=n.resolution/2;this.levels.push({resolution:r,scale:n.scale/2,tileSize:[r*this.pixelSize,r*this.pixelSize]}),t=!0}return t}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/2**e}levelAtScale(e){const t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/2**e}compatibleWith(e){if(!(e instanceof ur)){if(ur.checkUnsupported(e))return!1;e=new ur(e)}if(!e.spatialReference.equals(this.spatialReference)||e.pixelSize!==this.pixelSize)return!1;const t=Math.min(this.levels.length,e.levels.length)-1,n=this.levels[t].resolution;let r=.5*n;return!Hp(e.origin[0],this.origin[0],r)||!Hp(e.origin[1],this.origin[1],r)?!1:(r=.5*n/2**t/this.pixelSize*Mnt,Hp(n,e.levels[t].resolution,r))}rootTilesInExtent(e,t=null,n=1/0){const r=new Array,s=this.levels[0].tileSize;if(B(e)||s[0]===0||s[1]===0)return r;ur.computeRowColExtent(e,s,this.origin,Gh);let a=Gh[1],o=Gh[3],l=Gh[0],c=Gh[2];const u=c-l,d=o-a;if(u*d>n){const h=Math.floor(Math.sqrt(n));d>h&&(a=a+Math.floor(.5*d)-Math.floor(.5*h),o=a+h),u>h&&(l=l+Math.floor(.5*u)-Math.floor(.5*h),c=l+h)}for(let h=a;h<o;h++)for(let p=l;p<c;p++)r.push([0,h,p]);return T(t)&&(t[0]=this.origin[0]+l*s[0],t[1]=this.origin[1]-o*s[1],t[2]=this.origin[0]+c*s[0],t[3]=this.origin[1]-a*s[1]),r}static computeRowColExtent(e,t,n,r){const s=.001*(e[2]-e[0]+(e[3]-e[1]));r[0]=Math.max(0,Math.floor((e[0]+s-n[0])/t[0])),r[2]=Math.max(0,Math.ceil((e[2]-s-n[0])/t[0])),r[1]=Math.max(0,Math.floor((n[1]-e[3]+s)/t[1])),r[3]=Math.max(0,Math.ceil((n[1]-e[1]-s)/t[1]))}static isPowerOfTwo(e){const t=e.lods,n=t[0].resolution*2**t[0].level;return!t.some(r=>!Nye(r.resolution,n/2**r.level))}static hasGapInLevels(e){const t=e.lods.map(n=>n.level);t.sort((n,r)=>n-r);for(let n=1;n<t.length;n++)if(t[n]!==t[0]+n)return!0;return!1}static tileSizeSupported(e){const t=e.size[1];return t===e.size[0]&&(t&t-1)==0&&t>=128&&t<=512}static hasOriginPerLODs(e){const t=e.origin;return e.lods.some(n=>n.origin!=null&&(n.origin[0]!==t.x||n.origin[1]!==t.y))}static getMissingTileInfoError(){return new Ze("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(e){return B(e)?FU():e.lods.length<1?new Ze("tilingscheme:generic","Tiling scheme must have at least one level"):ur.isPowerOfTwo(e)?ur.hasGapInLevels(e)?new Ze("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):ur.tileSizeSupported(e)?ur.hasOriginPerLODs(e)?new Ze("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new Ze("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new Ze("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(e,t){const n=e[2]-e[0],r=e[3]-e[1],s=rf(t),a=1.2*Math.max(n,r),o=256,l=96,c=.0254,u=new ur(new tE({size:[o,o],origin:{x:e[0]-.5*(a-n),y:e[3]+.5*(a-r)},lods:[{level:0,resolution:a/o,scale:1/(o/l*c/(a*s))}],spatialReference:t}));return u.ensureMaxLod(20),u}static makeWebMercatorAuxiliarySphere(e){const t=new ur(ur.WebMercatorAuxiliarySphereTileInfo);return t.ensureMaxLod(e),t}static makeGCSWithTileSize(e,t=256,n=16){const r=256/t,s=new ur(new tE({size:[t,t],origin:{x:-180,y:90,spatialReference:e},spatialReference:e,lods:[{level:0,resolution:.703125*r,scale:295497598570834e-6*r}]}));return s.ensureMaxLod(n),s}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}};function FU(){return new Ze("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}ur.WebMercatorAuxiliarySphereTileInfo=new tE({size:[256,256],origin:{x:-20037508342787e-6,y:20037508342787e-6,spatialReference:$n.WebMercator},spatialReference:$n.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:591657527591555e-6}]}),ur.WebMercatorAuxiliarySphere=ur.makeWebMercatorAuxiliarySphere(19);const Gh=qi(),Bw=64,bS=512,Pnt=2.5,lA=Vye(Bye/10),vhe=4,yhe=qi();ur.WebMercatorAuxiliarySphere.getExtent(0,0,0,yhe);const Ont=qi([-180,-90,180,90]),Rnt="Cannot extend surface to encompass all layers because it would result in too many root tiles.",Int="Surface extent is too large for tile resolution at level 0.";let $nt=4;const JR=i=>i<4?3:$nt;let fv=class extends Pn.EventedAccessor{constructor(e){super(e),this.demResolution={min:-1,max:-1},this.noDataValue=lA}initialize(){this.view.basemapTerrain.on("elevation-change",()=>this.emit("changed",{}))}get extent(){const e=this.view.basemapTerrain;if(B(e.extent)||B(e.spatialReference))return null;const t=nne(e.extent,e.spatialReference);return t.zmin=e.visibleElevationBounds.min,t.zmax=e.visibleElevationBounds.max,t}get spatialReference(){return Jt(this.view.basemapTerrain.spatialReference,$n.WGS84)}elevationAt(e,t){if(B(this.extent)||!yye(this.extent,e,t)){const n=T(this.extent)?`${this.extent.xmin}, ${this.extent.ymin}, ${this.extent.xmax}, ${this.extent.ymax}`:null;return tt.getLogger(this.declaredClass).warn("#elevationAt()",`Point used to sample elevation (${e}, ${t}) is outside of the sampler extent (${n})`),this.noDataValue}return Jt(this.view.elevationProvider.getElevation(e,t,0,this.spatialReference,"ground"),this.noDataValue)}queryElevation(e){return Y0e(e.clone(),this)}};f([y({readOnly:!0})],fv.prototype,"demResolution",void 0),f([y({readOnly:!0})],fv.prototype,"extent",null),f([y({readOnly:!0})],fv.prototype,"noDataValue",void 0),f([y()],fv.prototype,"spatialReference",null),f([y({constructOnly:!0})],fv.prototype,"view",void 0),fv=f([ge("esri.views.support.GroundViewElevationSampler")],fv);const Lnt=fv;let mv=class extends et{constructor(e){super(e),this._handles=new mi,this.view=null,this.layerViews=new _i}initialize(){this._handles.add(rs(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground},e=>e.load())),this._handles.add(this.layerViews.on("after-changes",()=>this._layerViewsAfterChangesHandler()))}destroy(){this._set("view",null),this._handles&&(this._handles.destroy(),this._handles=null)}get elevationSampler(){return this.view?this.view.type==="2d"?null:this.view.ready&&this.view.basemapTerrain&&this.view.basemapTerrain.ready?new Lnt({view:this.view}):null:null}get updating(){return!this.suspended&&this.layerViews.some(e=>e.updating)}get suspended(){return!this.view||this.view.suspended}_layerViewsAfterChangesHandler(){this._handles.remove("updating"),this._handles.add(this.layerViews.map(e=>ue(()=>e.updating,()=>this._updateUpdating(),on)).toArray(),"updating"),this._updateUpdating()}_updateUpdating(){this.notifyChange("updating")}};f([y({readOnly:!0})],mv.prototype,"elevationSampler",null),f([y({type:Boolean,readOnly:!0})],mv.prototype,"updating",null),f([y({constructOnly:!0})],mv.prototype,"view",void 0),f([y({type:_i,readOnly:!0})],mv.prototype,"layerViews",void 0),f([y({readOnly:!0})],mv.prototype,"suspended",null),mv=f([ge("esri.views.GroundView")],mv);const Dnt=mv,MT=()=>Ee(()=>import("./TileLayerView3D-12690e2a.js"),["./TileLayerView3D-12690e2a.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./Polyline-bf268e7b.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./LayerView3D-9d740636.js","./reactiveUtils-f41a4e00.js","./TiledLayerView3D-ef836553.js","./LayerView-b83ced89.js","./Evented-515b9d9c.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./TileLayerView-71fcdeb9.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),dX=()=>Ee(()=>import("./ElevationLayerView3D-d3707099.js"),["./ElevationLayerView3D-d3707099.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./LayerView3D-9d740636.js","./reactiveUtils-f41a4e00.js","./TiledLayerView3D-ef836553.js","./LayerView-b83ced89.js","./Evented-515b9d9c.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),hX={"base-dynamic":()=>Ee(()=>import("./BaseDynamicLayerView3D-9e4ee44e.js"),["./BaseDynamicLayerView3D-9e4ee44e.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./DynamicLayerView3D-97fd58f5.js","./asyncUtils-62e8a185.js","./reactiveUtils-f41a4e00.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./LayerView3D-9d740636.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./mat3f64-c6305894.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./aaBoundingBox-fc742a4e.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./byteSizeEstimations-f0cab514.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./assets-0b172f07.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./projectExtentUtils-9adea3ba.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"base-elevation":dX,"base-tile":MT,"bing-maps":MT,"building-scene":()=>Ee(()=>import("./BuildingSceneLayerView3D-3f6463ec.js"),["./BuildingSceneLayerView3D-3f6463ec.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./BuildingGroupSublayer-e396dfb3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./BuildingComponentSublayer-80f74d57.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./TimeExtent-744afd75.js","./ElevationInfo-ce9cacc2.js","./RelationshipQuery-db5fcd0c.js","./Query-ff8c2cfb.js","./Layer-f0696768.js","./HandleOwner-e1406413.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./assets-0b172f07.js","./intl-f1e98361.js","./messages-be07754e.js","./editsZScale-2015e7db.js","./queryZScale-d9d8ef40.js","./zscale-1e1fc911.js","./FeatureSet-0573546e.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./PortalItem-aa42c739.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./TopFeaturesQuery-785f5453.js","./popupUtils-07fe66a7.js","./capabilities-a18453f6.js","./I3SIndexInfo-acc8ea15.js","./I3SLayerDefinitions-f6c057a8.js","./I3SUtil-3ffd3baa.js","./mat3-3fc68e72.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./I3SBinaryReader-3d2c2faa.js","./VertexAttribute-9c5c630d.js","./projection-d7b57a6c.js","./ViewingMode-5d7d590b.js","./symbolColorUtils-604c5345.js","./vec3f32-c9aa289f.js","./plane-45609588.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./vec2f64-30dc1443.js","./popupUtils-e8f3d062.js","./WhereClause-2b5b05b2.js","./I3SMeshView3D-4e176d72.js","./mat3f32-d3d088e8.js","./I3SOverrides-02bb416c.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./Scheduler-8433672d.js","./I3SNode-42b7a44e.js","./RenderTexture-efcfcb1e.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./AlphaCutoff-96178e0d.js","./Texture-bbae5d9d.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./Util-a48361c6.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Octree-1a841545.js","./FeatureLayerView3D-23021139.js","./FeatureLayerViewBase3D-f9a2841f.js","./FeatureLikeLayerView3D-e095b99c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./hash-0ddfbf4b.js","./Graphics3DObjectStates-2cd67a8a.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./vec2f32-461e65a9.js","./lineSegment-e6f72ff2.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./LercDecoder-73115fd2.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js","./SceneModification-17ca2be5.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./SceneLayerWorker-dd02c2a0.js","./I3SQueryFeatureStore-f22918fe.js","./DefinitionExpressionSceneLayerView-5a30c6e1.js"],import.meta.url),csv:()=>Ee(()=>import("./CSVLayerView3D-193c83af.js"),["./CSVLayerView3D-193c83af.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./FeatureLayerViewBase3D-f9a2841f.js","./reactiveUtils-f41a4e00.js","./FeatureLikeLayerView3D-e095b99c.js","./asyncUtils-62e8a185.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./Promise-dfdee8ba.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./persistableUrlUtils-a16d0f55.js","./Query-ff8c2cfb.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./quantizationUtils-33aba427.js","./ViewingMode-5d7d590b.js","./Scheduler-8433672d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./assets-0b172f07.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./hash-0ddfbf4b.js","./compilerUtils-034cacb8.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./mat4f64-1e28eae0.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),dimension:()=>Ee(()=>import("./DimensionLayerView3D-1616b387.js"),["./DimensionLayerView3D-1616b387.js","./preload-helper-41c905a7.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./asyncUtils-62e8a185.js","./reactiveUtils-f41a4e00.js","./LayerView3D-9d740636.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./Basemap-a8f7f439.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),elevation:dX,feature:()=>Ee(()=>import("./FeatureLayerView3D-23021139.js"),["./FeatureLayerView3D-23021139.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./Polyline-bf268e7b.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./styleUtils-4adfed9e.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./FeatureLayerViewBase3D-f9a2841f.js","./reactiveUtils-f41a4e00.js","./FeatureLikeLayerView3D-e095b99c.js","./asyncUtils-62e8a185.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./persistableUrlUtils-a16d0f55.js","./Query-ff8c2cfb.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./quantizationUtils-33aba427.js","./ViewingMode-5d7d590b.js","./Scheduler-8433672d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./hash-0ddfbf4b.js","./compilerUtils-034cacb8.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./mat4f64-1e28eae0.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),geojson:()=>Ee(()=>import("./GeoJSONLayerView3D-9c624890.js"),["./GeoJSONLayerView3D-9c624890.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./FeatureLayerViewBase3D-f9a2841f.js","./reactiveUtils-f41a4e00.js","./FeatureLikeLayerView3D-e095b99c.js","./asyncUtils-62e8a185.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./Promise-dfdee8ba.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./persistableUrlUtils-a16d0f55.js","./Query-ff8c2cfb.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./quantizationUtils-33aba427.js","./ViewingMode-5d7d590b.js","./Scheduler-8433672d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./assets-0b172f07.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./hash-0ddfbf4b.js","./compilerUtils-034cacb8.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./mat4f64-1e28eae0.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),graphics:()=>Ee(()=>import("./GraphicsLayerView3D-c4638a97.js"),["./GraphicsLayerView3D-c4638a97.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./LayerView3D-9d740636.js","./queryForSymbologySnapping-f3902574.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./GraphicsProcessor-8dba02d6.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./diffUtils-1ac65748.js","./Layer-f0696768.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Graphics3DObjectStates-2cd67a8a.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./asyncUtils-62e8a185.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./Scheduler-8433672d.js","./projectExtentUtils-9adea3ba.js","./LayerView-b83ced89.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),group:()=>Ee(()=>import("./GroupLayerView-e2c80272.js"),["./GroupLayerView-e2c80272.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./reactiveUtils-f41a4e00.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js"],import.meta.url),imagery:()=>Ee(()=>import("./ImageryLayerView3D-65903b44.js"),["./ImageryLayerView3D-65903b44.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./DynamicLayerView3D-97fd58f5.js","./asyncUtils-62e8a185.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./LayerView3D-9d740636.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./mat3f64-c6305894.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./aaBoundingBox-fc742a4e.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./byteSizeEstimations-f0cab514.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./assets-0b172f07.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./projectExtentUtils-9adea3ba.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./ImageryLayerView-a754e4c1.js","./OperationalLayer-24e6fa34.js","./TimeExtent-744afd75.js","./persistableUrlUtils-a16d0f55.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./opacityUtils-243aae26.js","./Query-ff8c2cfb.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./popupUtils-e8f3d062.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"integrated-mesh":()=>Ee(()=>import("./IntegratedMeshLayerView3D-ee3e9e55.js"),["./IntegratedMeshLayerView3D-ee3e9e55.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./I3SMeshView3D-4e176d72.js","./byteSizeEstimations-f0cab514.js","./unitUtils-47abac71.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./I3SOverrides-02bb416c.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Scheduler-8433672d.js","./ViewingMode-5d7d590b.js","./I3SNode-42b7a44e.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./I3SUtil-3ffd3baa.js","./quat-5b263584.js","./I3SBinaryReader-3d2c2faa.js","./VertexAttribute-9c5c630d.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./symbolColorUtils-604c5345.js","./vec3f32-c9aa289f.js","./plane-45609588.js","./asyncUtils-62e8a185.js","./RenderTexture-efcfcb1e.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./compilerUtils-034cacb8.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./AlphaCutoff-96178e0d.js","./Texture-bbae5d9d.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./Util-a48361c6.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Octree-1a841545.js","./styleUtils-4adfed9e.js","./FeatureLayerView3D-23021139.js","./FeatureLayerViewBase3D-f9a2841f.js","./FeatureLikeLayerView3D-e095b99c.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./hash-0ddfbf4b.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./vec2f32-461e65a9.js","./lineSegment-e6f72ff2.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js","./SceneModification-17ca2be5.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./SceneLayerWorker-dd02c2a0.js"],import.meta.url),"line-of-sight":()=>Ee(()=>import("./LineOfSightLayerView3D-cbac9424.js"),["./LineOfSightLayerView3D-cbac9424.js","./preload-helper-41c905a7.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./asyncUtils-62e8a185.js","./reactiveUtils-f41a4e00.js","./LayerView3D-9d740636.js","./LayerView-b83ced89.js","./Evented-515b9d9c.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"map-image":()=>Ee(()=>import("./MapImageLayerView3D-52d4fe11.js"),["./MapImageLayerView3D-52d4fe11.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./DynamicLayerView3D-97fd58f5.js","./asyncUtils-62e8a185.js","./reactiveUtils-f41a4e00.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./LayerView3D-9d740636.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./mat3f64-c6305894.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./aaBoundingBox-fc742a4e.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./byteSizeEstimations-f0cab514.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./assets-0b172f07.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./projectExtentUtils-9adea3ba.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./MapImageLayerView-d2265098.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./enumeration-3c281341.js","./jsonMap-c1f958cf.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./Clonable-ba795b08.js","./unitUtils-47abac71.js","./scaleUtils-b32a50d8.js","./OperationalLayer-24e6fa34.js","./TimeExtent-744afd75.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./normalizeUtils-ee4bf39f.js","./jsonUtils-03c4af61.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ScaleRangeLayer-271178b7.js","./popupUtils-e8f3d062.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),media:()=>Ee(()=>import("./MediaLayerView3D-92648895.js"),["./MediaLayerView3D-92648895.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./mediaUtils-d2f5e3a2.js","./Polyline-bf268e7b.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./assets-0b172f07.js","./request-d3e98716.js","./zscale-1e1fc911.js","./normalizeUtilsSync-9c84b89e.js","./jsonUtils-03c4af61.js","./normalizeUtils-ee4bf39f.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./LayerView3D-9d740636.js","./basicInterfaces-19ed850e.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./aaBoundingBox-fc742a4e.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./asyncUtils-62e8a185.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./byteSizeEstimations-f0cab514.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"ogc-feature":()=>Ee(()=>import("./OGCFeatureLayerView3D-259c54e9.js"),["./OGCFeatureLayerView3D-259c54e9.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./FeatureLayerViewBase3D-f9a2841f.js","./reactiveUtils-f41a4e00.js","./FeatureLikeLayerView3D-e095b99c.js","./asyncUtils-62e8a185.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./Promise-dfdee8ba.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./persistableUrlUtils-a16d0f55.js","./Query-ff8c2cfb.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./quantizationUtils-33aba427.js","./ViewingMode-5d7d590b.js","./Scheduler-8433672d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./assets-0b172f07.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./hash-0ddfbf4b.js","./compilerUtils-034cacb8.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./mat4f64-1e28eae0.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./OGCFeatureLayerView-848f8dcf.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"open-street-map":MT,"oriented-imagery":()=>Ee(()=>import("./FeatureLayerView3D-23021139.js"),["./FeatureLayerView3D-23021139.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./Polyline-bf268e7b.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./styleUtils-4adfed9e.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./FeatureLayerViewBase3D-f9a2841f.js","./reactiveUtils-f41a4e00.js","./FeatureLikeLayerView3D-e095b99c.js","./asyncUtils-62e8a185.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./persistableUrlUtils-a16d0f55.js","./Query-ff8c2cfb.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./quantizationUtils-33aba427.js","./ViewingMode-5d7d590b.js","./Scheduler-8433672d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./hash-0ddfbf4b.js","./compilerUtils-034cacb8.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./mat4f64-1e28eae0.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"point-cloud":()=>Ee(()=>import("./PointCloudLayerView3D-f3c1758a.js").then(i=>i.P),["./PointCloudLayerView3D-f3c1758a.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./asyncUtils-62e8a185.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./reactiveUtils-f41a4e00.js","./screenUtils-410d12c0.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec3f32-c9aa289f.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./mat4-44a0988f.js","./Polyline-bf268e7b.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./aaBoundingBox-fc742a4e.js","./plane-45609588.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./typeUtils-eb9416d0.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Scheduler-8433672d.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./LayerView3D-9d740636.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./number-347a3a44.js","./locale-30120714.js","./messages-be07754e.js","./I3SUtil-3ffd3baa.js","./mat3-3fc68e72.js","./quat-5b263584.js","./I3SBinaryReader-3d2c2faa.js","./VertexAttribute-9c5c630d.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Clonable-ba795b08.js","./ViewingMode-5d7d590b.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./symbolColorUtils-604c5345.js","./PointCloudWorkerUtil-e1c8092b.js","./PointCloudUniqueValueRenderer-fed7b0dd.js","./LegendOptions-e65e7a9c.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./basicInterfaces-19ed850e.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./Util-a48361c6.js","./vec2-2cef68de.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./Texture2DPassUniform-6e8ae673.js","./Slice.glsl-a612de15.js","./OutputHighlight.glsl-7364b03b.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./ShaderTechniqueConfiguration-9f5b4555.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./PopupSceneLayerView-394d8bbf.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js"],import.meta.url),voxel:()=>Ee(()=>import("./VoxelLayerView3D-a3500b92.js"),["./VoxelLayerView3D-a3500b92.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./LayerView3D-9d740636.js","./LayerView-b83ced89.js","./Evented-515b9d9c.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./context-util-1e3c8cfc.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),route:()=>Ee(()=>import("./RouteLayerView3D-8d84815a.js"),["./RouteLayerView3D-8d84815a.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./CollectionFlattener-3dd1f479.js","./reactiveUtils-f41a4e00.js","./Stop-ac044e9e.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./LayerView3D-9d740636.js","./GraphicsProcessor-8dba02d6.js","./HandleOwner-e1406413.js","./diffUtils-1ac65748.js","./Layer-f0696768.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Graphics3DObjectStates-2cd67a8a.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./quantizationUtils-33aba427.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./asyncUtils-62e8a185.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./ElevationInfo-ce9cacc2.js","./basicInterfaces-19ed850e.js","./Scheduler-8433672d.js","./projectExtentUtils-9adea3ba.js","./EventedSet-7223bfeb.js","./LayerView-b83ced89.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),scene:i=>i.profile==null||i.profile==="mesh-pyramids"?Ee(()=>import("./SceneLayerView3D-fd22a842.js"),["./SceneLayerView3D-fd22a842.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./WhereClause-2b5b05b2.js","./FeatureReductionLayer-4077b2ae.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./TimeExtent-744afd75.js","./Query-ff8c2cfb.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./ExportImageParameters-f328a234.js","./HandleOwner-e1406413.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./I3SMeshView3D-4e176d72.js","./byteSizeEstimations-f0cab514.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./mat4f64-1e28eae0.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./I3SOverrides-02bb416c.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./Scheduler-8433672d.js","./ViewingMode-5d7d590b.js","./I3SNode-42b7a44e.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./I3SUtil-3ffd3baa.js","./quat-5b263584.js","./I3SBinaryReader-3d2c2faa.js","./VertexAttribute-9c5c630d.js","./symbolColorUtils-604c5345.js","./vec3f32-c9aa289f.js","./plane-45609588.js","./asyncUtils-62e8a185.js","./RenderTexture-efcfcb1e.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./AlphaCutoff-96178e0d.js","./Texture-bbae5d9d.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./Util-a48361c6.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Octree-1a841545.js","./FeatureLayerView3D-23021139.js","./FeatureLayerViewBase3D-f9a2841f.js","./FeatureLikeLayerView3D-e095b99c.js","./arcgisLayerUrl-0b2b7691.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./hash-0ddfbf4b.js","./Graphics3DObjectStates-2cd67a8a.js","./Layer-f0696768.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./vec2f32-461e65a9.js","./lineSegment-e6f72ff2.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js","./SceneModification-17ca2be5.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./SceneLayerWorker-dd02c2a0.js","./SceneLayerView-f66e8829.js","./DefinitionExpressionSceneLayerView-5a30c6e1.js","./I3SQueryFeatureStore-f22918fe.js","./PopupSceneLayerView-394d8bbf.js"],import.meta.url):Ee(()=>import("./SceneLayerGraphicsView3D-4daf0bad.js"),["./SceneLayerGraphicsView3D-4daf0bad.js","./preload-helper-41c905a7.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./quantizationUtils-33aba427.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./I3SOverrides-02bb416c.js","./Scheduler-8433672d.js","./ViewingMode-5d7d590b.js","./vec4f64-e407da96.js","./I3SNode-42b7a44e.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./I3SUtil-3ffd3baa.js","./mat3-3fc68e72.js","./quat-5b263584.js","./I3SBinaryReader-3d2c2faa.js","./VertexAttribute-9c5c630d.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./symbolColorUtils-604c5345.js","./vec3f32-c9aa289f.js","./plane-45609588.js","./asyncUtils-62e8a185.js","./RenderTexture-efcfcb1e.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./compilerUtils-034cacb8.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./AlphaCutoff-96178e0d.js","./Texture-bbae5d9d.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./Util-a48361c6.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Octree-1a841545.js","./styleUtils-4adfed9e.js","./FeatureLayerView3D-23021139.js","./FeatureLayerViewBase3D-f9a2841f.js","./FeatureLikeLayerView3D-e095b99c.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./hash-0ddfbf4b.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./lineSegment-e6f72ff2.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js","./SceneLayerView-f66e8829.js","./DefinitionExpressionSceneLayerView-5a30c6e1.js","./PopupSceneLayerView-394d8bbf.js"],import.meta.url),stream:()=>Ee(()=>import("./StreamLayerView3D-2e618891.js"),["./StreamLayerView3D-2e618891.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./HandleOwner-e1406413.js","./StreamFeatureManager-3d9d6b32.js","./CircularArray-cf56c6b0.js","./createConnection-960a5f5a.js","./zscale-1e1fc911.js","./unitUtils-47abac71.js","./query-922e6fbf.js","./normalizeUtils-ee4bf39f.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./EventedSet-7223bfeb.js","./FeatureLikeLayerView3D-e095b99c.js","./asyncUtils-62e8a185.js","./arcgisLayerUrl-0b2b7691.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./quantizationUtils-33aba427.js","./ViewingMode-5d7d590b.js","./Scheduler-8433672d.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./assets-0b172f07.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./hash-0ddfbf4b.js","./compilerUtils-034cacb8.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./featureConversionUtils-01cdde8a.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./mat4f64-1e28eae0.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./LayerView-b83ced89.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),tile:MT,"imagery-tile":()=>Ee(()=>import("./ImageryTileLayerView3D-96802c36.js"),["./ImageryTileLayerView3D-96802c36.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./LayerView3D-9d740636.js","./TiledLayerView3D-ef836553.js","./ImageryTileLayerView-283faa2a.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./OperationalLayer-24e6fa34.js","./TimeExtent-744afd75.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./rasterProjectionHelper-967d22a7.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./RefreshableLayerView-1faf24ee.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"vector-tile":()=>Ee(()=>import("./VectorTileLayerView3D-3d37d06e.js"),["./VectorTileLayerView3D-3d37d06e.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./MemCache-4b976a8b.js","./mat3f32-d3d088e8.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./TileInfoViewPOT-de1d9d50.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./assets-0b172f07.js","./intl-f1e98361.js","./number-347a3a44.js","./jsonMap-c1f958cf.js","./locale-30120714.js","./messages-be07754e.js","./Rect-ea14f53a.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./pbf-e1a6c35b.js","./rasterizingUtils-133923fb.js","./floatRGBA-fa8308d2.js","./TileKey-0750ad58.js","./config-1337d16e.js","./StyleDefinition-7d58136b.js","./enums-4b2a86a0.js","./TileInfo-34f80a8e.js","./unitUtils-47abac71.js","./TileStore-787dbea4.js","./Evented-515b9d9c.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./Query-ff8c2cfb.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./WGLBrushVTLSymbol-dcfd88b4.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./vec2f64-30dc1443.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./definitions-2d0dd0cd.js","./enums-4ca4641f.js","./number-954e4ab6.js","./FramebufferObject-50e1b68f.js","./vec2f32-461e65a9.js","./GeometryUtils-c093d234.js","./VTLMaterialManager-2c63b5e3.js","./enums-0fc02184.js","./ShaderCompiler-77d0dcb6.js","./programUtils-f035fe8a.js","./StyleRepository-14d163c2.js","./Color-a42a8267.js","./colorUtils-82440b70.js","./GeometryUtils-eebff0a0.js","./Geometry-daada628.js","./LayerView3D-9d740636.js","./TiledLayerView3D-ef836553.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Cyclical-b66238c6.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./vec2-2cef68de.js","./TileStrategy-4189758f.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js"],import.meta.url),wcs:()=>Ee(()=>import("./ImageryTileLayerView3D-96802c36.js"),["./ImageryTileLayerView3D-96802c36.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./LayerView3D-9d740636.js","./TiledLayerView3D-ef836553.js","./ImageryTileLayerView-283faa2a.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./OperationalLayer-24e6fa34.js","./TimeExtent-744afd75.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./rasterProjectionHelper-967d22a7.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./RefreshableLayerView-1faf24ee.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"web-tile":MT,wfs:()=>Ee(()=>import("./WFSLayerView3D-ee900f17.js"),["./WFSLayerView3D-ee900f17.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./FeatureLayerViewBase3D-f9a2841f.js","./reactiveUtils-f41a4e00.js","./FeatureLikeLayerView3D-e095b99c.js","./asyncUtils-62e8a185.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./Promise-dfdee8ba.js","./HandleOwner-e1406413.js","./arcgisLayerUrl-0b2b7691.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./persistableUrlUtils-a16d0f55.js","./Query-ff8c2cfb.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./TimeExtent-744afd75.js","./enumeration-3c281341.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Clonable-ba795b08.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./quantizationUtils-33aba427.js","./ViewingMode-5d7d590b.js","./Scheduler-8433672d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./assets-0b172f07.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryForSymbologySnapping-f3902574.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./hash-0ddfbf4b.js","./compilerUtils-034cacb8.js","./diffUtils-1ac65748.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./Graphics3DObjectStates-2cd67a8a.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./Layer-f0696768.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./FeatureReductionLayer-4077b2ae.js","./OperationalLayer-24e6fa34.js","./ExportImageParameters-f328a234.js","./LayerFloorInfo-2cd5e8ae.js","./sublayerUtils-ba7f61bc.js","./QueryEngine-a5c074c3.js","./normalizeUtils-ee4bf39f.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./FeatureSet-0573546e.js","./scaleUtils-b32a50d8.js","./FeatureStore-b1ba4c29.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./mat4f64-1e28eae0.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Heatmap.glsl-07ebb671.js","./HeatmapDensity.glsl-028179cd.js","./heatmapTextureUtils-d1d96768.js","./projectExtentUtils-9adea3ba.js","./LayerView3D-9d740636.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./EventedSet-7223bfeb.js","./FeatureLayerView-dbb9730b.js","./popupUtils-e8f3d062.js","./LayerView-b83ced89.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./RelationshipQuery-db5fcd0c.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./plane-45609588.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),wms:()=>Ee(()=>import("./WMSLayerView3D-7cb6ef97.js"),["./WMSLayerView3D-7cb6ef97.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./DynamicLayerView3D-97fd58f5.js","./asyncUtils-62e8a185.js","./reactiveUtils-f41a4e00.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./LayerView3D-9d740636.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./mat3f64-c6305894.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./aaBoundingBox-fc742a4e.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./quatf64-7fd38d64.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./byteSizeEstimations-f0cab514.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./sphere-4f5e644f.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./assets-0b172f07.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./projectExtentUtils-9adea3ba.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./WMSLayerView-90570b56.js","./OperationalLayer-24e6fa34.js","./TimeExtent-744afd75.js","./persistableUrlUtils-a16d0f55.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./opacityUtils-243aae26.js","./ExportWMSImageParameters-3c811106.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),wmts:()=>Ee(()=>import("./WMTSLayerView3D-d79f8b68.js"),["./WMTSLayerView3D-d79f8b68.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./reactiveUtils-f41a4e00.js","./layerUtils-034678f6.js","./LayerView3D-9d740636.js","./TiledLayerView3D-ef836553.js","./LayerView-b83ced89.js","./HandleOwner-e1406413.js","./Identifiable-aa6d459d.js","./Promise-dfdee8ba.js","./RefreshableLayerView-1faf24ee.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),"geo-rss":null,kml:null,"map-notes":null,"subtype-group":null,unknown:null,unsupported:null};function knt(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Ze(`${t}:view-not-supported`,`${e} is not supported in 3D`)}const pX={hasLayerViewModule:i=>T(hX[i.type]),importLayerView:i=>{const e=hX[i.type];if(B(e))throw knt(i);return e(i)}},fX="analyses-owner-handles";var zw,l0;(function(i){i[i.PENDING=0]="PENDING",i[i.CREATED=1]="CREATED"})(zw||(zw={})),function(i){i[i.ADDED=0]="ADDED",i[i.REMOVED=1]="REMOVED"}(l0||(l0={}));let D_=class extends PC{constructor(e){super(e),this._allAnalysisViews=new _i,this._creatingViewCount=0,this._items=new Map,this._scheduledUpdateHandle=null,this._attachedToViewResolver=mX(),this._analysisModules={"area-measurement":{module:null},dimension:{module:null},"direct-line-measurement":{module:null},"line-of-sight":{module:null},slice:{module:null}}}destroy(){this._disconnectOwners(),this._attachedToViewResolver.reject(js("AnalysisViewManager was destroyed"))}attach(){this._connectOwners(),this._attachedToViewResolver.resolve()}detach(){this._disconnectOwners(),this._attachedToViewResolver.reject(js()),this._attachedToViewResolver=mX()}get updating(){return!this.view.ready||this._creatingViewCount!==0||this._allAnalysisViews.some(e=>e.updating)}get testInfo(){return{allAnalysisViews:this._allAnalysisViews}}async whenAnalysisView(e){await this._attachedToViewResolver.promise;const t=this._items.get(e);if(B(t)||t.state.list===l0.REMOVED)throw new Ze("AnalysisViewManager:no-analysisview-for-analysis","The analysis has not been added to view.analyses",{analysis:e});return t.createAnalysisViewTask.promise}_connectOwners(){this.handles.add(this._connectAnalysesCollection(this.view.analyses),fX)}_disconnectOwners(){this.handles.remove(fX),this._update(),this._creatingViewCount=0}_connectAnalysesCollection(e){for(const r of e)this._addAnalysis(r);const t=e.on("after-add",r=>this._addAnalysis(r.item)),n=e.on("after-remove",r=>this._removeAnalysis(r.item));return{remove:()=>{t.remove(),n.remove();for(const r of e)this._removeAnalysis(r)}}}_addAnalysis(e){const t=this._items.get(e);if(t==null){const n={state:{view:zw.PENDING,list:l0.ADDED},analysis:e,view:null,createAnalysisViewTask:null};this._items.set(e,n),n.createAnalysisViewTask=WA(r=>this._createAnalysisViewPromise(n,r))}else t.state.list=l0.ADDED}_removeAnalysis(e){const t=this._items.get(e);t!=null?(t.state.list=l0.REMOVED,this._scheduleUpdate()):tt.getLogger(this.declaredClass).error("Trying to remove analysis which was not added")}_scheduleUpdate(){T(this._scheduledUpdateHandle)||(this._scheduledUpdateHandle=aie(()=>this._update()))}_update(){this._scheduledUpdateHandle=Gr(this._scheduledUpdateHandle),this._items.forEach(e=>{if(e.state.list===l0.REMOVED)switch(this._items.delete(e.analysis),e.state.view){case zw.PENDING:e.createAnalysisViewTask=ll(e.createAnalysisViewTask);break;case zw.CREATED:T(e.view)&&(this._allAnalysisViews.remove(e.view),e.view=_t(e.view),e.createAnalysisViewTask=null)}})}async _createAnalysisViewPromise(e,t){const n=e.analysis,r=n.type,s=this._analysisModules[r];if(this._creatingViewCount+=1,B(s.module))try{s.module=await this._loadAnalysisModule(r)}catch(o){throw this._creatingViewCount-=1,o}if(bu(t))throw this._creatingViewCount-=1,js("AnalysisView creation aborted");const a=new s.module.default({analysis:n,view:this.view});try{await a.when()}catch(o){throw this._creatingViewCount-=1,o}if(bu(t))throw this._creatingViewCount-=1,a.destroy(),js("AnalysisView creation aborted");return e.view=a,e.state.view=zw.CREATED,this._allAnalysisViews.add(a),this._creatingViewCount-=1,a}_loadAnalysisModule(e){switch(e){case"area-measurement":return Ee(()=>import("./AreaMeasurementAnalysisView3D-52ea2478.js").then(t=>t.A),["./AreaMeasurementAnalysisView3D-52ea2478.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./analysisThemeUtils-eba5c5ba.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./screenUtils-410d12c0.js","./vec2-2cef68de.js","./common-c186b691.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./colorUtils-4aa5b1d6.js","./AnalysisView3D-70b48b15.js","./Promise-dfdee8ba.js","./reactiveUtils-f41a4e00.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./Polyline-bf268e7b.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./quantityFormatUtils-ba1f6cd1.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./aaBoundingBox-fc742a4e.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./asyncUtils-62e8a185.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./plane-45609588.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./measurementUtils-c86e49dc.js","./LineVisualElement-69b2e868.js","./EffectView-d3bf37ed.js","./TileKey-0750ad58.js","./parser-2b40deea.js","./intl-f1e98361.js","./number-347a3a44.js","./locale-30120714.js","./messages-be07754e.js","./Segment-97608ed7.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./TextOverlayItem-a6091360.js"],import.meta.url);case"dimension":return Ee(()=>import("./DimensionAnalysisView3D-49e9221a.js"),["./DimensionAnalysisView3D-49e9221a.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./reactiveUtils-f41a4e00.js","./AnalysisView3D-70b48b15.js","./Promise-dfdee8ba.js","./LengthDimension-d35d103c.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Clonable-ba795b08.js","./Cyclical-b66238c6.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./unitUtils-47abac71.js","./quantityFormatUtils-ba1f6cd1.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./dehydratedFeatures-4eeb381a.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./Segment-97608ed7.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./vec2-2cef68de.js","./LineVisualElement-69b2e868.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./assets-0b172f07.js","./request-d3e98716.js","./zscale-1e1fc911.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./widget-f7489a3f.js","./intl-f1e98361.js","./number-347a3a44.js","./locale-30120714.js","./messages-be07754e.js","./uuid-73213768.js","./dom-5b7af1bf.js","./TextOverlayItem-a6091360.js","./plane-45609588.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./measurementUtils-c86e49dc.js","./manipulatorUtils-302eea16.js","./compilerUtils-034cacb8.js","./lineSegment-e6f72ff2.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./asyncUtils-62e8a185.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./Factory-d9ba6160.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./lengthUtils-d2d33f94.js","./MarkerSizing.glsl-c6fa192a.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./HandleOwner-e1406413.js","./VerticesVisualElement-dd38c964.js","./PointVisualElement-685382db.js","./Octree-1a841545.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./RightAngleQuadVisualElement-d5a5e64b.js","./colorUtils-82440b70.js","./analysisViewUtils-dbd7f679.js","./RenderTexture-efcfcb1e.js","./Basemap-a8f7f439.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./Portal-8b65c9c4.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./projection-aa2a8986.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url);case"direct-line-measurement":return Ee(()=>import("./DirectLineMeasurementAnalysisView3D-a29f231f.js").then(t=>t.D),["./DirectLineMeasurementAnalysisView3D-a29f231f.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./analysisThemeUtils-eba5c5ba.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./screenUtils-410d12c0.js","./vec2-2cef68de.js","./common-c186b691.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./colorUtils-4aa5b1d6.js","./AnalysisView3D-70b48b15.js","./Promise-dfdee8ba.js","./quantityFormatUtils-ba1f6cd1.js","./reactiveUtils-f41a4e00.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./Polyline-bf268e7b.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./LineVisualElement-69b2e868.js","./mat4f64-1e28eae0.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./vec2f64-30dc1443.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./intl-f1e98361.js","./number-347a3a44.js","./locale-30120714.js","./messages-be07754e.js","./Segment-97608ed7.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./TextOverlayItem-a6091360.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./quatf64-7fd38d64.js","./plane-45609588.js","./InterleavedLayout-5e9cf734.js","./BufferView-646ba1de.js","./types-e1c0a5bf.js","./Matrix3PassUniform-da8eddae.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./asyncUtils-62e8a185.js","./Version-9baeb7ac.js","./quat-5b263584.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./RightAngleQuadVisualElement-d5a5e64b.js"],import.meta.url);case"line-of-sight":return Ee(()=>import("./LineOfSightAnalysisView3D-bc3483dc.js"),["./LineOfSightAnalysisView3D-bc3483dc.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./vec3f64-2f9cef06.js","./AnalysisView3D-70b48b15.js","./Promise-dfdee8ba.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./common-c186b691.js","./vec4-790471c0.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./LineOfSightAnalysisTarget-664b45de.js","./Clonable-ba795b08.js","./persistable-19c823da.js","./preload-helper-41c905a7.js","./multiOriginJSONSupportUtils-c978f4c3.js","./request-d3e98716.js","./uuid-73213768.js","./persistableUrlUtils-a16d0f55.js","./ElevationInfo-ce9cacc2.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./asyncUtils-62e8a185.js","./reactiveUtils-f41a4e00.js","./HandleOwner-e1406413.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./assets-0b172f07.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./elevationInfoUtils-427916a5.js","./screenUtils-410d12c0.js","./dehydratedFeatures-4eeb381a.js","./aaBoundingBox-fc742a4e.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./LineVisualElement-69b2e868.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./Scheduler-8433672d.js","./lineSegment-e6f72ff2.js","./manipulatorUtils-302eea16.js","./compilerUtils-034cacb8.js","./vec2-2cef68de.js","./plane-45609588.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./manipulatorUtils-0cd1c493.js","./PointVisualElement-685382db.js","./Octree-1a841545.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./analysisViewUtils-dbd7f679.js","./Basemap-a8f7f439.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./loadAll-7fd968fe.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./projection-aa2a8986.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url);case"slice":return Ee(()=>import("./SliceAnalysisView3D-ab6558d0.js"),["./SliceAnalysisView3D-ab6558d0.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./AnalysisView3D-70b48b15.js","./Promise-dfdee8ba.js","./sliceToolUtils-d711e2da.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Clonable-ba795b08.js","./Cyclical-b66238c6.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./persistable-19c823da.js","./preload-helper-41c905a7.js","./multiOriginJSONSupportUtils-c978f4c3.js","./request-d3e98716.js","./uuid-73213768.js","./persistableUrlUtils-a16d0f55.js","./screenUtils-410d12c0.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./quat-5b263584.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./SimpleObservable-7dcdef1d.js","./assets-0b172f07.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./vec2f64-30dc1443.js","./plane-45609588.js","./LineVisualElement-69b2e868.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./Evented-515b9d9c.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./colorUtils-639f4d25.js","./mat4f32-77b3d8ac.js","./reactiveUtils-f41a4e00.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./manipulatorUtils-302eea16.js","./compilerUtils-034cacb8.js","./vec2-2cef68de.js","./lineSegment-e6f72ff2.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./asyncUtils-62e8a185.js","./Version-9baeb7ac.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Loadable-48bc1293.js","./BuildingComponentSublayer-80f74d57.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Collection-78126e82.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./TimeExtent-744afd75.js","./ElevationInfo-ce9cacc2.js","./RelationshipQuery-db5fcd0c.js","./Query-ff8c2cfb.js","./HandleOwner-e1406413.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./messages-be07754e.js","./editsZScale-2015e7db.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./BlendLayer-d8293c8d.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./PortalItem-aa42c739.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./TopFeaturesQuery-785f5453.js","./popupUtils-07fe66a7.js","./capabilities-a18453f6.js","./I3SIndexInfo-acc8ea15.js","./I3SLayerDefinitions-f6c057a8.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./popupUtils-e8f3d062.js","./Factory-d9ba6160.js","./elevationInfoUtils-427916a5.js","./analysisViewUtils-dbd7f679.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./featureConversionUtils-01cdde8a.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url)}}};function mX(){const i=_b();return i.promise.catch(()=>{}),i}f([y()],D_.prototype,"updating",null),f([y({constructOnly:!0})],D_.prototype,"view",void 0),f([y()],D_.prototype,"_allAnalysisViews",void 0),f([y()],D_.prototype,"_creatingViewCount",void 0),D_=f([ge("esri.views.3d.analysis.AnalysisViewManager3D")],D_);const Fnt=D_;let Jf=class extends et{constructor(e){super(e),this.collision=new wS,this.distance=1/0,this.minimumPoiDistance=4,this.tilt=null}get altitude(){return this.mode===Ot.Local?null:this._get("altitude")||null}set altitude(e){this.mode!==Ot.Local?this._set("altitude",e):tt.getLogger(this.declaredClass).warn("Altitude constraint is ignored in local scenes")}clampAltitude(e){return this.altitude?lt(e,this.altitude.min,this.altitude.max):e}clampTilt(e,t){if(!this.tilt)return t;const n=this.tilt(e);return lt(t,n.min,n.max)}clampDistance(e){return Math.min(e,this.distance)}createDefaultTilt(){return this.mode===Ot.Local?this._createDefaultTiltLocal():this._createDefaultTiltGlobal()}createConstantMaxTilt(e){return(t,n=dF)=>(n.min=Ya.min,n.max=e,n)}_createDefaultTiltLocal(){const e=this.collision.enabled?nR([[4e3,Ya.max],[1e4,zi(88)],[6e6,zi(88)]]):()=>Ya.max;return(t,n=dF)=>(n.min=Ya.min,n.max=e(t),n)}_createDefaultTiltGlobal(){const e=this.collision.enabled?nR([[4e3,Ya.max],[5e4,zi(88)],[6e6,zi(88)],[2e7,Ya.min]]):nR([[3e5,Ya.max],[3e6,zi(88)],[6e6,zi(88)],[2e7,Ya.min]]);return(t,n=dF)=>(n.min=Ya.min,n.max=e(t),n)}};function Nnt(i){return{min:-2e5,max:4*i.radius}}f([y()],Jf.prototype,"altitude",null),f([y({readOnly:!0})],Jf.prototype,"collision",void 0),f([y()],Jf.prototype,"distance",void 0),f([y({readOnly:!0})],Jf.prototype,"minimumPoiDistance",void 0),f([y()],Jf.prototype,"tilt",void 0),f([y({constructOnly:!0})],Jf.prototype,"mode",void 0),Jf=f([ge("esri.views.3d.state.Constraints")],Jf);const gX=Nnt(Rc),Ya={min:zi(.5),max:zi(179.5)},dF={min:0,max:0};let wS=class extends et{constructor(){super(...arguments),this.enabled=!0,this.elevationMargin=5}};f([y({type:Boolean})],wS.prototype,"enabled",void 0),f([y({type:Number})],wS.prototype,"elevationMargin",void 0),wS=f([ge("esri.views.3d.state.Constraints.CollisionConstraint")],wS);let Uw=class extends et{constructor(){super(...arguments),this.min=gX.min,this.max=gX.max}};f([y({type:Number})],Uw.prototype,"min",void 0),f([y({type:Number})],Uw.prototype,"max",void 0),Uw=f([ge("esri.views.3d.constraints.AltitudeConstraint")],Uw);let lm=class extends et{constructor(){super(...arguments),this.mode="auto"}get near(){return this._get("near")}set near(e){this._set("near",e),e>=this._get("far")&&(this.far=e+1e-9),this.mode="manual"}castNear(e){return Math.max(1e-8,e)}get far(){return this._get("far")}set far(e){this._set("far",e),e<=this._get("near")&&(this.near=e-1e-9),this.mode="manual"}castFar(e){return Math.max(1e-8,e)}autoUpdate(e,t){this.mode==="auto"&&(this._get("near")!==e&&this._set("near",e),this._get("far")!==t&&this._set("far",t))}};f([y({type:Number,value:1e-8})],lm.prototype,"near",null),f([Mr("near")],lm.prototype,"castNear",null),f([y({type:Number,value:1e-8})],lm.prototype,"far",null),f([Mr("far")],lm.prototype,"castFar",null),f([y({type:["auto","manual"]})],lm.prototype,"mode",void 0),lm=f([ge("esri.views.3d.constraints.ClipDistanceConstraint")],lm);const l6={min:ql(Ya.min),max:ql(Ya.max)};let c0=class extends et{constructor(){super(...arguments),this.mode="auto"}get max(){return this._get("max")}set max(e){this._set("max",e),this.mode="manual"}castMax(e){return lt(e,l6.min,l6.max)}autoUpdate(e){this.mode==="auto"&&this._get("max")!==e&&this._set("max",e)}};f([y({type:["auto","manual"]})],c0.prototype,"mode",void 0),f([y({type:Number,value:l6.max})],c0.prototype,"max",null),f([Mr("max")],c0.prototype,"castMax",null),c0=f([ge("esri.views.3d.constraints.TiltConstraint")],c0);let u0=class extends et{constructor(){super(...arguments),this.tilt=new c0,this.altitude=new Uw,this.clipDistance=new lm}};f([y({type:c0})],u0.prototype,"tilt",void 0),f([y({type:Uw})],u0.prototype,"altitude",void 0),f([y({type:lm})],u0.prototype,"clipDistance",void 0),u0=f([ge("esri.views.3d.constraints.Constraints")],u0);var c6;let Wu=c6=class extends Wo{constructor(i){super(i),this.type="sun",this.date=null,this.directShadowsEnabled=!1,this.displayUTCOffset=null}readDate(i,e){return e.datetime!=null&&new Date(e.datetime)||null}writeDate(i,e,t){e[t]=i.getTime()}readDirectShadowsEnabled(i,e){return!!e.directShadows}writedirectShadowsEnabled(i,e,t){i&&(e[t]=i)}writeDisplayUTCOffset(i,e){i!=null&&(e.displayUTCOffset=i)}clone(){return new c6(this.cloneConstructProperties())}cloneConstructProperties(){const i={directShadowsEnabled:this.directShadowsEnabled,displayUTCOffset:this.displayUTCOffset!=null?this.displayUTCOffset:null};return this.date!=null&&(i.date=new Date(this.date.getTime())),i}};f([y({readOnly:!0,type:["sun"],json:{write:!0}})],Wu.prototype,"type",void 0),f([y({type:Date,json:{type:Number,write:{target:"datetime"}}})],Wu.prototype,"date",void 0),f([PN("date",["datetime"])],Wu.prototype,"readDate",null),f([eE("date")],Wu.prototype,"writeDate",null),f([y({type:Boolean,json:{default:!1,write:{target:"directShadows"}}})],Wu.prototype,"directShadowsEnabled",void 0),f([PN("directShadowsEnabled",["directShadows"])],Wu.prototype,"readDirectShadowsEnabled",null),f([eE("directShadowsEnabled")],Wu.prototype,"writedirectShadowsEnabled",null),f([y({type:Number,json:{write:!0}})],Wu.prototype,"displayUTCOffset",void 0),f([eE("displayUTCOffset")],Wu.prototype,"writeDisplayUTCOffset",null),Wu=c6=f([ge("esri.webscene.SunLighting")],Wu);const cA=Wu;var uw;let lp=uw=class extends Pn.EventedMixin(cA){constructor(i){super(i),this.cameraTrackingEnabled=!0,this.ambientOcclusionEnabled=!1,this.waterReflectionEnabled=!1,this.positionTimezoneInfo={hours:0,minutes:0,seconds:0,autoUpdated:!0};const e=new Date().getFullYear(),t=new Date("March 15, "+e+" 12:00:00 UTC");this._set("defaultDate",t),this._set("date",t)}get defaultDate(){return new Date(this._get("defaultDate").getTime())}static fromWebsceneLighting(i){return new uw(i.cloneConstructProperties())}set defaultDate(i){const e=this._get("date")===this._get("defaultDate");i=new Date(i.getTime()),this._set("defaultDate",i),e&&this._set("date",i)}set date(i){i!=null&&(this.positionTimezoneInfo.autoUpdated=!1,this._set("date",new Date(i.getTime())))}autoUpdate(i,e){const t=uw.calculateTimezoneOffset(this.positionTimezoneInfo);this.positionTimezoneInfo.hours=e.hours,this.positionTimezoneInfo.minutes=e.minutes,this.positionTimezoneInfo.seconds=e.seconds;let n=null;T(i)&&(this.positionTimezoneInfo.autoUpdated=!0,isNaN(i.getTime())?(n=this.defaultDate.getTime(),this._set("date",this.defaultDate)):(n=this.date&&this.date.getTime(),this._set("date",new Date(i.getTime()))));const r=uw.calculateTimezoneOffset(this.positionTimezoneInfo);if(t!==r&&(hF.target=this,hF.timezoneOffset=r,this.emit("timezone-will-change",hF)),T(i))return!!isNaN(i.getTime())||n!==i.getTime()}clone(){const i=this._get("date")===this._get("defaultDate"),e=new uw({...this.cloneConstructProperties(),defaultDate:this.defaultDate,cameraTrackingEnabled:this.cameraTrackingEnabled,ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled});return i&&e._set("date",e._get("defaultDate")),e.positionTimezoneInfo.autoUpdated=this.positionTimezoneInfo.autoUpdated,e.positionTimezoneInfo.hours=this.positionTimezoneInfo.hours,e.positionTimezoneInfo.minutes=this.positionTimezoneInfo.minutes,e.positionTimezoneInfo.seconds=this.positionTimezoneInfo.seconds,e}cloneWithWebsceneLighting(i){const e=this.clone();return i.date!=null&&(e.date=i.date),e.directShadowsEnabled=i.directShadowsEnabled,e.displayUTCOffset=i.displayUTCOffset,e}cloneNonPersistentConstructProperties(){return{ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled}}};f([y({type:Boolean})],lp.prototype,"cameraTrackingEnabled",void 0),f([y({type:Boolean})],lp.prototype,"ambientOcclusionEnabled",void 0),f([y({type:Boolean})],lp.prototype,"waterReflectionEnabled",void 0),f([y({type:Date})],lp.prototype,"defaultDate",null),f([y({type:Date})],lp.prototype,"date",null),lp=uw=f([ge("esri.views.3d.environment.SunLighting")],lp),function(i){function e({hours:t,minutes:n,seconds:r}){return Math.round(t+n/60+r/3600)}i.calculateTimezoneOffset=e}(lp||(lp={}));const hF={target:null,timezoneOffset:0},gv=lp;var u6;let xS=u6=class extends Wo{constructor(i){super(i),this.type="virtual",this.directShadowsEnabled=!1}clone(){return new u6(this.cloneConstructProperties())}cloneConstructProperties(){return{directShadowsEnabled:this.directShadowsEnabled}}};f([y({readOnly:!0,type:["virtual"],json:{write:!0}})],xS.prototype,"type",void 0),f([y({type:Boolean,json:{default:!1,name:"directShadows",write:!0}})],xS.prototype,"directShadowsEnabled",void 0),xS=u6=f([ge("esri.webscene.VirtualLighting")],xS);const iD=xS;var eI;let dw=eI=class extends Pn.EventedMixin(iD){constructor(i){super(i),this.ambientOcclusionEnabled=!1,this.waterReflectionEnabled=!1,this.cameraTrackingEnabled=!0}clone(){return new eI({...this.cloneConstructProperties(),ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled})}static fromWebsceneLighting(i){return new eI(i.cloneConstructProperties())}cloneWithWebsceneLighting(i){const e=this.clone();return e.directShadowsEnabled=i.directShadowsEnabled,e}cloneNonPersistentConstructProperties(){return{ambientOcclusionEnabled:this.ambientOcclusionEnabled,waterReflectionEnabled:this.waterReflectionEnabled,cameraTrackingEnabled:this.cameraTrackingEnabled}}};f([y({type:Boolean})],dw.prototype,"ambientOcclusionEnabled",void 0),f([y({type:Boolean})],dw.prototype,"waterReflectionEnabled",void 0),f([y({type:Boolean})],dw.prototype,"cameraTrackingEnabled",void 0),dw=eI=f([ge("esri.views.3d.environment.VirtualLighting")],dw);const CS=dw,Vnt={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:gv,virtual:CS}};var d6;let xE=d6=class extends et{set quality(i){["low","high"].includes(i)&&this._set("quality",i)}clone(){return new d6({quality:this.quality})}};f([y({type:["low","high"],value:"low"})],xE.prototype,"quality",null),xE=d6=f([ge("esri.views.3d.environment.SceneViewAtmosphere")],xE);var h6;let TS=h6=class extends Wo{constructor(i){super(i),this.type="sunny",this.cloudCover=.5}clone(){return new h6({cloudCover:this.cloudCover})}};f([bb({sunny:"sunny"})],TS.prototype,"type",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],TS.prototype,"cloudCover",void 0),TS=h6=f([ge("esri.views.3d.environment.SunnyWeather")],TS);const p6=TS;var f6;let SS=f6=class extends Wo{constructor(i){super(i),this.type="cloudy",this.cloudCover=.5}clone(){return new f6({cloudCover:this.cloudCover})}};f([bb({cloudy:"cloudy"})],SS.prototype,"type",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],SS.prototype,"cloudCover",void 0),SS=f6=f([ge("esri.views.3d.environment.CloudyWeather")],SS);const Bnt=SS;var m6;let ES=m6=class extends Wo{constructor(i){super(i),this.type="foggy",this.fogStrength=.5}clone(){return new m6({fogStrength:this.fogStrength})}};f([bb({foggy:"foggy"})],ES.prototype,"type",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],ES.prototype,"fogStrength",void 0),ES=m6=f([ge("esri.views.3d.environment.FoggyWeather")],ES);const znt=ES;var g6;let hw=g6=class extends Wo{constructor(i){super(i),this.type="rainy",this.cloudCover=.5,this.precipitation=.5}clone(){return new g6({cloudCover:this.cloudCover,precipitation:this.precipitation})}};f([bb({rainy:"rainy"})],hw.prototype,"type",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],hw.prototype,"cloudCover",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],hw.prototype,"precipitation",void 0),hw=g6=f([ge("esri.views.3d.environment.RainyWeather")],hw);const Unt=hw;var v6;let k_=v6=class extends Wo{constructor(i){super(i),this.type="snowy",this.cloudCover=.5,this.precipitation=.5,this.snowCover="disabled"}clone(){return new v6({cloudCover:this.cloudCover,precipitation:this.precipitation,snowCover:this.snowCover})}};f([bb({snowy:"snowy"})],k_.prototype,"type",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],k_.prototype,"cloudCover",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],k_.prototype,"precipitation",void 0),f([y({type:["enabled","disabled"],nonNullable:!0,json:{write:!0}})],k_.prototype,"snowCover",void 0),k_=v6=f([ge("esri.views.3d.environment.SnowyWeather")],k_);const Hnt=k_,_he={key:"type",base:p6,typeMap:{sunny:p6,cloudy:Bnt,rainy:Unt,snowy:Hnt,foggy:znt}},Gnt=Object.keys(_he.typeMap);function Wnt(i,e){return!!Gnt.includes(i)||(e.error(`"${i}" is not a valid weather type`),!1)}const od=1e4,jnt={key:"type",defaultKeyValue:"sun",base:null,typeMap:{sun:cA,virtual:iD}};let tI=class extends Wo{constructor(e){super(e)}clone(){}};f([y({readOnly:!0,json:{read:!1}})],tI.prototype,"type",void 0),tI=f([ge("esri.webscene.background.Background")],tI);const bhe=tI;var y6;const qnt={...P_e,nonNullable:!0};let AS=y6=class extends bhe{constructor(i){super(i),this.type="color",this.color=new Xt([0,0,0,1])}clone(){return new y6(this.cloneProperties())}cloneProperties(){return{color:this.color.clone()}}};f([bb({color:"color"},{readOnly:!0})],AS.prototype,"type",void 0),f([y(qnt)],AS.prototype,"color",void 0),AS=y6=f([ge("esri.webscene.background.ColorBackground")],AS);const whe=AS,vX={base:bhe,key:"type",typeMap:{color:whe}};function Knt(i){return(e,t,n)=>{if(!e)return e;for(const r in i.typeMap)if(e.type===r){const s=new i.typeMap[r];return s.read(e,n),s}}}const Ynt={types:vX,json:{read:Knt(vX),write:{overridePolicy:(i,e,t)=>({enabled:!t||!t.isPresentation})}}};var _6;const xhe="esri.webscene.Environment",Xnt=tt.getLogger(xhe),yX=(i,e,t)=>({enabled:!t||!t.isPresentation});let vv=_6=class extends Wo{constructor(i){super(i),this.lighting=new cA,this.background=null,this.atmosphereEnabled=!0,this.starsEnabled=!0}set weather(i){Wnt(i==null?void 0:i.type,Xnt)&&this._set("weather",i)}clone(){return new _6(this.cloneConstructProperties())}cloneConstructProperties(){return{lighting:this.lighting&&this.lighting.type==="virtual"?iD.prototype.clone.call(this.lighting):cA.prototype.clone.call(this.lighting),background:ko(this.background),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,weather:this.weather.clone()}}};f([y({types:jnt,nonNullable:!0,json:{write:!0}})],vv.prototype,"lighting",void 0),f([y(Ynt)],vv.prototype,"background",void 0),f([y({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:yX}}})],vv.prototype,"atmosphereEnabled",void 0),f([y({type:Boolean,nonNullable:!0,json:{write:{overridePolicy:yX}}})],vv.prototype,"starsEnabled",void 0),f([y({types:_he,nonNullable:!0,json:{write:!0},value:new p6})],vv.prototype,"weather",null),vv=_6=f([ge(xhe)],vv);const Che=vv;var MS;let pw=MS=class extends Che{constructor(i){super(i),this.atmosphere=new xE,this.lighting=new gv,this.cachedCameraTrackingEnabled=null}static fromWebsceneEnvironment(i){const e=i.cloneConstructProperties();return new MS({...e,lighting:e.lighting.type==="virtual"?CS.fromWebsceneLighting(e.lighting):gv.fromWebsceneLighting(e.lighting)})}castLighting(i){return this._convertLighting(i)}applyLighting(i){this.lighting=this._convertLighting(i)}_convertLighting(i){var e,t;return i?i instanceof gv||i instanceof CS?i:i instanceof cA?this.lighting&&this.lighting.type!=="virtual"?this.lighting.cloneWithWebsceneLighting(i):new gv({...i.cloneConstructProperties(),...(e=this.lighting)==null?void 0:e.cloneNonPersistentConstructProperties()}):i instanceof iD?this.lighting&&this.lighting.type==="virtual"?this.lighting.cloneWithWebsceneLighting(i):new CS({...i.cloneConstructProperties(),...(t=this.lighting)==null?void 0:t.cloneNonPersistentConstructProperties()}):gye(Vnt,i):new gv}clone(){return new MS({lighting:this.lighting.clone(),atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:ko(this.background)})}cloneWithWebsceneEnvironment(i){return new MS({atmosphere:this.atmosphere.clone(),weather:this.weather.clone(),atmosphereEnabled:this.atmosphereEnabled,starsEnabled:this.starsEnabled,background:ko(this.background),...i.cloneConstructProperties(),lighting:this._getLighting(i)})}_getLighting(i){switch(i.lighting.type){case"sun":return this.lighting&&this.lighting.type==="sun"?this.lighting.cloneWithWebsceneLighting(i.lighting):gv.fromWebsceneLighting(i.lighting);case"virtual":return this.lighting&&this.lighting.type==="virtual"?this.lighting.cloneWithWebsceneLighting(i.lighting):CS.fromWebsceneLighting(i.lighting);default:return Do(i.lighting),gv.fromWebsceneLighting(i.lighting)}}};f([y({type:xE,json:{read:!1},nonNullable:!0})],pw.prototype,"atmosphere",void 0),f([y({nonNullable:!0})],pw.prototype,"lighting",void 0),f([Mr("lighting")],pw.prototype,"castLighting",null),pw=MS=f([ge("esri.views.3d.environment.SceneViewEnvironment")],pw);const fw=pw;var Ma;(function(i){i[i.Simple=0]="Simple",i[i.Realistic=1]="Realistic",i[i.Panoramic=2]="Panoramic",i[i.None=3]="None"})(Ma||(Ma={}));function The(i){return Math.min(1,Math.max(0,(i-1e5)/(1e6-1e5)))}const b6=1e4,Znt=.085,uA=1e5,CE=Gt(parseFloat(Number(5802e-9).toFixed(6)),parseFloat(Number(13558e-9).toFixed(6)),parseFloat(Number(331e-7).toFixed(6))),pF=3,fF=Gt(pF*parseFloat(Number(65e-8).toFixed(6)),pF*parseFloat(Number(1881e-9).toFixed(6)),pF*parseFloat(Number(85e-9).toFixed(6))),Qnt=3996e-9,Jnt=Gt(parseFloat(Number(CE[0]+fF[0]).toFixed(6)),parseFloat(Number(CE[1]+fF[1]).toFixed(6)),parseFloat(Number(CE[2]+fF[2]).toFixed(6)));function ert(i){const e=new Nr;e.attributes.add(j.POSITION,"vec2"),e.include(YL,{textureCoordinateType:yy.Default}),e.varyings.add("worldRay","vec3"),e.varyings.add("eyeDir","vec3");const{vertex:t,fragment:n}=e;return t.uniforms.add([new pl("inverseProjectionMatrix",(r,s)=>s.camera.inverseProjectionMatrix),new pl("inverseViewMatrix",(r,s)=>Da(trt,s.camera.viewMatrix))]),t.code.add(ee`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1, 1)).xyz;
eyeDir = posViewNear;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0)).xyz;
forwardTextureCoordinates();
gl_Position = vec4(position, 1, 1);
}`),n.uniforms.add([new hl("radii",r=>r.radii),new Io("cameraPosition",(r,s)=>s.camera.eye),new jp("heightParameters",r=>r.heightParameters),new Hi("innerFadeDistance",r=>r.innerFadeDistance),new Hi("altitudeFade",r=>r.altitudeFade),new sn("depthTex",r=>r.depthTex),new Hi("hazeStrength",r=>r.hazeStrength)]),n.constants.add("betaRayleigh","vec3",CE),n.constants.add("betaCombined","vec3",Jnt),n.constants.add("betaMie","float",Qnt),n.constants.add("scaleHeight","float",Znt*uA),XL(n),e.include(UB),i.haze&&(n.include(eb),n.uniforms.add(new hl("nearFar",(r,s)=>s.camera.nearFar))),n.code.add(ee`vec2 sphereIntersect(vec3 start, vec3 dir, float radius, bool planet) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float c = planet ? heightParameters[1] - radius * radius : heightParameters[2];
float d = (b * b) - 4.0 * a * c;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}`),n.code.add(ee`float chapmanApproximation(float X, float h, float cosZenith) {
float c = sqrt(X + h);
float cExpH = c * exp(-h);
if (cosZenith >= 0.0) {
return cExpH / (c * cosZenith + 1.0);
} else {
float x0 = sqrt(1.0 - cosZenith * cosZenith) * (X + h);
float c0 = sqrt(x0);
return 2.0 * c0 * exp(X - x0) - cExpH / (1.0 - c * cosZenith);
}
}`),n.code.add(ee`float getOpticalDepth(vec3 position, vec3 dir, float h) {
return scaleHeight * chapmanApproximation(radii[0] / scaleHeight, h, dot(normalize(position), dir));
}`),n.code.add(ee`
    const int STEPS = 6;

    float getGlow(float dist, float radius, float intensity) {
      return pow(radius / max(dist, 1e-6), intensity);
    }

    vec3 getAtmosphereColour(vec3 cameraPos, vec3 rayDir, vec3 lightDir, float terrainDepth) {
      float reducedPlanetRadius = radii[0] - 20000.0;
      vec2 rayPlanetIntersect = sphereIntersect(cameraPos, rayDir, reducedPlanetRadius, true);
      vec2 rayAtmosphereIntersect = sphereIntersect(cameraPos, rayDir, radii[1], false);
      bool hitsAtmosphere = (rayAtmosphereIntersect.x <= rayAtmosphereIntersect.y) && rayAtmosphereIntersect.x > 0.0;
      bool insideAtmosphere = heightParameters[0] < radii[1];

      if (!(hitsAtmosphere || insideAtmosphere)) {
        return vec3(0);
      }

      bool hitsPlanet = (rayPlanetIntersect.x <= rayPlanetIntersect.y) && rayPlanetIntersect.x > 0.0;

      float start = insideAtmosphere ? 0.0 : rayAtmosphereIntersect.x;

      if (heightParameters[0] < reducedPlanetRadius) {
        // Long light rays from the night side of the planet lead to numerical instability
        // Do not render the atmosphere in such cases
        if (dot(rayDir, normalize(cameraPos)) < -0.025) {
          return vec3(0);
        }
        start = rayPlanetIntersect.y;
      }

      float end = hitsPlanet ? rayPlanetIntersect.x : rayAtmosphereIntersect.y;
      float maxEnd = end;

      ${i.haze?ee`if (terrainDepth != -1.0) { end = terrainDepth; }`:""}

      vec3 samplePoint = cameraPos + rayDir * end;
      float multiplier = hitsPlanet ? -1.0 : 1.0;

      vec3 scattering = vec3(0);
      float scaleFract = (length(samplePoint) - radii[0]) / scaleHeight;
      float lastOpticalDepth = getOpticalDepth(samplePoint, rayDir, scaleFract);
      float stepSize = (end - start) / float(STEPS);
      for (int i = 0; i < STEPS; i++) {
        samplePoint -= stepSize * rayDir;
        scaleFract = (length(samplePoint) - radii[0]) / scaleHeight;
        float opticalDepth = multiplier * getOpticalDepth(samplePoint, rayDir * multiplier, scaleFract);

        if (i > 0) {
          scattering *= ${i.haze?ee``:" mix(2.5, 1.0, clamp((length(cameraPos) - radii[0]) / 50e3, 0.0, 1.0)) * "} exp(-(mix(betaCombined, betaRayleigh, 0.5) + betaMie) * max(0.0, (opticalDepth - lastOpticalDepth)));
        }

        if (dot(normalize(samplePoint), lightDir) > -0.3) {

          float scale = exp(-scaleFract);
          float lightDepth = getOpticalDepth(samplePoint, lightDir, scaleFract);

          scattering += scale * exp(-(betaCombined + betaMie) * lightDepth);
          ${i.haze?"":ee`scattering += scale * exp(-(0.25 * betaCombined ) * lightDepth);`}
        }

        lastOpticalDepth = opticalDepth;

      }

      float mu = dot(rayDir, lightDir);
      float mumu = 1.0 + mu * mu;

      float phaseRayleigh = 0.0596831 * mumu;

      ${i.haze?ee`return 3.0 * scattering * stepSize * phaseRayleigh * betaRayleigh;`:ee`
            const float g = 0.8;
            const float gg = g * g;
            float phaseMie = end == maxEnd ? 0.1193662 * ((1.0 - gg) * mumu) / (pow(1.0 + gg - 2.0 * mu * g, 1.5) * (2.0 + gg)) : 0.0;
            phaseMie += getGlow(1.0 - mu, 5e-5, 3.0) * smoothstep(0.01, 0.1, length(scattering));
            phaseMie = clamp(phaseMie, 0.0, 128.0);
            return 3.0 * scattering * stepSize * (phaseRayleigh * betaRayleigh + 0.025 * phaseMie * betaMie);`}
    }

    vec3 tonemapACES(vec3 x) {
      return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
    }

    vec4 applyUndergroundAtmosphere(vec3 rayDir, vec3 lightDirection, vec4 fragColor) {
      vec2 rayPlanetIntersect = sphereIntersect(cameraPosition, rayDir, radii[0], true);
      if (!((rayPlanetIntersect.x <= rayPlanetIntersect.y) && rayPlanetIntersect.y > 0.0)) {
        return fragColor;
      }

      float lightAngle = dot(lightDirection, normalize(cameraPosition + rayDir * max(0.0, rayPlanetIntersect.x)));
      vec4 surfaceColor = vec4(vec3(max(0.0, (smoothstep(-1.0, 0.8, 2.0 * lightAngle)))), 1.0 - altitudeFade);
      float relDist = (rayPlanetIntersect.y - max(0.0, rayPlanetIntersect.x)) / innerFadeDistance;
      if (relDist > 1.0) {
        return surfaceColor;
      }

      return mix(gl_FragColor, surfaceColor, smoothstep(0.0, 1.0, relDist * relDist));
    }

    void main() {
      vec3 rayDir = normalize(worldRay);
      float terrainDepth = -1.0;
      ${i.haze?ee`
          vec4 depthSample = texture2D(depthTex, vuv0).rgba;
          if (depthSample != vec4(0)) {
            vec3 cameraSpaceRay = normalize(eyeDir);
            cameraSpaceRay /= cameraSpaceRay.z;
            cameraSpaceRay *= -linearDepthFromTexture(depthTex, vuv0, nearFar);
            terrainDepth = max(0.0, length(cameraSpaceRay));
          }`:ee`
          float depthSample = texture2D(depthTex, vuv0).r;
          if (depthSample != 1.0) {
            gl_FragColor = vec4(0);
            return;
          }`}

      ${i.haze?ee`
            vec3 col = vec3(0);
            float fadeOut = smoothstep(-10000.0, -15000.0, heightParameters[0] - radii[0]);
            if(depthSample != vec4(0)){
              col = (1.0 - fadeOut) * hazeStrength * getAtmosphereColour(cameraPosition, rayDir, mainLightDirection, terrainDepth);
            }
            float alpha = 1.0 - fadeOut;`:ee`
            vec3 col = getAtmosphereColour(cameraPosition, rayDir, mainLightDirection, terrainDepth);;
            float alpha = smoothstep(0.0, mix(0.15, 0.01, heightParameters[3]), length(col));`}
      col = tonemapACES(col);
      gl_FragColor = delinearizeGamma(vec4(col, alpha));
      ${i.haze?"":ee`
          if (depthSample == 1.0) {
            gl_FragColor = applyUndergroundAtmosphere(rayDir, mainLightDirection, gl_FragColor);
          }`}
    }
  `),e}const trt=St(),irt=Object.freeze(Object.defineProperty({__proto__:null,betaRayleigh:CE,build:ert},Symbol.toStringTag,{value:"Module"}));let nrt=class extends Es{constructor(){super(...arguments),this.heightParameters=Dn(),this.radii=xt(),this.innerFadeDistance=0,this.altitudeFade=0,this.hazeStrength=1}},L$=class extends _n{initializeProgram(e){return new gn(e.rctx,L$.shader.get().build(this.configuration),Mn)}initializePipeline(){return this.configuration.haze?yi({blending:Na(vt.ONE,vt.ZERO,vt.ONE_MINUS_SRC_COLOR,vt.ONE),colorWrite:$i}):yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),depthTest:{func:lo.LEQUAL},colorWrite:$i})}};L$.shader=new bn(irt,()=>Ee(()=>import("./ChapmanAtmosphere.glsl-352b7f78.js"),["./ChapmanAtmosphere.glsl-352b7f78.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./vec3-a020a6f6.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./FloatPassUniform-d2dfc562.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./vec3f32-c9aa289f.js","./compilerUtils-034cacb8.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let She=class extends ic{constructor(){super(...arguments),this.haze=!1}};f([Pe()],She.prototype,"haze",void 0);let _X=class{constructor(e){this._view=e,this.type=Ma.Realistic,this._passParameters=new nrt,this._rootTileElevationMin=NaN,this._lowerBoundEarthRadius=Rc.radius,this._fadeHaze=0,this._updateRadius(Rc.radius)}destroy(){this._atmosphereTechnique=Lr(this._atmosphereTechnique),this._atmosphereHazeTechnique=Lr(this._atmosphereHazeTechnique),this._vao=Ht(this._vao),this._handles=_t(this._handles)}initializeRenderContext(e){const t=e.renderContext.rctx,n=this._handles=new mi;this._updateRootTileElevationBounds(),n.add(ue(()=>this._view.basemapTerrain.rootTileElevationBounds,()=>this._updateRootTileElevationBounds())),n.add(ue(()=>this._view.basemapTerrain.visibleElevationBounds,()=>this._updateVisibleElevationBounds()));const r=new She;r.haze=!1,this._atmosphereTechnique=e.shaderTechniqueRepository.acquire(L$,r),r.haze=!0,this._atmosphereHazeTechnique=e.shaderTechniqueRepository.acquire(L$,r),this._vao=tc(t,KA)}render(e){this._render(e,this._atmosphereTechnique,e.offscreenRenderingHelper.depthTexture)}renderHaze(e,t){this._fadeHaze=t,this._render(e,this._atmosphereHazeTechnique,e.offscreenRenderingHelper.linearDepthTexture)}_render(e,t,n){if(B(n))return;this._update(e.bindParameters.camera),this._passParameters.depthTex=n;const r=e.rctx.bindTechnique(t,this._passParameters,e.bindParameters);e.offscreenRenderingHelper.renderDepthDetached(()=>{this._renderCommon(r,e)})}_renderCommon(e,t){B(this._vao)||(t.rctx.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),t.rctx.drawArrays(Qi.TRIANGLE_STRIP,0,4))}_adjustRadiusForTesselation(e){return e*Math.cos(Math.PI/16/16)}_updateRootTileElevationBounds(){const e=this._view.basemapTerrain.rootTileElevationBounds.min;e!==this._rootTileElevationMin&&(this._rootTileElevationMin=e,this._lowerBoundEarthRadius=Rc.radius,this._updateVisibleElevationBounds())}_updateVisibleElevationBounds(){const e=this._adjustRadiusForTesselation(Rc.radius+this._view.basemapTerrain.visibleElevationBounds.min);e<this._lowerBoundEarthRadius&&this._updateRadius(e)}_updateRadius(e){this._lowerBoundEarthRadius=e,Bi(this._passParameters.radii,e,e+uA),this._passParameters.innerFadeDistance=2*Math.sqrt((2*e-b6)*b6)}_update(e){if(B(e))return;const t=Et(e.eye),n=t*t,r=n-this._passParameters.radii[1]*this._passParameters.radii[1],s=Math.min(1,Math.max(0,(t-this._passParameters.radii[0])/uA));dl(this._passParameters.heightParameters,t,n,r,s),this._passParameters.altitudeFade=The(t-this._lowerBoundEarthRadius),this._passParameters.hazeStrength=ki(ki(.6,1,Nx(9500,10500,t-Rc.radius)),1,this._fadeHaze)}static isSupported(e){return e.renderContext.rctx.capabilities.depthTexture}};function rrt(){const i=new Nr;i.attributes.add(j.POSITION,"vec2"),i.varyings.add("worldRay","vec3");const{vertex:e,fragment:t}=i;return e.uniforms.add([new pl("inverseProjectionMatrix",(n,r)=>r.camera.inverseProjectionMatrix),new pl("inverseViewMatrix",(n,r)=>Da(srt,r.camera.viewMatrix))]),e.code.add(ee`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1.0, 1.0)).xyz;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0.0)).xyz;
gl_Position = vec4(position, 1.0, 1.0);
}`),t.include(Nne),t.include(Tb),i.include(tbe,{pbrMode:Ds.Disabled,lightingSphericalHarmonicsOrder:2}),i.include(kbe),i.include(UB),i.include(ibe,{useLegacyTerrainShading:!1}),i.include(abe,{instancedDoublePrecision:!1,useLegacyTerrainShading:!1}),t.uniforms.add([new Io("cameraPosition",(n,r)=>r.camera.eye)]),t.code.add(ee`void main() {
vec4 cloudsColor = renderClouds(normalize(worldRay), cameraPosition);
gl_FragColor = vec4((1.0 - totalFadeInOut) * cloudsColor.rgb, cloudsColor.a);
}`),i}const srt=St(),art=Object.freeze(Object.defineProperty({__proto__:null,build:rrt},Symbol.toStringTag,{value:"Module"}));let NU=class extends _n{constructor(e){super(e,new ic,()=>this.destroy())}initializeProgram(e){return new gn(e.rctx,NU.shader.get().build(),Mn)}initializePipeline(){return yi({blending:vf(vt.ONE,vt.SRC_ALPHA),depthTest:{func:lo.LEQUAL},colorWrite:$i})}};NU.shader=new bn(art,()=>Ee(()=>import("./CloudsComposition.glsl-e03c8eab.js"),["./CloudsComposition.glsl-e03c8eab.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./vec3-a020a6f6.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./vec3f32-c9aa289f.js","./compilerUtils-034cacb8.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./mathUtils-2519596a.js","./Ellipsoid-89682c5e.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./mat3f64-c6305894.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./ReadLinearDepth.glsl-7ff30f7d.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let F_=class extends et{constructor(e){super(e),this._technique=new NU(e),this._vao=tc(e.rctx)}destroy(){this._technique=Lr(this._technique),this._vao=Ht(this._vao)}render(e){const t=e.bindParameters.cloudsFade;if(B(this._vao)||B(t.data))return;if(!this._technique.compiled)return void this.requestRender();const n=e.rctx.bindTechnique(this._technique,ort,e.bindParameters);e.rctx.bindVAO(this._vao),n.assertCompatibleVertexAttributeLocations(this._vao),e.rctx.drawArrays(Qi.TRIANGLE_STRIP,0,4)}};f([y({constructOnly:!0})],F_.prototype,"rctx",void 0),f([y({constructOnly:!0})],F_.prototype,"viewingMode",void 0),f([y({constructOnly:!0})],F_.prototype,"planetRadius",void 0),f([y({constructOnly:!0})],F_.prototype,"requestRender",void 0),F_=f([ge("esri.views.3d.environment.CloudsComposition")],F_);const ort=new Es;var Hl;(function(i){i[i.SIXTEEN=0]="SIXTEEN",i[i.HUNDRED=1]="HUNDRED",i[i.TWOHUNDRED=2]="TWOHUNDRED",i[i.COUNT=3]="COUNT"})(Hl||(Hl={}));let iI=class extends ic{constructor(){super(...arguments),this.steps=Hl.SIXTEEN,this.writeTextureChannels=HB.RG}};f([Pe({count:Hl.COUNT})],iI.prototype,"steps",void 0),f([Pe({constValue:Fi("esri-mobile")?1024:2048})],iI.prototype,"cubeMapSize",void 0),f([Pe()],iI.prototype,"writeTextureChannels",void 0);let PS=class{constructor(e,t,n,r,s,a,o,l,c=.5){this.coverage=e,this.density=t,this.absorption=n,this.cloudSize=r,this.detailSize=s,this.smoothness=a,this.cloudHeight=o,this.raymarchingSteps=l,this.median=c}};const bX=new PS([0,.6],[.03,.03],[0,0],[.9,.9],[.8,.8],[.7,.7],[.05,.05],Hl.SIXTEEN),bo={sunny:bX,cloudy:new PS([.3,.65],[.2,.4],[0,0],[.85,.85],[.75,.75],[.3,.4],[1,1],Hl.TWOHUNDRED,.6),rainy:new PS([.6,.8],[.5,.8],[.1,.5],[.9,.9],[.75,.75],[.5,.5],[1,1],Hl.TWOHUNDRED,.4),snowy:new PS([.25,.75],[.3,.3],[0,0],[.95,.95],[.7,.7],[.69,.75],[.3,1],Hl.HUNDRED,.65),foggy:new PS([.8,.8],[.5,.5],[0,0],[.95,.95],[.9,.9],[.55,.55],[.3,.3],Hl.SIXTEEN),default:bX},ld=Fi("esri-mobile")?64:128,lrt=ld/128,Qd=Math.ceil(Math.sqrt(ld)),rh=(ld+2)*Qd,crt=1e5,mF=128,urt=rh/1560;let Ehe=class extends Es{constructor(){super(...arguments),this.cloudRadius=0,this.cloudSize=0,this.detailSize=0,this.absorption=0,this.density=0,this.smoothness=0,this.cloudHeight=0,this.coverage=0,this.raymarchingSteps=bo.default.raymarchingSteps,this.weatherTile=xt()}},Ahe=class extends Es{constructor(){super(...arguments),this.viewMatrix=Ho()}};function drt(i){const e=new Nr;e.include(dg,!1);const t=e.fragment;return t.uniforms.add([new Hi("cloudRadius",n=>n.cloudRadius),new Hi("power",n=>ki(35,120,n.absorption)),new Hi("sigmaE",n=>1+n.absorption),new Hi("density",n=>ki(0,.3,n.density)),new Hi("cloudSize",n=>ki(0,.02,Math.max(.01,1-n.cloudSize))),new Hi("detailSize",n=>ki(0,.2,Math.max(.01,1-n.detailSize))),new Hi("smoothness",n=>ki(0,.5,1-n.smoothness)),new Hi("cloudHeight",n=>ki(0,1500,n.cloudHeight)),new Hi("coverage",n=>n.coverage),new JN("view",n=>n.viewMatrix),new sn("cloudShapeTexture",n=>T(n.noiseTexture)?n.noiseTexture.textureAtlas:null),new hl("cloudVariables",n=>Bi(hrt,n.coverage,n.absorption))]),t.constants.add("halfCubeMapSize","float",.5*i.cubeMapSize),t.code.add(ee`
    const int STEPS = ${i.steps===Hl.SIXTEEN?ee`16`:i.steps===Hl.HUNDRED?ee`100`:ee`200`};
    const int STEPS_LIGHT = 6;
    const float stepL = 300.0 / float(STEPS_LIGHT);
    const float cloudStart = 1500.0;

    vec3 rayDirection(vec2 fragCoord) {
      vec2 xy = fragCoord - halfCubeMapSize;
      return normalize(vec3(-xy, -halfCubeMapSize));
    }

    float remap(float x, float low1, float high1, float low2, float high2) {
      return low2 + (x - low1) * (high2 - low2) / (high1 - low1);
    }

    float saturate(float x) {
      return clamp(x, 0.0, 1.0);
    }`),t.code.add(ee`
    float getCloudShape(vec3 pos, float pOffset) {
      const float textureWidth = ${ee.float(rh)};
      const float dataWidth = ${ee.float(rh)};
      const float tileRows = ${ee.float(Qd)};
      const vec3 atlasDimensions = vec3(${ee.float(ld)}, ${ee.float(ld)}, tileRows * tileRows);

      //Change from Y being height to Z being height
      vec3 p = float(${ee.float(lrt)}) * pos.xzy;

      //Pixel coordinates of point in the 3D data
      vec3 coord = vec3(mod(p - pOffset * atlasDimensions, atlasDimensions));
      float f = fract(coord.z);
      float level = floor(coord.z);
      float tileY = floor(level / tileRows);
      float tileX = level - tileY * tileRows;

      //The data coordinates are offset by the x and y tile, the two boundary cells between each tile pair and the initial boundary cell on the first row/column
      vec2 offset = atlasDimensions.x * vec2(tileX, tileY) + 2.0 * vec2(tileX, tileY) + 1.0;
      vec2 pixel = coord.xy + offset;
      vec2 data = texture2D(cloudShapeTexture, mod(pixel, dataWidth) / textureWidth).xy;

      return 1.0 - mix(data.x, data.y, f);
    }

    float getCloudMap(vec2 p){
      // Non-power-of-two textures can't be tiled using WebGL1
      // Get fractional part of uv to tile
      // Shift the texture center to origin to avoid seam artifacts
      vec2 uv = fract((${ee.float(urt)} * p) / ${ee.float(rh)} + 0.5);

      return texture2D(cloudShapeTexture, uv).a;
    }
    `),t.code.add(ee`float clouds(vec3 p) {
float cloud = saturate(0.5 * mix(0.0, 1.0, min(2.0 * coverage, 1.0)));
if (cloud <= 0.0) {
return 0.0;
}
float cloudMap = getCloudMap(cloudSize * p.xy);
cloud = mix(cloud, min(2.0 * (coverage), 1.0) * cloudMap, min(2.0 * (1.0 - coverage), 1.0));
if (cloud <= 0.0) {
return 0.0;
}
float shape = getCloudShape(8.0 * cloudSize * p, 0.0);
cloud = saturate(remap(cloud, smoothness * shape, 1.0, 0.0, 1.0));
if (cloud <= 0.0) {
return 0.0;
}
float heightFraction = saturate((length(p) - cloudRadius - cloudStart) / cloudHeight);
cloud *= saturate(remap(heightFraction, 0.0, 0.25, 0.0, 1.0)) * smoothstep(1.0, 0.25, heightFraction);
if (cloud <= 0.0) {
return 0.0;
}
return density * saturate(remap(cloud, 0.35 * smoothness * getCloudShape(detailSize * p, 0.0), 1.0, 0.0, 1.0));
}`),t.code.add(ee`vec2 sphereIntersections(vec3 start, vec3 dir, float radius) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float c = dot(start, start) - (radius * radius);
float d = (b * b) - 4.0 * a * c;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}
float HenyeyGreenstein(float g, float costh) {
return (1.0 / (4.0 * 3.1415))  * ((1.0 - g * g) / pow(1.0 + g * g - 2.0 * g * costh, 1.5));
}`),t.code.add(`
    float multipleOctaves(float extinction, float mu, float stepL) {
      float attenuation = 1.0;
      float contribution = 1.0;
      float phaseAttenuation = 1.0;
      float luminance = 0.0;

      for (int i = 0; i < 4; i++) {
        float phase = mix(HenyeyGreenstein(0.0, mu), HenyeyGreenstein(0.3 * phaseAttenuation, mu), 0.7);
        luminance += contribution * phase * exp(-stepL * extinction * sigmaE * attenuation);
        attenuation *= 0.2;
        contribution *= 0.6;
        phaseAttenuation *= 0.5;
      }

      return luminance;
    }`),t.code.add(ee`float lightRay(vec3 org, vec3 p, float phaseFunction, float mu, vec3 sunDirection) {
float lightRayDensity = clouds(p);
lightRayDensity += clouds(p + sunDirection * 1.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 2.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 3.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 4.0 * stepL);
lightRayDensity += clouds(p + sunDirection * 5.0 * stepL);
float beersLaw = multipleOctaves(lightRayDensity, mu, stepL);
return mix(beersLaw * 2.0 * (1.0 - (exp(-stepL * lightRayDensity * 2.0 * sigmaE ))), beersLaw, 0.5 + 0.5 * mu);
}`),t.code.add(ee`float mainRay(vec3 org, vec3 dir, vec3 sunDirection, float distToStart, float totalDistance, out float totalTransmittance) {
if (dir.z < 0.0) {
return 0.0;
}
totalTransmittance = 1.0;
float stepS = totalDistance / float(STEPS);
float cameraHeight = length(org);
float mu = 0.5 + 0.5 * dot(sunDirection, dir);
float phaseFunction = mix(HenyeyGreenstein(-0.3, mu), HenyeyGreenstein(0.3, mu), 0.7);
vec3 p = org + distToStart  * dir;
float dist = distToStart;
float shading = 0.0;
for (int i = 0; i < STEPS; i++) {
float sampleDensity = clouds(p);
float sampleSigmaE = sampleDensity * sigmaE;
if (sampleDensity > 0.0 ) {
float ambient = mix((1.2), (1.6), saturate((length(p) - cloudRadius - cloudStart) / cloudHeight));
float luminance = sampleDensity * (ambient + power * phaseFunction * lightRay(org, p, phaseFunction, mu, sunDirection));
float transmittance = exp(-sampleSigmaE * stepS);
shading += totalTransmittance * (luminance - luminance * transmittance) / sampleSigmaE;
totalTransmittance *= transmittance;
if (totalTransmittance <= 0.001) {
totalTransmittance = 0.0;
break;
}
}
dist += stepS;
p = org + dir * dist;
}
return shading;
}`),t.code.add(ee`void main() {
if (coverage ==  0.0) {
gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
return;
}
vec3 rayDir = rayDirection(gl_FragCoord.xy);
rayDir = normalize(view * rayDir);
vec3 viewPos = vec3(0, 0, cloudRadius + 1.0);
bool hitsPlanet = rayDir.z < 0.0;
float hazeFactor = smoothstep(-0.01, mix(0.0, 0.075, cloudVariables.x), abs(dot(rayDir, vec3(0, 0, 1))));
float totalTransmittance = 1.0;
float shading = 0.0;
if (hitsPlanet) {
shading = clamp(1.0 - cloudVariables.y, 0.6, 1.0) * (1.0 - hazeFactor);
totalTransmittance = hazeFactor;
gl_FragColor = vec4(shading, totalTransmittance, shading, totalTransmittance);
return;
}
vec2 rayStartIntersect = sphereIntersections(viewPos, rayDir, cloudRadius + cloudStart);
vec2 rayEndIntersect = sphereIntersections(viewPos, rayDir, cloudRadius + cloudStart + cloudHeight);
float distToStart = rayStartIntersect.y;
float totalDistance = rayEndIntersect.y - distToStart;
vec3 sunDirection = normalize(vec3(0, 0, 1));
shading = 0.5 * mainRay(viewPos, rayDir, sunDirection, distToStart, totalDistance, totalTransmittance);
shading = mix(clamp(1.0 - cloudVariables.y, 0.6, 1.0), shading, hazeFactor);
totalTransmittance = mix(0.0, totalTransmittance, hazeFactor);
gl_FragColor = vec4(shading, totalTransmittance, shading, totalTransmittance);
}`),e}const hrt=xt(),prt=Object.freeze(Object.defineProperty({__proto__:null,CloudsPassParameters:Ehe,CloudsDrawParameters:Ahe,build:drt},Symbol.toStringTag,{value:"Module"}));let VU=class extends _n{constructor(e,t){super(e,t,()=>this.destroy())}initializeProgram(e){return new gn(e.rctx,VU.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:vf(vt.CONSTANT_COLOR,vt.ONE_MINUS_CONSTANT_COLOR,m2.ADD,this.configuration.writeTextureChannels===HB.RG?[1,1,0,0]:[0,0,1,1]),depthTest:{func:lo.LEQUAL},colorWrite:$i})}};VU.shader=new bn(prt,()=>Ee(()=>import("./Clouds.glsl-4cbde1a0.js"),["./Clouds.glsl-4cbde1a0.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./mat3f64-c6305894.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));var wu;(function(i){i[i.Full=0]="Full",i[i.WeatherMap=1]="WeatherMap",i[i.COUNT=2]="COUNT"})(wu||(wu={}));let w6=class extends ic{constructor(){super(...arguments),this.mode=wu.Full}};f([Pe({count:wu.COUNT})],w6.prototype,"mode",void 0);let Mhe=class extends Es{constructor(){super(...arguments),this.weatherTile=dn(0,0)}};function frt(i){const e=new Nr;return e.include(dg,!1),e.fragment.code.add(ee`float remap(float x, float low1, float high1, float low2, float high2) {
return low2 + (x - low1) * (high2 - low2) / (high1 - low1);
}`),i.mode===wu.Full&&e.fragment.code.add(ee`
    float saturate(float x) {
      return clamp(x, 0.0, 1.0);
    }

    // Safer modulo for positive and negative values
    vec3 modulo(vec3 m, float n){
      return mod(mod(m, n) + n, n);
    }

    vec3 hash(vec3 p3, float frequency){
      p3 = modulo(p3, frequency);
      p3 = fract(p3 * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yxz + 33.33);
      return -1.0 + 2.0 * fract((p3.xxy + p3.yxx) * p3.zyx);
    }

    // 5th order polynomial interpolation
    vec3 fade(vec3 t){
      return (t * t * t) * (t * (t * 6.0 - 15.0) + 10.0);
    }

    float gradientNoise(vec3 p, float frequency){
      // Cell point is in
      vec3 i = floor(p);

      // Position in the cell in [0, 1]
      vec3 f = fract(p);

      // Interpolation value for gradient mixing
      vec3 u = fade(f);

      // Trilinear interpolation of gradients at cube vertices around point
      return mix( mix( mix( dot( hash( i + vec3(0.0,0.0,0.0), frequency), f - vec3(0.0,0.0,0.0) ),
                            dot( hash( i + vec3(1.0,0.0,0.0), frequency), f - vec3(1.0,0.0,0.0) ), u.x),
                       mix( dot( hash( i + vec3(0.0,1.0,0.0), frequency), f - vec3(0.0,1.0,0.0) ),
                            dot( hash( i + vec3(1.0,1.0,0.0), frequency), f - vec3(1.0,1.0,0.0) ), u.x), u.y),
                  mix( mix( dot( hash( i + vec3(0.0,0.0,1.0), frequency), f - vec3(0.0,0.0,1.0) ),
                            dot( hash( i + vec3(1.0,0.0,1.0), frequency), f - vec3(1.0,0.0,1.0) ), u.x),
                       mix( dot( hash( i + vec3(0.0,1.0,1.0), frequency), f - vec3(0.0,1.0,1.0) ),
                            dot( hash( i + vec3(1.0,1.0,1.0), frequency), f - vec3(1.0,1.0,1.0) ), u.x), u.y), u.z );
    }

    float getPerlinNoise(vec3 pos, float frequency) {
      float octaveFrequencyFactor = 2.0;
      float sum = 0.0;
      float weightSum = 0.0;
      float weight = 1.0;

      for (int oct = 0; oct < 3; oct++) {
        vec3 p = pos * frequency;
        float val = 0.5 + 0.5 * gradientNoise(p, frequency);
        sum += val * weight;
        weightSum += weight;
        weight *= 0.5;
        frequency *= octaveFrequencyFactor;
      }

      float noise = (sum / weightSum);
      noise = saturate(noise);
      return noise;
    }

    float worley(vec3 pos, float numCells) {
      vec3 p = pos * numCells;
      float d = 1.0e10;

      for (int x = -1; x <= 1; x++) {
        for (int y = -1; y <= 1; y++) {
          for (int z = -1; z <= 1; z++) {
            vec3 tp = floor(p) + vec3(x, y, z);
            tp = p - tp - (hash(tp, numCells) * 0.5 + 0.5);
            d = min(d, dot(tp, tp));
          }
        }
      }

      return 1.0 - clamp(d, 0.0, 1.0);
    }

    vec3 get3Dfrom2D(vec2 uv) {
      vec2 tile = floor(uv);
      float z = floor(${ee.float(Qd)} * tile.y + tile.x);
      return vec3(fract(uv), z);
    }

    float getTextureForPointPerlinWorley(vec3 p) {
      float perlinNoise = getPerlinNoise(p, ${ee.float(8)});

      float worley0 = worley(p, ${ee.float(2)} * 2.0);
      float worley1 = worley(p, ${ee.float(2)} * 8.0);
      float worley2 = worley(p, ${ee.float(2)} * 14.0);

      float worleyFBM = worley0 * 0.625 + worley1 * 0.25 + worley2 * 0.125;
      return remap(perlinNoise, 0.0, 1.0, worleyFBM, 1.0);
    }

    float getTextureForPointWorley(vec3 p) {
      float worley0 = worley(p, ${ee.float(2)});
      float worley1 = worley(p, ${ee.float(2)} * 2.0);
      float worley2 = worley(p, ${ee.float(2)} * 4.0);
      float worley3 = worley(p, ${ee.float(2)} * 8.0);

      float FBM0 = worley0 * 0.625 + worley1 * 0.25 + worley2 * 0.125;
      float FBM1 = worley1 * 0.625 + worley2 * 0.25 + worley3 * 0.125;
      float FBM2 = worley2 * 0.75 + worley3 * 0.25;

      return FBM0 * 0.625 + FBM1 * 0.25 + FBM2 * 0.125;
    }
  `),e.fragment.uniforms.add(new hl("weatherTile",t=>t.weatherTile)),e.fragment.code.add(ee`
    vec2 modulo(vec2 m, float n){
      return mod(mod(m, n) + n, n);
    }

    vec2 hash(vec2 p){
      // Get position of p in weather tile
      p = modulo(p, ${ee.float(mF)});

      // Get global coordinates of p
      p += weatherTile * ${ee.float(mF)};

      // Limit position to avoid numerical instability
      p = modulo(p, ${ee.float(crt)});

      vec3 p3 = fract(vec3(p.xyx) * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yzx + 33.33);
      return 2.0 * fract((p3.xx + p3.yz) * p3.zy) - 1.0;
    }

    vec2 fade(vec2 t){
      return (t * t * t) * (t * (t * 6.0 - 15.0) + 10.0);
    }

    float gradientNoise(vec2 p){
      vec2 i = floor( p );
      vec2 f = fract( p );

      vec2 u = fade(f);

      // Bilinear interpolation of gradients at cell vertices around point
      return  mix(
                mix(dot( hash( i + vec2(0.0,0.0) ), f - vec2(0.0,0.0) ),
                    dot( hash( i + vec2(1.0,0.0) ), f - vec2(1.0,0.0) ), u.x),
                mix(dot( hash( i + vec2(0.0,1.0) ), f - vec2(0.0,1.0) ),
                    dot( hash( i + vec2(1.0,1.0) ), f - vec2(1.0,1.0) ), u.x),
                u.y);
    }

    float worley(vec2 p){
      float d = 1.0e10;
      for (int x = -1; x <= 1; x++){
        for (int y = -1; y <= 1; y++){
                vec2 tp = floor(p) + vec2(x, y);
                tp = p - tp - (0.5 + 0.5 * hash(tp));
                d = min(d, dot(tp, tp));
            }
        }
      return 1.0 - clamp(d, 0.0, 1.0);
    }
  `),e.fragment.code.add(ee`void main() {`),i.mode===wu.Full&&e.fragment.code.add(ee`
        float padWidth = 1.0;
        float paddedSize = ${ee.float(ld)} + 2.0 * padWidth;
        float tileCount = ${ee.float(Qd)} * ${ee.float(Qd)};
        vec2 tile = floor((gl_FragCoord.xy - 0.5) / paddedSize);

        bool padCell = false;
        if (mod(gl_FragCoord.x, paddedSize) == 0.5 || mod(gl_FragCoord.x, paddedSize) == paddedSize - 0.5) {
          padCell = true;
        }

        if (mod(gl_FragCoord.y, paddedSize) == 0.5 || mod(gl_FragCoord.y, paddedSize) == paddedSize - 0.5) {
          padCell = true;
        }

        bool startPadX = false;
        bool startPadY = false;
        bool endPadX = false;
        bool endPadY = false;

        if (gl_FragCoord.x == tile.x * paddedSize + 0.5) {
          startPadX = true;
        }

        if (gl_FragCoord.y == tile.y * paddedSize + 0.5) {
          startPadY = true;
        }

        if (gl_FragCoord.x == (tile.x + 1.0) * paddedSize - 0.5) {
          endPadX = true;
        }

        if (gl_FragCoord.y == (tile.y + 1.0) * paddedSize - 0.5) {
          endPadY = true;
        }

        vec2 padding = vec2(2.0 * padWidth) * tile;
        vec2 uv;

        if (padCell) {
          vec2 pixel = gl_FragCoord.xy - padWidth - padding;

          if (startPadX) {
            pixel.x += ${ee.float(ld)};
          }

          if (startPadY) {
            pixel.y += ${ee.float(ld)};
          }

          if (endPadX) {
            pixel.x -= ${ee.float(ld)};
          }

          if (endPadY) {
            pixel.y -= ${ee.float(ld)};
          }

          uv = vec2(pixel.xy / ${ee.float(ld)});
        } else {
          vec2 pixel = gl_FragCoord.xy - padWidth - padding;
          uv = vec2(pixel.xy / ${ee.float(ld)});
        }

        vec3 p_ = get3Dfrom2D(uv);
        vec3 p = p_;
        p.z /= (${ee.float(Qd)} * ${ee.float(Qd)});

        float worleyPerlinNoise = getTextureForPointPerlinWorley(p);
        float worleyNoise = getTextureForPointWorley(p);

        gl_FragColor.r = saturate(remap(worleyPerlinNoise, worleyNoise, 1.0, 0.0, 1.0));

        p_ = mod(p_ + 1.0, ${ee.float(Qd)} * ${ee.float(Qd)});
        p = p_;
        p.z /= (${ee.float(Qd)} * ${ee.float(Qd)});

        worleyPerlinNoise = getTextureForPointPerlinWorley(p);
        worleyNoise = getTextureForPointWorley(p);

        gl_FragColor.g = saturate(remap(worleyPerlinNoise, worleyNoise, 1.0, 0.0, 1.0));
      `),e.fragment.code.add(ee`
      vec2 mapUV = ${ee.float(mF)} * (gl_FragCoord.xy / ${ee.float(rh)});
      float map = abs(gradientNoise(mapUV));
      map = remap(map, 0.25 * (1.0 - worley(8.0 * mapUV)), 1.0, 0.0, 1.0);

      ${i.mode===wu.Full?ee`gl_FragColor.ba = vec2(0.0, map);`:ee`gl_FragColor = vec4(map);`};
    }
  `),e}const mrt=Object.freeze(Object.defineProperty({__proto__:null,NoiseTextureAtlasPassParameters:Mhe,build:frt},Symbol.toStringTag,{value:"Module"}));let D$=class extends _n{initializeProgram(e){return new gn(e.rctx,D$.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:this.configuration.mode===wu.Full?vf(vt.ONE,vt.ZERO):Na(vt.ZERO,vt.ONE,vt.ONE,vt.ZERO),depthTest:{func:lo.ALWAYS},colorWrite:$i})}};D$.shader=new bn(mrt,()=>Ee(()=>import("./NoiseTextureAtlas.glsl-3f04e375.js"),["./NoiseTextureAtlas.glsl-3f04e375.js","./vec2f64-30dc1443.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let OS=class extends et{constructor(e){super(e),this._needsRender=!0,this._passParameters=new Mhe,this._frameBuffer=new ma(e.context.renderContext.rctx,{colorTarget:ka.TEXTURE,width:rh,height:rh},{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR,hasMipmap:!1,width:rh,height:rh}),this._vao=tc(e.context.renderContext.rctx)}get _techniqueRepository(){return this.context.shaderTechniqueRepository}get textureAtlas(){return T(this._texture)?T(this._weatherMapTechnique)&&this._weatherMapTechnique.compiled&&this._needsRender&&(this._texture=this._render(wu.WeatherMap)):T(this._fullTechnique)&&this._fullTechnique.compiled&&(this._texture=this._render(wu.Full)),this._texture}_setDirty(){this._needsRender=!0}updateWeatherMap(e){this._passParameters.weatherTile[0]===e[0]&&this._passParameters.weatherTile[1]===e[1]||(Zs(this._passParameters.weatherTile,e),this._setDirty())}destroy(){this._fullTechniqueCached=Lr(this._fullTechniqueCached),this._weatherMapTechniqueCached=Lr(this._weatherMapTechniqueCached),this._frameBuffer=Ht(this._frameBuffer),this._vao=Ht(this._vao)}get _fullTechnique(){if(B(this._fullTechniqueCached)){const e=new w6;e.mode=wu.Full,this._fullTechniqueCached=this._techniqueRepository.acquire(D$,e)}return this._fullTechniqueCached}get _weatherMapTechnique(){if(B(this._weatherMapTechniqueCached)){const e=new w6;e.mode=wu.WeatherMap,this._weatherMapTechniqueCached=this._techniqueRepository.acquire(D$,e)}return this._weatherMapTechniqueCached}_render(e){if(B(this._vao)||B(this._frameBuffer))return null;const t=e===wu.Full?this._fullTechnique:this._weatherMapTechnique,n=this.context.renderContext.rctx,r=n.getViewport();n.setViewport(0,0,rh,rh),n.bindFramebuffer(this._frameBuffer);const s=n.bindTechnique(t,this._passParameters,null);return n.bindVAO(this._vao),s.assertCompatibleVertexAttributeLocations(this._vao),n.gl.drawArrays(n.gl.TRIANGLE_STRIP,0,4),n.setViewport(r.x,r.y,r.width,r.height),this._needsRender=!1,this._frameBuffer.colorTexture}};f([y({constructOnly:!0})],OS.prototype,"context",void 0),f([y({readOnly:!0})],OS.prototype,"_techniqueRepository",null),OS=f([ge("esri.views.3d.environment.NoiseTextureAtlas")],OS);let nD=class{constructor(e,t,n){this.shadowMap=e,this.ssaoHelper=t,this.slicePlane=n,this.slot=at.OPAQUE_MATERIAL,this.hasOccludees=!1,this.enableFillLights=!0,this._inverseViewport=xt(),this.oldLighting=new ek,this.newLighting=new ek,this._fadedLighting=new ek,this._lighting=this.newLighting,this.ssr=new obe,this.multipassTerrain=new Gbe,this.multipassGeometry=new Ube,this.overlays=[],this.cloudsFade=new lbe}get camera(){return this._camera}set camera(e){this._camera=this.ssr.camera=e,this._inverseViewport[0]=1/e.fullViewport[2],this._inverseViewport[1]=1/e.fullViewport[3]}get inverseViewport(){return this._inverseViewport}get lighting(){return this._lighting}get weatherFading(){return this._lighting===this._fadedLighting}fadeLighting(e){const{oldLighting:t,newLighting:n}=this;e>=1?this._lighting=n:(this._fadedLighting.lerpLighting(t,n,e),this._lighting=this._fadedLighting)}},Ml=class extends et{constructor(e){super(e),this.runOncePerFrame=!0,this._handles=new mi,this._techniques=new Array,this._techniqueConfiguration=new iI,this._bindParameters=new nD(null,null,null),this._passParameters=new Ehe,this._drawParameters=new Ahe,this._weatherTile=xt(),this._weatherTileCount=128,this._faceIndex=0,this._tileIndex=0,this.coverage=ki(bo.default.coverage[0],bo.default.coverage[1],.5),this.density=ki(bo.default.density[0],bo.default.density[1],.5),this.absorption=ki(bo.default.absorption[0],bo.default.absorption[1],.5),this.cloudSize=ki(bo.default.cloudSize[0],bo.default.cloudSize[1],.5),this.detailSize=ki(bo.default.detailSize[0],bo.default.detailSize[1],.5),this.smoothness=ki(bo.default.smoothness[0],bo.default.smoothness[1],.5),this.cloudHeight=ki(bo.default.cloudHeight[0],bo.default.cloudHeight[1],.5),this.raymarchingSteps=bo.default.raymarchingSteps,this._viewMatrix=St(),this._dirty=!1,this.running=!1}_getTechnique(e){const t=1-this.context.renderContext.bindParameters.cloudsFade.readChannels,n=t===HB.RG?2*e:2*e+1;return this._techniques[n]||(this._techniqueConfiguration.writeTextureChannels=t,this._techniqueConfiguration.steps=e,this._techniques[n]=new VU({rctx:this.context.renderContext.rctx,viewingMode:this.view.state.viewingMode},this._techniqueConfiguration),this._techniques[n])}updateWeatherTile(){const e=this.view.camera.position.latitude,t=this.view.camera.position.longitude;Bi(this._weatherTile,(e+90)/180,(t+180)/360);const n=Math.floor(this._weatherTileCount*Math.abs(2*this._weatherTile[0]-1));this._weatherTile[0]=Math.floor(2*this._weatherTileCount*this._weatherTile[0]),this._weatherTile[1]=Math.floor(4*(this._weatherTileCount-n)*this._weatherTile[1]);let r=0,s=0;if(T(this.view.environment)&&this.view.environment.lighting.type!=="virtual"&&T(this.view.environment.lighting.date)){const a=new Date(this.view.environment.lighting.date);a.setUTCHours(this.view.environment.lighting.date.getUTCHours()+this.view.environment.lighting.displayUTCOffset),r=31*a.getUTCMonth()+a.getUTCDate(),s=a.getUTCFullYear()}this._weatherTile[0]=(this._weatherTile[0]+r)%(2*this._weatherTileCount),this._weatherTile[1]=(this._weatherTile[1]+s%100)%(4*this._weatherTileCount),SB(this._passParameters.weatherTile,this._weatherTile)||this.setDirty()}initialize(){this._vao=tc(this.context.renderContext.rctx);const e=rn(this.view.spatialReference);this._passParameters.cloudRadius=.5*e.radius,this.setDirty(),this.updateWeatherTile(),this._handles.add([this.view.resourceController.scheduler.registerTask($r.CLOUDS_GENERATOR,this),ue(()=>[this.coverage,this.density,this.absorption,this.cloudSize,this.detailSize,this.smoothness,this.cloudHeight,this.raymarchingSteps],()=>this.setDirty(),At)])}destroy(){this._handles.destroy(),this._techniques.forEach(e=>Lr(e)),this._frameBufferCube=Ht(this._frameBufferCube),this._techniques.length=0,this._vao=Ht(this._vao),this._passParameters.noiseTexture=_t(this._passParameters.noiseTexture)}get _tilesPerFace(){switch(this._techniqueConfiguration.steps){case Hl.SIXTEEN:return 1;case Hl.HUNDRED:return 4;case Hl.COUNT:case Hl.TWOHUNDRED:return 8}}_ensureNoiseTexture(){if(T(this._passParameters.noiseTexture))this._passParameters.noiseTexture.updateWeatherMap(this._passParameters.weatherTile);else{const e=this.context;this._passParameters.noiseTexture=new OS({context:e}),this._passParameters.noiseTexture.updateWeatherMap(this._passParameters.weatherTile)}return T(this._passParameters.noiseTexture.textureAtlas)}_ensureFrameBufferCube(e){if(B(this._frameBufferCube)){const t={target:Wn.TEXTURE_CUBE_MAP,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR,hasMipmap:!1,width:e,height:e};this._frameBufferCube=new ma(this.context.renderContext.rctx,{colorTarget:ka.CUBEMAP,width:e,height:e},t)}return this._frameBufferCube}get cubeMap(){return this._frameBufferCube}destroyFrameBufferCube(){this._frameBufferCube=Ht(this._frameBufferCube)}applyPreset(e,t){const n=e.median,r=s=>{const a=ki(s[0],s[1],n);return t<.5?ki(s[0],a,2*t):ki(a,s[1],2*(t-.5))};this.coverage=r(e.coverage),this.density=r(e.density),this.absorption=r(e.absorption),this.cloudSize=r(e.cloudSize),this.detailSize=r(e.detailSize),this.smoothness=r(e.smoothness),this.cloudHeight=r(e.cloudHeight),this.raymarchingSteps=e.raymarchingSteps}setDirty(){this._dirty=this.running=!0}runTask(e){if(B(this._vao))return this._dirty=this.running=!1,void(this.context.renderContext.bindParameters.cloudsFade.renderingStage=Ws.FINISHED_RENDERING);this._faceIndex===0&&this._tileIndex===0&&(this._passParameters.raymarchingSteps=this.raymarchingSteps,this.updateWeatherTile(),Zs(this._passParameters.weatherTile,this._weatherTile));const t=this._getTechnique(this._passParameters.raymarchingSteps);if(!t.compiled||!this.context.renderContext.bindParameters.cloudsFade.isCameraPositionFinal||this.context.renderContext.bindParameters.cloudsFade.isFading||!this._ensureNoiseTexture())return;this._faceIndex===0&&this._tileIndex===0&&(this.context.renderContext.bindParameters.cloudsFade.renderingStage=Ws.RENDERING,this._passParameters.absorption=this.absorption,this._passParameters.density=this.density,this._passParameters.cloudSize=this.cloudSize,this._passParameters.detailSize=this.detailSize,this._passParameters.smoothness=this.smoothness,this._passParameters.cloudHeight=this.cloudHeight,this._passParameters.coverage=this.coverage,this._dirty=!1);const n=this.context.renderContext.rctx,r=n.bindTechnique(t,this._passParameters,this._bindParameters);n.bindVAO(this._vao),r.assertCompatibleVertexAttributeLocations(this._vao);const s=n.getViewport(),a=t.configuration.cubeMapSize,o=a/this._tilesPerFace,l=this._tileIndex*o;n.setViewport(0,l,a,o);const c=this._ensureFrameBufferCube(a);n.bindFramebuffer(c);const u=grt[this._faceIndex],d=vrt[this._faceIndex];R0e(this._viewMatrix,yrt,u,d),Um(this._drawParameters.viewMatrix,this._viewMatrix);const h=Wn.TEXTURE_CUBE_MAP_POSITIVE_X+this._faceIndex;c.setColorTextureTarget(h),r.bindDraw(this._drawParameters,this._bindParameters,this._passParameters),n.gl.drawArrays(n.gl.TRIANGLE_STRIP,0,4),n.gl.flush(),n.setViewport(s.x,s.y,s.width,s.height),this.requestRender(),e.madeProgress(),++this._tileIndex,this._faceIndex===4&&this._tileIndex===this._tilesPerFace?(this.running=this._dirty,this._faceIndex=0,this._tileIndex=0,this.context.renderContext.bindParameters.cloudsFade.renderingStage=Ws.FINISHED_RENDERING):this._tileIndex===this._tilesPerFace&&(++this._faceIndex,this._tileIndex=0)}};f([y({constructOnly:!0})],Ml.prototype,"context",void 0),f([y({constructOnly:!0})],Ml.prototype,"view",void 0),f([y({constructOnly:!0})],Ml.prototype,"requestRender",void 0),f([y()],Ml.prototype,"coverage",void 0),f([y()],Ml.prototype,"density",void 0),f([y()],Ml.prototype,"absorption",void 0),f([y()],Ml.prototype,"cloudSize",void 0),f([y()],Ml.prototype,"detailSize",void 0),f([y()],Ml.prototype,"smoothness",void 0),f([y()],Ml.prototype,"cloudHeight",void 0),f([y()],Ml.prototype,"raymarchingSteps",void 0),f([y()],Ml.prototype,"running",void 0),Ml=f([ge("esri.views.3d.environment.CloudsGenerator")],Ml);const grt=[Un(1,0,0),Un(-1,0,0),Un(0,1,0),Un(0,-1,0),Un(0,0,1)],vrt=[Un(0,1,0),Un(0,1,0),Un(0,0,-1),Un(0,0,1),Un(0,1,0)],yrt=Fbe();let BU=class extends Es{constructor(){super(...arguments),this.fogColor=q(),this.hazeColor=q(),this.fogStrength=4e-6,this.hazeStrength=4e-6,this.atmosphereC=1}};function _rt(i){const e=new Nr;e.attributes.add(j.POSITION,"vec2"),e.include(YL,{textureCoordinateType:yy.Default}),e.varyings.add("worldRay","vec3"),e.varyings.add("eyeDir","vec3");const{vertex:t,fragment:n}=e;return t.uniforms.add([new pl("inverseProjectionMatrix",(r,s)=>s.camera.inverseProjectionMatrix),new pl("inverseViewMatrix",(r,s)=>Da(brt,s.camera.viewMatrix))]),t.code.add(ee`void main(void) {
vec3 posViewNear = (inverseProjectionMatrix * vec4(position, -1, 1)).xyz;
eyeDir = posViewNear;
worldRay = (inverseViewMatrix * vec4(posViewNear, 0)).xyz;
forwardTextureCoordinates();
gl_Position = vec4(position, 1, 1);
}`),n.uniforms.add(new Hi("atmosphereC",r=>r.atmosphereC)),n.uniforms.add(new Io("cameraPosition",(r,s)=>s.camera.eye)),n.uniforms.add(new hl("nearFar",(r,s)=>s.camera.nearFar)),n.uniforms.add(new sn("depthTex",r=>r.depthTexture)),n.uniforms.add(new Hi("fogStrength",r=>i.haze?r.hazeStrength:r.fogStrength)),n.uniforms.add(new Hi("fogAmount",r=>i.haze?r.hazeAmount:r.fogAmount)),n.uniforms.add(new Io("fogColor",r=>i.haze?r.hazeColor:r.fogColor)),e.include(UB),n.include(eb),n.code.add(ee`vec2 sphereIntersect(vec3 start, vec3 dir) {
float a = dot(dir, dir);
float b = 2.0 * dot(dir, start);
float d = (b * b) - 4.0 * a * atmosphereC;
if (d < 0.0) {
return vec2(1e5, -1e5);
}
return vec2((-b - sqrt(d)) / (2.0 * a), (-b + sqrt(d)) / (2.0 * a));
}`),n.code.add(ee`vec4 applyFog(float dist, vec3 rayDir){
if(dist == -1.0){
vec2 rayAtmosphereIntersect = sphereIntersect(cameraPosition, rayDir);
dist = 0.055 * rayAtmosphereIntersect.y;
}
float fogAmount = fogAmount * (1.0 - exp(-dist * fogStrength));
return vec4(fogAmount * fogColor, fogAmount);
}`),n.code.add(ee`
    vec3 tonemapACES(vec3 x) {
      return clamp((x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14), 0.0, 1.0);
    }

    void main() {
      vec3 rayDir = normalize(worldRay);
      float terrainDepth = -1.0;

      float depthSample = texture2D(depthTex, vuv0).r;
      float zNorm = 2.0 * depthSample - 1.0;
      float linDepth = 2.0 * nearFar[0] * nearFar[1] / (nearFar[1] + nearFar[0] - zNorm * (nearFar[1] - nearFar[0]));
      if(depthSample < 1.0 && depthSample > 0.0){
        vec3 cameraSpaceRay = normalize(eyeDir);
        cameraSpaceRay /= cameraSpaceRay.z;
        cameraSpaceRay *= linDepth;
        terrainDepth = max(0.0, length(cameraSpaceRay));
      }

      ${i.haze?ee`
          if(terrainDepth == -1.0){
            gl_FragColor = vec4(0);
            return;
          }`:""}

      vec4 fog = applyFog(terrainDepth, rayDir);

      gl_FragColor = delinearizeGamma(vec4(tonemapACES(fog.rgb), fog.a));
    }
  `),e}const brt=St(),Phe=Object.freeze(Object.defineProperty({__proto__:null,FogHazePassParameters:BU,build:_rt},Symbol.toStringTag,{value:"Module"}));let zU=class extends _n{initializeProgram(e){return new gn(e.rctx,zU.shader.get().build(this.configuration),Mn)}initializePipeline(){return this.configuration.haze?yi({blending:Na(vt.ONE,vt.ZERO,vt.ONE_MINUS_SRC_COLOR,vt.ONE),colorWrite:$i}):yi({blending:Na(vt.SRC_ALPHA,vt.ZERO,vt.ONE_MINUS_SRC_ALPHA,vt.ONE),colorWrite:$i})}};zU.shader=new bn(Phe,()=>Ee(()=>import("./FogHaze.glsl-74b7f5ba.js"),["./FogHaze.glsl-74b7f5ba.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./vec3-a020a6f6.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./FloatPassUniform-d2dfc562.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./vec3f32-c9aa289f.js","./compilerUtils-034cacb8.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let UU=class extends ic{constructor(){super(...arguments),this.haze=!1}};f([Pe()],UU.prototype,"haze",void 0);const wrt=.95,xrt=1;let RS=class extends et{constructor(e){super(e),this._passParameters=new BU;const t=e.context.renderContext.rctx;this._vao=tc(t,KA);const n=rn(e.view.spatialReference);this._planetRadius=n.radius,this._atmosphereRadius=n.radius+uA}destroy(){this._thickFogTechniqueCached=Lr(this._thickFogTechniqueCached),this._vao=Ht(this._vao)}get _shaderTechniqueRepository(){return this.context.shaderTechniqueRepository}set strength(e){this._passParameters.fogStrength=e}get strength(){return this._passParameters.fogStrength}get _thickFogTechnique(){if(B(this._thickFogTechniqueCached)){const e=new UU;e.haze=!1,this._thickFogTechniqueCached=this._shaderTechniqueRepository.acquire(zU,e)}return this._thickFogTechniqueCached}render(e,t){if(this._update(e,t),this._passParameters.fogAmount<=0)return;const n=this._thickFogTechnique;if(!n.compiled)return void this.context.requestRender();const r=e.offscreenRenderingHelper;r.renderDepthDetached(()=>{this._passParameters.depthTexture=r.depthTexture;const s=e.rctx.bindTechnique(n,this._passParameters,e.bindParameters);this._renderFog(s,e)})}_renderFog(e,t){if(B(this._vao))return;const n=t.rctx;n.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),n.drawArrays(Qi.TRIANGLE_STRIP,0,4)}_update(e,t){const n=e.bindParameters.camera;mt(wX,n.eye);const r=Math.max(0,dt(wX,e.bindParameters.lighting.mainLight.direction)),s=t.color;Ye(xX,s,.1),oo(this._passParameters.fogColor,xX,s,r);const a=Et(n.eye),o=a*a;this._passParameters.atmosphereC=o-this._atmosphereRadius*this._atmosphereRadius,this._passParameters.fogAmount=(1-Nx(wrt*od,xrt*od,Math.abs(a-this._planetRadius)))*t.amount,this._passParameters.fogStrength=t.strength}static isSupported(e){return e.capabilities.depthTexture}};f([y({constructOnly:!0})],RS.prototype,"context",void 0),f([y({constructOnly:!0})],RS.prototype,"view",void 0),RS=f([ge("esri.views.3d.environment.Fog")],RS);let Crt=class{constructor(){this.color=q(),this.strength=0,this.amount=0}};const wX=q(),xX=q();var ff;(function(i){i[i.Cone=0]="Cone",i[i.Cylinder=1]="Cylinder",i[i.Underground=2]="Underground",i[i.COUNT=3]="COUNT"})(ff||(ff={}));let k$=class extends yf{constructor(){super(...arguments),this.geometry=ff.Cone}};f([Pe({count:ff.COUNT})],k$.prototype,"geometry",void 0);let HU=class extends Es{constructor(){super(...arguments),this.texV=xt(),this.altitudeFade=0,this.innerScale=0,this.undergroundFadeAlpha=0,this.silhouette=new Ohe}},Ohe=class{constructor(){this.center=q(),this.v1=q(),this.v2=q()}};function Trt(i){const e=new Nr,{vertex:t,fragment:n}=e;if(XL(t),i.geometry===ff.Underground)e.attributes.add(j.POSITION,"vec2"),e.varyings.add("color","vec4"),t.uniforms.add([new Io("cameraPosition",(r,s)=>s.camera.eye),new Hi("undergroundFadeAlpha",r=>r.undergroundFadeAlpha)]),t.code.add(ee`void main(void) {
float ndotl = dot(normalize(cameraPosition), mainLightDirection);
float lighting = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));
color = vec4(vec3(lighting), undergroundFadeAlpha);
gl_Position = vec4(position.xy, 1.0, 1.0);
}`),n.code.add(ee`void main() {
gl_FragColor = color;
}`);else{e.include(Kne,i),e.attributes.add(j.POSITION,"vec3"),e.varyings.add("vtc","vec2"),e.varyings.add("falloff","float");const r=i.geometry===ff.Cylinder;t.uniforms.add([new pl("proj",(o,l)=>l.camera.projectionMatrix),new pl("view",(o,l)=>l.camera.viewMatrix)]),r||(e.varyings.add("innerFactor","float"),t.uniforms.add(new Io("silCircleCenter",o=>o.silhouette.center)),t.uniforms.add(new Io("silCircleV1",o=>o.silhouette.v1)),t.uniforms.add(new Io("silCircleV2",o=>o.silhouette.v2)),t.uniforms.add(new hl("texV",o=>o.texV)),t.uniforms.add(new Hi("innerScale",o=>o.innerScale)));const s=6.2831853,a=1/128;t.code.add(ee`
		void main(void) {
      ${r?ee`
      vec3 pos = position;
      float ndotl = mainLightDirection.z;
      vtc = vec2(0.0, position.z + 0.05);`:ee`
      innerFactor = clamp(-position.z, 0.0, 1.0);
      float scale = position.y * (1.0 + innerFactor * innerScale);
      float phi = position.x * ${ee.float(s*a)} + 1.0;
      vec3 pos =  (silCircleCenter + sin(phi) * silCircleV1 + cos(phi) * silCircleV2) * scale;
      float ndotl = dot(normalize(position.y > 0.0 ? pos: silCircleCenter), mainLightDirection);
      vtc.x = position.x  * ${ee.float(a)};
      vtc.y = texV.x * (1.0 - position.z) + texV.y * position.z;
      `}
      falloff = max(0.0, smoothstep(-1.0, 0.8, 2.0 * ndotl));

		  gl_Position = transformPosition(proj, view, pos);
		  gl_Position.z = gl_Position.w; // project atmosphere onto the far plane
    }
	  `),n.uniforms.add(new sn("tex",o=>o.texture)),r||n.uniforms.add(new Hi("altitudeFade",o=>o.altitudeFade)),n.code.add(ee`
		void main() {
			vec4 atmosphereColor = texture2D(tex, vtc) * falloff;
      ${r?ee`gl_FragColor = atmosphereColor;`:ee`
			vec4 innerColor = vec4(atmosphereColor.rgb, 1.0 - altitudeFade);
			gl_FragColor = mix(atmosphereColor, innerColor, smoothstep(0.0, 1.0, innerFactor));
      `}
    }`)}return e}const Srt=Object.freeze(Object.defineProperty({__proto__:null,SimpleAtmospherePassParameters:HU,SilhouetteCircle:Ohe,build:Trt},Symbol.toStringTag,{value:"Module"}));let dA=class extends _n{initializeProgram(e){return new gn(e.rctx,dA.shader.get().build(this.configuration),Mn)}initializePipeline(){return this.configuration.geometry===ff.Cylinder?yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),culling:Sne,depthTest:{func:lo.LEQUAL},colorWrite:$i}):yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),depthTest:{func:lo.LEQUAL},colorWrite:$i})}};dA.shader=new bn(Srt,()=>Ee(()=>import("./SimpleAtmosphere.glsl-47afb085.js"),["./SimpleAtmosphere.glsl-47afb085.js","./vec2f64-30dc1443.js","./vec3f64-2f9cef06.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const Rhe=new Uint8ClampedArray([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,6,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,10,0,0,0,10,0,0,0,10,0,0,0,10,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,13,0,0,0,13,0,0,0,13,0,0,0,13,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,0,0,0,15,16,0,0,16,16,0,0,16,16,0,0,16,16,0,0,16,15,0,0,17,15,0,0,17,15,0,0,17,15,0,0,17,14,0,0,18,14,0,0,18,14,0,0,18,13,0,0,19,13,0,0,19,13,0,0,19,13,0,0,19,13,0,0,20,13,0,0,20,13,0,0,20,13,0,0,20,12,0,0,21,12,0,0,21,12,0,0,21,12,0,0,21,12,0,0,22,12,0,0,22,12,0,0,22,12,0,0,22,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,24,11,0,0,24,11,0,0,24,11,0,0,24,10,0,0,25,10,0,0,25,10,0,0,25,10,0,0,26,10,0,0,26,10,0,0,26,10,0,0,26,9,0,0,27,9,0,0,27,9,0,0,27,18,0,0,28,18,0,0,28,18,0,0,28,18,0,0,28,18,0,0,29,18,0,0,29,18,0,0,29,17,0,0,30,17,0,0,30,17,0,0,30,17,0,0,30,16,0,0,31,16,0,0,31,16,0,0,31,16,0,0,32,16,0,0,32,16,0,0,32,15,0,0,33,15,0,0,33,15,0,0,33,15,0,0,34,15,8,0,34,15,8,0,34,15,8,0,34,15,7,0,35,15,7,0,35,15,7,0,35,21,7,0,36,21,7,0,36,21,7,0,36,21,7,0,37,21,7,0,37,21,7,0,37,20,7,0,38,20,7,0,38,20,7,0,38,20,7,0,39,20,7,0,39,20,7,0,39,20,7,0,39,19,6,0,40,19,6,0,40,19,6,0,40,19,6,0,41,19,6,0,41,19,6,0,41,18,6,0,42,18,6,0,42,18,6,0,42,24,6,0,43,24,6,0,43,24,6,0,43,23,6,0,44,23,6,0,44,23,6,0,44,23,6,0,45,23,6,0,45,23,6,0,45,22,6,0,46,22,6,0,46,22,6,0,46,22,5,0,47,22,5,0,47,22,5,0,47,21,5,0,48,21,5,0,48,21,5,0,48,21,5,0,49,21,5,0,49,26,5,0,49,25,5,0,50,25,5,0,50,25,5,0,50,25,5,0,51,25,5,0,51,25,5,0,51,25,5,0,52,25,5,0,52,25,5,0,52,24,5,0,53,24,5,0,53,24,5,0,53,24,9,0,54,28,9,0,54,28,9,0,54,28,9,0,55,28,9,0,55,27,9,0,56,27,9,0,56,27,9,0,56,27,9,4,57,27,9,4,57,27,9,4,57,26,9,4,58,26,9,4,58,26,9,4,58,26,9,4,59,26,9,4,59,26,9,4,59,26,8,4,60,30,8,4,60,30,8,4,60,29,8,4,61,29,8,4,61,29,8,4,62,29,8,4,62,29,8,4,62,28,8,4,63,28,8,4,63,28,8,4,63,28,12,4,64,28,12,4,64,28,12,4,64,27,12,4,65,27,12,8,65,27,12,8,65,31,12,8,66,31,12,8,66,30,11,8,67,30,11,8,67,30,11,8,67,30,11,8,68,30,11,8,68,30,11,8,68,30,15,7,69,30,15,7,69,30,15,7,69,33,15,11,70,33,15,11,70,32,14,11,71,32,14,11,71,32,14,11,71,32,18,14,72,32,18,14,72,32,18,14,72,31,17,14,73,35,17,14,73,34,17,17,74,34,21,17,74,34,21,17,74,34,20,17,75,34,20,20,75,34,20,20,75,34,23,20,76,34,23,20,76,36,23,23,77,36,23,23,77,36,23,23,77,36,23,23,78,36,26,26,78,36,26,26,78,36,26,26,79,36,26,29,79,38,26,29,80,38,29,29,80,38,29,29,80,38,28,31,81,38,28,31,81,38,31,31,81,37,31,34,82,37,31,34,82,37,31,37,83,40,34,37,83,40,34,37,83,39,33,39,84,39,33,39,84,39,36,42,84,39,36,42,85,39,36,42,85,39,36,42,85,39,39,44,86,39,39,44,86,41,38,47,87,41,41,47,87,41,41,50,87,41,41,49,88,41,41,52,88,40,43,52,89,43,43,52,89,43,43,54,89,42,45,54,90,42,45,57,90,42,45,57,90,42,45,59,91,42,48,59,91,44,47,61,92,44,47,61,92,44,50,61,92,44,49,63,93,44,49,63,93,44,52,66,93,43,52,65,94,46,54,68,94,46,54,70,95,46,54,70,95,46,54,70,95,45,56,72,96,45,56,72,96,45,58,74,97,47,58,76,97,47,58,76,97,47,60,78,98,47,60,78,98,47,60,81,98,49,62,80,99,49,62,82,99,48,61,84,100,48,64,84,100,48,64,84,100,50,63,86,101,50,66,86,101,50,66,88,101,50,65,90,102,52,67,89,103,51,69,91,104,51,68,92,105,52,69,93,107,52,71,94,108,54,70,96,109,53,71,96,111,52,73,98,112,54,72,98,114,53,73,100,115,54,72,100,117,54,73,102,118,55,74,104,120,55,76,105,121,56,77,106,123,56,76,107,124,57,79,107,126,58,78,110,128,57,79,111,129,56,80,113,131,58,79,112,132,57,82,114,134,58,81,116,136,60,82,117,137,59,83,117,139,60,83,119,141,59,84,120,142,60,85,122,144,59,86,122,146,60,86,126,148,62,87,127,149,61,88,127,151,62,88,128,153,63,89,130,155,62,90,131,156,63,90,132,158,64,91,134,160,65,91,135,162,64,92,136,163,63,93,138,165,66,95,139,167,65,95,140,169,66,95,142,171,67,96,142,172,66,97,144,174,67,99,145,176,67,97,148,178,67,99,147,180,68,100,149,181,68,100,150,183,69,101,152,185,70,102,153,187,71,103,155,188,70,103,156,190,70,104,157,192,71,105,158,194,71,106,160,195,72,106,161,197,72,108,161,199,73,108,163,200,73,109,164,202,74,109,165,204,74,110,167,206,75,111,168,207,74,112,170,209,75,112,170,210,76,113,171,212,76,114,173,214,77,115,174,215,78,115,175,217,78,116,175,218,78,117,177,220,78,118,178,221,79,118,180,223,80,120,180,224,81,120,181,226,81,120,182,227,82,121,184,229,82,122,185,230,84,123,186,232,83,123,187,233,84,124,189,234,84,125,188,235,85,126,189,237,86,126,190,238,86,127,191,239,87,127,192,240,87,129,193,242,88,129,194,243,89,130,195,244,90,131,196,245,90,132,197,246,91,132,197,247,92,133,198,248,92,134,199,249,93,135,200,250,94,136,201,251,95,137,202,252,96,138,203,253,97,140,204,254,98,141,205,254,99,142,206,255,101,143,207,255,102,144,208,255,103,146,209,255,104,147,209,255,106,148,210,255,107,149,211,255,108,151,212,255,110,152,213,255,111,153,213,255,112,154,214,255,114,156,215,255,115,157,215,255,117,158,216,255,118,160,217,255,120,161,217,255,121,162,218,255,123,164,218,255,124,165,219,255,125,166,219,255,127,167,220,255,129,169,220,255,130,170,221,255,132,171,221,255,133,173,222,255,134,174,222,255,136,175,223,255,139,178,224,255,142,180,224,255,144,182,225,255,147,185,226,255,150,187,226,255,153,189,227,255,155,191,228,255,158,194,228,255,160,196,229,255,163,198,229,255,165,200,230,255,168,202,231,255,170,203,231,255,172,205,232,255,174,207,232,255,176,209,233,255,178,210,234,255,180,212,234,255,182,214,235,255,184,215,236,255,186,217,237,255,188,219,238,255,190,220,238,255,192,221,239,255,193,222,240,255,194,224,240,255,196,225,241,255,197,226,241,255,198,226,242,255,199,227,242,255,200,228,242,255,201,228,243,255,202,229,243,255,203,230,243,255,204,230,244,255,205,231,244,255,207,232,244,255,208,233,245,255,209,233,245,255,211,234,246,255,213,235,246,255,217,238,247,255,222,240,248,255,226,242,249,255,231,245,250,255,236,247,251,255,241,249,252,255,245,251,253,255,249,252,254,255,255,255,255,255]);var x6;(function(i){function e(a,o){const l=a[o],c=a[o+1],u=a[o+2];return Math.sqrt(l*l+c*c+u*u)}function t(a,o){const l=a[o],c=a[o+1],u=a[o+2],d=1/Math.sqrt(l*l+c*c+u*u);a[o]*=d,a[o+1]*=d,a[o+2]*=d}function n(a,o,l){a[o]*=l,a[o+1]*=l,a[o+2]*=l}function r(a,o,l,c,u,d=o){(u=u||a)[d]=a[o]+l[c],u[d+1]=a[o+1]+l[c+1],u[d+2]=a[o+2]+l[c+2]}function s(a,o,l,c,u,d=o){(u=u||a)[d]=a[o]-l[c],u[d+1]=a[o+1]-l[c+1],u[d+2]=a[o+2]-l[c+2]}i.length=e,i.normalize=t,i.scale=n,i.add=r,i.subtract=s})(x6||(x6={}));const s1=x6;var C6,T6,S6;(function(i){const t=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],n=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],r=[0,0,1,0,1,1,0,1],s=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],a=new Array(36);for(let c=0;c<6;c++)for(let u=0;u<6;u++)a[6*c+u]=c;const o=new Array(36);for(let c=0;c<6;c++)o[6*c+0]=0,o[6*c+1]=1,o[6*c+2]=2,o[6*c+3]=2,o[6*c+4]=3,o[6*c+5]=0;function l(c){Array.isArray(c)||(c=[c,c,c]);const u=new Array(24);for(let d=0;d<8;d++)u[3*d]=t[d][0]*c[0],u[3*d+1]=t[d][1]*c[1],u[3*d+2]=t[d][2]*c[2];return new Bs([[j.POSITION,{size:3,data:u,exclusive:!0}],[j.NORMAL,{size:3,data:n}],[j.UV0,{size:2,data:r}]],[[j.POSITION,s],[j.NORMAL,a],[j.UV0,o]])}i.createGeometry=l})(C6||(C6={})),function(i){const t=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],n=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],r=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],s=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];function a(o){Array.isArray(o)||(o=[o,o,o]);const l=new Array(18);for(let c=0;c<6;c++)l[3*c]=t[c][0]*o[0],l[3*c+1]=t[c][1]*o[1],l[3*c+2]=t[c][2]*o[2];return new Bs([[j.POSITION,{size:3,data:l,exclusive:!0}],[j.NORMAL,{size:3,data:n}]],[[j.POSITION,r],[j.NORMAL,s]])}i.createGeometry=a}(T6||(T6={})),function(i){const n=Un(-.5,0,-.5),r=Un(.5,0,-.5),s=Un(0,0,.5),a=Un(0,0+.5,0),o=wr(),l=wr(),c=wr(),u=wr(),d=wr();nt(o,n,a),nt(l,n,r),vi(c,o,l),mt(c,c),nt(o,r,a),nt(l,r,s),vi(u,o,l),mt(u,u),nt(o,s,a),nt(l,s,n),vi(d,o,l),mt(d,d);const h=[n,r,s,a],p=[0,-1,0,c[0],c[1],c[2],u[0],u[1],u[2],d[0],d[1],d[2]],m=[0,1,2,3,1,0,3,2,1,3,0,2],g=[0,0,0,1,1,1,2,2,2,3,3,3];function _(b){Array.isArray(b)||(b=[b,b,b]);const x=new Array(12);for(let w=0;w<4;w++)x[3*w]=h[w][0]*b[0],x[3*w+1]=h[w][1]*b[1],x[3*w+2]=h[w][2]*b[2];return new Bs([[j.POSITION,{size:3,data:x,exclusive:!0}],[j.NORMAL,{size:3,data:p}]],[[j.POSITION,m],[j.NORMAL,g]])}i.createGeometry=_}(S6||(S6={}));const Ert=C6.createGeometry,Art=T6.createGeometry,Mrt=S6.createGeometry;function X$t(i,e,t,n={uv:!0}){const r=-Math.PI,s=2*Math.PI,a=-Math.PI/2,o=Math.PI,l=Math.max(3,Math.floor(e)),c=Math.max(2,Math.floor(t)),u=(l+1)*(c+1),d=new Float32Array(3*u),h=new Float32Array(3*u),p=new Float32Array(2*u),m=[];let g=0;for(let w=0;w<=c;w++){const C=[],S=w/c,E=a+S*o,A=Math.cos(E);for(let P=0;P<=l;P++){const O=P/l,M=r+O*s,V=Math.cos(M)*A,L=Math.sin(E),U=-Math.sin(M)*A;d[3*g]=V*i,d[3*g+1]=L*i,d[3*g+2]=U*i,h[3*g]=V,h[3*g+1]=L,h[3*g+2]=U,p[2*g]=O,p[2*g+1]=S,C.push(g),++g}m.push(C)}const _=new Array;for(let w=0;w<c;w++)for(let C=0;C<l;C++){const S=m[w][C],E=m[w][C+1],A=m[w+1][C+1],P=m[w+1][C];w===0?(_.push(S),_.push(A),_.push(P)):w===c-1?(_.push(S),_.push(E),_.push(A)):(_.push(S),_.push(E),_.push(A),_.push(A),_.push(P),_.push(S))}const b=[[j.POSITION,_],[j.NORMAL,_]],x=[[j.POSITION,{size:3,data:d,exclusive:!0}],[j.NORMAL,{size:3,data:h,exclusive:!0}]];return n.uv&&(x.push([j.UV0,{size:2,data:p,exclusive:!0}]),b.push([j.UV0,_])),n.offset&&(b[0][0]=j.OFFSET,x[0][0]=j.OFFSET,b.push([j.POSITION,new Array(_.length).fill(0)]),x.push([j.POSITION,{size:3,data:Float64Array.from(n.offset),exclusive:!0}])),new Bs(x,b)}function Ihe(i,e,t){const n=i;let r,s;if(t)r=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],s=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1];else{const d=n*(1+Math.sqrt(5))/2;r=[-n,d,0,n,d,0,-n,-d,0,n,-d,0,0,-n,d,0,n,d,0,-n,-d,0,n,-d,d,0,-n,d,0,n,-d,0,-n,-d,0,n],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]}for(let d=0;d<r.length;d+=3)s1.scale(r,d,i/s1.length(r,d));let a={};function o(d,h){d>h&&([d,h]=[h,d]);const p=d.toString()+"."+h.toString();if(a[p])return a[p];let m=r.length;return r.length+=3,s1.add(r,3*d,r,3*h,r,m),s1.scale(r,m,i/s1.length(r,m)),m/=3,a[p]=m,m}for(let d=0;d<e;d++){const h=s.length,p=new Array(4*h);for(let m=0;m<h;m+=3){const g=s[m],_=s[m+1],b=s[m+2],x=o(g,_),w=o(_,b),C=o(b,g),S=4*m;p[S]=g,p[S+1]=x,p[S+2]=C,p[S+3]=_,p[S+4]=w,p[S+5]=x,p[S+6]=b,p[S+7]=C,p[S+8]=w,p[S+9]=x,p[S+10]=w,p[S+11]=C}s=p,a={}}const l=new Float32Array(r);for(let d=0;d<l.length;d+=3)s1.normalize(l,d);const c=[[j.POSITION,s],[j.NORMAL,s]],u=[[j.POSITION,{size:3,data:new Float32Array(r),exclusive:!0}],[j.NORMAL,{size:3,data:l,exclusive:!0}]];return new Bs(u,c)}function E6(i,e,t,n,r,s,a,o){const l=e?[e[0],e[1],e[2]]:[0,0,0],c=i?[i[0],i[1],i[2]]:[0,0,1];s=s||[0,0];const u=t?[255*t[0],255*t[1],255*t[2],t.length>3?255*t[3]:255]:[255,255,255,255],d=n!=null&&n.length===2?n:[1,1],h=[[j.POSITION,{size:3,data:l,exclusive:!0}],[j.NORMAL,{size:3,data:c,exclusive:!0}],[j.UV0,{size:s.length,data:s}],[j.COLOR,{size:4,data:u,exclusive:!0}],[j.SIZE,{size:2,data:d}]];if(r!=null){const p=new Float32Array([r[0],r[1],r[2],r[3]]);h.push([j.AUXPOS1,{size:4,data:p}])}if(a!=null){const p=new Float32Array([a[0],a[1],a[2],a[3]]);h.push([j.AUXPOS2,{size:4,data:p}])}return new Bs(h,null,xh.Point,o)}const Prt=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function Z$t(i=Prt){const e=new Array(12);for(let c=0;c<4;c++)for(let u=0;u<3;u++)e[3*c+u]=i[c][u];const t=[0,1,2,2,3,0],n=[0,0,1],r=[0,0,0,0,0,0],s=[0,0,1,0,1,1,0,1],a=[255,255,255,255],o=[[j.POSITION,t],[j.NORMAL,r],[j.UV0,t],[j.COLOR,r]],l=[[j.POSITION,{size:3,data:e,exclusive:!0}],[j.NORMAL,{size:3,data:n,exclusive:!0}],[j.UV0,{size:2,data:s,exclusive:!0}],[j.COLOR,{size:4,data:a,exclusive:!0}]];return new Bs(l,o)}function CX(i,e,t,n,r=!0,s=!0){let a=0;const o=e,l=i;let c=Un(0,a,0),u=Un(0,a+l,0),d=Un(0,-1,0),h=Un(0,1,0);n&&(a=l,u=Un(0,0,0),c=Un(0,a,0),d=Un(0,1,0),h=Un(0,-1,0));const p=[u,c],m=[d,h],g=t+2,_=Math.sqrt(l*l+o*o);if(n)for(let A=t-1;A>=0;A--){const P=A*(2*Math.PI/t),O=Un(Math.cos(P)*o,a,Math.sin(P)*o);p.push(O);const M=Un(l*Math.cos(P)/_,-o/_,l*Math.sin(P)/_);m.push(M)}else for(let A=0;A<t;A++){const P=A*(2*Math.PI/t),O=Un(Math.cos(P)*o,a,Math.sin(P)*o);p.push(O);const M=Un(l*Math.cos(P)/_,o/_,l*Math.sin(P)/_);m.push(M)}const b=new Array,x=new Array;if(r){for(let A=3;A<p.length;A++)b.push(1),b.push(A-1),b.push(A),x.push(0),x.push(0),x.push(0);b.push(p.length-1),b.push(2),b.push(1),x.push(0),x.push(0),x.push(0)}if(s){for(let A=3;A<p.length;A++)b.push(A),b.push(A-1),b.push(0),x.push(A),x.push(A-1),x.push(1);b.push(0),b.push(2),b.push(p.length-1),x.push(1),x.push(2),x.push(m.length-1)}const w=new Float32Array(3*g);for(let A=0;A<g;A++)w[3*A]=p[A][0],w[3*A+1]=p[A][1],w[3*A+2]=p[A][2];const C=new Float32Array(3*g);for(let A=0;A<g;A++)C[3*A]=m[A][0],C[3*A+1]=m[A][1],C[3*A+2]=m[A][2];const S=[[j.POSITION,b],[j.NORMAL,x]],E=[[j.POSITION,{size:3,data:w,exclusive:!0}],[j.NORMAL,{size:3,data:C,exclusive:!0}]];return new Bs(E,S)}function Ort(i,e,t,n,r,s){const a=n?JG(n):Un(1,0,0),o=r?JG(r):Un(0,0,0);s=s??!0;const l=wr();mt(l,a);const c=wr();Ye(c,l,Math.abs(i));const u=wr();Ye(u,c,-.5),rt(u,u,o);const d=Un(0,1,0);Math.abs(1-dt(l,d))<.2&&je(d,0,0,1);const h=wr();vi(h,l,d),mt(h,h),vi(d,h,l);const p=2*t+(s?2:0),m=t+(s?2:0),g=new Float32Array(3*p),_=new Float32Array(3*m),b=new Float32Array(2*p),x=new Array(3*t*(s?4:2)),w=new Array(3*t*(s?4:2));s&&(g[3*(p-2)+0]=u[0],g[3*(p-2)+1]=u[1],g[3*(p-2)+2]=u[2],b[2*(p-2)]=0,b[2*(p-2)+1]=0,g[3*(p-1)+0]=g[3*(p-2)+0]+c[0],g[3*(p-1)+1]=g[3*(p-2)+1]+c[1],g[3*(p-1)+2]=g[3*(p-2)+2]+c[2],b[2*(p-1)]=1,b[2*(p-1)+1]=1,_[3*(m-2)+0]=-l[0],_[3*(m-2)+1]=-l[1],_[3*(m-2)+2]=-l[2],_[3*(m-1)+0]=l[0],_[3*(m-1)+1]=l[1],_[3*(m-1)+2]=l[2]);const C=(M,V,L)=>{x[M]=V,w[M]=L};let S=0;const E=wr(),A=wr();for(let M=0;M<t;M++){const V=M*(2*Math.PI/t);Ye(E,d,Math.sin(V)),Ye(A,h,Math.cos(V)),rt(E,E,A),_[3*M+0]=E[0],_[3*M+1]=E[1],_[3*M+2]=E[2],Ye(E,E,e),rt(E,E,u),g[3*M+0]=E[0],g[3*M+1]=E[1],g[3*M+2]=E[2],b[2*M+0]=M/t,b[2*M+1]=0,g[3*(M+t)+0]=g[3*M+0]+c[0],g[3*(M+t)+1]=g[3*M+1]+c[1],g[3*(M+t)+2]=g[3*M+2]+c[2],b[2*(M+t)+0]=M/t,b[2*M+1]=1;const L=(M+1)%t;C(S++,M,M),C(S++,M+t,M),C(S++,L,L),C(S++,L,L),C(S++,M+t,M),C(S++,L+t,L)}if(s){for(let M=0;M<t;M++){const V=(M+1)%t;C(S++,p-2,m-2),C(S++,M,m-2),C(S++,V,m-2)}for(let M=0;M<t;M++){const V=(M+1)%t;C(S++,M+t,m-1),C(S++,p-1,m-1),C(S++,V+t,m-1)}}const P=[[j.POSITION,x],[j.NORMAL,w],[j.UV0,x]],O=[[j.POSITION,{size:3,data:g,exclusive:!0}],[j.NORMAL,{size:3,data:_,exclusive:!0}],[j.UV0,{size:2,data:b,exclusive:!0}]];return new Bs(O,P)}function Q$t(i,e,t,n,r){t=t||10,n=n==null||n,Ti(i.length>1);const s=[[0,0,0]],a=[],o=[];for(let l=0;l<t;l++){a.push([0,-l-1,-(l+1)%t-1]);const c=l/t*2*Math.PI;o.push([Math.cos(c)*e,Math.sin(c)*e])}return Rrt(o,i,s,a,n,r)}function Rrt(i,e,t,n,r,s=Un(0,0,0)){const a=i.length,o=new Float32Array(e.length*a*3+(6*t.length||0)),l=new Float32Array(e.length*a*3+(t?6:0)),c=new Array,u=new Array;let d=0,h=0;const p=wr(),m=wr(),g=wr(),_=wr(),b=wr(),x=wr(),w=wr(),C=q(),S=wr(),E=wr(),A=wr(),P=wr(),O=wr(),M=Dr();je(S,0,1,0),nt(m,e[1],e[0]),mt(m,m),r?(rt(C,e[0],s),mt(g,C)):je(g,0,0,1),F$(m,g,S,S,b,g,TX),Ge(_,g),Ge(P,b);for(let $=0;$<t.length;$++)Ye(x,b,t[$][0]),Ye(C,g,t[$][2]),rt(x,x,C),rt(x,x,e[0]),o[d++]=x[0],o[d++]=x[1],o[d++]=x[2];l[h++]=-m[0],l[h++]=-m[1],l[h++]=-m[2];for(let $=0;$<n.length;$++)c.push(n[$][0]>0?n[$][0]:-n[$][0]-1+t.length),c.push(n[$][1]>0?n[$][1]:-n[$][1]-1+t.length),c.push(n[$][2]>0?n[$][2]:-n[$][2]-1+t.length),u.push(0),u.push(0),u.push(0);let V=t.length;const L=t.length-1;for(let $=0;$<e.length;$++){let F=!1;$>0&&(Ge(p,m),$<e.length-1?(nt(m,e[$+1],e[$]),mt(m,m)):F=!0,rt(E,p,m),mt(E,E),rt(A,e[$-1],_),Gx(e[$],E,M),xb(M,Ah(A,p),C)?(nt(C,C,e[$]),mt(g,C),vi(b,E,g),mt(b,b)):F$(E,_,P,S,b,g,TX),Ge(_,g),Ge(P,b)),r&&(rt(C,e[$],s),mt(O,C));for(let Y=0;Y<a;Y++)if(Ye(x,b,i[Y][0]),Ye(C,g,i[Y][1]),rt(x,x,C),mt(w,x),l[h++]=w[0],l[h++]=w[1],l[h++]=w[2],rt(x,x,e[$]),o[d++]=x[0],o[d++]=x[1],o[d++]=x[2],!F){const ne=(Y+1)%a;c.push(V+Y),c.push(V+a+Y),c.push(V+ne),c.push(V+ne),c.push(V+a+Y),c.push(V+a+ne);for(let X=0;X<6;X++){const J=c.length-6;u.push(c[J+X]-L)}}V+=a}const U=e[e.length-1];for(let $=0;$<t.length;$++)Ye(x,b,t[$][0]),Ye(C,g,t[$][1]),rt(x,x,C),rt(x,x,U),o[d++]=x[0],o[d++]=x[1],o[d++]=x[2];const G=h/3;l[h++]=m[0],l[h++]=m[1],l[h++]=m[2];const H=V-a;for(let $=0;$<n.length;$++)c.push(n[$][0]>=0?V+n[$][0]:-n[$][0]-1+H),c.push(n[$][2]>=0?V+n[$][2]:-n[$][2]-1+H),c.push(n[$][1]>=0?V+n[$][1]:-n[$][1]-1+H),u.push(G),u.push(G),u.push(G);const k=[[j.POSITION,c],[j.NORMAL,u]],D=[[j.POSITION,{size:3,data:o,exclusive:!0}],[j.NORMAL,{size:3,data:l,exclusive:!0}]];return new Bs(D,k)}function J$t(i,e,t){Ti(i.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),Ti(i[0].length===3,"createPolylineGeometry(): malformed vertex"),Ti(e==null||e.length===i.length,"createPolylineGeometry: need same number of points and normals"),Ti(e==null||e[0].length===3,"createPolylineGeometry(): malformed normal");const n=new Float64Array(3*i.length),r=new Array(2*(i.length-1));let s=0,a=0;for(let c=0;c<i.length;c++){for(let u=0;u<3;u++)n[s++]=i[c][u];c>0&&(r[a++]=c-1,r[a++]=c)}const o=[],l=[];if(o.push([j.POSITION,r]),l.push([j.POSITION,{size:3,data:n,exclusive:!0}]),e){const c=new Float32Array(3*e.length);let u=0;for(let d=0;d<i.length;d++)for(let h=0;h<3;h++)c[u++]=e[d][h];o.push([j.NORMAL,r]),l.push([j.NORMAL,{size:3,data:c,exclusive:!0}])}return t&&(l.push([j.COLOR,{size:4,data:t}]),o.push([j.COLOR,nz(t.length/4)])),new Bs(l,o,xh.Line)}function eLt(i,e,t,n,r=0){const s=new Array(18),a=[[-e,r,n/2],[t,r,n/2],[0,i+r,n/2],[-e,r,-n/2],[t,r,-n/2],[0,i+r,-n/2]],o=[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5];for(let l=0;l<6;l++)s[3*l]=a[l][0],s[3*l+1]=a[l][1],s[3*l+2]=a[l][2];return new Bs([[j.POSITION,{size:3,data:s,exclusive:!0}]],[[j.POSITION,o]])}function tLt(i,e){const t=i.getMutableAttribute(j.POSITION).data;for(let n=0;n<t.length;n+=3){const r=t[n],s=t[n+1],a=t[n+2];je(a1,r,s,a),$t(a1,a1,e),t[n]=a1[0],t[n+1]=a1[1],t[n+2]=a1[2]}}function Irt(i,e=i){const t=i.vertexAttributes,n=t.get(j.POSITION).data,r=t.get(j.NORMAL).data;if(r){const s=e.getMutableAttribute(j.NORMAL).data;for(let a=0;a<r.length;a+=3){const o=r[a+1];s[a+1]=-r[a+2],s[a+2]=o}}if(n){const s=e.getMutableAttribute(j.POSITION).data;for(let a=0;a<n.length;a+=3){const o=n[a+1];s[a+1]=-n[a+2],s[a+2]=o}}return e}function gF(i,e,t,n,r){return!(Math.abs(dt(e,i))>r)&&(vi(t,i,e),mt(t,t),vi(n,t,i),mt(n,n),!0)}function F$(i,e,t,n,r,s,a){return gF(i,e,r,s,a)||gF(i,t,r,s,a)||gF(i,n,r,s,a)}const TX=.99619469809,a1=wr();let $rt=class{constructor(){this.type=Ma.Panoramic,this._configuration=new k$,this._passParameters=new HU}destroy(){this._passParameters.texture=Ht(this._passParameters.texture),this._vao=Ht(this._vao)}initializeRenderContext(e){this._configuration.geometry=ff.Cylinder,this._technique=e.shaderTechniqueRepository.acquire(dA,this._configuration);const t=e.renderContext.rctx;this._vao=this._createVertexArrayObject(t),this._vaoCount=al(this._vao,"geometry"),this._passParameters.texture=new Er(t,{pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR,flipped:!0,width:1,height:512},Rhe),e.requestRender()}render(e){if(B(this._vao)||B(this._passParameters.texture))return;const t=e.rctx,n=t.bindTechnique(this._technique,this._passParameters,e.bindParameters);Lrt(SX,e.bindParameters.camera.viewMatrix),n.setUniformMatrix4fv("view",SX),t.bindVAO(this._vao),n.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(Qi.TRIANGLES,0,this._vaoCount)}renderHaze(){return!1}_createVertexArrayObject(e){const t=Ihe(1,2,!1),n=t.indices.get(j.POSITION);for(let o=0;o<n.length;o+=3){const l=n[o];n[o]=n[o+2],n[o+2]=l}const r=t.vertexAttributes.get(j.POSITION).data,s=EX.createBuffer(n.length),a=s.position;for(let o=0;o<n.length;++o){const l=3*n[o];a.set(o,0,r[l]),a.set(o,1,r[l+1]),a.set(o,2,r[l+2])}return new lf(e,Mn,{geometry:Dh(EX)},{geometry:In.createVertex(e,kn.STATIC_DRAW,s.buffer)})}};function Lrt(i,e){da(i,e),i[12]=0,i[13]=0,i[14]=0,i[15]=1}const SX=St(),EX=Js().vec3f(j.POSITION);var eg;(function(i){i[i.Rain=0]="Rain",i[i.Snow=1]="Snow",i[i.COUNT=2]="COUNT"})(eg||(eg={}));let A6=class extends ic{constructor(){super(...arguments),this.type=eg.Rain}};f([Pe({count:eg.COUNT})],A6.prototype,"type",void 0);function Drt(i){const e=new Nr;return e.attributes.add(j.POSITION,"vec3"),e.attributes.add(j.INSTANCEFEATUREATTRIBUTE,"float"),e.vertex.uniforms.add(new Io("cameraPosition",(t,n)=>n.camera.eye)),e.vertex.uniforms.add(new Io("offset",(t,n)=>krt(t,n))),e.vertex.uniforms.add(new Hi("width",t=>t.width)),e.vertex.uniforms.add(new pl("proj",(t,n)=>n.camera.projectionMatrix)),e.vertex.uniforms.add(new pl("view",(t,n)=>n.camera.viewMatrix)),e.vertex.uniforms.add(new Hi("time",t=>t.time)),e.varyings.add("vUv","vec2"),e.vertex.code.add(ee`
    vec3 hash31(float p){
      vec3 p3 = fract(vec3(p) * vec3(0.1031, 0.1030, 0.0973));
      p3 += dot(p3, p3.yzx + 33.33);
      return fract((p3.xxy + p3.yzz) * p3.zyx);
    }

    float hash11(float p){
      p = fract(p * 0.1031);
      p *= p + 33.33;
      p *= p + p;
      return fract(p);
    }

    //https://www.geeks3d.com/20141201/how-to-rotate-a-vertex-by-a-quaternion-in-glsl/
    vec3 rotateVectorByQuaternion(vec3 v, vec4 q){
      return 2.0 * cross(q.xyz, v * q.w + cross(q.xyz, v)) + v;
    }

    void main(void) {

      vUv = position.xz;

      vec3 rand = hash31(instanceFeatureAttribute);

      // Set random position for all particles
      // The hash function space is not high resolution so offset particles by an additional random value
      // This creates grids of 1000 particles which are shifted by random hundreths of the tile width
      // overlaying multiple identical but offset grids
      vec3 randomPosition = 2.0 * (rand + (0.01 + 0.01 * rand) * floor(0.001 * instanceFeatureAttribute)) - 1.0;

      // Random orientation of rain drops
      float angle = 3.1415 * hash11(instanceFeatureAttribute);

      vec3 up = vec3(0, 0, 1);

      // Gravity and wind direction
      vec3 direction = normalize(cameraPosition);

      vec3 tangent = normalize(cross(direction, up));

      // Gravity
      vec3 animatedPos = randomPosition + direction * -time;

      // Rain particles fall straight down and are randomly oriented
      // Snow particles have random sinusoid trajectories and are rotated to face the camera
      ${i.type===eg.Rain?ee`
            // Random rotation for particle
            vec3 rotationAxis = up;
            vec4 quat = vec4(rotationAxis * sin(angle), cos(angle));
            vec3 transformedPos = rotateVectorByQuaternion(vec3(0.2, 0.2, 4.0) * (position - vec3(0.5, 0.0, 0.5)), quat);

            // Rotate particle to planetary position
            rotationAxis = tangent;
            angle = 0.5 * -acos(dot(direction, up));
            quat = vec4(rotationAxis * sin(angle), cos(angle));
            transformedPos = rotateVectorByQuaternion(transformedPos, quat);

            vec4 pos = mat4(mat3(view)) * vec4(transformedPos + (mod(width * animatedPos - offset, width) - 0.5 * width), 1.0);
            gl_Position = proj * pos;
      `:ee`
            vec3 rotationAxis = direction;
            vec4 quat = vec4(rotationAxis * sin(angle), cos(angle));

            tangent = rotateVectorByQuaternion(tangent, quat);
            // Random sinusoid from friction
            animatedPos += tangent * 0.25 * sin(dot(animatedPos, direction));
            vec4 pos = mat4(mat3(view)) * vec4((mod(width * animatedPos - offset, width) - 0.5 * width), 1.0);
            gl_Position = proj * (0.5 * vec4(position.xzy, 0.0) + pos);
      `}
    }
  `),e.fragment.uniforms.add([new Hi("opacity",t=>t.opacity),new Io("particleColor",(t,n)=>Frt(n,i))]),e.fragment.code.add(ee`
    void main() {

      // Cut off corners of the triangle
      if(vUv.x < 0.0 || vUv.y < 0.0){
        discard;
      }

      float d = length(vUv - vec2(0.5));

      ${i.type===eg.Rain?ee`d = 0.35 * smoothstep(0.5, 0.0, d);`:ee`d = smoothstep(0.5, 0.1, d);`}
      gl_FragColor = opacity * vec4(particleColor * d, d);
    }
  `),e}function krt(i,e){const t=e.camera.eye,n=.5*i.width,r=1/i.width,s=u0e(M6,je(M6,(t[0]+n)*r,(t[1]+n)*r,(t[2]+n)*r));return pr(s,t,Ye(s,s,i.width))}function Frt(i,e){const t=e.type===eg.Rain?Vrt:Nrt,n=Ye(M6,t,Brt),r=i.camera.eye;mt(AX,r);const s=Math.max(0,dt(AX,i.lighting.mainLight.direction));return oo(n,n,t,s)}const M6=q(),AX=q(),Nrt=Gt(1,1,1),Vrt=Gt(.85,.85,.85),Brt=.7,zrt=Object.freeze(Object.defineProperty({__proto__:null,build:Drt},Symbol.toStringTag,{value:"Module"}));let Urt=class extends Es{constructor(){super(...arguments),this.time=0,this.radius=1,this.width=500,this.opacity=1}},N$=class extends _n{initializeProgram(e){return new gn(e.rctx,N$.shader.get().build(this.configuration),nI)}initializePipeline(){return yi({blending:Na(vt.ONE,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),depthTest:{func:lo.LEQUAL},colorWrite:$i})}};N$.shader=new bn(zrt,()=>Ee(()=>import("./Precipitation.glsl-51153145.js"),["./Precipitation.glsl-51153145.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const nI=new Map([[j.POSITION,0],[j.INSTANCEFEATUREATTRIBUTE,1]]);let $he=class{constructor(){this.enabled=!0,this._time=Wi(0)}get time(){return this._time}advance(e){return this._time!==e.time&&(this._time=e.time,!0)}},N_=class extends et{constructor(e){super(e),this._numParticles=25e4,this._rainSpeed=.1,this._snowSpeed=.01,this._passParameters=new Urt,this._animation=new $he,this._updatingTracking=new wb,this._passParameters.time=0,this._passParameters.radius=rn(e.view.spatialReference).radius,this._shaderTechniqueRepository=e.context.shaderTechniqueRepository}destroy(){this._updatingTracking.destroy(),this._numParticles=0,this._snowTechniqueCached=Lr(this._snowTechniqueCached),this._rainTechniqueCached=Lr(this._rainTechniqueCached),this._vao=Ht(this._vao),this._instanceIdBuffer=Ht(this._instanceIdBuffer)}get updating(){return this._updatingTracking.updating}get _rainTechnique(){if(B(this._rainTechniqueCached)){const e=new A6;e.type=eg.Rain,this._rainTechniqueCached=this._shaderTechniqueRepository.acquire(N$,e)}return this._rainTechniqueCached}get _snowTechnique(){if(B(this._snowTechniqueCached)){const e=new A6;e.type=eg.Snow,this._snowTechniqueCached=this._shaderTechniqueRepository.acquire(N$,e)}return this._snowTechniqueCached}update(e){return this._animation.advance(e)}render(e,t,n){const r=n==="rainy"?this._rainTechnique:this._snowTechnique;if(!r.compiled)return void this.context.requestRender();const s=e.rctx;if(this._ensureResources(s),B(r)||B(this._vao)||B(this._instanceIdBuffer)||(T(e.bindParameters.cloudsFade.data)&&(this._passParameters.opacity=1-e.bindParameters.cloudsFade.fadeInOutHeight.factor),this._passParameters.opacity<=0))return;const a=.35;t=t<.5?ki(0,a,2*t):ki(a,1,2*(t-.5)),this._passParameters.time=(n==="rainy"?this._rainSpeed:this._snowSpeed)*sB(this._animation.time)%1e5;const o=s.bindTechnique(r,this._passParameters,e.bindParameters);s.bindVAO(this._vao),o.assertCompatibleVertexAttributeLocations(this._vao),Bne(s,nI,this._instanceIdBuffer,MX,0),s.capabilities.instancing.drawArraysInstanced(Qi.TRIANGLES,0,3,this._numParticles*t),zne(s,nI,this._instanceIdBuffer,MX)}_ensureResources(e){B(this._vao)&&(this._vao=this._createVertexArrayObject(e)),B(this._instanceIdBuffer)&&(this._instanceIdBuffer=this._createInstanceIndices(e))}_createInstanceIndices(e){const t=[];for(let n=0;n<this._numParticles;n++)t.push(n);return In.createVertex(e,kn.STATIC_DRAW,new Float32Array(t))}_createVertexArrayObject(e){const t=new Float32Array([-1,0,1,1,0,-1,1,0,1]);return new lf(e,nI,{geometry:Dh(Hrt)},{geometry:In.createVertex(e,kn.STATIC_DRAW,t)})}};f([y({constructOnly:!0})],N_.prototype,"context",void 0),f([y({constructOnly:!0})],N_.prototype,"view",void 0),f([y({readOnly:!0})],N_.prototype,"updating",null),f([y()],N_.prototype,"_updatingTracking",void 0),N_=f([ge("esri.views.3d.environment.Precipitation")],N_);const Hrt=Js().vec3f(j.POSITION),MX=Dh(Js().f32(j.INSTANCEFEATUREATTRIBUTE),1),Grt=new Uint8ClampedArray([0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,2,0,0,0,3,0,0,0,3,0,0,0,3,0,0,0,4,0,0,0,4,0,0,0,4,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,5,0,0,0,6,0,0,0,6,0,0,0,7,0,0,0,7,0,0,0,7,0,0,0,8,0,0,0,8,0,0,0,8,0,0,0,9,0,0,0,9,0,0,0,9,0,0,0,10,0,0,0,10,0,0,0,11,0,0,0,11,0,0,0,11,0,0,0,12,0,0,0,12,0,0,0,12,0,0,0,13,0,0,0,13,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,14,0,0,0,15,0,0,0,15,0,0,0,16,0,0,0,16,0,0,0,16,0,0,0,17,0,0,0,17,0,0,0,18,0,0,0,18,0,0,0,19,0,0,0,19,0,0,0,19,0,0,0,20,0,0,0,20,0,0,0,21,0,0,0,21,0,0,0,22,0,0,0,22,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,23,11,0,0,24,11,0,0,24,11,0,0,24,10,0,0,25,10,0,0,25,10,0,0,26,10,0,0,26,9,0,0,27,9,0,0,27,9,0,0,28,9,0,0,28,9,0,0,29,9,0,0,29,8,0,0,30,8,0,0,30,8,0,0,31,8,0,0,31,8,0,0,32,8,0,0,32,8,0,0,32,8,0,0,32,8,0,0,33,8,0,0,33,8,0,0,34,7,0,0,35,7,0,0,35,7,0,0,36,7,0,0,36,7,7,0,37,7,7,0,37,7,7,0,38,7,7,0,38,13,7,0,39,13,7,0,39,13,6,0,40,13,6,0,40,12,6,0,41,12,6,0,41,12,6,0,41,12,6,0,42,12,6,0,42,12,6,0,43,12,6,0,43,12,6,0,44,12,6,0,44,11,6,0,45,11,6,6,45,11,6,6,46,11,5,5,47,11,5,5,47,11,5,5,48,11,5,5,48,10,5,5,49,10,5,5,49,10,5,5,50,15,5,5,51,15,5,5,51,15,5,5,51,15,5,5,51,15,5,5,52,15,5,5,52,14,5,5,53,14,5,5,54,14,5,5,54,14,5,5,55,14,5,5,55,14,5,5,56,13,4,4,57,13,4,4,57,13,4,4,58,13,4,4,58,13,4,4,59,13,4,4,59,17,4,4,60,17,4,4,60,17,4,4,60,17,4,4,61,17,4,4,61,16,4,4,62,16,4,4,63,16,4,4,63,16,8,4,64,16,8,4,64,16,8,4,65,15,8,4,66,15,8,4,66,15,8,4,67,19,8,4,68,19,8,4,68,18,7,4,69,18,7,4,69,18,7,4,69,18,7,4,70,18,7,4,70,18,7,4,71,18,7,4,71,18,7,4,72,17,7,3,73,17,7,3,73,21,7,3,74,21,7,3,74,20,7,3,75,20,7,3,76,20,7,3,76,20,7,3,77,20,7,3,77,20,7,3,78,20,7,3,78,20,7,7,78,19,6,6,79,19,10,6,80,19,10,6,80,22,9,6,81,22,9,6,81,22,9,6,82,22,9,6,83,22,9,6,83,21,9,6,84,21,9,6,84,21,9,6,85,21,9,6,86,21,9,6,86,23,9,6,87,23,9,6,87,23,9,6,87,23,9,6,88,23,9,6,88,23,9,6,89,23,8,6,90,23,8,6,90,22,8,6,91,22,8,6,91,25,8,6,92,25,8,5,93,25,8,5,93,24,8,5,94,24,8,5,94,24,11,5,95,24,11,5,96,24,11,5,96,26,11,5,97,26,11,5,97,26,11,5,97,26,10,5,98,26,10,5,98,26,10,5,99,25,10,5,100,25,10,5,100,25,10,5,101,25,10,5,101,25,10,5,102,27,10,5,103,27,10,5,103,27,10,5,104,27,10,5,104,27,12,5,105,26,12,5,106,26,12,5,106,29,12,5,106,29,12,5,106,29,12,7,107,28,12,7,108,28,12,7,108,28,12,7,109,28,12,7,109,30,12,7,110,30,11,7,111,30,11,7,111,30,11,7,112,30,11,7,112,29,11,7,113,29,11,7,114,29,11,7,114,31,11,7,115,31,11,7,115,31,11,7,115,31,11,7,116,31,11,7,116,33,13,7,117,33,13,9,117,32,13,9,118,32,13,9,118,32,13,9,119,34,15,8,120,34,15,8,120,34,15,8,121,36,15,8,121,36,15,8,122,36,15,8,122,35,15,8,123,37,14,8,124,37,14,8,124,37,14,8,124,37,14,8,124,39,14,8,125,39,16,8,125,38,16,8,126,38,16,8,127,38,16,8,127,40,16,10,128,40,16,10,128,40,16,10,129,42,18,10,129,41,18,10,130,41,18,10,130,43,18,10,131,43,18,10,131,42,17,10,132,42,17,12,132,42,17,12,133,44,17,12,133,44,17,12,133,46,17,11,134,46,17,11,134,45,19,11,135,45,19,11,135,47,19,11,136,47,19,11,136,47,19,11,137,47,19,11,137,48,20,11,138,48,20,11,138,50,20,13,139,50,20,13,139,49,20,13,140,49,22,13,140,51,22,13,141,51,22,13,141,50,22,13,142,52,22,13,142,52,21,12,143,53,21,12,143,53,21,12,143,53,21,12,143,53,21,14,144,53,23,14,144,55,23,14,145,55,23,14,145,56,23,14,146,56,23,14,146,57,24,14,147,57,24,14,147,59,24,16,148,59,24,16,148,58,24,15,149,58,26,15,149,58,26,15,149,60,26,15,150,60,26,15,150,61,25,15,151,61,25,15,151,62,25,17,152,62,25,17,152,64,25,17,152,64,27,17,152,63,27,17,153,63,27,17,153,65,27,17,153,66,28,17,154,66,28,17,154,67,28,16,155,67,28,16,155,67,30,16,155,69,29,18,156,69,29,18,156,68,29,18,157,70,29,18,157,70,29,18,157,71,31,18,158,71,31,18,158,72,30,19,159,72,30,19,159,74,30,19,159,73,30,19,160,73,32,19,160,74,32,19,161,74,32,21,161,76,32,21,161,78,33,21,161,78,33,21,161,79,35,20,162,78,34,20,163,79,34,22,164,81,36,22,164,82,36,22,165,81,35,22,166,82,37,21,167,84,37,21,167,85,36,21,168,86,38,23,169,88,38,23,169,88,38,23,170,88,39,23,170,89,39,24,171,91,40,24,171,92,40,24,172,93,40,24,173,94,41,25,173,95,41,25,174,96,42,25,175,98,42,25,175,99,43,26,176,99,43,26,177,101,45,26,177,102,44,26,178,103,46,27,179,104,46,27,179,105,46,27,179,106,45,28,180,108,47,28,180,108,46,28,181,109,48,28,182,111,48,29,182,111,49,29,183,114,49,29,184,114,50,30,184,114,50,30,185,116,51,30,185,117,51,30,186,119,52,31,187,119,53,31,187,121,53,31,188,122,54,33,188,123,54,32,189,124,55,32,189,125,55,32,189,126,56,34,190,128,56,34,190,128,57,33,191,130,57,33,191,131,58,35,192,131,58,35,192,133,59,34,193,134,60,35,194,135,60,35,194,136,61,37,195,139,61,37,195,139,62,36,196,141,62,36,196,141,63,38,197,142,63,38,197,143,64,39,198,144,64,39,198,146,66,39,198,146,67,39,198,147,67,38,199,147,68,40,199,149,68,40,200,150,69,40,200,152,70,41,201,154,71,41,201,154,71,42,202,155,72,42,202,156,73,41,203,157,73,43,203,158,74,42,204,160,75,44,204,161,76,44,204,162,77,44,205,164,77,45,205,165,78,45,206,166,79,45,206,168,80,46,207,169,81,46,207,170,83,47,207,171,83,47,207,172,83,47,207,174,85,48,208,175,85,48,208,177,85,48,209,178,87,49,209,180,87,49,210,181,87,49,210,182,89,50,210,182,89,50,211,185,91,50,211,186,91,51,212,186,93,51,212,189,94,52,212,190,95,51,213,192,96,51,213,193,96,53,213,194,97,52,214,195,98,54,214,197,98,55,215,198,100,55,215,199,101,55,215,200,102,55,216,202,103,55,216,203,104,55,216,204,105,57,216,205,106,57,216,207,107,58,216,208,108,58,217,209,109,59,217,210,110,60,217,211,111,60,218,212,112,61,218,213,113,61,218,214,114,62,219,217,115,63,219,217,116,64,219,218,118,64,220,219,119,65,220,220,121,66,220,222,121,67,221,222,122,67,221,222,123,68,221,223,124,69,222,224,125,70,222,225,127,71,222,226,128,72,223,228,129,73,223,228,130,74,223,229,132,75,223,230,135,79,224,231,138,81,224,233,141,84,224,233,144,87,225,235,147,91,225,236,150,94,225,237,154,97,225,238,158,102,225,239,161,107,225,239,165,110,225,240,168,114,226,241,172,118,226,241,176,122,226,241,181,126,226,242,183,130,227,243,186,135,227,243,190,139,227,244,194,143,227,244,197,147,228,244,200,150,228,245,204,154,228,245,207,157,228,245,210,161,229,246,212,164,229,246,215,167,229,246,217,169,229,246,220,172,230,247,221,174,230]),fP=128,PX=-b6,OX=0,vF=50,Wrt=()=>1-511/512,jrt=nR([[50,.1015625],[500,.21875],[5e3,1-250/512],[5e4,.4140625]]);let qrt=class{constructor(e){this.view=e,this.type=Ma.Simple,this._passParameters=new HU,this._fadeVaoCount=0,this._texV1=1,this._isOnMars=zA(e.spatialReference);const t=rn(e.spatialReference);this._planetRadius=t.radius,this._outerRimWidth=t.outerAtmosphereRimWidth,this._innerRimFactor=(this._planetRadius+PX)/this._planetRadius,this._middleRimFactor=(this._planetRadius+OX)/this._planetRadius,this._outerRimFactor=(this._planetRadius+this._outerRimWidth)/this._planetRadius,this._texV0=OX/this._outerRimWidth,this._texVScale=this._texV1-this._texV0}destroy(){this._cameraChangeHandle=Gr(this._cameraChangeHandle),this._passParameters.texture=Ht(this._passParameters.texture),this._fadeVao=Ht(this._fadeVao),this._vao=Ht(this._vao)}async initializeRenderContext(e){this._shaderTechniqueRepository=e.shaderTechniqueRepository;const t=e.renderContext.rctx;this._cameraChangeHandle=ue(()=>{var r;return(r=this.view.state)==null?void 0:r.camera},()=>e.requestRender(),hn),this._vao=this._createRibbon(t),this._vaoCount=al(this._vao,"geometry"),this._fadeVao=tc(t),this._fadeVaoCount=al(this._fadeVao,"geometry");const n=this._isOnMars?Grt:Rhe;this._passParameters.texture=new Er(t,{pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR,flipped:!0,width:1,height:512},n),e.requestRender()}get _coneTechnique(){if(B(this._coneTechniqueCached)){const e=new k$;e.geometry=ff.Cone,this._coneTechniqueCached=this._shaderTechniqueRepository.acquire(dA,e)}return this._coneTechniqueCached}get _undergroundTechnique(){if(B(this._undergroundTechniqueCached)){const e=new k$;e.geometry=ff.Underground,this._undergroundTechniqueCached=this._shaderTechniqueRepository.acquire(dA,e)}return this._undergroundTechniqueCached}render(e){if(B(this._vao)||B(this._passParameters.texture))return;const t=e.bindParameters.camera;this._update(t);const n=e.rctx;this._passParameters.undergroundFadeAlpha<1&&(n.bindTechnique(this._coneTechnique,this._passParameters,e.bindParameters),n.bindVAO(this._vao),n.drawArrays(Qi.TRIANGLES,0,this._vaoCount)),this._passParameters.undergroundFadeAlpha>0&&(n.bindTechnique(this._undergroundTechnique,this._passParameters,e.bindParameters),n.bindVAO(this._fadeVao),n.drawArrays(Qi.TRIANGLE_STRIP,0,this._fadeVaoCount))}renderHaze(){}_update(e){const t=q(),n=this._planetRadius,r=Et(e.eye),s=r-n;if(s<0){const p=Math.min(-s/5e3,1);this._passParameters.undergroundFadeAlpha=p}else this._passParameters.undergroundFadeAlpha=0;const a=Math.max(vF,s),o=n+PX;this._passParameters.innerScale=Krt(n+a,n,o)-1,this._passParameters.altitudeFade=The(s),Ye(t,e.eye,(n+vF)/r),RX(t,e.center,e.up,n,this._passParameters.silhouette);const l=this._computeScreenRimWidth(e,t,e.up,this._passParameters.silhouette),c=Wrt(),u=jrt(s);let d=this._texV0+c*this._texVScale,h=this._texV0+l*u*this._texVScale;if(s>vF){RX(e.eye,e.center,e.up,n,this._passParameters.silhouette);const p=this._computeScreenRimWidth(e,e.eye,e.up,this._passParameters.silhouette),m=lt((p-1.5)/(l-1.5),0,1);d=this._texV0+m*c*this._texVScale,h=this._texV0+ki(this._texV1,l*u,m)*this._texVScale}Bi(this._passParameters.texV,d,h)}_createRibbon(e){const t=new Float32Array(3+3*fP*3),n=new Uint32Array(3*fP*5);t[0]=0,t[1]=0,t[2]=-1;for(let a=0;a<fP;a++){const o=9*a+3;t[o+0]=a,t[o+1]=this._innerRimFactor,t[o+2]=-1,t[o+3]=a,t[o+4]=this._middleRimFactor,t[o+5]=0,t[o+6]=a,t[o+7]=this._outerRimFactor,t[o+8]=1;const l=3*a+1,c=a===fP-1?1:l+3,u=15*a;n[u+0]=l,n[u+1]=l+1,n[u+2]=c+1,n[u+3]=c+1,n[u+4]=c,n[u+5]=l,n[u+6]=l+1,n[u+7]=l+2,n[u+8]=c+2,n[u+9]=c+2,n[u+10]=c+1,n[u+11]=l+1,n[u+12]=l,n[u+13]=c,n[u+14]=0}const r=IX.createBuffer(n.length),s=r.position;for(let a=0;a<n.length;++a){const o=3*n[a];s.set(a,0,t[o]),s.set(a,1,t[o+1]),s.set(a,2,t[o+2])}return new lf(e,Mn,{geometry:Dh(IX)},{geometry:In.createVertex(e,kn.STATIC_DRAW,r.buffer)})}_computeScreenRimWidth(e,t,n,r){return rt(PT,r.center,r.v2),Ye(_F,PT,this._outerRimFactor),LB(yF,t,PT,n),lW(PT,yF,e.projectionMatrix,e.viewport),lW(_F,yF,e.projectionMatrix,e.viewport),Gn(PT,_F)/e.height}};function RX(i,e,t,n,r){const s=Et(i),a=n*Math.sqrt(s*s-n*n)/s,o=Math.sqrt(n*n-a*a),l=r.v1,c=r.v2;return Ye(r.center,i,o/s),vi(l,i,e),dd(l)<1&&vi(l,i,t),Ye(l,l,a/Et(l)),vi(c,l,i),Ye(c,c,a/Et(c)),a}const yF=St(),PT=q(),_F=q();function Krt(i,e,t){return i*i/(Math.sqrt(i*i-e*e)*Math.sqrt(i*i-t*t)+e*t)}const IX=Js().vec3f(j.POSITION);let GU=class extends _n{initializeProgram(e){return new gn(e.rctx,GU.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:Na(vt.ONE,vt.ZERO,vt.ONE_MINUS_SRC_COLOR,vt.ONE),colorWrite:$i})}};GU.shader=new bn(Phe,()=>Ee(()=>import("./FogHaze.glsl-74b7f5ba.js"),["./FogHaze.glsl-74b7f5ba.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./vec3-a020a6f6.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./FloatPassUniform-d2dfc562.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./vec3f32-c9aa289f.js","./compilerUtils-034cacb8.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const Yrt=.7,Xrt=1;let IS=class extends et{constructor(e){super(e),this._passParameters=new BU;const t=e.context.renderContext.rctx;this._vao=tc(t,KA);const n=rn(e.view.spatialReference);this._planetRadius=n.radius,this._atmosphereRadius=n.radius+uA}destroy(){this._hazeTechniqueCached=Lr(this._hazeTechniqueCached),this._vao=Ht(this._vao)}get _shaderTechniqueRepository(){return this.context.shaderTechniqueRepository}set strength(e){this._passParameters.hazeStrength=e}get strength(){return this._passParameters.hazeStrength}get _hazeTechnique(){if(B(this._hazeTechniqueCached)){const e=new UU;e.haze=!0,this._hazeTechniqueCached=this._shaderTechniqueRepository.acquire(GU,e)}return this._hazeTechniqueCached}render(e,t){if(this.view.basemapTerrain.baseOpacity===0||(this._update(e,t),this._passParameters.hazeAmount<=0))return;const n=this._hazeTechnique;if(!n.compiled)return void this.context.requestRender();const r=e.offscreenRenderingHelper;r.renderDepthDetached(()=>{this._passParameters.depthTexture=r.depthTexture;const s=e.rctx.bindTechnique(n,this._passParameters,e.bindParameters);this._renderSimpleHaze(s,e)})}_renderSimpleHaze(e,t){if(B(this._vao))return;const n=t.rctx;n.bindVAO(this._vao),e.assertCompatibleVertexAttributeLocations(this._vao),n.drawArrays(Qi.TRIANGLE_STRIP,0,4)}_update(e,t){const n=e.bindParameters.camera;mt($X,n.eye);const r=Math.max(0,dt($X,e.bindParameters.lighting.mainLight.direction)),s=Qrt;Ye(LX,s,0),oo(this._passParameters.hazeColor,LX,s,r);const a=Et(n.eye),o=a*a;this._passParameters.atmosphereC=o-this._atmosphereRadius*this._atmosphereRadius,this._passParameters.hazeAmount=(1-Nx(Yrt*od,Xrt*od,Math.abs(a-this._planetRadius)))*t.amount,this._passParameters.fogStrength=t.strength}static isSupported(e){return e.capabilities.depthTexture}};f([y({constructOnly:!0})],IS.prototype,"context",void 0),f([y({constructOnly:!0})],IS.prototype,"view",void 0),IS=f([ge("esri.views.3d.environment.SimpleHaze")],IS);let Zrt=class{constructor(){this.strength=0,this.amount=0}};const Qrt=Gt(.24,.44,.8),$X=q(),LX=q();function Jrt(){const i=new Nr;return i.attributes.add(j.POSITION,"vec3"),i.attributes.add(j.COLOR,"vec4"),i.attributes.add(j.SIZE,"float"),i.varyings.add("vcolor","vec4"),i.varyings.add("vsize","float"),i.vertex.uniforms.add([new pl("transform",(e,t)=>est(e,t)),new jp("viewport",(e,t)=>t.camera.fullViewport),new Hi("pixelRatio",(e,t)=>t.camera.pixelRatio)]),i.include(Hbe),i.vertex.code.add(ee`void main(void) {
vec4 posProj = transform * vec4(position, 0);
gl_Position = alignToPixelCenter(posProj, viewport.zw);
vcolor = color / 1.2;
vsize = size * 5.0 * pixelRatio;
gl_PointSize = vsize;
}`),i.fragment.code.add(ee`void main() {
float cap = 0.7;
float scale = 1.0 / cap;
float helper = clamp(length(abs(gl_PointCoord - vec2(0.5))), 0.0, cap);
float alpha = clamp((cap - helper) * scale, 0.0, 1.0);
float intensity = alpha * alpha * alpha;
if (vsize < 3.0) {
intensity *= 0.5;
}
gl_FragColor = vec4(vcolor.xyz, intensity);
}`),i}function est(i,e){return da(Lg,e.camera.projectionMatrix),Lg[10]=24e-8-1,Lg[11]=-1,Lg[14]=(24e-8-2)*e.camera.near,Vs(Lg,Lg,e.camera.viewMatrix),Vs(Lg,Lg,i.modelMatrix)}const Lg=St(),tst=Object.freeze(Object.defineProperty({__proto__:null,build:Jrt},Symbol.toStringTag,{value:"Module"}));let ist=class extends Es{constructor(){super(...arguments),this.modelMatrix=St()}},WU=class extends _n{constructor(e){super(e,new ic,()=>this.destroy())}initializeProgram(e){return new gn(e.rctx,WU.shader.get().build(),Mn)}initializePipeline(){return yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),depthTest:{func:lo.LEQUAL},colorWrite:$i})}};WU.shader=new bn(tst,()=>Ee(()=>import("./Stars.glsl-257fb638.js"),["./Stars.glsl-257fb638.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let yv=class extends et{constructor(e){super(e),this._loadDataTask=null,this._numPoints=0,this._renderParameter=new ist,this._updatingTracking=new wb}get updating(){return this._updatingTracking.updating||this.loading}get loading(){return T(this._loadDataTask)&&!this._loadDataTask.finished}initialize(){this._loadDataTask=this._createLoadDataTask()}destroy(){this._loadDataTask=ll(this._loadDataTask),this._updatingTracking.destroy(),this._numPoints=0,this._technique=Lr(this._technique),this._vao=Ht(this._vao)}render(e){const{rctx:t}=e;if(this._ensureResources(t),B(this._technique)||B(this._vao))return;if(!this._technique.compiled)return void this.requestRender();const n=t.bindTechnique(this._technique,this._renderParameter,e.bindParameters);t.bindVAO(this._vao),n.assertCompatibleVertexAttributeLocations(this._vao),t.drawArrays(Qi.POINTS,0,this._numPoints)}_ensureResources(e){if(T(this._technique)||B(o1))return;this._technique=new WU({rctx:e,viewingMode:this.view.state.viewingMode}),this._numPoints=o1.byteLength/DX;const t=new Float32Array(o1,0,2*this._numPoints),n=new Uint8Array(o1,2*this._numPoints*4,this._numPoints);this._vao=this._createVertexArrayObject(e,t,n,this._numPoints),this._updatingTracking.add(()=>this.view.environment.lighting.type!=="virtual"?this.view.environment.lighting.date:null,r=>this._update(r),At)}_computeDayDuration(e){const t=e,n=new Date(e.getFullYear(),0,1,11,58,56);return(+t-+n)/(+new Date(e.getFullYear()+1,0,1,11,58,55)-+n)}_update(e){if(!e)return;const t=(e.getHours()/12+e.getMinutes()/60*(2/24)+e.getSeconds()/60*(2/1440)-.9972222)%2,n=2*this._computeDayDuration(e),r=da(this._renderParameter.modelMatrix,sst);d2(r,r,-n*Math.PI),Vs(r,rst,r),d2(r,r,-t*Math.PI),this.requestRender()}_hexToRGB(e){return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}_unpackUint8Attributes(e){return e>=192?[2.9,e-192]:e>=160?[2.5,e-160]:e>=128?[2,e-128]:e>=96?[1.5,e-96]:e>=64?[1,e-64]:e>=32?[.7,e-32]:[.4,e]}_createVertexArrayObject(e,t,n,r){const s=kX.createBuffer(r),a=s.position,o=s.color,l=s.size;for(let c=0;c<r;c++){const u=t[2*c+0],d=t[2*c+1];a.set(c,0,-Math.cos(u)*Math.sin(d)),a.set(c,1,-Math.sin(u)*Math.sin(d)),a.set(c,2,-Math.cos(d));const h=this._unpackUint8Attributes(n[c]),p=this._hexToRGB(nst[h[1]]);o.set(c,0,255*p[0]),o.set(c,1,255*p[1]),o.set(c,2,255*p[2]),o.set(c,3,255),l.set(c,h[0])}return new lf(e,Mn,{geometry:Dh(kX)},{geometry:In.createVertex(e,kn.STATIC_DRAW,s.buffer)})}_createLoadDataTask(){if(T(o1))return null;const e=WA(async t=>{const{data:n}=await x_e("esri/views/3d/environment/resources/stars.wsv",{responseType:"array-buffer",signal:t});this._verifyStarData(n),o1=n});return e.promise.catch(t=>{zo(t)||tt.getLogger(this.declaredClass).error(t)}).then(()=>{this.destroyed||(this.requestRender(),this.notifyChange("updating"))}),e}_verifyStarData(e){if(!e)throw new Ze("stars:no-data-received","Failed to create stars because star catalogue is missing");const t=e.byteLength/DX;if(t%1!=0||t>5e4||t<5e3)throw new Ze("stars:invalid-data","Failed to create stars because star catalogue data is invalid")}};f([y({constructOnly:!0})],yv.prototype,"view",void 0),f([y({constructOnly:!0})],yv.prototype,"requestRender",void 0),f([y({readOnly:!0})],yv.prototype,"updating",null),f([y()],yv.prototype,"_loadDataTask",void 0),f([y()],yv.prototype,"_updatingTracking",void 0),yv=f([ge("esri.views.3d.environment.Stars")],yv);const nst=["9bb2ff","9eb5ff","aabfff","bbccff","ccd8ff ","dae2ff","e4e9ff","eeefff","f8f6ff","fff9fb","fff5ef","fff1e5","ffeddb","ffe9d2","ffe6ca","ffe3c3","ffe0bb","ffddb4","ffdaad","ffd6a5","ffd29c","ffcc8f","ffc178","ffa94b","ff7b00"],rst=fne(1,0,0,0,0,.9174771405229186,.39778850739794974,0,0,-.39778850739794974,.9174771405229186,0,0,0,0,1),sst=fne(1,0,0,0,0,.9174771405229186,-.39778850739794974,0,0,.39778850739794974,.9174771405229186,0,0,0,0,1),DX=9,kX=Js().vec3f(j.POSITION).vec4u8(j.COLOR).f32(j.SIZE);let o1=null;function ast(i,e,t){const n=i.parallax.anchorPointClouds;i.fadeIn.stage===bp.FINISHED&&(i.fadeIn.factor=0,Ge(n,Rp),i.fadeIn.stage=bp.CHANGE_ANCHOR,i.crossFade.enabled=!1,i.fadeInOut.stage=Nl.FINISHED),i.fadeIn.stage===bp.CHANGE_ANCHOR&&i.isCameraPositionFinal&&(GB(i.data)&&i.renderingStage!==Ws.RENDERING||i.renderingStage===Ws.FADING_TEXTURE_CHANNELS)&&(Ge(n,Rp),i.fadeIn.stage=bp.FADE_IN,i.startTime=e,i.renderingStage===Ws.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Ws.SWITCH_CHANNELS)),i.fadeIn.factor<1&&i.fadeIn.stage===bp.FADE_IN?i.fadeIn.factor=t?lt((e-i.startTime)/(Lhe*t),0,1):1:i.fadeIn.factor>=1&&i.fadeIn.stage===bp.FADE_IN&&(i.fadeIn.stage=bp.FINISHED,i.fadeIn.factor=1)}function ost(i,e,t){const{fadeInOut:n,crossFade:r}=i;n.stage===Nl.FINISHED&&(i.startTime=e,n.factor=1,n.stage=Nl.FADE_OUT),n.factor>0&&n.stage===Nl.FADE_OUT?n.factor=t?1-lt((e-i.startTime)/(hst*t),0,1):0:(n.factor<=0&&n.stage===Nl.FADE_OUT&&(n.factor=0,Ge(i.parallax.anchorPointClouds,Rp)),n.factor<=0&&n.stage===Nl.FADE_OUT&&i.isCameraPositionFinal&&(n.factor=0,n.stage=Nl.SWITCH,i.crossFade.enabled=!1,r.factor=1),n.stage===Nl.SWITCH&&(GB(i.data)&&i.renderingStage!==Ws.RENDERING||i.renderingStage===Ws.FADING_TEXTURE_CHANNELS)&&(i.startTime=e,n.factor=0,n.stage=Nl.FADE_IN,Ge(i.parallax.anchorPointClouds,Rp),i.crossFade.enabled=!1,r.factor=1,i.renderingStage===Ws.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Ws.SWITCH_CHANNELS)),n.factor<1&&n.stage===Nl.FADE_IN?n.factor=t?lt((e-i.startTime)/(Lhe*t),0,1):1:n.factor>=1&&n.stage===Nl.FADE_IN&&(n.stage=Nl.FINISHED,n.factor=1))}function lst(i,e,t,n){const{crossFade:r}=i,s=i.parallax.anchorPointClouds;i.crossFade.enabled&&!n||(Ge(i.parallaxNew.anchorPointClouds,Rp),i.startTime=e,r.factor=0,i.crossFade.enabled=!0),r.factor<1&&i.crossFade.enabled?r.factor=t?lt((e-i.startTime)/(pst*t),0,1):1:r.factor>=1&&i.crossFade.enabled&&(i.crossFade.enabled=!1,r.factor=1,Ge(s,i.parallaxNew.anchorPointClouds),i.renderingStage===Ws.FADING_TEXTURE_CHANNELS&&(i.renderingStage=Ws.SWITCH_CHANNELS))}function FX(i,e,t,n){const r=i.fadeInOutHeight,s=r.stage===qI.FINISHED?t:i.startTimeHeightFade;if(n!==0){const a=(t-s)/(fst*n);r.factor+=e?-a:a}else r.factor=e?0:1;i.startTimeHeightFade=t,r.factor=lt(r.factor,0,1),r.stage=qI.HEIGHT_FADE}function cst(i,e,t,n,r){i.renderingStage===Ws.FINISHED_RENDERING&&(i.renderingStage=Ws.FADING_TEXTURE_CHANNELS);const s=Et(e.eye);i.fadeInOutHeight.factor<0&&(i.fadeInOutHeight.factor=s-Rc.radius>od?1:0),i.isCameraPositionFinal=af(i.cameraPositionLastFrame,e.eye),mt(Rp,e.eye),Ye(Rp,Rp,Rc.radius);const a=i.parallax;a.anchorPointClouds[0]===0&&a.anchorPointClouds[1]===0&&a.anchorPointClouds[2]===0&&Ge(a.anchorPointClouds,Rp);const o=Et(nt(dst,a.anchorPointClouds,Rp));let l=!0;o>i.fadeIn.distanceThresholdFactor*a.cloudsHeight||i.fadeIn.stage!==bp.FINISHED?ast(i,n,r):o>i.fadeInOut.distanceThresholdFactor*a.cloudsHeight||i.fadeInOut.stage!==Nl.FINISHED?ost(i,n,r):o>i.crossFade.distanceThresholdFactor*a.cloudsHeight||i.crossFade.enabled||i.renderingStage===Ws.FADING_TEXTURE_CHANNELS?lst(i,n,r,(t!==Ap.IDLE||!GB(i.data))&&i.renderingStage!==Ws.FADING_TEXTURE_CHANNELS):l=!1;const c=s-Rc.radius;if((c>1.7*od||c<-od)&&i.fadeInOutHeight.factor<1?i.fadeInOutHeight.factor=1:(c>od||c<-.35*od)&&i.fadeInOutHeight.factor<1?FX(i,!1,n,r):c<od&&c>-.35*od&&i.fadeInOutHeight.factor>0?FX(i,!0,n,r):i.fadeInOutHeight.stage=qI.FINISHED,i.renderingStage===Ws.SWITCH_CHANNELS&&(i.readChannels=1-i.readChannels,i.renderingStage=Ws.FINISHED),a.radiusCurvatureCorrectionFactor=.84*Math.sqrt(Math.max(s*s-Rc.radius*Rc.radius,0))/s,cW(NX,a.anchorPointClouds,l1),gd(a.transform,Ks,l1[3],uW(l1)),l){const{parallaxNew:u}=i;cW(NX,u.anchorPointClouds,l1),gd(u.transform,Ks,l1[3],uW(l1))}Ge(i.cameraPositionLastFrame,e.eye)}function ust(i){return i.crossFade.enabled||i.fadeInOut.stage!==Nl.FINISHED||i.fadeIn.stage!==bp.FINISHED||i.fadeInOutHeight.stage!==qI.FINISHED||i.renderingStage!==Ws.FINISHED}const NX=Gt(0,0,1),l1=_1e(),Rp=q(),dst=q(),Lhe=1,hst=.5,pst=1.3,fst=1;var xx;(function(i){i[i.Immediate=0]="Immediate",i[i.Faded=1]="Faded"})(xx||(xx={}));var mw;const mst=[at.POSTPROCESSING_ENVIRONMENT_OPAQUE,at.POSTPROCESSING_ENVIRONMENT_TRANSPARENT];let vo=mw=class extends et{constructor(i){super(i),this._handles=new mi,this._context=null,this._atmosphere=null,this._oldWeatherParameters=new bF,this._newWeatherParameters=new bF,this._fadedWeatherParameters=new bF,this._weatherParameters=this._newWeatherParameters}initialize(){this.view._stage.addRenderPlugin(mst,this)}destroy(){var i;((i=this.view)==null?void 0:i._stage)!=null&&this.view._stage.removeRenderPlugin(this),this._handles=_t(this._handles),this._set("view",null)}get atmosphereType(){return T(this._atmosphere)?this._atmosphere.type:Ma.None}get canRender(){var i;return!!((i=this.view.basemapTerrain)!=null&&i.renderer.canRender)||this.view.viewingMode!=="global"}get needsLinearDepth(){return T(this._atmosphere)&&this._atmosphere.type===Ma.Realistic}updateAnimation(i){return!!T(this._precipitation)&&this._precipitation.update(i)}get updating(){return T(this._stars)&&this._stars.updating||T(this._clouds)&&this._clouds.running}get weatherVisible(){return Et(this.view.state.camera.eye)-rn(this.view.spatialReference).radius<=od}get _stars(){var n;const i=this.view,e=((n=i.environment)==null?void 0:n.starsEnabled)??!1,t=this._get("_stars");return!e||B(this._context)?(_t(t),null):T(t)?t:new yv({view:i,requestRender:()=>this._setNeedsRender()})}get _precipitation(){const i=this._get("_precipitation");if(!this._precipitationEnabled||B(this._context))return _t(i),null;const e=this.view,t=this._context;return T(i)&&i.context===t?i:(_t(i),new N_({context:t,view:e}))}get _clouds(){const i=this._get("_clouds");if(!this.weatherEnabled||B(this._context))return _t(i),null;if(T(i))return i;const e=this.view,t=this._context;return _t(i),new Ml({context:t,view:e,requestRender:()=>this._setNeedsRender()})}get _cloudsComposition(){const i=this._get("_cloudsComposition");if(!this.weatherEnabled||B(this._context))return _t(i),null;const e=this.view.state.viewingMode,t=this._context.renderContext.rctx,n=rn(this.view.spatialReference).radius;return T(i)&&i.viewingMode===e&&i.planetRadius===n?i:(_t(i),new F_({rctx:t,viewingMode:e,planetRadius:n,requestRender:()=>this._setNeedsRender()}))}get _fog(){const i=this._get("_fog");if(!this.weatherEnabled||B(this._context))return _t(i),null;if(T(i))return i;const e=this.view,t=this._context;return new RS({context:t,view:e})}get _simpleHaze(){const i=this._get("_simpleHaze");if(!this.weatherEnabled||B(this._context))return _t(i),null;if(T(i))return i;const e=this.view,t=this._context;return new IS({context:t,view:e})}get weatherEnabled(){var i,e;return!!((e=(i=this.view)==null?void 0:i.environmentManager)!=null&&e.weatherEnabled)}get _precipitationEnabled(){return this.weatherEnabled&&(this.view.environment.weather.type==="rainy"||this.view.environment.weather.type==="snowy")}initializeRenderContext(i=null){this._context=i;const e=()=>this._setNeedsRender();this._handles.add([rs(()=>{var t;return(t=this.view)==null?void 0:t.basemapTerrain},()=>this._updateBasemapTerrain(),hn),ue(()=>({viewingMode:this.view.viewingMode,atmosphereEnabled:this.view.environment.atmosphereEnabled,atmosphereQuality:this.view.environment.atmosphere.quality}),()=>this._updateAtmosphere(),hn),ue(()=>this._stars,e),ue(()=>this._precipitation,e),ue(()=>this._clouds,()=>this._updateWeather(),At),ue(()=>this._fog,()=>this._updateFogHaze(),At),ue(()=>this._simpleHaze,()=>this._updateFogHaze(),At),ue(()=>this._weatherUpdateParameters,()=>{this._updateWeather(),this._updateFogHaze()},hn)])}uninitializeRenderContext(){this._context=null,this._atmosphere=_t(this._atmosphere),this._set("_stars",_t(this._stars)),this._set("_precipitation",_t(this._precipitation)),this._set("_clouds",_t(this._clouds)),this._set("_cloudsComposition",_t(this._cloudsComposition)),this._set("_fog",_t(this._fog)),this._set("_simpleHaze",_t(this._simpleHaze))}prepareRender(i){i.bindParameters.cloudsFade.data=cbe(this._clouds)?this._clouds:null,this.view.viewingMode!=="local"&&(cst(i.bindParameters.cloudsFade,i.bindParameters.camera,this.view.state.mode,mw.test.time||i.time,this.view.qualitySettings.weatherFadeDuration),this._updateWeatherFading(i.bindParameters),i.bindParameters.cloudsFade.renderingStage===Ws.FINISHED&&T(this._clouds)&&this._clouds.coverage===0&&this._clouds.running===!1&&this._clouds.destroyFrameBufferCube())}render(i){if(i.output===Re.Color)switch(i.bindParameters.slot){case at.POSTPROCESSING_ENVIRONMENT_OPAQUE:T(this._stars)&&this._stars.render(i),T(this._atmosphere)&&(this._atmosphere.render(i),T(this._cloudsComposition)&&T(i.bindParameters.cloudsFade.data)&&(this.weatherVisible&&T(this._clouds)&&this._clouds.updateWeatherTile(),this._cloudsComposition.render(i)),ust(i.bindParameters.cloudsFade)&&T(this._context)&&this._context.requestRender());break;case at.POSTPROCESSING_ENVIRONMENT_TRANSPARENT:if(T(this._atmosphere)&&(this._atmosphere.renderHaze(i,this._weatherParameters.haze.amount),this._weatherParameters.haze.amount>0&&this._selectAtmosphereType()!==Ma.Realistic&&T(this._simpleHaze)&&this._simpleHaze.render(i,this._weatherParameters.haze),this._weatherParameters.fog.amount>0&&T(this._fog)&&this._fog.render(i,this._weatherParameters.fog),T(this._precipitation))){const e=this.view.environment.weather;e.type!=="rainy"&&e.type!=="snowy"||this._precipitation.render(i,e.precipitation,e.type)}}}updateLightSources(i,e,t,n){if(T(this._context)){const r=this._context.renderContext;r.bindParameters.oldLighting.copyFrom(r.bindParameters.lighting),r.bindParameters.newLighting.noonFactor=e,r.bindParameters.newLighting.globalFactor=t,r.bindParameters.newLighting.set(i),n===xx.Faded||r.bindParameters.weatherFading?r.bindParameters.fadeLighting(0):r.bindParameters.fadeLighting(1),this._context.requestRender()}}get _weatherUpdateParameters(){const i=this.weatherEnabled?this.view.environment.weather:null;return B(i)?null:i.type==="rainy"||i.type==="snowy"?{type:i.type,weatherAdjustment:i.cloudCover,effect:i.precipitation}:{type:i.type,weatherAdjustment:i.type==="foggy"?i.fogStrength:i.cloudCover}}_updateWeatherFading(i){if(!i.weatherFading)return;const e=i.cloudsFade;return e.fadeIn.stage===bp.FADE_IN?(i.fadeLighting(e.fadeIn.factor),void this._fadeWeather(e.fadeIn.factor)):e.fadeInOut.stage===Nl.FADE_IN?(i.fadeLighting(e.fadeInOut.factor),void this._fadeWeather(e.fadeInOut.factor)):e.crossFade.enabled?(i.fadeLighting(e.crossFade.factor),void this._fadeWeather(e.crossFade.factor)):(i.fadeLighting(0),void this._fadeWeather(0))}_fadeWeather(i){const{_newWeatherParameters:e,_oldWeatherParameters:t}=this;i>=1?this._weatherParameters=e:(this._fadedWeatherParameters.lerp(t,e,i),this._weatherParameters=this._fadedWeatherParameters)}_updateWeather(){const i=this._weatherUpdateParameters;B(i)||B(this._clouds)||(this._clouds.applyPreset(bo[i.type],i.weatherAdjustment),this._setNeedsRender())}_setNeedsRender(){T(this._context)&&this._context.requestRender()}_updateFogHaze(){const i=this._weatherUpdateParameters;if(B(this._fog)||B(this._simpleHaze)||B(i)||B(this._context))return;const e=this._context.renderContext.bindParameters;switch(this._oldWeatherParameters.copyFrom(this._weatherParameters),i.type){case"foggy":this._newWeatherParameters.fog.strength=ki(3e-5,.005,i.weatherAdjustment**3),Ge(this._newWeatherParameters.fog.color,VX),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=this._selectAtmosphereType()===Ma.Realistic?1:0,this._setNeedsRender();break;case"rainy":this._newWeatherParameters.fog.strength=ki(4e-6,2e-4,i.effect**3),Ge(this._newWeatherParameters.fog.color,gst),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=0,this._setNeedsRender();break;case"snowy":this._newWeatherParameters.fog.strength=ki(4e-6,2e-4,i.effect**3),Ge(this._newWeatherParameters.fog.color,VX),this._newWeatherParameters.fog.amount=1,this._newWeatherParameters.haze.strength=0,this._newWeatherParameters.haze.amount=this._selectAtmosphereType()===Ma.Realistic?1:0,this._setNeedsRender();break;default:this._newWeatherParameters.fog.strength=0,this._newWeatherParameters.fog.amount=0,this._newWeatherParameters.haze.strength=4e-6,this._newWeatherParameters.haze.amount=1,this._setNeedsRender()}e.weatherFading?this._fadeWeather(0):this._fadeWeather(1)}_updateAtmosphere(){const i=this._selectAtmosphereType();if(this.atmosphereType===i)return;const e=this._getAtmosphereClass();if(!e)return T(this._atmosphere)&&(this._atmosphere.destroy(),this._atmosphere=null,this._setNeedsRender()),void this._updateBasemapTerrain();T(this._context)&&(_t(this._atmosphere),this._atmosphere=new e(this.view),this._atmosphere.initializeRenderContext(this._context),this._setNeedsRender(),this._updateBasemapTerrain())}_getAtmosphereClass(){switch(this._selectAtmosphereType()){case Ma.None:return null;case Ma.Realistic:return _X;case Ma.Panoramic:return $rt;case Ma.Simple:return qrt;default:return}}_selectAtmosphereType(){const i=this.view.get("environment.atmosphereEnabled"),e=this.view.get("environment.atmosphere.quality"),t=this.view.viewingMode;return!i||e==null||UA(this.view.spatialReference)?Ma.None:t==="local"?Ma.Panoramic:e==="high"&&T(this._context)&&_X.isSupported(this._context)&&NI(this.view.spatialReference)?Ma.Realistic:Ma.Simple}_updateBasemapTerrain(){this.view.basemapTerrain&&(this.view.basemapTerrain.velvetOverground=T(this._atmosphere)&&this.atmosphereType===Ma.Simple)}get test(){return{atmosphere:this._atmosphere,clouds:this._clouds,selectAtmosphereType:()=>this._selectAtmosphereType(),stubGetAtmosphereClass:i=>{BX=mw.prototype._getAtmosphereClass,mw.prototype._getAtmosphereClass=i},restoreGetAtmosphereClass:()=>{mw.prototype._getAtmosphereClass=BX}}}};vo.test={time:Wi(0)},f([y({constructOnly:!0})],vo.prototype,"view",void 0),f([y({type:Boolean,readOnly:!0})],vo.prototype,"updating",null),f([y({readOnly:!0})],vo.prototype,"weatherVisible",null),f([y()],vo.prototype,"_context",void 0),f([y({readOnly:!0})],vo.prototype,"_stars",null),f([y({readOnly:!0})],vo.prototype,"_precipitation",null),f([y({readOnly:!0})],vo.prototype,"_clouds",null),f([y({readOnly:!0})],vo.prototype,"_cloudsComposition",null),f([y({readOnly:!0})],vo.prototype,"_fog",null),f([y({readOnly:!0})],vo.prototype,"_simpleHaze",null),f([y({readOnly:!0})],vo.prototype,"weatherEnabled",null),f([y({readOnly:!0})],vo.prototype,"_precipitationEnabled",null),f([y({readOnly:!0})],vo.prototype,"_weatherUpdateParameters",null),vo=mw=f([ge("esri.views.3d.environment.EnvironmentRenderer")],vo);let bF=class{constructor(){this.fog=new Crt,this.haze=new Zrt}copyFrom(e){this.fog.amount=e.fog.amount,this.haze.amount=e.haze.amount,this.fog.strength=e.fog.strength,this.haze.strength=e.haze.strength,Ge(this.fog.color,e.fog.color)}lerp(e,t,n){this.fog.amount=ki(e.fog.amount,t.fog.amount,n),this.haze.amount=ki(e.haze.amount,t.haze.amount,n),this.fog.strength=ki(e.fog.strength,t.fog.strength,n),this.haze.strength=ki(e.haze.strength,t.haze.strength,n),oo(this.fog.color,e.fog.color,t.fog.color,n)}};const gst=Gt(.5,.5,.5),VX=Gt(1.5,1.5,1.5);let BX;function zX(i,e,t){if(B(e.longitude)||B(e.latitude)||B(t.longitude)||B(t.latitude))throw new Error("Invalid points: no lon/lat");return vst(i,e.longitude,e.latitude,t.longitude,t.latitude)}function vst(i,e,t,n,r){const s=zi(t),a=zi(r),o=s-a,l=zi(e)-zi(n),c=Math.sin(o/2),u=Math.sin(l/2),d=2*nf(Math.sqrt(c*c+Math.cos(s)*Math.cos(a)*u*u))*i;return Math.round(1e4*d)/1e4}function yst(i,e,t){const n=e.spatialReference,r=rn(n),s=new Wt(e.x,i.y,n),a=new Wt(t.x,i.y,n),o=new Wt(i.x,e.y,n),l=new Wt(i.x,t.y,n);return{lon:zX(r.radius,s,a),lat:zX(r.radius,o,l)}}function _st(i,e,t){const n=e/t,r=zi(i),s=Math.sin(n/2),a=Math.cos(r),o=2*nf(Math.sqrt(s*s/(a*a)));return ql(o)}function bst(i,e){let t=i/15;return e||(t=Math.round(t)),t}function UX(i,e){e||(e={hours:0,minutes:0,seconds:0}),e.hours=bst(i[0],!0);const t=e.hours%1;e.hours-=t,e.minutes=60*t;const n=e.minutes%1;return e.minutes-=n,e.seconds=Math.round(60*n),e}var HX,GX,WX,Dhe={exports:{}};HX=Dhe,GX=function(){var i=Math.PI,e=Math.sin,t=Math.cos,n=Math.tan,r=Math.asin,s=Math.atan2,a=Math.acos,o=i/180,l=864e5,c=2440588,u=2451545,d={dec:0,ra:0};function h(D){return D.valueOf()/l-.5+c}function p(D){return new Date((D+.5-c)*l)}function m(D){return h(D)-u}var g=23.4397*o;function _(D,$){return s(e(D)*t(g)-n($)*e(g),t(D))}function b(D,$){return r(e($)*t(g)+t($)*e(g)*e(D))}function x(D,$,F){return s(e(D),t(D)*e($)-n(F)*t($))}function w(D,$,F){return r(e($)*e(F)+t($)*t(F)*t(D))}function C(D,$){return o*(280.16+360.9856235*D)-$}function S(D){return o*(357.5291+.98560028*D)}function E(D){return o*(1.9148*e(D)+.02*e(2*D)+3e-4*e(3*D))}function A(D,$){return D+$+102.9372*o+i}function P(D,$){var F=S(D),Y=A(F,E(F));return $||($={dec:0,ra:0}),$.dec=b(Y,0),$.ra=_(Y,0),$}var O={PolarException:{NORMAL:0,MIDNIGHT_SUN:1,POLAR_NIGHT:2},getPosition:function(D,$,F,Y){var ne=o*-F,X=o*$,J=m(D),he=P(J,d),ye=C(J,ne)-he.ra;return Y||(Y={azimuth:0,altitude:0}),Y.azimuth=x(ye,X,he.dec),Y.altitude=w(ye,X,he.dec),Y}},M=[[-.83,"sunrise","sunset"]];O.addTime=function(D,$,F){M.push([D,$,F])};var V=9e-4;function L(D,$){return Math.round(D-V-$/(2*i))}function U(D,$,F){return V+(D+$)/(2*i)+F}function G(D,$,F){return u+D+.0053*e($)-.0069*e(2*F)}function H(D,$,F){return a((e(D)-e($)*e(F))/(t($)*t(F)))}function k(D){var $=o*(134.963+13.064993*D),F=o*(93.272+13.22935*D),Y=o*(218.316+13.176396*D)+6.289*o*e($),ne=5.128*o*e(F),X=385001-20905*t($);return{ra:_(Y,ne),dec:b(Y,ne),dist:X}}return O.getTimes=function(D,$,F){var Y=o*-F,ne=o*$,X=L(m(D),Y),J=U(0,Y,X),he=S(J),ye=E(he),Te=A(he,ye),ce=b(Te,0),ae=G(J,he,Te);function le(ve){return G(U(H(ve,ne,ce),Y,X),he,Te)}function fe(ve){var ke=(e(ve)-e(ne)*e(ce))/(t(ne)*t(ce));return ke<-1?O.PolarException.MIDNIGHT_SUN:ke>1?O.PolarException.POLAR_NIGHT:O.PolarException.NORMAL}var Ue,ie,oe,we,Ae,Oe={solarNoon:p(ae),nadir:p(ae-.5),polarException:O.PolarException.NORMAL};for(Ue=0,ie=M.length;Ue<ie;Ue+=1)Ae=ae-((we=le((oe=M[Ue])[0]*o))-ae),Oe[oe[1]]=p(Ae),Oe[oe[2]]=p(we);return Oe.polarException=fe(M[0][0]*o),Oe},O.getMoonPosition=function(D,$,F){var Y=o*-F,ne=o*$,X=m(D),J=k(X),he=C(X,Y)-J.ra,ye=w(he,ne,J.dec);return ye+=.017*o/n(ye+10.26*o/(ye+5.1*o)),{azimuth:x(he,ne,J.dec),altitude:ye,distance:J.dist}},O.getMoonFraction=function(D){var $=m(D),F=P($),Y=k($),ne=149598e3,X=a(e(F.dec)*e(Y.dec)+t(F.dec)*t(Y.dec)*t(F.ra-Y.ra)),J=s(ne*e(X),Y.dist-ne*t(X));return(1+t(J))/2},O},(WX=GX())!==void 0&&(HX.exports=WX);const ub=Dhe.exports,wp={local:{altitude:1500,ambientAtNight:.1,ambientAtNoon:.45,ambientAtTwilight:.2,directAtNoon:.65,directAtTwilight:.7},global:{altitude:8e5,ambient:.015,direct:.75},planarDirection:{localAltitude:1e4,globalAltitude:1e6,globalAngles:{azimuth:1.3*Math.PI,altitude:.6*Math.PI}}};function wst(i,e,t,n,r,s){je(s.ambient.color,1,1,1),s.ambient.intensity=wp.global.ambient,je(s.direct.color,1,1,1),s.direct.intensity=wp.global.direct;const a=e[2],o=lt((Math.abs(a)-wp.local.altitude)/(wp.global.altitude-wp.local.altitude),0,1);let l;if(s.globalFactor=o,T(i)&&(l=ub.getTimes(i,e[1],e[0])),o<1){let c;if(T(i))c=Mst(i,l,n);else{const u=Nhe(n);c={direct:{intensity:wp.local.directAtNoon*u.direct,color:Gt(1,1,1)},ambient:{intensity:wp.local.ambientAtNoon*u.ambient,color:Gt(1,1,1)},timeOfDay:"early afternoon"}}oo(s.ambient.color,c.ambient.color,s.ambient.color,o),s.ambient.intensity=ki(c.ambient.intensity,s.ambient.intensity,o),oo(s.direct.color,c.direct.color,s.direct.color,o),s.direct.intensity=ki(c.direct.intensity,s.direct.intensity,o),s.specularStrength=n==="rainy"||n==="snowy"||n==="foggy"?0:1,s.environmentStrength=n==="rainy"?.7:n==="snowy"||n==="foggy"?.75:1}s.noonFactor=T(i)?Ast(i,l):1,T(i)?xst(i,e,t,s.direct.directionToLightSource):khe(r,t,s.direct.directionToLightSource)}function khe(i,e,t){e===Ot.Global?mt(wF,i.eye):je(wF,0,0,1),Ye(xF,i.viewForward,-1);const n=rR(xF,wF),r=Math.max(n-2*CF,0),s=.85*r/(r+1),a=Math.max(CF,n-CF-s);Mh(qX,-a,i.viewRight),$t(t,xF,qX),rt(t,t,Ye(Pst,i.viewRight,Ost)),mt(t,t)}function xst(i,e,t,n){const r=Est,s=Q0(Sst);if(t===Ot.Global)ub.getPosition(i,0,0,r),je(n,0,0,-1),h2(s,s,-r.azimuth),DB(s,s,-r.altitude),$t(n,n,s);else{const a=wp.planarDirection,o=a.globalAngles,l=e[2];let c=(Math.abs(l)-a.localAltitude)/(a.globalAltitude-a.localAltitude);c=lt(c,0,1),c<1?(ub.getPosition(i,e[1],e[0],r),r.azimuth=(1-c)*r.azimuth+c*o.azimuth,r.altitude=(1-c)*r.altitude+c*o.altitude):(r.azimuth=o.azimuth,r.altitude=o.altitude),je(n,0,-1,0),d2(s,s,-r.azimuth),h2(s,s,-r.altitude),$t(n,n,s)}}function Cst(i,e){if(e===Ot.Global)return!0;const t=wp.planarDirection;return Math.abs(i)<t.localAltitude}const Tst=Gt(.5773502691896258,-.5773502691896258,.5773502691896258);let Fhe=class{constructor(){this.ambient={color:Gt(1,1,1),intensity:.55},this.direct={color:Gt(1,1,1),intensity:.55,directionToLightSource:Ts(Tst)},this.noonFactor=.5,this.globalFactor=0,this.specularStrength=1,this.environmentStrength=1}};const Sst=St(),Est={azimuth:0,altitude:0};function Ast(i,e){const t=i.valueOf();let n,r;e.polarException===ub.PolarException.MIDNIGHT_SUN?(n=t-60*(i.getHours()+48)*60*1e3-60*i.getMinutes()*1e3,r=n+432e6):e.polarException===ub.PolarException.POLAR_NIGHT?(n=t-2,r=t-1):(n=e.sunrise.valueOf(),r=e.sunset.valueOf());const s=n+(r-n)/2;return 1-lt(Math.abs(t-s)/432e5,0,1)}function Nhe(i){switch(i){case"disabled":case"sunny":case"cloudy":return{direct:1,ambient:1};case"rainy":return{direct:.4,ambient:1.2};case"snowy":return{direct:.5,ambient:1.3};case"foggy":return{direct:.2,ambient:1.6}}}function jX(i,e){const t=(i[0]+i[1]+i[2])/3;for(let n=0;n<3;n++)i[n]=i[n]+(t-i[n])*e;return i}function Mst(i,e,t){const n=i.valueOf();let r,s;e.polarException===ub.PolarException.MIDNIGHT_SUN?(r=n-60*(i.getHours()+48)*60*1e3-60*i.getMinutes()*1e3,s=r+432e6):e.polarException===ub.PolarException.POLAR_NIGHT?(r=n-2,s=n-1):(r=e.sunrise.valueOf(),s=e.sunset.valueOf());const a=s-r,o=r+a/2,l=a/4,c=o-l,u=o+l,d=.06*a,h=r-d/2,p=r+d/2,m=s-d/2,g=s+d/2,_=wp.local,b=[.01,_.ambientAtNight],x=[.8,.8,1],w=[.01,.01,.01],C=[_.directAtTwilight,_.ambientAtTwilight],S=[1,.6,.5],E=[.8,.8,1],A=[.9*_.directAtNoon,_.ambientAtNoon],P=[1,.98,.98],O=[.98,.98,1],M=[_.directAtNoon,_.ambientAtNoon],V=[1,1,1],L=[1,1,1],U=A,G=P,H=O,k=C,D=S,$=E;let F,Y,ne=[0,0],X=[0,0,0],J=[0,0,0];n<h||n>g?(ne=b,X=w,J=x,Y="night"):n<p?(F=p-h,ne=za(n-h,F,b,C),X=za(n-h,F,w,S),J=za(n-h,F,x,E),Y="sun rising"):n<c?(F=c-p,ne=za(n-p,F,C,A),X=za(n-p,F,S,P),J=za(n-p,F,E,O),Y="early morning"):n<o?(F=o-c,ne=za(n-c,F,A,M),X=za(n-c,F,P,V),J=za(n-c,F,O,L),Y="late morning"):n<u?(F=u-o,ne=za(n-o,F,M,U),X=za(n-o,F,V,G),J=za(n-o,F,L,H),Y="early afternoon"):n<m?(F=m-u,ne=za(n-u,F,U,k),X=za(n-u,F,G,D),J=za(n-u,F,H,$),Y="late afternoon"):n<g&&(F=g-m,ne=za(n-m,F,k,b),X=za(n-m,F,D,w),J=za(n-m,F,$,x),Y="sun setting");let he=0;switch(t){case"rainy":case"foggy":he=.9;case"snowy":he=.5}he>0&&(X=jX(X,he),J=jX(J,he));const ye=Gt(X[0],X[1],X[2]),Te=Gt(J[0],J[1],J[2]),ce=Nhe(t);return{direct:{intensity:ne[0]*ce.direct,color:ye},ambient:{intensity:ne[1]*ce.ambient,color:Te},timeOfDay:Y}}function za(i,e,t,n){const r=[];for(let s=0;s<t.length;s++)r[s]=(n[s]-t[s])*i/e+t[s];return r}const qX=St(),wF=q(),xF=q(),Pst=q(),CF=.25,Ost=.2;let Wd=class extends Pn.EventedAccessor{constructor(){super(),this._referencePointUpdateDelay=200,this._referencePointUpdateInterval=3e3,this._referencePointUpdateDistThreshold=1e6,this._referencePosUpdateQuery=null,this._referencePosMapCoordsRequested=null,this._viewHandles=new mi,this._preserveAbsoluteDateTime=!1,this._trackingEnabled=!1,this._referencePosResetPreserveAbsoluteTime=!1,this._referencePosUpdateTimer=null,this._referencePosMapCoords=null,this._mainLight=new mbe,this._ambientLight=new Ene,this._moonLight=new gbe,this.disableQueries=!1,this._disableWeather=!1,this._renderer=null,this._referencePosWGS84Comparable=null,this._resetReferencePosition()}destroy(){this.disconnectView(),this._viewHandles.destroy()}get _view(){var e;return(e=this._renderer)==null?void 0:e.view}get updating(){var e;return!((this.disableQueries||!this._referencePosUpdateQuery&&!this._referencePosMapCoordsRequested)&&!((e=this._renderer)!=null&&e.updating))}get weatherEnabled(){var e,t,n;return((e=this._view)==null?void 0:e.environment.atmosphereEnabled)&&!this._disableWeather&&((n=(t=this._view)==null?void 0:t.state)==null?void 0:n.viewingMode)===Ot.Global&&NI(this._view.spatialReference)}get weatherVisible(){var e;return this.weatherEnabled&&((e=this._renderer)==null?void 0:e.weatherVisible)}get referencePositionWGS84Comparable(){return this._referencePosWGS84Comparable}connectView(e){if(this._renderer)return;this._renderer=new vo({view:e});const t=()=>this._updateRenderParameters(),n=()=>this._cameraHandler();this._viewHandles.add([ue(()=>e.environment.lighting,r=>this._updateLightingHandler(r),on),ue(()=>e.environment.lighting.type!=="virtual"?e.environment.lighting.date:null,r=>this._lightingDateHandler(r),on),ue(()=>e.stationary,()=>this._interactingStationaryHandler()),ue(()=>e.environment.lighting.directShadowsEnabled,t,on),ue(()=>e.environment.lighting.ambientOcclusionEnabled,t,on),ue(()=>e.environment.lighting.waterReflectionEnabled,t,on),ue(()=>{var r;return(r=e.environment.background)==null?void 0:r.color},t,on),ue(()=>e.spatialReference,()=>this._resetReferencePosition(!0),on),ue(()=>e.environment.weather.type,()=>this._updateLighting(null,xx.Faded),on),ue(()=>this.weatherEnabled,()=>this._updateLighting(null,xx.Faded),on),ue(()=>e.viewingMode,()=>this._resetReferencePosition(!0),hn),ue(()=>e.environment.lighting.type!=="virtual"&&e.environment.lighting.cameraTrackingEnabled,r=>this._updateCameraTracking(r),hn),ue(()=>e.state.camera,n,hn),ue(()=>this.disableQueries,n)]),this._updateRenderParameters(),this._updateLighting(),this._cameraHandler(),this.notifyChange("updating")}disconnectView(){this._viewHandles.removeAll(),this._resetReferencePosition(),this._renderer=_t(this._renderer)}_updateLightingHandler(e){this._updateCameraTracking(e.type!=="virtual"&&e.cameraTrackingEnabled),this._lightingDateHandler(e.type!=="virtual"?e.date:null),this._updateRenderParameters()}_updateCameraTracking(e){if(this._trackingEnabled=e,e)this._cameraHandler();else{const t=this._view.environment.lighting;(t==null?void 0:t.type)!=="virtual"&&(t.positionTimezoneInfo.autoUpdated=!1)}}_lightingDateHandler(e){const t=this._view.environment.lighting;if((t==null?void 0:t.type)!=="virtual"){if(e){if(!t.positionTimezoneInfo.autoUpdated){this._preserveAbsoluteDateTime=!0;const n=this._view.spatialReference;if(!X0(n)){const r=this._view.camera.position;if(!this._referencePosMapCoords||!this._referencePosMapCoords.equals(r))return void this._requestReferencePositionUpdate(r)}if(this._preupdateTracking(e),T(this._referencePosWGS84Comparable)){const r=UX(this._referencePosWGS84Comparable,KX);T(r)&&(t.autoUpdate(null,r),this._trackingEnabled&&(t.positionTimezoneInfo.autoUpdated=!0))}}this._updateLighting(e)}}else this._updateLighting()}_preupdateTracking(e){!this._trackingEnabled&&this._view.environment.lighting.type!=="virtual"&&this._view.environment.lighting.cameraTrackingEnabled&&this._cameraHandler(e)}_cameraHandler(e=null){const t=this._view;if(!t.ready)return;const n=t.stateManager.camera;n&&(this._cameraHandlerClientSide(n,e)||this._cameraHandlerServerSide(n))}_cameraHandlerClientSide(e,t){const n=NI(this._view.spatialReference);if(n&&!X0(this._view.spatialReference))return this._view.environment.lighting.type==="virtual"&&this._updateLighting(),!1;const r=e.position;return B(this._referencePosWGS84Comparable)&&(this._referencePosWGS84Comparable=q()),n?Hye(r,this._referencePosWGS84Comparable):je(this._referencePosWGS84Comparable,r.longitude,r.latitude,r.z),this.notifyChange("referencePositionWGS84Comparable"),this._autoUpdateTimezone(this._referencePosWGS84Comparable,t)||this._updateLighting(t),!0}_cameraHandlerServerSide(e){const t=e.position;(!this._referencePosMapCoords||this._referencePosMapCoordsRequested||this._exceedsReferencePosDistThreshold(t))&&this._requestReferencePositionUpdate(t,!0),this._view.mapCoordsHelper&&this._referencePosWGS84Comparable&&(this._referencePosWGS84Comparable[2]=t.z*this._view.mapCoordsHelper.unitInMeters,this._referencePosChanged())}_interactingStationaryHandler(){this._view.stationary&&this._executePendingReferencePositionUpdate()}_updateLighting(e,t=xx.Immediate){const n=this._view;e=e||(n.environment.lighting.type==="virtual"?null:n.environment.lighting.date);const r=this._referencePosWGS84Comparable,s=T(r)?Rst:Ist,a=this.weatherVisible?n.environment.weather.type:"disabled";T(r)?wst(e,r,n.state.viewingMode,a,n.state.camera,s):n.environment.lighting.type==="virtual"&&khe(n.state.camera,n.state.viewingMode,s.direct.directionToLightSource);const o=this._mainLight,l=s.direct;Ye(o.intensity,l.color,l.intensity*Math.PI),Ge(o.direction,l.directionToLightSource),o.specularStrength=s.specularStrength,o.environmentStrength=s.environmentStrength;const c=this._ambientLight;Ye(c.intensity,s.ambient.color,s.ambient.intensity);const u=this._moonLight;oo(u.intensity,Lst,Dst,s.globalFactor);const d=(1-.5*s.globalFactor)*(1-.4*s.noonFactor*(1-s.globalFactor));Ye(u.intensity,u.intensity,d),Ge(u.direction,l.directionToLightSource),this._renderer.updateLightSources([o,c,u],s.noonFactor,s.globalFactor,t),this._updateRenderParameters()}_autoUpdateTimezone(e,t=null){if(this._view.environment.lighting.type==="virtual"||!this._view.environment.lighting.cameraTrackingEnabled||B(e))return!1;const n=$st;n.setTime((t||this._view.environment.lighting.date).getTime());const r=UX(e,KX);if(B(r))return!1;let s=this._view.environment.lighting.positionTimezoneInfo;if(s.autoUpdated){if(s.hours===r.hours&&s.minutes===r.minutes&&s.seconds===r.seconds)return!1}else s=r;const a=n.getUTCHours()-(r.hours-s.hours),o=n.getUTCMinutes()-(r.minutes-s.minutes),l=n.getUTCSeconds()-(r.seconds-s.seconds);return n.setUTCHours(a),n.setUTCMinutes(o),n.setUTCSeconds(l),!t&&this._view.environment.lighting.autoUpdate(n,r)}_updateRenderParameters(){const e=this._view._stage;if(!e)return;const t=Ov(this._referencePosWGS84Comparable,!0,s=>Cst(s[2],this._view.state.viewingMode)),n=this._view.environment.background,r=n instanceof whe?{type:"color",color:yne(Xt.toUnitRGBA(n.color))}:{type:"color",color:Xn(0,0,0,1)};e.renderView.setRenderParameters({shadowMap:this._view.environment.lighting.directShadowsEnabled&&t,background:r,environment:this._view.environment,weatherVisible:this._view.environmentManager.weatherVisible})}_resetReferencePosition(e=!1){this._cancelReferencePosUpdates(),this._referencePosMapCoords=null,this._referencePosMapCoordsRequested=null,this._referencePosResetPreserveAbsoluteTime=null,this._referencePosWGS84Comparable=null,this.notifyChange("updating"),e&&this._cameraHandler()}_requestReferencePositionUpdate(e,t=!1){if(!this.disableQueries&&(this._referencePosMapCoordsRequested?this._referencePosMapCoordsRequested.copy(e):this._referencePosMapCoordsRequested=e.clone(),this._referencePosResetPreserveAbsoluteTime=!!t,!this._referencePosUpdateQuery&&!this._referencePosUpdateTimer&&this._view.stationary)){const n=this._referencePosUpdateQuery=Fx(this._referencePointUpdateDelay).then(()=>{if(this._referencePosUpdateQuery===n){const s=()=>this._referencePosUpdateQuery!==n;return this._doReferencePositionUpdateQuery(s)}}).catch(s=>{s.name==="mapcoordshelper:missing-geometry-service"&&(this.disableQueries=!0)}).then(()=>{this._referencePosUpdateQuery===n&&(this._referencePosUpdateQuery=null,this._referencePosUpdateTimer||this._executePendingReferencePositionUpdate(),this.notifyChange("updating"))}),r=this._referencePosUpdateTimer=Fx(this._referencePointUpdateInterval).then(()=>{this._referencePosUpdateTimer===r&&(this._referencePosUpdateTimer=null,this._referencePosUpdateQuery||this._executePendingReferencePositionUpdate())});this.notifyChange("updating")}}async _doReferencePositionUpdateQuery(e){this._referencePosResetPreserveAbsoluteTime&&(this._preserveAbsoluteDateTime=!1),this._referencePosMapCoords?this._referencePosMapCoords.copy(this._referencePosMapCoordsRequested):this._referencePosMapCoords=this._referencePosMapCoordsRequested.clone(),this._referencePosResetPreserveAbsoluteTime=null,this._referencePosMapCoordsRequested=null;const t=await this._view.mapCoordsHelper.toGeographic(this._referencePosMapCoords);if(!e()&&!isNaN(t[0])&&!isNaN(t[1])){const n=this._referencePosMapCoords.z*this._view.mapCoordsHelper.unitInMeters;this._referencePosWGS84Comparable?(this._referencePosWGS84Comparable[0]=t[0],this._referencePosWGS84Comparable[1]=t[1],this._referencePosWGS84Comparable[2]=n):this._referencePosWGS84Comparable=[t[0],t[1],n],this._referencePosChanged()}}_executePendingReferencePositionUpdate(){const e=this._referencePosMapCoordsRequested;e&&this._requestReferencePositionUpdate(e,this._referencePosResetPreserveAbsoluteTime)}_referencePosChanged(){this._preserveAbsoluteDateTime?this._updateLighting():this._autoUpdateTimezone(this._referencePosWGS84Comparable)||this._updateLighting(),this.notifyChange("referencePositionWGS84Comparable")}_exceedsReferencePosDistThreshold(e){if(this._referencePosMapCoords){let t=this._referencePosMapCoords.distance(e);return this._view.mapCoordsHelper&&(t*=this._view.mapCoordsHelper.unitInMeters),t>this._referencePointUpdateDistThreshold}return!0}_cancelReferencePosUpdates(){const e=!!this._referencePosUpdateQuery;return this._referencePosUpdateQuery=null,this._referencePosUpdateTimer=null,e}get test(){const e=this;return{get renderer(){return e._renderer},set referencePointUpdateInterval(t){e._referencePointUpdateInterval=t},set referencePointUpdateDistThreshold(t){e._referencePointUpdateDistThreshold=t},set referencePosUpdateTimer(t){e._referencePosUpdateTimer=t},set referencePointUpdateDelay(t){e._referencePointUpdateDelay=t},set disableWeather(t){e._disableWeather=t}}}};f([y({type:Boolean,readOnly:!0})],Wd.prototype,"updating",null),f([y()],Wd.prototype,"disableQueries",void 0),f([y()],Wd.prototype,"_disableWeather",void 0),f([y()],Wd.prototype,"weatherEnabled",null),f([y()],Wd.prototype,"weatherVisible",null),f([y()],Wd.prototype,"referencePositionWGS84Comparable",null),f([y()],Wd.prototype,"_renderer",void 0),f([y()],Wd.prototype,"_referencePosWGS84Comparable",void 0),Wd=f([ge("esri.views.3d.environment.SceneViewEnvironmentManager")],Wd);const Rst=new Fhe,Ist=new Fhe,$st=new Date,KX={hours:0,minutes:0,seconds:0},Lst=Gt(.22,.22,.33),Dst=Gt(.22,.22,.22);var qn;(function(i){i[i.NONE=0]="NONE",i[i.TILT=1]="TILT",i[i.ALTITUDE=2]="ALTITUDE",i[i.DISTANCE=4]="DISTANCE",i[i.COLLISION=8]="COLLISION",i[i.ALL=15]="ALL",i[i.ALL_EXCEPT_COLLISION=7]="ALL_EXCEPT_COLLISION"})(qn||(qn={}));var Si;(function(i){i[i.NONE=0]="NONE",i[i.ZOOM=1]="ZOOM",i[i.TUMBLE=2]="TUMBLE",i[i.LOOK_AROUND=3]="LOOK_AROUND",i[i.PAN=4]="PAN",i[i.ASCEND=5]="ASCEND"})(Si||(Si={}));var va;(function(i){i[i.TUMBLE=0]="TUMBLE",i[i.LOOK_AROUND=1]="LOOK_AROUND"})(va||(va={}));function hA(i,e){return(i&e)!=0}function V$(i,e,t,n,r,s){i!==0&&(t?(s.min=Math.min(s.min,e),s.max=Math.max(s.max,e)):n!=null?(s.min-=Math.max(0,(e-s.min)*(1-n)),s.max+=Math.max(0,(e-s.max)*(1-n))):r&&(s.min-=Math.max(0,e-s.min-r),s.max+=Math.max(0,e-s.max-r)))}const Py={selection:qn.NONE,interactionType:Si.NONE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:va.TUMBLE};function Vhe(i,e,t,n){return e=e||i.viewForward,Ge(n,e),Ye(n,n,Math.sign(dt(e,t))),n}function kst(i,e,t,n){return zst(i,e,t,Vst(n,e,t,!0))}function Fst(i,e,t,n){const r=dt(t,nt(i,n,e));return rt(i,e,Ye(i,t,r))}const Nst={dir:q(),len:0,clip:xt()};function Vst(i,e,t,n){const r=Nst;return i?(t&&n&&(r.len=Gn(e,t)),Ge(r.dir,i)):n?(r.len=Gn(e,t),nt(r.dir,t,e),Ye(r.dir,r.dir,1/r.len)):(nt(r.dir,t,e),mt(r.dir,r.dir)),r}function Bst(i,e,t){const n=dt(ro(i),t.dir),r=-tr(i,e);if(r<0&&n>=0)return!1;if(n>-1e-6&&n<1e-6)return r>0;if((r<0||n<0)&&!(r<0&&n<0))return!0;const s=r/n;return n>0?s<t.clip[1]&&(t.clip[1]=s):s>t.clip[0]&&(t.clip[0]=s),t.clip[0]<=t.clip[1]}function zst(i,e,t,n){n.clip[0]=0,n.clip[1]=t?n.len:Number.MAX_VALUE;for(let r=0;r<i.length;r++)if(!Bst(i[r],e,n))return!1;return!0}function Ust(i,e,t=Py){const n=jU(i,e,t);if(n===0)return!1;const r=i.renderCoordsHelper,s=r.getAltitude(e.eye)+n,a=Vhe(e,t.interactionDirection,Wst(i,e,Math.sign(n),Yst),Kst),o=Ge(Xst,e.viewForward),l=r.intersectInfiniteManifold(Ah(e.eye,a),s,TF);return e.eye=T(l)?l:r.setAltitude(TF,s,e.eye),e.center=Fst(TF,e.eye,o,e.center),!0}function jU(i,e,t=Py){if(!Hst(i,t))return 0;const n=jst(i.state.constraints.altitude,qst);Gst(i,t,n);const r=i.renderCoordsHelper.getAltitude(e.eye),s=lt(r,n.min,n.max)-r;return Math.abs(s)<=1e-6?0:s}function Hst(i,e){const t=i.state.constraints.altitude;return!(!i.state.isGlobal||!t)&&(e.interactionType!==Si.TUMBLE||!hA(e.selection,qn.TILT))}function Gst(i,e,t){const n=e.interactionType;if(n===Si.NONE)return;const{min:r,max:s}=t,{interactionStartCamera:a,interactionFactor:o}=e,l=n===Si.TUMBLE||n===Si.ZOOM,c=jU(i,a),u=c===0?0:i.renderCoordsHelper.getAltitude(a.eye);t.min=r,t.max=s,V$(c,u,l,o,.05*u,t)}function Wst(i,e,t,n){return i.renderCoordsHelper.worldUpAtPosition(e.eye,n),Ye(n,n,t),n}function jst(i,e){return e.min=i.min,e.max=i.max,e}const qst={min:0,max:0},Kst=q(),Yst=q(),Xst=q(),TF=q();function qU(i,e,t=Py){if(!i.state.isLocal)return 0;const n=i.state.constraints.distance;if(!i.pointsOfInterest.surfaceOrigin.renderLocation||n===1/0)return 0;mP.min=0,mP.max=n,Qst(i,t,mP);const r=KU(i,e),s=mP.max-r;return s>=-1e-6?0:s}function Zst(i,e,t=Py){const n=qU(i,e,t);if(n===0)return!1;const r=i.pointsOfInterest.surfaceOrigin,s=KU(i,e)+n,a=Ge(eat,e.eye),o=Vhe(e,t.interactionDirection,Jst(i,e,nat),iat);if(!qL(T0e(r.renderLocation,s),Ah(e.eye,o),gP))return!1;e.eye=gP;const l=nt(tat,e.eye,a);e.center=rt(gP,e.center,l);const c=i.renderCoordsHelper.getAltitude(e.center),u=i.renderCoordsHelper.intersectInfiniteManifold(e.ray,c,gP);return T(u)&&(e.center=u),!0}function Qst(i,e,t){const n=e.interactionType;if(n===Si.NONE)return;const{min:r,max:s}=t,{interactionStartCamera:a,interactionFactor:o}=e,l=n===Si.ZOOM||n===Si.PAN,c=qU(i,a),u=c===0?0:KU(i,a);t.min=r,t.max=s,V$(c,u,l,o,.05*u,t)}function KU(i,e){const t=i.pointsOfInterest.surfaceOrigin;return Gn(e.eye,t.renderLocation)}function Jst(i,e,t){const n=i.pointsOfInterest.surfaceOrigin;return Hm(t,e.eye,n.renderLocation)}const mP={min:0,max:0},eat=q(),tat=q(),iat=q(),nat=q(),gP=q();var Sr,Fa;(function(i){i[i.OBJECT=0]="OBJECT",i[i.HUD=1]="HUD",i[i.TERRAIN=2]="TERRAIN",i[i.OVERLAY=3]="OVERLAY",i[i.I3S=4]="I3S",i[i.PCL=5]="PCL",i[i.LOD=6]="LOD",i[i.VOXEL=7]="VOXEL"})(Sr||(Sr={}));let rat=class{constructor(){this.verticalOffset=0,this.selectionMode=!1,this.hud=!0,this.selectOpaqueTerrainOnly=!0,this.invisibleTerrain=!1,this.backfacesTerrain=!0,this.isFiltered=!1,this.store=Fa.ALL}};(function(i){i[i.MIN=0]="MIN",i[i.MINMAX=1]="MINMAX",i[i.ALL=2]="ALL"})(Fa||(Fa={}));function bf(i){return T(i)&&T(i.dist)}function YX(i){return(e,t,n)=>(oo(XX,e,t,n),!$U(i,XX))}function rD(i){return bf(i)&&i.intersector===Sr.OBJECT&&!!i.target}function sD(i){return bf(i)&&i.intersector===Sr.HUD&&!!i.target&&T(i.target.center)}const XX=q(),gC=1e-5;let sat=class{constructor(e){this.options=new rat,this._results=new aat,this.transform=new Wbe,this.tolerance=gC,this.verticalOffset=null,this._ray=Oc(),this._rayEnd=q(),this._rayBeginTransformed=q(),this._rayEndTransformed=q(),this.viewingMode=e??Ot.Global}get results(){return this._results}get ray(){return this._ray}get rayBegin(){return this._ray.origin}get rayEnd(){return this._rayEnd}reset(e,t,n){this.resetWithRay(S0e(e,t,this._ray),n)}resetWithRay(e,t){this.camera=t,e!==this._ray&&jN(e,this._ray),this.options.verticalOffset!==0?this.viewingMode===Ot.Local?this._ray.origin[2]-=this.options.verticalOffset:this.verticalOffset=this.options.verticalOffset:this.verticalOffset=null,rt(this._rayEnd,this._ray.origin,this._ray.direction),this._results.init(this._ray)}intersect(e=null,t,n,r,s){this.point=t,this.filterPredicate=r,this.tolerance=n??gC;const a=rW(this.verticalOffset);if(T(e)&&e.length>0){const o=s?l=>{s(l)&&this.intersectObject(l)}:l=>{this.intersectObject(l)};for(const l of e){const c=l.getSpatialQueryAccelerator&&l.getSpatialQueryAccelerator();T(c)?(T(a)?c.forEachAlongRayWithVerticalOffset(this._ray.origin,this._ray.direction,o,a):c.forEachAlongRay(this._ray.origin,this._ray.direction,o),this.options.selectionMode&&this.options.hud&&c.forEachDegenerateObject(o)):l.objects.forAll(u=>o(u))}}this.sortResults()}intersectObject(e){const t=e.geometryRecords;if(!t)return;const n=e.transformation,r=rW(this.verticalOffset);for(const s of t){const{geometry:a,material:o,instanceParameters:l}=s;if(ZL(l))continue;const c=a.id;this.transform.setAndInvalidateLazyTransforms(n,s.getShaderTransformation()),$t(this._rayBeginTransformed,this.rayBegin,this.transform.inverse),$t(this._rayEndTransformed,this.rayEnd,this.transform.inverse);const u=this.transform.transform;T(r)&&(r.objectTransform=this.transform),o.intersect(a,l,this.transform.transform,this,this._rayBeginTransformed,this._rayEndTransformed,(d,h,p,m,g,_)=>{if(d>=0){if(T(this.filterPredicate)&&!this.filterPredicate(this._ray.origin,this._rayEnd,d))return;const b=m?this._results.hud:this._results,x=m?w=>{const C={object:e,geometryId:c,triangleNr:p,center:T(_)?[_[0],_[1],_[2]]:null};w.set(Sr.HUD,C,d,h,Ks,g)}:w=>w.set(Sr.OBJECT,{object:e,geometryId:c,triangleNr:p},d,h,u,g);if((b.min.drapedLayerOrder==null||g>=b.min.drapedLayerOrder)&&(b.min.dist==null||d<b.min.dist)&&x(b.min),this.options.store!==Fa.MIN&&(b.max.drapedLayerOrder==null||g<b.max.drapedLayerOrder)&&(b.max.dist==null||d>b.max.dist)&&x(b.max),this.options.store===Fa.ALL)if(m){const w=new P6(this._ray);x(w),this._results.hud.all.push(w)}else{const w=new Cx(this._ray);x(w),this._results.all.push(w)}}},s.shaderTransformation)}}sortResults(e=this._results.all){e.sort((t,n)=>t.dist!==n.dist?Jt(t.dist,0)-Jt(n.dist,0):t.drapedLayerOrder!==n.drapedLayerOrder?Jt(t.drapedLayerOrder,Number.MAX_VALUE)-Jt(n.drapedLayerOrder,Number.MAX_VALUE):Jt(n.drapedLayerGraphicOrder,Number.MIN_VALUE)-Jt(t.drapedLayerGraphicOrder,Number.MIN_VALUE))}};function Od(i){return new sat(i)}let aat=class{constructor(){this.min=new Cx(Oc()),this.max=new Cx(Oc()),this.hud={min:new P6(Oc()),max:new P6(Oc()),all:new Array},this.ground=new Cx(Oc()),this.all=[]}init(e){this.min.init(e),this.max.init(e),this.ground.init(e),this.all.length=0,this.hud.min.init(e),this.hud.max.init(e),this.hud.all.length=0}},Cx=class{constructor(e){this.intersector=Sr.OBJECT,this.normal=q(),this.transformation=St(),this._ray=Oc(),this.init(e)}get ray(){return this._ray}get distanceInRenderSpace(){return T(this.dist)?(Ye(vP,this.ray.direction,this.dist),Et(vP)):null}getIntersectionPoint(e){return!!bf(this)&&(Ye(vP,this.ray.direction,this.dist),rt(e,this.ray.origin,vP),!0)}getTransformedNormal(e){return Ge(OT,this.normal),OT[3]=0,Sm(OT,OT,this.transformation),Ge(e,OT),mt(e,e)}init(e){this.dist=null,this.target=null,this.drapedLayerOrder=null,this.drapedLayerGraphicOrder=null,this.intersector=Sr.OBJECT,jN(e,this._ray)}set(e,t,n,r,s,a,o){this.intersector=e,this.dist=n,Ge(this.normal,Jt(r,f0e)),da(this.transformation,Jt(s,Ks)),this.target=t,this.drapedLayerOrder=a,this.drapedLayerGraphicOrder=o}copy(e){jN(e.ray,this._ray),this.intersector=e.intersector,this.dist=e.dist,this.target=e.target,this.drapedLayerOrder=e.drapedLayerOrder,this.drapedLayerGraphicOrder=e.drapedLayerGraphicOrder,Ge(this.normal,e.normal),da(this.transformation,e.transformation)}},P6=class extends Cx{constructor(){super(...arguments),this.intersector=Sr.HUD}};function YU(i){return new Cx(i)}const vP=q(),OT=Dn();function Bhe(i,e,t,n){return T(i.renderCoordsHelper.fromRenderCoords(e.eye,B$,n))&&rne(t,B$)}function aD(i,e){return i.elevationProvider?Jt(i.elevationProvider.getElevation(e[0],e[1],e[2],i.renderCoordsHelper.spatialReference,"ground"),0):0}function Lb(i,e,t,n){const r=i.state.camera.clone();e&&(r.eye=e,r.center=t,r.up=n),oat(i,r.ray,Dg)||Ge(Dg,r.center);const s=i.state.constraints,a=s.minimumPoiDistance;if(Fo(r.eye,Dg)<a){const o=s.collision.enabled;Ge(Qy,r.viewForward),Ye(Qy,Qy,a),o?r.eye=nt(B$,Dg,Qy):rt(Dg,r.eye,Qy);const l=i.renderCoordsHelper,c=l.getAltitude(r.eye),u=s.collision.elevationMargin;o&&c<u&&(nt(Qy,Dg,r.eye),r.eye=l.setAltitude(B$,u,r.eye),rt(Dg,r.eye,Qy))}return r.center=Dg,r}function ZX(i,e,t){if(!i.state.isGlobal)return!1;const n=aD(i,e),r=i.stateManager.constraintsManager.nearFarHeuristic,{far:s}=r.compute(e,t,i.renderDataExtent,n,cat),a=s*s;return Fo(e,t)>a}function oat(i,e,t){let n=QX[i.viewingMode];n||(n=Od(i.state.viewingMode),n.options.backfacesTerrain=!i.state.isGlobal,n.options.invisibleTerrain=!0,QX[i.viewingMode]=n);const{isGlobal:r}=i.state;return!(!i.sceneIntersectionHelper.intersectRay(e,n,t)||ZX(i,e.origin,t))||!(!i.renderCoordsHelper.intersectManifold(e,0,t)||ZX(i,e.origin,t))||!!r&&lat(e,t,rn(i.spatialReference).radius)}function lat(i,e,t){const n=dt(i.origin,i.origin)-t*t,r=n>0?Math.sqrt(n)/3:1;return Ye(e,i.direction,r/Et(i.direction)),rt(e,e,i.origin),!0}const QX={},B$=q(),Dg=q(),Qy=q(),cat={near:0,far:0};function qC(i,e,t=bd.EYE){const n=i.state.constraints;if(!n.collision.enabled)return!1;const r=aD(i,e.eye),s=i.renderCoordsHelper.getAltitude(e.eye),a=r+n.collision.elevationMargin;if(s>=a)return!1;const o=Et(e.eye);if(nt(yP,e.center,e.eye),e.eye=i.renderCoordsHelper.setAltitude(uat,a,e.eye),t===bd.EYE_AND_CENTER)e.center=rt(yP,e.eye,yP);else if(t===bd.EYE_AND_CENTER_SCALE){const l=(o-s+a)/o;e.center=Ye(yP,e.center,l)}return!0}var bd;(function(i){i[i.EYE=0]="EYE",i[i.EYE_AND_CENTER=1]="EYE_AND_CENTER",i[i.EYE_AND_CENTER_SCALE=2]="EYE_AND_CENTER_SCALE"})(bd||(bd={}));const yP=q(),uat=q();function Oy(i,e,t){i.worldUpAtPosition(e,JX),nt(SF,t,e);const n=Et(SF);return n===0?0:Uo(dt(SF,JX)/n)}const JX=q(),SF=q();function zhe(i,e,t=Py,n=!0){RT.eyeCenterDistance=0,RT.requiresTwoSteps=!1;const r=XU(i,e,t,void 0,RT);if(r===0)return!1;switch(Mh(_P,-r,e.viewRight),t.tiltMode){case va.LOOK_AROUND:$t(kg,e.viewForward,_P),Ye(kg,kg,RT.eyeCenterDistance),e.center=rt(Wv,e.eye,kg);break;case va.TUMBLE:nt(kg,e.center,e.eye),$t(kg,kg,_P),e.eye=nt(Wv,e.center,kg);break;default:Do(t.tiltMode)}return e.up=$t(Wv,e.up,_P),!RT.requiresTwoSteps||!n||zhe(i,e,t,!1)}function XU(i,e,t=Py,n=Py,r){if(!i.state.constraints.tilt)return 0;const s=e.distance,a=i.state.constraints.tilt(s,bat);return _at(i,t,a),n.interactionType===Si.TUMBLE&&hA(n.selection,qn.ALTITUDE)&&Uhe(i,n.interactionStartCamera,a),t.tiltMode===va.LOOK_AROUND||n.tiltMode===va.LOOK_AROUND?hat(i,e,a,r):dat(i,e,a)}function dat(i,e,t){const n=Oy(i.renderCoordsHelper,e.center,e.eye),r=n-lt(n,t.min,t.max);return pA(r)?r:0}function hat(i,e,t,n){switch(n&&(n.requiresTwoSteps=!1),i.viewingMode){case"global":return fat(i,e,t,n);case"local":return pat(i,e,t,n);default:return void Do(i.viewingMode)}}function pat(i,e,t,n){const r=Oy(i.renderCoordsHelper,e.center,e.eye),s=lt(r,t.min,t.max),a=r-s;if(!pA(a))return 0;if(n){const o=i.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,l=i.renderCoordsHelper.getAltitude(e.eye)-o,c=Math.cos(s);Math.abs(c)>1e-4?n.eyeCenterDistance=l/c:n.eyeCenterDistance=e.distance}return a}function fat(i,e,t,n){const r=mat(i,e,wat),s=lt(r.tiltAtCenter,t.min,t.max);if(!pA(r.tiltAtCenter-s))return 0;let a,o;return r.centerIsOnSurface?(a=gat(r),o=vat(r,a)):(a=r.constraints.clampTilt(r.eyeCenterDistance,r.tiltAtCenter),n&&a<Math.PI/2&&(n.requiresTwoSteps=!0,a=Math.PI/2-1e-5),o=yat(r,a)),n&&(n.eyeCenterDistance=O6(r,a)),o}function mat(i,e,t){const n=i.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,r=n+rn(i.spatialReference).radius,s=i.renderCoordsHelper.intersectManifold(e.ray,n,Wv);return t.eyeCenterDistance=e.distance,t.centerIsOnSurface=!1,T(s)?(t.eyeCenterDistance=Gn(e.eye,s),t.tiltAtCenter=Oy(i.renderCoordsHelper,s,e.eye),t.centerIsOnSurface=!0):i.state.isLocal?t.tiltAtCenter=Oy(i.renderCoordsHelper,e.center,e.eye):(KL(PB(OB,r),e.ray,Wv),t.eyeCenterDistance=Gn(e.eye,Wv),t.tiltAtCenter=Uo(-dt(e.viewForward,mt(Wv,Wv)))),t.radius=r,t.eyeRadius=Et(e.eye),t.constraints=i.state.constraints,t}function pA(i){return Math.abs(i)>1e-9}function gat(i){const{constraints:e,eyeCenterDistance:t,tiltAtCenter:n}=i;let r=n,s=e.clampTilt(t,n);const a=O6(i,s);if(e.clampTilt(a,n)===s)return s;let o=0;for(;o<10&&pA(s-r);){const l=(r+s)/2,c=O6(i,l);pA(e.clampTilt(c,l)-l)?r=l:s=l,o++}return s}function O6(i,e){if(!i.centerIsOnSurface)return i.eyeCenterDistance;const t=Math.PI-lt(e,0,Math.PI),n=nf(i.radius/i.eyeRadius*Math.sin(t)),r=Math.PI-t-n,s=Math.sin(r)/Math.sin(t);if(i.eyeRadius<i.radius&&s>1){const a=Math.PI-n,o=Math.PI-t-a;return Math.sin(o)/Math.sin(t)*i.eyeRadius}return s*i.eyeRadius}function vat(i,e){const t=nf(i.radius/i.eyeRadius*Math.sin(i.tiltAtCenter)),n=nf(i.radius/i.eyeRadius*Math.sin(e));return i.eyeRadius>i.radius?t-n:n-t}function yat(i,e){return i.tiltAtCenter-Math.PI/2-(e-Math.PI/2)}function _at(i,e,t){if(e.interactionType===Si.NONE)return;const{interactionStartCamera:n,interactionFactor:r}=e,{min:s,max:a}=t,o=XU(i,n,Py,e),l=o===0?0:Oy(i.renderCoordsHelper,n.center,n.eye);t.min=s,t.max=a,e.interactionType===Si.TUMBLE?(hA(e.selection,qn.ALTITUDE)&&Uhe(i,n,t),V$(o,l,!0,r,eZ,t)):V$(o,l,!1,r,eZ,t)}function Uhe(i,e,t){if(i.state.isLocal)return;const n=i.state.constraints;if(!n.altitude)return;const r=dd(e.center),s=Math.sqrt(r),a=e.distance,o=rn(i.spatialReference).radius,l=n.altitude.min+o,c=n.altitude.max+o,u=(l*l-a*a-r)/(-2*s*a),d=(c*c-a*a-r)/(-2*s*a);t.min=Math.max(t.min,Math.min(Math.PI-Uo(d),t.max)),t.max=Math.min(t.max,Math.PI-Uo(u))}const kg=q(),_P=St(),Wv=q(),eZ=zi(5),bat={min:0,max:0},wat={constraints:null,radius:0,eyeRadius:0,centerIsOnSurface:!0,eyeCenterDistance:0,tiltAtCenter:0},RT={eyeCenterDistance:0,requiresTwoSteps:!1};function xat(i){return i}const oD=i=>i*i,ZU=i=>1-oD(1-i),Cat=i=>i<.5?oD(2*i)/2:(ZU(2*(i-.5))+1)/2,QU=i=>i*i*i,Hhe=i=>1-QU(1-i),Ghe=i=>i<.5?QU(2*i)/2:(Hhe(2*(i-.5))+1)/2,JU=i=>i*i*i*i,Whe=i=>1-JU(1-i),Tat=i=>i<.5?JU(2*i)/2:(Whe(2*(i-.5))+1)/2,e7=i=>i*i*i*i*i,jhe=i=>1-e7(1-i),Sat=i=>i<.5?e7(2*i)/2:(jhe(2*(i-.5))+1)/2,t7=i=>1-Math.cos(i*Math.PI/2),qhe=i=>1-t7(1-i),Eat=i=>i<.5?t7(2*i)/2:(qhe(2*(i-.5))+1)/2,i7=i=>2**(10*(i-1)),gM=i=>1-i7(1-i),Aat=i=>i<.5?i7(2*i)/2:(gM(2*(i-.5))+1)/2,n7=i=>-(Math.sqrt(1-i*i)-1),Khe=i=>1-n7(1-i),Mat=i=>i<.5?n7(2*i)/2:(Khe(2*(i-.5))+1)/2;function $d(i){const e=2*(i-Math.sqrt((i-1)*i)),t=e/2/i;return n=>n<t?i*n*n:e*n-e+1}function Ld(i,e){return(t,n)=>t<e?e*i(t/e,n):1-i((1-t)/(1-e),n)*(1-e)}const Pat=Ld($d(1),1),Oat=Ld($d(1),0),Yhe=Ld($d(1),.5),Rat=Ld($d(2),1),Iat=Ld($d(2),0),$at=Ld($d(2),.5),Lat=Ld($d(3),1),Dat=Ld($d(3),0),kat=Ld($d(3),.5),Fat=Ld($d(4),1),Nat=Ld($d(4),0),Vat=Ld($d(4),.5),Bat={linear:xat,"in-quad":oD,"out-quad":ZU,"in-out-quad":Cat,"in-coast-quad":Pat,"out-coast-quad":Oat,"in-out-coast-quad":Yhe,"in-cubic":QU,"out-cubic":Hhe,"in-out-cubic":Ghe,"in-coast-cubic":Rat,"out-coast-cubic":Iat,"in-out-coast-cubic":$at,"in-quart":JU,"out-quart":Whe,"in-out-quart":Tat,"in-coast-quart":Lat,"out-coast-quart":Dat,"in-out-coast-quart":kat,"in-quint":e7,"out-quint":jhe,"in-out-quint":Sat,"in-coast-quint":Fat,"out-coast-quint":Nat,"in-out-coast-quint":Vat,"in-sine":t7,"out-sine":qhe,"in-out-sine":Eat,"in-expo":i7,"out-expo":gM,"in-out-expo":Aat,"in-circ":n7,"out-circ":Khe,"in-out-circ":Mat};function is(i,e,t=Gat,n=e){n!==e&&n.copyFrom(e),n.computeUp(i.state.viewingMode);let r=!1;for(let o=0;o<Wat;o++){let l=0;for(const c of Hat)if(hA(t.selection,c.type)){const u=Math.abs(c.error(i,n,t));c.apply(i,n,t)&&(r=!0,l+=u)}if(l===0)break}const s=hA(t.selection,qn.COLLISION),a=zat(t.interactionType,i);return s&&qC(i,n,a)&&(r=!0),r&&n.computeUp(i.state.viewingMode),r}function zat(i,e){switch(i){case Si.PAN:return bd.EYE_AND_CENTER;case Si.ASCEND:return e.state.isGlobal?bd.EYE_AND_CENTER_SCALE:bd.EYE_AND_CENTER;default:return bd.EYE}}function sh(i){const e=Math.min(1,i/150);return Ghe(e)}function Uat(i,e,t){return XU(i,e,t)*e.distance}const Hat=[{type:qn.TILT,error:Uat,apply:zhe},{type:qn.ALTITUDE,error:jU,apply:Ust},{type:qn.DISTANCE,error:qU,apply:Zst}],Gat={selection:qn.ALL,interactionType:Si.NONE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:va.TUMBLE},Wat=5,Wc=q(),sc=q(),Fg=q(),po=q(),Jy=q(),jat=q(),jc={upward:Gt(0,0,1),forward:Gt(0,1,0),sideway:Gt(1,0,0)},tZ=Ho();let iZ=class{constructor(e=Ot.Global){this.viewingMode=e,this.center=q(),this.pitch=0,this.yaw=0,this.distance=0,this.lookAtDirection=Ts(jc.forward)}pixelsPerPanAtZoom(e){return this.size/2/(this._zoomToPanScale*e)}zoomAtPixelsPerPan(e){return this.size/2/(this._zoomToPanScale*e)}pixelsPerRotateAtZoom(){const e=Math.max(Math.cos(Math.abs(this.pitch)),.5);return this.size/2/e}compareTo(e,t){if(t||(t={pan:0,rotate:0,sourceZoom:0,targetZoom:0}),this.viewingMode===Ot.Global){const s=(Et(this.center)+Et(e.center))/2;t.pan=rR(this.center,e.center)*s}else t.pan=Gn(this.center,e.center);let n=Math.abs(e.yaw-this.yaw);n>=Math.PI&&(n=2*Math.PI-n);const r=Math.abs(e.pitch-this.pitch);return t.rotate=Math.max(n,r),t.sourceZoom=this.distance,t.targetZoom=e.distance,t}interpolate(e,t,n){this.viewingMode===Ot.Global?U0e(e.center,t.center,n.pan,this.center):oo(this.center,e.center,t.center,n.pan),this.distance=isFinite(t.distance)?ki(e.distance,t.distance,n.zoom):e.distance,this.pitch=ki(e.pitch,t.pitch,n.rotate);let r=e.yaw;const s=t.yaw;Math.abs(s-r)>=Math.PI&&(r+=2*(r<s?1:-1)*Math.PI),this.yaw=ki(r,s,n.rotate)}copyFrom(e){Ge(this.center,e.center),this.pitch=e.pitch,this.yaw=e.yaw,this.distance=e.distance,Ge(this.lookAtDirection,e.lookAtDirection),this.size=e.size,this.copyFromCommon(e),this.viewingMode=e.viewingMode}copyFromRenderCamera(e){const t=this._lookAtOrientation(e.center,tZ);Ge(this.center,e.center),nt(po,e.center,e.eye),Lp(po,po,t),Lp(Jy,e.up,t),this.distance=Et(po),this.distance!==0&&(po[0]/=this.distance,po[1]/=this.distance,po[2]/=this.distance),this.pitch=this._eyeUpToPitch(po),this.yaw=this._eyeUpToYaw(po,Jy),this.size=Math.sqrt(e.width*e.width+e.height*e.height),this.copyFromCommon(e)}copyFromCommon(e){this.fov=e.fov,this._zoomToPanScale=Math.atan(.5*this.fov)}copyToRenderCamera(e){const t=this._lookAtOrientation(this.center,tZ);cg(t,t),this._axisAngleVec3(jc.sideway,this.pitch-Math.PI/2,jc.forward,po),this._axisAngleVec3(jc.upward,this.yaw,po),this._axisAngleVec3(jc.sideway,this.pitch-Math.PI/2,jc.upward,Jy),this._axisAngleVec3(jc.upward,this.yaw,Jy),Ye(po,po,this.distance),Lp(po,po,t),Lp(Jy,Jy,t),e.center=this.center,e.eye=nt(po,this.center,po),e.up=Jy}_axisAngleVec3(e,t,n,r=n){const s=Math.cos(t),a=Math.sin(t);return Ye(Wc,n,s),vi(sc,e,n),Ye(sc,sc,a),Ye(Fg,e,(1-s)*dt(e,n)),rt(r,rt(r,Wc,sc),Fg)}_lookAtOrientation(e,t=Ho()){return this._upAtLookAt(e,Fg),vi(Wc,this.lookAtDirection,Fg),mt(Wc,Wc),Wc[0]===0&&Wc[1]===0&&Wc[2]===0&&Ge(Wc,jc.sideway),vi(sc,Fg,Wc),mt(sc,sc),t[0]=Wc[0],t[1]=sc[0],t[2]=Fg[0],t[3]=Wc[1],t[4]=sc[1],t[5]=Fg[1],t[6]=Wc[2],t[7]=sc[2],t[8]=Fg[2],t}_upAtLookAt(e,t){return this.viewingMode===Ot.Local?Ge(t,jc.upward):mt(t,e)}_eyeUpToPitch(e){return Math.PI-rR(jc.upward,e)}_eyeUpToYaw(e,t){const n=jat;return Math.abs(t[2])<.5?(Ge(n,t),e[2]>0&&Ye(n,n,-1)):Ge(n,e),vi(sc,n,jc.upward),mt(sc,sc),rR(jc.sideway,sc,jc.upward)}},Nn=class{constructor(e=null,t=null,n=null){this._viewUp=q(),this._viewForward=q(),this._viewRight=q(),this._ray=Oc(),this._viewport=Xn(0,0,1,1),this._padding=Xn(0,0,0,0),this._fov=55/180*Math.PI,this._nearFar=dn(1,1e3),this._viewDirty=!0,this._viewMatrix=St(),this._projectionDirty=!0,this._projectionMatrix=St(),this._viewProjectionDirty=!0,this._viewProjectionMatrix=St(),this._viewInverseTransposeMatrixDirty=!0,this._viewInverseTransposeMatrix=St(),this._inverseProjectionDirty=!0,this._inverseProjectionMatrix=null,this._frustumDirty=!0,this._frustum=_2(),this._fullViewport=Dn(),this._pixelRatio=1,this.relativeElevation=0,T(e)&&Ge(this._ray.origin,e),this._center=T(t)?Ts(t):q(),this._up=T(n)?Ts(n):Gt(0,0,1)}get pixelRatio(){return this._pixelRatio}set pixelRatio(e){this._pixelRatio=e>0?e:1}get eye(){return this._ray.origin}set eye(e){this._compareAndSetView(e,this._ray.origin)}get center(){return this._center}set center(e){this._compareAndSetView(e,this._center)}get ray(){return nt(this._ray.direction,this.center,this.eye),this._ray}get up(){return this._up}set up(e){this._compareAndSetView(e,this._up)}get viewMatrix(){return this._ensureViewClean(),this._viewMatrix}set viewMatrix(e){da(this._viewMatrix,e),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get viewForward(){return this._ensureViewClean(),this._viewForward}get viewUp(){return this._ensureViewClean(),this._viewUp}get viewRight(){return this._ensureViewClean(),this._viewRight}get nearFar(){return this._nearFar}get near(){return this._nearFar[0]}set near(e){this._nearFar[0]!==e&&(this._nearFar[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get far(){return this._nearFar[1]}set far(e){this._nearFar[1]!==e&&(this._nearFar[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewport(){return this._viewport}set viewport(e){this.x=e[0],this.y=e[1],this.width=e[2],this.height=e[3]}get x(){return this._viewport[0]}set x(e){e+=this._padding[li.LEFT],this._viewport[0]!==e&&(this._viewport[0]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get y(){return this._viewport[1]}set y(e){e+=this._padding[li.BOTTOM],this._viewport[1]!==e&&(this._viewport[1]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get width(){return this._viewport[2]}set width(e){this._viewport[2]!==e&&(this._viewport[2]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get height(){return this._viewport[3]}set height(e){this._viewport[3]!==e&&(this._viewport[3]=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get fullWidth(){return this._viewport[2]+this._padding[li.RIGHT]+this._padding[li.LEFT]}set fullWidth(e){this.width=e-(this._padding[li.RIGHT]+this._padding[li.LEFT])}get fullHeight(){return this._viewport[3]+this._padding[li.TOP]+this._padding[li.BOTTOM]}set fullHeight(e){this.height=e-(this._padding[li.TOP]+this._padding[li.BOTTOM])}get fullViewport(){return this._fullViewport[0]=this._viewport[0]-this._padding[li.LEFT],this._fullViewport[1]=this._viewport[1]-this._padding[li.BOTTOM],this._fullViewport[2]=this.fullWidth,this._fullViewport[3]=this.fullHeight,this._fullViewport}get aspect(){return this.width/this.height}get padding(){return this._padding}set padding(e){this._padding[li.TOP]===e[li.TOP]&&this._padding[li.RIGHT]===e[li.RIGHT]&&this._padding[li.BOTTOM]===e[li.BOTTOM]&&this._padding[li.LEFT]===e[li.LEFT]||(this._viewport[0]+=e[li.LEFT]-this._padding[li.LEFT],this._viewport[1]+=e[li.BOTTOM]-this._padding[li.BOTTOM],this._viewport[2]-=e[li.RIGHT]+e[li.LEFT]-(this._padding[li.RIGHT]+this._padding[li.LEFT]),this._viewport[3]-=e[li.TOP]+e[li.BOTTOM]-(this._padding[li.TOP]+this._padding[li.BOTTOM]),Em(this._padding,e),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0)}get viewProjectionMatrix(){return this._viewProjectionDirty&&(Vs(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionDirty=!1),this._viewProjectionMatrix}get projectionMatrix(){if(this._projectionDirty){const e=this.width,t=this.height,n=this.near*Math.tan(this.fovY/2),r=n*this.aspect;I0e(this._projectionMatrix,-r*(1+2*this._padding[li.LEFT]/e),r*(1+2*this._padding[li.RIGHT]/e),-n*(1+2*this._padding[li.BOTTOM]/t),n*(1+2*this._padding[li.TOP]/t),this.near,this.far),this._projectionDirty=!1}return this._projectionMatrix}get inverseProjectionMatrix(){return B(this._inverseProjectionMatrix)&&(this._inverseProjectionMatrix=St()),this._inverseProjectionDirty&&Da(this._inverseProjectionMatrix,this.projectionMatrix),this._inverseProjectionMatrix}set projectionMatrix(e){da(this._projectionMatrix,e),this._projectionDirty=!1,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fov(){return this._fov}set fov(e){this._fov=e,this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovX(){return p1e(this._fov,this.width,this.height)}set fovX(e){this._fov=f1e(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get fovY(){return m1e(this._fov,this.width,this.height)}set fovY(e){this._fov=g1e(e,this.width,this.height),this._projectionDirty=!0,this._inverseProjectionDirty=!0,this._viewProjectionDirty=!0,this._frustumDirty=!0}get distance(){return Gn(this._center,this.eye)}get frustum(){return this._recomputeFrustum(),this._frustum}get viewInverseTransposeMatrix(){return(this._viewInverseTransposeMatrixDirty||this._viewDirty)&&(Da(this._viewInverseTransposeMatrix,this.viewMatrix),$B(this._viewInverseTransposeMatrix,this._viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),this._viewInverseTransposeMatrix}depthNDCToWorld(e){const t=2*e-1;return 2*this.near*this.far/(this.far+this.near-t*(this.far-this.near))}get perRenderPixelRatio(){return Math.tan(this.fovX/2)/(this.width/2)}get perScreenPixelRatio(){return this.perRenderPixelRatio*this._pixelRatio}get aboveGround(){return this.relativeElevation!=null&&this.relativeElevation>=0}copyFrom(e){Ge(this._ray.origin,e.eye),Ge(this._center,e.center),Ge(this._up,e.up),Em(this._viewport,e.viewport),Em(this._padding,e.padding),Zs(this._nearFar,e.nearFar),this._fov=e.fov,this.relativeElevation=e.relativeElevation;const t=e;return this._viewDirty=t._viewDirty,this._viewDirty||(da(this._viewMatrix,e.viewMatrix),Ge(this._viewRight,e.viewRight),Ge(this._viewUp,e.viewUp),Ge(this._viewForward,e.viewForward)),t._projectionDirty?this._projectionDirty=!0:(da(this._projectionMatrix,e.projectionMatrix),this._projectionDirty=!1),this._viewProjectionDirty=!0,this._inverseProjectionDirty=!0,this._frustumDirty=t._frustumDirty,this._frustumDirty||(JI(this._frustum,e.frustum),this._frustumDirty=!1),t._viewInverseTransposeMatrixDirty?this._viewInverseTransposeMatrixDirty=!0:(da(this._viewInverseTransposeMatrix,e.viewInverseTransposeMatrix),this._viewInverseTransposeMatrixDirty=!1),Em(this._fullViewport,e.fullViewport),this._pixelRatio=e.pixelRatio,this}copyViewFrom(e){this.eye=e.eye,this.center=e.center,this.up=e.up}clone(){return new Nn().copyFrom(this)}equals(e){return uh(this.eye,e.eye)&&uh(this._center,e.center)&&uh(this._up,e.up)&&XN(this._viewport,e.viewport)&&XN(this._padding,e.padding)&&J_e(this._nearFar,e.nearFar)&&this._fov===e.fov&&this._pixelRatio===e.pixelRatio&&this.relativeElevation===e.relativeElevation}almostEquals(e){if(this._pixelRatio!==e.pixelRatio||Math.abs(e.fov-this._fov)>=.001)return!1;const t=5e-4,n=1-1e-10;pr(fo,e.eye,e.center),pr(EF,this.eye,this._center);const r=dt(fo,EF),s=c2(fo),a=c2(EF);return r*r>=n*s*a&&tne(e.eye,this.eye)<Math.max(s,a)*t*t&&qG(e.padding,this._padding)<.5&&qG(e.viewport,this._viewport)<.5}computeRenderPixelSizeAt(e){return this.computeRenderPixelSizeAtDist(this._viewDirectionDistance(e))}computeRenderPixelSizeAtDist(e){return e*this.perRenderPixelRatio}computeScreenPixelSizeAt(e){return this.computeScreenPixelSizeAtDist(this._viewDirectionDistance(e))}_viewDirectionDistance(e){return Math.abs(L0(this.viewForward,nt(fo,e,this.eye)))}computeScreenPixelSizeAtDist(e){return e*this.perScreenPixelRatio}computeDistanceFromRadius(e,t){return e/Math.tan(Math.min(this.fovX,this.fovY)/(2*(t||1)))}getScreenCenter(e=Fn()){return e[0]=(this.padding[li.LEFT]+this.width/2)/this._pixelRatio,e[1]=(this.padding[li.TOP]+this.height/2)/this._pixelRatio,e}getRenderCenter(e,t=.5,n=.5){return e[0]=this.padding[li.LEFT]+this.width*t,e[1]=this.padding[li.BOTTOM]+this.height*n,e[2]=.5,e}setGLViewport(e){const t=this.viewport,n=this.padding;e.setViewport(t[0]-n[3],t[1]-n[2],t[2]+n[1]+n[3],t[3]+n[0]+n[2])}applyProjection(e,t){e!==Mi&&Ge(Mi,e),Mi[3]=1,Sm(Mi,Mi,this.projectionMatrix);const n=Math.abs(Mi[3]);Ye(Mi,Mi,1/n);const r=this.fullViewport;t[0]=ki(0,r[0]+r[2],.5+.5*Mi[0]),t[1]=ki(0,r[1]+r[3],.5+.5*Mi[1]),t[2]=.5*(Mi[2]+1),t[3]=n}unapplyProjection(e,t){const n=this.fullViewport;Mi[0]=(e[0]/(n[0]+n[2])*2-1)*e[3],Mi[1]=(e[1]/(n[1]+n[3])*2-1)*e[3],Mi[2]=(2*e[2]-1)*e[3],Mi[3]=e[3],Sm(Mi,Mi,this.inverseProjectionMatrix),t[0]=Mi[0],t[1]=Mi[1],t[2]=Mi[2]}projectToScreen(e,t){return this.projectToRenderScreen(e,AF),this.renderToScreen(AF,t),t}projectToRenderScreen(e,t){if(Mi[0]=e[0],Mi[1]=e[1],Mi[2]=e[2],Mi[3]=1,Sm(Mi,Mi,this.viewProjectionMatrix),Mi[3]===0)return null;Ye(Mi,Mi,1/Math.abs(Mi[3]));const n=this.fullViewport;return"x"in t?(t.x=ki(0,n[0]+n[2],.5+.5*Mi[0]),t.y=ki(0,n[1]+n[3],.5+.5*Mi[1])):(t[0]=ki(0,n[0]+n[2],.5+.5*Mi[0]),t[1]=ki(0,n[1]+n[3],.5+.5*Mi[1]),t.length>2&&(t[2]=.5*(Mi[2]+1))),t}unprojectFromScreen(e,t){return this.unprojectFromRenderScreen(this.screenToRender(e,AF),t)}unprojectFromRenderScreen(e,t){if(Vs(bP,this.projectionMatrix,this.viewMatrix),!Da(bP,bP))return null;const n=this.fullViewport;return Mi[0]=2*(e[0]-n[0])/n[2]-1,Mi[1]=2*(e[1]-n[1])/n[3]-1,Mi[2]=2*e[2]-1,Mi[3]=1,Sm(Mi,Mi,bP),Mi[3]===0?null:(t[0]=Mi[0]/Mi[3],t[1]=Mi[1]/Mi[3],t[2]=Mi[2]/Mi[3],t)}constrainWindowSize(e,t,n,r=n){const s=e*this._pixelRatio,a=t*this._pixelRatio,o=Math.max(s-n/2,0),l=Math.max(this.fullHeight-a-r/2,0),c=-Math.min(s-n/2,0),u=-Math.min(this.fullHeight-a-r/2,0);return[o,l,n-c- -Math.min(this.fullWidth-s-n/2,0),r-u- -Math.min(a-r/2,0)]}computeUp(e){e===Ot.Global?this._computeUpGlobal():this._computeUpLocal()}screenToRender(e,t){const n=e[0]*this._pixelRatio,r=this.fullHeight-e[1]*this._pixelRatio;return t[0]=n,t[1]=r,t}renderToScreen(e,t){const n=e[0]/this._pixelRatio,r=(this.fullHeight-e[1])/this._pixelRatio;t[0]=n,t[1]=r}_computeUpGlobal(){nt(fo,this.center,this.eye);const e=Et(this.center);e<1?(je(this._up,0,0,1),this._markViewDirty()):Math.abs(dt(fo,this.center))>.9999*Et(fo)*e||(vi(this._up,fo,this.center),vi(this._up,this._up,fo),mt(this._up,this._up),this._markViewDirty())}_computeUpLocal(){Hm(fo,this.eye,this.center),Math.abs(fo[2])<=.9999&&(Ye(fo,fo,fo[2]),je(this._up,-fo[0],-fo[1],1-fo[2]),mt(this._up,this._up),this._markViewDirty())}_compareAndSetView(e,t){typeof e[0]=="number"&&isFinite(e[0])&&typeof e[1]=="number"&&isFinite(e[1])&&typeof e[2]=="number"&&isFinite(e[2])?uh(e,t)||(Ge(t,e),this._markViewDirty()):tt.getLogger("esri.views.3d.webgl-engine.lib.Camera").warn("Camera vector contains invalid number, ignoring value")}_markViewDirty(){this._viewDirty=!0,this._frustumDirty=!0,this._viewProjectionDirty=!0}_recomputeFrustum(){this._frustumDirty&&(Zne(this.viewMatrix,this.projectionMatrix,this._frustum),this._frustumDirty=!1)}_ensureViewClean(){this._viewDirty&&(LB(this._viewMatrix,this.eye,this._center,this._up),je(this._viewForward,-this._viewMatrix[2],-this._viewMatrix[6],-this._viewMatrix[10]),je(this._viewUp,this._viewMatrix[1],this._viewMatrix[5],this._viewMatrix[9]),je(this._viewRight,this._viewMatrix[0],this._viewMatrix[4],this._viewMatrix[8]),this._viewDirty=!1,this._viewInverseTransposeMatrixDirty=!0)}};const Mi=Dn(),bP=St(),fo=q(),EF=q(),AF=pa();var li;(function(i){i[i.TOP=0]="TOP",i[i.RIGHT=1]="RIGHT",i[i.BOTTOM=2]="BOTTOM",i[i.LEFT=3]="LEFT"})(li||(li={}));const z$={desiredScreenFlow:2,minDuration:Wi(500),maxDuration:Wi(8e3)};let Xhe=class{constructor(e){this._createCamera=e,this.compared={sourceZoom:0,targetZoom:0,pan:0,rotate:0},this.settings={desiredScreenFlow:z$.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new Xhe(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,t,n){this.source!==e&&this.source.copyFrom(e),this.target!==t&&this.target.copyFrom(t),this.compared=this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=n.desiredScreenFlow!=null?n.desiredScreenFlow:z$.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const t=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/t}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>1e-9}get hasRotate(){return this.compared.rotate>1e-9}},qat=class{constructor(){this.segments=[]}get time(){return this.segments.reduce((e,t)=>th(e+t.time),th(0))}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1),e*=this.time;let n=0,r=0;const s=this.definition;for(let a=0;a<this.segments.length;a++){const o=this.segments[a],l=o.definition;if(e<=o.time||a===this.segments.length-1){if(t=this.segmentInterpolateComponentsAt(o,o.time===0?0:e/o.time,t),s.hasPan&&!isNaN(t.pan)&&isFinite(s.compared.pan)?t.pan=(n+l.compared.pan*t.pan)/s.compared.pan:t.pan=1,s.hasRotate&&!isNaN(t.rotate)&&isFinite(s.compared.rotate)?t.rotate=(r+l.compared.rotate*t.rotate)/s.compared.rotate:t.rotate=1,s.hasZoom&&!isNaN(t.zoom)&&isFinite(l.compared.targetZoom)){const c=t.zoom*(l.compared.targetZoom-l.compared.sourceZoom)+l.compared.sourceZoom,u=this.segments[0].definition.compared.sourceZoom,d=this.segments[this.segments.length-1].definition.compared.targetZoom;t.zoom=(c-u)/(d-u)}else t.zoom=1;return t}e-=o.time,n+=l.compared.pan,r+=l.compared.rotate}}segmentInterpolateComponentsAt(e,t,n){return e.interpolateComponentsAt(t,n)}},MF=class{constructor(e){e&&this.update(e)}get time(){return this._time}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,t=e.compared,n=t.sourceZoom,r=t.targetZoom;this._zoomSign=n>r?1:-1,this._panPixelsAtSource=t.pan*e.source.pixelsPerPanAtZoom(n);const s=(e.source.pixelsPerRotateAtZoom(n)+e.target.pixelsPerRotateAtZoom(r))/2;this._rotatePixels=t.rotate*s}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,t=this.definition.compared.targetZoom,{hasZoom:n,hasPan:r,hasRotate:s}=this.definition;let a=0,o=0;n&&(r&&(a=(t/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),s&&(o=this._zoomSign*(Math.log(e/t)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(n&&r&&s){const c=a+o+a*o;this._zoomPixelFlow=a*o/c*l,this._panPixelFlow=o/c*l,this._rotatePixelFlow=a/c*l}else if(n&&r){const c=1+a;this._zoomPixelFlow=a/c*l,this._panPixelFlow=1/c*l}else if(n&&s){const c=1+o;this._zoomPixelFlow=o/c*l,this._rotatePixelFlow=1/c*l}else if(r&&s){const c=this._panPixelsAtSource/this._rotatePixels,u=1+c;this._panPixelFlow=c/u*l,this._rotatePixelFlow=1/u*l}else r?this._panPixelFlow=l:n?this._zoomPixelFlow=l:s&&(this._rotatePixelFlow=l);this._time=s?this.rotateTime:n?this.zoomTime:r?this.panTime:th(0)}get rotateTime(){return this.definition.hasRotate?th(this._rotatePixels/this._rotatePixelFlow):th(0)}get zoomTime(){return this.definition.hasZoom?th(this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow):th(0)}get panTime(){if(this.definition.hasPan){if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,t=e*this._panPixelsAtSource;return th(Math.log(t*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow))}return th(this._panPixelsAtSource/this._panPixelFlow)}return th(0)}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const t=this.definition.compared.sourceZoom,n=this.definition.compared.targetZoom;return(t*(t/n)**-e-t)/(n-t)}return e}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const t=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(t*e*this._time)-1))/(t*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,t){e=Math.min(Math.max(e,0),1);const n=this._interpolateComponentsZoom(e),r=this._interpolateComponentsPan(e),s=this._interpolateComponentsRotate(e);return t?(t.zoom=n,t.pan=r,t.rotate=s):t={zoom:n,pan:r,rotate:s},t}};function Kat(i,e,t){const n=e-i.compared.sourceZoom,r=i.halfWindowPanAtZoom(n);return-i.halfWindowSize*(t.ascensionFactor*Math.LN2*i.compared.pan+r)*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2*r)}function Yat(i,e,t){const n=1/e,r=Math.log(i.compared.sourceZoom*n),s=1/i.desiredPixelFlow,a=1/Math.LN2,o=e-i.compared.sourceZoom,l=1/o,c=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(o))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*n*s*a*l*c-i.halfWindowSize*r*s*a*l+i.halfWindowSize*r*s*a*c/(o*o)}function Xat(i,e,t){const n=e-i.compared.sourceZoom,r=1/n,s=1/e,a=Math.log(i.compared.sourceZoom*s),o=(t.ascensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(n))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*r*(-2*r*s*o+2*r*a+2*s-2*a*o/(n*n)-o/(e*e))/(i.desiredPixelFlow*Math.LN2)}function Zat(i,e){return-i.halfWindowSize*Math.log(i.compared.sourceZoom/e)/(i.desiredPixelFlow*Math.LN2)}function Qat(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function Jat(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function eot(i,e,t){return-i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e))}function tot(i,e,t){return i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e))}function iot(i,e,t){return-2*i.compared.pan*i.halfWindowSize*(t.ascensionFactor+t.descensionFactor-1)/(i.desiredPixelFlow*i.halfWindowPanAtZoom(e*e*e))}function not(i,e,t){return i.halfWindowSize*(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*i.halfWindowPanAtZoom(-e+i.compared.targetZoom))}function rot(i,e,t){const n=Math.log(e/i.compared.targetZoom),r=1/i.desiredPixelFlow,s=1/Math.LN2,a=-e+i.compared.targetZoom,o=1/a,l=(-i.halfWindowPanAtZoom(e)-t.descensionFactor*Math.LN2*i.compared.pan+i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return-i.halfWindowSize*n*r*s*o+i.halfWindowSize*n*r*s*l/(a*a)+i.halfWindowSize*r*s*o*l/e}function sot(i,e,t){const n=e-i.compared.targetZoom,r=1/n,s=1/e,a=Math.log(e/i.compared.targetZoom),o=(i.halfWindowPanAtZoom(e)+t.descensionFactor*Math.LN2*i.compared.pan-i.halfWindowPanAtZoom(i.compared.targetZoom))/i.halfWindowPanAtZoom(1);return i.halfWindowSize*r*(-2*r*s*o-2*r*a+2*s+2*a*o/(n*n)-o/(e*e))/(i.desiredPixelFlow*Math.LN2)}function aot(i,e){return i.halfWindowSize*Math.log(e/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2)}function oot(i,e){return i.halfWindowSize/(e*i.desiredPixelFlow*Math.LN2)}function lot(i,e){return-i.halfWindowSize/(e*e*i.desiredPixelFlow*Math.LN2)}function cot(i){const e=Math.LN2*i.compared.pan,t=i.compared.sourceZoom-i.compared.targetZoom,n=i.halfWindowPanAtZoom(t),r=i.halfWindowSize*Math.log(i.compared.sourceZoom/i.compared.targetZoom)/(i.desiredPixelFlow*Math.LN2*n);return i.compared.sourceZoom<=i.compared.targetZoom?r*(e-n):r*(e+n)}function uot(i,e){let t=dot(i,e);const n={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},r=n.ascensionFactor===0,s=n.descensionFactor===0,a=r?Zat:Kat,o=r?Qat:Yat,l=r?Jat:Xat,c=s?aot:not,u=s?oot:rot,d=s?lot:sot,h=C=>a(i,C,n)+eot(i,C,n)+c(i,C,n),p=C=>o(i,C,n)+tot(i,C,n)+u(i,C,n),m=C=>l(i,C,n)+iot(i,C,n)+d(i,C,n);let g=h(t);const _=cot(i);let b;const x=e.maximumIterations||20,w=e.maximumDistance!=null?e.maximumDistance:1/0;for(b=0;b<x;b++){const S=(p(t)+1e-6)/m(t);if(isNaN(S)||t>=w&&S<0){if(!isFinite(w))return null;t=w,g=h(t);break}if(t-=S,t<i.compared.sourceZoom||t<i.compared.targetZoom)return null;const E=h(t);if(Math.abs(E-g)/g<=.005)break;g=E}return g>_*(1-.3)||t<i.compared.sourceZoom||t<i.compared.targetZoom?null:t}function dot(i,e){const t=Math.max(i.compared.sourceZoom,i.compared.targetZoom),n=i.source.zoomAtPixelsPerPan(i.desiredPixelFlow/i.compared.pan)/2;return n<t?e.maximumDistance!=null?t+(e.maximumDistance-t)/2:1.5*t:e.maximumDistance?Math.min(e.maximumDistance,n):n}let hot=class extends qat{constructor(e,t){super(),this._preallocSegments=[new MF,new MF,new MF],this.update(e,t)}update(e,t){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();let n=null;t&&t.apex&&(n=uot(e,t.apex)),this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,n==null?this._updateWithoutApex():this._updateWithApex(n,t.apex)}segmentInterpolateComponentsAt(e,t,n){return n=e.interpolateComponentsAt(t,n),e===this._ascensionSegment?n.zoom=ZU(n.zoom):e===this._descensionSegment&&(n.zoom=oD(n.zoom)),n}_updateWithApex(e,t){const[n,r,s]=this._preallocSegments,a=t.ascensionFactor!=null?t.ascensionFactor:.5,o=Math.min(1-a,t.ascensionFactor!=null?t.descensionFactor:.5),l=1-a-o;n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*a,n.definition.compared.rotate=this.definition.compared.rotate*a,n.update(),this._ascensionSegment=n,this.segments.push(n),l>0&&(r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.copyFrom(this.definition),r.definition.compared.sourceZoom=e,r.definition.compared.targetZoom=e,r.definition.compared.pan=this.definition.compared.pan*l,r.definition.compared.rotate=this.definition.compared.rotate*l,r.update(),this.segments.push(r)),s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.sourceZoom=e,s.definition.compared.pan=this.definition.compared.pan*o,s.definition.compared.rotate=this.definition.compared.rotate*o,s.update(),this._descensionSegment=s,this.segments.push(s)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const pot={zoom:0,pan:0,rotate:0};let fot=class{constructor(e){this._createCamera=e,this._time=Wi(0),this.definition=new Xhe(e),this.path=new hot}get time(){return this._time}update(e,t,n){this.definition.update(e,t,n),this.path.update(this.definition,n),this._time=this._applyTimeSettings(oie(isFinite(this.path.time)?this.path.time:th(0)),n),this._easing=n.easing?n.easing:this._time>=1e3?Yhe:gM}cameraAt(e,t){t=t||this._createCamera(),e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const n=this.path.interpolateComponentsAt(e,pot);return t.interpolate(this.definition.source,this.definition.target,n),t}_normalizedEasing(e){const t=this._easing(0,this._time),n=this._easing(1,this._time);return(this._easing(e,this._time)-t)/(n-t)}_applyTimeSettings(e,t){const n=t.speedFactor!=null?t.speedFactor:1;t.duration!=null?e=t.duration:t.speedFactor!=null&&(e=Wi(e/n));const r=t.minDuration!=null?t.minDuration:z$.minDuration/n,s=t.maxDuration!=null?t.maxDuration:z$.maxDuration/n;return Wi(Math.min(Math.max(r,e),s))}};const mot=q();let got=class{constructor(e){this.currentTime=Wi(0),this._animation=new fot(()=>new iZ(e)),this._current=new iZ(e)}get finished(){return this.currentTime>=this._animation.time}get time(){return this._animation.time}update(e,t,n){const r=this._animation.definition.source,s=this._animation.definition.target,a=nt(mot,t.center,e.center),o=Et(a);o>=1e-5?(a[0]/=o,a[1]/=o,a[2]/=o):(a[0]=0,a[1]=1,a[0]=0),Ge(r.lookAtDirection,a),Ge(s.lookAtDirection,a),r.copyFromRenderCamera(e),s.copyFromRenderCamera(t),this._current.copyFrom(r),this._animation.update(r,s,n),this.currentTime=Wi(0),e.almostEquals(t)&&(this.currentTime=this._animation.time)}cameraAt(e,t){return this._animation.cameraAt(e,this._current),t=t||new Nn,this._current.copyToRenderCamera(t),t}step(e,t){return this.finished||(this.currentTime=Wi(this.currentTime+oie(e)),this.currentTime>=this.time&&(this.currentTime=this.time)),this.cameraAt(this.currentTime/this.time,t)}};var xr;(function(i){i.Ready="ready",i.Rejected="rejected",i.Running="running",i.Stopped="stopped",i.Finished="finished"})(xr||(xr={}));let vm=class extends et{constructor(e){super(e),this.state=xr.Ready}get active(){return this.state===xr.Running}get isInteractive(){return!1}get canStop(){return!1}stopController(){return!!this.canStop&&(this.state=xr.Stopped,!0)}finishController(){this.state=xr.Finished}get steppingFinished(){return!1}};f([y({constructOnly:!0})],vm.prototype,"view",void 0),f([y({readOnly:!0})],vm.prototype,"active",null),f([y()],vm.prototype,"state",void 0),f([y({readOnly:!0})],vm.prototype,"isInteractive",null),vm=f([ge("esri.views.3d.state.controllers.CameraController")],vm);let fA=class extends vm{constructor(){super(...arguments),this._asyncResult=null}get canStop(){return!0}set asyncResult(e){this._asyncResult&&(this._asyncResult.reject(js()),this._asyncResult=null),this.state===xr.Finished||this.state===xr.Stopped?(VL(e),this.state===xr.Finished?e.resolve():e.reject(js())):this._asyncResult=e}get asyncResult(){return this._asyncResult}onControllerStart(){this.state=xr.Running,T(this.viewAnimation)&&this.viewAnimation.when(()=>this.updateStateFromViewAnimation(),()=>this.updateStateFromViewAnimation())}updateStateFromViewAnimation(){!T(this.viewAnimation)||this.state!==xr.Ready&&this.state!==xr.Running||(this.viewAnimation.state===Qm.State.FINISHED?this.finish():this.viewAnimation.state===Qm.State.STOPPED&&(this.state=xr.Stopped))}onControllerEnd(){T(this.viewAnimation)&&!this.viewAnimation.done&&(this.state===xr.Finished?this.viewAnimation.finish():this.state===xr.Stopped&&this.viewAnimation.stop()),this._asyncResult&&(this.state===xr.Finished?this._asyncResult.resolve():this._asyncResult.reject(js()))}finish(){this.finishController()}};fA=f([ge("esri.views.3d.state.controllers.AnimationController")],fA);let Pm=class extends fA{constructor(e){super(e),this.mode="interaction",this._hasTarget=!1}get intersectionHelper(){return this.view.sceneIntersectionHelper}initialize(){this.animation=new got(this.view.state.viewingMode),this.viewAnimation=this.mode==="interaction"?null:new Qm}get isInteractive(){return this.mode==="interaction"}begin(e,t){this._hasTarget=!0;const n=this.animationSettings(t);wP.copyFrom(this.view.state.camera);const r=Od(this.view.state.viewingMode);this.intersectionHelper.intersectRay(wP.ray,r,nZ)&&(wP.center=nZ),this.animation.update(wP,e,n),this.animation.finished&&this.finish()}finish(){this.animation.currentTime=this.animation.time,super.finish()}get steppingFinished(){return this._hasTarget&&this.animation.finished}stepController(e,t){this._hasTarget&&this.animation.step(e,t)}onControllerEnd(e){this._hasTarget&&(this.animation.cameraAt(this.animation.currentTime/this.animation.time,e),this.animation.currentTime=this.animation.time),super.onControllerEnd(e)}animationSettings(e={}){return{apex:{maximumDistance:this.view.state.constraints.clampAltitude(1/0)/6,ascensionFactor:void 0,descensionFactor:void 0},...e,easing:typeof e.easing=="string"?Bat[e.easing]:e.easing}}};f([y({constructOnly:!0})],Pm.prototype,"mode",void 0),f([y({readOnly:!0})],Pm.prototype,"isInteractive",null),Pm=f([ge("esri.views.3d.state.controllers.PointToPointAnimationController")],Pm);const wP=new Nn,nZ=q();function lD(i=yot){return[i[0],i[1],i[2],i[3]]}function mA(i,e){return vot(i[0],i[1],i[2],e,E0e.get())}function vot(i,e,t,n,r=lD()){return r[0]=i,r[1]=e,r[2]=t,r[3]=n,r}function r7(i,e,t){return vi(t,i,e),mt(t,t),t[3]=RB(i,e),t}const yot=[0,0,1,0];function Zhe(i,e,t){return _ot(i,i.screenToRender(e,Vx(si.get())),t)}function _ot(i,e,t){const n=Vx(Zs(si.get(),e));if(n[2]=0,!i.unprojectFromRenderScreen(n,t.origin))return null;const r=Vx(Zs(si.get(),e));r[2]=1;const s=i.unprojectFromRenderScreen(r,si.get());return B(s)?null:(nt(t.direction,s,t.origin),t)}function KC(i,e,t){return s7(i,i.screenToRender(e,Vx(si.get())),t)}function s7(i,e,t){Ge(t.origin,i.eye);const n=je(si.get(),e[0],e[1],1),r=i.unprojectFromRenderScreen(n,si.get());return B(r)?null:(nt(t.direction,r,t.origin),t)}function a7(i,e,t,n){const r=KC(e,t,bot);return qL(i,r,n)}const bot=Oc();var vC;(function(i){i[i.Ellipsoid=0]="Ellipsoid",i[i.Silhouette=1]="Silhouette"})(vC||(vC={}));const Qhe=30,U$=[1,3e8],Jhe=70;function G0(i,e,t){return t[0]=e[0]/(i.fullWidth/i.pixelRatio),t[1]=e[1]/(i.fullHeight/i.pixelRatio),t}function R6(i){for(;i>Math.PI;)i-=2*Math.PI;for(;i<-Math.PI;)i+=2*Math.PI;return i}function Ry(i,e,t){const n=Mh(A0e.get(),t[3],t);B(n)||$0e(n,Ks)||(nt(Rn,i.eye,e),$t(Rn,Rn,n),i.eye=rt(Rn,Rn,e),nt(Rn,i.center,e),$t(Rn,Rn,n),i.center=rt(Rn,Rn,e),i.up=$t(Rn,i.up,n))}function wot(i,e,t,n){return xb(i,Zhe(e,t,c7),n)}function I6(i,e,t,n){return xb(i,KC(e,t,c7),n)}function o7(i,e,t,n){const r=si.get();let s=1-t;nt(r,e,i.eye);const a=Et(r);let o=a*(1-s);s>=0&&o<n&&(o=n,s=-(o-a)/a),Math.abs(a-o)<1e-6||(Ye(r,r,s),i.eye=rt(Rn,i.eye,r),i.center=oo(Rn,i.center,e,s))}function epe(i,e,t){e.getScreenCenter(rZ),a7(i,e,rZ,Rn)&&(e.center=Rn);const n=e.distance,r=n*t;if(Math.abs(n-r)<1e-6)return;const s=Ye(si.get(),e.viewForward,r);e.eye=nt(Rn,e.center,s)}const rZ=Fn();function PF(i,e){je(e,0,0,0);for(const t of i)rt(e,e,t);Ye(e,e,1/i.length)}function rI(i,e,t,n){return Math.sin(i/Et(e))*(t+n.radius)}function sZ(i,e,t,n){return rI(Math.PI/2,e,t,n)+(i-Math.PI/2)}var $a;(function(i){i[i.Vertical=0]="Vertical",i[i.Horizontal=1]="Horizontal"})($a||($a={}));const aZ={Elevation:3e4,Angle:zi(6)},xP={Pole:.95,Angle:zi(18),Tilt:45},tpe=zi(80);function ipe(i,e,t,n,r,s){const a=q(),o=gf();let l=!0,c=!0;return i.intersectScreen(t,a,s)?o[3]=Et(a):(c=!1,e.aboveGround&&r!==vC.Ellipsoid?o[3]=Math.max(Et(e.center),.9*n.radius):o[3]=Et(e.eye)-e.relativeElevation,r===vC.Silhouette?gA(o,e,t,a):l=a7(o,e,t,a)),{sphere:o,scenePickPoint:l?a:null,hasGeometryIntersection:c}}function cD(i,e,t,n){return Et(i.eye)-n.radius>aZ.Elevation?$a.Horizontal:t?(KC(i,e,fZ),-Math.sign(i.relativeElevation)*(.5*Math.PI+RB(i.eye,fZ.direction))<aZ.Angle?$a.Vertical:$a.Horizontal):$a.Vertical}function npe(i,e,t){nt(OF,t,e),i.eye=nt(Rn,i.eye,OF),i.center=nt(Rn,i.center,OF)}const OF=q();function gA(i,e,t,n){const r=KC(e,t,c7);return!B(r)&&(KL(i,r,CP),qL(i,r,n)?!(Fo(CP,r.origin)<Fo(n,r.origin))||(Ge(n,CP),!1):(nt(c1,e.eye,e.center),mt(c1,c1),gne(c1,-dt(mt(c1,c1),CP),oZ),xb(oZ,r,n),!1))}const CP=q(),c1=q(),oZ=Dr();function rpe(i,e,t,n,r,s){let a=0;if(vi(W$,i,e),nt(AP,i,e),Et(i)<=r||!n.aboveGround){vi(t,AP,n.eye);const o=dt(i,e)/(Et(i)*Et(e));if(o<.9999)a=Uo(o);else{const c=Et(vi(q(),i,e))/(Et(i)*Et(e));a=nf(c)}const l=Math.cos(lt(py.normalize(zi(s)),0,tpe));a=-a-Math.max(0,Et(e)-r)/(l*r)}else nt(lZ,n.eye,n.center),vi(t,AP,lZ),a=-Et(AP)/r;return mt(t,t),Ye(t,t,Et(W$)),a}const lZ=q();function cZ(i,e,t,n){let r,s;const a=Math.cos(lt(py.normalize(zi(n)),0,tpe));return r=e>t?-(e-t)/(a*t):e<-t?Math.PI-(e+t)/(a*t):Uo(e/t),s=i>t?-(i-t)/(a*t):i<-t?Math.PI-(i+t)/(a*t):Uo(i/t),(s-r)*t}function xot(i,e,t,n,r,s,a,o,l,c){const u=cZ(i[2],e[2],s[3],o),d=l?cZ(i[0],e[0],s[3],180):e[0]-i[0],h=Math.sin(a)*d-Math.cos(a)*u,p=Math.cos(a)*d+Math.sin(a)*u;mt(Rn,r);const m=l?h/Math.sqrt(Math.abs(s[3]**2-dt(t,Rn)**2)):h/s[3],g=p/Math.sqrt(Math.abs(s[3]**2-dt(t,n)**2));Bi(c,m,g)}function spe(i,e,t,n,r,s,a,o,l,c){vi(W$,i,e),o6(s.up,s.eye,TP,SP,EP),o6([0,0,1],s.eye,Im,uy,cpe),Ge(t,uy),Ge(n,Im),mt(t,t),Ye(t,t,Et(W$)),uX(i,mt(SP,SP),mt(EP,EP),mt(TP,TP),uZ),uX(e,SP,EP,TP,dZ),xot(uZ,dZ,i,Im,uy,a,o,l,c,r)}function Cot(i,e,t,n,r,s,a){Mh(H$,r,n),Mh(G$,a,s),Vs(Hw,H$,G$),nt(e,i,t),$t(e,e,Hw),rt(e,e,t)}function ape(i,e,t,n,r,s){Mh(H$,n,t),Mh(G$,s,r),Vs(Hw,H$,G$),nt(Rn,i.eye,e),$t(Rn,Rn,Hw),i.eye=rt(Rn,Rn,e),nt(Rn,i.center,e),$t(Rn,Rn,Hw),i.center=rt(Rn,Rn,e),nt(Rn,i.up,e),$t(Rn,Rn,Hw),i.up=rt(Rn,Rn,e)}function l7(i,e,t,n,r,s){return(Math.abs(n)>Math.PI-xP.Angle||Math.abs(n)<xP.Angle)&&(Math.abs(i[2])<t*xP.Pole||Math.abs(e)>t)&&s.aboveGround&&r<xP.Tilt}function ope(i,e,t,n,r,s){if(s)r7(t,n,hZ),Ry(e,i,hZ);else{const a=rpe(t,n,pZ,e,i[3],r);Ry(e,i,mA(pZ,a))}}function lpe(i,e,t,n,r,s,a){const o=a?20:1,l=1e-12;let c,u;Ge(e_,n),MP.copyFrom(e);for(let d=0;d<o&&Fo(t,e_)>l&&(c=Fo(t,e_),spe(t,e_,uy,Im,IT,MP,i,r,s,a),ape(MP,i,Im,IT[1],uy,IT[0]),Cot(e_,e_,i,Im,IT[1],uy,IT[0]),u=Fo(t,e_),u<c||d===0);d++)e.copyFrom(MP)}function Tot(i,e,t,n,r,s,a){l7(t,dt(e.up,t),i[3],-py.normalize(zi(r)),s,e)?lpe(i,e,t,n,-py.normalize(zi(r)),s,a):ope(i,e,t,n,s,a)}function Sot(i,e,t,n,r,s){const{eye:a}=i;o6([0,0,1],a,Im,uy,cpe);const o=e.translation[0]*t.pan,l=r.mode==="zoom"?0:e.translation[1]*t.pan,c=Math.max(Math.sqrt(Math.abs(1-dt(i.center,Im)**2/Et(i.center)**2)),.5),u=(Math.sin(s)*l+Math.cos(s)*o)/c,d=-Math.cos(s)*l+Math.sin(s)*o;switch(gd(n.pan.matrix,n.pan.matrix,u,Im),n.pan.enabled=!0,r.mode){case"pan":gd(n.pan.matrix,n.pan.matrix,d,uy),n.pan.enabled=!0;break;case"zoom":n.zoom=-e.translation[1]*t.zoom}}function Eot(i,e,t,n,r){const{eye:s,viewRight:a}=i,o=vi(si.get(),a,s),l=e.translation[0]*t.pan;switch(l!==0&&(gd(n.pan.matrix,n.pan.matrix,-l,o),n.pan.enabled=!0),r.mode){case"pan":{const c=e.translation[1]*t.pan;c!==0&&(gd(n.pan.matrix,n.pan.matrix,c,a),n.pan.enabled=!0);break}case"zoom":n.zoom=-e.translation[1]*t.zoom}}function Aot(i,e,t,n,r,s,a,o,l){l7(i.center,dt(i.up,i.center),Et(i.center),-py.normalize(zi(s)),a,e)?Sot(e,t,n,o,l,-py.normalize(zi(r))):Eot(e,t,n,o,l)}const Im=q(),uy=q(),cpe=q(),TP=q(),SP=q(),EP=q(),uZ=q(),dZ=q(),IT=xt(),hZ=lD(),H$=St(),G$=St(),Hw=St(),e_=q(),Rn=q(),AP=q(),MP=new Nn,W$=q(),pZ=q(),c7={origin:q(),direction:q()},fZ={origin:q(),direction:q()},mZ=.6,RF=4,Mot=12,Pot=60,Oot=200;let j$=class extends Pm{constructor(){super(...arguments),this._zoomLocation=q(),this._tmpCamera=new Nn,this._tmpViewDir=q(),this._tmpRayDir={origin:q(),direction:q()},this._targetOnSphere=q(),this._tmpCenter=q(),this._constraintOptions={selection:qn.ALL_EXCEPT_COLLISION,interactionType:Si.ZOOM,interactionFactor:null,interactionStartCamera:new Nn,interactionDirection:null,tiltMode:va.TUMBLE},this._sphere=gf()}initialize(){this._intersector=Od(this.view.state.viewingMode)}zoomStep(e,t){if(!this.active)return;const n=this.view.state,{interactionStartCamera:r}=this._constraintOptions;this.animation.finished?r.copyFrom(n.camera):this.animation.cameraAt(1,r);let s=!1,a=!1;this.intersectionHelper.intersectScreen(t,this._zoomLocation,this.view.map.ground.opacity===0?Rot:{})&&(s=e>0,a=!0),this._tmpCamera.copyFrom(n.camera),s?this.intersectionHelper.intersectRay(this._tmpCamera.ray,this._intersector,this._tmpCenter)&&(this._tmpCamera.center=this._tmpCenter):this.intersectionHelper.intersectRay(this._tmpCamera.ray,this._intersector,this._zoomLocation)?this._tmpCamera.center=this._zoomLocation:Ge(this._zoomLocation,this._tmpCamera.center),this._updateCamera(this._tmpCamera,e,this._zoomLocation,t,a),this.begin(this._tmpCamera)}animationSettings(){return{apex:null,duration:Wi(600),easing:gM}}_updateCamera(e,t,n,r,s){const a=rn(this.view.spatialReference),o=cD(e,r,s,a);let l;this.view.camera.position.hasZ&&(l=Math.abs(this.view.camera.position.z)),mt(OP,e.eye),Ye(OP,OP,-1),KC(e,r,this._tmpRayDir),mt(this._tmpRayDir.direction,this._tmpRayDir.direction);const c=Math.max(Math.min(Mot,1/Math.abs(dt(OP,this._tmpRayDir.direction)))*l,Oot);if(o===$a.Horizontal){let u=mZ**t;this._sphere[3]=Et(n),nt(this._tmpViewDir,e.center,e.eye);const d=Math.min(Et(this._tmpViewDir),c);let h=d*u;if(u<=1&&h<RF&&(h=RF,u=h/d),Math.abs(d-h)<1e-6)return;const p=Et(e.center);if(this._sphere[3]!==p){const m=this._sphere[3]+u*(p-this._sphere[3]);e.center=Ye(PP,e.center,m/p)}Ye(this._tmpViewDir,this._tmpViewDir,-u),e.eye=rt(PP,e.center,this._tmpViewDir),is(this.view,e,this._constraintOptions),Fo(n,e.center)>1e-12&&a7(this._sphere,e,r,this._targetOnSphere)&&Tot(this._sphere,e,n,this._targetOnSphere,this.view.camera.heading,this.view.camera.tilt,!0)}else{let u=mZ**Math.abs(t);const d=t>0?1:-1;nt(this._tmpViewDir,n,e.eye);const h=Et(this._tmpViewDir),p=this.view._stage.renderView.getMinimalDepthForArea(null,r[0],r[1],this.view.state.camera,Pot);let m=T(p)?Math.min(c,p):c;m=s?Math.min(m,h):m,Ye(this._tmpRayDir.direction,this._tmpRayDir.direction,m),rt(n,this._tmpRayDir.origin,this._tmpRayDir.direction);let g=m*u;const _=Math.max(RF,1.01*e.nearFar[0]);if(t>0&&g<_&&(g=_,u=g/m),Math.abs(m-g)<1e-6)return;Ye(this._tmpRayDir.direction,this._tmpRayDir.direction,d*(1-u)),e.eye=rt(PP,e.eye,this._tmpRayDir.direction),e.center=rt(PP,e.center,this._tmpRayDir.direction)}qC(this.view,e)}};j$=f([ge("esri.views.3d.state.controllers.global.ZoomStepController")],j$);const PP=q(),OP=q(),Rot={exclude:new Set([lh])},Iot=.6,$ot=4,Lot=60,Dot=14,kot=200;let q$=class extends Pm{constructor(){super(...arguments),this._zoomLocation=q(),this._tmpCamera=new Nn,this._tmpRayDir=q(),this._tmpCenter=q(),this._constraintOptions={selection:qn.ALL,interactionType:Si.ZOOM,interactionFactor:null,interactionStartCamera:new Nn,interactionDirection:null,tiltMode:va.TUMBLE}}zoomStep(e,t){if(!this.active)return;const n=this.view.state,{interactionStartCamera:r}=this._constraintOptions;this.animation.finished?r.copyFrom(n.camera):this.animation.cameraAt(1,r),this._tmpCamera.copyFrom(n.camera);const s=Od(this.view.state.viewingMode);e>0?(this.view.map.ground.opacity===0?this.intersectionHelper.intersectScreenFreePointFallback(t,this._zoomLocation,Not):this.intersectionHelper.intersectScreenFreePointFallback(t,this._zoomLocation),this.intersectionHelper.intersectRay(this._tmpCamera.ray,s,this._tmpCenter)&&(this._tmpCamera.center=this._tmpCenter)):this.intersectionHelper.intersectRay(this._tmpCamera.ray,s,this._zoomLocation)?this._tmpCamera.center=this._zoomLocation:Ge(this._zoomLocation,this._tmpCamera.center);const a=Iot**e;let o=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,t[0],t[1],this.view.state.camera,Lot);nt(RP,this._tmpCamera.eye,this._zoomLocation),mt(RP,RP);const l=Math.max(Math.min(Dot,1/Math.abs(dt(Fot,RP)))*Math.abs(this.view.camera.position.z),kot);if(o=T(o)?Math.min(o,l):l,o){const c=q();nt(c,this._zoomLocation,this._tmpCamera.eye),o<Et(c)&&(mt(c,c),rt(this._zoomLocation,this._tmpCamera.eye,Ye(c,c,o)))}this._updateCamera(this._tmpCamera,a,this._zoomLocation),this.begin(this._tmpCamera)}animationSettings(){return{apex:null,duration:Wi(600),easing:gM}}_updateCamera(e,t,n){nt(this._tmpRayDir,n,e.eye);const r=Et(this._tmpRayDir);let s=r*t;const a=t<=1,o=Math.max($ot,1.01*e.nearFar[0]);s!==0&&(a&&s<o&&(s=o,t=s/r),Math.abs(r-s)<1e-6||(Ye(this._tmpRayDir,this._tmpRayDir,t),e.eye=nt(gZ,n,this._tmpRayDir),e.center=oo(gZ,e.center,n,1-t),is(this.view,e,this._constraintOptions)))}};q$=f([ge("esri.views.3d.state.controllers.local.ZoomStepController")],q$);const gZ=q(),Fot=Gt(0,0,1),RP=q(),Not={exclude:new Set([lh])};let Vot=class extends sr{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,n=>this._handleDoubleClick(n))}_handleDoubleClick(e){const t=e.data;if(Q3(t,"primary")){const n=this._view.state.isGlobal?new j$({view:this._view,mode:"animation"}):new q$({view:this._view,mode:"animation"});this._view.state.switchCameraController(n),n.zoomStep(Math.log(.5)/Math.log(.6),Fn(t.x,t.y)),e.stopPropagation()}}};function Bot(i,e,t){return i===Ot.Global?new Uot(t):new zot(e,t)}let zot=class{constructor(e,t){this._elevationProvider=e,this._referenceEllipsoid=rn(t),this._unitInMeters=rf(t,this._referenceEllipsoid.metersPerDegree)}compute(e,t,n,r,s){var w;s||(s={near:0,far:0});let a=e[2]*this._unitInMeters;const o=a,l=a-r,c=(w=this._elevationProvider)==null?void 0:w.visibleElevationBounds;c&&(a=l>=0?o-this._unitInMeters*c.min:this._unitInMeters*c.max-o);const u={x:(n=T(n)?n:new fs({xmin:0,ymin:0,zmin:0,xmax:0,ymax:0,zmax:0})).xmax-n.xmin,y:n.ymax-n.ymin,z:4*Math.max(n.xmax-n.xmin,n.ymax-n.ymin)},d=Math.max(u.x,u.y,u.z);nt(t_,t,e),u1[0]=t_[0]>0?n.xmax:n.xmin,u1[1]=t_[1]>0?n.ymax:n.ymin,u1[2]=t_[2]>0?d/2:-d/2,nt(u1,u1,e),mt(t_,t_);const h=1.1*dt(u1,t_)*this._unitInMeters,p=Math.sqrt(a*(a+2*this._referenceEllipsoid.radius)),m=Math.max(n.xmax-n.xmin,n.ymax-n.ymin),g=m*Wot*this._unitInMeters,_=m*jot*this._unitInMeters;let b=lt((a-_)/(g-_),0,1);b*=b*b;let x=Math.min(ki(p,h,b),p);return x*=Math.max(Math.log(Math.abs(l)),1),x=Math.min(x,Math.max(34064e4,d)),x/=this._unitInMeters,upe(x,Hot,this._unitInMeters,s)}},Uot=class{constructor(e){this._referenceEllipsoid=rn(e)}compute(e,t,n,r,s){s||(s={near:0,far:0});const a=Et(e)-this._referenceEllipsoid.radius,o=this._referenceEllipsoid.radius+Math.min(0,r),l=Math.abs(a-r),c=Math.max(l,Math.abs(a));return upe(1.2*Math.sqrt(c*(c+2*o)),lt(2e4-(Math.log(c)-7.983)/9.011*19e3,1e3,2e4),1,s)}};function upe(i,e,t,n){const r=Got/t;return i/e>r?(n.far=i,n.near=n.far/e):(n.near=r,n.far=n.near*e),n}const Hot=2e4,Got=2,Wot=.001,jot=1e-4,u1=q(),t_=q();let sI=class extends et{constructor(e){super(e),this._handles=new mi}initialize(){this._handles.add(this.view.basemapTerrain.on("elevation-change",e=>this._handleElevationChangeEvent(e)))}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}_handleElevationChangeEvent(e){if(this.view.state.cameraController)return;const t=this.view.state.camera;T(e.spatialReference)&&Bhe(this.view,t,e.extent,e.spatialReference)&&this._applyToCurrentCamera()}_applyToCurrentCamera(){this.view.state.updateCamera(e=>qC(this.view,e,bd.EYE_AND_CENTER))}};f([y({constructOnly:!0})],sI.prototype,"view",void 0),sI=f([ge("esri.views.3d.state.ElevationCollisionConstraint")],sI);let $S=class extends et{constructor(e){super(e),this._handles=new mi,this.nearFarHeuristic=Bot(e.view.state.viewingMode,e.view.basemapTerrain,e.view.renderCoordsHelper.spatialReference)}initialize(){this._handles.add([ue(()=>{var e,t,n,r;return[(t=(e=this.view.constraints)==null?void 0:e.clipDistance)==null?void 0:t.near,(r=(n=this.view.constraints)==null?void 0:n.clipDistance)==null?void 0:r.far]},()=>this._clipDistanceNearFarChanged()),ue(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.clipDistance)==null?void 0:t.mode},()=>this._updateNearFar()),this.view.state.events.on("before-camera-change",e=>this._updateCameraNearFar(e.camera)),ue(()=>this.view.renderDataExtent,()=>this._updateNearFar(),on),ue(()=>{var e,t,n,r;return[(t=(e=this.view.constraints)==null?void 0:e.altitude)==null?void 0:t.min,(r=(n=this.view.constraints)==null?void 0:n.altitude)==null?void 0:r.max]},()=>this._updateAltitude(),on),ue(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.tilt)==null?void 0:t.max},()=>this._updateTiltMax(),on),ue(()=>{var e,t;return(t=(e=this.view.constraints)==null?void 0:e.tilt)==null?void 0:t.mode},()=>this._updateTilt(),on),ue(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},()=>this._updateTiltAutoMax(),on),ue(()=>{var e,t,n,r,s,a;return[(n=(t=(e=this.view.map)==null?void 0:e.ground)==null?void 0:t.navigationConstraint)==null?void 0:n.type,(a=(s=(r=this.view.state)==null?void 0:r.constraints)==null?void 0:s.collision)==null?void 0:a.enabled]},()=>this._updateCollision(),on)]),this.view.state.isLocal&&this._handles.add(ue(()=>this.view.renderDataExtent,e=>this._updateLocalSurfaceDistance(e),At)),this._updateNearFar(),this.view.state.viewingMode!==Ot.Local&&this._updateAltitude(),this._updateTilt(),this._updateCollision(),this._set("surfaceCollisionConstraint",new sI({view:this.view}))}destroy(){this._handles=_t(this._handles),this.surfaceCollisionConstraint&&(this.surfaceCollisionConstraint.destroy(),this._set("surfaceCollisionConstraint",null))}_clipDistanceNearFarChanged(){var t;const e=(t=this.view.constraints)==null?void 0:t.clipDistance;e&&e.mode!=="auto"&&this.view.state.updateCamera(n=>this._updateCameraNearFarManual(n,e))}_updateNearFar(){this.view.state.updateCamera(e=>this._updateCameraNearFar(e))}_updateCameraNearFar(e){const t=this.view.constraints&&this.view.constraints.clipDistance;(t?t.mode:"auto")==="manual"?this._updateCameraNearFarManual(e,t):this._updateCameraNearFarAuto(e,t)}_updateCameraNearFarAuto(e,t){this.nearFarHeuristic.compute(e.eye,e.center,this.view.renderDataExtent,aD(this.view,e.eye),e),t&&t.autoUpdate(e.near,e.far)}_updateCameraNearFarManual(e,t){t&&(e.near=t.near,e.far=t.far)}_updateCollision(){var r,s,a;const e=(a=(s=(r=this.view.map)==null?void 0:r.ground)==null?void 0:s.navigationConstraint)==null?void 0:a.type,t=!e||e==="stay-above",n=this.view.state.constraints.collision;if(t!==n.enabled){n.enabled=t,t&&this._reapplyConstraints(qn.COLLISION);const o=this.view.constraints&&this.view.constraints.tilt;o&&o.mode!=="auto"||this._updateTiltAuto()}}_updateAltitude(){const e=this.view.constraints&&this.view.constraints.altitude;e&&this.view.state.viewingMode!==Ot.Local?this.view.state.constraints.altitude={min:e.min,max:e.max}:this.view.state.constraints.altitude=null,this._reapplyConstraints()}_updateTiltMax(){const e=this.view.constraints&&this.view.constraints.tilt;e&&e.mode!=="auto"&&(this._updateTiltManual(e),this._reapplyConstraints())}_updateTilt(){const e=this.view.constraints&&this.view.constraints.tilt;(e?e.mode:"auto")==="manual"?this._updateTiltManual(e):this._updateTiltAuto(),this._reapplyConstraints()}_updateTiltManual(e){const t=this.view.state.constraints;t.tilt=t.createConstantMaxTilt(zi(e.max))}_updateTiltAuto(){const e=this.view.state.constraints;e.tilt=e.createDefaultTilt(),this._updateTiltAutoMax()}_updateTiltAutoMax(){const e=this.view.constraints&&this.view.constraints.tilt;if(!e||e.mode!=="auto")return;const t=this.view.state.constraints;if(t.tilt){const n=t.tilt(this.view.state.camera.distance).max;e.autoUpdate(ql(n))}}_updateLocalSurfaceDistance(e){if(B(e))return;let t=Math.max(e.width,e.height);if(t<=0)return;e.hasZ&&(t=Math.max(t,e.zmax-e.zmin));const n=this.view.state,r=3*t/Math.atan(n.camera.fov/2);r!==n.constraints.distance&&(n.constraints.distance=r)}_reapplyConstraints(e=qn.ALL){this.view.state.updateCamera(t=>is(this.view,t,{selection:e,interactionType:Si.NONE,interactionFactor:null,interactionStartCamera:null,interactionDirection:null,tiltMode:va.TUMBLE}))}};f([y({constructOnly:!0})],$S.prototype,"view",void 0),f([y({readOnly:!0})],$S.prototype,"surfaceCollisionConstraint",void 0),$S=f([ge("esri.views.3d.state.ConstraintsManager")],$S);let jv=class{constructor(e){this.renderCoordsHelper=e,this.frustum=_2(),this._points=S1e(),this.lines=new Array(12),this._origin=q(),this._direction=q(),this._altitude=null;for(let t=0;t<12;t++)this.lines[t]={origin:null,direction:q(),endpoint:null}}get planes(){return this.frustum}get points(){return this._points}get mutablePoints(){return this._points}get direction(){return this._direction}update(e){Zne(e.viewMatrix,e.projectionMatrix,this.frustum,this._points),Ge(this._origin,e.eye),Ge(this._direction,e.viewForward),this._altitude=this.renderCoordsHelper.getAltitude(this._origin),this._updateLines()}updatePoints(e){for(let t=0;t<this._points.length;t++)Ge(this._points[t],e[t]);E1e(this.frustum,this._points),this._updateLines()}get altitude(){return this._altitude}intersectsSphere(e){return e3(this.frustum,e)}intersectsRay(e){return A1e(this.frustum,e)}intersectsLineSegment(e,t){return M1e(this.frustum,e,t)}intersectsPoint(e){return Qne(this.frustum,e)}_updateLines(){const e=this._points;for(let t=0;t<4;t++){const n=t+4;IF(this.lines[t],e[t],e[n]),IF(this.lines[t+4],e[t],t===3?e[0]:e[t+1]),IF(this.lines[t+8],e[n],t===3?e[4]:e[n+1])}}};function IF(i,e,t){i.origin=e,i.endpoint=t,Hm(i.direction,e,t)}jv.planePointIndices=P1e,jv.nearFarLineIndices=[[Jn.NEAR_BOTTOM_LEFT,Jn.FAR_BOTTOM_LEFT],[Jn.NEAR_BOTTOM_RIGHT,Jn.FAR_BOTTOM_RIGHT],[Jn.NEAR_TOP_RIGHT,Jn.FAR_TOP_RIGHT],[Jn.NEAR_TOP_LEFT,Jn.FAR_TOP_LEFT]];let TE=class extends vm{constructor(e){super(e),this._handles=new mi}set desiredCamera(e){this._set("desiredCamera",e.clone())}get canStop(){return!0}get constraintEnabled(){return this.view.state.constraints.collision.enabled}onControllerStart(){this.state=xr.Running,this._handles.add(this.view.basemapTerrain.on("elevation-change",e=>this._handleElevationChangeEvent(e))),this._applyCorrection()}onControllerEnd(){this._handles.removeAll()}stepController(){}_handleElevationChangeEvent(e){T(e.spatialReference)&&!Bhe(this.view,this.desiredCamera,e.extent,e.spatialReference)||this._applyCorrection()}_applyCorrection(){this.view.state.updateCamera(e=>{e.copyViewFrom(this.desiredCamera),qC(this.view,e,bd.EYE_AND_CENTER)||this.constraintEnabled||(this.state=xr.Stopped)})}};f([y({constructOnly:!0})],TE.prototype,"desiredCamera",null),TE=f([ge("esri.views.3d.state.controllers.SurfaceCollisionCorrectionController")],TE);const qot=q(),IP=q();function u7(){return{direction:q(),up:q()}}function dpe(i,e,t,n,r){let s=mt(qot,i),a=dt(s,n);const o=a>0;a=Math.abs(a),a>.99&&(a=Math.abs(dt(e,n)),a<.99?(Ge(s,e),o&&Ye(s,s,-1)):s=null);let l=0;if(s){Ye(IP,n,dt(n,s)),nt(s,s,IP);const u=dt(s,r)/(Et(s)*Et(r));vi(IP,s,r),l=(dt(IP,n)>0?1:-1)*ql(Uo(u))}const c=ql(Uo(-dt(n,i)/Et(i)));return t?(t.heading=l,t.tilt=c,t):{heading:l,tilt:c}}const hpe=Gt(0,1,0),ppe=Gt(0,0,1),$T=St(),Rf=q(),If=q();function fpe(i,e,t,n=u7()){const{direction:r,up:s}=n;return L0e($T,-zi(e)),h2($T,$T,zi(t)),$t(r,ppe,$T),Ye(r,r,-1),$t(s,hpe,$T),n}function Kot(i,e,t,n){return dpe(e,t,n,ppe,hpe)}function Yot(i,e,t,n){const r=fpe(i,t,n),s=q();return Ye(s,r.direction,-e),rt(s,s,i),{up:r.up,eye:s,heading:t,tilt:n}}function Xot(i){return ql(i)}function Zot(i){return zi(i)}function mpe(i,e,t,n,r){const s=i.renderSpatialReference,a=i.map&&i.spatialReference||e.spatialReference;return ya(e,Rf,s),ya(e,If,s),Rf[0]-=t/2,If[0]+=t/2,Rf[1]-=n/2,If[1]+=n/2,no(Rf,s,Rf,a),no(If,s,If,a),r?(r.xmin=Rf[0],r.ymin=Rf[1],r.xmax=If[0],r.ymax=If[1],r.spatialReference=a):r=new fs(Rf[0],Rf[1],If[0],If[1],a),r}const Qot=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:fpe,directionToHeadingTilt:Kot,eyeForCenterWithHeadingTilt:Yot,lookAtTiltToEyeTilt:Xot,eyeTiltToLookAtTilt:Zot,toExtent:mpe},Symbol.toStringTag,{value:"Module"})),gpe=Gt(0,0,1),vpe=mt(q(),Gt(1,1,1)),Jot=new i2(-180,180),LT=St(),Dv=q(),d1=q();function ype(i,e,t,n=u7()){vi(Dv,i,gpe),dt(Dv,Dv)===0&&vi(Dv,i,vpe),Mh(LT,-zi(e),i),gd(LT,LT,-zi(t),Dv);const{up:r,direction:s}=n;return vi(r,Dv,i),mt(r,r),$t(r,r,LT),mt(s,i),No(s,s),$t(s,s,LT),n}function elt(i,e,t,n){const r=Dv,s=d1;return mt(r,i),vi(d1,r,gpe),dt(d1,d1)===0&&vi(d1,r,vpe),vi(s,d1,r),dpe(e,t,n,r,s)}function tlt(i,e,t,n){const r={eye:q(),up:null,tilt:n,heading:t},s=Dv;s[0]=i[0],s[1]=i[2],s[2]=-i[1];const a=e,o=zi(t),l=zi(n),c=Math.sin(o),u=Math.cos(o),d=Math.sin(l),h=Math.cos(l),p=Et(s);let m;if(Math.abs(l)<1e-8)m=a+p;else{const k=p/d,D=nf(a/k),$=Math.PI-l-D;m=k*Math.sin($)}const g=h*a,_=a*a*(d*d),b=u*u*_,x=m-g,w=x*x,C=b*(b+w-s[1]*s[1]);if(C<0)return Ye(r.eye,s,m/p),r.tilt=0,r;const S=Math.sqrt(C),E=s[1]*x,A=b+w;let P;if(P=u>0?-S+E:S+E,Math.abs(A)<1e-8)return p<1e-8?(r.eye[0]=0,r.eye[1]=0,r.eye[2]=a):Ye(r.eye,s,m/p),r.tilt=0,$F(r.eye),LF(r,i);r.eye[1]=P/A;const O=c*c*_,M=d*a,V=u*M*r.eye[1],L=r.eye[1]*r.eye[1],U=1-L,G=Math.sqrt(U),H=b*L+O-2*V*G*x+U*w;return Math.abs(H)<1e-8?(Ye(r.eye,s,m/p),r.tilt=0,$F(r.eye),LF(r,i)):(r.eye[0]=(U*(m*s[0]-g*s[0])-M*G*(s[0]*r.eye[1]*u+s[2]*c))/H,r.eye[2]=(U*(m*s[2]-g*s[2])-M*G*(s[2]*r.eye[1]*u-s[0]*c))/H,Ye(r.eye,r.eye,m),$F(r.eye),LF(r,i))}function $F(i){const e=i[1];i[1]=-i[2],i[2]=e}function LF(i,e){const t=ype(e,i.heading,i.tilt);return i.up=t.up,i}function ilt(i,e,t){const n=Et(e),r=Math.sqrt(t*t+n*n-2*t*n*Math.cos(Math.PI-i)),s=nf(t/(r/Math.sin(i)));return ql(i-s)}function nlt(i,e,t){const n=zi(i),r=Et(e);return nf(t/(r/Math.sin(n)))+n}function _pe(i,e,t,n,r){let s,a,o,l;const c=e.latitude,u=rn(i.spatialReference).radius,d=e.longitude,h=_st(c,t,u)/2;s=d-h,a=d+h;const p=zi(c),m=(1+Math.sin(p))/(1-Math.sin(p)),g=(m+1)*Math.tan(n/u/2),_=g*g;function b(w){const C=Math.PI/2;return(w=Fye.normalize(w,-C))>C&&(w=Math.PI-w),w}if(o=1.5*Math.PI-2*Math.atan(.5*(g+Math.sqrt(4*m+_))),l=o+n/u,o=b(o),l=b(l),l<o){const w=l;l=o,o=w}if(o=Math.max(ql(o),-90),l=Math.min(ql(l),90),a=Jot.monotonic(s,a),a-s>180){const w=(a-s-180)/2;s+=w,a-=w}const x=i.spatialReference&&i.spatialReference.isGeographic?i.spatialReference:$n.WGS84;return r?(r.xmin=s,r.ymin=o,r.xmax=a,r.ymax=l,r.spatialReference=x):r=new fs(s,o,a,l,x),i.spatialReference&&i.spatialReference.isWebMercator&&FL(r,!1,r),r}const rlt=Object.freeze(Object.defineProperty({__proto__:null,headingTiltToDirectionUp:ype,directionToHeadingTilt:elt,eyeForCenterWithHeadingTilt:tlt,lookAtTiltToEyeTilt:ilt,eyeTiltToLookAtTilt:nlt,toExtent:_pe},Symbol.toStringTag,{value:"Module"}));function K$(i){return i.type==="point"}let bpe=class{constructor(e,t=null,n=0){this.array=e,this.spatialReference=t,this.offset=n}};function wpe(i){return"array"in i}function Vp(i,e,t="ground"){if(K$(e))return i.getElevation(e.x,e.y,e.z||0,e.spatialReference,t);if(wpe(e)){let n=e.offset;return i.getElevation(e.array[n++],e.array[n++],e.array[n]||0,Jt(e.spatialReference,i.spatialReference),t)}return i.getElevation(e[0],e[1],e[2]||0,i.spatialReference,t)}function vA(i,e){return i!=null&&(e==null||(e===Ot.Local?!i.isGeographic||i.isWGS84||i.wkid===oT.CGCS2000:i.isWebMercator||i.isWGS84||i.wkid===oT.CGCS2000||i.wkid===oT.GCSMARS2000||i.wkid===oT.GCSMARS2000_SPHERE||i.wkid===oT.GCSMOON2000))}const xpe=tt.getLogger("esri.views.3d.support.cameraUtils"),Cpe=39.37,Tpe=96,$6=1,slt=8,alt=5,Spe=1,vZ=q(),$P=q(),olt={heading:0,tilt:0},ym=new Wt,llt=new i2(-20037508342788905e-9,20037508342788905e-9),clt=new i2(-180,180);var to;function vM(i){return i.spatialReference||$n.WGS84}function YC(i){return i.viewingMode==="global"?rlt:Qot}function ult(i,e,t,n,r){return YC(i).headingTiltToDirectionUp(e,t,n,r)}function cm(i,e){if(B(e))return null;const t=i.renderSpatialReference,n=YC(i).headingTiltToDirectionUp,r=q();if(!ya(e.position,r,t))return null;const s=n(r,e.heading,e.tilt);Ye(s.direction,s.direction,i.state.camera.distance),rt(s.direction,s.direction,r);const a=Lb(i,r,s.direction,s.up);return a.fov=zi(e.fov),a}(function(i){i[i.LOCKED=0]="LOCKED",i[i.ADJUST=1]="ADJUST"})(to||(to={}));const h1=q();function yC(i,e,t){const n=i.renderSpatialReference,r=uD(i,e.eye,e.viewForward,e.up,olt);let s=vM(i);return no(e.eye,n,h1,s)||(s=$n.WGS84,no(e.eye,n,h1,s)),B(t)?new ku(new Wt(h1,s),r.heading,r.tilt,ql(e.fov)):(t.position.x=h1[0],t.position.y=h1[1],t.position.z=h1[2],t.position.spatialReference=s,t.heading=r.heading,t.tilt=r.tilt,t.fov=ql(e.fov),t)}function d7(i,e,t){const n=i.state.camera,r=n.width/2/n.pixelRatio;return i.renderCoordsHelper.viewingMode===Ot.Global&&t!=null&&(e*=Math.cos(zi(t))),e/=i.renderCoordsHelper.unitInMeters,r/(Tpe*Cpe/e)/Math.tan(n.fovX/2)}function db(i,e,t){const n=i.state.camera,r=e*Math.tan(n.fovX/2),s=n.width/2/n.pixelRatio;let a=Tpe*Cpe/(s/r);return i.renderCoordsHelper.viewingMode===Ot.Global&&(a/=Math.cos(zi(t))),a*=i.renderCoordsHelper.unitInMeters,a}function Epe(i,e,t,n,r,s){return Ape(i,e,d7(i,t,e.latitude),n,r,s)}function Ape(i,e,t,n,r,s){if(W0(s)){const o=new XC(s.signal);return yA(i,n.heading,n.tilt,e,t,r,o),void o.resolver.promise.then(l=>{const c=X$(i,l,n.fov);if(!B(c))return s.resolver.resolve(c);s.resolver.reject()},l=>s.resolver.reject(l))}const a=yA(i,n.heading,n.tilt,e,t,r);return X$(i,a,n.fov,s)}function uD(i,e,t,n,r){return YC(i).directionToHeadingTilt(e,t,n,r)}function dlt(i,e){return!!(i.basemapTerrain&&i.renderCoordsHelper.fromRenderCoords(e,ym,i.spatialReference)&&Jt(Vp(i.elevationProvider,ym),0)>ym.z-Spe)}async function hlt(i,e,t){if(!i.renderCoordsHelper.fromRenderCoords(e,ym,i.spatialReference))return!1;const n=await i.elevationProvider.queryElevation(ym.x,ym.y,ym.z,ym.spatialReference,"ground",t);return Jt(n,0)>ym.z-Spe}async function plt(i,e,t){const n=q();if(e)if(e instanceof Wt){if(ya(e,n,i.renderSpatialReference),e.z==null&&i.basemapTerrain!=null){const r=await i.elevationProvider.queryElevation(e.x,e.y,e.z,e.spatialReference,"ground",t);return T(r)&&i.renderCoordsHelper.setAltitude(n,r),n}}else Ge(n,e);else Ge(n,i.state.camera.center);return n}function flt(i,e){const t=q();if(e&&e instanceof Wt){if(ya(e,t,i.renderSpatialReference),e.z==null&&i.basemapTerrain!=null){const n=Vp(i.elevationProvider,e);T(n)&&i.renderCoordsHelper.setAltitude(t,n)}}else Ge(t,e||i.state.camera.center);return t}function yA(i,e,t,n,r,s,a){const o=n&&n instanceof Wt?n:null;if(W0(a))return plt(i,n,a.signal).then(c=>{L6(i,e,t,o,c,r,s,a)},c=>a.resolver.reject(c)),null;const l=flt(i,n);return L6(i,e,t,o,l,r,s,a)}function L6(i,e,t,n,r,s,a,o){if(B(n)){const d=i.renderSpatialReference;if(n=fy(r,d,vM(i)),B(n))return null}s=Math.max(s,i.state.constraints.minimumPoiDistance);const l=vlt(i,e,t,r,s,a),c=(0,YC(i).eyeForCenterWithHeadingTilt)(r,s,l.heading,l.tilt);if(a===to.ADJUST&&i.viewingMode==="global"&&t>0){const d=()=>{const p=Mpe(i,r,s,_lt(i,s,t,r));return a=t-p<1?to.LOCKED:to.ADJUST,L6(i,e,p,n,r,s,a,o)},h=i.map.ground.navigationConstraint;if(!h||h.type==="stay-above"){if(dlt(i,c.eye))return d();if(W0(o))return hlt(i,c.eye,o.signal).then(p=>p?d():(o.resolver.resolve({eye:c.eye,up:c.up,center:Ts(r),heading:c.heading,tilt:c.tilt}),null)),null}}const u=!o||W0(o)?{center:q(),eye:q(),up:q(),tilt:0,heading:0}:o;return u.eye=c.eye,u.up=c.up,u.center=Ts(r),u.heading=c.heading,u.tilt=c.tilt,W0(o)&&o.resolver.resolve(u),u}function SE(i,e,t,n,r,s=null){const a=e.zmax!=null&&e.zmin!=null;let o,l,c;if(i.state.isGlobal){if(!vA(e.spatialReference,Ot.Global))return W0(s)&&s.resolver.reject(),null;const b=new Wt(e.xmin,e.ymin,e.spatialReference),x=new Wt(e.xmax,e.ymax,e.spatialReference),w=e.spatialReference.isGeographic?clt:llt;o=new Wt({x:w.center(b.x,x.x),y:(x.y+b.y)/2,z:a?(e.zmax+e.zmin)/2:null,spatialReference:e.spatialReference});const C=rn(e.spatialReference),S=yst(o,b,x);l=S.lon,c=S.lat,w.diff(b.x,x.x)>w.range/2&&(l+=C.halfCircumference),l=Math.min(l,C.halfCircumference),c=Math.min(c,C.halfCircumference)}else{const b=Jt(i.renderSpatialReference,e.spatialReference);b.equals(e.spatialReference)||(e=Bc(e,b)),l=e.xmax-e.xmin,c=e.ymax-e.ymin;const x=a?(e.zmax+e.zmin)/2:null;o=new Wt({x:e.xmin+.5*l,y:e.ymin+.5*c,z:x,spatialReference:b})}const u=a?e.zmax-e.zmin:0,d=i.state.camera,h=1/Math.tan(d.fovX/2),p=1/Math.tan(d.fovY/2),m=1/Math.tan(d.fov/2),g=Math.max(.5*l*h,.5*c*p,.5*u*m)/$6;if(W0(s)){const b=new XC(s.signal);return yA(i,t,n,o,g,r,b),void b.resolver.promise.then(x=>{const w=X$(i,x,i.camera.fov);if(!B(w))return s.resolver.resolve(w);s.resolver.reject()},x=>s.resolver.reject(x))}const _=yA(i,t,n,o,g,r);return X$(i,_,i.camera.fov,s)}function mlt(i,e,t){const n=i.renderSpatialReference,r=fy(t,n,vM(i));if(B(r))return null;const s=Math.tan(e.fovX/2),a=Math.tan(e.fovY/2),o=ine(e.eye,t),l=2*o*s*$6,c=2*o*a*$6;return i.viewingMode==="global"?_pe(i,r,l,c):mpe(i,r,l,c)}function glt(i,e,t){const n=i.pointsOfInterest.centerOnSurfaceFrequent.distance;if(Math.log(t/n)/Math.LN2>slt)return!0;const r=i.renderSpatialReference,s=vM(i),a=fy(e,r,s),o=fy(i.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,r,s);if(B(a)||B(o))return!1;const l=Math.tan(.5*i.state.camera.fov)*n;return o.distance(a)/l>alt}function vlt(i,e,t,n,r,s){let a=0;return s===to.ADJUST&&glt(i,n,r)?(e=0,a=ylt(i,r,t,n)):a=h7(i,n,r,t),a=i.state.constraints.clampTilt(r,a),{heading:e,tilt:t=Mpe(i,n,r,a)}}const Y$=.7;function ylt(i,e,t,n){const r=i.state.constraints.tilt(e);r.max=Math.min(r.max,.5*Math.PI);const s=r.min*(1-Y$)+r.max*Y$,a=h7(i,n,e,t);return Math.min(a,s)}function _lt(i,e,t,n){const r=i.state.constraints.tilt(e);let s=h7(i,n,e,t);return s=Math.min(s,.5*Math.PI),r.min*(1-Y$)+s*Y$}function Mpe(i,e,t,n){return YC(i).lookAtTiltToEyeTilt(n,e,t)}function h7(i,e,t,n){return YC(i).eyeTiltToLookAtTilt(n,e,t)}function X$(i,e,t,n){if(B(e))return null;const r=i.renderSpatialReference,s=fy(e.eye,r,vM(i));return B(s)?null:T(n)?(n.position=s,n.heading=e.heading,n.tilt=e.tilt,n.fov=t,n):new ku(s,e.heading,e.tilt,t)}function blt(i,e){var n;const t=(n=i.basemapTerrain)==null?void 0:n.tilingScheme;if(t)return t.levelAtScale(e);xpe.error("#scaleToZoom()","Cannot compute zoom from scale without a tiling scheme")}function Ppe(i,e){var n;const t=(n=i.basemapTerrain)==null?void 0:n.tilingScheme;if(t)return t.scaleAtLevel(e);xpe.error("#zoomToScale()","Cannot compute scale from zoom without a tiling scheme")}function Ope(i,e,t){const n=i.renderSpatialReference;let r,s;e||(e=i.state.camera);const a=$n.WGS84;return e instanceof ku?(r=e.position.latitude,ya(e.position,vZ,n),ya(t,$P,n),s=Gn(vZ,$P)):(no(e.center,n,$P,a),r=$P[1],s=e.distance),db(i,s,r)}let XC=class{constructor(e){this.signal=e,this.resolver=_b()}};function W0(i){return i&&"resolver"in i}const wlt=.66;function Rpe(i){return 360-BL.normalize(i)}function dD(i){return BL.normalize(360-i)}function LP(i){return T(i)&&i.resolver&&i.resolver.reject(),null}function xlt(i,e){return T(i)&&i.resolver&&i.resolver.resolve(e),e}function Ipe(i,e,t,n=null){if(!e)return LP(n);const r=i.spatialReference||$n.WGS84;if(T(e.camera)){const c=oB(e.camera.position,r);if(B(c))return LP(n);const u=e.camera.clone();return u.position=c,xlt(n,u)}if(B(e.targetGeometry))return LP(n);const s=e.get("targetGeometry.spatialReference");if(s&&!VI(s,r))return LP(n);const a=yC(i,i.state.camera);let o=to.ADJUST;if(e.rotation!=null&&(a.heading=Rpe(e.rotation),o=to.LOCKED),t!=null&&(a.tilt=t),e.targetGeometry.type==="point"){const c=e.targetGeometry;let u;const d=e.targetGeometry.clone();return u=e.scale!=null?d7(i,e.scale,c.latitude):i.state.camera.distance,Ape(i,d,u,a,o,n)}const l=e.targetGeometry.extent;return SE(i,l,a.heading,a.tilt,o,n)}function Clt(i,e,t=null){return B(t)&&(t=new ga),m7(i,null,e.clone(),t)}async function Tlt(i,e,t){const n=Llt(i,e);if(!n)throw new Ze("viewpointutils-create:no-target","Missing target for creating viewpoint");const r=new ku({fov:i.camera.fov}),s=new ga({camera:r});if(n.target instanceof ga)return i_(await Alt(i,n.target,n,t,s));if(n.target instanceof ku)return i_(Lpe(i,n.target,s));const a=n.scale!=null||n.zoom!=null;if(n.target instanceof fs){const c=n.target.xmin===n.target.xmax||n.target.ymin===n.target.ymax;return i_(a||c?await D6(i,n,n.target.center,r,t,s):await Rlt(i,n,n.target,r,t,s))}const o={boundingBox:fr(),hasZ:!1,screenSpaceObjects:[]},l=a?Slt(i,n):void 0;if(await $pe(i,n.target,l,o),isFinite(o.boundingBox[0])){let c;if(ph(o.boundingBox,es),fu.x=es[0],fu.y=es[1],fu.z=es[2],fu.spatialReference=i.spatialReference,isFinite(fu.z)&&o.hasZ?c=rz(o.boundingBox):(fu.z=void 0,c=g0e(sz(o.boundingBox,klt))),a||c)return i_(await D6(i,n,fu,r,t,s));const u=Dlt(i,o.screenSpaceObjects);return i_(await $lt(i,n,fu,o.boundingBox,u,r,t,s))}return n.position?i_(Plt(i,n,r,s)):i_(await Olt(i,n,r,t,s))}function p7(i,e){return e.scale==null&&e.zoom!=null?Ppe(i,e.zoom):e.scale}function Slt(i,e){return j0e(p7(i,e))}function f7(i,e){let t=!1;return e.heading!=null?(i.heading=e.heading,t=!0):e.rotation!=null&&(i.heading=Rpe(e.rotation),t=!0),e.tilt!=null&&(i.tilt=e.tilt,t=!0),e.fov!=null&&(i.fov=e.fov),t}function m7(i,e,t,n){const r=i.spatialReference||$n.WGS84;return e=T(e)?e:cm(i,t),B(e)||(n.targetGeometry=fy(e.center,i.renderSpatialReference,r),n.scale=Ope(i,e),n.rotation=dD(t.heading),n.camera=t),n}function Z$(i,e,t){var o;const n=()=>new Ze("viewpointutils:invalid-geometry","The target is missing a valid geometry");if(!e)throw n();if(!VI(e.spatialReference,i.spatialReference))throw new Ze("viewpointutils:incompatible-spatialreference",`Spatial reference (${e.spatialReference?e.spatialReference.wkid:"unknown"}) is incompatible with the view (${i.spatialReference.wkid})`,{geometry:e});const r=[];if(!e.hasZ&&i.basemapTerrain){let l;switch(e.type){case"point":l=e;break;case"multipoint":case"polyline":l=(o=e.extent)==null?void 0:o.center;break;case"mesh":l=e.origin;break;case"extent":l=e.center;break;case"polygon":l=e.centroid}l&&T(i.basemapTerrain.spatialReference)&&VI(l,i.basemapTerrain.spatialReference)?es[2]=Jt(Vp(i.elevationProvider,l),0):es[2]=0}(0,Flt[e.type])(e,l=>{r.push(l[0],l[1],l[2])},es);const s=r.length/3;if(s===0)throw n();const a=new Array(r.length);if(Kl(r,e.spatialReference,0,a,i.spatialReference,0,s)){e.hasZ&&(t.hasZ=!0);for(let l=0;l<a.length;l+=3)e.hasZ?(es[0]=a[l+0],es[1]=a[l+1],es[2]=a[l+2]):(es[0]=a[l+0],es[1]=a[l+1]),Wx(t.boundingBox,es)}}async function Elt(i,e,t,n){const r=await l2(i.whenViewForGraphic(e));if(r.ok===!1||B(r.value)||!("whenGraphicBounds"in r.value))return void Z$(i,e.geometry,n);const s=r.value,a=await l2(s.whenGraphicBounds(e,{minDemResolution:t}));if(a.ok===!1)return void Z$(i,e.geometry,n);const{screenSpaceObjects:o,boundingBox:l}=a.value;jx(n.boundingBox,l),o&&o.forEach(c=>{n.screenSpaceObjects.push(c)}),isFinite(l[2])&&(n.hasZ=!0)}async function $pe(i,e,t,n){if(Array.isArray(e)&&e.length===2){const r=e[0],s=e[1];if(typeof r=="number"&&typeof s=="number")return fu.x=r,fu.y=s,fu.z=void 0,fu.spatialReference=i.spatialReference.isGeographic?i.spatialReference:$n.WGS84,void Z$(i,fu,n)}e&&typeof e.map=="function"?await Ra(e.map(r=>$pe(i,r,t,n))):e instanceof die?Z$(i,e,n):e instanceof ao&&await Elt(i,e,t,n)}async function Alt(i,e,t,n,r){if(T(e.camera))return Lpe(i,e.camera,r);r.scale=e.scale,r.rotation=e.rotation,r.targetGeometry=T(e.targetGeometry)?e.targetGeometry.clone():null,r.camera=null,t.heading!=null?r.rotation=dD(t.heading):t.rotation!=null&&(r.rotation=t.rotation);const s=p7(i,t);s!=null&&(r.scale=s);const a=new XC(n);return Ipe(i,r,t.tilt,a),r.camera=await a.resolver.promise,r}function Lpe(i,e,t){const n=i.spatialReference,r=oB(e.position,n);return B(r)?null:((e=e.clone()).fov=i.camera.fov,e.position=r,m7(i,null,e,t))}function Mlt(i,e,t,n,r,s){const a=i.renderSpatialReference;return ya(t.position,kP,a),ya(e,DF,a),s.targetGeometry=new Wt(e),r.position=new Wt(t.position),nt(Q$,DF,kP),uD(i,kP,Q$,n.up,r),s.scale=db(i,Gn(kP,DF),s.targetGeometry.latitude),s.rotation=dD(r.heading),s.camera=r,s}async function D6(i,e,t,n,r,s){if(B(t))throw new Ze("createfromcenter","invalid point");s.targetGeometry=t.clone();const a=Lb(i);if(e.position)return Mlt(i,s.targetGeometry,e,a,n,s);if(e.zoomFactor){const l=a.distance/e.zoomFactor,c=Ye(es,a.viewForward,-l);a.eye=rt(es,a.center,c),s.scale=db(i,l,t.latitude)}yC(i,a,n);const o=f7(n,e)?to.LOCKED:to.ADJUST;if(!e.zoomFactor){s.scale=p7(i,e),s.scale==null&&(ya(t,es,i.renderSpatialReference),Qne(a.frustum,es)?s.scale=db(i,Gn(a.eye,es),t.latitude):s.scale=Ope(i,a));const l=new XC(r);Epe(i,s.targetGeometry,s.scale,n,o,l),s.camera=await l.resolver.promise}return s}function Plt(i,e,t,n){const r=Lb(i);return Ge(Q$,r.viewForward),uD(i,r.eye,Q$,r.up,kF),t.position=new Wt(e.position),t.heading=e.heading!=null?e.heading:kF.heading,t.tilt=e.tilt!=null?e.tilt:kF.tilt,m7(i,null,t,n)}async function Olt(i,e,t,n,r){const s=Lb(i);return D6(i,e,fy(s.center,i.renderSpatialReference,i.spatialReference),t,n,r)}async function Rlt(i,e,t,n,r,s){s.targetGeometry=t.clone();const a=Lb(i);yC(i,a,n);const o=f7(n,e)?to.LOCKED:to.ADJUST,l=new XC(r);return SE(i,t,n.heading,n.tilt,o,l),s.camera=await l.resolver.promise,s}function Ilt(i,e,t,n,r){let s=0;t.hasZ?s=t.z:i.basemapTerrain&&(s=kt(Vp(i.elevationProvider,t))),je(es,t.x,t.y,s),zm(i.spatialReference,es,yZ,i.renderSpatialReference),Um(DP,yZ),cg(DP,DP),fr(DT);const a=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];for(let m=0;m<a.length;m++){const g=a[m];let _=n[g[2]];isFinite(_)||(_=s),je(es,n[g[0]],n[g[1]],_),no(es,i.spatialReference,es,i.renderSpatialReference),Wx(DT,Lp(es,es,DP))}const o=Jne(DT),l=az(DT),c=ere(DT),u=1/Math.tan(e.fovX/2),d=1/Math.tan(e.fovY/2),h=.5*Math.sqrt(o*o+c*c)*Math.max(d,u)+.5*l,p=.5*l*d+.5*Math.max(o,c);return Math.max(h,p)/r}async function $lt(i,e,t,n,r,s,a,o){o.targetGeometry=t.clone();const l=Lb(i),c=Ilt(i,l,t,n,r);yC(i,l,s);const u=f7(s,e)?to.LOCKED:to.ADJUST;o.scale=db(i,c,o.targetGeometry.latitude);const d=new XC(a);return Epe(i,o.targetGeometry,o.scale,s,u,d),o.camera=await d.resolver.promise,o}function Llt(i,e){if(!e||!i.spatialReference)return null;const t={target:null};if("declaredClass"in e||Array.isArray(e))t.target=e;else{for(const n in e)t[n]=e[n];e.center&&!t.target&&(t.target=e.center)}return t}function i_(i){return i&&T(i.camera)&&(i.rotation=dD(i.camera.heading)),i}function Dlt(i,e){const t=wlt;if(!e.length)return t;let n=Number.NEGATIVE_INFINITY;for(let r=0;r<e.length;r++){const s=e[r].screenSpaceBoundingRect;n=Math.max(n,Math.abs(s[0]),Math.abs(s[1]),Math.abs(s[2]),Math.abs(s[3]))}return t-n/Math.min(i.width,i.height)*2}const es=q(),yZ=St(),DP=Ho(),DT=Go(),klt=qi(),Q$=q(),kP=q(),DF=q(),kF={heading:0,tilt:0},fu=new Wt,Flt={point(i,e,t){t[0]=i.x,t[1]=i.y,i.hasZ&&(t[2]=i.z),e(t)},polygon(i,e,t){const n=i.hasZ;for(let r=0;r<i.rings.length;r++){const s=i.rings[r];for(let a=0;a<s.length;a++)t[0]=s[a][0],t[1]=s[a][1],n&&(t[2]=s[a][2]),e(t)}},polyline(i,e,t){const n=i.hasZ;for(let r=0;r<i.paths.length;r++){const s=i.paths[r];for(let a=0;a<s.length;a++)t[0]=s[a][0],t[1]=s[a][1],n&&(t[2]=s[a][2]),e(t)}},multipoint(i,e,t){const n=i.points,r=i.hasZ;for(let s=0;s<n.length;s++)t[0]=n[s][0],t[1]=n[s][1],r&&(t[2]=n[s][2]),e(t)},extent(i,e,t){i.hasZ?(e(je(t,i.xmin,i.ymin,i.zmin)),e(je(t,i.xmax,i.ymin,i.zmin)),e(je(t,i.xmin,i.ymax,i.zmin)),e(je(t,i.xmax,i.ymax,i.zmin)),e(je(t,i.xmin,i.ymin,i.zmax)),e(je(t,i.xmax,i.ymin,i.zmax)),e(je(t,i.xmin,i.ymax,i.zmax)),e(je(t,i.xmax,i.ymax,i.zmax))):(e(je(t,i.xmin,i.ymin,t[2])),e(je(t,i.xmax,i.ymin,t[2])),e(je(t,i.xmin,i.ymax,t[2])),e(je(t,i.xmax,i.ymax,t[2])))},mesh(i,e,t){const n=i.vertexAttributes&&i.vertexAttributes.position;if(n)for(let r=0;r<n.length;r+=3)e(je(t,n[r+0],n[r+1],n[r+2]))}};let Nlt=class{constructor(e,t,n){this.target=e,this.options=t,this.view=n,this.state="pending",this._abortController=null,this._animationController=null,this._promise=new Promise((r,s)=>{this._resolveCallback=r,this._rejectCallback=s;const a=new AbortController;T(this.options.signal)&&Bm(this.options.signal,()=>{this.abort()}),this._abortController=a,this.waitForReady()})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}resolve(e){return this.state="finished",this._resolveCallback(e)}reject(e){return this.state="finished",this._rejectCallback(e)}abort(e=!1){switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":this.reject(js());break;case"wait-for-animation-finish":!e&&T(this._animationController)&&this.view.state.cameraController===this._animationController&&this._animationController.active&&this._animationController.stopController(),this.reject(js())}}async waitForReady(){if(this.state="wait-for-ready",!this.view.ready)try{await $u(()=>this.view.ready,this._abortController.signal)}catch(e){return this.reject(e)}this.createViewPoint()}createViewPoint(){this.state!=="finished"&&(this.state="wait-for-viewpoint",this._animationController=this.options.animate?this._getAnimationController():null,Tlt(this.view,this.target,this._abortController.signal).then(e=>{if(this.state==="finished")return;const t=this._getCameraFromViewpoint(e);if(!B(t))if(this.options.animate){if(B(this._animationController))return;this.startAnimation(t,this._animationController)}else this.view.stateManager.setStateCamera(t.camera,{applyConstraints:!t.isFullySpecified,positionAndOrientationOnly:!0,doNotCancelGoToOperation:!0}),this.resolve()},e=>{this.reject(e)}))}_getCameraFromViewpoint(e){const t=!!(this.target instanceof ga&&this.target.camera||this.target instanceof ku),n=e.camera;if(B(n))return null;if(!this.view.stateManager.isCompatible(n)){const s=n.position,a=s&&s.spatialReference,o=a?a.wkid:"none",l=this.view.spatialReference.wkid;return this.reject(new Ze("GotoAnimation:incompatible-spatialreference",`Resulting camera has an incompatible spatial reference (camera: ${o}, view: ${l})`,{camera:n})),null}const r=cm(this.view,n);return B(r)?(this.reject(new Ze("GotoAnimation:invalid-camera","Resulting camera is invalid")),null):{viewpoint:e,camera:r,isFullySpecified:t}}startAnimation(e,t){this.state="wait-for-animation-finish";const n=t.viewAnimation;if(B(n))return void this.reject(new Ze("GotoAnimation:missing-animation","Unreachable code in view.stateManager"));if(n.update(e.viewpoint,"running"),!t.active||B(t.viewAnimation)||t.viewAnimation.target!==e.viewpoint||this.view.state.cameraController!==t)return this.abort();let r;e.isFullySpecified?(r=new TE({view:this.view,desiredCamera:e.camera}),qC(this.view,e.camera,bd.EYE_AND_CENTER)):is(this.view,e.camera),t.begin(e.camera,this.options);const s=()=>{const o=this.view.state.cameraController;r&&(o&&o.active?o instanceof Pm&&T(o.viewAnimation)&&o.viewAnimation.target===e.viewpoint&&(this.view.state.cameraController=r):T(t.viewAnimation)&&t.viewAnimation.target===e.viewpoint&&t.state==="finished"&&(this.view.state.cameraController=r))},a=o=>{if(!B(this.view.state))switch(t.state){case xr.Finished:switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":this.resolve()}break;case xr.Ready:case xr.Rejected:case xr.Running:case xr.Stopped:switch(this.state){case"pending":case"wait-for-ready":case"wait-for-viewpoint":case"wait-for-animation-finish":this.reject(o)}}};n.when(s,o=>a(o)),t.asyncResult={resolve:()=>a(),reject:o=>a(o)}}_getAnimationController(){let e,t=null;const n=this.view.state.cameraController;return n instanceof Pm&&(n.updateStateFromViewAnimation(),n.active&&(e=n,t=e.viewAnimation)),e!=null||(e=new Pm({view:this.view,mode:"animation"}),t=e.viewAnimation,this.view.state.switchCameraController(e))?e:(T(t)&&t.stop(),this.reject(new Ze("GotoAnimation:goto-cannot-interrupt","Cannot start an animation while interacting")),null)}},Us=class extends et{constructor(e){super(e),this._propertiesPool=new Zm({frustum:jv},this),this._handles=new mi,this._cameraSetByUser=!1,this._gotoOperation=null,this.ready=!1,this._windowDevicePixelRatio=1,this._devicePixelRatioOverride=null,this._maximumPixelRatioOverride=null,this._cameraChangeTime=0,this.test={contentCameraResetState:new Map,setDevicePixelRatio:t=>this._devicePixelRatioOverride=t,setMaximumPixelRatio:t=>this._maximumPixelRatioOverride=t,renderState:null}}get camera(){const e=this._get("camera");if(!this.ready)return e;const t=yC(this.view,this.view.state.camera,FF);return t&&e&&t.equals(e)?e:t.clone()}set camera(e){this._updatePropertyBeforeReady("camera",e)||(this.view.elevationProvider.enableElevationCache(!0),this.setStateCamera(cm(this.view,e),{applyConstraints:!1})||tt.getLogger(this.declaredClass).error("#camera=","Invalid camera",e),this.view.elevationProvider.enableElevationCache(!1))}get contentCamera(){const e=this._get("contentCamera");if(!this.ready)return e;const t=yC(this.view,this.view.state.contentCamera,FF);return t&&e&&t.equals(e)?e:t.clone()}set contentCamera(e){if(this._updatePropertyBeforeReady("contentCamera",e))return;const t=cm(this.view,e);B(t)?this.view.state.contentCamera=null:(this._updateElevation(t),this.view.state.contentCamera=t)}installContentCameraReset(e){if(this._handles.remove("contentCameraReset"),this.test.contentCameraResetState.clear(),!this.view.state.fixedContentCamera)return!1;const t=this.zoom,n=this.view.state.camera.distance**2,r=gu(this.view.state.camera.center),s=e.sticky?this.contentCamera.clone():null;return this._handles.add([ue(()=>this.contentCamera,()=>{e.sticky||(this._handles.remove("contentCameraReset"),this.test.contentCameraResetState.clear())}),ue(()=>this.zoom,a=>{this.test.contentCameraResetState.set("view.zoom",Math.abs(a-t)/2),Math.abs(a-t)>2?this.contentCamera=null:this.view.state.fixedContentCamera||(this.contentCamera=s)}),ue(()=>this.view.state.camera,a=>{const o=Fo(r,a.center);this.test.contentCameraResetState.set("camera.center",o/n),o>n?this.contentCamera=null:this.view.state.fixedContentCamera||(this.contentCamera=s)})],"contentCameraReset"),!0}get center(){return this.ready?this.view.pointsOfInterest.centerOnContent.location:this._get("center")}set center(e){this._updatePropertyBeforeReady("center",e)||(e?this.isCompatible(e)?this.setStateCamera(this._centerToCamera(e),{applyConstraints:!0})?this.view.pointsOfInterest.centerOnContent.runTask():tt.getLogger(this.declaredClass).error("#center=","Invalid center",e):tt.getLogger(this.declaredClass).error("#center=","Center has an incompatible spatial reference (center: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):tt.getLogger(this.declaredClass).error("#center=","Center may not be null or undefined"))}get extent(){if(!this.ready)return this._get("extent");const e=this.view,t=mlt(e,e.state.camera,e.pointsOfInterest.centerOnContent.renderLocation);return T(t)?t:this._get("extent")}set extent(e){this._updatePropertyBeforeReady("extent",e)||(e?this.isCompatible(e)?this.setStateCamera(this._extentToCamera(e),{applyConstraints:!0})||tt.getLogger(this.declaredClass).error("#extent=","Invalid extent",e):tt.getLogger(this.declaredClass).error("#extent=","Extent has an incompatible spatial reference (extent: "+(e.spatialReference?e.spatialReference.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e):tt.getLogger(this.declaredClass).error("#extent=","Extent may not be null or undefined"))}get frustum(){const e=this._propertiesPool.get("frustum");return e.renderCoordsHelper=this.view.renderCoordsHelper,e.update(this.view.state.camera),e}get hasInitialView(){return!!this.view.get("map.initialViewProperties.viewpoint")}get scale(){if(this.ready){const e=this.view.pointsOfInterest.centerOnContent;return db(this.view,e.distance,e.location.latitude)}return this._get("scale")}set scale(e){this._updatePropertyBeforeReady("scale",e)||this.setStateCamera(this._scaleToCamera(e),{applyConstraints:!0})||tt.getLogger(this.declaredClass).error("#scale=","Invalid scale",e)}get padding(){if(!this.ready)return this._get("padding");const e=this.view.state.camera,t=e.padding,n=e.pixelRatio,r=this._get("padding"),s=Math.round(t[li.TOP]/n),a=Math.round(t[li.RIGHT]/n),o=Math.round(t[li.BOTTOM]/n),l=Math.round(t[li.LEFT]/n);return r!=null&&r.top===s&&r.right===a&&r.bottom===o&&r.left===l?r:{top:s,right:a,bottom:o,left:l}}set padding(e){this._updatePropertyBeforeReady("padding",e)||(this._paddingToArray(e,this.view.state.camera.pixelRatio,FP),this.view.state.updateCamera(t=>t.padding=FP))}_paddingToArray(e,t,n){e?dl(n,e.top||0,e.right||0,e.bottom||0,e.left||0):dl(n,0,0,0,0);for(let r=0;r<4;r++)n[r]=Math.round(n[r]*t)}get screenCenter(){const e=this.padding;return Cs((this.view.width-(e.left+e.right))/2+e.left,(this.view.height-(e.top+e.bottom))/2+e.top)}get viewpoint(){return this.ready?Clt(this.view,this.camera):this._get("viewpoint")}set viewpoint(e){if(!this._updatePropertyBeforeReady("viewpoint",e))if(e)if(this.isCompatible(e))this.setStateCamera(this._viewpointToCamera(e),{applyConstraints:!e.camera})||tt.getLogger(this.declaredClass).error("#viewpoint=","Invalid viewpoint",e);else{const t=T(e.camera)?e.camera.position:e.targetGeometry,n=T(t)&&t.spatialReference;tt.getLogger(this.declaredClass).error("#viewpoint=","Viewpoint has an incompatible spatial reference (viewpoint: "+(n?n.wkid:"none")+", view: "+this.view.spatialReference.wkid+")",e)}else tt.getLogger(this.declaredClass).error("#viewpoint=","Viewpoint may not be null or undefined")}get zoom(){return this.ready?blt(this.view,this.scale):this._get("zoom")}set zoom(e){this._updatePropertyBeforeReady("zoom",e)||this.setStateCamera(this._zoomToCamera(e),{applyConstraints:!0})||tt.getLogger(this.declaredClass).error("#zoom=","Invalid zoom",e)}get maximumPixelRatio(){if(T(this._maximumPixelRatioOverride))return this._maximumPixelRatioOverride;let e=1/0;const{maximumPixelRatio:t,maximumRenderResolution:n}=this.view.qualitySettings;if(t!=null&&(e=Math.min(e,t)),n!=null){const r=n/Math.max(this.view.width,this.view.height);e=Math.min(e,r)}return e}get _devicePixelRatio(){return B(this._devicePixelRatioOverride)?Math.min(this._windowDevicePixelRatio,this.maximumPixelRatio):this._devicePixelRatioOverride}initialize(){this._cameraChangeTime=performance.now(),this._handles.add([Sn(()=>this.view.state.events,"before-camera-change",e=>this._updateElevation(e.camera)),ue(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},(e,t)=>this._cameraChangedHandler(e,t),on)]),rs(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},e=>this._updateElevation(e),{once:!0,sync:!0}),this._handles.add([Vm({prepare:()=>this._prepareFrame()}),ue(()=>this.view.state.cameraController,()=>{this._cameraSetByUser=!0,this._handles.remove(NP)}),Sn(()=>this.view.state.events,"camera-projection-changed",()=>this.notifyChange("scale"))])}destroy(){this.exit(),this._handles&&(this._handles.destroy(),this._handles=null),this._propertiesPool&&(this._propertiesPool.destroy(),this._propertiesPool=null)}init(){this.constraintsManager=new $S({view:this.view}),this._prepareFrame();const e=this._getInitialProperties();this._cameraSetByUser=!1,this._set("ready",!0);for(const t of e)this.set(t.name,t.value);if(!this._cameraSetByUser){const t=this.view.get("map.initialViewProperties.viewpoint")||this.view.initialExtent;t&&this.isCompatible(t)?this._setInitialView(t):this.view.state.viewingMode===Ot.Local&&this._handles.add(rs(()=>this.view.basemapTerrain.ready,()=>{this._handles.remove(NP),this._setInitialView(this.view.dataExtent)},{once:!0,initial:!0}),NP)}}exit(){this._cancelGoToOperation(),this.ready&&(this._override("padding",this.padding),this._set("ready",!1),this._clearOverride("hasInitialView"),this._cameraSetByUser=!1,this._handles.remove(NP),this.constraintsManager&&(this.constraintsManager.destroy(),this.constraintsManager=null))}async goTo(e,t){const n={animate:!0,...t};return T(this._gotoOperation)&&this._gotoOperation.abort(n.animate),this._gotoOperation=new Nlt(e,n,this.view),this.view.resourceController.scheduler.stopFrame(),this._gotoOperation}debugSetCameraOnContent(){this.setStateCamera(Lb(this.view),{applyConstraints:!1})}step(e){const t=this.view.state,n=t==null?void 0:t.cameraController;n&&(t.updateCamera(r=>n.stepController(e,r)),n.steppingFinished&&n.finishController())}_cancelGoToOperation(){T(this._gotoOperation)&&(this._gotoOperation.abort(),this._gotoOperation=null)}_getInitialProperties(){const e=new Set,t=[];for(const{propertyName:n,overrides:r}of Blt){const s=e.has(n),a=this._isOverridden(n);!s&&a&&t.push({name:n,value:this._get(n)}),this._clearOverride(n),(s||a)&&r.forEach(o=>e.add(o))}return t}_setInitialView(e){if(B(e)||this._cameraSetByUser)return;if(e instanceof ku)return void this.setStateCamera(cm(this.view,e),{applyConstraints:!1});if(e instanceof ga){if(e.targetGeometry instanceof fs){const s=SE(this.view,e.targetGeometry,0,.5,to.LOCKED);return void(T(s)&&this.setStateCamera(cm(this.view,s),{applyConstraints:!0}))}const n={applyConstraints:!e.camera},r=this._viewpointToCamera(e);return void this.setStateCamera(r,n)}const t=SE(this.view,e,0,.5,to.LOCKED);T(t)&&this.setStateCamera(cm(this.view,t),{applyConstraints:!0})}_updatePropertyBeforeReady(e,t){return!this.ready&&(this._override(e,t),t&&Vlt.includes(e)&&this._override("hasInitialView",!0),!0)}isCompatible(e){return!B(e)&&(e instanceof ga?e.camera?this.isCompatible(e.camera):this.isCompatible(e.targetGeometry):e instanceof ku?this.isCompatible(e.position):e.spatialReference&&VI(e.spatialReference,this.view.spatialReference))}_getPreservingHeadingTilt(e=zlt){return this._cameraSetByUser?(e.heading=this.camera.heading,e.tilt=this.camera.tilt):(e.heading=0,e.tilt=.5),e}_centerPointAtDistanceToCamera(e,t,n=Ng){const{heading:r,tilt:s}=this._getPreservingHeadingTilt(),a=yA(this.view,r,s,e,t,to.ADJUST);return B(a)?null:(n.copyFrom(this.view.state.camera),n.eye=a.eye,n.center=a.center,n.up=a.up,n)}_centerToCamera(e){const t=this.view.pointsOfInterest.centerOnContent;t.runTask();const n=t.distance;return this._centerPointAtDistanceToCamera(e,n)}_extentToCamera(e){const{heading:t,tilt:n}=this._getPreservingHeadingTilt(),r=SE(this.view,e,t,n,to.ADJUST,FF);return T(r)?cm(this.view,r):null}_scaleToCamera(e){if(e==null)return null;const t=this.view.pointsOfInterest.centerOnContent;t.runTask();const n=t.renderLocation,r=t.location.latitude,s=d7(this.view,e,r);return this._centerPointAtDistanceToCamera(n,s)}_zoomToCamera(e){return this._scaleToCamera(Ppe(this.view,e))}_viewpointToCamera(e){return cm(this.view,Ipe(this.view,e))}setStateCamera(e,t){return!(B(e)||!this.view.state.stopActiveCameraController())&&(this._cameraSetByUser=!0,t.doNotCancelGoToOperation||this._cancelGoToOperation(),this.view.state.updateCamera(n=>{t.positionAndOrientationOnly?(n.eye=e.eye,n.center=e.center,n.up=e.up):n.copyFrom(e),t.applyConstraints&&is(this.view,n)}),t.applyConstraints||(this.view.state.cameraController=new TE({view:this.view,desiredCamera:e})),!0)}_prepareFrame(){const{surface:e,canvas:t}=this.view;if(!e||!t)return;this._windowDevicePixelRatio=window.devicePixelRatio;const n=this._devicePixelRatio,r=Math.round(e.clientWidth*n),s=Math.round(e.clientHeight*n);if(r!==0&&s!==0&&(t.width===r&&t.height===s||(t.width=r,t.height=s),this.view.state)){const a=this.view.state.camera;a.fullWidth===r&&a.fullHeight===s&&a.pixelRatio===n||(Ng.copyFrom(a),Ng.pixelRatio!==n&&(this._paddingToArray(this.padding,n,FP),Ng.padding=FP),Ng.fullWidth=r,Ng.fullHeight=s,Ng.pixelRatio=n,this.view.state.camera=Ng),this._updateRenderState()}}_updateElevation(e){var s;const t=this.view.basemapTerrain&&this.view.basemapTerrain.spatialReference,n=((s=this.view.renderCoordsHelper)==null?void 0:s.getAltitude(e.eye))??0,r=t?aD(this.view,e.eye):0;e.relativeElevation=n-r}_updateRenderState(){T(this.test.renderState)?this.view.state.mode=this.test.renderState:this.view.animation?this.view.state.mode=Ap.ANIMATING:this.view.interacting?this.view.state.mode=Ap.INTERACTING:(this.view.state.mode===Ap.ANIMATING&&(this._cameraChangeTime=0),performance.now()-this._cameraChangeTime<=Ult?this.view.state.mode=Ap.INTERACTING:this.view.state.mode=Ap.IDLE)}_cameraChangedHandler(e,t){e&&t&&e.almostEquals(t)||(this._cameraChangeTime=performance.now(),this._updateRenderState())}};f([y({type:ku,dependsOn:["view.state.camera","ready"]})],Us.prototype,"camera",null),f([y({type:ku,dependsOn:["view.state.contentCamera","ready"]})],Us.prototype,"contentCamera",null),f([y({type:Wt})],Us.prototype,"center",null),f([y({type:fs})],Us.prototype,"extent",null),f([y({readOnly:!0})],Us.prototype,"frustum",null),f([y({readOnly:!0})],Us.prototype,"hasInitialView",null),f([y({readOnly:!0,type:Boolean})],Us.prototype,"ready",void 0),f([y({type:Number})],Us.prototype,"scale",null),f([y()],Us.prototype,"padding",null),f([y({readOnly:!0})],Us.prototype,"screenCenter",null),f([y({constructOnly:!0})],Us.prototype,"view",void 0),f([y({type:ga})],Us.prototype,"viewpoint",null),f([y({type:Number})],Us.prototype,"zoom",null),f([y()],Us.prototype,"maximumPixelRatio",null),f([y()],Us.prototype,"_devicePixelRatio",null),f([y()],Us.prototype,"_windowDevicePixelRatio",void 0),f([y()],Us.prototype,"_devicePixelRatioOverride",void 0),f([y()],Us.prototype,"_maximumPixelRatioOverride",void 0),Us=f([ge("esri.views.3d.state.ViewStateManager")],Us);const Vlt=["camera","viewpoint","extent","scale","center","zoom"],Blt=[{propertyName:"camera",overrides:["viewpoint"]},{propertyName:"viewpoint",overrides:["extent"]},{propertyName:"extent",overrides:["center","scale"]},{propertyName:"center",overrides:[]},{propertyName:"scale",overrides:["zoom"]},{propertyName:"zoom",overrides:[]},{propertyName:"padding",overrides:[]}],zlt={heading:0,tilt:0},FF=new ku,Ng=new Nn,FP=Dn(),NP="pending-initial-view",Ult=300,_Z=100;let Bp=class extends vm{constructor(){super(...arguments),this.startCamera=new Nn,this.currentCamera=new Nn,this._lastInteraction=0}get isInteractive(){return performance.now()-this._lastInteraction<_Z}stepController(e,t){t.copyViewFrom(this.currentCamera),this.currentCamera.copyFrom(t)}onControllerStart(e){this.state=xr.Running,this.startCamera.copyFrom(e),this.currentCamera.copyFrom(e)}onControllerEnd(e){e.copyViewFrom(this.currentCamera)}commitCamera(){this._lastInteraction=performance.now(),setTimeout(()=>this.notifyChange("isInteractive"),_Z),this.view.state.updateCamera(e=>this.stepController(0,e)),this.steppingFinished&&this.finishController()}};f([y({readOnly:!0})],Bp.prototype,"isInteractive",null),f([y()],Bp.prototype,"_lastInteraction",void 0),Bp=f([ge("esri.views.3d.state.controllers.InteractiveController")],Bp);var Ec;(function(i){i[i.CENTER=0]="CENTER",i[i.EYE=1]="EYE"})(Ec||(Ec={}));const Hlt=7,NF=90;let EE=class extends Bp{constructor(e){super(e),this.pivot=Ec.CENTER,this._lastPoint=xt(),this._tmpWorldUp=q(),this._tmpViewDir=q(),this._tmpRotCurPoint=xt(),this._tmpTransf=St(),this._tmpAxis=q(),this._tmpPivotPoint=q(),this._pivotPos=q(),this._constraintOptions={selection:qn.ALL,interactionType:Si.TUMBLE,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:va.TUMBLE}}get _intersectionHelper(){return this.view.sceneIntersectionHelper}initialize(){this._rotScale=this.pivot===Ec.CENTER?3:1.5}begin(e){if(this.active){switch(this.pivot){case Ec.EYE:Ge(this._pivotPos,this.startCamera.eye),this._constraintOptions.interactionType=Si.LOOK_AROUND,this._constraintOptions.tiltMode=va.LOOK_AROUND,this._constraintOptions.selection=qn.NONE;break;case Ec.CENTER:{const t=this._intersectionHelper.intersectRayFreePointFallback(this.startCamera.ray,this._pivotPos);t||Ge(this._pivotPos,this.startCamera.center),this._constrainPivotPoint(e,t),this.startCamera.center=this._pivotPos,this._constraintOptions.interactionType=Si.TUMBLE,this._constraintOptions.tiltMode=va.TUMBLE,this._constraintOptions.selection=qn.ALL&~qn.DISTANCE;break}}this._constraintOptions.interactionStartCamera=this.startCamera,G0(this.startCamera,e,this._lastPoint)}}_constrainPivotPoint(e,t){const n=this.startCamera,r=q();nt(r,this._pivotPos,n.eye);const s=Et(r);let a=Math.min(s,Hlt*Math.abs(this.view.camera.position.z));const o=rn(this.view.spatialReference),l=Fn(n.width/n.pixelRatio*.5,n.height/n.pixelRatio*.5),c=cD(this.startCamera,l,!0,o);let u=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,n.fullWidth/n.pixelRatio*.5,n.fullHeight/n.pixelRatio*.5,n,2.5*NF,NF),d=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,e[0],e[1],n,NF);(T(u)||T(d))&&(u=Jt(u,d),d=B(d)||c===$a.Horizontal?u:d,a=u>d?d:u,a=t?Math.min(a,s):a),mt(r,r),Ge(this._pivotPos,rt(this._tmpPivotPoint,n.eye,Ye(this._tmpPivotPoint,r,a)))}update(e){if(this.active){switch(this.pivot){case Ec.EYE:this.currentCamera.center=this._applyRotation(this.currentCamera,e,this.currentCamera.center,this._pivotPos);break;case Ec.CENTER:this.currentCamera.center=this._pivotPos,this.currentCamera.eye=this._applyRotation(this.currentCamera,e,this.currentCamera.eye,this._pivotPos)}is(this.view,this.currentCamera,this._constraintOptions),this.commitCamera()}}end(){this.active&&this.finishController()}_applyRotation(e,t,n,r){this.view.renderCoordsHelper.worldUpAtPosition(r,this._tmpWorldUp),G0(e,t,this._tmpRotCurPoint);let s=(this._lastPoint[1]-this._tmpRotCurPoint[1])*this._rotScale,a=(this._tmpRotCurPoint[0]-this._lastPoint[0])*this._rotScale;nt(this._tmpViewDir,n,r);const o=Et(this._tmpViewDir),l=Uo(dt(this._tmpViewDir,this._tmpWorldUp)/o);if(this.pivot===Ec.EYE){s*=-.5;const c=.5*Math.PI-l,u=.5*Math.PI*.99;s=c-Math.max(-u,Math.min(u,c+s))}return s=lt(s+l,Ya.min,Ya.max)-l,vi(this._tmpAxis,e.up,this._tmpViewDir),this.pivot===Ec.CENTER&&(a=-a),Mh(this._tmpTransf,a,this._tmpWorldUp),gd(this._tmpTransf,this._tmpTransf,s,this._tmpAxis),$t(this._tmpViewDir,this._tmpViewDir,this._tmpTransf),e.up=$t(VF,e.up,this._tmpTransf),rt(VF,r,this._tmpViewDir),Zs(this._lastPoint,this._tmpRotCurPoint),VF}};f([y()],EE.prototype,"pivot",void 0),EE=f([ge("esri.views.3d.state.controllers.RotateController")],EE);const VF=q();let BF=class extends sr{constructor(e,t,n,r){super(!0),this._view=e,this.pointerAction=t,this._pivot=n,this.registerIncoming("drag",r,s=>this._handleDrag(s))}_handleDrag(e){const t=e.data;if(t.pointers.size>1||!AU(e.data,this.pointerAction))return;const n=Fn(t.center.x,t.center.y);switch(t.action){case"start":this._cameraController&&(this._cameraController.end(),this._cameraController=null),this._cameraController=new EE({view:this._view,pivot:this._pivot}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(n);break;case"update":this._cameraController&&this._cameraController.update(n);break;case"end":this._cameraController&&(this._cameraController.end(),this._cameraController=null)}e.stopPropagation()}},k6=class extends Bp{constructor(){super(...arguments),this._pickPoint=q(),this._tmpP0=xt(),this._panAxisAngle=lD(),this._tmpRayDir=q(),this._tmpRayDirPick=q(),this._targetOnSphere=q(),this._tmpRay={origin:q(),direction:q()},this.dragBeginPoint=Fn(),this._normalizedAnchorPoint=xt(),this._constraintOptions={selection:qn.ALL_EXCEPT_COLLISION,interactionType:Si.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:null,tiltMode:va.TUMBLE},this._sphere=gf(),this._hasPickPoint=!1}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;Zs(this.dragBeginPoint,e),G0(this.startCamera,e,this._normalizedAnchorPoint);const t=rn(this.view.spatialReference),n=ipe(this._intersectionHelper,this.startCamera,e,t,vC.Ellipsoid,this.view.map.ground.opacity===0?Glt:{});if(this._navMode=cD(this.startCamera,e,n.hasGeometryIntersection,t),this._navMode===$a.Horizontal)this._hasPickPoint=!!n.scenePickPoint,this._pickPoint=Jt(n.scenePickPoint,this._pickPoint),this._sphere=n.sphere;else{let r,s;KC(this.startCamera,e,this._tmpRay),mt(this._tmpRay.direction,this._tmpRay.direction),T(n.scenePickPoint)&&(nt(this._tmpRayDirPick,this.startCamera.eye,n.scenePickPoint),s=Et(this._tmpRayDirPick)),this.view.camera.position.hasZ&&(r=Math.abs(this.view.camera.position.z));let a=lt(Qhe*r,U$[0],U$[1]);const o=this.view._stage.renderView.getMinimalDepthForArea(null,e[0],e[1],this.view.state.camera,Jhe);a=T(o)?Math.min(a,o):a,a=n.scenePickPoint?Math.min(a,s):a,this._hasPickPoint=!0,Ye(this._tmpRay.direction,this._tmpRay.direction,a),rt(this._pickPoint,this._tmpRay.origin,this._tmpRay.direction)}this._constraintOptions.interactionStartCamera=this.startCamera}update(e){if(this.active){if(this.currentCamera.eye=this.startCamera.eye,this.currentCamera.center=this.startCamera.center,this.currentCamera.up=this.startCamera.up,this._navMode===$a.Horizontal){nt(this._tmpRayDir,this.currentCamera.center,this.currentCamera.eye);const t=Et(this._tmpRayDir);G0(this.currentCamera,e,this._tmpP0);const n=12*(this._normalizedAnchorPoint[1]-this._tmpP0[1]);let r=t*2**n;const s=this.view.state.constraints.minimumPoiDistance;if(n<0&&r<s&&(r=s),Math.abs(t-r)<1e-6)return;if(this._hasPickPoint&&r<t){const a=1-(1-r/t)*(1-this._sphere[3]/Et(this.currentCamera.center));this.currentCamera.center=Ye(VP,this.currentCamera.center,a)}Ye(this._tmpRayDir,this._tmpRayDir,-r/t),this.currentCamera.eye=rt(VP,this.currentCamera.center,this._tmpRayDir),this._constraintOptions.interactionFactor=sh(sf(this.dragBeginPoint,e)),is(this.view,this.currentCamera,this._constraintOptions),this._hasPickPoint&&(gA(this._sphere,this.currentCamera,this.dragBeginPoint,this._targetOnSphere),r7(this._pickPoint,this._targetOnSphere,this._panAxisAngle),Ry(this.currentCamera,this._sphere,this._panAxisAngle))}else{const t=Et(this._tmpRay.direction);G0(this.currentCamera,e,this._tmpP0);const n=12*(this._normalizedAnchorPoint[1]-this._tmpP0[1]);let r=t*2**n;const s=this.view.state.constraints.minimumPoiDistance;if(n<0&&r<s&&(r=s),Math.abs(t-r)<1e-6)return;Ye(this._tmpRayDir,this._tmpRay.direction,1-r/t),this.currentCamera.eye=rt(VP,this.currentCamera.eye,this._tmpRayDir),this.currentCamera.center=rt(VP,this.currentCamera.center,this._tmpRayDir)}qC(this.view,this.currentCamera),this.commitCamera()}}end(){this.active&&this.finishController()}};k6=f([ge("esri.views.3d.state.controllers.global.ZoomController")],k6);const VP=q(),Glt={exclude:new Set([lh])};let F6=class extends Bp{constructor(){super(...arguments),this._tmpP=q(),this._tmpDir=q(),this._tmpN=q(),this._tmpP0=xt(),this._tmpPoi=q(),this._tmpRayDir=q(),this.dragBeginPoint=Fn(),this._normalizedAnchorPoint=xt(),this._constraintOptions={selection:qn.ALL,interactionType:Si.ZOOM,interactionFactor:0,interactionStartCamera:null,interactionDirection:q(),tiltMode:va.TUMBLE},this._plane=Dr()}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;Zs(this.dragBeginPoint,e),G0(this.startCamera,e,this._normalizedAnchorPoint);const t=this._intersectionHelper.intersectScreenFreePointFallback(e,this._tmpP,this.view.map.ground.opacity===0?Wlt:{});nt(this._tmpDir,this._tmpP,this.startCamera.eye);const n=Et(this._tmpDir);let r;mt(this._tmpDir,this._tmpDir),this.view.camera.position.hasZ&&(r=Math.abs(this.view.camera.position.z));let s=lt(Qhe*r,U$[0],U$[1]);const a=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,e[0],e[1],this.view.state.camera,Jhe);s=T(a)?Math.min(s,a):s,s=t?Math.min(s,n):s,Ye(this._tmpDir,this._tmpDir,s),rt(this._tmpP,this.startCamera.eye,this._tmpDir),nt(this._tmpN,this.startCamera.eye,this.startCamera.center),mt(this._tmpN,this._tmpN),this._tmpN[1]<0&&No(this._tmpN,this._tmpN),Gx(this._tmpP,this._tmpN,this._plane),this._constraintOptions.interactionStartCamera=this.startCamera}update(e){if(!this.active)return;wot(this._plane,this.currentCamera,this.dragBeginPoint,this._tmpPoi)||Ge(this._tmpPoi,this.currentCamera.center),G0(this.currentCamera,e,this._tmpP0);let t=4*(this._tmpP0[1]-this._normalizedAnchorPoint[1]);Zs(this._normalizedAnchorPoint,this._tmpP0),nt(this._tmpRayDir,this._tmpPoi,this.currentCamera.eye);const n=Et(this._tmpRayDir);let r=n*(1-t);Ge(this._constraintOptions.interactionDirection,this._tmpRayDir),Ye(this._constraintOptions.interactionDirection,this._constraintOptions.interactionDirection,Math.sign(t)/n);const s=this.view.state.constraints.minimumPoiDistance;t>=0&&r<s&&(r=s,t=-(r-n)/n),Math.abs(n-r)<1e-6||(Ye(this._tmpRayDir,this._tmpRayDir,t),this.currentCamera.eye=rt(n_,this.currentCamera.eye,this._tmpRayDir),oo(n_,this.currentCamera.center,this._tmpPoi,t),this._tmpPoi[2]>this.startCamera.center[2]?n_[2]=Math.max(this.startCamera.center[2],n_[2]):n_[2]=Math.min(this.startCamera.center[2],n_[2]),this.currentCamera.center=n_,this._constraintOptions.interactionFactor=sh(sf(this.dragBeginPoint,e)),is(this.view,this.currentCamera,this._constraintOptions),this.commitCamera())}end(){this.active&&this.finishController()}};F6=f([ge("esri.views.3d.state.controllers.local.ZoomController")],F6);const n_=q(),Wlt={exclude:new Set([lh])};let jlt=class extends sr{constructor(e,t,n){super(!0),this._view=e,this.pointerAction=t,this.registerIncoming("drag",n,r=>this._handleDrag(r))}_handleDrag(e){const t=e.data;if(t.pointers.size>1||!AU(e.data,this.pointerAction))return;const n=Fn(t.center.x,t.center.y);switch(t.action){case"start":this._cameraController&&(this._cameraController.end(),this._cameraController=null),this._view.state.isGlobal?this._cameraController=new k6({view:this._view}):this._cameraController=new F6({view:this._view}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(n);break;case"update":this._cameraController&&this._cameraController.update(n);break;case"end":this._cameraController&&(this._cameraController.end(),this._cameraController=null)}e.stopPropagation()}},M0=class extends Bp{constructor(e){super(e),this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._keysButtonState=[0,0,0,0,0,0,0,0,0,0,0,0],this._tmpCamera=new Nn,this._constraintOptions={selection:qn.ALL,interactionType:Si.NONE,interactionStartCamera:new Nn,interactionFactor:0,interactionDirection:null,tiltMode:va.LOOK_AROUND}}handleEventGamepad(e){const t=r6(e,this.view.navigation.gamepad,this._transformation);(e.action==="end"||jR(t))&&this.finishController()}activateDirection(e){this._keysButtonState[e]=1,YY(this._keysButtonState,this._transformation)}deactivateDirection(e){this._keysButtonState[e]=0;const t=YY(this._keysButtonState,this._transformation);jR(t)&&this.finishController()}onControllerStart(e){this._filteredSurfaceElevation=this.view.pointsOfInterest.cameraOnSurface.location.z,this._headingStart=this.view.camera.heading,super.onControllerStart(e)}_updateFilteredSurfaceElevation(e){const t=this.view.pointsOfInterest.cameraOnSurface.location.z,n=1;this._filteredSurfaceElevation+=n*(t-this._filteredSurfaceElevation)*e}stepController(e,t){this._updateStartHeading(),this._updateFilteredSurfaceElevation(e),this.currentCamera.copyViewFrom(t),this._updateCameraCenter(),this._constraintOptions.interactionStartCamera.copyFrom(this.currentCamera),this._calculateControlTransformation(e,this.currentCamera,r_),this._applyDisabledMovementTypes(r_),this._applyPan(r_.pan),this._applyRotate(r_.rotate),this._applyZoom(r_.zoom),this._applyAscend(r_.ascend),this._constraintOptions.interactionType=Si.NONE,this._constraintOptions.selection=qn.COLLISION,is(this.view,this.currentCamera,this._constraintOptions),super.stepController(e,t)}_updateStartHeading(){this._transformation.heading!==0&&(this._headingStart=this.view.camera.heading)}_applyRotate(e){if(!e.enabled)return;const t=this.currentCamera;nt(yl,t.center,t.eye),$t(yl,yl,e.matrix),t.center=rt(yl,yl,t.eye),t.up=$t(yl,t.up,e.matrix),this._constraintOptions.interactionType=Si.LOOK_AROUND,this._constraintOptions.selection=qn.ALL_EXCEPT_COLLISION,is(this.view,t,this._constraintOptions)}_applyPan(e,t=this.currentCamera){e.enabled&&(t.eye=$t(yl,t.eye,e.matrix),t.center=$t(yl,t.center,e.matrix),this.view.state.isGlobal&&(t.up=$t(yl,t.up,e.matrix)),this._constraintOptions.interactionType=Si.PAN,this._constraintOptions.selection=qn.ALL,is(this.view,t,this._constraintOptions))}_applyZoom(e){if(!e)return;const t=this.currentCamera.viewForward;this.currentCamera.eye=rt(yl,this.currentCamera.eye,Ye(si.get(),t,e)),Ge(kT,t),No(kT,kT),this._constraintOptions.interactionDirection=kT,this._constraintOptions.interactionType=Si.ZOOM,this._constraintOptions.selection=qn.ALL_EXCEPT_COLLISION,is(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null}_applyAscend(e){if(!e)return;const t=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,si.get());if(this._constraintOptions.interactionDirection=Ge(kT,t),this.view.state.isGlobal){const n=Et(this.currentCamera.eye),r=(n+e)/n;this.currentCamera.eye=Ye(yl,this.currentCamera.eye,r),this.currentCamera.center=Ye(yl,this.currentCamera.center,r)}else{const n=Ye(si.get(),t,e);this.currentCamera.eye=rt(yl,this.currentCamera.eye,n),this.currentCamera.center=rt(yl,this.currentCamera.center,n)}this._updateCameraCenter(),this._constraintOptions.interactionType=Si.ASCEND,this._constraintOptions.selection=qn.COLLISION,is(this.view,this.currentCamera,this._constraintOptions)&&this._updateCameraCenter(),this._constraintOptions.selection=qn.ALL_EXCEPT_COLLISION,is(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null}_calculateControlTransformation(e,t,n){Jlt(n);const r=this._computeVelocities(e);this.view.state.isLocal?this._calculateControlTransformationLocal(r,t,n):this._calculateControlTransformationGlobal(r,t,n)}_updateCameraCenter(){const e=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,t=this.view.renderCoordsHelper,n=this.currentCamera.ray;this.currentCamera.center=t.intersectManifoldClosestSilhouette(n,e,yl)}_calculateControlTransformationLocal(e,t,n){const{viewRight:r,viewForward:s}=t,a=this._transformation,o=this.view.navigation.gamepad,l=je(si.get(),s[0],s[1],0);mt(l,l);const c=a.translation[0]*e.pan;if(c!==0){const g=Ye(si.get(),r,c);of(n.pan.matrix,n.pan.matrix,g),n.pan.enabled=!0}switch(o.mode){case"pan":{const g=-a.translation[1]*e.pan;if(g!==0){const _=Ye(si.get(),l,g);of(n.pan.matrix,n.pan.matrix,_),n.pan.enabled=!0}n.zoom=a.zoom*e.zoom;break}case"zoom":n.zoom=(-a.translation[1]+a.zoom)*e.zoom;break;default:Do(o.mode)}const u=a.translation[2]*e.ascend;n.ascend=u;const d=-a.heading*e.rotate;d!==0&&(gd(n.rotate.matrix,n.rotate.matrix,d,this.view.renderCoordsHelper.worldUpAtPosition(t.eye,si.get())),n.rotate.enabled=!0);const h=a.tilt*e.rotate,p=Oy(this.view.renderCoordsHelper,t.center,t.eye),m=lt(p+h,Ya.min,Ya.max)-p;m&&(gd(n.rotate.matrix,n.rotate.matrix,m,r),n.rotate.enabled=!0)}_calculateControlTransformationGlobal(e,t,n){const{eye:r,viewRight:s}=t,a=this._transformation,o=this.view.navigation.gamepad,l=vi(si.get(),s,r);mt(l,l),No(l,l),Aot(this.startCamera,t,a,e,this.view.camera.heading,this._headingStart,this.view.camera.tilt,n,o),this._tmpCamera.copyFrom(this.currentCamera),this._applyPan(r_.pan,this._tmpCamera);const c=this.view.pointsOfInterest.centerOnSurfaceFrequent.estimatedSurfaceAltitude,u=a.translation[2]*e.ascend;n.ascend=u;const d=-a.heading*e.rotate;d!==0&&(gd(n.rotate.matrix,n.rotate.matrix,d,this._tmpCamera.eye),n.rotate.enabled=!0);const h=a.tilt*e.rotate,p=this._clampTiltDeltaGlobalToValidRange(h,t.ray,c);p!==0&&(gd(n.rotate.matrix,n.rotate.matrix,p,this._tmpCamera.viewRight),n.rotate.enabled=!0),n.zoom+=a.zoom*e.zoom}_clampTiltDeltaGlobalToValidRange(e,t,n){const r=rn(this.view.spatialReference),s=rI(Ya.min,t.origin,n,r);let a=0,o=0;const l=si.get();if(this.view.renderCoordsHelper.intersectManifold(t,n,l)){const c=Oy(this.view.renderCoordsHelper,l,t.origin);a=rI(c,t.origin,n,r),o=rI(Ya.max,t.origin,n,r)}else{KL(PB(OB,n+r.radius),t,l);const c=Uo(-dt(t.direction,mt(l,l)));a=sZ(c,t.origin,n,r),o=sZ(Ya.max,t.origin,n,r)}return lt(a+e,s,o)-a}_getPointAbsoluteSurfaceElevation(e,t,n){const{renderCoordsHelper:r}=this.view,s=r.getAltitude(e),a=t+Math.abs(s-t);return r.setAltitude(n,a,e),a}_clampedDistanceToSurface(e,t){const{renderCoordsHelper:n}=this.view,{camera:r}=this.view.state,{direction:s}=ult(this.view,t,0,Dpe,Qlt),a=n.intersectManifoldClosestSilhouette(Ah(t,s),e,si.get()),o=Gn(t,a),l=n.intersectManifoldClosestSilhouette(Ah(t,Hm(si.get(),t,r.center)),e,si.get()),c=Gn(t,l);return Math.min(o,c)}_computeHeadingRotateRadius(e){const{renderCoordsHelper:t,state:n}=this.view,{camera:r,isGlobal:s}=n,a=t.intersectManifoldClosestSilhouette(r.ray,this._filteredSurfaceElevation,si.get());if(s){const o=nt(si.get(),e,a),l=Et(o);Ye(o,o,1/l);const c=mt(si.get(),e),u=Uo(dt(c,o));return l*Math.sin(Math.min(Klt,u))}{const o=Ge(si.get(),e);return t.setAltitude(o,this._filteredSurfaceElevation),Gn(a,o)}}_minimumAscendVelocity(){return this.view.state.constraints.collision.enabled?0:Ylt}_computeVelocities(e){const t=this._filteredSurfaceElevation,n=t+rn(this.view.spatialReference).radius,{camera:r,isGlobal:s}=this.view.state,a=si.get(),o=this._getPointAbsoluteSurfaceElevation(r.eye,t,a),l=this._clampedDistanceToSurface(t,a),c=r.width/2,u=bZ*r.width,d=bZ*r.width,h=l*Math.tan(.5*r.fovX)/c,p=h/n,m=h/this._computeHeadingRotateRadius(a),g=o-t;return{pan:(s?p:h)*u*e,ascend:Math.max(this._minimumAscendVelocity()*e,2**(u*e/c)*g-g),zoom:2**(u*e/c)*l-l,rotate:lt(m*d,Xlt,Zlt)*e}}_applyDisabledMovementTypes(e){!T(this.disableMovements)||this.disableMovements.mode!==void 0&&this.view.state.viewingMode!==this.disableMovements.mode||(e.zoom=this.disableMovements.zoom?0:e.zoom,e.ascend=this.disableMovements.ascend?0:e.ascend,e.pan.enabled=!this.disableMovements.pan,this.disableMovements.pan&&Q0(e.pan.matrix),e.rotate.enabled=!this.disableMovements.rotate,this.disableMovements.rotate&&Q0(e.rotate.matrix))}static activatesFor(e,t){const n=r6(t,e.navigation.gamepad,qlt);return!(t.action==="end"||jR(n))}};f([y({constructOnly:!0})],M0.prototype,"gamepadDevice",void 0),f([y({constructOnly:!0})],M0.prototype,"disableMovements",void 0),M0=f([ge("esri.views.3d.state.controllers.GamepadKeyboardController")],M0);const qlt={translation:[0,0,0],heading:0,tilt:0,zoom:0},Dpe=80,Klt=zi(Dpe),bZ=.75,Ylt=5,Xlt=zi(30),Zlt=zi(80),r_={zoom:0,ascend:0,pan:{enabled:!1,matrix:St()},rotate:{enabled:!1,matrix:St()}},yl=q(),kT=q(),Qlt=u7();function Jlt(i){i.zoom=0,i.ascend=0,i.pan.enabled=!1,Q0(i.pan.matrix),i.rotate.enabled=!1,Q0(i.rotate.matrix)}let ect=class extends sr{constructor(e){super(!0),this._view=e,this._watchHandles=new mi,this._handle=this.registerIncoming("gamepad",t=>this._handleEventGamepad(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([ue(()=>this._view.navigation.gamepad.enabled,t=>{t?this._handle.resume():(this._handle.pause(),this._cameraControllerGamepad&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null))},At),ue(()=>this._view.navigation.gamepad.device,t=>{this._cameraControllerGamepad&&t&&this._cameraControllerGamepad.gamepadDevice!==t&&(this._cameraControllerGamepad.finishController(),this._cameraControllerGamepad=null)})])}onUninstall(){this._watchHandles.removeAll(),super.onUninstall()}_handleEventGamepad(e){const t=this._view.navigation.gamepad.device;if(t&&e.data.device!==t)return;const n=this._cameraControllerGamepad&&this._cameraControllerGamepad.active;if(n||M0.activatesFor(this._view,e.data)){if(!n){const r=new M0({view:this._view,gamepadDevice:e.data.device});this._view.state.switchCameraController(r)&&(this._cameraControllerGamepad=r)}this._cameraControllerGamepad&&this._cameraControllerGamepad.active&&this._cameraControllerGamepad.gamepadDevice===e.data.device&&this._cameraControllerGamepad.handleEventGamepad(e.data)}}};var bc;(function(i){i[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT",i[i.FORWARD=2]="FORWARD",i[i.BACKWARD=3]="BACKWARD",i[i.UP=4]="UP",i[i.DOWN=5]="DOWN",i[i.HEADINGLEFT=6]="HEADINGLEFT",i[i.HEADINGRIGHT=7]="HEADINGRIGHT",i[i.TILTUP=8]="TILTUP",i[i.TILTDOWN=9]="TILTDOWN",i[i.ZOOMIN=10]="ZOOMIN",i[i.ZOOMOUT=11]="ZOOMOUT"})(bc||(bc={}));let tct=class extends sr{constructor(e,t){super(!0),this._view=e,this._disableMovements={pan:!0,zoom:!1,ascend:!0,rotate:!1,mode:Ot.Local},this._keyToNumber={[t.left]:bc.LEFT,[t.right]:bc.RIGHT,[t.forward]:bc.FORWARD,[t.backward]:bc.BACKWARD,[t.up]:bc.UP,[t.down]:bc.DOWN,[t.headingLeft]:bc.HEADINGLEFT,[t.headingRight]:bc.HEADINGRIGHT,[t.tiltUp]:bc.TILTUP,[t.tiltDown]:bc.TILTDOWN,[t.zoomIn]:bc.ZOOMIN,[t.zoomOut]:bc.ZOOMOUT},this.registerIncoming("key-down",null,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",null,n=>this._handleKeyUp(n)),this.registerIncoming("blur",null,()=>this._handleBlur())}_handleKeyDown(e){if(e.data.native.ctrlKey||e.data.native.metaKey)return;const t=this._keyToNumber[e.data.key];t!=null&&(this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active||(this._cameraControllerKeyboard=new M0({view:this._view,disableMovements:this._disableMovements}),this._view.state.switchCameraController(this._cameraControllerKeyboard)),this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.activateDirection(t),e.stopPropagation()))}_handleBlur(){this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.finishController(),this._cameraControllerKeyboard=null)}_handleKeyUp(e){if(e.data.native.ctrlKey||e.data.native.metaKey)return;const t=this._keyToNumber[e.data.key];t!=null&&this._cameraControllerKeyboard&&this._cameraControllerKeyboard.active&&(this._cameraControllerKeyboard.deactivateDirection(t),e.stopPropagation())}},ict=class extends sr{constructor(e,t){super(!0),this._view=e,this.registerIncoming("mouse-wheel",t,n=>this._handleMouseWheel(n))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled)return;const t=e.data;this._cameraController&&this._cameraController.active||(this._cameraController=this._view.state.isGlobal?new j$({view:this._view,mode:"interaction"}):new q$({view:this._view,mode:"interaction"}),this._view.state.switchCameraController(this._cameraController)),this._cameraController.zoomStep(-1/60*t.deltaY,Fn(t.x,t.y)),e.preventDefault(),e.stopPropagation()}},J$=class{constructor(e){this._gain=e}reset(e){this._value=e}set gain(e){this._gain=e}get value(){return this._value===void 0?0:this._value}update(e){this._value===void 0?this._value=e:this._value=this._gain*e+(1-this._gain)*this._value}},hb=class extends fA{constructor(){super(...arguments),this._beginCamera=new Nn,this._elapsedTimeSec=0,this.constraintOptions={selection:qn.ALL,interactionType:Si.PAN,interactionFactor:0,interactionStartCamera:new Nn,interactionDirection:null,tiltMode:va.TUMBLE}}initialize(){this.constraintOptions.interactionType=this.interactionType,this.viewAnimation=new Qm}get steppingFinished(){return this.momentum.isFinished(this._elapsedTimeSec)}onControllerStart(e){this._beginCamera.copyFrom(e),this.constraintOptions.interactionStartCamera=this._beginCamera,super.onControllerStart(e)}stepController(e,t){t.copyViewFrom(this._beginCamera),this._elapsedTimeSec+=e,this.momentumStep(this._elapsedTimeSec,t),is(this.view,t,this.constraintOptions)}};hb=f([ge("esri.views.3d.state.controllers.momentum.MomentumController")],hb);let AE=class extends hb{constructor(e){super(e),this.interactionType=Si.PAN,this._tmpPan=q()}momentumStep(e,t){const n=this.momentum.value(e);Ye(this._tmpPan,this.momentum.direction,n),t.eye=nt(wZ,t.eye,this._tmpPan),t.center=nt(wZ,t.center,this._tmpPan),this.constraintOptions.interactionDirection=this._tmpPan}};f([y({constructOnly:!0})],AE.prototype,"momentum",void 0),AE=f([ge("esri.views.3d.state.controllers.momentum.PanPlanarMomentumController")],AE);const wZ=q(),nct=q(),BP=q();let aI=class extends hb{constructor(e){super(e),this.interactionType=Si.PAN}momentumStep(e,t){const n=this.momentum.value1(e),r=this.momentum.value2(e);Ge(BP,t.eye),mt(BP,BP),vi(this.momentum.axis2,BP,this.momentum.axis1),ape(t,nct,this.momentum.axis1,n,this.momentum.axis2,r)}};f([y({constructOnly:!0})],aI.prototype,"momentum",void 0),aI=f([ge("esri.views.3d.state.controllers.momentum.PanSphericalMomentumController")],aI);let d0=class extends hb{constructor(e){super(e),this.interactionType=Si.TUMBLE}set center(e){this._set("center",Ts(e))}set axis(e){this._set("axis",Ts(e))}momentumStep(e,t){const n=this.momentum.value(e);Ry(t,this.center,mA(this.axis,n))}};f([y({constructOnly:!0})],d0.prototype,"momentum",void 0),f([y({constructOnly:!0})],d0.prototype,"center",null),f([y({constructOnly:!0})],d0.prototype,"axis",null),d0=f([ge("esri.views.3d.state.controllers.momentum.MomentumController")],d0);let Gw=class extends hb{constructor(e){super(e),this.interactionType=Si.ZOOM,this.constraintOptions.interactionDirection=q()}set zoomCenter(e){this._set("zoomCenter",Ts(e))}momentumStep(e,t){Ge(this.constraintOptions.interactionDirection,t.eye);const n=this.momentum.valueDelta(0,e);o7(t,this.zoomCenter,n,this.view.state.constraints.minimumPoiDistance),this.constraintOptions.interactionDirection=Hm(this.constraintOptions.interactionDirection,t.eye,this.constraintOptions.interactionDirection)}};f([y({constructOnly:!0})],Gw.prototype,"momentum",void 0),f([y({constructOnly:!0})],Gw.prototype,"zoomCenter",null),Gw=f([ge("esri.views.3d.state.controllers.momentum.ZoomPlanarMomentumController")],Gw);let V_=class extends hb{constructor(e){super(e),this.interactionType=Si.ZOOM,this.radius=0,this._tmpSceneCenter=q(),this._tmpZoomAxisAngle=lD(),this._sphere=gf()}set screenCenter(e){this._set("screenCenter",Fn(e[0],e[1]))}set sceneCenter(e){this._set("sceneCenter",Ts(e))}initialize(){this._sphere[3]=this.radius}momentumStep(e,t){const n=this.momentum.valueDelta(0,e);epe(this._sphere,t,n),this.constraintOptions.interactionType=Si.ZOOM,is(this.view,t,this.constraintOptions),gA(this._sphere,t,this.screenCenter,this._tmpSceneCenter),r7(this.sceneCenter,this._tmpSceneCenter,this._tmpZoomAxisAngle),Ry(t,this._sphere,this._tmpZoomAxisAngle),this.constraintOptions.interactionType=Si.PAN}};f([y({constructOnly:!0})],V_.prototype,"momentum",void 0),f([y({constructOnly:!0})],V_.prototype,"screenCenter",null),f([y({constructOnly:!0})],V_.prototype,"sceneCenter",null),f([y({constructOnly:!0})],V_.prototype,"radius",void 0),V_=f([ge("esri.views.3d.state.controllers.momentum.ZoomSphericalMomentumController")],V_);let ah=class{constructor(e){this._gain=e,this.lastValue=void 0,this.filteredDelta=void 0}update(e){if(this.hasLastValue()){const t=this.computeDelta(e);this._updateDelta(t)}this.lastValue=e}reset(){this.lastValue=void 0,this.filteredDelta=void 0}hasLastValue(){return this.lastValue!==void 0}hasFilteredDelta(){return this.filteredDelta!==void 0}computeDelta(e){return this.lastValue===void 0?NaN:e-this.lastValue}_updateDelta(e){this.filteredDelta!==void 0?this.filteredDelta=(1-this._gain)*this.filteredDelta+this._gain*e:this.filteredDelta=e}},hD=class{constructor(e,t,n){this._initialVelocity=e,this._stopVelocity=t,this._friction=n,this._duration=Math.abs(Math.log(Math.abs(this._initialVelocity)/this._stopVelocity)/Math.log(1-this._friction))}get duration(){return this._duration}isFinished(e){return e>this.duration}get friction(){return this._friction}value(e){return this.valueFromInitialVelocity(this._initialVelocity,e)}valueDelta(e,t){const n=this.value(e);return this.value(e+t)-n}valueFromInitialVelocity(e,t){t=Math.min(t,this.duration);const n=1-this.friction;return e*(n**t-1)/Math.log(n)}},rct=class extends hD{constructor(e,t,n,r,s){super(e,t,n),this._sceneVelocity=r,this.direction=s}value(e){return super.valueFromInitialVelocity(this._sceneVelocity,e)}},kpe=class{constructor(e=300,t=12,n=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this.enabled=!0,this._time=new ah(.6),this._screen=[new ah(.4),new ah(.4)],this._scene=[new ah(.6),new ah(.6),new ah(.6)],this._tmpDirection=q()}add(e,t,n){if(this.enabled){if(this._time.hasLastValue()&&this._time.computeDelta(n)<.015)return;this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._scene[0].update(t[0]),this._scene[1].update(t[1]),this._scene[2].update(t[2]),this._time.update(n)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._scene[0].reset(),this._scene[1].reset(),this._scene[2].reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta()||!this._time.hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,n=e==null||t==null?0:Math.sqrt(e*e+t*t),r=this._time.filteredDelta,s=r==null||n==null?0:n/r;return Math.abs(s)<this._minimumInitialVelocity?null:this.createMomentum(s,this._stopVelocity,this._friction)}createMomentum(e,t,n){je(this._tmpDirection,this._scene[0].filteredDelta??0,this._scene[1].filteredDelta??0,this._scene[2].filteredDelta??0);const r=Et(this._tmpDirection);r>0&&Ye(this._tmpDirection,this._tmpDirection,1/r);const s=this._time.filteredDelta;return new rct(e,t,n,s==null?0:r/s,this._tmpDirection)}},xZ=class{constructor(e){this._gain=e}update(e){this.filteredValue!==void 0?this.filteredValue=(1-this._gain)*this.filteredValue+this._gain*e:this.filteredValue=e}reset(){this.filteredValue=void 0}get hasFilteredValue(){return this.filteredValue!==void 0}};const CZ=1e-5;let sct=class extends hD{constructor(e,t,n,r,s,a=0,o){super(e,t,n),this._angularVelocity1=r,this.axis1=s,this.angularVelocity2=a,this.axis2=o}value1(e){return super.valueFromInitialVelocity(this._angularVelocity1,e)}value2(e){return super.valueFromInitialVelocity(this.angularVelocity2,e)}},act=class{constructor(e=300,t=12,n=.84){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this.enabled=!0,this._tmpAxis1=q(),this._tmpAxis2=q(),this._tmpAngles=xt(),this._time=new ah(.3),this._screen=[new ah(.4),new ah(.4)],this._angle1=new xZ(.6),this._angle2=new xZ(.6),this._axis1=q(),this._axis2=q(),this._lastScene=q()}addMomentumDirectRotation(e,t,n,r,s,a){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(n)<.01)return;let o=rpe(this._lastScene,t,this._tmpAxis2,r,s,a);this._angle2.update(0),dd(this._tmpAxis2)<CZ?o=0:mt(this._axis1,this._tmpAxis2),this._angle1.update(o),Ge(this._lastScene,t)}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._time.update(n)}}addMomentumPreserveHeading(e,t,n,r,s,a,o){if(this.enabled){if(this._time.hasLastValue()){if(this._time.computeDelta(n)<.01)return;spe(this._lastScene,t,this._tmpAxis2,this._tmpAxis1,this._tmpAngles,r,s,a,o,!1),dd(this._tmpAxis2)<CZ?(this._angle1.update(0),this._angle2.update(0)):(this._angle1.update(this._tmpAngles[1]),this._angle2.update(this._tmpAngles[0]),mt(this._axis1,this._tmpAxis1),mt(this._axis2,this._tmpAxis2)),Ge(this._lastScene,t)}this._screen[0].update(e[0]),this._screen[1].update(e[1]),this._time.update(n)}}reset(){this._screen[0].reset(),this._screen[1].reset(),this._angle1.reset(),this._angle2.reset(),this._time.reset()}evaluateMomentum(){if(!this.enabled||!this._screen[0].hasFilteredDelta())return null;const e=this._screen[0].filteredDelta,t=this._screen[1].filteredDelta,n=e==null||t==null?null:Math.sqrt(e*e+t*t),r=this._time.filteredDelta,s=n==null||r==null?0:n/r;return Math.abs(s)<this._minimumInitialVelocity?null:this.createMomentum(s,this._stopVelocity,this._friction)}createMomentum(e,t,n){const r=this._time.filteredDelta,s=this._angle1.filteredValue,a=this._angle2.filteredValue,o=r==null||a==null?0:a/r;return new sct(e,t,n,r==null||s==null?0:s/r,this._axis1,o,this._axis2)}},Fpe=class{constructor(e=2.5,t=.01,n=.95,r=12){this._minimumInitialVelocity=e,this._stopVelocity=t,this._friction=n,this._maxVelocity=r,this.enabled=!0,this.value=new ah(.8),this.time=new ah(.3)}add(e,t){if(this.enabled&&t!=null){if(this.time.hasLastValue()){if(this.time.computeDelta(t)<.01)return;if(this.value.hasFilteredDelta()){const n=this.value.computeDelta(e);this.value.filteredDelta*n<0&&this.value.reset()}}this.time.update(t),this.value.update(e)}}reset(){this.value.reset(),this.time.reset()}evaluateMomentum(){if(!this.enabled||!this.value.hasFilteredDelta()||!this.time.hasFilteredDelta())return null;let e=this.value.filteredDelta/this.time.filteredDelta;return e=lt(e,-this._maxVelocity,this._maxVelocity),Math.abs(e)<this._minimumInitialVelocity?null:this.createMomentum(e,this._stopVelocity,this._friction)}createMomentum(e,t,n){return new hD(e,t,n)}},Npe=class extends Fpe{constructor(e=3,t=.01,n=.95,r=12){super(e,t,n,r)}add(e,t){const n=this.value.lastValue;if(n!=null){let r=e-n;for(;r>Math.PI;)r-=2*Math.PI;for(;r<-Math.PI;)r+=2*Math.PI;e=n+r}super.add(e,t)}},oct=class extends hD{constructor(e,t,n){super(e,t,n)}value(e){const t=super.value(e);return Math.exp(t)}valueDelta(e,t){const n=super.value(e),r=super.value(e+t)-n;return Math.exp(r)}},Vpe=class extends Fpe{constructor(e=2.5,t=.01,n=.95,r=12){super(e,t,n,r)}add(e,t){super.add(Math.log(e),t)}createMomentum(e,t,n){return new oct(e,t,n)}},N6=class extends Bp{constructor(){super(...arguments),this._smoothRotation=new J$(.05),this._rotationAxis=q(),this._panningPlane=Dr(),this._smoothScaling=new J$(.05),this._zoomCenterScreen=Fn(),this._zoomMomentumEstimator=new Vpe,this._rotationMomentumEstimator=new Npe,this._panSphericalMomentumEstimator=new act,this._panPlanarMomentumEstimator=new kpe,this._adjustedSphere=gf(),this._tmp3d=q(),this._tmpScreenPointArray=Fn(),this._beginScreenPoint=Fn(),this._beginScenePoint=q(),this._screenPickPoint=Fn(),this._mode=$a.Horizontal,this._tmpInteractionDirection=q(),this._constraintOptions={selection:qn.ALL,interactionType:Si.NONE,interactionFactor:0,interactionStartCamera:new Nn,interactionDirection:null,tiltMode:va.TUMBLE}}get _intersectionHelper(){return this.view.sceneIntersectionHelper}begin(e){if(!this.active)return;const t=this.view.navigation.momentumEnabled;this._zoomMomentumEstimator.enabled=t,this._rotationMomentumEstimator.enabled=t,this._panPlanarMomentumEstimator.enabled=t,this._panSphericalMomentumEstimator.enabled=t,this._beginHeading=-py.normalize(zi(this.view.camera.heading)),this._beginRadius=e.radius,this._pointerCount=e.pointers.size,this._beginAngle=e.angle,this._smoothRotation.reset(),Ep(e.center,this._screenPickPoint),Zs(this._beginScreenPoint,this._screenPickPoint);const n=rn(this.view.spatialReference),r=ipe(this._intersectionHelper,this.startCamera,this._screenPickPoint,n,vC.Silhouette);B(r.scenePickPoint)||(this._scenePickPoint=r.scenePickPoint,this._sphere=r.sphere,Ge(this._beginScenePoint,this._scenePickPoint),this._mode=cD(this.startCamera,this._screenPickPoint,r.hasGeometryIntersection,n),this._mode===$a.Vertical&&this._preparePlanarPanMode(e),this._constraintOptions.interactionStartCamera.copyFrom(this.startCamera))}update(e){if(!this.active)return;this.currentCamera.copyFrom(this.startCamera);const t=e.pointers.size>1;this._mode===$a.Horizontal?(t&&this._zoomSpherical(e),this._panningSpherical(e),t&&this._rotateSpherical(e)):(t&&this._zoomPlanar(e),this._panningPlanar(e),t&&this._rotatePlanar(e)),this.commitCamera()}end(e){e.pointers.size===this._pointerCount&&this.update(e),this.finishController();const t=this._zoomMomentumEstimator.evaluateMomentum();if(t)return this._mode===$a.Horizontal?new V_({view:this.view,momentum:t,screenCenter:this._zoomCenterScreen,sceneCenter:this._beginScenePoint,radius:this._sphere[3]}):new Gw({view:this.view,momentum:t,zoomCenter:this._beginScenePoint});const n=this._rotationMomentumEstimator.evaluateMomentum();if(n)return new d0({view:this.view,momentum:n,center:this._sphere,axis:this._rotationAxis});if(this._mode===$a.Horizontal){const r=this._panSphericalMomentumEstimator.evaluateMomentum();if(r)return new aI({view:this.view,momentum:r})}else{const r=this._panPlanarMomentumEstimator.evaluateMomentum();if(r)return new AE({view:this.view,momentum:r})}return null}_preparePlanarPanMode(e){const t=No(this._tmp3d,this.startCamera.viewForward);Gx(this._scenePickPoint,t,this._panningPlane);const n=Fn(this._screenPickPoint[0],0),r=q(),s=Et(this.startCamera.eye);this._adjustedSphere[3]=s<this._sphere[3]?s-100:this._sphere[3],gA(this._adjustedSphere,this.startCamera,n,r);const a=pa();this.startCamera.projectToRenderScreen(r,a);const o=.9*a[1];this._screenPickPoint[1]=Math.min(this._screenPickPoint[1],o);const l=this._intersectionHelper.intersectScreen(this._screenPickPoint,this._scenePickPoint);l&&Gx(this._scenePickPoint,ro(this._panningPlane),this._panningPlane);const c=q(),u=q(),d=q(),h=80,p=5,m=50;nt(c,this._scenePickPoint,this.currentCamera.eye);const g=Et(c);mt(c,c);const _=p*Math.max(Math.abs(this.view.camera.position.z),m),b=this.view._stage.renderView.getMinimalDepthForArea(null,this._screenPickPoint[0],this._screenPickPoint[1],this.view.state.camera,h);let x=T(b)?Math.min(b,_):_;x=l?Math.min(x,g):x,Ge(d,rt(u,this.currentCamera.eye,Ye(u,c,x))),this._panningPlane[3]=-dt(this._panningPlane,d),this.startCamera.center=rt(u,this.startCamera.eye,Ye(u,this.startCamera.viewForward,x));const w=Ep(e.center,this._tmpScreenPointArray);I6(this._panningPlane,this.startCamera,w,this._beginScenePoint)}_zoomSpherical(e){const t=this._beginRadius/e.radius,n=.001875*Math.min(Math.max(e.radius,40),120);this._smoothScaling.gain=n,this._smoothScaling.update(t),epe(this._sphere,this.currentCamera,this._smoothScaling.value),Ep(e.center,this._zoomCenterScreen),this._zoomMomentumEstimator.add(this._smoothScaling.value,.001*e.timestamp),this._constraintOptions.interactionType=Si.ZOOM,this._constraintOptions.interactionFactor=sh(e.radius-this._beginRadius),is(this.view,this.currentCamera,this._constraintOptions)}_panningSpherical(e){const t=Ep(e.center,this._tmpScreenPointArray);gA(this._sphere,this.currentCamera,t,this._tmp3d),l7(this._beginScenePoint,dt(this.currentCamera.up,this._beginScenePoint),this._sphere[3],this._beginHeading,this.view.camera.tilt,this.startCamera)?(lpe(this._sphere,this.currentCamera,this._beginScenePoint,this._tmp3d,this._beginHeading,this.view.camera.tilt,!1),this._panSphericalMomentumEstimator.addMomentumPreserveHeading(t,this._tmp3d,.001*e.timestamp,this.startCamera,this._sphere,this._beginHeading,this.view.camera.tilt)):(ope(this._sphere,this.currentCamera,this._beginScenePoint,this._tmp3d,this.view.camera.tilt,!1),this._panSphericalMomentumEstimator.addMomentumDirectRotation(t,this._tmp3d,.001*e.timestamp,this.startCamera,this._sphere[3],this.view.camera.tilt)),this._constraintOptions.interactionType=Si.PAN,this._constraintOptions.interactionFactor=sh(sf(this._screenPickPoint,t)),is(this.view,this.currentCamera,this._constraintOptions)}_rotateSpherical(e){mt(this._rotationAxis,this._scenePickPoint),this.currentCamera.aboveGround||No(this._rotationAxis,this._rotationAxis);const t=this._smoothRotation.value,n=t+R6(e.angle-t),r=.00125*Math.min(Math.max(e.radius,40),120);this._smoothRotation.gain=r,this._smoothRotation.update(n);const s=this._smoothRotation.value-this._beginAngle;this._rotationMomentumEstimator.add(s,.001*e.timestamp),Ry(this.currentCamera,this._sphere,mA(this._rotationAxis,s)),this._constraintOptions.interactionType=Si.TUMBLE,this._constraintOptions.interactionFactor=sh(e.radius*n),is(this.view,this.currentCamera,this._constraintOptions)}_panningPlanar(e){const t=Ep(e.center,this._tmpScreenPointArray);I6(this._panningPlane,this.currentCamera,t,this._tmp3d)&&(npe(this.currentCamera,this._beginScenePoint,this._tmp3d),this._panPlanarMomentumEstimator.add(t,this._tmp3d,.001*e.timestamp),this._constraintOptions.interactionType=Si.PAN,this._constraintOptions.interactionFactor=sh(sf(this._beginScreenPoint,t)),this._constraintOptions.interactionDirection=this.view.renderCoordsHelper.worldUpAtPosition(this.currentCamera.eye,this._tmpInteractionDirection),is(this.view,this.currentCamera,this._constraintOptions),this._constraintOptions.interactionDirection=null)}_zoomPlanar(e){const t=this._beginRadius/e.radius,n=.001875*Math.min(Math.max(e.radius,40),120);this._smoothScaling.gain=n,this._smoothScaling.update(t),this._zoomMomentumEstimator.add(this._smoothScaling.value,.001*e.timestamp),o7(this.currentCamera,this._beginScenePoint,this._smoothScaling.value,this.view.state.constraints.minimumPoiDistance),this._constraintOptions.interactionType=Si.ZOOM,this._constraintOptions.interactionFactor=sh(e.radius-this._beginRadius),is(this.view,this.currentCamera,this._constraintOptions)}_rotatePlanar(e){Ge(this._rotationAxis,this._beginScenePoint),this.currentCamera.aboveGround||No(this._rotationAxis,this._rotationAxis);const t=this._smoothRotation.value;let n=e.angle-t;n=R6(n);const r=t+n,s=.00125*Math.min(Math.max(e.radius,40),120);this._smoothRotation.gain=s,this._smoothRotation.update(r);const a=this._smoothRotation.value-this._beginAngle;this._rotationMomentumEstimator.add(a,.001*e.timestamp),Ry(this.currentCamera,this._sphere,mA(this._rotationAxis,a)),this._constraintOptions.interactionType=Si.TUMBLE,this._constraintOptions.interactionFactor=sh(e.radius*a),is(this.view,this.currentCamera,this._constraintOptions)}};N6=f([ge("esri.views.3d.state.controllers.global.PinchAndPanController")],N6);const TZ=Gt(0,0,1),lct={ELEVATION_THRESHOLD:3e4,ANGLE_THRESHOLD:16/180*Math.PI},cct=80;let V6=class extends Bp{constructor(){super(...arguments),this._rotationValueSmooth=new J$(.05),this._scalingValueSmooth=new J$(.05),this._planeHorizontal=Dr(),this._planeVertical=Dr(),this._rotationMomentumEstimator=new Npe,this._panMomentumEstimator=new kpe(300,12,.9),this._zoomMomentumEstimator=new Vpe,this._beginCenter=q(),this._tmpPoints=[],this._beginCenterScreen=Fn(),this._tmpCentroid3d=q(),this._tmpCentroid2d=Fn(),this._tmp2d=Fn(),this._constraintOptions={selection:qn.ALL,interactionType:Si.NONE,interactionFactor:0,interactionStartCamera:new Nn,interactionDirection:null,tiltMode:va.TUMBLE}}begin(e){if(!this.active)return;const t=this.view.navigation.momentumEnabled;this._zoomMomentumEstimator.enabled=t,this._rotationMomentumEstimator.enabled=t,this._panMomentumEstimator.enabled=t,this._beginRadius=e.radius,this._pointerCount=e.pointers.size,this._beginAngle=e.angle,this._rotationValueSmooth.reset(),this._scalingValueSmooth.reset(),Ep(e.center,this._beginCenterScreen),gne(TZ,0,this._planeHorizontal);const n=q(),r=this._intersectionHelper.intersectScreenFreePointFallback(this._beginCenterScreen,n),s=q();No(s,this.startCamera.viewForward);const a=q();Ge(a,TZ);const o=dt(s,a),l=nf(o<0?-o:o);if(this._panMode=l>=lct.ANGLE_THRESHOLD?$a.Horizontal:$a.Vertical,qN(this._planeHorizontal,this._planeHorizontal,n),this.startCamera.aboveGround||KN(this._planeHorizontal,this._planeHorizontal),this._panMode===$a.Vertical){Ye(a,a,o),nt(this._planeVertical,s,a),mt(this._planeVertical,this._planeVertical),qN(this._planeVertical,this._planeVertical,n);const c=q(),u=q(),d=q();nt(c,n,this.currentCamera.eye);const h=Et(c);mt(c,c);const p=5*Math.max(Math.abs(this.view.camera.position.z),50),m=this.view._stage.renderView.getMinimalDepthForArea(this.view.voxelWasm,this._beginCenterScreen[0],this._beginCenterScreen[1],this.view.state.camera,cct);let g=T(m)?Math.min(m,p):p;g=r?Math.min(g,h):g,Ge(d,rt(u,this.currentCamera.eye,Ye(u,c,g))),this._planeVertical[3]=-dt(this._planeVertical,d),this._computePlanePoints(e.pointers,this._planeVertical,this.startCamera,this._tmpPoints),PF(this._tmpPoints,this._beginCenter)}else this._computePlanePoints(e.pointers,this._planeHorizontal,this.startCamera,this._tmpPoints),PF(this._tmpPoints,this._beginCenter);this._constraintOptions.interactionStartCamera.copyFrom(this.startCamera)}update(e){if(!this.active)return;this.currentCamera.copyFrom(this.startCamera);const t=e.pointers.size>1,n=this._panMode===$a.Horizontal?this._planeHorizontal:this._planeVertical,r=this._beginCenter;if(t){const s=this._beginRadius/e.radius,a=.001875*Math.min(Math.max(e.radius,40),120);this._scalingValueSmooth.gain=a,this._scalingValueSmooth.update(s),o7(this.currentCamera,r,this._scalingValueSmooth.value,this.view.state.constraints.minimumPoiDistance),this._zoomMomentumEstimator.add(this._scalingValueSmooth.value,.001*e.timestamp),this._constraintOptions.interactionType=Si.ZOOM,this._constraintOptions.interactionFactor=sh(Math.abs(e.radius-this._beginRadius)),is(this.view,this.currentCamera,this._constraintOptions)}if(this._computePlanePoints(e.pointers,n,this.currentCamera,this._tmpPoints),PF(this._tmpPoints,this._tmpCentroid3d),Ep(e.center,this._tmpCentroid2d),npe(this.currentCamera,r,this._tmpCentroid3d),this._panMomentumEstimator.add(this._tmpCentroid2d,this._tmpCentroid3d,.001*e.timestamp),this._constraintOptions.interactionType=Si.PAN,this._constraintOptions.interactionFactor=sh(sf(this._beginCenterScreen,this._tmpCentroid2d)),is(this.view,this.currentCamera,this._constraintOptions),t){const s=this._planeHorizontal,a=r,o=this._rotationValueSmooth.value,l=o+R6(e.angle-o),c=.00125*Math.min(Math.max(e.radius,40),120);this._rotationValueSmooth.gain=c,this._rotationValueSmooth.update(l);const u=this._rotationValueSmooth.value-this._beginAngle;this._rotationMomentumEstimator.add(u,.001*e.timestamp),Ry(this.currentCamera,a,mA(s,u)),this._constraintOptions.interactionType=Si.TUMBLE,this._constraintOptions.interactionFactor=sh(Math.abs(e.radius*u)),is(this.view,this.currentCamera,this._constraintOptions)}this.commitCamera()}end(e){e.pointers.size===this._pointerCount&&this.update(e),this.finishController();const t=this._zoomMomentumEstimator.evaluateMomentum();if(t)return new Gw({view:this.view,momentum:t,zoomCenter:this._beginCenter});const n=this._rotationMomentumEstimator.evaluateMomentum();if(n)return new d0({view:this.view,momentum:n,center:this._beginCenter,axis:ro(this._planeHorizontal)});const r=this._panMomentumEstimator.evaluateMomentum();return r?new AE({view:this.view,momentum:r}):null}_computePlanePoints(e,t,n,r){r.length=e.size;const s=this._tmp2d;let a=0;return e.forEach(o=>{s[0]=o.x,s[1]=o.y,r[a]===void 0&&(r[a]=q()),I6(t,n,s,r[a]),a+=1}),r}get _intersectionHelper(){return this.view.sceneIntersectionHelper}};V6=f([ge("esri.views.3d.state.controllers.local.PinchAndPanController")],V6);let SZ=class extends sr{constructor(e,t,n){super(!0),this._view=e,this.pointerAction=t,this._lastEndTimestamp=0,this._lastTimestamp=0,this.registerIncoming("drag",n,r=>this._handleDrag(r))}_handleDrag(e){if(e.data.pointerType==="mouse"&&!AU(e.data,this.pointerAction))return;const t=e.timestamp-this._lastEndTimestamp,n=40,r=this._momentum&&this._momentum.active&&t<n;switch(e.data.action){case"start":case"update":if(r)break;this._controller&&this._controller.active?e.data.timestamp-this._lastTimestamp>2&&(this._controller.update(e.data),this._lastTimestamp=e.timestamp):this._startController(e);break;case"end":case"removed":this._endController(e,!0);break;case"added":this._endController(e,!1),this._startController(e)}e.stopPropagation()}_endController(e,t){if(this._controller&&this._controller.active){this._lastEndTimestamp=e.timestamp;const n=this._controller.end(e.data);t&&n&&(this._momentum=n,this._view.state.switchCameraController(this._momentum))}this._controller=null}_startController(e){this._controller=this._createController(),this._view.state.switchCameraController(this._controller),this._controller.begin(e.data),this._lastTimestamp=e.timestamp}_createController(){return this._view.state.isGlobal?new N6({view:this._view}):new V6({view:this._view})}},uct=class extends sr{constructor(e,t){super(!0),this.view=e,this.registerIncoming("pointer-down",t,()=>this.view.state.stopActiveCameraController())}},Bpe=class extends sr{constructor(e,t){super(!0),this.key=e,this.registerIncoming("key-down",t,n=>this._handleKeyDown(n))}_handleKeyDown(e){e.data.key===this.key&&(this.activate(),e.stopPropagation())}},dct=class extends Bpe{constructor(e,t,n){super(t,n),this.view=e}activate(){this.view.goTo({heading:0}).catch(()=>{})}},hct=class extends Bpe{constructor(e,t,n){super(t,n),this.view=e}activate(){this.view.goTo({tilt:0}).catch(()=>{})}},pct=class extends sr{constructor(e,t=!1){super(!0),this._view=e,this._invert=t,this.registerIncoming("vertical-two-finger-drag",n=>this._handleTwoFinger(n))}_handleTwoFinger(e){var r,s,a;const t=this._invert?-1:1,n=Fn(0,e.data.delta*t);switch(e.data.action){case"begin":(r=this._cameraController)==null||r.end(),this._cameraController=new EE({view:this._view,pivot:Ec.CENTER}),this._view.state.switchCameraController(this._cameraController),this._cameraController.begin(n);break;case"update":(s=this._cameraController)==null||s.update(n);break;case"end":(a=this._cameraController)==null||a.end(),this._cameraController=null}}},fct=class extends sr{constructor(e=20,t=40){super(!1),this._threshold=e,this._maxDelta=t,this._state="ready",this._emittedArtificalEnd2=!1,this._vertical=this.registerOutgoing("vertical-two-finger-drag"),this._artificalDrag=this.registerOutgoing("drag"),this._dragEventSeparator=new mM({start:(n,r)=>this._observeStart(n,r),update:(n,r,s)=>this._observeUpdate(n,r,s),end:(n,r)=>this._observeEnd(r)}),this.registerIncoming("drag",n=>this._dragEventSeparator.handle(n))}get failed(){return this._state==="failed"}_observeStart(e,t){e===1&&this._emittedArtificalEnd2&&(this._emittedArtificalEnd2=!1,this._artificalDrag.emit({action:"start",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),t.stopPropagation()),this._state=e===2?"ready":"failed"}_observeUpdate(e,t,n){if(this._state!=="failed"&&e===2)return this._state==="active"?(this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"update"}),void t.stopPropagation()):void(this._checkMovementWithinLimits(t.data,n.data)?this._checkVerticalThresholdReached(t.data,n.data)&&(this._state="active",this._emittedArtificalEnd2=!0,this._thresholdReachedCenter=t.data.center,this._artificalDrag.emit({action:"end",button:t.data.button,buttons:t.data.buttons,pointerType:t.data.pointerType,timestamp:t.data.timestamp,pointers:t.data.pointers,pointer:t.data.pointer,angle:t.data.angle,radius:t.data.radius,center:t.data.center}),this._vertical.emit({delta:t.data.center.y-this._thresholdReachedCenter.y,action:"begin"}),t.stopPropagation()):this._state="failed")}_observeEnd(e){this._state==="active"&&(this._vertical.emit({delta:e.data.center.y-this._thresholdReachedCenter.y,action:"end"}),this._state="ready",e.stopPropagation())}_checkMovementWithinLimits(e,t){let n=-1/0,r=1/0,s=-1/0,a=1/0;for(const{x:g,y:_}of t.pointers.values())n=Math.max(n,g),r=Math.min(r,g),s=Math.max(s,_),a=Math.min(a,_);let o=-1/0,l=1/0,c=-1/0,u=1/0;for(const{x:g,y:_}of e.pointers.values())o=Math.max(o,g),l=Math.min(l,g),c=Math.max(c,_),u=Math.min(u,_);const d=n-r,h=s-a,p=o-l,m=c-u;return Math.abs(e.center.x-t.center.x)<this._threshold&&Math.abs(p-d)<=this._maxDelta&&Math.abs(m-h)<=this._maxDelta}_checkVerticalThresholdReached(e,t){let n=Math.abs(e.center.y-t.center.y);return e.pointers.forEach((r,s)=>{const a=t.pointers.get(s);n=Math.min(n,Math.abs(r.y-a.y))}),n>=this._threshold}},jd=class extends et{constructor(){super(...arguments),this._handles=new mi}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this.disconnect()}get primaryDragAction(){return this._get("primaryDragAction")}set primaryDragAction(e){e!=="pan"&&e!=="rotate"||e===this._get("primaryDragAction")||(this._set("primaryDragAction",e),this._updateMode())}get mode(){return this._get("mode")}set mode(e){e!=="default"&&e!=="pro"||e===this._get("mode")||(this._set("mode",e),this._updateMode())}get hasPendingInputs(){var e;return(e=this._inputManager)==null?void 0:e.hasPendingInputs}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}disconnect(){this.view.viewEvents.disconnect(),this._inputManager=_t(this._inputManager)}connect(){const e=this.view;this._source=new J3(this.view.surface,e.input);const t=[new Rde,new Ide,new Mde,new Pde(this.view.navigation),new fct],n=new Zd({eventSource:this._source,recognizers:t});this._inputManager=n,n.installHandlers("prevent-context-menu",[new Ade],Pt.INTERNAL),this._modeDragPan=new SZ(e,"primary"),this._modeDragRotate=new BF(e,"secondary",Ec.CENTER),this._modeDragZoom=new jlt(e,"tertiary");const r={lookAround:"b",pan:{left:"ArrowLeft",right:"ArrowRight",forward:"ArrowUp",backward:"ArrowDown",up:"u",down:"j",headingLeft:"a",headingRight:"d",tiltUp:"w",tiltDown:"s",zoomIn:"+",zoomOut:"-"},resetHeading:"n",resetTilt:"p"};n.installHandlers("navigation",[new uct(e),new Vot(e),new ect(e),new tct(e,r.pan),new ict(e),new hct(e,r.resetTilt),new dct(e,r.resetHeading),new BF(e,"primary",Ec.EYE,[r.lookAround]),new BF(e,"secondary",Ec.CENTER,[r.lookAround]),new SZ(e,"tertiary",[r.lookAround]),this._modeDragRotate,this._modeDragZoom,this._modeDragPan,new pct(e)],Pt.INTERNAL),this.view.viewEvents.connect(n),this._updateMode(),this._handles.add(ue(()=>{var s;return(s=this.view.navigation)==null?void 0:s.browserTouchPanEnabled},s=>{this._source.browserTouchPanningEnabled=!s},At))}_updateMode(){const e=this.mode,t=this.primaryDragAction,n=B6.get(e).get(t);this._modeDragPan&&(this._modeDragPan.pointerAction=n.pan),this._modeDragRotate&&(this._modeDragRotate.pointerAction=n.rotate),this._modeDragZoom&&(this._modeDragZoom.pointerAction=n.zoom)}get test(){return{inputManager:this._inputManager,modeDragPan:this._modeDragPan,modeDragRotate:this._modeDragRotate,modeDragZoom:this._modeDragZoom}}};f([y()],jd.prototype,"view",void 0),f([y({value:"pan"})],jd.prototype,"primaryDragAction",null),f([y({value:"default"})],jd.prototype,"mode",null),f([y({readOnly:!0})],jd.prototype,"hasPendingInputs",null),f([y()],jd.prototype,"latestPointerType",null),f([y()],jd.prototype,"latestPointerLocation",null),f([y()],jd.prototype,"multiTouchActive",null),f([y()],jd.prototype,"_inputManager",void 0),jd=f([ge("esri.views.3d.input.SceneInputManager")],jd);const B6=new Map,zF=new Map,UF=new Map;zF.set("pan",{pan:"primary",rotate:"secondary",zoom:"tertiary"}),zF.set("rotate",{pan:"secondary",rotate:"primary",zoom:"tertiary"}),UF.set("pan",{pan:"primary",rotate:"tertiary",zoom:"secondary"}),UF.set("rotate",{pan:"tertiary",rotate:"primary",zoom:"secondary"}),B6.set("default",zF),B6.set("pro",UF);const mct=jd;let mu,Tx,z6=!1,U6=!1,H6=!1,G6=!1,ME=null;function gct(i,e){if(!U6||!Tx)return;zpe();const t=Tx;let n=0;for(let r=0;r<i.accBinsNumX;r++)for(let s=0;s<i.accBinsNumY;s++){const a=i.accBins[r][i.accBinsNumY-1-s];n+=a.length;const o=r*i.accBinsSizeX,l=(r+1)*i.accBinsSizeX,c=s*i.accBinsSizeY,u=(s+1)*i.accBinsSizeY;t.fillText(a.length.toFixed(),o+5,c+15),Upe(o,l,c,u,"blue")}t.fillText("total totalShownLabels: "+n,70,40),t.fillText("total visible labels: "+e.size,70,50),t.fillText("total numTests: "+i.accNumTests,70,30)}function vct(i){H6=cn.DECONFLICTOR_SHOW_VISIBLE,G6=cn.DECONFLICTOR_SHOW_INVISIBLE,z6=H6||G6,U6=cn.DECONFLICTOR_SHOW_GRID,ME=null,z6||U6?ME=()=>yct(i):mu&&(mu.parentElement.removeChild(mu),mu=null)}function zpe(){ME&&(ME(),ME=null)}function yct(i){mu==null&&(mu=document.createElement("canvas"),mu.setAttribute("id","canvas2d"),i.surface.parentElement.style.position="relative",i.surface.parentElement.appendChild(mu));const{state:e}=i,{camera:t,pixelRatio:n}=e,{width:r,height:s}=t,a=r*n,o=s*n;mu.setAttribute("width",`${a}px`),mu.setAttribute("height",`${o}px`),mu.setAttribute("style",`position:absolute;left:0px;top:0px;display:block;pointer-events:none;width:${r}px;height:${s}px`),Tx=mu.getContext("2d"),Tx.clearRect(0,0,r,s),Tx.font="12px Arial"}function Upe(i,e,t,n,r){zpe();const s=mu.height,a=Tx;a.beginPath(),a.lineWidth=1,a.strokeStyle=r,a.moveTo(i,s-t),a.lineTo(e,s-t),a.stroke(),a.lineTo(e,s-n),a.stroke(),a.lineTo(e,s-t),a.stroke(),a.lineTo(i,s-t),a.stroke(),a.lineTo(i,s-t),a.stroke(),a.closePath()}function _ct(i,e){z6&&(e&&H6||!e&&G6)&&Upe(i.aabr[0],i.aabr[2],i.aabr[1],i.aabr[3],e?"green":"red")}var Ia,xu;(function(i){i[i.GRAPHIC=0]="GRAPHIC",i[i.LABEL=1]="LABEL",i[i._COUNT=2]="_COUNT"})(Ia||(Ia={})),function(i){i[i.USER_SETTING=0]="USER_SETTING",i[i.SCALE_RANGE=1]="SCALE_RANGE",i[i.FILTER=2]="FILTER",i[i.DECONFLICTION=3]="DECONFLICTION",i[i._COUNT=4]="_COUNT"}(xu||(xu={}));function bct(i){return i instanceof Float32Array&&i.length>=16}function wct(i){return Array.isArray(i)&&i.length>=16}function xct(i){return bct(i)||wct(i)}let g7=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2,t.spherical=e.viewingMode===Ot.Global}initializeProgram(e){return new gn(e.rctx,g7.shader.get().build(this.configuration),Mn)}_setPipelineState(e){const t=this.configuration,n=e===ln.NONE,r=e===ln.FrontFace,s=this.configuration.hasPolygonOffset&&Cct,a=(n||r)&&t.output!==Re.Highlight?(t.depthEnabled||t.occlusionPass)&&Lu:null;return yi({blending:t.output===Re.Color||t.output===Re.Alpha||t.output===Re.Highlight?n?Tct:Ly(e):null,depthTest:{func:lo.LEQUAL},depthWrite:a,colorWrite:$i,polygonOffset:s})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}get primitiveType(){return this.configuration.occlusionPass?Qi.POINTS:Qi.TRIANGLES}};g7.shader=new bn(z1e,()=>Ee(()=>import("./HUDMaterial.glsl-7dd8cf7c.js"),["./HUDMaterial.glsl-7dd8cf7c.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./floatRGBA-fa8308d2.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./Texture-bbae5d9d.js","./compilerUtils-034cacb8.js","./Error-653283ae.js","./Evented-515b9d9c.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./assets-0b172f07.js","./Matrix3PassUniform-da8eddae.js","./HUD.glsl-80cf9a21.js","./ReadLinearDepth.glsl-7ff30f7d.js","./RgbaFloatEncoding.glsl-6036ca34.js","./VerticalOffset.glsl-86460edb.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./FloatPassUniform-d2dfc562.js","./TransparencyPassType-cd195b0e.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./Slice.glsl-a612de15.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./AlphaCutoff-96178e0d.js"],import.meta.url));const Cct={factor:0,units:-4},Tct=vf(vt.ONE,vt.ONE_MINUS_SRC_ALPHA);let Kr=class extends yf{constructor(){super(...arguments),this.output=Re.Color,this.screenCenterOffsetUnitsEnabled=_y.World,this.transparencyPassType=ln.NONE,this.spherical=!1,this.occlusionTestEnabled=!0,this.signedDistanceFieldEnabled=!1,this.vvSize=!1,this.vvColor=!1,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.debugDrawLabelBorder=!1,this.binaryHighlightOcclusionEnabled=!0,this.hasSlicePlane=!1,this.hasPolygonOffset=!1,this.depthEnabled=!0,this.pixelSnappingEnabled=!0,this.isDraped=!1,this.hasMultipassGeometry=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1}};f([Pe({count:Re.COUNT})],Kr.prototype,"output",void 0),f([Pe({count:_y.COUNT})],Kr.prototype,"screenCenterOffsetUnitsEnabled",void 0),f([Pe({count:ln.COUNT})],Kr.prototype,"transparencyPassType",void 0),f([Pe()],Kr.prototype,"spherical",void 0),f([Pe()],Kr.prototype,"occlusionTestEnabled",void 0),f([Pe()],Kr.prototype,"signedDistanceFieldEnabled",void 0),f([Pe()],Kr.prototype,"vvSize",void 0),f([Pe()],Kr.prototype,"vvColor",void 0),f([Pe()],Kr.prototype,"hasVerticalOffset",void 0),f([Pe()],Kr.prototype,"hasScreenSizePerspective",void 0),f([Pe()],Kr.prototype,"debugDrawLabelBorder",void 0),f([Pe()],Kr.prototype,"binaryHighlightOcclusionEnabled",void 0),f([Pe()],Kr.prototype,"hasSlicePlane",void 0),f([Pe()],Kr.prototype,"hasPolygonOffset",void 0),f([Pe()],Kr.prototype,"depthEnabled",void 0),f([Pe()],Kr.prototype,"pixelSnappingEnabled",void 0),f([Pe()],Kr.prototype,"isDraped",void 0),f([Pe()],Kr.prototype,"hasMultipassGeometry",void 0),f([Pe()],Kr.prototype,"hasMultipassTerrain",void 0),f([Pe()],Kr.prototype,"cullAboveGround",void 0),f([Pe()],Kr.prototype,"occlusionPass",void 0),f([Pe()],Kr.prototype,"objectAndLayerIdColorInstanced",void 0),f([Pe({constValue:!0})],Kr.prototype,"hasSliceInVertexProgram",void 0),f([Pe({constValue:!1})],Kr.prototype,"hasVvInstancing",void 0);let _C=class extends ug{constructor(e){super(e,new Lct),this._configuration=new Kr}getConfiguration(e,t){return this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVerticalOffset=!!this.parameters.verticalOffset,this._configuration.hasScreenSizePerspective=!!this.parameters.screenSizePerspective,this._configuration.screenCenterOffsetUnitsEnabled=this.parameters.centerOffsetUnits==="screen"?_y.Screen:_y.World,this._configuration.hasPolygonOffset=this.parameters.polygonOffset,this._configuration.isDraped=this.parameters.isDraped,this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.pixelSnappingEnabled=this.parameters.pixelSnappingEnabled,this._configuration.signedDistanceFieldEnabled=this.parameters.textureIsSignedDistanceField,this._configuration.vvSize=!!this.parameters.vvSizeEnabled,this._configuration.vvColor=!!this.parameters.vvColorEnabled,this._configuration.occlusionPass=t.slot===at.OCCLUSION_PIXELS&&this.parameters.occlusionTest&&(e===Re.Color||e===Re.Alpha),e===Re.Color&&(this._configuration.debugDrawLabelBorder=!!this.parameters.debugDrawLabelBorder),e===Re.Highlight&&(this._configuration.binaryHighlightOcclusionEnabled=this.parameters.binaryHighlightOcclusion),this._configuration.depthEnabled=this.parameters.depthEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassGeometry=t.multipassGeometry.enabled,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,n,r,s,a,o,l,c){T(c)?this._intersectDrapedHudGeometry(e,a,o,l,c):this._intersectHudGeometry(e,t,n,r,o,l)}_intersectDrapedHudGeometry(e,t,n,r,s){const a=e.vertexAttributes.get(j.POSITION),o=e.vertexAttributes.get(j.SIZE),l=this.parameters,c=pW(l);let u=1,d=1;if(T(r)){const p=r(MZ);u=p[0],d=p[5]}u*=e.screenToWorldRatio,d*=e.screenToWorldRatio;const h=Ict*e.screenToWorldRatio;for(let p=0;p<a.data.length/a.size;p++){const m=p*a.size,g=a.data[m],_=a.data[m+1],b=p*o.size;let x;Vg[0]=o.data[b]*u,Vg[1]=o.data[b+1]*d,l.textureIsSignedDistanceField&&(x=l.outlineSize*e.screenToWorldRatio/2),EZ(t,g,_,Vg,h,x,l,c)&&n(s.dist,s.normal,-1,!1)}}_intersectHudGeometry(e,t,n,r,s,a){if(!r.options.selectionMode||!r.options.hud||ZL(t))return;const o=this.parameters;let l=1,c=1;if(Um(GF,n),T(a)){const x=a(MZ);l=x[0],c=x[5],Act(GF)}const u=e.vertexAttributes.get(j.POSITION),d=e.vertexAttributes.get(j.SIZE),h=e.vertexAttributes.get(j.NORMAL),p=e.vertexAttributes.get(j.AUXPOS1);Ti(u.size>=3);const m=r.point,g=r.camera,_=pW(o);l*=g.pixelRatio,c*=g.pixelRatio;const b=this.parameters.centerOffsetUnits==="screen";for(let x=0;x<u.data.length/u.size;x++){const w=x*u.size;je(mo,u.data[w],u.data[w+1],u.data[w+2]),$t(mo,mo,n);const C=x*d.size;Vg[0]=d.data[C]*l,Vg[1]=d.data[C+1]*c,$t(mo,mo,g.viewMatrix);const S=x*p.size;if(je(qc,p.data[S+0],p.data[S+1],p.data[S+2]),!b&&(mo[0]+=qc[0],mo[1]+=qc[1],qc[2]!==0)){const A=qc[2];mt(qc,mo),nt(mo,mo,Ye(qc,qc,A))}const E=x*h.size;if(je(FT,h.data[E],h.data[E+1],h.data[E+2]),this._normalAndViewAngle(FT,GF,g,WF),this._applyVerticalOffsetTransformationView(mo,WF,g,HF),g.applyProjection(mo,qo),qo[0]>-1){qo[0]=Math.floor(qo[0]),qo[1]=Math.floor(qo[1]),b&&(qc[0]||qc[1])&&(qo[0]+=qc[0],qc[1]!==0&&(qo[1]+=wbe(qc[1],HF.factorAlignment)),g.unapplyProjection(qo,mo)),qo[0]+=this.parameters.screenOffset[0],qo[1]+=this.parameters.screenOffset[1],Pne(Vg,HF.factor,Vg);const A=Rct*g.pixelRatio;let P;if(o.textureIsSignedDistanceField&&(P=o.outlineSize*g.pixelRatio/2),EZ(m,qo[0],qo[1],Vg,A,P,o,_)){const O=r.ray;if($t(AZ,mo,Da(Oct,g.viewMatrix)),qo[0]=m[0],qo[1]=m[1],g.unprojectFromRenderScreen(qo,mo)){const M=q();Ge(M,O.direction);const V=1/Et(M);Ye(M,M,V),s(Gn(O.origin,mo)*V,M,-1,!0,1,AZ)}}}}}computeAttachmentOrigin(e,t){const n=e.vertexAttributes;if(!n)return!1;const r=n.get(j.POSITION),s=e.indices.get(j.POSITION);return jbe(r,s,t)}createBufferWriter(){return new kct(this)}_normalAndViewAngle(e,t,n,r){return xct(t)&&(t=Um(Pct,t)),Lp(r.normal,e,t),$t(r.normal,r.normal,n.viewInverseTransposeMatrix),r.cosAngle=dt(Hpe,$ct),r}_updateScaleInfo(e,t,n){const r=this.parameters;T(r.screenSizePerspective)?XG(n,t,r.screenSizePerspective,e.factor):(e.factor.scale=1,e.factor.factor=0,e.factor.minPixelSize=0,e.factor.paddingPixels=0),T(r.screenSizePerspectiveAlignment)?XG(n,t,r.screenSizePerspectiveAlignment,e.factorAlignment):(e.factorAlignment.factor=e.factor.factor,e.factorAlignment.scale=e.factor.scale,e.factorAlignment.minPixelSize=e.factor.minPixelSize,e.factorAlignment.paddingPixels=e.factor.paddingPixels)}applyShaderOffsetsView(e,t,n,r,s,a,o){const l=this._normalAndViewAngle(t,n,s,WF);return this._applyVerticalGroundOffsetView(e,l,s,o),this._applyVerticalOffsetTransformationView(o,l,s,a),this._applyPolygonOffsetView(o,l,r[3],s,o),this._applyCenterOffsetView(o,r,o),o}applyShaderOffsetsNDC(e,t,n,r,s){return this._applyCenterOffsetNDC(e,t,n,r),T(s)&&Ge(s,r),this._applyPolygonOffsetNDC(r,t,n,r),r}_applyPolygonOffsetView(e,t,n,r,s){const a=r.aboveGround?1:-1;let o=Math.sign(n);o===0&&(o=a);const l=a*o;if(this.parameters.shaderPolygonOffset<=0)return Ge(s,e);const c=lt(Math.abs(t.cosAngle),.01,1),u=1-Math.sqrt(1-c*c)/c/r.viewport[2];return Ye(s,e,l>0?u:1/u),s}_applyVerticalGroundOffsetView(e,t,n,r){const s=Et(e),a=n.aboveGround?1:-1,o=.5*n.computeRenderPixelSizeAtDist(s),l=Ye(mo,t.normal,a*o);return rt(r,e,l),r}_applyVerticalOffsetTransformationView(e,t,n,r){const s=this.parameters;if(!s.verticalOffset||!s.verticalOffset.screenLength){if(s.screenSizePerspective||s.screenSizePerspectiveAlignment){const c=Et(e);this._updateScaleInfo(r,c,t.cosAngle)}else r.factor.scale=1,r.factorAlignment.scale=1;return e}const a=Et(e),o=Jt(s.screenSizePerspectiveAlignment,s.screenSizePerspective),l=xbe(n,a,s.verticalOffset,t.cosAngle,o);return this._updateScaleInfo(r,a,t.cosAngle),Ye(t.normal,t.normal,l),rt(e,e,t.normal)}_applyCenterOffsetView(e,t,n){const r=this.parameters.centerOffsetUnits!=="screen";return n!==e&&Ge(n,e),r&&(n[0]+=t[0],n[1]+=t[1],t[2]&&(mt(FT,n),rt(n,n,Ye(FT,FT,t[2])))),n}_applyCenterOffsetNDC(e,t,n,r){const s=this.parameters.centerOffsetUnits!=="screen";return r!==e&&Ge(r,e),s||(r[0]+=t[0]/n.fullWidth*2,r[1]+=t[1]/n.fullHeight*2),r}_applyPolygonOffsetNDC(e,t,n,r){const s=this.parameters.shaderPolygonOffset;if(e!==r&&Ge(r,e),s){const a=n.aboveGround?1:-1,o=a*Math.sign(t[3]);r[2]-=(o||a)*s}return r}requiresSlot(e,t){if(t===Re.Color||t===Re.Alpha||t===Re.Highlight||t===Re.ObjectAndLayerIdColor){if(e===at.DRAPED_MATERIAL)return!0;const{drawInSecondSlot:n,occlusionTest:r}=this.parameters;return e===(n?at.LABEL_MATERIAL:at.HUD_MATERIAL)||r&&e===at.OCCLUSION_PIXELS}return!1}createGLMaterial(e){return new Sct(e)}calculateRelativeScreenBounds(e,t,n=qi()){return Ect(this.parameters,e,t,n),n[2]=n[0]+e[0],n[3]=n[1]+e[1],n}},Sct=class extends Une{constructor(e){super({...e,...e.material.parameters})}selectProgram(e){return this.ensureTechnique(g7,e)}beginSlot(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.selectProgram(e)}};function Ect(i,e,t,n=Mct){return Zs(n,i.anchorPosition),n[0]*=-e[0],n[1]*=-e[1],n[0]+=i.screenOffset[0]*t,n[1]+=i.screenOffset[1]*t,n}function Act(i){const e=i[0],t=i[1],n=i[2],r=i[3],s=i[4],a=i[5],o=i[6],l=i[7],c=i[8],u=1/Math.sqrt(e*e+t*t+n*n),d=1/Math.sqrt(r*r+s*s+a*a),h=1/Math.sqrt(o*o+l*l+c*c);return i[0]=e*u,i[1]=t*u,i[2]=n*u,i[3]=r*d,i[4]=s*d,i[5]=a*d,i[6]=o*h,i[7]=l*h,i[8]=c*h,i}function EZ(i,e,t,n,r,s,a,o){let l=e-r-(o[0]>0?n[0]*o[0]:0),c=l+n[0]+2*r,u=t-r-(o[1]>0?n[1]*o[1]:0),d=u+n[1]+2*r;const h=a.distanceFieldBoundingBox;return a.textureIsSignedDistanceField&&T(h)&&(l+=n[0]*h[0],u+=n[1]*h[1],c-=n[0]*(1-h[2]),d-=n[1]*(1-h[3]),l-=s,c+=s,u-=s,d+=s),i[0]>l&&i[0]<c&&i[1]>u&&i[1]<d}const HF={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}},Mct=xt(),mo=q(),FT=q(),qo=Dn(),Hpe=q(),AZ=q(),GF=Ho(),Pct=Ho(),Oct=St(),qc=q(),WF={normal:Hpe,cosAngle:0},MZ=St(),Rct=1,Ict=2,Vg=[0,0],$ct=Gt(0,0,1);let Lct=class extends qbe{constructor(){super(...arguments),this.renderOccluded=Qr.Occlude,this.color=Xn(1,1,1,1),this.texCoordScale=[1,1],this.polygonOffset=!1,this.anchorPosition=dn(.5,.5),this.screenOffset=[0,0],this.shaderPolygonOffset=1e-5,this.textureIsSignedDistanceField=!1,this.outlineColor=Xn(1,1,1,1),this.outlineSize=0,this.vvSizeEnabled=!1,this.vvSizeMinSize=[1,1,1],this.vvSizeMaxSize=[100,100,100],this.vvSizeOffset=[0,0,0],this.vvSizeFactor=[1,1,1],this.vvColorEnabled=!1,this.vvColorValues=[0,0,0,0,0,0,0,0],this.vvColorColors=[1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0],this.hasSlicePlane=!1,this.pixelSnappingEnabled=!0,this.occlusionTest=!0,this.binaryHighlightOcclusion=!0,this.debugDrawLabelBorder=!1,this.centerOffsetUnits="world",this.drawInSecondSlot=!1,this.depthEnabled=!0,this.isDraped=!1}};const Gpe=Js().vec3f(j.POSITION).vec3f(j.NORMAL).vec2f(j.UV0).vec4u8(j.COLOR).vec2f(j.SIZE).vec4f(j.AUXPOS1).vec4f(j.AUXPOS2),Dct=Gpe.clone().vec4u8(j.OBJECTANDLAYERIDCOLOR);let kct=class{constructor(e){this._material=e,this.vertexBufferLayout=Fi("enable-feature:objectAndLayerId-rendering")?Dct:Gpe}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(j.POSITION).length}write(e,t,n,r,s){YB(n.indices.get(j.POSITION),n.vertexAttributes.get(j.POSITION).data,e,r.position,s,6),Hne(n.indices.get(j.NORMAL),n.vertexAttributes.get(j.NORMAL).data,t,r.normal,s,6);{const a=n.vertexAttributes.get(j.UV0).data;let o,l,c,u;if(a==null||a.length<4){const m=this._material.parameters;o=0,l=0,c=m.texCoordScale[0],u=m.texCoordScale[1]}else o=a[0],l=a[1],c=a[2],u=a[3];c=Math.min(1.99999,c+1),u=Math.min(1.99999,u+1);const d=n.indices.get(j.POSITION).length,h=r.uv0;let p=s;for(let m=0;m<d;++m)h.set(p,0,o),h.set(p,1,l),p+=1,h.set(p,0,c),h.set(p,1,l),p+=1,h.set(p,0,c),h.set(p,1,u),p+=1,h.set(p,0,c),h.set(p,1,u),p+=1,h.set(p,0,o),h.set(p,1,u),p+=1,h.set(p,0,o),h.set(p,1,l),p+=1}Gne(n.indices.get(j.COLOR),n.vertexAttributes.get(j.COLOR).data,4,r.color,s,6);{const a=n.indices.get(j.SIZE),o=n.vertexAttributes.get(j.SIZE).data,l=a.length,c=r.size;let u=s;for(let d=0;d<l;++d){const h=o[2*a[d]],p=o[2*a[d]+1];for(let m=0;m<6;++m)c.set(u,0,h),c.set(u,1,p),u+=1}}if(n.indices.get(j.AUXPOS1)&&n.vertexAttributes.get(j.AUXPOS1)&&g2(n.indices.get(j.AUXPOS1),n.vertexAttributes.get(j.AUXPOS1).data,r.auxpos1,s,6),n.indices.get(j.AUXPOS2)&&n.vertexAttributes.get(j.AUXPOS2)&&g2(n.indices.get(j.AUXPOS2),n.vertexAttributes.get(j.AUXPOS2).data,r.auxpos2,s,6),T(n.objectAndLayerIdColor)&&n.objectAndLayerIdColor.length===4&&n.indices.get(j.POSITION)){const a=n.indices.get(j.POSITION).length,o=r.getField(j.OBJECTANDLAYERIDCOLOR,by);Kbe(n.objectAndLayerIdColor,o,a,s,6)}}};const Wh=q(),p1=Dn(),NT=Dn(),jF=q(),Fct=St(),Nct=gf(),qF=Oc(),Vct=q(),Bct=qi();class zct{constructor(){this.aabr=qi(),this.distance=0,this.culled=!1,this.visible=!1}}class Uct{constructor(e,t,n={}){this.graphics3DGraphic=e,this.slicePlaneEnabled=t,this.info=n}}class Hct{constructor(){this.active=new Map,this.visible=new Map}clear(){this.active.clear(),this.visible.clear()}}class Gct{}class Wct{constructor(){this.sortArray=new pn({allocator:e=>e||new Gct})}}var Cc;(function(i){i[i.Idle=0]="Idle",i[i.Process=1]="Process",i[i.Sort=2]="Sort",i[i.Deconflict=3]="Deconflict",i[i.NumStates=4]="NumStates"})(Cc||(Cc={}));class Wpe{constructor(){this.camera=new Nn,this.slicePlane=wg(),this.slicePlaneEnabled=!1}copyFrom(e){this.camera.copyFrom(e.camera),$b(e.slicePlane,this.slicePlane),this.slicePlaneEnabled=e.slicePlaneEnabled}}let Ww=class extends et{constructor(i){super(i),this._dirty=!1,this._runningViewState=new Wpe,this._state=Cc.Idle,this._graphics=new Hct,this._iterators=new Wct,this._accBinsNumX=15,this._accBinsNumY=20,this._accBinsSizeX=0,this._accBinsSizeY=0,this._accBins=null,this.accNumTests=0}get dirty(){return this._dirty}get state(){return this._state}destroy(){this._graphics.clear(),this._iterators=null}setDirty(){!this._dirty&&this._graphics.active.size>0&&(this._dirty=!0,this.notifyChange("updating"))}get updating(){return this._state!==Cc.Idle||this._dirty}get updatingProgress(){if(!this.updating)return 1;const i=this._state/Cc.NumStates;return this._dirty?.5*i:i}get running(){return this.view.ready&&this.view.state!=null&&this.updating}runTask(i){switch(this._state){case Cc.Idle:this._startUpdate(),i.madeProgress();case Cc.Process:if(this._state=Cc.Process,!this._processActiveGraphics(i))return;case Cc.Sort:if(this._state=Cc.Sort,!this._sortVisibleGraphics(i))return;case Cc.Deconflict:if(this._state=Cc.Deconflict,!this._deconflictVisibleGraphics(i))return;default:gct(this,this._graphics.visible),this._state=Cc.Idle,this.notifyChange("updating")}}modifyGraphics(i,e){e?i.forEach(t=>this.addToActiveGraphics(t)):i.forEach(t=>this.removeFromActiveGraphics(t)),this.setDirty()}layerSupportsDeconfliction(i){if(B(i)||i.type!=="object3d")return!1;const e=i.stageObject;return(e?e.geometryRecords.length:0)!==1?!1:e.geometryRecords[0].material instanceof _C}_startUpdate(){vct(this.view),this._dirty=!1,this._runningViewState.copyFrom(this.viewState);const{fullWidth:i,fullHeight:e}=this._runningViewState.camera;this._initBins(i,e),this._resetIterators()}addToActiveGraphics(i){i.info[this.visibilityGroup]=new zct,this._graphics.active.set(i.graphics3DGraphic.graphic.uid,i),this.setDirty()}removeFromActiveGraphics(i){this._removeFromVisibleGraphics(i),jct(i,this.visibilityGroup),delete i.info[this.visibilityGroup],this._graphics.active.delete(i.graphics3DGraphic.graphic.uid),this.setDirty()}_addToVisibleGraphics(i){this._graphics.visible.set(i.graphics3DGraphic.graphic.uid,i)}_removeFromVisibleGraphics(i){this._graphics.visible.delete(i.graphics3DGraphic.graphic.uid)}_processActiveGraphics(i){const e=this._ensureActiveGraphicsIterator(),t=Da(Fct,this._runningViewState.camera.projectionMatrix),n=this.view.viewingMode==="global"&&this.view.map.ground.opacity===1&&this._runningViewState.camera.relativeElevation>0?Nct:null;let r=0;for(T(n)&&($t(n,wd,this._runningViewState.camera.viewMatrix),n[3]=rn(this.view.spatialReference).radius,r=M0e(n,wd));!i.done;){i.madeProgress();const s=e.next();if(s.done===!0)return this._resetActiveGraphicsIterator(),!0;const a=s.value,o=a&&a.info[this.visibilityGroup];o&&(this._collectGraphics3DGraphics(a,t,n,r),o.culled?this._removeFromVisibleGraphics(a):this._addToVisibleGraphics(a))}return!1}_sortVisibleGraphics(i){const e=this._ensureSortGraphicsIterator();for(;!i.done;){const t=e.next();if(i.madeProgress(),t.done===!0)return this._resetSortGraphicsIterator(),!0}return!1}_deconflictVisibleGraphics(i){const e=this._ensureVisibleGraphicsIterator(),t=this.visibilityGroup===Ia.LABEL;for(;!i.done;){i.madeProgress();const n=e.next();if(n.done===!0)return this._resetVisibleGraphicsIterator(),!0;const r=n.value,s=r.info[this.visibilityGroup];if(!s||s.culled)continue;const a=r.graphics3DGraphic,o=(!t||a.isVisible())&&!this._isConflicted(r);o&&this._addToBins(r),s.visible=o,this._setGraphicVisibility(r,o),_ct(s,o)}return!1}_resetIterators(){this._iterators.active=null,this._iterators.visible=null,this._iterators.sort=null}_ensureActiveGraphicsIterator(){return this._iterators.active||(this._iterators.active=PZ(this._graphics.active)),this._iterators.active}_resetActiveGraphicsIterator(){this._iterators.active=null}_ensureVisibleGraphicsIterator(){return this._iterators.visible||(this._iterators.visible=PZ(this._graphics.visible)),this._iterators.visible}_resetVisibleGraphicsIterator(){this._iterators.visible=null}_ensureSortGraphicsIterator(){return this._iterators.sort||(this._iterators.sort=qct(this._graphics.visible,this._iterators.sortArray,this.visibilityGroup)),this._iterators.sort}_resetSortGraphicsIterator(){this._iterators.sort=null}_collectGraphics3DGraphics(i,e,t,n){const r=i.graphics3DGraphic;if(r.destroyed)return;const s=i.info[this.visibilityGroup];if(!r.isVisible(Ia.GRAPHIC,xu.DECONFLICTION))return void(s.culled=!0);const a=this.getGraphicsLayers(r);Eh(s.aabr);let o=null;for(const l of a){if(!this.layerSupportsDeconfliction(l))continue;const c=l.stageObject.geometryRecords[0].material;if(B(o)){if(o=this._getProjectionInfo(l,e,Xct),o.isOutsideScreen||this._isCulledBySlice(i,Wh)||T(t)&&this._isCulledByHorizon(o,t,n))return void(s.culled=!0);!cn.TESTS_DISABLE_OPTIMIZATIONS&&s.visible&&(o.distance*=.7)}this._expandBoundingRect(s,l,c,o)}B(o)?s.culled=!0:(s.distance=o.distance,s.culled=!1)}_getProjectionInfo(i,e,t){const n=this._runningViewState.camera,r=i.stageObject,s=r.geometryRecords[0],a=s.material,o=IB(r.boundingVolumeWorldSpace.bounds);$t(Wh,o,n.viewMatrix);const l=s.geometry.vertexAttributes,c=l.get(j.NORMAL).data,u=l.get(j.AUXPOS1).data;return a.applyShaderOffsetsView(Wh,c,r.transformation,u,n,t.scaleInfo,Wh),dl(p1,Wh[0],Wh[1],Wh[2],1),Sm(NT,p1,n.projectionMatrix),Ye(t.positionNDC,NT,1/NT[3]),a.applyShaderOffsetsNDC(t.positionNDC,u,n,t.positionNDC,jF),t.distanceWithoutPolygonOffset=n.depthNDCToWorld(jF[2]),t.distance=jF[2]===t.positionNDC[2]?t.distanceWithoutPolygonOffset:n.depthNDCToWorld(t.positionNDC[2]),dl(NT,t.positionNDC[0],t.positionNDC[1],t.positionNDC[2],1),Sm(p1,NT,e),VB(p1,p1,1/p1[3]),je(t.positionView,Wh[0],Wh[1],Wh[2]),t}_isCulledByHorizon(i,e,t){return Ge(qF.direction,i.positionView),je(qF.origin,0,0,0),!!qL(e,qF,Vct)&&i.distanceWithoutPolygonOffset>t}_isCulledBySlice(i,e){return i.slicePlaneEnabled&&this._runningViewState.slicePlaneEnabled&&$U(this._runningViewState.slicePlane,e)}_expandBoundingRect(i,e,t,{positionNDC:n,scaleInfo:r}){const s=this._runningViewState.camera,a=e.getScreenSize(Kct);Pne(a,r.factor,a),a[0]*=s.pixelRatio,a[1]*=s.pixelRatio;const o=jI(t.calculateRelativeScreenBounds(a,r.factorAlignment.scale,Bct),ki(0,s.fullWidth,.5+.5*n[0]),ki(0,s.fullHeight,.5+.5*n[1])),l=this.iconMarginFactor;if(l!==0){const c=l*Math.min(Mp(o),vy(o));o[0]-=c,o[1]-=c,o[2]+=c,o[3]+=c}ry(i.aabr,o,i.aabr)}_isConflicted(i){const e=i.graphics3DGraphic.graphic.uid,t=i.info[this.visibilityGroup];for(let n=Math.floor(t.aabr[0]/this._accBinsSizeX);n<=Math.floor(t.aabr[2]/this._accBinsSizeX);n++)if(!(n<0||n>=this._accBinsNumX))for(let r=Math.floor(t.aabr[1]/this._accBinsSizeY);r<=Math.floor(t.aabr[3]/this._accBinsSizeY);r++){if(r<0||r>=this._accBinsNumY)continue;const s=this._accBins[n][r];for(let a=0;a<s.length;a++){const o=s.data[a],l=o.info[this.visibilityGroup];if(l&&l.visible&&o.graphics3DGraphic.graphic.uid!==e&&(this.accNumTests++,jL(l.aabr,t.aabr)))return!0}}return!1}_initBins(i,e){if(this._accBins==null){this._accBins=[];for(let t=0;t<this._accBinsNumX;t++){this._accBins.push([]);const n=this._accBins[this._accBins.length-1];for(let r=0;r<this._accBinsNumY;r++)n.push(new pn)}}else for(let t=0;t<this._accBinsNumX;t++)for(let n=0;n<this._accBinsNumY;n++)this._accBins[t][n].clear();this._accBinsSizeX=i/this._accBinsNumX,this._accBinsSizeY=e/this._accBinsNumY,this.accNumTests=0}_addToBins(i){const e=i.info[this.visibilityGroup],t=Math.floor(e.aabr[0]/this._accBinsSizeX),n=Math.floor(e.aabr[2]/this._accBinsSizeX),r=Math.floor(e.aabr[1]/this._accBinsSizeY),s=Math.floor(e.aabr[3]/this._accBinsSizeY);for(let a=t;a<=n;a++)if(!(a<0||a>=this._accBinsNumX))for(let o=r;o<=s;o++)o<0||o>=this._accBinsNumY||this._accBins[a][o].push(i)}_setGraphicVisibility(i,e){const t=i.graphics3DGraphic;t.destroyed||(t.setVisibilityFlag(xu.DECONFLICTION,e,this.visibilityGroup),this.visibilityGroup===Ia.LABEL&&this.view.labeler.setLabelGraphicVisibility(t,e))}};function jct(i,e){const t=i.graphics3DGraphic;t.destroyed||t.clearVisibilityFlag(xu.DECONFLICTION,e)}function*PZ(i){if(Map.prototype.entries){const e=i.entries();for(let t=e.next();!t.done;t=e.next())yield t.value[1]}else yield*i.values()}function*qct(i,e,t){e.clear(),i.forEach((r,s)=>{const a=e.pushNew();a.id=s,a.prio=r.info?-r.info[t].distance:Number.MAX_VALUE}),yield;const n=e.iterableSort((r,s)=>s.prio-r.prio);for(let r=n.next();!r.done;r=n.next())yield;e.forAll(r=>{const s=i.get(r.id);s&&(i.delete(r.id),i.set(r.id,s))}),e.clear()}f([y({constructOnly:!0})],Ww.prototype,"view",void 0),f([y({type:Boolean,readOnly:!0})],Ww.prototype,"updating",null),Ww=f([ge("esri.views.3d.layers.graphics.Deconflictor")],Ww);const Kct=xt();class Yct{constructor(){this.positionView=q(),this.positionNDC=q(),this.distance=0,this.distanceWithoutPolygonOffset=0,this.scaleInfo={factor:{scale:0,factor:0,minPixelSize:0,paddingPixels:0},factorAlignment:{scale:0,factor:0,minPixelSize:0,paddingPixels:0}}}get isOutsideScreen(){const e=this.positionNDC;return e[0]<-1||e[1]<-1||e[2]<-1||e[0]>=1||e[1]>=1}}const Xct=new Yct,Zct=2e3;let oI=class extends Ww{constructor(e){super(e),this.visibilityGroup=Ia.LABEL,this.iconMarginFactor=0,this._lastDeconfliction=0}get viewState(){return this.parent.viewState}runTask(e){if(this.parent.running)return;const t=performance.now();(e.state===Ap.IDLE||t-this._lastDeconfliction>Zct)&&(super.runTask(e),this.state===Cc.Idle&&(this._lastDeconfliction=t))}enabledChanged(e,t){this.modifyGraphics(t,e.labelsEnabled)}getGraphicsLayers(e){return e.labelGraphics}};f([y({constructOnly:!0})],oI.prototype,"parent",void 0),oI=f([ge("esri.views.3d.layers.graphics.LabelDeconflictor")],oI);let W6=class extends Ww{constructor(){super(...arguments),this._handles=new mi,this._contexts=new Map,this._viewState=new Wpe,this.visibilityGroup=Ia.GRAPHIC,this._iconMarginFactor=-.1}get labels(){return this._labels}get viewState(){return this._viewState}initialize(){this._handles.add([ue(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.state)==null?void 0:t.camera},()=>{this._updateViewState(),this.setDirty()}),ue(()=>{var e,t,n;return(n=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:n.opacity},(e,t)=>{e!==1&&t!==1||this.setDirty()}),ue(()=>{var e;return(e=this.view)==null?void 0:e.slicePlane},()=>{this._updateSlicePlane(),this._slicePlaneChanged()},At)]),this._frameTask=this.view.resourceController.scheduler.registerTask($r.GRAPHICS_DECONFLICTOR,this),this._labels=new oI({view:this.view,parent:this})}destroy(){this._labels.destroy(),this._labels=null,this._handles.destroy(),this._handles=null,this._frameTask&&(this._frameTask.remove(),this._frameTask=null)}get iconMarginFactor(){return this._iconMarginFactor}set iconMarginFactor(e){this._iconMarginFactor=e,this.setDirty()}setDirty(){this._contexts.size>0&&(super.setDirty(),this._labels.setDirty())}runTask(e){super.runTask(e),this.running||this._labels.setDirty()}setInitialIconVisibilityFlag(e,t){const n=!(this._graphicSupportsDeconfliction(t)&&KF(e));t.setVisibilityFlag(xu.DECONFLICTION,n,Ia.GRAPHIC)}_updateViewState(){this.view&&this.view.state&&(this._viewState.camera.copyFrom(this.view.state.camera),this._updateSlicePlane())}_updateSlicePlane(){const e=this.view?this.view.slicePlane:null;T(e)&&uhe(e,this._viewState.camera.viewMatrix,this._viewState.slicePlane),this._viewState.slicePlaneEnabled=T(e)}_slicePlaneChanged(){ps(this._contexts,(e,t)=>t.symbolCreationContext.slicePlaneEnabled)&&this.setDirty()}addGraphicsOwner(e){let t=this._contexts.get(e);return t==null&&(t=new Map,this._contexts.set(e,t),this.setDirty()),{addGraphic:n=>this._addGraphic(e,t,n),removeGraphic:n=>this._removeGraphic(t,n),labelingInfoChange:()=>this._labels.enabledChanged(e,t),featureReductionChange:()=>this.enabledChanged(e,t),slicePlaneEnabledChange:()=>this._slicePlaneEnabledChanged(e,t),clear:()=>t.forEach(n=>this._removeGraphic(t,n.graphics3DGraphic))}}removeGraphicsOwner(e){const t=this._contexts.get(e);t&&(t.forEach(n=>this._removeGraphic(t,n.graphics3DGraphic)),this._contexts.delete(e),this.setDirty())}_addGraphic(e,t,n){const r=n.graphic.uid,s=new Uct(n,e.symbolCreationContext.slicePlaneEnabled);t.set(r,s),KF(e)&&this.addToActiveGraphics(s),e.labelsEnabled&&this._labels.addToActiveGraphics(s)}_removeGraphic(e,t){const n=t.graphic.uid,r=e.get(n);r&&(this.removeFromActiveGraphics(r),this._labels.removeFromActiveGraphics(r),e.delete(n),this.setDirty())}enabledChanged(e,t){const n=KF(e);n||Qct(e),this.modifyGraphics(t,n)}_slicePlaneEnabledChanged(e,t){const n=e.symbolCreationContext.slicePlaneEnabled;t.forEach(r=>r.slicePlaneEnabled=n),this.setDirty()}getGraphicsLayers(e){return e.graphics}_graphicSupportsDeconfliction(e){if(e.isDraped)return!1;const t=e.graphics;if(!t||!t.length)return!1;for(const n of t)if(this.layerSupportsDeconfliction(n))return!0;return!1}};function KF(i){const e=i.layer;return!(!e||!e.featureReduction||e.featureReduction.type!=="selection")}function Qct(i){const e=i.graphics3DGraphics;e&&e.forEach(t=>t.clearVisibilityFlag(xu.DECONFLICTION))}W6=f([ge("esri.views.3d.layers.graphics.GraphicsDeconflictor")],W6);function jpe(i,e){if(i===e)return!0;if(i==null||e==null||i.length!==e.length)return!1;for(let t=0;t<i.length;t++){const n=i[t],r=e[t];if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==r[s])return!1}return!0}function qpe(i,e){if(i===e)return!0;if(i==null||e==null||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!jpe(i[t],e[t]))return!1;return!0}function eL(i,e){return i===e||T(i)&&T(e)&&Vc(i.spatialReference,e.spatialReference)&&i.x===e.x&&i.y===e.y&&i.z===e.z&&i.m===e.m}function Jct(i,e){return i.hasZ===e.hasZ&&i.hasM===e.hasM&&!!Vc(i.spatialReference,e.spatialReference)&&qpe(i.paths,e.paths)}function eut(i,e){return i.hasZ===e.hasZ&&i.hasM===e.hasM&&!!Vc(i.spatialReference,e.spatialReference)&&qpe(i.rings,e.rings)}function tut(i,e){return i.hasZ===e.hasZ&&i.hasM===e.hasM&&!!Vc(i.spatialReference,e.spatialReference)&&jpe(i.points,e.points)}function iut(i,e){return i.hasZ===e.hasZ&&i.hasM===e.hasM&&!!Vc(i.spatialReference,e.spatialReference)&&i.xmin===e.xmin&&i.ymin===e.ymin&&i.zmin===e.zmin&&i.xmax===e.xmax&&i.ymax===e.ymax&&i.zmax===e.zmax}function nut(i,e){if(i===e)return!0;if(B(i)||B(e)||i.type!==e.type)return!1;switch(i.type){case"point":return eL(i,e);case"extent":return iut(i,e);case"polyline":return Jct(i,e);case"polygon":return eut(i,e);case"multipoint":return tut(i,e);case"mesh":return!1;default:return}}function rut(i,e){if(i===e)return!0;if(!i||!e)return!1;const t=Object.keys(i),n=Object.keys(e);if(t.length!==n.length)return!1;for(const r of t)if(i[r]!==e[r])return!1;return!0}function V3t(i,e){return i===e||i!=null&&e!=null&&i.objectId===e.objectId&&!!nut(i.geometry,e.geometry)&&!!rut(i.attributes,e.attributes)}function Kpe(i){return"declaredClass"in i}function OZ(i){return"declaredClass"in i}function sut(i){return"declaredClass"in i}function aut(i,e){if(!i)return null;if(sut(i))return i;const t=new ao({layer:e,sourceLayer:e});return t.visible=i.visible,t.symbol=ko(i.symbol),t.attributes=ko(i.attributes),t.geometry=Ype(i.geometry),t}function Ype(i){return B(i)?null:Kpe(i)?i:$N(out(i))}function out(i){const{wkid:e,wkt:t,latestWkid:n}=i.spatialReference,r={wkid:e,wkt:t,latestWkid:n};switch(i.type){case"point":{const{x:s,y:a,z:o,m:l}=i;return{x:s,y:a,z:o,m:l,spatialReference:r}}case"polygon":{const{rings:s,hasZ:a,hasM:o}=i;return{rings:RZ(s),hasZ:a,hasM:o,spatialReference:r}}case"polyline":{const{paths:s,hasZ:a,hasM:o}=i;return{paths:RZ(s),hasZ:a,hasM:o,spatialReference:r}}case"extent":{const{xmin:s,xmax:a,ymin:o,ymax:l,zmin:c,zmax:u,mmin:d,mmax:h,hasZ:p,hasM:m}=i;return{xmin:s,xmax:a,ymin:o,ymax:l,zmin:c,zmax:u,mmin:d,mmax:h,hasZ:p,hasM:m,spatialReference:r}}case"multipoint":{const{points:s,hasZ:a,hasM:o}=i;return{points:Zpe(s)?Xpe(s):s,hasZ:a,hasM:o,spatialReference:r}}default:return}}function RZ(i){return lut(i)?i.map(e=>Xpe(e)):i}function Xpe(i){return i.map(e=>wye(e))}function lut(i){for(const e of i)if(e.length!==0)return Zpe(e);return!1}function Zpe(i){return i.length&&(mie(i[0])||gie(i[0]))}function pD(i,e){if(!i)return null;let t;if(OZ(i)){if(e==null)return i.clone();if(OZ(e))return e.copy(i)}return e!=null?(t=e,t.x=i.x,t.y=i.y,t.spatialReference=i.spatialReference,i.hasZ?(t.z=i.z,t.hasZ=i.hasZ):(t.z=null,t.hasZ=!1),i.hasM?(t.m=i.m,t.hasM=!0):(t.m=null,t.hasM=!1)):(t=Id(i.x,i.y,i.z,i.spatialReference),i.hasM&&(t.m=i.m,t.hasM=!0)),t}function cut(i){const{wkid:e,wkt:t,latestWkid:n}=i,r={wkid:e,wkt:t,latestWkid:n};return $n.fromJSON(r)}function v7(i,e){if(i.type==="point")return Bg(i,e,!1);if(Kpe(i))switch(i.type){case"extent":return Bg(i.center,e,!1);case"polygon":return Bg(i.centroid,e,!1);case"polyline":return Bg(IZ(i),e,!0);case"mesh":return Bg(i.origin,e,!1)}else switch(i.type){case"extent":return Bg(uut(i),e,!0);case"polygon":return Bg(dut(i),e,!0);case"polyline":return Bg(IZ(i),e,!0)}}function IZ(i){const e=i.paths[0];if(!e||e.length===0)return null;const t=Hie(e,Gie(e)/2);return Id(t[0],t[1],t[2],i.spatialReference)}function uut(i){const e=isFinite(i.zmin);return Id(.5*(i.xmax+i.xmin),.5*(i.ymax+i.ymin),e?.5*(i.zmax+i.zmin):void 0,i.spatialReference)}function dut(i){const e=i.rings[0];if(!e||e.length===0)return null;const t=N_e(i.rings,i.hasZ);return Id(t[0],t[1],t[2],i.spatialReference)}function Bg(i,e,t){const n=t?i:pD(i);return e&&i?Gye(i,n,e)?n:null:n}function B3t(i,e,t,n=0){if(i){e||(e=qi());const r=i;let s=.5*r.width*(t-1),a=.5*r.height*(t-1);return r.width<1e-7*r.height?s+=a/20:r.height<1e-7*r.width&&(a+=s/20),dl(e,r.xmin-s-n,r.ymin-a-n,r.xmax+s+n,r.ymax+a+n),e}return null}function Qpe(i,e){for(let t=0;t<i.geometries.length;++t){const n=i.geometries[t].getMutableAttribute(j.AUXPOS1);n&&n.data[3]!==e&&(n.data[3]=e,i.geometryVertexAttrsUpdated(i.geometryRecords[t]))}}function PE(i,e){const t=NB(oh);return T(i)&&(t[0]=i[0],t[1]=i[1],t[2]=i[2]),T(e)?t[3]=e:T(i)&&i.length>3&&(t[3]=i[3]),t}function z3t(i,e,t,n,r,s=[0,0,0,0]){for(let a=0;a<3;++a)T(i)&&i[a]!=null?s[a]=i[a]:T(t)&&t[a]!=null?s[a]=t[a]:s[a]=r[a];return T(e)?s[3]=e:T(n)?s[3]=n:s[3]=r[3],s}function $Z(i=Zv,e,t,n=1){const r=new Array(3);if(B(e)||B(t))r[0]=1,r[1]=1,r[2]=1;else{let s,a=0;for(let o=2;o>=0;o--){const l=i[o];let c;const u=l!=null,d=o===0&&!s&&!u,h=t[o];l==="symbol-value"||d?c=h!==0?e[o]/h:1:u&&l!=="proportional"&&isFinite(l)&&(c=h!==0?l/h:1),c!=null&&(r[o]=c,s=c,a=Math.max(a,Math.abs(c)))}for(let o=2;o>=0;o--)r[o]==null?r[o]=s:r[o]===0&&(r[o]=.001*a)}for(let s=2;s>=0;s--)r[s]/=n;return gu(r)}function hut(i){return i.isPrimitive!=null}function fD(i){return hut(i)&&(i=[i.width,i.depth,i.height]),tL(i)?null:"Symbol sizes may not be negative values"}function tL(i){if(Array.isArray(i)){for(const e of i)if(!tL(e))return!1;return!0}return i==null||i>=0}function put(i,e,t,n=St()){const r=i||0,s=e||0,a=t||0;return r!==0&&d2(n,n,-r/180*Math.PI),s!==0&&h2(n,n,s/180*Math.PI),a!==0&&DB(n,n,a/180*Math.PI),n}function y7(i,e,t){if(t.minDemResolution!=null)return t.minDemResolution;const n=rf(e),r=Jne(i)*n,s=ere(i)*n,a=az(i)*(e.isGeographic?1:n);return r===0&&s===0&&a===0?t.minDemResolutionForPoints:.01*Math.max(r,s,a)}function Jpe(i,e,t,n,r,s,a,o,l,c,u){const d=wut[u.mode];let h,p,m=0;if(Kl(i,e,t,n,l.spatialReference,r,o))return d.requiresAlignment(u)?(m=d.applyElevationAlignmentBuffer(n,r,s,a,o,l,c,u),h=s,p=a):(h=n,p=r),Kl(h,l.spatialReference,p,s,c.spatialReference,a,o)?m:void 0}function tg(i,e,t,n,r){const s=(K$(i)?i.z:wpe(i)?i.array[i.offset+2]:i[2])||0;switch(t.mode){case"on-the-ground":{const a=Jt(Vp(e,i,"ground"),0);return r.verticalDistanceToGround=0,r.sampledElevation=a,void(r.z=a)}case"relative-to-ground":{const a=Jt(Vp(e,i,"ground"),0),o=t.geometryZWithOffset(s,n);return r.verticalDistanceToGround=o,r.sampledElevation=a,void(r.z=o+a)}case"relative-to-scene":{const a=Jt(Vp(e,i,"scene"),0),o=t.geometryZWithOffset(s,n);return r.verticalDistanceToGround=o,r.sampledElevation=a,void(r.z=o+a)}case"absolute-height":{const a=t.geometryZWithOffset(s,n),o=Jt(Vp(e,i,"ground"),0);return r.verticalDistanceToGround=a-o,r.sampledElevation=o,void(r.z=a)}default:return Do(t.mode),void(r.z=0)}}function fut(i,e,t,n){return tg(i,e,t,n,jw),jw.z}function yM(i,e,t){return e==null||t==null?i.definedChanged:e==="on-the-ground"&&t==="on-the-ground"?i.staysOnTheGround:e===t||e!=="on-the-ground"&&t!=="on-the-ground"?Fr.UPDATE:i.onTheGroundChanged}function Rd(i){return i==="relative-to-ground"||i==="relative-to-scene"}function Iy(i){return i!=="absolute-height"}function mut(i,e,t,n,r){tg(e,t,r,n,jw),Qpe(i,jw.verticalDistanceToGround);const s=jw.sampledElevation,a=da(xut,i.transformation);return zP[0]=e.x,zP[1]=e.y,zP[2]=jw.z,zm(e.spatialReference,zP,a,n.spatialReference)?i.transformation=a:console.warn("Could not locate symbol object properly, it might be misplaced"),s}function gut(i,e,t,n,r,s){let a=0;const o=s.spatialReference;e*=3,n*=3;for(let l=0;l<r;++l){const c=i[e+0],u=i[e+1],d=i[e+2],h=Jt(s.getElevation(c,u,d,o,"ground"),0);a+=h,t[n+0]=c,t[n+1]=u,t[n+2]=h,e+=3,n+=3}return a/r}function vut(i,e,t,n,r,s,a,o){let l=0;const c=o.calculateOffsetRenderUnits(a),u=o.featureExpressionInfoContext,d=s.spatialReference;e*=3,n*=3;for(let h=0;h<r;++h){const p=i[e+0],m=i[e+1],g=i[e+2],_=Jt(s.getElevation(p,m,g,d,"ground"),0);l+=_,t[n+0]=p,t[n+1]=m,t[n+2]=u==null?g+_+c:_+c,e+=3,n+=3}return l/r}function yut(i,e,t,n,r,s,a,o){let l=0;const c=o.calculateOffsetRenderUnits(a),u=o.featureExpressionInfoContext,d=s.spatialReference;e*=3,n*=3;for(let h=0;h<r;++h){const p=i[e+0],m=i[e+1],g=i[e+2],_=Jt(s.getElevation(p,m,g,d,"scene"),0);l+=_,t[n+0]=p,t[n+1]=m,t[n+2]=u==null?g+_+c:_+c,e+=3,n+=3}return l/r}function _ut(i){const e=i.meterUnitOffset,t=i.featureExpressionInfoContext;return e!==0||t!=null}function but(i,e,t,n,r,s,a,o){const l=o.calculateOffsetRenderUnits(a),c=o.featureExpressionInfoContext;e*=3,n*=3;for(let u=0;u<r;++u){const d=i[e+0],h=i[e+1],p=i[e+2];t[n+0]=d,t[n+1]=h,t[n+2]=c==null?p+l:l,e+=3,n+=3}return 0}let _M=class{constructor(){this.verticalDistanceToGround=0,this.sampledElevation=0,this.z=0}};var Fr;(function(i){i[i.NONE=0]="NONE",i[i.UPDATE=1]="UPDATE",i[i.RECREATE=2]="RECREATE"})(Fr||(Fr={}));const wut={"absolute-height":{applyElevationAlignmentBuffer:but,requiresAlignment:_ut},"on-the-ground":{applyElevationAlignmentBuffer:gut,requiresAlignment:()=>!0},"relative-to-ground":{applyElevationAlignmentBuffer:vut,requiresAlignment:()=>!0},"relative-to-scene":{applyElevationAlignmentBuffer:yut,requiresAlignment:()=>!0}},xut=St(),jw=new _M,zP=q();function efe(i,e,t,n){const r=i.stageObject,s=r.geometryRecords;let a=0;for(const o of s){const{update:l,averageGeometrySampledElevation:c}=ife(o,e,t,n);a+=c,l&&r.geometryVertexAttrsUpdated(o)}return a/s.length}function _A(i,e,t,n){const r=i.stageObject,s=e.centerPointInElevationSR;let a=0;r.metadata.usesVerticalDistanceToGround?(tg(s,t,e,n,Bl),Qpe(r,Bl.verticalDistanceToGround),a=Bl.sampledElevation):(tg(s,t,e,n,Bl),e.mode!=="absolute-height"&&(a=Bl.sampledElevation));const o=da(Cut,r.transformation),l=je(tfe,o[12],o[13],o[14]);cn.TESTS_DISABLE_OPTIMIZATIONS?(Vl[0]=s.x,Vl[1]=s.y,Vl[2]=Bl.z,zm(s.spatialReference,Vl,o,n.spatialReference)&&(r.transformation=o)):n.setAltitudeOfTransformation(Bl.z,o);const c=_7/n.unitInMeters;return(Math.abs(o[12]-l[0])>=c||Math.abs(o[13]-l[1])>=c||Math.abs(o[14]-l[2])>=c)&&(r.transformation=o),a}const Cut=St();function Tut(i,e,t,n){const r=i.graphics3DSymbolLayer.lodRenderer;if(B(r))return 0;const s=e.centerPointInElevationSR;tg(s,t,e,n,Bl);const a=e.mode!=="absolute-height"?Bl.sampledElevation:0,o=r.instanceData,l=i.instanceIndex,c=Eut;o.getGlobalTransform(l,c);const u=je(tfe,c[12],c[13],c[14]);cn.TESTS_DISABLE_OPTIMIZATIONS?(Vl[0]=s.x,Vl[1]=s.y,Vl[2]=Bl.z,zm(s.spatialReference,Vl,c,n.spatialReference)&&o.setGlobalTransform(l,c)):n.setAltitudeOfTransformation(Bl.z,c);const d=_7/n.unitInMeters;return(cn.TESTS_DISABLE_OPTIMIZATIONS||Math.abs(c[12]-u[0])>=d||Math.abs(c[13]-u[1])>=d||Math.abs(c[14]-u[2])>=d)&&o.setGlobalTransform(l,c),a}function Sut(i,e,t,n){const r=i.stageObject,s=r.geometryRecords;if(s.length===0)return 0;let a=0,o=null,l=0,c=!1;for(const u of s){const d=u.geometry.vertexAttributes.get(j.POSITION);if(d!==o){const{update:h,averageGeometrySampledElevation:p}=ife(u,e,t,n);l=p,o=d,c=h}c&&r.geometryVertexAttrsUpdated(u),a+=l}return a/s.length}const _7=.01,Vl=q(),Bu=q(),f1=q(),Eut=St(),tfe=q(),Bl=new _M;function ife(i,e,t,n){let r=!1;const s=t.spatialReference,a=i.geometry,o=i.getShaderTransformation(),l=e.requiresSampledElevationInfo;Bu[0]=o[12],Bu[1]=o[13],Bu[2]=o[14],a.invalidateBoundingInfo();const c=a.getMutableAttribute(j.POSITION),u=c.data,d=a.vertexAttributes.get(j.MAPPOS).data,h=c.size,p=u.length/h,m=new bpe(d,s);let g=0,_=0;for(let b=0;b<p;b++){if(f1[0]=u[g],f1[1]=u[g+1],f1[2]=u[g+2],tg(m,t,e,n,Bl),l&&(_+=Bl.sampledElevation),cn.TESTS_DISABLE_OPTIMIZATIONS)u[g]=m.array[m.offset],u[g+1]=m.array[m.offset+1],u[g+2]=Bl.z,Kl(u,s,g,u,n.spatialReference,g,1),u[g]-=Bu[0],u[g+1]-=Bu[1],u[g+2]-=Bu[2],r=!0;else{Vl[0]=u[g]+Bu[0],Vl[1]=u[g+1]+Bu[1],Vl[2]=u[g+2]+Bu[2],n.setAltitude(Vl,Bl.z),u[g]=Vl[0]-Bu[0],u[g+1]=Vl[1]-Bu[1],u[g+2]=Vl[2]-Bu[2];const x=_7/n.unitInMeters;(Math.abs(f1[0]-u[g])>=x||Math.abs(f1[1]-u[g+1])>=x||Math.abs(f1[2]-u[g+2])>=x)&&(r=!0)}g+=h,m.offset+=3}return _/=p,{update:r,averageGeometrySampledElevation:_}}const Aut=tt.getLogger("esri.views.3d.layers.graphics.featureExpressionInfoUtils");function Mut(i){return{cachedResult:i.cachedResult,arcade:i.arcade?{func:i.arcade.func,context:i.arcade.modules.arcadeUtils.createExecContext(null,{sr:i.arcade.context.spatialReference}),modules:i.arcade.modules}:null}}function H3t(i){const e=i&&i.expression;if(typeof e=="string"){const t=sfe(e);if(t!=null)return{cachedResult:t}}return null}async function G3t(i,e,t,n){const r=i&&i.expression;if(typeof r!="string")return null;const s=sfe(r);if(s!=null)return{cachedResult:s};const a=await UL();Cn(t);const o=a.arcadeUtils,l=o.createSyntaxTree(r);return o.dependsOnView(l)?(n!=null&&n.error("Expressions containing '$view' are not supported on ElevationInfo"),{cachedResult:0}):{arcade:{func:o.createFunction(l),context:o.createExecContext(null,{sr:e}),modules:a}}}function nfe(i,e,t){return i.arcadeUtils.createFeature(e.attributes,e.geometry,t)}function b7(i,e){if(i!=null&&!rfe(i)){if(!e||!i.arcade)return void Aut.errorOncePerTick("Arcade support required but not provided");const t=e;t._geometry&&(t._geometry=Ype(t._geometry)),i.arcade.modules.arcadeUtils.updateExecContext(i.arcade.context,e)}}function Put(i){if(i!=null){if(rfe(i))return i.cachedResult;const e=i.arcade;let t=i.arcade.modules.arcadeUtils.executeFunction(e.func,e.context);return typeof t!="number"&&(i.cachedResult=0,t=0),t}return 0}function W3t(i,e=!1){let t=i&&i.featureExpressionInfo;const n=t&&t.expression;return e||n==="0"||(t=null),t}const Out={cachedResult:0};function rfe(i){return i.cachedResult!=null}function sfe(i){return i==="0"?0:null}let Dd=class{constructor(){this._meterUnitOffset=0,this._renderUnitOffset=0,this._unit="meters",this._metersPerElevationInfoUnit=1,this._featureExpressionInfoContext=null,this.centerPointInElevationSR=null,this.mode=null}get featureExpressionInfoContext(){return this._featureExpressionInfoContext}get meterUnitOffset(){return this._meterUnitOffset}get unit(){return this._unit}set unit(e){this._unit=e,this._metersPerElevationInfoUnit=W1e(e)}get requiresSampledElevationInfo(){return this.mode!=="absolute-height"}reset(){this.mode=null,this._meterUnitOffset=0,this._renderUnitOffset=0,this._featureExpressionInfoContext=null,this.unit="meters"}set offsetMeters(e){this._meterUnitOffset=e,this._renderUnitOffset=0}set offsetElevationInfoUnits(e){this._meterUnitOffset=e*this._metersPerElevationInfoUnit,this._renderUnitOffset=0}addOffsetRenderUnits(e){this._renderUnitOffset+=e}geometryZWithOffset(e,t){const n=this.calculateOffsetRenderUnits(t);return this.featureExpressionInfoContext!=null?n:e+n}calculateOffsetRenderUnits(e){let t=this._meterUnitOffset;const n=this.featureExpressionInfoContext;return n!=null&&(t+=Put(n)*this._metersPerElevationInfoUnit),t/e.unitInMeters+this._renderUnitOffset}setFromElevationInfo(e){this.mode=e.mode,this.unit=j1e(e.unit)?e.unit:"meters",this.offsetElevationInfoUnits=Jt(e.offset,0)}updateFeatureExpressionInfoContext(e,t,n){if(B(e))return void(this._featureExpressionInfoContext=null);const r=e&&e.arcade;r&&T(t)&&T(n)?(this._featureExpressionInfoContext=Mut(e),b7(this._featureExpressionInfoContext,nfe(r.modules,t,n))):this._featureExpressionInfoContext=e}static fromElevationInfo(e){const t=new Dd;return T(e)&&t.setFromElevationInfo(e),t}},wf=class{constructor(e,t,n,r,s,a,o,l=null){this.graphics3DSymbolLayer=e,this.stageObject=t,this._uniqueGeometries=n,this._uniqueMaterials=r,this._sharedResource=s,this.elevationAligner=a,this.elevationContext=o,this._edgeState=l,this.type="object3d",this._stageLayer=null,this._stage=null,this._visible=!1,this._addedToStage=!1,this.alignedSampledElevation=0,this.needsElevationUpdates=!1,this.useObjectOriginAsAttachmentOrigin=!1,this.graphics3DSymbolLayer=e,this.stageObject=t}get isElevationSource(){return!(!this.stageObject.metadata||!this.stageObject.metadata.isElevationSource)}initialize(e,t){this._stageLayer=t,this._stage=e,e.addMany(this._uniqueMaterials),e.addMany(this._uniqueGeometries),e.add(this.stageObject)}destroy(){const e=this._stage;this._stageLayer&&(e.removeMany(this._uniqueMaterials),e.removeMany(this._uniqueGeometries)),e.remove(this.stageObject),this._addedToStage&&(this._stageLayer.remove(this.stageObject),this._addedToStage=!1);const t=this._stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)&&t.removeObject(this.stageObject),this.stageObject.dispose(),T(this._sharedResource)&&this._sharedResource.release(),this._visible=!1,this._stageLayer=null,this._stage=null}layerOpacityChanged(e,t){if(B(this._edgeState))return;const n=LZ(this._edgeState.baseMaterial);let r=!1;for(const s of this._edgeState.edgeMaterials)s.objectTransparency!==n&&(s.objectTransparency=n,r=!0);r&&this._resetEdgeObject(t),this._stage.renderView.ensureEdgeView().updateAllComponentOpacities(this.stageObject,[e])}slicePlaneEnabledChanged(e,t){B(this._edgeState)||(this._stage.renderView.ensureEdgeView().updateAllComponentMaterials(this.stageObject,this._edgeState.edgeMaterials,{hasSlicePlane:e},!t),this._edgeState.properties.hasSlicePlane=e)}setVisibility(e){if(this._stage!=null&&this._visible!==e&&(this._visible=e,this._visible?this._addedToStage?this.stageObject.setVisible(!0):(this._stageLayer.add(this.stageObject),this._addedToStage=!0):this.stageObject.setVisible(!1),T(this._edgeState))){const t=this._stage.renderView.ensureEdgeView();t.hasObject(this.stageObject)?t.updateObjectVisibility(this.stageObject,e):e&&this._addOrUpdateEdgeObject(t,!1)}}get visible(){return this._visible}alignWithElevation(e,t,n,r){this.elevationAligner!=null&&(T(n)&&b7(this.elevationContext.featureExpressionInfoContext,n),this.alignedSampledElevation=this.elevationAligner(this,this.elevationContext,e,t),this._resetEdgeObject(r))}getCenterObjectSpace(e=q()){return Ge(e,IB(this.stageObject.boundingVolumeObjectSpace.bounds))}getBoundingBoxObjectSpace(e=Go()){const t=this.stageObject.boundingVolumeObjectSpace;return L1e(e,t.min),D1e(e,t.max),e}computeAttachmentOrigin(e){if(this.useObjectOriginAsAttachmentOrigin){const t=this.stageObject.transformation;e.render.origin[0]+=t[12],e.render.origin[1]+=t[13],e.render.origin[2]+=t[14],e.render.num++}else for(const t of this.stageObject.geometryRecords)t.computeAttachmentOrigin($f)&&($t($f,$f,this.stageObject.transformation),rt(e.render.origin,e.render.origin,$f),e.render.num++)}async getProjectedBoundingBox(e,t,n,r,s){const a=this.getBoundingBoxObjectSpace(s),o=Rut,l=rz(a)?1:o.length;for(let u=0;u<l;u++){const d=o[u];zg[0]=a[d[0]],zg[1]=a[d[1]],zg[2]=a[d[2]],$t(zg,zg,this.stageObject.transformation),s_[3*u+0]=zg[0],s_[3*u+1]=zg[1],s_[3*u+2]=zg[2]}if(!e(s_,0,l))return null;fr(a);let c=null;this.calculateRelativeScreenBounds&&(c=this.calculateRelativeScreenBounds());for(let u=0;u<3*l;u+=3){for(let d=0;d<3;d++)a[d]=Math.min(a[d],s_[u+d]),a[d+3]=Math.max(a[d+3],s_[u+d]);c&&n.push({location:s_.slice(u,u+3),screenSpaceBoundingRect:c})}if(t&&t.service&&this.elevationContext.mode!=="absolute-height"){ph(a,$f);const u=this.elevationContext.mode==="relative-to-scene"?"scene":"ground";let d=0;if(t.useViewElevation)d=Jt(t.service.getElevation($f[0],$f[1],u),0);else try{const h=y7(a,t.service.spatialReference,t);d=Jt(await t.service.queryElevation($f[0],$f[1],r,h,u),0)}catch{}tre(a,0,0,-this.alignedSampledElevation+d)}return a}addObjectState(e,t){e===nb.Highlight&&t.addObject(this.stageObject,this.stageObject.highlight()),e===nb.MaskOccludee&&t.addObject(this.stageObject,this.stageObject.maskOccludee())}removeObjectState(e){e.removeObject(this.stageObject)}_resetEdgeObject(e){if(B(this._edgeState))return;const t=this._stage.renderView.ensureEdgeView();this._visible?this._addOrUpdateEdgeObject(t,e):t.removeObject(this.stageObject)}_addOrUpdateEdgeObject(e,t){const n=this._edgeState;if(B(n))return;const r=LZ(n.baseMaterial);for(const s of n.edgeMaterials)s.objectTransparency=r;e.addOrUpdateObject3D(this.stageObject,n.edgeMaterials,n.properties,!t).then(()=>{var s;return(s=this._stageLayer)==null?void 0:s.sync()})}};function LZ(i){return i.isVisible?i.parameters.transparent?Vi.TRANSPARENT:Vi.OPAQUE:Vi.INVISIBLE}const s_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],zg=q(),$f=q(),Rut=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]];var Ns;(function(i){i[i.Recreate_Symbol=0]="Recreate_Symbol",i[i.Recreate_Graphics=1]="Recreate_Graphics",i[i.Fast_Update=2]="Fast_Update"})(Ns||(Ns={}));let w7=class{constructor(e){this.schedule=e,this._abortController=null,this._loadStatus=yu.LOADING,this._loadError=null,this._loader=null,this.logger=null}destroy(){this.abortLoad()}get loadStatus(){return this._loadStatus}load(e,t){return this._loadStatus===yu.LOADED?(e&&e(),Jt(this._loader,Promise.resolve())):this._loadStatus===yu.FAILED?(t&&t(this._loadError),Jt(this._loader,Promise.resolve())):(B(this._loader)&&(this._abortController=new AbortController,this._loader=this.doLoad(this._abortController.signal).then(()=>{this._abortController=null,this._loadStatus=yu.LOADED},n=>{throw this._loadError=n,this._abortController=null,this._loadStatus=yu.FAILED,!zo(n)&&this.logger&&n.message&&this.logger.warn(n.message),n})),this._loader.then(e,t).catch(()=>{}),this._loader)}abortLoad(){T(this._abortController)?this._abortController=ll(this._abortController):this._loadStatus===yu.LOADING&&(this._loadStatus=yu.FAILED),this._loader=null}};var yu;(function(i){i[i.LOADING=0]="LOADING",i[i.LOADED=1]="LOADED",i[i.FAILED=2]="FAILED"})(yu||(yu={}));function Iut(i){switch(i){case"sphere":case"cube":case"diamond":case"cylinder":case"cone":case"inverted-cone":case"tetrahedron":return!0}return!1}function afe(i,e){const t=(n,r,s=!1)=>({levels:n.map(a=>{const o=r(a.tesselation);return s&&Irt(o),{components:[{geometry:o,material:e}],faceCount:o.indexCount/3,minScreenSpaceRadius:a.minScreenSpaceRadius}})});switch(i){case"sphere":return t([{tesselation:0,minScreenSpaceRadius:0},{tesselation:1,minScreenSpaceRadius:8},{tesselation:2,minScreenSpaceRadius:16},{tesselation:3,minScreenSpaceRadius:50},{tesselation:4,minScreenSpaceRadius:250}],n=>Ihe(.5,n,!0));case"cube":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>Ert(1));case"cone":return t(YF,n=>CX(1,.5,n,!1),!0);case"inverted-cone":return t(YF,n=>CX(1,.5,n,!0),!0);case"cylinder":return t(YF,n=>Ort(1,.5,n,[0,0,1],[0,0,.5]));case"tetrahedron":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>Mrt(1),!0);case"diamond":return t([{tesselation:0,minScreenSpaceRadius:0}],()=>Art(1),!0);default:return}}const YF=[{tesselation:6,minScreenSpaceRadius:0},{tesselation:18,minScreenSpaceRadius:7},{tesselation:64,minScreenSpaceRadius:65}];function UP(i){const e=[];return i.levels.forEach(t=>{t.components.forEach(n=>{e.push(n.material)})}),HA(e)}function DZ(i){const e=new Array;return i.levels.forEach(t=>{t.components.forEach(n=>{n.textures&&e.push(...n.textures)})}),HA(e)}function x7(i){const e=[];return i.components.forEach(t=>{e.push(t.geometry)}),HA(e)}function kZ(i){const e=[];return i.levels.forEach(t=>{t.components.forEach(n=>{e.push(n.geometry)})}),HA(e)}function $ut(i){return x7(i).reduce((e,t)=>e+t.indexCount/3,0)}const C7={primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:{bytesPerFeature:0,bytesPerCoordinate:0,bytesPerFeatureLabel:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}}};function Y3t(i){return i.type==="web-style"?C7:T7(i.symbolLayers.toArray().map(e=>ofe(i,e)))}function T7(i){let e=0,t=0,n=0,r=!1,s=0;const a={bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:0,bytesPerFeatureLabel:0,bytesPerCoordinate:0}};for(const o of i)B(o)||(e+=o.primitivesPerFeature,t+=o.primitivesPerCoordinate,n+=o.drawCallsPerFeature,a.bytesPerFeature+=o.memory.bytesPerFeature,a.bytesPerFeatureLabel+=o.memory.bytesPerFeatureLabel,a.bytesPerCoordinate+=o.memory.bytesPerCoordinate,a.resourceBytes+=o.memory.resourceBytes,a.draped.bytesPerFeature+=o.memory.bytesPerFeature,a.draped.bytesPerFeatureLabel+=o.memory.bytesPerFeatureLabel,a.draped.bytesPerCoordinate+=o.memory.bytesPerCoordinate,r=r||o.estimated,++s);return{primitivesPerFeature:e,primitivesPerCoordinate:t,drawCallsPerFeature:n,estimated:r,memory:a,numComplexities:s}}function X3t(i){const e=T7(i);return e.numComplexities>0&&(e.primitivesPerFeature/=e.numComplexities,e.primitivesPerCoordinate/=e.numComplexities,e.drawCallsPerFeature/=e.numComplexities,e.memory.bytesPerFeature/=e.numComplexities,e.memory.bytesPerFeatureLabel/=e.numComplexities,e.memory.bytesPerCoordinate/=e.numComplexities,e.memory.resourceBytes/=e.numComplexities,e.memory.draped.bytesPerFeature/=e.numComplexities,e.memory.draped.bytesPerFeatureLabel/=e.numComplexities,e.memory.draped.bytesPerCoordinate/=e.numComplexities),e}const FZ={};function ofe(i,e){const t=lfe(i,e),n=q1e(e)?2:0;switch(e.type){case"extrude":return{primitivesPerFeature:-4,primitivesPerCoordinate:4,drawCallsPerFeature:n,estimated:!1,memory:t};case"fill":return i.type==="mesh-3d"?{primitivesPerFeature:0,primitivesPerCoordinate:0,drawCallsPerFeature:n,estimated:!1,memory:t}:T(e.outline)&&e.outline.size>0?{primitivesPerFeature:-4,primitivesPerCoordinate:3,drawCallsPerFeature:0,estimated:!1,memory:t}:{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:t};case"water":return{primitivesPerFeature:-2,primitivesPerCoordinate:1,drawCallsPerFeature:0,estimated:!1,memory:t};case"line":return{primitivesPerFeature:-2,primitivesPerCoordinate:2,drawCallsPerFeature:0,estimated:!1,memory:t};case"object":return e.resource&&e.resource.href?{primitivesPerFeature:16,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!0,memory:t}:{...Lut(e.resource&&e.resource.primitive||hB),memory:t};case"path":{let o=0,l=0;switch(e.profile){case"circle":o=10;break;case"quad":o=4;break;default:return void Do(e.profile)}switch(e.join){case"round":l=3;break;case"miter":case"bevel":l=1;break;default:return void Do(e.join)}const c=2*o,u=o*l*2;let d=-2*u-c;switch(e.cap){case"none":break;case"butt":case"square":d+=2*(o-1);break;case"round":d+=2*(o*(3-1)*2+o);break;default:return}return{primitivesPerFeature:d,primitivesPerCoordinate:u+c,drawCallsPerFeature:0,estimated:!1,memory:t}}case"text":case"icon":return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:t};default:return}}function lfe(i,e){const t=i.type==="point-3d";switch(e.type){case"extrude":return e.edges&&e.edges.size>0?_l.EXTRUDE_EDGES:_l.EXTRUDE;case"fill":return T(e.outline)&&e.outline.size>0?_l.FILL_OUTLINE:_l.FILL;case"water":return _l.FILL;case"line":return e.join==="round"?_l.LINE_ROUND:_l.LINE_MITER;case"path":switch(e.join){case"round":switch(e.profile){case"circle":return _l.PATH_ROUND_CIRCLE;case"quad":return _l.PATH_ROUND_QUAD;default:return void Do(e.profile)}case"miter":case"bevel":switch(e.profile){case"circle":return _l.PATH_MITER_CIRCLE;case"quad":return _l.PATH_MITER_QUAD;default:return void Do(e.profile)}default:return void Do(e.join)}case"object":return t?_l.OBJECT_POINT:_l.OBJECT_POLYGON;case"icon":case"text":return t?_l.ICON_POINT:_l.ICON_POLYGON;default:return}}function Lut(i){let e=FZ[i];if(e)return e;const t=afe(i,null);return e={primitivesPerFeature:x7(t.levels[0]).reduce((n,r)=>n+r.indices.get(j.POSITION).length/3,0),primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1},FZ[i]=e,e}const _l={ICON_POINT:{bytesPerFeature:7127.413186968842,bytesPerFeatureLabel:4826.302896296296,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:3929.4396628895197,bytesPerFeatureLabel:3550.1332222222227,bytesPerCoordinate:0}},ICON_POLYGON:{bytesPerFeature:9329.452613976147,bytesPerFeatureLabel:3675.3372604938268,bytesPerCoordinate:60.177252982212096,resourceBytes:0,draped:{bytesPerFeature:6190.247450139383,bytesPerFeatureLabel:3744.074358024691,bytesPerCoordinate:59.488211068026104}},OBJECT_POINT:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0,resourceBytes:0,draped:{bytesPerFeature:2350.5884192634558,bytesPerFeatureLabel:4446.651003703703,bytesPerCoordinate:0}},OBJECT_POLYGON:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506,resourceBytes:0,draped:{bytesPerFeature:4583.807620302299,bytesPerFeatureLabel:3665.342685185186,bytesPerCoordinate:60.11621818101506}},LINE_MITER:{bytesPerFeature:7321.028181375921,bytesPerFeatureLabel:4048.0226716049388,bytesPerCoordinate:186.55621386363578,resourceBytes:0,draped:{bytesPerFeature:4246.856619435009,bytesPerFeatureLabel:3852.3737679012347,bytesPerCoordinate:163.47884002621583}},LINE_ROUND:{bytesPerFeature:7482.205842738954,bytesPerFeatureLabel:4045.886987654321,bytesPerCoordinate:191.5452524171851,resourceBytes:0,draped:{bytesPerFeature:4473.481387957992,bytesPerFeatureLabel:3842.1112395061728,bytesPerCoordinate:167.27703460226945}},PATH_MITER_CIRCLE:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275,resourceBytes:0,draped:{bytesPerFeature:9010.489006415351,bytesPerFeatureLabel:4230.9109,bytesPerCoordinate:4618.2594178027275}},PATH_ROUND_CIRCLE:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957,resourceBytes:0,draped:{bytesPerFeature:4104.727250200398,bytesPerFeatureLabel:4251.8525,bytesPerCoordinate:8019.043777064957}},PATH_MITER_QUAD:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203,resourceBytes:0,draped:{bytesPerFeature:9416.372942261387,bytesPerFeatureLabel:4241.2757,bytesPerCoordinate:3176.7222742582203}},PATH_ROUND_QUAD:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826,resourceBytes:0,draped:{bytesPerFeature:6614.431545308682,bytesPerFeatureLabel:4206.7461,bytesPerCoordinate:5141.817789093826}},FILL:{bytesPerFeature:9478.244183633637,bytesPerFeatureLabel:3713.816824691358,bytesPerCoordinate:95.9343604185578,resourceBytes:0,draped:{bytesPerFeature:6287.911108168086,bytesPerFeatureLabel:3790.785032098766,bytesPerCoordinate:83.08783220478168}},FILL_OUTLINE:{bytesPerFeature:13085.871870349445,bytesPerFeatureLabel:3392.613241975309,bytesPerCoordinate:118.63968023169875,resourceBytes:0,draped:{bytesPerFeature:8437.199992480122,bytesPerFeatureLabel:3973.5431172839503,bytesPerCoordinate:106.33556817014312}},EXTRUDE:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477,resourceBytes:0,draped:{bytesPerFeature:19459.53727140414,bytesPerFeatureLabel:3743.7045209876546,bytesPerCoordinate:372.6819978900477}},EXTRUDE_EDGES:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312,resourceBytes:0,draped:{bytesPerFeature:22266.888534913724,bytesPerFeatureLabel:3064.3193358024696,bytesPerCoordinate:374.3725221561312}}},m1=tt.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayer");let xf=class extends w7{constructor(e,t,n,r){super(n.schedule),this._context=n,this._elevationInfoOverride=null,this._ignoreDrivers=!1,this._drivenProperties={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1},this.complexity=null,this.logger=m1,this._elevationOptions={supportsOffsetAdjustment:!1,supportsOnTheGround:!0},this.symbol=e,this.symbolLayer=t,this._renderPriority=r.renderPriority,this._renderPriorityStep=r.renderPriorityStep,this._elevationContext=new Dd,this.complexity=this.computeComplexity(),this._ignoreDrivers=r.ignoreDrivers,this._ignoreDrivers||(this._drivenProperties=NZ(this._context.renderer)),this._updateElevationContext()}getCachedSize(){return null}get extentPadding(){return 0}_drivenPropertiesChanged(e){if(this._ignoreDrivers)return!1;const t=this._drivenProperties,n=NZ(e);return n.color!==t.color||n.opacity!==t.opacity||n.opacityAlwaysOpaque!==t.opacityAlwaysOpaque||n.size!==t.size}get needsDrivenTransparentPass(){return this._drivenProperties.opacity&&!this._drivenProperties.opacityAlwaysOpaque}_logGeometryCreationWarnings(e,t,n,r){const s=e.projectionSuccess,a="polygons"in e?e.polygons:null,o=`${r} geometry failed to be created`;let l=null;s?!this._logGeometryValidationWarnings(t,n,r)&&a&&a.length===0&&n==="rings"&&t.length>0&&t[0].length>2&&(l=`${o} (filled rings should use clockwise winding - try reversing the order of vertices)`):l=`${o} (failed to project geometry to view spatial reference)`,l&&m1.warnOncePerTick(l)}_logGeometryValidationWarnings(e,t,n){const r=`${n} geometry failed to be created`;return!e.length||e.length===1&&!e[0].length?(m1.warnOncePerTick(`${r} (no ${t} were defined)`),!0):(!Array.isArray(e)||!Array.isArray(e[0]))&&(m1.warnOncePerTick(`${r} (${t} should be defined as a 2D array)`),!0)}_validateGeometry(e,t=null,n=null){if(T(t)&&!t.includes(e.type))return this.logger.warn("unsupported geometry type for "+n+` symbol: ${e.type}`),!1;if(e.type==="point"){const r=e;if(!isFinite(r.x)||!isFinite(r.y))return m1.warn("point coordinate is not a valid number, graphic skipped"),!1}return!0}_defaultElevationInfoNoZ(){return Dut}_defaultElevationInfoZ(){return kut}_updateElevationContext(){T(this._elevationInfoOverride)?(this._elevationContext.setFromElevationInfo(this._elevationInfoOverride),this._elevationContext.updateFeatureExpressionInfoContext(null)):this._context.layer.elevationInfo?(this._elevationContext.setFromElevationInfo(this._context.layer.elevationInfo),this._elevationContext.updateFeatureExpressionInfoContext(this._context.featureExpressionInfoContext)):this._elevationContext.reset()}getDefaultElevationInfo(e){return e.hasZ?this._defaultElevationInfoZ():this._defaultElevationInfoNoZ()}getGeometryElevationMode(e,t=this.getDefaultElevationInfo(e)){return this._elevationContext.mode||t.mode}setElevationInfoOverride(e){this._elevationInfoOverride=e,this._updateElevationContext()}setGraphicElevationContext(e,t){const n=kt(e.geometry),r=this.getDefaultElevationInfo(n);t.unit=this._elevationContext.unit!=null?this._elevationContext.unit:r.unit,t.mode=this.getGeometryElevationMode(n,r),t.offsetMeters=Jt(this._elevationContext.meterUnitOffset,Jt(r.offset,0));const s=!this._elevationOptions.supportsOnTheGround&&t.mode==="on-the-ground";s&&(t.mode="relative-to-ground",t.offsetMeters=0);const a=s?Out:this._elevationContext.featureExpressionInfoContext;return t.updateFeatureExpressionInfoContext(a,e,this._context.layer),t}prepareSymbolLayerPatch(e){}updateGeometry(e,t){return!1}onRemoveGraphic(e){}_getLayerOpacity(){return this._context.graphicsCoreOwner&&"fullOpacity"in this._context.graphicsCoreOwner?this._context.graphicsCoreOwner.fullOpacity:this._context.layer.opacity??1}_getCombinedOpacity(e,t=VZ){let n=1;return this.draped||(n*=this._getLayerOpacity()),this._drivenProperties.opacity||(T(e)?n*=e.a:t.hasIntrinsicColor||(n=0)),n}_getCombinedOpacityAndColor(e,t=VZ){const n=this._getCombinedOpacity(e,t);if(this._drivenProperties.color)return PE(null,n);const r=T(e)?Xt.toUnitRGB(e):Zv;return PE(r,n)}_getVertexOpacityAndColor(e,t=null){const n=this._drivenProperties.color?e.color:null,r=this._drivenProperties.opacity?e.opacity:null,s=PE(n,r);return T(t)&&(s[0]*=t,s[1]*=t,s[2]*=t,s[3]*=t),s}isFastUpdatesEnabled(){return this._fastUpdates&&this._fastUpdates.enabled}computeComplexity(){return ofe(this.symbol,this.symbolLayer)}globalPropertyChanged(e,t,n){switch(e){case"opacity":return this.layerOpacityChanged(t,n),!0;case"elevationInfo":{const r=this._elevationContext.mode;return this._updateElevationContext(),this.layerElevationInfoChanged(t,n,r)!==Fr.RECREATE}case"slicePlaneEnabled":return this.slicePlaneEnabledChanged(t,n);case"physicalBasedRenderingEnabled":return this.physicalBasedRenderingChanged();case"pixelRatio":return this.pixelRatioChanged();default:return!1}}updateGraphics3DGraphicElevationInfo(e,t,n){let r=Fr.UPDATE;return e.forEach(s=>{const a=t(s);if(T(a)){const o=s.graphic;this.setGraphicElevationContext(o,a.elevationContext),a.needsElevationUpdates=n(a.elevationContext.mode)}else r=Fr.RECREATE}),r}applyRendererDiff(e,t){return Ns.Recreate_Symbol}getFastUpdateAttrValues(e){if(!this._fastUpdates.enabled)return null;const t=this._fastUpdates.visualVariables,n=t.size?$m(t.size.field,e):0,r=t.color?$m(t.color.field,e):0,s=t.opacity?$m(t.opacity.field,e):0;return Xn(n,r,s,0)}get draped(){return this._draped}ensureDrapedStatus(e){return this._draped==null?(this._draped=e,!0):(e!==this.draped&&m1.warnOnce("A symbol can only produce either draped or non-draped visualizations. Use two separate symbol instances for draped and non-draped graphics if necessary."),!1)}test(){const e=()=>{var t,n,r,s,a,o,l,c,u,d,h,p;return{size:((r=(n=(t=this._fastUpdates)==null?void 0:t.visualVariables)==null?void 0:n.size)==null?void 0:r.field)??null,color:((o=(a=(s=this._fastUpdates)==null?void 0:s.visualVariables)==null?void 0:a.color)==null?void 0:o.field)??null,opacity:((u=(c=(l=this._fastUpdates)==null?void 0:l.visualVariables)==null?void 0:c.opacity)==null?void 0:u.field)??null,rotation:((p=(h=(d=this._fastUpdates)==null?void 0:d.visualVariables)==null?void 0:h.rotation)==null?void 0:p.field)??null}};return{drivenProperties:this._drivenProperties,getVisVarFields:e}}};function $m(i,e){const t=i!=null?e.attributes[i]:0;return t!=null&&isFinite(t)?t:0}function NZ(i){const e={color:!1,opacity:!1,opacityAlwaysOpaque:!0,size:!1};return i&&"visualVariables"in i&&i.visualVariables&&i.visualVariables.forEach(t=>{switch(t.type){case"color":if(e.color=!0,t.stops)for(let n=0;n<t.stops.length;n++){const r=t.stops[n].color;r&&(e.opacity=!0,r.a<1&&(e.opacityAlwaysOpaque=!1))}break;case"opacity":e.opacity=!0,e.opacityAlwaysOpaque=!1;break;case"size":e.size=!0}}),e}const Dut={mode:"on-the-ground",offset:0,unit:"meters"},kut={mode:"absolute-height",offset:0,unit:"meters"},VZ={hasIntrinsicColor:!1};let pb=class{constructor(){this._disposed=!1}get disposed(){return this._disposed}get shaderTransformation(){return this._shaderTransformation}acquire(e,t,n,r,s,a){this.id=tf(),this.geometry=e,this.material=t,this.transformation=n,this.instanceParameters=r,this.origin=s,this._shaderTransformation=a,this._disposed=!1}release(){this._disposed=!1}dispose(){this._disposed=!0}getStaticTransformation(){return this.transformation}getShaderTransformation(){return T(this._shaderTransformation)?this._shaderTransformation(this.transformation):this.transformation}computeAttachmentOrigin(e){return!!(this.material.computeAttachmentOrigin?this.material.computeAttachmentOrigin(this.geometry,e):this.geometry.computeAttachmentOrigin(e))&&($t(e,e,this.getStaticTransformation()),!0)}};pb.pool=new Ic(pb);let iL=class{constructor(e){this.channel=e,this.id=tf()}},xg=class extends One{constructor(e={}){super(),this.type=LC.Object,this._geometryRecords=new Array,this._geometries=new Array,this._objectTransformation=St(),this._bvObjectSpace=new BZ,this._bvWorldSpace=new BZ,this._bvDirty=!0,this._hasVolatileTransformation=!1,this._visible=!0,this.castShadow=e.castShadow==null||e.castShadow,this.metadata=e.metadata,this.metadata&&this.metadata.isElevationSource&&(this.metadata.lastValidElevationBB=new cfe);const{geometries:t,materials:n,transformations:r,origins:s}=e;if(Array.isArray(t)){Ti(n.length===t.length,"Object3D: materials don't match geometries"),Ti(r.length===t.length,"Object3D: transformations don't match geometries"),this._geometryRecords.length=t.length,this._geometries.length=t.length;for(let a=0;a<t.length;a++)this._geometries[a]=t[a],this._geometryRecords[a]=pb.pool.acquire(t[a],n[a],iR(r[a]),{highlights:null,occludees:null,visible:this._visible},s&&s[a])}}get geometryRecords(){return this._geometryRecords}get geometries(){return this._geometries}get transformation(){return this._objectTransformation}set transformation(e){da(this._objectTransformation,e),this._invalidateBoundingVolume(),this._emit("objectTransformation",this)}dispose(){this._geometryRecords.length=0,this._geometries.length=0}get parentLayer(){return this._parentLayer}set parentLayer(e){Ti(this._parentLayer==null||e==null,"Object3D can only be added to a single Layer"),this._parentLayer=e}addGeometry(e,t,n,r,s){n=n||Ks,this._geometries.push(e);const a=pb.pool.acquire(e,t,n,{highlights:null,occludees:null,visible:this._visible},r,s);return this._geometryRecords.push(a),this._hasVolatileTransformation=this._hasVolatileTransformation||T(a.shaderTransformation),this._emit("objectGeometryAdded",{object:this,record:a}),this._invalidateBoundingVolume(),a}removeGeometry(e){const t=this._geometryRecords.splice(e,1)[0];return this._hasVolatileTransformation=T(t.shaderTransformation)?this._geometryRecords.some(n=>T(n.shaderTransformation)):this._hasVolatileTransformation,t.dispose(),this._geometries.splice(e,1),this._emit("objectGeometryRemoved",{object:this,record:t}),this._invalidateBoundingVolume(),t}removeAllGeometries(){for(;this.geometryRecords.length>0;)this.removeGeometry(0)}geometryVertexAttrsUpdated(e){this._emit("vertexAttrsUpdated",{object:this,record:e}),this._invalidateBoundingVolume()}get isVisible(){return this._visible}setVisible(e){if(this._visible!==e){this._visible=e;for(const t of this._geometryRecords)t.instanceParameters.visible=this._visible;this._emit("visibilityChanged",this)}}maskOccludee(){const e=new iL(nb.MaskOccludee);for(const t of this._geometryRecords)t.instanceParameters.occludees=ZN(t.instanceParameters.occludees,e);return this._emit("occlusionChanged",this),e}removeOcclude(e){for(const t of this._geometryRecords)t.instanceParameters.occludees=QN(t.instanceParameters.occludees,e);this._emit("occlusionChanged",this)}highlight(){const e=new iL(nb.Highlight);for(const t of this._geometryRecords)t.instanceParameters.highlights=ZN(t.instanceParameters.highlights,e);return this._emit("highlightChanged",this),e}removeHighlight(e){for(const t of this._geometryRecords)t.instanceParameters.highlights=QN(t.instanceParameters.highlights,e);this._emit("highlightChanged",this)}getCombinedStaticTransformation(e,t){return Vs(t,this.transformation,e.getStaticTransformation())}_getCombinedShaderTransformation(e){return Vs(St(),this.transformation,e.getShaderTransformation())}hasVolativeTransformation(){return this._hasVolatileTransformation}get boundingVolumeWorldSpace(){return this._validateBoundingVolume(),this._bvWorldSpace}get boundingVolumeObjectSpace(){return this._validateBoundingVolume(),this._bvObjectSpace}_validateBoundingVolume(){if(!this._bvDirty&&!this._hasVolatileTransformation)return;this._bvObjectSpace.init(),this._bvWorldSpace.init();for(let r=0;r<this._geometryRecords.length;++r){const s=this._geometries[r],a=this._geometryRecords[r],o=s.boundingInfo;T(o)&&(this._calculateTransformedBoundingVolume(o,this._bvObjectSpace,a.getShaderTransformation()),this._calculateTransformedBoundingVolume(o,this._bvWorldSpace,this._getCombinedShaderTransformation(a)))}oo(this._bvObjectSpace.bounds,this._bvObjectSpace.min,this._bvObjectSpace.max,.5),oo(this._bvWorldSpace.bounds,this._bvWorldSpace.min,this._bvWorldSpace.max,.5);const e=q(),t=q(),n=J0(this.transformation);for(let r=0;r<this._geometryRecords.length;++r){const s=this._geometries[r].boundingInfo;if(B(s))continue;const a=this._geometryRecords[r].getShaderTransformation(),o=J0(a);$t(e,s.getCenter(),a);const l=Gn(e,this._bvObjectSpace.bounds),c=s.getBSRadius()*o;this._bvObjectSpace.bounds[3]=Math.max(this._bvObjectSpace.bounds[3],l+c),$t(t,e,this.transformation);const u=Gn(t,this._bvWorldSpace.bounds),d=c*n;this._bvWorldSpace.bounds[3]=Math.max(this._bvWorldSpace.bounds[3],u+d)}this._bvDirty=!1}_calculateTransformedBoundingVolume(e,t,n){const r=e.getBBMin(),s=e.getBBMax(),a=Ts(r),o=Ts(s);$t(a,a,n),$t(o,o,n);for(let l=0;l<3;++l)t.min[l]=Math.min(t.min[l],a[l],o[l]),t.max[l]=Math.max(t.max[l],a[l],o[l]);for(let l=0;l<3;++l){Ge(a,r),Ge(o,s),a[l]=s[l],o[l]=r[l],$t(a,a,n),$t(o,o,n);for(let c=0;c<3;++c)t.min[c]=Math.min(t.min[c],a[c],o[c]),t.max[c]=Math.max(t.max[c],a[c],o[c])}}_invalidateBoundingVolume(){this._bvDirty=!0,T(this._parentLayer)&&this._parentLayer.notifyObjectBBChanged(this,this._bvWorldSpace.bounds)}_emit(e,t){T(this._parentLayer)&&this._parentLayer.events.emit(e,t)}get test(){const e=this;return{hasGeometry:t=>e._geometries.includes(t),getGeometryIndex:t=>e._geometries.indexOf(t)}}},cfe=class{constructor(){this.min=Gt(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this.max=Gt(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE)}isEmpty(){return this.max[0]<this.min[0]&&this.max[1]<this.min[1]&&this.max[2]<this.min[2]}},BZ=class extends cfe{constructor(){super(...arguments),this.bounds=gf()}init(){je(this.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),je(this.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),P0e(this.bounds)}};const ey=q();function S7(i,e,t,n,r,s,a,o){const l=t?t.length:0,c=i.clippingExtent;if(ya(e,ey,i.elevationProvider.spatialReference),T(c)&&!oz(c,ey))return null;ya(e,ey,i.renderCoordsHelper.spatialReference);const u=i.localOriginFactory.getOrigin(ey),d=new xg({castShadow:!1,metadata:{layerUid:s,graphicUid:a,usesVerticalDistanceToGround:!0}});for(let h=0;h<l;h++){const p=Ks;d.addGeometry(t[h],n[h],p,u,o)}return{object:d,sampledElevation:mut(d,e,i.elevationProvider,i.renderCoordsHelper,r)}}function bA(i,e,t){const n=i.elevationContext,r=t.spatialReference;ya(e,ey,r),n.centerPointInElevationSR=Id(ey[0],ey[1],e.hasZ?ey[2]:0,T(r)?r:null)}function wA(i){switch(i.type){case"point":return i;case"polygon":case"extent":return v7(i);case"polyline":{const e=i.paths[0];if(!e||e.length===0)return null;const t=Hie(e,Gie(e)/2);return Id(t[0],t[1],t[2],i.spatialReference)}case"mesh":return i.origin}return null}let E7=class extends _n{initializeConfiguration(e,t){t.spherical=e.viewingMode===Ot.Global}initializeProgram(e){return new gn(e.rctx,E7.shader.get().build(this.configuration),Mn)}setPipelineState(e){const t=e?lo.ALWAYS:lo.LESS;return this.configuration.depthHudEnabled?yi({depthTest:{func:t},depthWrite:Lu}):yi({blending:Na(vt.ONE,vt.SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),depthTest:{func:t},colorWrite:$i})}initializePipeline(){return this.setPipelineState(this.configuration.hasMultipassGeometry)}};E7.shader=new bn(Q1e,()=>Ee(()=>import("./LineCallout.glsl-e237208d.js"),["./LineCallout.glsl-e237208d.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./mat4f64-1e28eae0.js","./vec3-a020a6f6.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./HUD.glsl-80cf9a21.js","./ReadLinearDepth.glsl-7ff30f7d.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./VerticalOffset.glsl-86460edb.js","./vec4-790471c0.js","./Float4PassUniform-3a47b7b3.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./FloatPassUniform-d2dfc562.js","./VertexAttribute-9c5c630d.js","./LineCallout.glsl-a0056465.js","./Slice.glsl-a612de15.js"],import.meta.url));let ju=class extends yf{constructor(){super(...arguments),this.screenCenterOffsetUnitsEnabled=_y.World,this.spherical=!1,this.occlusionTestEnabled=!0,this.hasVerticalOffset=!1,this.hasScreenSizePerspective=!1,this.depthHudEnabled=!1,this.depthHudAlignStartEnabled=!1,this.hasSlicePlane=!1,this.hasMultipassGeometry=!1}};f([Pe({count:_y.COUNT})],ju.prototype,"screenCenterOffsetUnitsEnabled",void 0),f([Pe()],ju.prototype,"spherical",void 0),f([Pe()],ju.prototype,"occlusionTestEnabled",void 0),f([Pe()],ju.prototype,"hasVerticalOffset",void 0),f([Pe()],ju.prototype,"hasScreenSizePerspective",void 0),f([Pe()],ju.prototype,"depthHudEnabled",void 0),f([Pe()],ju.prototype,"depthHudAlignStartEnabled",void 0),f([Pe()],ju.prototype,"hasSlicePlane",void 0),f([Pe()],ju.prototype,"hasMultipassGeometry",void 0),f([Pe({constValue:!0})],ju.prototype,"hasSliceInVertexProgram",void 0),f([Pe({constValue:!1})],ju.prototype,"isDraped",void 0);let qw=class extends ug{constructor(e){super(e,new Nut),this._configuration=new ju,this._uniqueMaterialIdentifier=qw.uniqueMaterialIdentifier(this.parameters)}get uniqueMaterialIdentifier(){return this._uniqueMaterialIdentifier}getPassParameters(){return this.parameters}getConfiguration(e,t){const n=(t==null?void 0:t.slot)!==at.LINE_CALLOUTS;return this._configuration.occlusionTestEnabled=this.parameters.occlusionTest,this._configuration.hasVerticalOffset=T(this.parameters.verticalOffset),this._configuration.hasScreenSizePerspective=T(this.parameters.screenSizePerspective),this._configuration.depthHudEnabled=n,this._configuration.depthHudAlignStartEnabled=!!this.parameters.depthHUDAlignStart,this._configuration.screenCenterOffsetUnitsEnabled=this.parameters.centerOffsetUnits==="screen"?_y.Screen:_y.World,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasMultipassGeometry=t.multipassGeometry.enabled,this._configuration}intersect(){}requiresSlot(e,t){if(t===Re.Color)switch(e){case at.LINE_CALLOUTS:case at.LINE_CALLOUTS_HUD_DEPTH:return!0}return!1}createGLMaterial(e){return new Fut(e)}createBufferWriter(){return new But}validateParameters(e){const t=qw.uniqueMaterialIdentifier(e);t!==this._uniqueMaterialIdentifier&&(this._uniqueMaterialIdentifier=t)}static uniqueMaterialIdentifier(e){return JSON.stringify({screenOffset:e.screenOffset||[0,0],centerOffsetUnits:e.centerOffsetUnits||"world"})}},Fut=class extends Sb{beginSlot(e){return this.ensureTechnique(E7,e)}},Nut=class extends YA{constructor(){super(...arguments),this.screenOffset=Z0,this.color=[0,0,0,1],this.size=1,this.occlusionTest=!1,this.shaderPolygonOffset=1e-5,this.depthHUDAlignStart=!1,this.centerOffsetUnits="world",this.hasSlicePlane=!1}};const Vut=Js().vec3f(j.POSITION).vec3f(j.NORMAL).vec2f(j.UV0).vec4f(j.AUXPOS1),zZ=[Rv(0,0),Rv(1,0),Rv(0,1),Rv(1,0),Rv(1,1),Rv(0,1)];let But=class{constructor(){this.vertexBufferLayout=Vut}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 6*e.indices.get(j.POSITION).length}write(e,t,n,r,s){YB(n.indices.get(j.POSITION),n.vertexAttributes.get(j.POSITION).data,e,r.position,s,6),Hne(n.indices.get(j.NORMAL),n.vertexAttributes.get(j.NORMAL).data,t,r.normal,s,6),g2(n.indices.get(j.AUXPOS1),n.vertexAttributes.get(j.AUXPOS1).data,r.auxpos1,s,6);for(let a=0;a<zZ.length;++a)r.uv0.setVec(s+a,zZ[a])}},A7=class extends xf{constructor(e,t){super(e,null,t,Hut),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){this._material=new qw(this._materialParameters),this._context.stage.add(this._material)}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}_perInstanceMaterialParameters(e){const t=this._materialParameters;return t.screenOffset=e.screenOffset||Z0,t.centerOffsetUnits=e.centerOffsetUnits||"world",t}get _materialParameters(){const e=this.symbol,t=e.callout,n=T(t.color)?Xt.toUnitRGBA(t.color):[0,0,0,0];n[3]*=this._getLayerOpacity();const r=Hn(t.size||0);let s=null;if(e.verticalOffset){const{screenLength:d,minWorldLength:h,maxWorldLength:p}=e.verticalOffset;s={screenLength:Hn(d),minWorldLength:h||0,maxWorldLength:T(p)?p:1/0}}const a=T(t.border)&&T(t.border.color)?Xt.toUnitRGBA(t.border.color):null,o=e.symbolLayers.getItemAt(0).type==="object",l=!o,c=o?0:void 0,u=e.type==="label-3d";return{color:n,size:r,verticalOffset:s,screenSizePerspective:this._context.screenSizePerspectiveEnabled?this._context.sharedResources.screenSizePerspectiveSettings:null,screenOffset:[0,0],centerOffsetUnits:"world",borderColor:a,occlusionTest:l,shaderPolygonOffset:c,depthHUDAlignStart:u,hasSlicePlane:this._context.slicePlaneEnabled,renderOccluded:Qr.Occlude,__tagStrict:"NoParameters"}}_defaultElevationInfoNoZ(){return Uut}createGraphics3DGraphic(e){const t=e.renderingInfo,n=e.graphic,r=this.setGraphicElevationContext(n,new Dd,t.elevationOffset||0),s=t.symbol,a=this._elevationContext.mode==="on-the-ground"&&(s.type==="cim"||!s.symbolLayers.some(l=>l.type==="object"||l.type==="text"));if(s.type!=="label-3d"&&a||s.type==="point-3d"&&s.symbolLayers.every(l=>l.type==="text"&&!Bie(l)))return null;const o=v7(n.geometry);return B(o)?null:this._createAs3DShape(o,r,t,n.uid)}layerOpacityChanged(){T(this._material)&&this._material.setParameters(this._materialParameters)}layerElevationInfoChanged(e,t,n){const r=this._elevationContext.mode,s=yM(A7.elevationModeChangeTypes,n,r);return s!==Fr.UPDATE||e.forEach(a=>{const o=t(a);T(o)&&this.updateGraphicElevationContext(a.graphic,o)}),s}slicePlaneEnabledChanged(){return B(this._material)||this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}setGraphicElevationContext(e,t,n=0){const r=super.setGraphicElevationContext(e,t);return r.addOffsetRenderUnits(n),r}updateGraphicElevationContext(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Rd(t.elevationContext.mode)}computeComplexity(){return{primitivesPerFeature:2,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:C7.memory}}_createVertexData(e){const{translation:t,centerOffset:n}=e,r=t?{size:3,data:[t[0],t[1],t[2]],exclusive:!0}:{size:3,data:[0,0,0],exclusive:!0},s=n?{size:4,data:[n[0],n[1],n[2],n[3]],exclusive:!0}:{size:4,data:[0,0,0,1],exclusive:!0};return[[j.POSITION,r],[j.NORMAL,{size:3,data:[0,0,1],exclusive:!0}],[j.AUXPOS1,s]]}_getOrCreateMaterial(e){const t=this._perInstanceMaterialParameters(e),n=qw.uniqueMaterialIdentifier(t);if(T(this._material)&&n===this._material.uniqueMaterialIdentifier)return{material:this._material,isUnique:!1};if(e.materialCollection){let r=e.materialCollection.get(n);return B(r)&&(r=new qw(t),e.materialCollection.add(n,r)),{material:r,isUnique:!1}}return{material:new qw(t),isUnique:!0}}_createAs3DShape(e,t,n,r){const s=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:r,layerUid:this._context.layer.uid}),a=[new Bs(this._createVertexData(n),zut,xh.Point,s)],o=this._getOrCreateMaterial(n),l=S7(this._context,e,a,[o.material],t,this._context.layer.uid,r);if(l===null)return null;const c=new wf(this,l.object,a,o.isUnique?[o.material]:null,null,_A,t);return c.metadata={elevationOffset:n.elevationOffset||0},c.alignedSampledElevation=l.sampledElevation,c.needsElevationUpdates=Rd(t.mode),bA(c,e,this._context.elevationProvider),c}};A7.elevationModeChangeTypes={definedChanged:Fr.UPDATE,staysOnTheGround:Fr.UPDATE,onTheGroundChanged:Fr.RECREATE};const XF=[0],zut=[[j.POSITION,XF],[j.NORMAL,XF],[j.AUXPOS1,XF]],Uut={mode:"relative-to-ground",offset:0},Hut={ignoreDrivers:!0,renderPriority:0,renderPriorityStep:1},UZ=tt.getLogger("esri.views.3d.layers.graphics.Graphics3DCalloutSymbolLayerFactory");function Gut(i,e){if(!pB(i))return UZ.error("Graphics3DCalloutSymbolLayerFactory#make",`symbol of type '${i.type}' does not support callouts`),null;if(!i.callout)return null;const t=Wut[i.callout.type];return t?new t(i,e):(UZ.error("Graphics3DCalloutSymbolLayerFactory#make",`unknown or unsupported callout type ${i.callout.type}`),null)}const Wut={line:A7};let jut=class{constructor(e,t,n){this.graphic=e,this.renderingInfo=t,this.layer=n}};const HZ=new Ic(Array,i=>lz(i,k1e),null,10,5),qut=qi();let Kut=class{constructor(e,t,n,r,s){this.graphic=e,this.graphics3DSymbol=t,this.graphics=n,this._labelGraphics=new Array,this._auxiliaryGraphics=new Array,this._visibilityFlags=Yut(Ia._COUNT,xu._COUNT),this._featureExpressionFeature=null,this._optimizedGeometry={geometry:null,hasZ:!1,hasM:!1},this._extent=null,this.isElevationSource=!1,++t.referenced,this._featureExpressionFeature=s?nfe(s,e,r):null;for(const a of n)T(a)&&(this.isElevationSource=this.isElevationSource||a.isElevationSource)}get labelGraphics(){return this._labelGraphics}get extent(){return this._extent}initialize(e,t){this._layer=t,this._stage=e,this._forEachSymbolLayerGraphic(n=>{n.initialize(e,t),n.setVisibility(this.isVisible())})}destroy(){this._forEachSymbolLayerGraphic(e=>e.destroy()),this.graphics=null,this._auxiliaryGraphics=null,--this.graphics3DSymbol.referenced,this.graphics3DSymbol=null}get destroyed(){return this.graphics==null}clearLabelGraphics(){this._forEachLabelGraphic(e=>e.destroy()),this._labelGraphics.length=0}addLabelGraphic(e,t,n){this._labelGraphics.push(e),e.initialize(t,n),e.setVisibility(this.isVisible(Ia.LABEL))}addAuxiliaryGraphic(e){this._auxiliaryGraphics.push(e),this._layer&&(e.initialize(this._stage,this._layer),e.setVisibility(this.isVisible()))}get isDraped(){let e=!1;return this._forEachSymbolLayerGraphic(t=>{t.type==="draped"&&(e=!0)}),e}isVisible(e=Ia.GRAPHIC,t){for(let n=0;n<=e;n++){const r=this._visibilityFlags[n];for(let s=0;s<r.length;++s)if(r[s]===!1&&s!==t)return!1}return!0}hasVisibilityFlag(e,t){return this._visibilityFlags[t][e]!=null}setVisibilityFlag(e,t,n){const r=this.isVisible(n);this._visibilityFlags[n][e]=t;const s=this.isVisible(n);if(r===s)return!1;if(n===Ia.LABEL)this._forEachLabelGraphic(a=>a.setVisibility(s));else{this._forEachSymbolLayerGraphic(o=>o.setVisibility(s));const a=this.isVisible(Ia.LABEL);this._forEachLabelGraphic(o=>o.setVisibility(a))}return!0}clearVisibilityFlag(e,t=Ia.GRAPHIC){return this.setVisibilityFlag(e,void 0,t)}computeExtent(e){if(!this._extent){const t=this.graphic.geometry;if(B(t))return!1;this._extent=qi(),U1e(t,this._extent);const n=t.spatialReference;if(!Vc(n,e)&&!zL(this._extent,n,this._extent,e))return this._extent=null,!1}return!0}getAsOptimizedGeometry(e,t){return T(this._optimizedGeometry.geometry)&&this._optimizedGeometry.hasZ===e&&this._optimizedGeometry.hasM===t||(this._optimizedGeometry.geometry=this._convertGraphicToOptimizedGeometry(this.graphic,e,t),this._optimizedGeometry.hasZ=e,this._optimizedGeometry.hasM=t),this._optimizedGeometry.geometry}_convertGraphicToOptimizedGeometry(e,t,n){let r=e.geometry;return r.type!=="mesh"&&r.type!=="extent"||(r=Om.fromExtent(r.type==="mesh"?r.extent:r)),k_e(r,t,n)}get usedMemory(){let e=Zye(this.graphic.attributes);return this._forEachSymbolLayerGraphic(t=>{const n=t.graphics3DSymbolLayer.complexity;if(B(n))return;const r=t.type==="draped"?n.memory.draped:n.memory;e+=r.bytesPerFeature,r.bytesPerCoordinate&&(e+=H1e(this.graphic.geometry)*r.bytesPerCoordinate)}),e}computeAttachmentOrigin(){const e={render:{origin:q(),num:0},draped:{origin:xt(),num:0}};for(const t of this.graphics)B(t)||t.computeAttachmentOrigin(e);return e.render.num&&Ye(e.render.origin,e.render.origin,1/e.render.num),e.draped.num&&Po(e.draped.origin,e.draped.origin,1/e.draped.num),e}async getProjectedBoundingBox(e,t,n,r,s){return s||(s={boundingBox:null,requiresDrapedElevation:!1,screenSpaceObjects:[]}),s.boundingBox?fr(s.boundingBox):s.boundingBox=fr(),s.requiresDrapedElevation=!1,await _B(this.graphics,async a=>{if(B(a))return;const o=a.type==="draped"?t:e,l=HZ.acquire(),c=await a.getProjectedBoundingBox(o,n,s.screenSpaceObjects,r,l);isFinite(c[2])&&isFinite(c[5])||(s.requiresDrapedElevation=!0),c&&jx(s.boundingBox,l),HZ.release(l)}),F1e(s.boundingBox)||GN(sz(s.boundingBox,qut))?s:null}needsElevationUpdates(){for(const e of this.graphics)if(T(e)&&(e.type==="object3d"||e.type==="lod-instance")&&e.needsElevationUpdates)return!0;for(const e of this._labelGraphics)if(e&&e.needsElevationUpdates)return!0;return!1}alignWithElevation(e,t,n){this._forEachRenderedGraphic(r=>{r.type!=="object3d"&&r.type!=="lod-instance"||r.alignWithElevation(e,t,this._featureExpressionFeature,n)})}addObjectStateSet(e,t){this._forEachSymbolLayerGraphic(n=>n.addObjectState(e,t))}removeObjectState(e){this._forEachSymbolLayerGraphic(t=>t.removeObjectState(e))}_forEachGraphicList(e,t){e.forEach(n=>n&&t(n))}_forEachSymbolLayerGraphic(e){this._forEachGraphicList(this.graphics,e),this._forEachGraphicList(this._auxiliaryGraphics,e)}_forEachLabelGraphic(e){this._forEachGraphicList(this._labelGraphics,e)}_forEachRenderedGraphic(e){this._forEachSymbolLayerGraphic(e),this._forEachLabelGraphic(e)}};function Yut(i,e){const t=new Array(i);for(let n=0;n<t.length;n++)t[n]=new Array(e);return t}function mD(i,e){if(!i||i.symbol)return null;const t=e&&e.renderer;return i&&T(t)&&t.getObservationRenderer?t.getObservationRenderer(i):t}function Xut(i,e){if(T(i.symbol))return i.symbol;const t=mD(i,e);return T(t)&&t.type!=="dot-density"?t.getSymbol(i,e):null}function hDt(i,e){const t=mD(i,e),n=Xut(i,e);if(B(n))return null;const r={renderer:t,symbol:n};if(B(t)||!("visualVariables"in t)||!t.visualVariables)return r;const s=lre(t,i,e)??[],a=["proportional","proportional","proportional"];for(const{variable:o,value:l}of s)switch(o.type){case"color":r.color=l.toRgba();break;case"size":if(o.target==="outline")r.outlineSize=l;else{const c=o.axis,u=o.useSymbolValue?"symbol-value":l;switch(c){case"width":a[0]=u;break;case"depth":a[1]=u;break;case"height":a[2]=u;break;case"width-and-depth":a[0]=a[1]=u;break;default:a[0]=a[1]=a[2]=u}}break;case"opacity":r.opacity=l;break;case"rotation":switch(o.axis){case"tilt":r.tilt=l;break;case"roll":r.roll=l;break;default:r.heading=l}}return a[0]==="proportional"&&a[1]==="proportional"&&a[2]==="proportional"||(r.size=a),r}async function Zut(i,e){if(T(i.symbol))return i.symbol;const t=mD(i,e);return T(t)?t.getSymbolAsync(i,e):null}async function pDt(i,e){const t=mD(i,e),n=await Zut(i,e);if(!n)return null;const r={renderer:t,symbol:n};if(!t||!("visualVariables"in t)||!t.visualVariables)return r;const s=lre(t,i,e)??[],a=["proportional","proportional","proportional"];for(const{variable:o,value:l}of s)if(o.type==="color")r.color=Xt.toUnitRGBA(l);else if(o.type==="size")if(o.target==="outline")r.outlineSize=l;else{const c=o.axis,u=o.useSymbolValue?"symbol-value":l;c==="width"?a[0]=u:c==="depth"?a[1]=u:c==="height"?a[2]=u:a[0]=a[1]=c==="width-and-depth"?u:a[2]=u}else o.type==="opacity"?r.opacity=l:o.type==="rotation"&&o.axis==="tilt"?r.tilt=l:o.type==="rotation"&&o.axis==="roll"?r.roll=l:o.type==="rotation"&&(r.heading=l);return(isFinite(a[0])||isFinite(a[1])||isFinite(a[2]))&&(r.size=a),r}function Qut(i,e=0){const t=i[e];return typeof t=="number"&&isFinite(t)?t:null}function Jut(i){for(let e=0;e<3;e++){const t=i[e];if(typeof t=="number")return isFinite(t)?t:0}return 0}function GZ(i){const e=[[j.POSITION,i.indices]],t=[[j.POSITION,{size:3,data:i.attributeData.position,exclusive:!0}]];return T(i.attributeData.color)&&(t.push([j.COLOR,{size:4,data:i.attributeData.color,exclusive:!0}]),e.push([j.COLOR,new Array(i.indices.length).fill(0)])),T(i.attributeData.uvMapSpace)&&(t.push([j.UVMAPSPACE,{size:4,data:i.attributeData.uvMapSpace,exclusive:!0}]),e.push([j.UVMAPSPACE,i.indices])),T(i.attributeData.boundingRect)&&(t.push([j.BOUNDINGRECT,{size:9,data:i.attributeData.boundingRect,exclusive:!0}]),e.push([j.BOUNDINGRECT,i.indices])),T(i.attributeData.mapPosition)&&(t.push([j.MAPPOS,{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),e.push([j.MAPPOS,i.indices])),new Bs(t,e,xh.Triangle,i.attributeData.objectAndLayerIdColor)}function WZ(i){const e=[[j.POSITION,i.indices],[j.UV0,i.indices]],t=[[j.POSITION,{size:3,data:i.attributeData.position,exclusive:!0}],[j.UV0,{size:2,data:i.attributeData.uv0,exclusive:!0}]];return T(i.attributeData.mapPosition)&&(t.push([j.MAPPOS,{size:3,data:i.attributeData.mapPosition,exclusive:!0}]),e.push([j.MAPPOS,i.indices])),new Bs(t,e)}function xA(i){switch(i.type){case"extent":if(i instanceof fs)return Om.fromExtent(i);break;case"polygon":return i}return null}let gD=class{constructor(e,t,n){this.renderData=e,this.layerUid=t,this.graphicsUid=n,this.outGeometries=new Array,this.outMaterials=new Array,this.outTransforms=new Array}};var OE,j6;(function(i){i[i.RasterImage=0]="RasterImage",i[i.Features=1]="Features"})(OE||(OE={})),function(i){i[i.WithRasterImage=0]="WithRasterImage",i[i.WithoutRasterImage=1]="WithoutRasterImage"}(j6||(j6={}));var br,cd,ei,RE,Ur,ha,Eo;(function(i){i[i.INNER=0]="INNER",i[i.OUTER=1]="OUTER"})(br||(br={})),function(i){i[i.REGULAR=0]="REGULAR",i[i.HAS_NORTH_POLE=1]="HAS_NORTH_POLE",i[i.HAS_SOUTH_POLE=2]="HAS_SOUTH_POLE",i[i.HAS_BOTH_POLES=3]="HAS_BOTH_POLES"}(cd||(cd={})),function(i){i[i.NORTH=0]="NORTH",i[i.NORTH_EAST=1]="NORTH_EAST",i[i.EAST=2]="EAST",i[i.SOUTH_EAST=3]="SOUTH_EAST",i[i.SOUTH=4]="SOUTH",i[i.SOUTH_WEST=5]="SOUTH_WEST",i[i.WEST=6]="WEST",i[i.NORTH_WEST=7]="NORTH_WEST"}(ei||(ei={})),function(i){i[i.OFF=0]="OFF",i[i.ON=1]="ON"}(RE||(RE={})),function(i){i[i.Color=0]="Color",i[i.ColorNoRasterImage=1]="ColorNoRasterImage",i[i.Highlight=2]="Highlight",i[i.Water=3]="Water",i[i.Occluded=4]="Occluded",i[i.ObjectAndLayerIdColor=5]="ObjectAndLayerIdColor"}(Ur||(Ur={})),function(i){i[i.FADING=0]="FADING",i[i.IMMEDIATE=1]="IMMEDIATE",i[i.UNFADED=2]="UNFADED"}(ha||(ha={})),function(i){i[i.INSIDE=0]="INSIDE",i[i.INTERSECTS=1]="INTERSECTS",i[i.OUTSIDE=2]="OUTSIDE"}(Eo||(Eo={}));let edt=class{constructor(e,t){this.vec3=e,this.id=t}};function IE(i,e,t,n){return new edt(Gt(i,e,t),n)}var ja;(function(i){i[i.None=0]="None",i[i.ColorAndWater=1]="ColorAndWater",i[i.Highlight=2]="Highlight",i[i.Occluded=3]="Occluded",i[i.ObjectAndLayerIdColor=4]="ObjectAndLayerIdColor"})(ja||(ja={}));let jZ=class{constructor(e,t){this.index=e,this.renderTargets=t,this._extent=qi(),this.resolution=0,this.renderLocalOrigin=IE(0,0,0,"O"),this.pixelRatio=1,this.mapUnitsPerPixel=1,this.canvasGeometries=new idt,this.validTargets=null,this.hasDrapedFeatureSource=!1,this.hasDrapedRasterSource=!1,this.hasTargetWithoutRasterImage=!1,this.index=e,this.validTargets=new Array(t.renderTargets.length).fill(!1)}get extent(){return this._extent}getValidTexture(e){return this.validTargets[e]?this.renderTargets.getTarget(e).getTexture():null}get _needsColorWithoutRasterImage(){return this.hasDrapedRasterSource&&this.hasDrapedFeatureSource&&this.hasTargetWithoutRasterImage}getColorTexture(e){const t=e===ja.ColorAndWater?this.renderTargets.getTarget(Ur.Color):e===ja.Highlight?this.renderTargets.getTarget(Ur.Highlight):e===ja.ObjectAndLayerIdColor?this.renderTargets.getTarget(Ur.ObjectAndLayerIdColor):this.renderTargets.getTarget(Ur.Occluded);return t?t.getTexture():null}getColorTextureNoRasterImage(){return this._needsColorWithoutRasterImage?this.getValidTexture(Ur.ColorNoRasterImage):this.hasDrapedFeatureSource?this.getValidTexture(Ur.Color):null}getNormalTexture(e){const t=e===ja.ColorAndWater?this.renderTargets.getTarget(Ur.Water):null;return t?t.getTexture():null}draw(e,t){const n=this.computeRenderTargetValidityBitfield();for(const r of this.renderTargets.renderTargets)r.type!==Ur.ColorNoRasterImage||this._needsColorWithoutRasterImage?this.validTargets[r.type]=e.drawTarget(this,r,t):this.validTargets[r.type]=!1;return n^this.computeRenderTargetValidityBitfield()?ZI.CHANGED:ZI.UNCHANGED}computeRenderTargetValidityBitfield(){const e=this.validTargets;return+e[Ur.Color]|+e[Ur.ColorNoRasterImage]<<1|+e[Ur.Highlight]<<2|+e[Ur.Water]<<3|+e[Ur.Occluded]<<4}setupGeometryViewsCyclical(e){this.setupGeometryViewsDirect();const t=.001*e.range;if(this._extent[0]-t<=e.min){const n=this.canvasGeometries.extents[this.canvasGeometries.numViews++];jI(this._extent,e.range,0,n)}if(this._extent[2]+t>=e.max){const n=this.canvasGeometries.extents[this.canvasGeometries.numViews++];jI(this._extent,-e.range,0,n)}}setupGeometryViewsDirect(){this.canvasGeometries.numViews=1,u2(this.canvasGeometries.extents[0],this._extent)}hasSomeSizedView(){for(let e=0;e<this.canvasGeometries.numViews;e++){const t=this.canvasGeometries.extents[e];if(t[0]!==t[2]&&t[1]!==t[3])return!0}return!1}applyViewport(e){e.setViewport(this.index===br.INNER?0:this.resolution,0,this.resolution,this.resolution)}};function tdt(i,e,t){return Math.min(cB(Math.max(i,e)+256),t)}let idt=class{constructor(){this.extents=[qi(),qi(),qi()],this.numViews=0}},ufe=class{constructor(e,t){this._size=o0e(),this._fbo=null,this._fbo=new ma(e,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR_MIPMAP_LINEAR,hasMipmap:t,maxAnisotropy:8,width:0,height:0})}dispose(){this._fbo=Ht(this._fbo)}getTexture(){return this._fbo?this._fbo.colorTexture:null}isValid(){return this._fbo!==null}resize(e,t){this._size[0]=e,this._size[1]=t,this._fbo.resize(this._size[0],this._size[1])}bind(e){e.bindFramebuffer(this._fbo)}generateMipMap(){const e=this._fbo.colorTexture;e.descriptor.hasMipmap&&e.generateMipmap()}disposeRenderTargetMemory(){var e;(e=this._fbo)==null||e.resize(0,0)}get gpuMemoryUsage(){var e;return((e=this._fbo)==null?void 0:e.gpuMemoryUsage)??0}},g1=class{constructor(e,t,n,r=!0){this.output=t,this.type=n,this.valid=!1,this.lastUsed=1/0,this.fbo=new ufe(e,r)}},ndt=class{constructor(e){this.renderTargets=[new g1(e,Re.Color,Ur.Color),new g1(e,Re.Color,Ur.ColorNoRasterImage),new g1(e,Re.Highlight,Ur.Highlight,!1),new g1(e,Re.Normal,Ur.Water),new g1(e,Re.Color,Ur.Occluded)],Fi("enable-feature:objectAndLayerId-rendering")&&this.renderTargets.push(new g1(e,Re.ObjectAndLayerIdColor,Ur.ObjectAndLayerIdColor))}getTarget(e){return this.renderTargets[e].fbo}dispose(){for(const e of this.renderTargets)e.fbo.dispose()}disposeRenderTargetMemory(){for(const e of this.renderTargets)e.fbo.disposeRenderTargetMemory()}validateUsageForTarget(e,t,n){if(e)t.lastUsed=n;else if(n-t.lastUsed>rdt)t.fbo.disposeRenderTargetMemory(),t.lastUsed=1/0;else if(t.lastUsed<1/0)return!0;return!1}get gpuMemoryUsage(){return this.renderTargets.reduce((e,t)=>e+t.fbo.gpuMemoryUsage,0)}};const rdt=1e3;let M7=class{constructor(){this._outer=new Map}clear(){this._outer.clear()}get empty(){return this._outer.size===0}get(e,t){var n;return(n=this._outer.get(e))==null?void 0:n.get(t)}set(e,t,n){const r=this._outer.get(e);r?r.set(t,n):this._outer.set(e,new Map([[t,n]]))}delete(e,t){const n=this._outer.get(e);n&&(n.delete(t),n.size===0&&this._outer.delete(e))}forEach(e){this._outer.forEach((t,n)=>e(t,n))}},dfe=class{constructor(e){this._context=e,this._perConstructorInstances=new M7,this._frameCounter=0,this._keepAliveFrameCount=qZ}get viewingMode(){return this._context.viewingMode}get constructionContext(){return this._context}dispose(){this._perConstructorInstances.forEach(e=>e.forEach(t=>t.technique.destroy())),this._perConstructorInstances.clear()}acquire(e,t=adt){const n=t.key;let r=this._perConstructorInstances.get(e,n);if(B(r)){const s=new e(this._context,t,()=>this.release(s));r=new sdt(s),this._perConstructorInstances.set(e,n,r)}return++r.refCount,r.technique}releaseAndAcquire(e,t,n){if(T(n)){if(t.key===n.key)return n;this.release(n)}return this.acquire(e,t)}release(e){if(B(e)||this._perConstructorInstances.empty)return;const t=this._perConstructorInstances.get(e.constructor,e.key);B(t)||(--t.refCount,t.refCount===0&&(t.refZeroFrame=this._frameCounter))}frameUpdate(){this._frameCounter++,this._keepAliveFrameCount!==qZ&&this._perConstructorInstances.forEach((e,t)=>{e.forEach((n,r)=>{n.refCount===0&&n.refZeroFrame+this._keepAliveFrameCount<this._frameCounter&&(n.technique.destroy(),this._perConstructorInstances.delete(t,r))})})}async reloadAll(){const e=new Array;this._perConstructorInstances.forEach((t,n)=>{const r=async(s,a)=>{const o=a.shader;o&&(await o.reload(),s.forEach(l=>l.technique.reload(this._context)))};e.push(r(t,n))}),await Promise.all(e)}},sdt=class{constructor(e){this.technique=e,this.refCount=0,this.refZeroFrame=0}};const qZ=-1,adt=new ic,vD=i=>{class e extends i{constructor(){super(...arguments),this._isDisposed=!1}dispose(){for(const n of this._managedDisposables??[]){const r=this[n];this[n]=null,r&&typeof r.dispose=="function"&&r.dispose()}this._isDisposed=!0}get isDisposed(){return this._isDisposed}}return e};let yD=class extends vD(class{}){};function qa(){return(i,e)=>{var t,n;i.hasOwnProperty("_managedDisposables")||(i._managedDisposables=((t=i._managedDisposables)==null?void 0:t.slice())??[]),(n=i._managedDisposables)==null||n.unshift(e)}}let hfe=class{constructor(e,t,n,r){this._textureRepository=e,this._techniqueRepository=t,this.materialChanged=n,this.requestRender=r,this._id2glMaterialRef=new M7}dispose(){this._textureRepository.dispose()}acquire(e,t,n){if(this._ownMaterial(e),!e.requiresSlot(t,n))return null;let r=this._id2glMaterialRef.get(n,e.id);if(B(r)){const s=e.createGLMaterial({material:e,techniqueRep:this._techniqueRepository,textureRep:this._textureRepository,output:n});r=new odt(s),this._id2glMaterialRef.set(n,e.id,r)}return r.ref(),r.glMaterial}release(e,t){const n=this._id2glMaterialRef.get(t,e.id);T(n)&&(n.unref(),n.referenced||(Ht(n.glMaterial),this._id2glMaterialRef.delete(t,e.id)))}_ownMaterial(e){T(e.repository)&&e.repository!==this&&tt.getLogger("esri.views.3d.webgl-engine.lib.GLMaterialRepository").error("Material is already owned by a different material repository"),e.repository=this}},odt=class{constructor(e){this.glMaterial=e,this._refCnt=0}ref(){++this._refCnt}unref(){--this._refCnt,Ti(this._refCnt>=0)}get referenced(){return this._refCnt>0}};const ldt={orderedRepackingEnabled:!1},cdt={rootOrigin:null},udt=["layerObjectAdded","layerObjectRemoved","layerObjectsAdded","layerObjectsRemoved","shaderTransformationChanged","objectTransformation","visibilityChanged","occlusionChanged","highlightChanged","objectGeometryAdded","objectGeometryRemoved","vertexAttrsUpdated"];let pfe=class extends One{constructor(e,t=""){super(),this.apiLayerUid=t,this.type=LC.Layer,this.events=new Pn,this.isSliceable=!1,this._objects=new pn,this._stageHandles=new mi,this.apiLayerUid=t,this.isVisible=(e==null?void 0:e.isVisible)??!0,this.isPickable=(e==null?void 0:e.isPickable)??!0,this.updatePolicy=(e==null?void 0:e.updatePolicy)??QI.ASYNC}get objects(){return this._objects}destroy(){this.detachStage(),this._stage=null}attachStage(e){this.detachStage(),this._stage=e;for(const t of udt)this._stageHandles.add(this.events.on(t,n=>e.handleEvent(t,n)))}detachStage(){this._stageHandles.removeAll(),this.invalidateSpatialQueryAccelerator()}add(e){this._objects.push(e),e.parentLayer=this,this.events.emit("layerObjectAdded",{layer:this,object:e}),T(this._octree)&&this._octree.add([e])}remove(e){this._objects.removeUnordered(e)&&(e.parentLayer=null,this.events.emit("layerObjectRemoved",{layer:this,object:e}),T(this._octree)&&this._octree.remove([e]))}addMany(e){this._objects.pushArray(e);for(const t of e)t.parentLayer=this;this.events.emit("layerObjectsAdded",{layer:this,objects:e}),T(this._octree)&&this._octree.add(e)}removeMany(e){const t=new Array;if(this._objects.removeUnorderedMany(e,e.length,t),t.length!==0){for(const n of t)n.parentLayer=null;this.events.emit("layerObjectsRemoved",{layer:this,objects:t}),T(this._octree)&&this._octree.remove(t)}}sync(){T(this._stage)&&this.updatePolicy!==QI.SYNC&&this._stage.syncLayer(this.id)}notifyObjectBBChanged(e,t){T(this._octree)&&this._octree.update(e,t)}getSpatialQueryAccelerator(){return B(this._octree)&&this._objects.length>50&&this._createOctree(),this._octree}shaderTransformationChanged(){this.invalidateSpatialQueryAccelerator(),this.events.emit("shaderTransformationChanged",this)}invalidateSpatialQueryAccelerator(){this._octree=_t(this._octree)}_createOctree(){this._octree=new hh(e=>e.boundingVolumeWorldSpace.bounds),this._octree.add(this._objects.data,this._objects.length)}};function nL(i){return T(i)&&i.type===LC.Layer}const ffe=new Map([[j.POSITION,0],[j.SUBDIVISIONFACTOR,1],[j.UV0,2],[j.AUXPOS1,3],[j.AUXPOS2,4],[j.COLOR,5],[j.COLORFEATUREATTRIBUTE,5],[j.SIZE,6],[j.SIZEFEATUREATTRIBUTE,6],[j.OPACITYFEATUREATTRIBUTE,7],[j.OBJECTANDLAYERIDCOLOR,8]]);let P7=class extends _n{initializeProgram(e){return new gn(e.rctx,P7.shader.get().build(this.configuration),ffe)}_makePipelineState(e,t){const n=this.configuration,r=e===ln.NONE,s=e===ln.FrontFace;return yi({blending:n.output===Re.Color||n.output===Re.Alpha?r?xd:Ly(e):null,depthTest:{func:Eb(e)},depthWrite:r?n.writeDepth&&Lu:JL(e),colorWrite:$i,stencilWrite:n.hasOccludees?Gm:null,stencilTest:n.hasOccludees?t?ib:Ab:null,polygonOffset:r||s?n.hasPolygonOffset&&KZ:XB})}initializePipeline(){const e=this.configuration;if(e.occluder){const t=e.hasPolygonOffset&&KZ;this._occluderPipelineTransparent=yi({blending:xd,polygonOffset:t,depthTest:XI,depthWrite:null,colorWrite:$i,stencilWrite:null,stencilTest:Wne}),this._occluderPipelineOpaque=yi({blending:xd,polygonOffset:t,depthTest:XI,depthWrite:null,colorWrite:$i,stencilWrite:jne,stencilTest:qne}),this._occluderPipelineMaskWrite=yi({blending:null,polygonOffset:t,depthTest:ZB,depthWrite:null,colorWrite:null,stencilWrite:Gm,stencilTest:ib})}return this._occludeePipelineState=this._makePipelineState(this.configuration.transparencyPassType,!0),this._makePipelineState(this.configuration.transparencyPassType,!1)}get primitiveType(){return this.configuration.wireframe?Qi.LINES:Qi.TRIANGLE_STRIP}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?e===at.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent:e===at.OCCLUDER_MATERIAL?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:super.getPipelineState(e,t)}};P7.shader=new bn(lwe,()=>Ee(()=>import("./RibbonLine.glsl-5e6cd1f8.js"),["./RibbonLine.glsl-5e6cd1f8.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./vec3f32-c9aa289f.js","./vec3f64-2f9cef06.js","./VertexAttribute-9c5c630d.js","./mat4-44a0988f.js","./common-c186b691.js","./vec3-a020a6f6.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./context-util-1e3c8cfc.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./promiseUtils-6684e352.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./LineStipple.glsl-de782d6a.js","./RgbaFloatEncoding.glsl-6036ca34.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./Float4PassUniform-3a47b7b3.js","./FloatPassUniform-d2dfc562.js","./floatRGBA-fa8308d2.js","./Texture-bbae5d9d.js","./compilerUtils-034cacb8.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./assets-0b172f07.js","./MarkerSizing.glsl-c6fa192a.js","./sdfPrimitives-a24e9cb2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./TransparencyPassType-cd195b0e.js","./DefaultTechniqueConfiguration-e8962072.js","./RibbonLine.glsl-2a3b4d4e.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./MultipassTerrainTest.glsl-e79d40de.js","./ReadLinearDepth.glsl-7ff30f7d.js","./PiUtils.glsl-0c0898f0.js","./AlphaCutoff-96178e0d.js"],import.meta.url));const KZ={factor:0,units:-4};var wc;(function(i){i[i.LEFT_JOIN_START=-2]="LEFT_JOIN_START",i[i.LEFT_JOIN_END=-1]="LEFT_JOIN_END",i[i.LEFT_CAP_START=-4]="LEFT_CAP_START",i[i.LEFT_CAP_END=-5]="LEFT_CAP_END",i[i.RIGHT_JOIN_START=2]="RIGHT_JOIN_START",i[i.RIGHT_JOIN_END=1]="RIGHT_JOIN_END",i[i.RIGHT_CAP_START=4]="RIGHT_CAP_START",i[i.RIGHT_CAP_END=5]="RIGHT_CAP_END"})(wc||(wc={}));let Kw=class extends ug{constructor(e){super(e,new hdt),this._configuration=new cwe,this._vertexAttributeLocations=ffe,this._layout=this.createLayout()}isClosed(e,t){return mfe(this.parameters,e,t)}getConfiguration(e,t){this._configuration.output=e,this._configuration.draped=t.slot===at.DRAPED_MATERIAL;const n=T(this.parameters.stipplePattern)&&e!==Re.Highlight;return this._configuration.stippleEnabled=n,this._configuration.stippleOffColorEnabled=n&&T(this.parameters.stippleOffColor),this._configuration.stippleScaleWithLineWidth=n&&this.parameters.stippleScaleWithLineWidth,this._configuration.stipplePreferContinuous=n&&this.parameters.stipplePreferContinuous,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.roundJoins=this.parameters.join==="round",this._configuration.capType=this.parameters.cap,this._configuration.applyMarkerOffset=!!T(this.parameters.markerParameters)&&fdt(this.parameters.markerParameters),this._configuration.hasPolygonOffset=this.parameters.hasPolygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.innerColorEnabled=this.parameters.innerWidth>0&&T(this.parameters.innerColor),this._configuration.falloffEnabled=this.parameters.falloff>0,this._configuration.occluder=this.parameters.renderOccluded===Qr.OccludeAndTransparentStencil,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration.wireframe=this.parameters.wireframe,this._configuration}intersect(e,t,n,r,s,a,o,l,c){T(c)?this._intersectDrapedLineGeometry(e,r,c,a,o):this._intersectLineGeometry(e,t,n,r,o)}_intersectDrapedLineGeometry(e,t,n,r,s){if(!t.options.selectionMode)return;const a=e.vertexAttributes.get(j.POSITION).data,o=e.vertexAttributes.get(j.SIZE);let l=this.parameters.width;if(this.parameters.vvSizeEnabled){const m=e.vertexAttributes.get(j.SIZEFEATUREATTRIBUTE).data[0];l*=lt(this.parameters.vvSizeOffset[0]+m*this.parameters.vvSizeFactor[0],this.parameters.vvSizeMinSize[0],this.parameters.vvSizeMaxSize[0])}else o&&(l*=o.data[0]);const c=r[0],u=r[1],d=(l/2+4)*e.screenToWorldRatio;let h=Number.MAX_VALUE,p=0;for(let m=0;m<a.length-5;m+=3){const g=a[m],_=a[m+1],b=c-g,x=u-_,w=a[m+3]-g,C=a[m+4]-_,S=lt((w*b+C*x)/(w*w+C*C),0,1),E=w*S-b,A=C*S-x,P=E*E+A*A;P<h&&(h=P,p=m/3)}h<d*d&&s(n.dist,n.normal,p,!1)}_intersectLineGeometry(e,t,n,r,s){if(!r.options.selectionMode||ZL(t))return;if(!Yne(n))return void tt.getLogger("esri.views.3d.webgl-engine.materials.RibbonLineMaterial").error("intersection assumes a translation-only matrix");const a=e.vertexAttributes,o=a.get(j.POSITION).data;let l=this.parameters.width;if(this.parameters.vvSizeEnabled){const b=a.get(j.SIZEFEATUREATTRIBUTE).data[0];l*=lt(this.parameters.vvSizeOffset[0]+b*this.parameters.vvSizeFactor[0],this.parameters.vvSizeMinSize[0],this.parameters.vvSizeMaxSize[0])}else a.has(j.SIZE)&&(l*=a.get(j.SIZE).data[0]);const c=r.camera,u=mdt;Zs(u,r.point);const d=l*c.pixelRatio/2+4*c.pixelRatio;je(VT[0],u[0]-d,u[1]+d,0),je(VT[1],u[0]+d,u[1]+d,0),je(VT[2],u[0]+d,u[1]-d,0),je(VT[3],u[0]-d,u[1]-d,0);for(let b=0;b<4;b++)if(!c.unprojectFromRenderScreen(VT[b],Lf[b]))return;Dp(c.eye,Lf[0],Lf[1],QF),Dp(c.eye,Lf[1],Lf[2],JF),Dp(c.eye,Lf[2],Lf[3],e4),Dp(c.eye,Lf[3],Lf[0],t4);let h=Number.MAX_VALUE,p=0;const m=q6(this.parameters,a,e.indices)?o.length-2:o.length-5;for(let b=0;b<m;b+=3){bl[0]=o[b]+n[12],bl[1]=o[b+1]+n[13],bl[2]=o[b+2]+n[14];const x=(b+3)%o.length;if(wl[0]=o[x]+n[12],wl[1]=o[x+1]+n[13],wl[2]=o[x+2]+n[14],tr(QF,bl)<0&&tr(QF,wl)<0||tr(JF,bl)<0&&tr(JF,wl)<0||tr(e4,bl)<0&&tr(e4,wl)<0||tr(t4,bl)<0&&tr(t4,wl)<0)continue;if(c.projectToRenderScreen(bl,o_),c.projectToRenderScreen(wl,l_),o_[2]<0&&l_[2]>0){nt(jh,bl,wl);const C=c.frustum,S=-tr(C[Jr.NEAR],bl)/dt(jh,ro(C[Jr.NEAR]));Ye(jh,jh,S),rt(bl,bl,jh),c.projectToRenderScreen(bl,o_)}else if(o_[2]>0&&l_[2]<0){nt(jh,wl,bl);const C=c.frustum,S=-tr(C[Jr.NEAR],wl)/dt(jh,ro(C[Jr.NEAR]));Ye(jh,jh,S),rt(wl,wl,jh),c.projectToRenderScreen(wl,l_)}else if(o_[2]<0&&l_[2]<0)continue;o_[2]=0,l_[2]=0;const w=kB(D0(o_,l_,ZZ),u);w<h&&(h=w,Ge(YZ,bl),Ge(XZ,wl),p=b/3)}const g=r.rayBegin,_=r.rayEnd;if(h<d*d){let b=Number.MAX_VALUE;if(mne(D0(YZ,XZ,ZZ),D0(g,_,gdt),a_)){nt(a_,a_,g);const x=Et(a_);Ye(a_,a_,1/x),b=x/Gn(g,_)}s(b,a_,p,!1)}}computeAttachmentOrigin(e,t){const n=e.vertexAttributes;if(!n)return!1;const r=e.indices,s=n.get(j.POSITION);return QB(s,r?r.get(j.POSITION):null,r&&q6(this.parameters,n,r),t)}createLayout(){const e=Js().vec3f(j.POSITION).f32(j.SUBDIVISIONFACTOR).vec2f(j.UV0).vec3f(j.AUXPOS1).vec3f(j.AUXPOS2);return this.parameters.vvSizeEnabled?e.f32(j.SIZEFEATUREATTRIBUTE):e.f32(j.SIZE),this.parameters.vvColorEnabled?e.f32(j.COLORFEATUREATTRIBUTE):e.vec4f(j.COLOR),this.parameters.vvOpacityEnabled&&e.f32(j.OPACITYFEATUREATTRIBUTE),Fi("enable-feature:objectAndLayerId-rendering")&&e.vec4u8(j.OBJECTANDLAYERIDCOLOR),e}createBufferWriter(){return new pdt(this._layout,this.parameters)}requiresSlot(e,t){return t===Re.Color||t===Re.Alpha||t===Re.Highlight||t===Re.Depth||t===Re.ObjectAndLayerIdColor?e===at.DRAPED_MATERIAL?!0:this.parameters.renderOccluded===Qr.OccludeAndTransparentStencil?e===at.OPAQUE_MATERIAL||e===at.OCCLUDER_MATERIAL||e===at.TRANSPARENT_OCCLUDER_MATERIAL:t===Re.Color||t===Re.Alpha?e===(this.parameters.writeDepth?at.TRANSPARENT_MATERIAL:at.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):e===at.OPAQUE_MATERIAL:!1}createGLMaterial(e){return new ddt(e)}validateParameters(e){e.join!=="miter"&&(e.miterLimit=0),T(e.markerParameters)&&(e.markerScale=e.markerParameters.width/e.width)}},ddt=class extends Sb{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextureRepository.release(this._stipplePattern),this._stipplePattern=null}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){this._output!==Re.Color&&this._output!==Re.Alpha||this._updateOccludeeState(e);const t=this._material.parameters.stipplePattern;return this._stipplePattern!==t&&(this._material.setParameters(this._stippleTextureRepository.swap(this._stipplePattern,t)),this._stipplePattern=t),this.ensureTechnique(P7,e)}},hdt=class extends Rne{constructor(){super(...arguments),this.width=0,this.color=oh,this.join="miter",this.cap=cx.BUTT,this.miterLimit=5,this.writeDepth=!0,this.hasPolygonOffset=!1,this.stippleTexture=null,this.stippleScaleWithLineWidth=!1,this.stipplePreferContinuous=!0,this.markerParameters=null,this.markerScale=1,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.isClosed=!1,this.falloff=0,this.innerWidth=0,this.hasOccludees=!1,this.wireframe=!1}},pdt=class{constructor(e,t){this._parameters=t,this.numJoinSubdivisions=0,this.vertexBufferLayout=e;const n=t.stipplePattern?1:0;switch(this._parameters.join){case"miter":case"bevel":this.numJoinSubdivisions=n;break;case"round":this.numJoinSubdivisions=uwe+n}}_isClosed(e){return q6(this._parameters,e.vertexAttributes,e.indices)}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){const n=e.indices.get(j.POSITION).length/2+1,r=this._isClosed(e);let s=r?2:2*2;return s+=((r?n:n-1)-(r?0:1))*(2*this.numJoinSubdivisions+4),s+=2,this._parameters.wireframe&&(s=2+4*(s-2)),s}write(e,t,n,r,s){var G;const a=vdt,o=ydt,l=_dt,c=n.vertexAttributes.get(j.POSITION).data,u=n.indices&&n.indices.get(j.POSITION),d=(G=n.vertexAttributes.get(j.DISTANCETOSTART))==null?void 0:G.data;u&&u.length!==2*(c.length/3-1)&&console.warn("RibbonLineMaterial does not support indices");let h=1,p=0;this._parameters.vvSizeEnabled?p=n.vertexAttributes.get(j.SIZEFEATUREATTRIBUTE).data[0]:n.vertexAttributes.has(j.SIZE)&&(h=n.vertexAttributes.get(j.SIZE).data[0]);let m=[1,1,1,1],g=0;this._parameters.vvColorEnabled?g=n.vertexAttributes.get(j.COLORFEATUREATTRIBUTE).data[0]:n.vertexAttributes.has(j.COLOR)&&(m=n.vertexAttributes.get(j.COLOR).data);let _=null;Fi("enable-feature:objectAndLayerId-rendering")&&(_=n.objectAndLayerIdColor);let b=0;this._parameters.vvOpacityEnabled&&(b=n.vertexAttributes.get(j.OPACITYFEATUREATTRIBUTE).data[0]);const x=c.length/3,w=new Float32Array(r.buffer),C=Fi("enable-feature:objectAndLayerId-rendering")?new Uint8Array(r.buffer):null,S=this.vertexBufferLayout.stride/4;let E=s*S;const A=E;let P=0;const O=d?(H,k,D)=>P=d[D]:(H,k,D)=>P+=Gn(H,k),M=(H,k,D,$,F,Y,ne)=>{if(w[E++]=k[0],w[E++]=k[1],w[E++]=k[2],w[E++]=$,w[E++]=ne,w[E++]=F,w[E++]=H[0],w[E++]=H[1],w[E++]=H[2],w[E++]=D[0],w[E++]=D[1],w[E++]=D[2],this._parameters.vvSizeEnabled?w[E++]=p:w[E++]=h,this._parameters.vvColorEnabled)w[E++]=g;else{const X=Math.min(4*Y,m.length-4);w[E++]=m[X+0],w[E++]=m[X+1],w[E++]=m[X+2],w[E++]=m[X+3]}this._parameters.vvOpacityEnabled&&(w[E++]=b),Fi("enable-feature:objectAndLayerId-rendering")&&(T(_)&&(C[4*E+0]=_[0],C[4*E+1]=_[1],C[4*E+2]=_[2],C[4*E+3]=_[3]),E++)};E+=S,je(o,c[0],c[1],c[2]),e&&$t(o,o,e);const V=this._isClosed(n);if(V){const H=c.length-3;je(a,c[H],c[H+1],c[H+2]),e&&$t(a,a,e)}else je(l,c[3],c[4],c[5]),e&&$t(l,l,e),M(o,o,l,1,wc.LEFT_CAP_START,0,0),M(o,o,l,1,wc.RIGHT_CAP_START,0,0),Ge(a,o),Ge(o,l);const L=V?0:1,U=V?x:x-1;for(let H=L;H<U;H++){const k=(H+1)%x*3;je(l,c[k+0],c[k+1],c[k+2]),e&&$t(l,l,e),O(a,o,H),M(a,o,l,0,wc.LEFT_JOIN_END,H,P),M(a,o,l,0,wc.RIGHT_JOIN_END,H,P);const D=this.numJoinSubdivisions;for(let $=0;$<D;++$){const F=($+1)/(D+1);M(a,o,l,F,wc.LEFT_JOIN_END,H,P),M(a,o,l,F,wc.RIGHT_JOIN_END,H,P)}M(a,o,l,1,wc.LEFT_JOIN_START,H,P),M(a,o,l,1,wc.RIGHT_JOIN_START,H,P),Ge(a,o),Ge(o,l)}V?(je(l,c[3],c[4],c[5]),e&&$t(l,l,e),P=O(a,o,U),M(a,o,l,0,wc.LEFT_JOIN_END,L,P),M(a,o,l,0,wc.RIGHT_JOIN_END,L,P)):(P=O(a,o,U),M(a,o,o,0,wc.LEFT_CAP_END,U,P),M(a,o,o,0,wc.RIGHT_CAP_END,U,P)),ZF(w,A+S,w,A,S),E=ZF(w,E-S,w,E,S),this._parameters.wireframe&&this._addWireframeVertices(r,A,E,S)}_addWireframeVertices(e,t,n,r){const s=new Float32Array(e.buffer,n*Float32Array.BYTES_PER_ELEMENT),a=new Float32Array(e.buffer,t*Float32Array.BYTES_PER_ELEMENT,n-t);let o=0;const l=c=>o=ZF(a,c,s,o,r);for(let c=0;c<a.length-1;c+=2*r)l(c),l(c+2*r),l(c+1*r),l(c+2*r),l(c+1*r),l(c+3*r)}};function ZF(i,e,t,n,r){for(let s=0;s<r;s++)t[n++]=i[e++];return n}function q6(i,e,t){return mfe(i,e.get(j.POSITION).data,t?t.get(j.POSITION):null)}function mfe(i,e,t){return!!i.isClosed&&(t?t.length>2:e.length>6)}function fdt(i){return i.anchor===cre.Tip&&i.hideOnShortSegments&&i.placement==="begin-end"&&i.worldSpace}const bl=q(),wl=q(),jh=q(),a_=q(),mdt=q(),o_=pa(),l_=pa(),YZ=q(),XZ=q(),ZZ=$C(),gdt=$C(),vdt=q(),ydt=q(),_dt=q(),VT=[pa(),pa(),pa(),pa()],Lf=[q(),q(),q(),q()],QF=Dr(),JF=Dr(),e4=Dr(),t4=Dr();let O7=class{constructor(e){this._originSR=e,this._origins=new Map,this._objects=new Map,this._gridSize=5e5,this._rootOriginId="root/"+tf()}getOrigin(e){const t=this._origins.get(this._rootOriginId);if(t==null){const u=cdt.rootOrigin;if(T(u))return this._origins.set(this._rootOriginId,IE(u[0],u[1],u[2],this._rootOriginId)),this.getOrigin(e);const d=IE(e[0]+Math.random()-.5,e[1]+Math.random()-.5,e[2]+Math.random()-.5,this._rootOriginId);return this._origins.set(this._rootOriginId,d),d}const n=this._gridSize,r=Math.round(e[0]/n),s=Math.round(e[1]/n),a=Math.round(e[2]/n),o=`${r}/${s}/${a}`;let l=this._origins.get(o);const c=.5*n;if(nt(xa,e,t.vec3),xa[0]=Math.abs(xa[0]),xa[1]=Math.abs(xa[1]),xa[2]=Math.abs(xa[2]),xa[0]<c&&xa[1]<c&&xa[2]<c){if(l){const u=Math.max(...xa);if(nt(xa,e,l.vec3),xa[0]=Math.abs(xa[0]),xa[1]=Math.abs(xa[1]),xa[2]=Math.abs(xa[2]),Math.max(...xa)<u)return l}return t}return l||(l=IE(r*n,s*n,a*n,o),this._origins.set(o,l)),l}_drawOriginBox(e,t=Xn(1,1,0,1)){const n=window.view,r=n._stage,s=t.toString();if(!this._objects.has(s)){this._material=new Kw({width:2,color:t}),r.add(this._material);const p=new pfe({isPickable:!1}),m=new xg({castShadow:!1});r.add(m),p.add(m),r.add(p),this._objects.set(s,m)}const a=this._objects.get(s),o=[0,1,5,4,0,2,1,7,6,2,0,1,3,7,5,4,6,2,0],l=o.length,c=new Array(3*l),u=new Array,d=.5*this._gridSize;for(let p=0;p<l;p++)c[3*p+0]=e[0]+(1&o[p]?d:-d),c[3*p+1]=e[1]+(2&o[p]?d:-d),c[3*p+2]=e[2]+(4&o[p]?d:-d),p>0&&u.push(p-1,p);Kl(c,this._originSR,0,c,n.renderSpatialReference,0,l);const h=new Bs([[j.POSITION,{size:3,data:c,exclusive:!0}]],[[j.POSITION,u]],xh.Line);r.add(h),a.addGeometry(h,this._material,Ks)}get test(){const e=this;return{set gridSize(t){e._gridSize=t}}}};const xa=q();let gfe=class{constructor(e,t,n,r=null){this.rctx=e,this.sliceHelper=r,this.lastFrameCamera=new Nn,this.output=Re.Color,this.renderOccludedMask=QZ,this.bindParameters=new nD(t,n,T(r)?r.plane:null)}resetRenderOccludedMask(){this.renderOccludedMask=QZ}},bdt=class extends gfe{constructor(e,t,n,r,s){super(e,n,r,s),this.offscreenRenderingHelper=t,this.sliceHelper=s}};const QZ=Qr.Occlude|Qr.OccludeAndTransparent|Qr.OccludeAndTransparentStencil;var bC;(function(i){i[i.Highlight=0]="Highlight",i[i.Default=1]="Default"})(bC||(bC={}));let HP=class{constructor(){this.camera=new Nn,this.lightMat=St()}},R7=class{constructor(e,t){this._rctx=e,this._viewingMode=t,this._enabled=!1,this._snapshots=new Array,this._textureSize=0,this._numCascades=1,this._maxNumCascades=4,this._splitSchemeLambda=0,this._warp=!0,this._cascadeDistances=[0,0,0,0,0],this._usedCascadeDistances=Dn(),this._cascades=[new HP,new HP,new HP,new HP],this._maxTextureSize=Math.min(Fi("esri-mobile")?2048:8192,this._rctx.parameters.maxTextureSize)}get depthTexture(){return this._depthTexture}get textureSize(){return this._textureSize}get numCascades(){return this._numCascades}get cascadeDistances(){return dl(this._usedCascadeDistances,this._cascadeDistances[0],this._numCascades>1?this._cascadeDistances[1]:1/0,this._numCascades>2?this._cascadeDistances[2]:1/0,this._numCascades>3?this._cascadeDistances[3]:1/0)}dispose(){this._discardDepthTexture(),this._discardAllSnapshots()}set maxCascades(e){this._maxNumCascades=lt(Math.floor(e),1,4)}get maxCascades(){return this._maxNumCascades}set enabled(e){this._enabled=e,e||(this._discardDepthTexture(),this._discardAllSnapshots())}get enabled(){return this._enabled}get ready(){return this._enabled&&T(this._depthTexture)}getSnapshot(e){return this.enabled?this._snapshots[e]:null}getCascades(){for(let e=0;e<this._numCascades;++e)n4[e]=this._cascades[e];return n4.length=this._numCascades,n4}start(e,t,n){Ti(this.enabled),this._textureSize=this._computeTextureSize(e.fullWidth,e.fullHeight),this._ensureDepthTexture();const{near:r,far:s}=this._clampNearFar(n);this._computeCascadeDistances(s,r),this._setupMatrices(e,t);const a=e.viewMatrix,o=e.projectionMatrix;for(let l=0;l<this._numCascades;++l)this._constructCascade(l,o,a,t);this._lastOrigin=null,this.clear()}finish(e){Ti(this.enabled),this._rctx.bindFramebuffer(e)}getShadowMapMatrices(e){if(!this._lastOrigin||!uh(e,this._lastOrigin)){this._lastOrigin=this._lastOrigin||q(),Ge(this._lastOrigin,e);for(let t=0;t<this._numCascades;++t){of(lQ,this._cascades[t].lightMat,e);for(let n=0;n<16;++n)cQ[16*t+n]=lQ[n]}}return cQ}takeCascadeSnapshotTo(e,t){Ti(this.enabled);const n=this._ensureSnapshot(t);this._bindFbo();const r=this._rctx,s=r.bindTexture(n,Er.TEXTURE_UNIT_FOR_UPDATES);r.gl.copyTexSubImage2D(Wn.TEXTURE_2D,0,e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[0],e.camera.viewport[1],e.camera.viewport[2],e.camera.viewport[3]),r.bindTexture(s,Er.TEXTURE_UNIT_FOR_UPDATES)}clear(){const e=this._rctx;this._bindFbo(),e.setClearColor(1,1,1,1),e.clearSafe(hr.COLOR_BUFFER_BIT|hr.DEPTH_BUFFER_BIT)}_computeTextureSize(e,t){const n=.5*Math.log(e*e+t*t)*Math.LOG2E,r=.35,s=2**Math.round(n+r);return Math.min(this._maxTextureSize,2*s)}_ensureDepthTexture(){if(T(this._depthTexture)&&this._depthTexture.descriptor.width===this._textureSize)return;this._discardDepthTexture();const e={target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};this._depthTexture=new Er(this._rctx,e),this._fbo=new ma(this._rctx,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.DEPTH_RENDER_BUFFER,width:this._textureSize,height:this._textureSize},this._depthTexture)}_ensureSnapshot(e){let t=this._snapshots[e];if(T(t)&&t.descriptor.width===this._textureSize)return t;this._discardSnapshot(e);const n={target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.NEAREST,flipped:!0,width:this._textureSize,height:this._textureSize};return t=new Er(this._rctx,n),this._snapshots[e]=t,t}_discardDepthTexture(){this._fbo=Ht(this._fbo),this._depthTexture=Ht(this._depthTexture)}_discardSnapshot(e){this._snapshots[e]=Ht(this._snapshots[e])}_discardAllSnapshots(){for(let e=0;e<this._snapshots.length;++e)this._discardSnapshot(e);this._snapshots.length=0}_bindFbo(){const e=this._rctx;e.unbindTexture(this._depthTexture),e.bindFramebuffer(this._fbo)}_constructCascade(e,t,n,r){const s=this._cascades[e],a=-this._cascadeDistances[e],o=-this._cascadeDistances[e+1],l=(t[10]*a+t[14])/Math.abs(t[11]*a+t[15]),c=(t[10]*o+t[14])/Math.abs(t[11]*o+t[15]);Ti(l<c);for(let d=0;d<8;++d){dl(iQ,d%4==0||d%4==3?-1:1,d%4==0||d%4==1?-1:1,d<4?l:c,1),Sm(gc[d],iQ,tQ);for(let h=0;h<3;++h)gc[d][h]/=gc[d][3]}No(i4,gc[0]),of(JZ,oQ,i4),s.camera.viewMatrix=JZ;for(let d=0;d<8;++d)$t(gc[d],gc[d],s.camera.viewMatrix);Ge(qh,gc[0]),Ge(Kh,gc[0]);for(let d=1;d<8;++d)for(let h=0;h<3;++h)qh[h]=Math.min(qh[h],gc[d][h]),Kh[h]=Math.max(Kh[h],gc[d][h]);qh[2]-=200,Kh[2]+=200,s.camera.near=-Kh[2],s.camera.far=-qh[2],this._warp?this._constructTrapezoidalProjection(n,r,s):this._constructOrthogonalProjection(s),Vs(s.lightMat,s.camera.projectionMatrix,s.camera.viewMatrix);const u=this._textureSize/2;s.camera.viewport[0]=e%2==0?0:u,s.camera.viewport[1]=Math.floor(e/2)===0?0:u,s.camera.viewport[2]=u,s.camera.viewport[3]=u}_constructOrthogonalProjection(e){une(e.camera.projectionMatrix,qh[0],Kh[0],qh[1],Kh[1],e.camera.near,e.camera.far)}_constructTrapezoidalProjection(e,t,n){const r=1/gc[0][3],s=1/gc[4][3];Ti(r<s);let a=r+Math.sqrt(r*s);const o=Math.sin(Uo(e[2]*t[0]+e[6]*t[1]+e[10]*t[2]));a/=o,xdt(gc,a,o,nQ,rQ,wdt,sQ,aQ),Cdt(nQ,rQ,sQ,aQ,n.camera.projectionMatrix),n.camera.projectionMatrix[10]=2/(qh[2]-Kh[2]),n.camera.projectionMatrix[14]=-(qh[2]+Kh[2])/(qh[2]-Kh[2])}_setupMatrices(e,t){Vs(eQ,e.projectionMatrix,e.viewMatrix),Da(tQ,eQ);const n=this._viewingMode===Ot.Global?e.eye:je(i4,0,0,1);LB(oQ,[0,0,0],[-t[0],-t[1],-t[2]],n)}_clampNearFar(e){let{near:t,far:n}=e;return t<2&&(t=2),n<2&&(n=2),t>=n&&(t=2,n=4),{near:t,far:n}}_computeCascadeDistances(e,t){this._numCascades=Math.min(1+Math.floor(v1e(e/t,4)),this._maxNumCascades);const n=(e-t)/this._numCascades,r=(e/t)**(1/this._numCascades);let s=t,a=t;for(let o=0;o<this._numCascades+1;++o)this._cascadeDistances[o]=ki(s,a,this._splitSchemeLambda),s*=r,a+=n}get gpuMemoryUsage(){var e;return this._snapshots.reduce((t,n)=>t+YI(n),((e=this._fbo)==null?void 0:e.gpuMemoryUsage)??0)}get test(){const e=this;return{maxNumCascades:this._maxNumCascades,cascades:this._cascades,textureSize:this._textureSize,set splitSchemeLambda(t){e._splitSchemeLambda=t},get splitSchemeLambda(){return e._splitSchemeLambda},set warp(t){e._warp=t},get warp(){return e._warp}}}};const JZ=St(),eQ=St(),tQ=St(),iQ=Dn(),gc=[];for(let i=0;i<8;++i)gc.push(Dn());const qh=q(),Kh=q(),nQ=xt(),rQ=xt(),wdt=xt(),sQ=xt(),aQ=xt(),oQ=St(),i4=q(),n4=[],lQ=St(),cQ=new Float32Array(64),Kc=xt(),v1=xt(),c_=[xt(),xt(),xt(),xt()],zs=xt(),r4=xt(),Ug=xt(),BT=xt(),y1=xt(),_1=xt(),GP=xt();function xdt(i,e,t,n,r,s,a,o){Bi(Kc,0,0);for(let S=0;S<4;++S)sd(Kc,Kc,i[S]);Po(Kc,Kc,.25),Bi(v1,0,0);for(let S=4;S<8;++S)sd(v1,v1,i[S]);Po(v1,v1,.25),Hv(c_[0],i[4],i[5],.5),Hv(c_[1],i[5],i[6],.5),Hv(c_[2],i[6],i[7],.5),Hv(c_[3],i[7],i[4],.5);let l=0,c=WI(c_[0],Kc);for(let S=1;S<4;++S){const E=WI(c_[S],Kc);E<c&&(c=E,l=S)}Yn(zs,c_[l],i[l+4]);const u=zs[0];let d,h;zs[0]=-zs[1],zs[1]=u,Yn(r4,v1,Kc),cr(r4,zs)<0&&Xie(zs,zs),Hv(zs,zs,r4,t),my(zs,zs),d=h=cr(Yn(Ug,i[0],Kc),zs);for(let S=1;S<8;++S){const E=cr(Yn(Ug,i[S],Kc),zs);E<d?d=E:E>h&&(h=E)}Zs(n,Kc),Po(Ug,zs,d-e),sd(n,n,Ug);let p=-1,m=1,g=0,_=0;for(let S=0;S<8;++S){Yn(BT,i[S],n),my(BT,BT);const E=zs[0]*BT[1]-zs[1]*BT[0];E>0?E>p&&(p=E,g=S):E<m&&(m=E,_=S)}Yb(p>0,"leftArea"),Yb(m<0,"rightArea"),Po(y1,zs,d),sd(y1,y1,Kc),Po(_1,zs,h),sd(_1,_1,Kc),GP[0]=-zs[1],GP[1]=zs[0];const b=DM(n,i[_],_1,sd(Ug,_1,GP),1,r),x=DM(n,i[g],_1,Ug,1,s),w=DM(n,i[g],y1,sd(Ug,y1,GP),1,a),C=DM(n,i[_],y1,Ug,1,o);Yb(b,"rayRay"),Yb(x,"rayRay"),Yb(w,"rayRay"),Yb(C,"rayRay")}function Xi(i,e){return 3*e+i}const uQ=xt();function ac(i,e){return Bi(uQ,i[e],i[e+3]),uQ}const xl=xt(),Nt=Ho();function Cdt(i,e,t,n,r){Yn(xl,t,n),Po(xl,xl,.5),Nt[0]=xl[0],Nt[1]=xl[1],Nt[2]=0,Nt[3]=xl[1],Nt[4]=-xl[0],Nt[5]=0,Nt[6]=xl[0]*xl[0]+xl[1]*xl[1],Nt[7]=xl[0]*xl[1]-xl[1]*xl[0],Nt[8]=1,Nt[Xi(0,2)]=-cr(ac(Nt,0),i),Nt[Xi(1,2)]=-cr(ac(Nt,1),i);let s=cr(ac(Nt,0),t)+Nt[Xi(0,2)],a=cr(ac(Nt,1),t)+Nt[Xi(1,2)],o=cr(ac(Nt,0),n)+Nt[Xi(0,2)],l=cr(ac(Nt,1),n)+Nt[Xi(1,2)];s=-(s+o)/(a+l),Nt[Xi(0,0)]+=Nt[Xi(1,0)]*s,Nt[Xi(0,1)]+=Nt[Xi(1,1)]*s,Nt[Xi(0,2)]+=Nt[Xi(1,2)]*s,s=1/(cr(ac(Nt,0),t)+Nt[Xi(0,2)]),a=1/(cr(ac(Nt,1),t)+Nt[Xi(1,2)]),Nt[Xi(0,0)]*=s,Nt[Xi(0,1)]*=s,Nt[Xi(0,2)]*=s,Nt[Xi(1,0)]*=a,Nt[Xi(1,1)]*=a,Nt[Xi(1,2)]*=a,Nt[Xi(2,0)]=Nt[Xi(1,0)],Nt[Xi(2,1)]=Nt[Xi(1,1)],Nt[Xi(2,2)]=Nt[Xi(1,2)],Nt[Xi(1,2)]+=1,s=cr(ac(Nt,1),e)+Nt[Xi(1,2)],a=cr(ac(Nt,2),e)+Nt[Xi(2,2)],o=cr(ac(Nt,1),t)+Nt[Xi(1,2)],l=cr(ac(Nt,2),t)+Nt[Xi(2,2)],s=-.5*(s/a+o/l),Nt[Xi(1,0)]+=Nt[Xi(2,0)]*s,Nt[Xi(1,1)]+=Nt[Xi(2,1)]*s,Nt[Xi(1,2)]+=Nt[Xi(2,2)]*s,s=cr(ac(Nt,1),e)+Nt[Xi(1,2)],a=cr(ac(Nt,2),e)+Nt[Xi(2,2)],o=-a/s,Nt[Xi(1,0)]*=o,Nt[Xi(1,1)]*=o,Nt[Xi(1,2)]*=o,r[0]=Nt[0],r[1]=Nt[1],r[2]=0,r[3]=Nt[2],r[4]=Nt[3],r[5]=Nt[4],r[6]=0,r[7]=Nt[5],r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=Nt[6],r[13]=Nt[7],r[14]=0,r[15]=Nt[8]}let vfe=class{constructor(){this.adds=new pn,this.removes=new pn,this.updates=new pn({allocator:e=>e||new Tdt,deallocator:e=>(e.renderGeometry=null,e)})}clear(){this.adds.clear(),this.removes.clear(),this.updates.clear()}prune(){this.adds.prune(),this.removes.prune(),this.updates.prune()}},Tdt=class{},Sdt=class{constructor(){this.adds=new Array,this.removes=new Array,this.updates=new Array}};var _r,Ls;(function(i){i[i.ADD=0]="ADD",i[i.UPDATE=1]="UPDATE",i[i.REMOVE=2]="REMOVE"})(_r||(_r={})),function(i){i[i.NONE=0]="NONE",i[i.VISIBILITIES=1]="VISIBILITIES",i[i.VERTEXATTRS=2]="VERTEXATTRS",i[i.TRANSFORMATION=4]="TRANSFORMATION",i[i.HIGHLIGHTS=8]="HIGHLIGHTS",i[i.OCCLUDEES=16]="OCCLUDEES"}(Ls||(Ls={}));function yfe(i){const e=new Map,t=n=>{let r=e.get(n);return r||(r=new Sdt,e.set(n,r)),r};return i.removes.forAll(n=>{s4(n)&&t(n.material).removes.push(n)}),i.adds.forAll(n=>{s4(n)&&t(n.material).adds.push(n)}),i.updates.forAll(n=>{s4(n.renderGeometry)&&t(n.renderGeometry.material).updates.push(n)}),e}function s4(i){return i.data.indexCount>=1}let _fe=class{constructor(e,t){this._material=e,this._repository=t,this._map=new Map}destroy(){this._map.forEach((e,t)=>{T(e)&&this._repository.release(this._material,t)})}load(e,t,n){if(!this._material.requiresSlot(t,n))return null;this._map.has(n)||this._map.set(n,this._repository.acquire(this._material,t,n));const r=this._map.get(n);if(T(r)){if(r.ensureResources(e)===oR.LOADED)return r;this._repository.requestRender()}return null}},K6=class extends dwe{constructor(e=q()){super(),this.origin=e,this.slicePlaneLocalOrigin=this.origin}},I7=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2,t.spherical=e.viewingMode===Ot.Global,t.doublePrecisionRequiresObfuscation=QL(e.rctx)}initializeProgram(e){return new gn(e.rctx,I7.shader.get().build(this.configuration),Mn)}_setPipelineState(e){const t=this.configuration,n=e===ln.NONE,r=e===ln.FrontFace;return yi({blending:t.output!==Re.Normal&&t.output!==Re.Highlight&&t.transparent?n?xd:Ly(e):null,depthTest:{func:Eb(e)},depthWrite:n?t.writeDepth&&Lu:JL(e),colorWrite:$i,polygonOffset:n||r?null:JB(t.enableOffset)})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}};I7.shader=new bn(ube,()=>Ee(()=>import("./WaterSurface.glsl-86965442.js"),["./WaterSurface.glsl-86965442.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./vec3f32-c9aa289f.js","./vec3f64-2f9cef06.js","./VertexAttribute-9c5c630d.js","./mat4-44a0988f.js","./common-c186b691.js","./vec3-a020a6f6.js","./vec4f64-e407da96.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./vec4-790471c0.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./compilerUtils-034cacb8.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./mathUtils-2519596a.js","./Ellipsoid-89682c5e.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./ReadLinearDepth.glsl-7ff30f7d.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js"],import.meta.url));let Sa=class extends yf{constructor(){super(...arguments),this.output=Re.Color,this.transparencyPassType=ln.NONE,this.spherical=!1,this.receiveShadows=!1,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!1,this.hasScreenSpaceReflections=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasCloudsReflections=!1,this.isDraped=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}};f([Pe({count:Re.COUNT})],Sa.prototype,"output",void 0),f([Pe({count:ln.COUNT})],Sa.prototype,"transparencyPassType",void 0),f([Pe()],Sa.prototype,"spherical",void 0),f([Pe()],Sa.prototype,"receiveShadows",void 0),f([Pe()],Sa.prototype,"hasSlicePlane",void 0),f([Pe()],Sa.prototype,"transparent",void 0),f([Pe()],Sa.prototype,"enableOffset",void 0),f([Pe()],Sa.prototype,"writeDepth",void 0),f([Pe()],Sa.prototype,"hasScreenSpaceReflections",void 0),f([Pe()],Sa.prototype,"doublePrecisionRequiresObfuscation",void 0),f([Pe()],Sa.prototype,"hasCloudsReflections",void 0),f([Pe()],Sa.prototype,"isDraped",void 0),f([Pe()],Sa.prototype,"hasMultipassTerrain",void 0),f([Pe()],Sa.prototype,"cullAboveGround",void 0),f([Pe({constValue:Ds.Water})],Sa.prototype,"pbrMode",void 0),f([Pe({constValue:!0})],Sa.prototype,"useCustomDTRExponentForWater",void 0),f([Pe({constValue:!0})],Sa.prototype,"highStepCount",void 0),f([Pe({constValue:!1})],Sa.prototype,"useFillLights",void 0);let Edt=class extends Sb{_updateShadowState(e){e.shadowMap.enabled!==this._material.parameters.receiveShadows&&this._material.setParameters({receiveShadows:e.shadowMap.enabled})}_updateSSRState(e){e.ssr.enabled!==this._material.parameters.hasScreenSpaceReflections&&this._material.setParameters({hasScreenSpaceReflections:e.ssr.enabled})}_updateCloudsReflectionState(e){const t=T(e.cloudsFade.data);t!==this._material.parameters.hasCloudsReflections&&this._material.setParameters({hasCloudsReflections:t})}ensureResources(e){return this._techniqueRepository.constructionContext.waterTextureRepository.ensureResources(e)}beginSlot(e){return this._output===Re.Color&&(this._updateShadowState(e),this._updateSSRState(e),this._updateCloudsReflectionState(e)),this._material.setParameters(this._techniqueRepository.constructionContext.waterTextureRepository.passParameters),this.ensureTechnique(I7,e)}};const Adt=Js().vec3f(j.POSITION),Mdt=Js().vec3f(j.POSITION).vec2f(j.UV0),bfe=Js().vec3f(j.POSITION).vec4u8(j.COLOR);Js().vec3f(j.POSITION).vec4u8(j.OBJECTANDLAYERIDCOLOR);Js().vec3f(j.POSITION).vec2f(j.UV0).vec4u8(j.OBJECTANDLAYERIDCOLOR);const Pdt=Js().vec3f(j.POSITION).vec4u8(j.COLOR).vec4u8(j.OBJECTANDLAYERIDCOLOR);let _D=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(j.POSITION).length}write(e,t,n,r,s){ez(n,this.vertexBufferLayout,e,t,r,s)}},wfe=class extends ug{constructor(e){super(e,new xfe),this._configuration=new Sa,this.animation=new $he}getConfiguration(e,t){return this._configuration.output=e,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.receiveShadows=this.parameters.receiveShadows,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasScreenSpaceReflections=this.parameters.hasScreenSpaceReflections,this._configuration.hasCloudsReflections=this.parameters.hasCloudsReflections,this._configuration.isDraped=this.parameters.isDraped,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<tz,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}update(e){const t=Math.min(e.camera.relativeElevation,e.camera.distance);this.animation.enabled=Math.sqrt(this.parameters.waveTextureRepeat/this.parameters.waveStrength)*t<Odt;const n=this.animation.advance(e);return this.setParameters({timeElapsed:sB(this.animation.time)*this.parameters.animationSpeed},!1),this.animation.enabled&&n}intersect(e,t,n,r,s,a,o){qB(e,t,r,s,a,void 0,o)}requiresSlot(e,t){switch(t){case Re.Normal:return e===at.DRAPED_WATER;case Re.Color:if(this.parameters.isDraped)return e===at.DRAPED_MATERIAL;break;case Re.Alpha:break;case Re.Highlight:return e===at.OPAQUE_MATERIAL||e===at.DRAPED_MATERIAL;default:return!1}let n=at.OPAQUE_MATERIAL;return this.parameters.transparent&&(n=this.parameters.writeDepth?at.TRANSPARENT_MATERIAL:at.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===n}createGLMaterial(e){return new Edt(e)}createBufferWriter(){return new _D(Mdt)}},xfe=class extends YA{constructor(){super(...arguments),this.waveStrength=.06,this.waveTextureRepeat=32,this.waveDirection=dn(1,0),this.waveVelocity=.05,this.flowStrength=.015,this.flowOffset=-.5,this.animationSpeed=.35,this.timeElapsed=0,this.color=Xn(0,0,0,0),this.transparent=!0,this.writeDepth=!0,this.hasSlicePlane=!1,this.isDraped=!1,this.receiveShadows=!0,this.hasScreenSpaceReflections=!1,this.hasCloudsReflections=!1}};const Odt=35e3;let WP=class{constructor(){this.first=0,this.count=0}},gw=class{constructor(e=0,t=0){this.from=e,this.to=t}},Rdt=class extends gw{constructor(e,t,n,r,s,a){super(t,n),this.id=e,this.isVisible=r,this.hasHighlights=s,this.hasOccludees=a}};function dQ(i){return Array.from(i.values()).sort(Idt)}function Idt(i,e){return i.from===e.from?i.to-e.to:i.from-e.from}function jP(i,e){const t=i.back();if(t==null){const n=i.pushNew();return n.first=e.from,void(n.count=e.to-e.from)}if($dt(t,e)){const n=e.from-t.first+e.to-e.from;t.count=n}else{const n=i.pushNew();n.first=e.from,n.count=e.to-e.from}}function $dt(i,e){return i.first+i.count>=e.from}let Ldt=class{constructor(e,t){this._pool=e,this._size=0,this._buffer=e.newBuffer(X6(t))}dispose(){this._buffer=this._pool.deleteBuffer(this._buffer),this._size=0}release(){this.erase(0,this._size),this.dispose()}get buffer(){return this._buffer}get size(){return this._size}grow(e){this._resize(this._size+e,!0).dispose()}allocate(e){return this._resize(e,!1)}_resize(e,t){let n;const r=Ddt(this._buffer.length,this._size,e);if(this._buffer.length!==r){const a=this._pool.newBuffer(r);t&&(a.array.set(this._buffer.array.subarray(0,Math.min(this._size,r))),a.vao.vertexBuffers.geometry.setSubData(a.array,0,0,a.array.length)),n=this._buffer,this._buffer=a}const s=this._size;return this._size=e,n?{dispose:()=>{n.array.fill(0,0,s),this._pool.deleteBuffer(n)},copy:(a,o,l)=>this._buffer.array.set(n.array.subarray(o,l),a),hasNewBuffer:!0}:{dispose:()=>{},copy:(a,o,l)=>{a!==o&&this._buffer.array.copyWithin(a,o,l)},hasNewBuffer:!1}}erase(e,t){this._buffer.array.fill(0,e,t)}};const Y6=65536;function X6(i){return Math.ceil(i/Y6)*Y6}function Ddt(i,e,t){return e<=t?i>=t?i:X6(Math.max(2*i,t)):i<=2*t?i:X6(t)}let kdt=class{constructor(e,t,n,r){this.vao=new lf(e,t,{geometry:n},{geometry:In.createVertex(e,kn.STATIC_DRAW)}),this.array=new Float32Array(r),this.vao.vertexBuffers.geometry.setSize(this.array.byteLength)}dispose(){this.vao.dispose(!0)}get length(){return this.array.length}};const Fdt=ywe+1;let Ndt=class{constructor(e,t,n){this._rctx=e,this._locations=t,this._layout=n,this._cache=e.newCache(`MergedRenderer pool ${tf()}`,Vdt)}dispose(){this._cache.destroy()}newBuffer(e){const t=e.toString(),n=this._cache.pop(t);if(T(n)){const r=n.pop();return n.length>0&&this._cache.put(t,n,r.array.byteLength*n.length,Fdt),r}return new kdt(this._rctx,this._locations,this._layout,e)}deleteBuffer(e){const t=e.array.byteLength,n=e.array.length.toString(),r=this._cache.pop(n);return T(r)?(r.push(e),this._cache.put(n,r,t*r.length,-1)):this._cache.put(n,[e],t,-1),null}};function Vdt(i,e){if(e===vwe.ALL)return void i.forEach(r=>r.dispose());const t=i.pop(),n=i.length*t.array.byteLength;return t.dispose(),n}let Cfe=class{constructor(e,t,n){this._rctx=e,this._materialRepository=t,this._material=n,this.type="MergedRenderer",this._dataByOrigin=new Map,this._renderCommandData=new pn,this._hasHighlights=!1,this._hasOccludees=!1,this._glMaterials=new _fe(this._material,this._materialRepository),this._bufferWriter=n.createBufferWriter(),this._bufferPool=new Ndt(e,n.vertexAttributeLocations,Dh(this._bufferWriter.vertexBufferLayout))}dispose(){this._glMaterials.destroy(),this._dataByOrigin.forEach(e=>e.geometry.dispose()),this._dataByOrigin.clear(),this._bufferPool.dispose()}get isEmpty(){return this._dataByOrigin.size===0}get hasHighlights(){return this._hasHighlights}get hasOccludees(){return this._hasOccludees}get hasWater(){return!this.isEmpty&&this._material instanceof wfe}get rendersOccluded(){return!this.isEmpty&&this._material.renderOccluded!==Qr.Occlude}modify(e){this._updateGeometries(e.updates),this._addAndRemoveGeometries(e.adds,e.removes),this._updateDrawCommands()}_addAndRemoveGeometries(e,t){const n=this._bufferWriter,r=n.vertexBufferLayout.stride/4,s=this._dataByOrigin,a=zdt(e,t);a.forEach((o,l)=>{a.delete(l);const c=o.add.reduce((b,x)=>b+n.elementCount(x.data),0);let u=s.get(l);if(u==null)Ti(o.remove.length===0),u=new Hdt(o.origin,new Ldt(this._bufferPool,c*r)),s.set(l,u);else if(o.add.length===0&&u.instances.size===o.remove.length)return u.geometry.dispose(),void s.delete(l);let d=0;u.instances.forEach(b=>d+=b.to-b.from);const h=o.remove.reduce((b,x)=>b+n.elementCount(x.data),0),p=u.geometry.size,m=(d+c-h)*r,g=Wdt;if(m>Y6&&(m<p/2||p-m>1048576)?this._removeAndRebuild(u,o.remove,r,m,g):o.remove.length>0&&this._remove(u,o.remove,r,g),o.add.length>0){const b=jdt;y1e(b,-o.origin[0],-o.origin[1],-o.origin[2]),this._add(u,o.add,r,b,g)}const _=u.geometry.buffer.vao.vertexBuffers.geometry;fQ(g),g.forAll(({from:b,to:x})=>{if(b<x){const w=u.geometry.buffer.array;_.setSubData(w,b,b,x)}}),g.clear(),u.drawCommandsDirty=!0})}_updateGeometries(e){const t=this._bufferWriter,n=t.vertexBufferLayout.stride/4;for(const r of e){const s=r.renderGeometry,a=this._dataByOrigin.get(s.origin.id),o=a&&a.instances.get(s.id);if(!o)return;const l=r.updateType;if(l&Ls.VISIBILITIES&&(o.isVisible=s.instanceParameters.visible),l&(Ls.HIGHLIGHTS|Ls.VISIBILITIES)){const c=s.instanceParameters.visible;o.hasHighlights=!!s.instanceParameters.highlights&&c}if(l&Ls.OCCLUDEES&&(o.hasOccludees=!!s.instanceParameters.occludees),l&(Ls.VERTEXATTRS|Ls.TRANSFORMATION)){const{array:c,vao:u}=a.geometry.buffer;Cbe(s,a4,zT),t.write(a4,zT,s.data,t.vertexBufferLayout.createView(c.buffer),o.from),Ti(o.from+t.elementCount(s.data)===o.to,"material VBO layout has changed"),u.vertexBuffers.geometry.setSubData(c,o.from*n,o.from*n,o.to*n)}a.drawCommandsDirty=!0}}_updateDrawCommands(){this._hasHighlights=!1,this._hasOccludees=!1,this._dataByOrigin.forEach(t=>{t.hasHiddenInstances=!1,t.hasHighlights=!1,t.hasOccludees=!1,ps(t.instances,n=>(n.isVisible?(n.hasHighlights&&(this._hasHighlights=!0,t.hasHighlights=!0),n.hasOccludees&&(this._hasOccludees=!0,t.hasOccludees=!0)):t.hasHiddenInstances=!0,t.hasHiddenInstances&&t.hasHighlights&&t.hasOccludees))});const e=t=>{if(t.drawCommandsDefault.clear(),t.drawCommandsHighlight.clear(),t.drawCommandsOccludees.clear(),t.drawCommandsShadowHighlightRest.clear(),t.instances.size===0)return;if(!pQ(t)){const r=t.drawCommandsDefault.pushNew();return r.first=1/0,r.count=0,t.instances.forEach(s=>{r.first=Math.min(r.first,s.from),r.count=Math.max(r.count,s.to)}),void(r.count-=r.first)}const n=dQ(t.instances);for(const r of n)r.isVisible&&(r.hasOccludees?jP(t.drawCommandsOccludees,r):jP(t.drawCommandsDefault,r),r.hasHighlights?jP(t.drawCommandsHighlight,r):jP(t.drawCommandsShadowHighlightRest,r))};this._dataByOrigin.forEach(t=>{t.drawCommandsDirty&&(e(t),t.drawCommandsDirty=!1)})}updateAnimation(e){return this._material.update(e)}requiresSlot(e,t){return this._material.requiresSlot(e,t)}render(e,t){if(!this.requiresSlot(t.slot,e))return!1;const n=e===Re.Highlight||e===Re.ShadowHighlight;if(n&&!this._hasHighlights)return!1;const r=e===Re.ShadowExludeHighlight,s=!(n||r);if(this._dataByOrigin.forEach(u=>{if(n&&!u.hasHighlights)return;const d=(n?u.drawCommandsHighlight:r&&pQ(u)?u.drawCommandsShadowHighlightRest:u.drawCommandsDefault)||null,h=s&&u.drawCommandsOccludees||null;(d!=null&&d.length||h!=null&&h.length)&&this._renderCommandData.push(new Gdt(u.origin,u.geometry,d,h))}),this._renderCommandData.length===0)return!1;const a=this._rctx,o=this._glMaterials.load(a,t.slot,e);if(B(o))return this._renderCommandData.clear(),!1;const l=o.beginSlot(t),c=a.bindTechnique(l,this._material.parameters,t);return this._renderCommandData.forAll(u=>{c.bindDraw(u,t,this._material.parameters);const{geometry:d,renderCommands:h,occludeeCommands:p}=u;l.ensureAttributeLocations(d.buffer.vao),a.bindVAO(d.buffer.vao);const m=l.primitiveType;T(h)&&h.length>0&&(l.bindPipelineState(a,t.slot,!1),h.forAll(g=>a.drawArrays(m,g.first,g.count))),T(p)&&p.length>0&&(l.bindPipelineState(a,t.slot,!0),p.forAll(g=>a.drawArrays(m,g.first,g.count)))}),this._renderCommandData.clear(),!0}_removeAndRebuild(e,t,n,r,s){for(const u of t)e.instances.delete(u.id);const a=dQ(e.instances);e.instances.clear();const o=e.geometry.size,l=e.geometry.allocate(r);let c=0;for(const u of a){const d=u.from*n,h=u.to*n;l.copy(c,d,h),u.from=c/n,c+=h-d,u.to=c/n,e.instances.set(u.id,u)}s.push(new gw(0,l.hasNewBuffer?e.geometry.buffer.array.length:o)),l.dispose(),e.geometry.erase(c,s.back().to),e.holes.clear()}_remove(e,t,n,r){for(const s of t){const a=s.id,o=e.instances.get(a),l=o.from*n,c=o.to*n;e.geometry.erase(l,c),e.holes.push(new gw(o.from,o.to)),e.instances.delete(a),r.push(new gw(l,c))}fQ(e.holes)}_add(e,t,n,r,s){if(t.length===0)return;const a=this._bufferWriter;let o=a.vertexBufferLayout.createView(e.geometry.buffer.array.buffer);const l=e.holes.length>0;let c=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;for(const d of t){const h=T(d.transformation)?Vs(a4,r,d.transformation):r;Da(zT,h);const p=$B(zT,zT),m=a.elementCount(d.data),g=m*n;let _=Udt(e.holes,m);B(_)&&(_=e.geometry.size/n,e.geometry.grow(g),o=a.vertexBufferLayout.createView(e.geometry.buffer.array.buffer)),a.write(h,p,d.data,o,_);const b=d.instanceParameters.visible,x=!!d.instanceParameters.highlights&&b,w=!!d.instanceParameters.occludees,C=new Rdt(d.id,_,_+m,b,x,w);Ti(e.instances.get(d.id)==null),e.instances.set(d.id,C),l?s.push(new gw(C.from*n,C.to*n)):(c=Math.min(C.from,c),u=Math.max(C.to,u))}l||s.push(new gw(c*n,u*n))}get test(){return{material:this._material,glMaterials:this._glMaterials,dataByOrigin:this._dataByOrigin}}},Bdt=class{constructor(e){this.origin=e,this.add=new Array,this.remove=new Array}};function zdt(i,e){const t=new Map;for(const n of i)hQ(t,n,!0);for(const n of e)hQ(t,n,!1);return t}function hQ(i,e,t){const n=e.origin;if(B(n))return;let r=i.get(n.id);r==null&&(r=new Bdt(n.vec3),i.set(n.id,r)),t?r.add.push(e):r.remove.push(e)}function pQ(i){return i.hasOccludees||i.hasHighlights||i.hasHiddenInstances}function Udt(i,e){let t;if(!i.some(r=>!(r.to-r.from<e)&&(t=r,!0)))return null;const n=t.from;return t.from+=e,t.from>=t.to&&i.removeUnordered(t),n}function fQ(i){const e=new Map;i.forAll(n=>e.set(n.from,n));let t=!0;for(;t;)t=!1,i.forEach(n=>{const r=e.get(n.to);r&&(n.to=r.to,e.delete(r.from),i.removeUnordered(r),t=!0)})}let Hdt=class{constructor(e,t){this.origin=e,this.geometry=t,this.instances=new Map,this.holes=new pn({deallocator:null}),this.hasHiddenInstances=!1,this.hasHighlights=!1,this.hasOccludees=!1,this.drawCommandsDirty=!1,this.drawCommandsDefault=new pn({allocator:n=>n||new WP,deallocator:n=>n}),this.drawCommandsHighlight=new pn({allocator:n=>n||new WP,deallocator:n=>n}),this.drawCommandsOccludees=new pn({allocator:n=>n||new WP,deallocator:n=>n}),this.drawCommandsShadowHighlightRest=new pn({allocator:n=>n||new WP,deallocator:n=>n})}},Gdt=class extends K6{constructor(e,t,n,r){super(e),this.geometry=t,this.renderCommands=n,this.occludeeCommands=r}};const Wdt=new pn({deallocator:null}),jdt=St(),a4=St(),zT=St();let yp=class extends et{constructor(e){super(e),this._pending=new qdt,this._changes=new vfe,this._materialRenderers=new Map,this._sortedMaterialRenderers=new pn,this._geometries=new Map,this._hasHighlights=!1,this._hasWater=!1}destroy(){this._changes.prune(),this._materialRenderers.forEach(e=>e.dispose()),this._materialRenderers.clear(),this._sortedMaterialRenderers.clear(),this._geometries.clear()}get updating(){return!this._pending.empty||this._changes.updates.length>0}get rctx(){return this.rendererContext.rctx}get _materialRepository(){return this.rendererContext.materialRepository}get _localOriginFactory(){return this.rendererContext.localOriginFactory}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return ps(this._materialRenderers,e=>e.rendersOccluded)}get isEmpty(){return!this.updating&&this._materialRenderers.size===0&&this._geometries.size===0}commitChanges(){if(!this.updating)return!1;this._processAddsRemoves();const e=yfe(this._changes);let t=!1,n=!1,r=!1;return e.forEach((s,a)=>{let o=this._materialRenderers.get(a);if(!o&&s.adds.length>0&&(o=new Cfe(this.rctx,this._materialRepository,a),this._materialRenderers.set(a,o),t=!0,n=!0,r=!0),!o)return;const l=n||o.hasHighlights,c=r||o.hasWater;o.modify(s),n=n||l!==o.hasHighlights,r=r||c!==o.hasWater,o.isEmpty&&(this._materialRenderers.delete(a),o.dispose(),t=!0)}),this._changes.clear(),t&&this._updateSortedMaterialRenderers(),n&&(this._hasHighlights=ps(this._materialRenderers,s=>s.hasHighlights)),r&&(this._hasWater=ps(this._materialRenderers,s=>s.hasWater)),this.notifyChange("updating"),!0}addGeometries(e,t){if(e.length===0)return;const n=this._validateRenderGeometries(e);for(const s of n)this._geometries.set(s.id,s);const r=this._pending.empty;for(const s of n)this._pending.adds.add(s);r&&this.notifyChange("updating"),t===_r.UPDATE&&this._notifyGraphicGeometryChanged(e)}removeGeometries(e,t){const n=this._pending.empty,r=this._pending.adds;for(const s of e)r.has(s)?(this._pending.removed.add(s),r.delete(s)):this._pending.removed.has(s)||this._pending.removes.add(s),this._geometries.delete(kt(s.id));n&&!this._pending.empty&&this.notifyChange("updating"),t===_r.UPDATE&&this._notifyGraphicGeometryChanged(e)}modifyGeometries(e,t){const n=this._changes.updates.length===0;for(const r of e){const s=this._changes.updates.pushNew();s.renderGeometry=this._validateRenderGeometry(r),s.updateType=t}switch(n&&this._changes.updates.length>0&&this.notifyChange("updating"),t){case Ls.TRANSFORMATION:case Ls.VERTEXATTRS:return this._notifyGraphicGeometryChanged(e);case Ls.VISIBILITIES:return this._notifyGraphicVisibilityChanged(e)}}updateAnimation(e){let t=!1;return this._sortedMaterialRenderers.forAll(({materialRenderer:n})=>t=n.updateAnimation(e)||t),t}render(e,t){for(let n=0;n<this._sortedMaterialRenderers.length;n++){const r=this._sortedMaterialRenderers.data[n];r.material.shouldRender(e)&&r.materialRenderer.render(e.output,t)}}intersect(e,t,n,r,s){return this._geometries.forEach(a=>{if(r&&!r(a))return;this._intersectRenderGeometry(a,n,t,0,e,s);const o=this.rendererContext.longitudeCyclical;o&&(a.boundingSphere[0]-a.boundingSphere[3]<o.min&&this._intersectRenderGeometry(a,n,t,o.range,e,s),a.boundingSphere[0]+a.boundingSphere[3]>o.max&&this._intersectRenderGeometry(a,n,t,-o.range,e,s)),s++}),s}_updateSortedMaterialRenderers(){this._sortedMaterialRenderers.clear();let e=0;this._materialRenderers.forEach((t,n)=>{n.insertOrder=e++,this._sortedMaterialRenderers.push({material:n,materialRenderer:t})}),this._sortedMaterialRenderers.sort((t,n)=>{const r=n.material.renderPriority-t.material.renderPriority;return r!==0?r:t.material.insertOrder-n.material.insertOrder})}_processAddsRemoves(){this._changes.adds.clear(),this._changes.removes.clear(),this._changes.adds.pushArray(Array.from(this._pending.adds)),this._changes.removes.pushArray(Array.from(this._pending.removes));for(let e=0;e<this._changes.updates.length;){const t=this._changes.updates.data[e];this._pending.has(t.renderGeometry)?this._changes.updates.removeUnorderedIndex(e):e++}this._pending.clear()}_intersectRenderGeometry(e,t,n,r,s,a){if(!e.instanceParameters.visible)return;let o=0;T(e.transformation)&&(r+=e.transformation[12],o=e.transformation[13]),qP[0]=n[0]-r,qP[1]=n[1]-o,qP[2]=1,KP[0]=n[0]-r,KP[1]=n[1]-o,KP[2]=0,e.screenToWorldRatio=this.rendererContext.screenToWorldRatio,e.material.intersect(e,null,e.getShaderTransformation(),s,qP,KP,(l,c,u)=>{Kdt(t,u,e.material.renderPriority,a,s,e.layerUid,e.graphicUid)},e.calculateShaderTransformation,t)}_notifyGraphicGeometryChanged(e){if(B(this.drapeSource.notifyGraphicGeometryChanged))return;let t;for(const n of e){const r=n.graphicUid;T(r)&&r!==t&&(this.drapeSource.notifyGraphicGeometryChanged(r),t=r)}}_notifyGraphicVisibilityChanged(e){if(B(this.drapeSource.notifyGraphicVisibilityChanged))return;let t;for(const n of e){const r=n.graphicUid;T(r)&&r!==t&&(this.drapeSource.notifyGraphicVisibilityChanged(r),t=r)}}_validateRenderGeometries(e){for(const t of e)this._validateRenderGeometry(t);return e}_validateRenderGeometry(e){return B(e.origin)&&(e.origin=this._localOriginFactory.getOrigin(e.boundingSphere)),e}get test(){return{sortedMaterialRenderers:this._sortedMaterialRenderers}}};f([y()],yp.prototype,"drapeSource",void 0),f([y()],yp.prototype,"updating",null),f([y()],yp.prototype,"rctx",null),f([y()],yp.prototype,"rendererContext",void 0),f([y()],yp.prototype,"_materialRepository",null),f([y()],yp.prototype,"_localOriginFactory",null),yp=f([ge("esri.views.3d.webgl-engine.lib.SortedRenderGeometryRenderer")],yp);let qdt=class{constructor(){this.adds=new Set,this.removes=new Set,this.removed=new Set}get empty(){return this.adds.size===0&&this.removes.size===0&&this.removed.size===0}has(e){return this.adds.has(e)||this.removes.has(e)||this.removed.has(e)}clear(){this.adds.clear(),this.removes.clear(),this.removed.clear()}};function Kdt(i,e,t,n,r,s,a){const o={layerUid:s,graphicUid:a,triangleNr:e},l=c=>{c.set(Sr.OVERLAY,o,i.dist,i.normal,i.transformation,t,n)};if((r.results.min.drapedLayerOrder==null||t>=r.results.min.drapedLayerOrder)&&(r.results.min.dist==null||r.results.ground.dist<=r.results.min.dist)&&l(r.results.min),r.options.store!==Fa.MIN&&(r.results.max.drapedLayerOrder==null||t<r.results.max.drapedLayerOrder)&&(r.results.max.dist==null||r.results.ground.dist>r.results.max.dist)&&l(r.results.max),r.options.store===Fa.ALL){const c=YU(r.ray);l(c),r.results.all.push(c)}}const qP=q(),KP=q();let bD=class extends _n{initializeProgram(e){return new gn(e.rctx,bD.shader.get().build(),Mn)}initializePipeline(){return this.configuration.hasAlpha?yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i}):yi({colorWrite:$i})}};bD.shader=new bn(rwe,()=>Ee(()=>import("./TextureOnly.glsl-318337e8.js"),["./TextureOnly.glsl-318337e8.js","./vec4f64-e407da96.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js"],import.meta.url));let $7=class extends ic{constructor(){super(...arguments),this.hasAlpha=!1}};f([Pe()],$7.prototype,"hasAlpha",void 0);let cp=class extends vD(et){constructor(e){super(e),this._overlays=null,this._overlayRenderTarget=null,this._hasHighlights=!1,this._rendersOccluded=!1,this._hasWater=!1,this._handles=new mi,this._renderers=new Map,this._sortedDrapeSourceRenderersDirty=!1,this._sortedRenderers=new pn,this._passParameters=new swe,this._rctx=null,this._materialRepository=null,this._screenToWorldRatio=1,this._localOriginFactory=null,this.worldToPCSRatio=1,this.events=new Pn,this.longitudeCyclical=null}get _bindParameters(){return this._renderContext.bindParameters}get rctx(){return this._rctx}get materialRepository(){return this._materialRepository}get screenToWorldRatio(){return this._screenToWorldRatio}get localOriginFactory(){return this._localOriginFactory}initialize(){const e=this.view._stage.renderView;this._rctx=e.renderingContext;const t=e.waterTextureRepository;this._stippleTextureRepository=new dre(e.renderingContext),this._shaderTechniqueRepository=new dfe({rctx:this._rctx,viewingMode:Ot.Local,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:t}),this._renderContext=new gfe(this._rctx,new R7(this._rctx,this.view.state.viewingMode),new Ane(this._shaderTechniqueRepository,this._rctx,()=>{})),this._handles.add([ue(()=>t.updating,()=>this.events.emit("content-changed"),hn),ue(()=>this.spatialReference,n=>this._localOriginFactory=new O7(n),hn),Sn(()=>this.view.allLayerViews,"after-changes",()=>this._sortedDrapeSourceRenderersDirty=!0)]),this._materialRepository=new hfe(e.textureRepository,this._shaderTechniqueRepository,n=>{(n.renderOccluded&rL)>0!==this._rendersOccluded&&this._updateRendersOccluded(),this.events.emit("content-changed"),this.notifyChange("updating")},()=>this.events.emit("content-changed")),this._bindParameters.slot=at.DRAPED_MATERIAL,this._bindParameters.highlightDepthTexture=Ine(this._rctx),this._bindParameters.camera=P0,this._bindParameters.transparencyPassType=ln.NONE,this._bindParameters.newLighting.noonFactor=0,this._bindParameters.newLighting.globalFactor=0,this._bindParameters.newLighting.set([new Ene(Gt(1,1,1))]),this._handles.add(this.view.resourceController.scheduler.registerTask($r.STAGE,this))}dispose(){this._handles.destroy(),this._renderers.forEach(e=>e.destroy()),this._renderers.clear(),this._debugTextureTechnique=Lr(this._debugTextureTechnique),this._passParameters.texture=Ht(this._passParameters.texture),this._bindParameters.highlightDepthTexture=Ht(this._bindParameters.highlightDepthTexture),this._shaderTechniqueRepository=Ht(this._shaderTechniqueRepository),this._temporaryFBO=Ht(this._temporaryFBO),this._quadVAO=Ht(this._quadVAO),this.disposeOverlays()}get updating(){return this._sortedDrapeSourceRenderersDirty||ps(this._renderers,e=>e.updating)}get hasOverlays(){return T(this._overlays)&&T(this._overlayRenderTarget)}get gpuMemoryUsage(){return T(this._overlayRenderTarget)?this._overlayRenderTarget.gpuMemoryUsage:0}createGeometryDrapeSourceRenderer(e){return this.createDrapeSourceRenderer(e,yp)}createDrapeSourceRenderer(e,t,n){const r=this._renderers.get(e);T(r)&&r.destroy();const s=new t({...n,rendererContext:this,drapeSource:e});return this._renderers.set(e,s),this._sortedDrapeSourceRenderersDirty=!0,"fullOpacity"in e&&this._handles.add(ue(()=>e.fullOpacity,()=>this.events.emit("content-changed")),e),s}removeDrapeSourceRenderer(e){if(B(e))return;const t=this._renderers.get(e);B(t)||(this._sortedDrapeSourceRenderersDirty=!0,this._renderers.delete(e),this._handles.remove(e),t.destroy())}collectUnusedRenderTargetMemory(e){let t=!1;if(T(this._overlayRenderTarget))for(const n of this._overlayRenderTarget.renderTargets){const r=this.overlays[0].validTargets[n.type]||!this.overlays[1].validTargets[n.type];t=this._overlayRenderTarget.validateUsageForTarget(r,n,e)||t}return t}get overlays(){return Jt(this._overlays,[])}ensureDrapeTargets(e){T(this._overlays)&&this._overlays.forEach(t=>t.hasTargetWithoutRasterImage=ZD(e,n=>n.drapeTargetType===j6.WithoutRasterImage))}ensureDrapeSources(e){T(this._overlays)&&this._overlays.forEach(t=>{t.hasDrapedFeatureSource=ZD(e,n=>n.drapeSourceType===OE.Features),t.hasDrapedRasterSource=ZD(e,n=>n.drapeSourceType===OE.RasterImage)})}ensureOverlays(e,t){B(this._overlays)&&(this._overlayRenderTarget=new ndt(this._rctx),this._overlays=[new jZ(br.INNER,this._overlayRenderTarget),new jZ(br.OUTER,this._overlayRenderTarget)]),this.ensureDrapeTargets(e),this.ensureDrapeSources(t)}disposeOverlays(){this._overlays=null,this._overlayRenderTarget=Ht(this._overlayRenderTarget),this.events.emit("textures-disposed")}get running(){return this.updating}runTask(e){this._processDrapeSources(e,()=>!0)}_processDrapeSources(e,t){let n=!1;for(const[r,s]of this._renderers){if(e.done)break;(r.destroyed||t(r))&&s.commitChanges()&&(n=!0,e.madeProgress())}this._sortedDrapeSourceRenderersDirty&&(this._sortedDrapeSourceRenderersDirty=!1,n=!0,this._updateSortedDrapeSourceRenderers()),n&&(T(this._overlays)&&this._renderers.size===0&&this.disposeOverlays(),this.notifyChange("updating"),this.events.emit("content-changed"),this._updateHasHighlights(),this._updateRendersOccluded(),this._updateHasWater())}processSyncDrapeSources(){this._processDrapeSources(WL,e=>e.updatePolicy===QI.SYNC)}isEmpty(){if(cn.OVERLAY_DRAW_DEBUG_TEXTURE)return!1;for(const e of this._renderers.values())if(!e.isEmpty)return!1;return!0}get hasHighlights(){return this._hasHighlights}get hasWater(){return this._hasWater}get rendersOccluded(){return this._rendersOccluded}updateAnimation(e){let t=!1;return this._renderers.forEach(n=>t=n.updateAnimation(e)||t),t}updateDrapeSourceOrder(){this._sortedDrapeSourceRenderersDirty=!0}drawTarget(e,t,n){const r=e.canvasGeometries;if(r.numViews===0)return!1;this._screenToWorldRatio=n*e.mapUnitsPerPixel;const s=t.output;if(this.isEmpty()||s===Re.Highlight&&!this.hasHighlights||s===Re.Normal&&!this.hasWater||!e.hasSomeSizedView())return!1;const a=t.fbo;if(!a.isValid())return!1;const o=2*e.resolution,l=e.resolution;a.resize(o,l);const c=this._rctx;P0.pixelRatio=e.pixelRatio*n,this._renderContext.output=s,this._bindParameters.screenToWorldRatio=this._screenToWorldRatio,this._bindParameters.screenToPCSRatio=this._screenToWorldRatio*this.worldToPCSRatio,this._bindParameters.slot=s===Re.Normal?at.DRAPED_WATER:at.DRAPED_MATERIAL,e.applyViewport(this._rctx),a.bind(c),e.index===br.INNER&&(c.setClearColor(0,0,0,0),c.clearSafe(hr.COLOR_BUFFER_BIT));const u=t.type===Ur.ColorNoRasterImage?kv.ExcludeRasterImage:t.type===Ur.Occluded?kv.OccludedOnly:kv.Normal;if(u===kv.OccludedOnly&&(this._renderContext.renderOccludedMask=rL),cn.OVERLAY_DRAW_DEBUG_TEXTURE&&u!==kv.OccludedOnly)for(let d=0;d<r.numViews;d++)this._setViewParameters(r.extents[d],e,P0),this._drawDebugTexture(e.resolution,Xdt[e.index]);return this._renderers.size>0&&this._sortedRenderers.forAll(({drapeSource:d,renderer:h})=>{if(u===kv.ExcludeRasterImage&&d.drapeSourceType===OE.RasterImage)return;const{fullOpacity:p}=d,m=T(p)&&p<1&&s===Re.Color;m&&(this.bindTemporaryFramebuffer(this._rctx,o,l),c.clearSafe(hr.COLOR_BUFFER_BIT));for(let g=0;g<r.numViews;g++)this._setViewParameters(r.extents[g],e,P0),h.render(this._renderContext,this._bindParameters);m&&T(this._temporaryFBO)&&(a.bind(c),this.view._stage.renderView.compositingHelper.compositeOverlay(this._renderContext.bindParameters,this._temporaryFBO.getTexture(),p,e.index))}),c.bindFramebuffer(null),a.generateMipMap(),this._renderContext.resetRenderOccludedMask(),!0}bindTemporaryFramebuffer(e,t,n){B(this._temporaryFBO)&&(this._temporaryFBO=new ufe(e,!1)),this._temporaryFBO.resize(t,n),this._temporaryFBO.bind(e)}async reloadShaders(){await this._shaderTechniqueRepository.reloadAll()}notifyContentChanged(){this.events.emit("content-changed")}intersect(e,t,n,r){var a;let s=0;for(const o of this._renderers.values())s=((a=o.intersect)==null?void 0:a.call(o,e,t,n,r,s))??s}_updateSortedDrapeSourceRenderers(){if(this._sortedRenderers.clear(),this._renderers.size===0)return;const e=this.view.map.allLayers;this._renderers.forEach((t,n)=>{const r=e.indexOf(n.layer);this._sortedRenderers.push(new Ydt(n,t,r<0?1/0:r))}),this._sortedRenderers.sort((t,n)=>t.index-n.index)}_setViewParameters(e,t,n){n.viewport[0]=n.viewport[1]=0,n.viewport[2]=n.viewport[3]=t.resolution,une(n.projectionMatrix,0,e[2]-e[0],0,e[3]-e[1],n.near,n.far),dne(n.viewMatrix,[-e[0],-e[1],0]),this._bindParameters.camera=n}_updateHasWater(){const e=ps(this._renderers,t=>t.hasWater);e!==this._hasWater&&(this._hasWater=e,this.events.emit("has-water",e))}_updateHasHighlights(){const e=ps(this._renderers,t=>t.hasHighlights);e!==this._hasHighlights&&(this._hasHighlights=e,this.events.emit("has-highlights",e))}_updateRendersOccluded(){const e=ps(this._renderers,t=>t.rendersOccluded);e!==this._rendersOccluded&&(this._rendersOccluded=e,this.events.emit("renders-occluded",e))}_drawDebugTexture(e,t){this._ensureDebugPatternResources(e,e,t);const n=this._rctx;n.bindTechnique(this._debugTextureTechnique,this._passParameters,null),n.bindVAO(this._quadVAO),n.drawArrays(Qi.TRIANGLE_STRIP,0,al(this._quadVAO,"geometry"))}_ensureDebugPatternResources(e,t,n){if(je(this._passParameters.color,n[0],n[1],n[2]),this._passParameters.texture)return;const r=new Uint8Array(e*t*4);let s=0;for(let o=0;o<t;o++)for(let l=0;l<e;l++){const c=Math.floor(l/10),u=Math.floor(o/10);c<2||u<2||10*c>e-20||10*u>t-20?(r[s++]=255,r[s++]=255,r[s++]=255,r[s++]=255):(r[s++]=255,r[s++]=255,r[s++]=255,r[s++]=1&c&&1&u?1&l^1&o?0:255:1&c^1&u?0:128)}this._passParameters.texture=new Er(this._rctx,{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.NEAREST,width:e,height:t},r);const a=new $7;a.hasAlpha=!0,this._debugTextureTechnique=this._shaderTechniqueRepository.acquire(bD,a),this._quadVAO=tc(this._rctx)}get test(){return{drapeSourceRenderers:this._renderers,getDrapeSourceRenderer:e=>this._renderers.get(e)}}};var kv;f([y()],cp.prototype,"_sortedDrapeSourceRenderersDirty",void 0),f([qa()],cp.prototype,"_shaderTechniqueRepository",void 0),f([qa()],cp.prototype,"_stippleTextureRepository",void 0),f([y({constructOnly:!0})],cp.prototype,"view",void 0),f([y()],cp.prototype,"worldToPCSRatio",void 0),f([y()],cp.prototype,"spatialReference",void 0),f([y({type:Boolean,readOnly:!0})],cp.prototype,"updating",null),cp=f([ge("esri.views.3d.terrain.OverlayRenderer")],cp),function(i){i[i.Normal=0]="Normal",i[i.OccludedOnly=1]="OccludedOnly",i[i.ExcludeRasterImage=2]="ExcludeRasterImage"}(kv||(kv={}));let Ydt=class{constructor(e,t,n){this.drapeSource=e,this.renderer=t,this.index=n}};const Xdt=[[1,.5,.5],[.5,.5,1]],P0=new Nn;P0.near=1,P0.far=1e4,P0.relativeElevation=null;const L7=-2,rL=Qr.OccludeAndTransparent;function D7(i,e,t,n){const r=t3(i.rings,i.hasZ,qx.CCW_IS_HOLE),s=new Float64Array(r.position.length),a=Jpe(r.position,i.spatialReference,0,s,0,r.position,0,r.position.length/3,e,t,n),o=a!=null;return new Qdt(r.position,s,Efe(r.polygons,r.position,s),Sfe(r.outlines,r.position,s),o,a)}function Tfe(i,e){const t=t3(i.rings,!1,qx.CCW_IS_HOLE),n=Kl(t.position,i.spatialReference,0,t.position,e,0,t.position.length/3);for(let r=2;r<t.position.length;r+=3)t.position[r]=L7;return{position:t.position,polygons:Efe(t.polygons,t.position),outlines:Sfe(t.outlines,t.position),projectionSuccess:n}}function Sfe(i,e,t){return i.filter(({count:n})=>n>1).map(({index:n,count:r})=>{const s=3*n,a=s+3*r;return t?new Zdt(n,r,e.subarray(s,a),t.subarray(s,a)):new Afe(n,r,e.subarray(s,a))})}function Efe(i,e,t){const n=new Array;for(const{index:r,count:s,holeIndices:a,pathLengths:o}of i){if(s<=1)continue;const l=3*r,c=l+3*s,u=a.map(d=>d-r);n.push({index:r,count:s,holeIndices:u,pathLengths:o,position:e.subarray(l,c),mapPosition:t?t.subarray(l,c):void 0})}return n}let Afe=class{constructor(e,t,n){this.index=e,this.count=t,this.position=n}},Zdt=class extends Afe{constructor(e,t,n,r){super(e,t,n),this.mapPosition=r}},Qdt=class{constructor(e,t,n,r,s,a){this.position=e,this.mapPosition=t,this.polygons=n,this.outlines=r,this.projectionSuccess=s,this.sampledElevation=a}};const Jdt=["polygon","extent"];let eht=class extends xf{constructor(e,t,n,r){super(e,t,n,r),this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const o=fD(this._getSymbolSize());if(o)throw new Ze("graphics3dextrudesymbollayer:invalid-size",o)}const e=ms(this.symbolLayer,"material","color"),t=this._getCombinedOpacityAndColor(e),n=gu(t),r=t[3],s=r<1||this.needsDrivenTransparentPass,a={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,diffuse:n,ambient:n,opacity:r,transparent:s,cullFace:s?qs.None:qs.Back,hasVertexColors:!0,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!0};this._material=new v2(a),this._bottomMaterial=new v2({...a,cullFace:qs.Back}),this._context.stage.add(this._material),this._context.stage.add(this._bottomMaterial)}destroy(){super.destroy(),this._material&&(this._context.stage.remove(this._material),this._context.stage.remove(this._bottomMaterial))}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,Jdt,this.symbolLayer.type))return null;const n=this._getVertexOpacityAndColor(e.renderingInfo,255),r=this.setGraphicElevationContext(t,new Dd);return this._createAs3DShape(t,e.renderingInfo,n,r,t.uid)}layerOpacityChanged(e,t){const n=ms(this.symbolLayer,"material","color"),r=this._getCombinedOpacity(n),s=r<1||this.needsDrivenTransparentPass;this._material.setParameters({opacity:r,transparent:s}),this._bottomMaterial.setParameters({opacity:r,transparent:s});const a=this._getLayerOpacity();e.forEach(o=>{const l=t(o);T(l)&&l.layerOpacityChanged(a,this._context.isAsync)})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Iy)}slicePlaneEnabledChanged(e,t){return this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),this._bottomMaterial.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),e.forEach(n=>{const r=t(n);T(r)&&r.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)}),!0}physicalBasedRenderingChanged(){return this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._bottomMaterial.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}pixelRatioChanged(){return!0}_getExtrusionSize(e){let t;return t=e.size&&this._drivenProperties.size?Qut(e.size,2)??0:this._getSymbolSize(),t/=this._context.renderCoordsHelper.unitInMeters,t}applyRendererDiff(e,t){return this._drivenPropertiesChanged(t)?Ns.Recreate_Symbol:Ns.Recreate_Graphics}async queryForSnapping(e,t,n,r){const s=this._getExtrusionSize(n)*this._context.renderCoordsHelper.unitInMeters/t_e(t),{objectId:a,target:o}=e,l=ko(o);switch(l.z=(l.z??0)+s,e.type){case"edge":{const{start:c,end:u}=e,d=ko(c),h=ko(u);return d.z=(d.z??0)+s,h.z=(h.z??0)+s,[mW(a,l,1/0,d,h)]}case"vertex":return[J1e(a,l,1/0),mW(a,o,1/0,o,l)];default:return[]}}_getSymbolSize(){return this.symbolLayer.size??1}_createAs3DShape(e,t,n,r,s){const a=xA(e.geometry);if(B(a))return null;if(a.rings.length===0||!a.rings.some(H=>H.length>0))return this._logGeometryValidationWarnings(a.rings,"rings","ExtrudeSymbol3DLayer"),null;const o=D7(a,this._context.elevationProvider,this._context.renderCoordsHelper,r);this._logGeometryCreationWarnings(o,a.rings,"rings","ExtrudeSymbol3DLayer");const l=v7(a);if(B(l))return null;const c=new Array,u=new Array,d=new Array,h=Go(),p=St(),m=q(),g=this._context.renderCoordsHelper.viewingMode===Ot.Global;g||this._context.renderCoordsHelper.worldUpAtPosition(null,m),zm(a.spatialReference,[l.x,l.y,0],p,this._context.renderCoordsHelper.spatialReference);const _=St();Da(_,p);const b=Ho();r0e(b,_);const{polygons:x,mapPosition:w,position:C}=o,S=C.length/3,E=new Float64Array(3*S*6),A=new Float64Array(3*S*6),P=new Float64Array(3*S*6),O=new Float64Array(1*S*6);let M=0;for(let H=0;H<x.length;++H){const k=x[H],D=k.count;if(this._context.clippingExtent&&(fr(h),Au(h,k.mapPosition),!fh(h,this._context.clippingExtent)))continue;const $=w2(k.mapPosition,k.holeIndices,3);if($.length===0)continue;const F=3*D*2+$.length,Y=new Array(F),ne=new Array($.length),X=6*D,J=3*E.BYTES_PER_ELEMENT,he=new wy(E.buffer,M*J,J,(M+X)*J),ye=3*A.BYTES_PER_ELEMENT,Te=new wy(A.buffer,M*ye,ye,(M+X)*ye),ce=new Float64Array(P.buffer,3*M*P.BYTES_PER_ELEMENT,3*X),ae=new Float64Array(O.buffer,1*M*O.BYTES_PER_ELEMENT,1*X),le=this._getExtrusionSize(t);tht(C,w,$,k,he.typedBuffer,ce,Te.typedBuffer,ae,Y,ne,le,m,g),are(he,he,_),e$(Te,Te,b),M+=6*D;const fe=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:s,layerUid:this._context.layer.uid}),Ue=mQ(Y,Y.length-ne.length,{positions:he.typedBuffer,elevation:ce,normals:Te.typedBuffer,heights:ae},n,fe);c.push(Ue),u.push(this._material),d.push(Ks);const ie=mQ(ne,0,{positions:he.typedBuffer,elevation:ce,normals:Te.typedBuffer,heights:ae},n,fe);c.push(ie),u.push(this._bottomMaterial),d.push(Ks)}if(c.length===0)return null;const V=new xg({geometries:c,materials:u,transformations:d,metadata:{layerUid:this._context.layer.uid,graphicUid:s,isElevationSource:!0}});V.transformation=p;const L=sre(this.symbolLayer,{opacity:this._getLayerOpacity()}),U=T(L)?{baseMaterial:this._material,edgeMaterials:[L],properties:{mergeGeometries:!0,hasSlicePlane:this._context.slicePlaneEnabled}}:null,G=new wf(this,V,c,null,null,rht,r,U);return G.alignedSampledElevation=o.sampledElevation,G.needsElevationUpdates=Iy(r.mode),G}};function mQ(i,e,t,n,r){const s=new Array(i.length).fill(0),a=[[j.POSITION,{size:3,data:t.positions,exclusive:!0}],[j.NORMAL,{size:3,data:t.normals,exclusive:!0}],[j.COLOR,{size:4,data:n,exclusive:!0}],[j.SIZE,{size:1,data:t.heights,exclusive:!0}]],o=[[j.POSITION,i],[j.NORMAL,i],[j.COLOR,s]];return t.elevation&&(a.push([j.MAPPOS,{size:3,data:t.elevation}]),o.push([j.MAPPOS,i])),new Bs(a,o,xh.Triangle,r,e)}function tht(i,e,t,n,r,s,a,o,l,c,u,d,h){const p=t.length/3;let m=0,g=2*n.count;iht(i,e,n.index,n.count,t,0,p,r,s,a,o,l,c,g,u,d,h);let _=2*n.count;g=0,gQ(r,s,o,a,m,n.pathLengths[0],n.count,_,l,g,u),_+=4*n.pathLengths[0],g+=2*n.pathLengths[0],m+=n.pathLengths[0];for(let b=1;b<n.pathLengths.length;++b)gQ(r,s,o,a,m,n.pathLengths[b],n.count,_,l,g,u),_+=4*n.pathLengths[b],g+=2*n.pathLengths[b],m+=n.pathLengths[b]}function iht(i,e,t,n,r,s,a,o,l,c,u,d,h,p,m,g,_){Ge(Cl,g);const b=m>0?1:-1;let x=3*t,w=0,C=3*w,S=n,E=3*S;for(let O=0;O<n;++O)_&&(Cl[0]=i[x+0],Cl[1]=i[x+1],Cl[2]=i[x+2],mt(Cl,Cl)),o[C+0]=i[x+0],o[C+1]=i[x+1],o[C+2]=i[x+2],l[C+0]=e[x+0],l[C+1]=e[x+1],l[C+2]=e[x+2],c[C+0]=-b*Cl[0],c[C+1]=-b*Cl[1],c[C+2]=-b*Cl[2],u[w]=0,o[E+0]=i[x+0]+m*Cl[0],o[E+1]=i[x+1]+m*Cl[1],o[E+2]=i[x+2]+m*Cl[2],l[E+0]=e[x+0],l[E+1]=e[x+1],l[E+2]=e[x+2],c[E+0]=b*Cl[0],c[E+1]=b*Cl[1],c[E+2]=b*Cl[2],u[S]=m,C+=3,E+=3,x+=3,w+=1,S+=1;x=3*s,C=0,E=3*p;const A=m<0?xQ:wQ,P=m<0?wQ:xQ;for(let O=0;O<a;++O)h[C+0]=r[x+A[0]],h[C+1]=r[x+A[1]],h[C+2]=r[x+A[2]],d[E+0]=r[x+P[0]]+n,d[E+1]=r[x+P[1]]+n,d[E+2]=r[x+P[2]]+n,C+=3,E+=3,x+=3}function YP(i,e,t,n,r,s,a){n[s]=n[a],a*=3,i[(s*=3)+0]=i[a+0],i[s+1]=i[a+1],i[s+2]=i[a+2],e[s+0]=e[a+0],e[s+1]=e[a+1],e[s+2]=e[a+2],t[s+0]=r[0],t[s+1]=r[1],t[s+2]=r[2]}const UT=q();function gQ(i,e,t,n,r,s,a,o,l,c,u){let d=r,h=r+1,p=r+a,m=r+a+1,g=o,_=o+1,b=o+2*s,x=o+2*s+1;u<0&&(d=r+a+1,m=r),c*=3;for(let w=0;w<s;++w)w===s-1&&(u>0?(h=r,m=r+a):(h=r,d=r+a)),nht(i,d,h,p,UT),YP(i,e,n,t,UT,g,d),YP(i,e,n,t,UT,_,h),YP(i,e,n,t,UT,b,p),YP(i,e,n,t,UT,x,m),l[c++]=g,l[c++]=b,l[c++]=x,l[c++]=g,l[c++]=x,l[c++]=_,d++,h++,p++,m++,g+=2,_+=2,b+=2,x+=2}const o4=q(),vQ=q(),yQ=q(),_Q=q(),bQ=q();function nht(i,e,t,n,r){e*=3,t*=3,n*=3,je(o4,i[e++],i[e++],i[e++]),je(vQ,i[t++],i[t++],i[t++]),je(yQ,i[n++],i[n++],i[n++]),nt(_Q,vQ,o4),nt(bQ,yQ,o4),vi(r,bQ,_Q),mt(r,r)}const b1=q();function rht(i,e,t,n){const r=i.stageObject,s=r.geometryRecords,a=s.length,o=e.mode!=="absolute-height";let l=0;const c=r.transformation,u=Da(St(),c);for(let d=0;d<a;d+=2){const h=s[d].geometry,p=h.getMutableAttribute(j.POSITION).data,m=h.vertexAttributes.get(j.SIZE).data,g=h.vertexAttributes.get(j.MAPPOS).data,_=new bpe(g),b=p.length/3;let x=0,w=!1,C=0;const S=t.spatialReference;for(let E=0;E<b;E++){b1[0]=p[x],b1[1]=p[x+1],b1[2]=p[x+2],tg(_,t,e,n,XP),o&&(C+=XP.sampledElevation),cn.TESTS_DISABLE_OPTIMIZATIONS?(je(oc,_.array[_.offset+0],_.array[_.offset+1],XP.z+m[x/3]),T(S)&&n.toRenderCoords(oc,S,oc),$t(oc,oc,u)):(je(oc,p[x+0],p[x+1],p[x+2]),$t(oc,oc,c),n.setAltitude(oc,XP.z+m[x/3]),$t(oc,oc,u)),p[x]=oc[0],p[x+1]=oc[1],p[x+2]=oc[2];const A=sht/n.unitInMeters;(Math.abs(b1[0]-p[x])>=A||Math.abs(b1[1]-p[x+1])>=A||Math.abs(b1[2]-p[x+2])>=A)&&(w=!0),_.offset+=3,x+=3}w&&(h.invalidateBoundingInfo(),r.geometryVertexAttrsUpdated(s[d]),s[d+1].geometry.invalidateBoundingInfo(),r.geometryVertexAttrsUpdated(s[d+1])),l+=C/b}return l/a}const oc=q(),Cl=q(),XP=new _M,wQ=[0,2,1],xQ=[0,1,2],sht=.01,mkt=1.2,aht=ox;let wD=class{constructor(e,t,n,r){this.graphics3DSymbolLayer=e,this.renderGeometries=t,this.boundingBox=n,this._drapeSourceRenderer=r,this.type="draped",this.stage=null,this._visible=!1,this._addedToStage=!1,this.isElevationSource=!1}initialize(e){this.stage=e}setVisibility(e){if(this.stage!=null&&this._visible!==e){if(this._visible=e,e&&!this._addedToStage)return this._addedToStage=!0,void this._drapeSourceRenderer.addGeometries(this.renderGeometries,_r.ADD);if(e||this._addedToStage){for(const t of this.renderGeometries)t.instanceParameters.visible=this._visible;this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ls.VISIBILITIES)}}}destroy(){this.stage&&this._addedToStage&&this._drapeSourceRenderer.removeGeometries(this.renderGeometries,_r.REMOVE),this._addedToStage=!1,this._visible=!1,this.stage=null}getCenterObjectSpace(e=q()){return je(e,0,0,0)}getBoundingBoxObjectSpace(e=Go()){return fr(e)}addObjectState(e,t){e===nb.Highlight&&(this.renderGeometries.forEach(n=>{const r=n.addHighlight();t.addRenderGeometry(n,r,this)}),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ls.HIGHLIGHTS))}removeObjectState(e){this.renderGeometries.forEach(t=>{e.removeRenderGeometry(t)})}removeRenderGeometryObjectState(e,t){e.removeHighlight(t),this._addedToStage&&this._drapeSourceRenderer.modifyGeometries(this.renderGeometries,Ls.HIGHLIGHTS)}computeAttachmentOrigin(e){for(const t of this.renderGeometries)t.computeAttachmentOrigin(w1)&&(e.draped.origin[0]+=w1[0],e.draped.origin[1]+=w1[1],e.draped.num++)}async getProjectedBoundingBox(e,t,n,r,s){fr(s);for(let a=0;a<this.renderGeometries.length;a++){const o=this.renderGeometries[a];this._getRenderGeometryProjectedBoundingRect(o,e,CQ,n),N1e(s,CQ)}if(t){let a;ph(s,w1);const o=y7(s,t.service.spatialReference,t);try{a=await t.service.queryElevation(w1[0],w1[1],r,o,"ground")}catch{}T(a)&&(s[2]=Math.min(s[2],a),s[5]=Math.max(s[5],a))}return s}_getRenderGeometryProjectedBoundingRect(e,t,n,r){if(this.boundingBox)lz(Yh,this.boundingBox);else{const s=e.boundingSphere,a=s[3];Yh[0]=s[0]-a,Yh[1]=s[1]-a,Yh[2]=s[2]-a,Yh[3]=s[0]+a,Yh[4]=s[1]+a,Yh[5]=s[2]+a}return t(Yh,0,2),this.calculateRelativeScreenBounds&&r.push({location:ph(Yh),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()}),sz(Yh,n)}};const CQ=qi(),Yh=Go(),w1=q();let Mfe=class{constructor(e,t,n,r=2048){this.text=e,this._alignment=t,this._parameters=n,this._maxSize=r,this._textWidths=[],this._lineWidths=[],this._renderPixelRatio=null,this._displayWidth=null,this._heightMetricsCached=null,this.key=`TextRenderer-${this._parameters.key}-${this._alignment}--${e}`,this._lines=e.split(/\r?\n/)}get displayWidth(){return Math.ceil(this._ensureTextWidth()+2*this._backgroundHorizontalPadding)}get displayHeight(){const e=this._lineSpacing*(this._lines.length-1),t=this._lineHeight;return Math.ceil(e+t+2*this._haloSize+this._backgroundTopPadding+this._backgroundBottomPadding)}get renderedWidth(){return Math.ceil(this._toRenderUnit(this.displayWidth))}get renderedHeight(){return Math.ceil(this._toRenderUnit(this.displayHeight))}get firstRenderedBaselinePosition(){return this._toRenderUnit(this._firstLineYOffset+this._baselinePosition)}get _firstLineYOffset(){return this._backgroundTopPadding+this._haloSize}get _heightMetrics(){return this._ensureHeightMetrics()}get _lineSpacing(){return(this._lineHeight+this._linePadding)*this._parameters.definition.lineSpacingFactor}get _lineHeight(){return this._heightMetrics.lineHeight}get _linePadding(){return this._lineHeight*oht}get _baselinePosition(){return this._heightMetrics.baselinePosition}get _renderedFontSize(){return this._toRenderUnit(this._fontSize)}get _fontSize(){return this._parameters.definition.size}get _renderedHaloSize(){return this._toRenderUnit(this._haloSize)}get _haloSize(){return this._parameters.haloSize}get _backgroundHorizontalPadding(){return this._hasBackground?this._parameters.definition.background.padding[0]:0}get _backgroundVerticalPadding(){return this._hasBackground?this._parameters.definition.background.padding[1]:0}get _backgroundTopPadding(){return Math.max(0,this._backgroundVerticalPadding-this._heightMetrics.paddingTop)}get _backgroundBottomPadding(){return Math.max(0,this._backgroundVerticalPadding-this._heightMetrics.paddingBottom)}get _hasBackground(){return!!this._parameters.backgroundStyle}get renderPixelRatio(){if(B(this._renderPixelRatio)){const e=this._parameters.definition.pixelRatio;this._maxSize>0?this._renderPixelRatio=Math.min(e,Math.min(this._maxSize/this.displayWidth,this._maxSize/this.displayHeight)):this._renderPixelRatio=e}return this._renderPixelRatio}_getLineXOffset(e){switch(this._alignment){case dy.Left:return this._backgroundHorizontalPadding;case dy.Center:return(this.displayWidth-this._lineWidths[e])/2;case dy.Right:return this.displayWidth-this._backgroundHorizontalPadding-this._lineWidths[e]}}render(e,t=0,n=0){e.save();const r=t/=this.renderPixelRatio,s=n/=this.renderPixelRatio,a=this._haloSize,o=this._firstLineYOffset;t+=a,n+=o+this._baselinePosition;const l=this._haloSize>0;l&&this._renderHalo(e,r,s,a,o),this._setFontProperties(e,this._renderedFontSize);for(let c=0;c<this._lines.length;++c){const u=this._lines[c],d=this._getLineXOffset(c);l&&(e.globalCompositeOperation="destination-out",e.fillStyle="rgb(0, 0, 0)",this._fillText(e,u,t+d,n),this._renderLineDecoration(e,t+d,n,this._textWidths[c])),e.globalCompositeOperation="source-over",e.fillStyle=this._parameters.textStyle,this._fillText(e,u,t+this._getLineXOffset(c),n),this._renderLineDecoration(e,t+d,n,this._textWidths[c]),n+=this._lineSpacing}if(cn.TEXT_SHOW_BASELINE){e.strokeStyle=TQ,e.setLineDash([2,2]),e.lineWidth=1;let c=s+o;for(let u=0;u<this._lines.length;++u){const d=c+this._baselinePosition;this._drawLine(e,[r,d],[r+this.displayWidth,d]),c+=this._lineSpacing}}if(cn.TEXT_SHOW_BORDER&&(e.strokeStyle=TQ,e.setLineDash([]),e.lineWidth=1,this._drawBox(e,[r,s],[this.displayWidth,this.displayHeight])),this._hasBackground){const c=this._parameters.definition.background.borderRadius*this.renderPixelRatio;this._roundedRect(e,r,s,c),e.globalCompositeOperation="destination-over",e.fillStyle=this._parameters.backgroundStyle,e.fill()}e.restore()}_renderLineDecoration(e,t,n,r,s=!1){if(this._parameters.definition.font.decoration==="none"||r===0)return;const a=1,o=Math.max(this._parameters.definition.size/16,a);switch(this._parameters.definition.font.decoration){case"underline":n+=2*o;break;case"line-through":n-=.33*this._baselinePosition}const l=s?this._haloSize:0;e.strokeStyle=s?this._parameters.haloStyle:this._parameters.textStyle,e.lineWidth=this._toRenderUnit(o+2*l),e.beginPath(),e.moveTo(this._toRenderUnit(t-l),this._toRenderUnit(n)),e.lineTo(this._toRenderUnit(t+r+l),this._toRenderUnit(n)),e.stroke()}_roundedRect(e,t,n,r){t=this._toRenderUnit(t),n=this._toRenderUnit(n);const s=this.renderedWidth,a=this.renderedHeight;r!==0?(r=lt(r,0,Math.floor(a/2)),e.beginPath(),e.moveTo(t,n+r),e.arcTo(t,n,t+r,n,r),e.lineTo(t+s-r,n),e.arcTo(t+s,n,t+s,n+r,r),e.lineTo(t+s,n+a-r),e.arcTo(t+s,n+a,t+s-r,n+a,r),e.lineTo(t+r,n+a),e.arcTo(t,n+a,t,n+a-r,r),e.closePath()):e.rect(t,n,s,a)}_renderHalo(e,t,n,r,s){const a=this.renderedWidth,o=this.renderedHeight,l=lI(l4,Math.max(a,x1),Math.max(o,x1)),c=l.getContext("2d");c.clearRect(0,0,a,o),this._setFontProperties(c,this._renderedFontSize),c.fillStyle=this._parameters.haloStyle,c.strokeStyle=this._parameters.haloStyle;const u=this._renderedHaloSize<3;c.lineJoin=u?"miter":"round",u?this._renderHaloEmulated(c,r,s):this._renderHaloNative(c,r,s);let d=s+this._baselinePosition;for(let h=0;h<this._lines.length;++h){const p=this._getLineXOffset(h);this._renderLineDecoration(c,r+p,d,this._textWidths[h],!0),d+=this._lineSpacing}e.globalAlpha=this._parameters.definition.halo.color[3],e.drawImage(l,0,0,a,o,this._toRenderUnit(t),this._toRenderUnit(n),a,o),e.globalAlpha=1}_renderHaloEmulated(e,t,n){n+=this._baselinePosition;for(let r=0;r<this._lines.length;++r){const s=this._lines[r],a=this._getLineXOffset(r);for(const[o,l]of Pfe)this._fillText(e,s,t+a+this._haloSize*o,n+this._haloSize*l);n+=this._lineSpacing}}_renderHaloNative(e,t,n){const r=2*this._haloSize;n+=this._baselinePosition;for(let s=0;s<this._lines.length;++s){const a=this._lines[s],o=this._getLineXOffset(s),l=5,c=.1;for(let u=0;u<l;u++){const d=1-(l-1)*c+u*c;e.lineWidth=this._toRenderUnit(d*r),this._strokeText(e,a,t+o,n)}n+=this._lineSpacing}}_setFontProperties(e,t){e.font=this._parameters.fontString(t),e.textAlign="left",e.textBaseline="alphabetic"}_ensureTextWidth(){if(T(this._displayWidth))return this._displayWidth;const e=lI(l4,x1,x1).getContext("2d");this._setFontProperties(e,this._fontSize);let t=2*this._haloSize;const n=this._parameters.definition.font;n.style!=="italic"&&n.style!=="oblique"&&n.weight!=="bold"&&n.weight!=="bolder"||(t+=.3*e.measureText("A").width),this._textWidths.length=0,this._lineWidths.length=0;let r=0;for(const s of this._lines){const a=e.measureText(s).width,o=a+t;this._textWidths.push(a),this._lineWidths.push(o),r=Math.max(r,o)}return this._displayWidth=r,this._displayWidth}_ensureHeightMetrics(){if(B(this._heightMetricsCached)){const e=lI(l4,x1,x1).getContext("2d");this._setFontProperties(e,this._fontSize);const t=e.measureText(this.text+lht),n=this._hasBackground?e.measureText(this._lines[0]):t,r=this._lines.length===1?n:this._hasBackground?e.measureText(this._lines[this._lines.length-1]):t,s=t.actualBoundingBoxAscent+t.actualBoundingBoxDescent;this._heightMetricsCached={paddingTop:t.actualBoundingBoxAscent-n.actualBoundingBoxAscent,paddingBottom:t.actualBoundingBoxDescent-r.actualBoundingBoxDescent,lineHeight:s,baselinePosition:t.actualBoundingBoxAscent}}return this._heightMetricsCached}_toRenderUnit(e){return e*this.renderPixelRatio}_toRoundedRenderUnit(e){return Math.round(e*this.renderPixelRatio)}_fillText(e,t,n,r){e.fillText(t,this._toRenderUnit(n),this._toRenderUnit(r))}_strokeText(e,t,n,r){e.strokeText(t,this._toRenderUnit(n),this._toRenderUnit(r))}_drawLine(e,t,n){e.beginPath(),e.moveTo(this._toRoundedRenderUnit(t[0])+.5,this._toRoundedRenderUnit(t[1])+.5),e.lineTo(this._toRoundedRenderUnit(n[0])+.5,this._toRoundedRenderUnit(n[1])+.5),e.stroke()}_drawBox(e,t,n){const r=this._toRenderUnit(t[0]),s=this._toRenderUnit(t[1]),a=this._toRenderUnit(n[0]),o=this._toRenderUnit(n[1]),l=Math.floor(r)+.5,c=Math.ceil(r+a)-.5,u=Math.floor(s)+.5,d=Math.ceil(s+o)-.5;e.beginPath(),e.moveTo(l,u),e.lineTo(c,u),e.lineTo(c,d),e.lineTo(l,d),e.lineTo(l,u),e.stroke()}};const Pfe=[];for(let e=0;e<360;e+=360/16)Pfe.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)]);var dy;function lI(i,e,t){return i.canvas||(i.canvas=document.createElement("canvas")),i.canvas.width=e,i.canvas.height=t,i.canvas}(function(i){i[i.Left=0]="Left",i[i.Center=1]="Center",i[i.Right=2]="Right"})(dy||(dy={}));const l4={canvas:null},oht=.2,x1=512,TQ="rgb(255, 0, 255, 0.5)",lht=(()=>{let i="";for(let e=32;e<127;e++)i+=String.fromCharCode(e);return i})(),cht=Object.freeze({left:0,center:.5,right:1}),cI=Object.freeze({"bottom-left":dn(0,0),bottom:dn(.5,0),"bottom-right":dn(1,0),left:dn(0,.5),center:dn(.5,.5),right:dn(1,.5),"top-left":dn(0,1),top:dn(.5,1),"top-right":dn(1,1)});function Ofe(i){switch(i){case"left":return dy.Left;case"right":return dy.Right;default:return dy.Center}}function SQ(i){switch(i){case"bottom-left":case"left":case"top-left":return"left";case"bottom":case"center":case"top":return"center";case"bottom-right":case"right":case"top-right":return"right"}}function uht(i){switch(i){case"bottom-left":case"bottom":case"bottom-right":return"bottom";case"left":case"center":case"right":return"center";case"top-left":case"top":case"top-right":return"top"}}function dht(i,e){switch(e){case"bottom":return i==="left"?"bottom-left":i==="right"?"bottom-right":"bottom";case"center":return i;case"top":return i==="left"?"top-left":i==="right"?"top-right":"top"}}function hht(i){return i==="middle"?"center":i}var Mo,EQ,sL;function HT(i){return i!=null}function C1(i){return typeof i=="number"}function xD(i){return typeof i=="string"}function pht(i){return i==null||xD(i)}function Fs(i,e){i&&i.push(e)}function fht(i,e,t,n=St()){const r=i||0,s=e||0,a=t||0;return r!==0&&d2(n,n,-r/180*Math.PI),s!==0&&h2(n,n,s/180*Math.PI),a!==0&&DB(n,n,a/180*Math.PI),n}function Hg(i,e,t,n,r){const s=i.minSize,a=i.maxSize;if(i.expression)return Fs(r,"Could not convert size info: expression not supported"),!1;if(i.useSymbolValue){const o=n.symbolSize[t];return e.minSize[t]=o,e.maxSize[t]=o,e.offset[t]=e.minSize[t],e.factor[t]=0,e.type[t]=Mo.DefinedSize,!0}if(HT(i.field))return HT(i.stops)?i.stops.length===2&&C1(i.stops[0].size)&&C1(i.stops[1].size)?(AQ(i.stops[0].size,i.stops[1].size,i.stops[0].value,i.stops[1].value,e,t),e.type[t]=Mo.DefinedSize,!0):(Fs(r,"Could not convert size info: stops only supported with 2 elements"),!1):C1(s)&&C1(a)&&HT(i.minDataValue)&&HT(i.maxDataValue)?(AQ(s,a,i.minDataValue,i.maxDataValue,e,t),e.type[t]=Mo.DefinedSize,!0):s5[i.valueUnit]!=null?(e.minSize[t]=-1/0,e.maxSize[t]=1/0,e.offset[t]=0,e.factor[t]=1/s5[i.valueUnit],e.type[t]=Mo.DefinedSize,!0):i.valueUnit==="unknown"?(Fs(r,"Could not convert size info: proportional size not supported"),!1):(Fs(r,"Could not convert size info: scale-dependent size not supported"),!1);if(!HT(i.field)){if(i.stops&&i.stops[0]&&C1(i.stops[0].size))return e.minSize[t]=i.stops[0].size,e.maxSize[t]=i.stops[0].size,e.offset[t]=e.minSize[t],e.factor[t]=0,e.type[t]=Mo.DefinedSize,!0;if(C1(s))return e.minSize[t]=s,e.maxSize[t]=s,e.offset[t]=s,e.factor[t]=0,e.type[t]=Mo.DefinedSize,!0}return Fs(r,"Could not convert size info: unsupported variant of sizeInfo"),!1}function AQ(i,e,t,n,r,s){const a=Math.abs(n-t)>0?(e-i)/(n-t):0;r.minSize[s]=a>0?i:e,r.maxSize[s]=a>0?e:i,r.offset[s]=i-t*a,r.factor[s]=a}function mht(i,e,t,n){if(i.normalizationField||i.valueRepresentation)return Fs(n,"Could not convert size info: unsupported property"),null;if(!pht(i.field))return Fs(n,"Could not convert size info: field is not a string"),null;if(e.size){if(i.field)if(e.size.field){if(i.field!==e.size.field)return Fs(n,"Could not convert size info: multiple fields in use"),null}else e.size.field=i.field}else e.size={field:i.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[Mo.Undefined,Mo.Undefined,Mo.Undefined]};let r;switch(i.axis){case"width":return r=Hg(i,e.size,0,t,n),r?e:null;case"height":return r=Hg(i,e.size,2,t,n),r?e:null;case"depth":return r=Hg(i,e.size,1,t,n),r?e:null;case"width-and-depth":return r=Hg(i,e.size,0,t,n),r&&Hg(i,e.size,1,t,n),r?e:null;case null:case void 0:case"all":return r=Hg(i,e.size,0,t,n),r=r&&Hg(i,e.size,1,t,n),r=r&&Hg(i,e.size,2,t,n),r?e:null;default:return Fs(n,`Could not convert size info: unknown axis "${i.axis}""`),null}}function ght(i,e,t){for(let r=0;r<3;++r){let s=e.unitInMeters;i.type[r]===Mo.DefinedSize&&(s*=e.modelSize[r],i.type[r]=Mo.DefinedScale),i.minSize[r]=i.minSize[r]/s,i.maxSize[r]=i.maxSize[r]/s,i.offset[r]=i.offset[r]/s,i.factor[r]=i.factor[r]/s}let n;if(i.type[0]!==Mo.Undefined)n=0;else if(i.type[1]!==Mo.Undefined)n=1;else{if(i.type[2]===Mo.Undefined)return Fs(t,"No size axis contains a valid size or scale"),!1;n=2}for(let r=0;r<3;++r)i.type[r]===Mo.Undefined&&(i.minSize[r]=i.minSize[n],i.maxSize[r]=i.maxSize[n],i.offset[r]=i.offset[n],i.factor[r]=i.factor[n],i.type[r]=i.type[n]);return!0}function MQ(i,e,t){i[4*e+0]=t.r/255,i[4*e+1]=t.g/255,i[4*e+2]=t.b/255,i[4*e+3]=t.a}function vht(i,e,t){if(i.normalizationField)return Fs(t,"Could not convert color info: unsupported property"),null;if(xD(i.field)){if(!i.stops)return Fs(t,"Could not convert color info: missing stops or colors"),null;{if(i.stops.length>8)return Fs(t,"Could not convert color info: too many color stops"),null;e.color={field:i.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};const n=i.stops;for(let r=0;r<8;++r){const s=n[Math.min(r,n.length-1)];e.color.values[r]=s.value,MQ(e.color.colors,r,s.color)}}}else{if(!(i.stops&&i.stops.length>=0))return Fs(t,"Could not convert color info: no field and no colors/stops"),null;{const n=i.stops&&i.stops.length>=0&&i.stops[0].color;e.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};for(let r=0;r<8;r++)e.color.values[r]=1/0,MQ(e.color.colors,r,n)}}return e}function yht(i,e,t){if(i.normalizationField)return Fs(t,"Could not convert opacity info: unsupported property"),null;if(xD(i.field)){if(!i.stops)return Fs(t,"Could not convert opacity info: missing stops or opacities"),null;{if(i.stops.length>8)return Fs(t,"Could not convert opacity info: too many opacity stops"),null;e.opacity={field:i.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};const n=i.stops;for(let r=0;r<8;++r){const s=n[Math.min(r,n.length-1)];e.opacity.values[r]=s.value,e.opacity.opacityValues[r]=s.opacity}}}else{if(!(i.stops&&i.stops.length>=0))return Fs(t,"Could not convert opacity info: no field and no opacities/stops"),null;{const n=i.stops&&i.stops.length>=0&&i.stops[0].opacity;e.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};for(let r=0;r<8;r++)e.opacity.values[r]=1/0,e.opacity.opacityValues[r]=n}}return e}function c4(i,e,t){const n=t===2&&i.rotationType==="arithmetic";e.offset[t]=n?90:0,e.factor[t]=n?-1:1,e.type[t]=1}function _ht(i,e,t){if(!xD(i.field))return Fs(t,"Could not convert rotation info: field is not a string"),null;if(e.rotation){if(i.field)if(e.rotation.field){if(i.field!==e.rotation.field)return Fs(t,"Could not convert rotation info: multiple fields in use"),null}else e.rotation.field=i.field}else e.rotation={field:i.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};switch(i.axis){case"tilt":return c4(i,e.rotation,0),e;case"roll":return c4(i,e.rotation,1),e;case null:case void 0:case"heading":return c4(i,e.rotation,2),e;default:return Fs(t,`Could not convert rotation info: unknown axis "${i.axis}""`),null}}function Rfe(i,e,t){if(!i)return null;const n=!e.supportedTypes||!!e.supportedTypes.size,r=!e.supportedTypes||!!e.supportedTypes.color,s=!e.supportedTypes||!!e.supportedTypes.rotation,a=!!e.supportedTypes&&!!e.supportedTypes.opacity,o=i.reduce((l,c)=>{if(!l)return l;if(c.valueExpression)return Fs(t,"Could not convert visual variables: arcade expressions not supported"),null;switch(c.type){case"size":return n?mht(c,l,e,t):l;case"color":return r?vht(c,l,t):l;case"opacity":return a?yht(c,l,t):null;case"rotation":return s?_ht(c,l,t):l;default:return null}},{size:null,color:null,opacity:null,rotation:null});return!(i.length>0&&o)||o.size||o.color||o.opacity||o.rotation?o&&o.size&&!ght(o.size,e,t)?null:o:null}function k7(i){return i&&i.size!=null}function CA(i,e){if(!i)return{enabled:!1};if(cn.TESTS_DISABLE_FAST_UPDATES)return{enabled:!1};const t=Rfe(i.visualVariables,e);return t?{enabled:!0,visualVariables:t,materialParameters:Ife(t,e),requiresShaderTransformation:k7(t)}:{enabled:!1}}function TA(i,e,t){if(!e||!i.enabled)return!1;const n=i.visualVariables,r=Rfe(e.visualVariables,t);return!!r&&!!(ZP(n.size,r.size,"size")&&ZP(n.color,r.color,"color")&&ZP(n.rotation,r.rotation,"rotation")&&ZP(n.opacity,r.opacity,"opacity"))&&(i.visualVariables=r,i.materialParameters=Ife(r,t),i.requiresShaderTransformation=k7(r),!0)}function ZP(i,e,t){if(!!i!=!!e||i&&i.field!==e.field)return!1;if(i&&t==="rotation"){const n=i,r=e;for(let s=0;s<3;s++)if(n.type[s]!==r.type[s]||n.offset[s]!==r.offset[s]||n.factor[s]!==r.factor[s])return!1}return!0}function Ife(i,e){const t={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},n=k7(i);return i&&i.size?(t.vvSizeEnabled=!0,t.vvSizeMinSize=i.size.minSize,t.vvSizeMaxSize=i.size.maxSize,t.vvSizeOffset=i.size.offset,t.vvSizeFactor=i.size.factor):i&&n&&(t.vvSizeValue=e.transformation.scale),i&&n&&(t.vvSymbolAnchor=e.transformation.anchor,t.vvSymbolRotationMatrix=Ho(),Q0($E),fht(e.transformation.rotation[2],e.transformation.rotation[0],e.transformation.rotation[1],$E),Um(t.vvSymbolRotationMatrix,$E)),i&&i.color&&(t.vvColorEnabled=!0,t.vvColorValues=i.color.values,t.vvColorColors=i.color.colors),i&&i.opacity&&(t.vvOpacityEnabled=!0,t.vvOpacityValues=i.opacity.values,t.vvOpacityOpacities=i.opacity.opacityValues),t}(function(i){i[i.Undefined=0]="Undefined",i[i.DefinedSize=1]="DefinedSize",i[i.DefinedScale=2]="DefinedScale"})(Mo||(Mo={})),function(i){i[i.Undefined=0]="Undefined",i[i.DefinedAngle=1]="DefinedAngle"}(EQ||(EQ={})),function(i){const e=St(),t=q();function n(s,a,o){if(!s.vvSizeEnabled)return o;da(e,o);const l=s.vvSymbolRotationMatrix;hne($E,l[0],l[1],l[2],0,l[3],l[4],l[5],0,l[6],l[7],l[8],0,0,0,0,1),Vs(e,e,$E);for(let c=0;c<3;++c){const u=s.vvSizeOffset[c]+a[0]*s.vvSizeFactor[c];t[c]=lt(u,s.vvSizeMinSize[c],s.vvSizeMaxSize[c])}return pne(e,e,t),of(e,e,s.vvSymbolAnchor),e}function r(s,a,o){if(!a.vvSizeEnabled)return je(s,1,1,1);for(let l=0;l<3;++l){const c=a.vvSizeOffset[l]+o[0]*a.vvSizeFactor[l];s[l]=lt(c,a.vvSizeMinSize[l],a.vvSizeMaxSize[l])}return s}i.evaluateModelTransform=n,i.evaluateModelTransformScale=r}(sL||(sL={}));const $E=St(),Z6=sL.evaluateModelTransform,bht=sL.evaluateModelTransformScale;let wht=class{constructor(){this.visible=!0}},wC=class{constructor(e,t,n={}){this.data=e,this.material=t,this.boundingSphere=Dn(),this.instanceParameters=new wht,this._transformation=St(),this._shaderTransformationDirty=!0,this.layerUid=Jt(n.layerUid,null),this.graphicUid=Jt(n.graphicUid,null),this.id=n.id?n.id:tf(),this.boundingInfo=Jt(n.boundingInfo,null),this.calculateShaderTransformation=Jt(n.calculateShaderTransformation,null),this.castShadow=!!n.castShadow&&n.castShadow}get transformation(){return this._transformation}updateTransformation(e){e(this._transformation),this._shaderTransformationDirty=!0,this.computeBoundingSphere(this._transformation,this.boundingSphere)}shaderTransformationChanged(){this._shaderTransformationDirty=!0}computeBoundingSphere(e,t,n=J0(e)){B(this.boundingInfo)||($t(t,this.boundingInfo.getCenter(),e),t[3]=this.boundingInfo.getBSRadius()*n)}get hasShaderTransformation(){return T(this.calculateShaderTransformation)}get primitiveType(){return this.data.primitiveType}getShaderTransformation(){return B(this.calculateShaderTransformation)?Jt(this.transformation,Ks):(this._shaderTransformationDirty&&(this._shaderTransformation||(this._shaderTransformation=St()),da(this._shaderTransformation,this.calculateShaderTransformation(Jt(this.transformation,Ks))),this._shaderTransformationDirty=!1),this._shaderTransformation)}computeAttachmentOrigin(e){if(this.material.computeAttachmentOrigin)return!!this.material.computeAttachmentOrigin(this,e)&&(T(this._transformation)&&$t(e,e,this._transformation),!0);const t=this.indices.get(j.POSITION),n=this.vertexAttributes.get(j.POSITION);return!!Ybe(n,t,e)&&(T(this._transformation)&&$t(e,e,this._transformation),!0)}get indices(){return this.data.indices}get vertexAttributes(){return this.data.vertexAttributes}addHighlight(){const e=new iL(nb.Highlight),t=this.instanceParameters;return t.highlights=ZN(t.highlights,e),e}removeHighlight(e){const t=this.instanceParameters;t.highlights=QN(t.highlights,e)}};const xht=St(),PQ=Gt(0,0,1),Cht=16,Tht=1.5,O0=Cwe,Sht=[O0/2,O0/2,1-O0/2,1-O0/2],Eht=[vW*O0,vW*O0];let aL=class extends xf{constructor(e,t,n,r){super(e,t,n,r),this._cimLayers=null,this._cimSymbolMaterials=new Map,this._cimSymbolTextures=new Map,this._cimMaterialParametersInfo=null,this._cimRequiredFields=null,this._cimScaleFactorOrFunction=null,this._size=null,this._symbolTextureRatio=1,this._outlineSize=0,this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!0}}getCachedSize(){return{size:this._getIconSize()}}async doLoad(e){this._validateOrThrow();const t=this._prepareMaterialParameters(),n=this._getPrimitive();if(T(n))this._prepareResourcesPrimitive(t,n);else{const r=Nie(this.symbol,this.symbolLayer),s=Rye(r);s&&s.mediaType==="application/json"?await this._prepareResourcesCIM(t,JSON.parse(s.data),e):await this._prepareResourcesHref(t,r,e)}}_validateOrThrow(){if(this._drivenProperties.size)return;const e=fD(this._getIconSize());if(e)throw new Ze("graphics3diconsymbollayer:invalid-size",e)}_getIconSize(){const e=this.symbolLayer,t=Math.round(e.size!=null?Hn(e.size):Cht);return this._drivenProperties.size?Math.max(t,64):t}_generateTextureCIM(e){const t=this._getGraphicHash(e);let n=t===""?null:this._cimSymbolTextures.get(t);if(!n){const r={scaleFactor:this._cimScaleFactorOrFunction},s=this._context.sharedResources.cimSymbolRasterizer.rasterizeCIMSymbol3D(this._cimLayers,e,"esriGeometryPoint",r,null,null);this._cimMaterialParametersInfo.anchorPosition=this._getAnchorPos("relative",s.anchorPosition);const a={width:s.imageData.width,height:s.imageData.height,powerOfTwoResizeMode:iz.PAD};n=new i3(s.imageData,a),this._cimSymbolTextures.set(t,n),this._context.stage.add(n)}return n}_computeSize(e,t){const n=e.width/e.height;return n>1?[t,Math.round(t/n)]:[Math.round(t*n),t]}_prepareMaterialParameters(){const e={anchorPosition:this._getAnchorPos(this.symbolLayer.anchor,this.symbolLayer.anchorPosition)},t=this.symbol;if(Aht(t)){const{screenLength:n,minWorldLength:r,maxWorldLength:s}=t.verticalOffset;e.verticalOffset={screenLength:Hn(n),minWorldLength:r||0,maxWorldLength:T(s)?s:1/0}}return this._context.screenSizePerspectiveEnabled&&(e.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),e.occlusionTest=!0,e.hasSlicePlane=this._context.slicePlaneEnabled,e}_prepareResourcesPrimitive(e,t){const n=this._getOutlineSize();if(u4(t)&&n===0)throw new Error("Nothing to render");if(this._outlineSize=n,e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,T(this._context.sharedResources.textures)){const s=this._context.sharedResources.textures.fromData(`${t}-icon`,()=>xwe(t));this._texture=s.texture,this._releaseTexture=s,e.textureId=this._texture.id}e.textureIsSignedDistanceField=!0,e.distanceFieldBoundingBox=Sht;const r=this._getIconSize();this._size=[r,r],this._symbolTextureRatio=1/O0,this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesHref(e,t,n){if(!Fi("esri-canvas-svg-support")&&lB(t))throw new Ze("graphics3diconsymbollayer:unsupported-image-format","IconSymbol3DLayer failed to load (SVG symbols are not supported in IE11)");this._outlineSize=this._getOutlineSize(),e.color=this._getFillColor(),e.outlineColor=this._getOutlineColor(),e.outlineSize=this._outlineSize,e.textureIsSignedDistanceField=!1;const r=this._getIconSize(),s=r*this._context.graphicsCoreOwner.view.state.pixelRatio;if(T(this._context.sharedResources.textures)){const a=await l2(this._context.sharedResources.textures.fromUrl(t,s,{signal:n}));if(a.ok===!1)throw pye(a.error),new Ze("graphics3diconsymbollayer:request-failed",`Failed to load (Request for icon resource failed: ${t})`);this._releaseTexture=a.value;const o=a.value.texture,l=o.params;this._size=this._computeSize(l,r),e.textureId=o.id}this._createMaterialAndAddToStage(e,this._context.stage)}async _prepareResourcesCIM(e,t,n){const r=new n3({data:t});if(!this._context.sharedResources.cimSymbolRasterizer){const u=(await Ee(()=>import("./CIMSymbolRasterizer-f4829d04.js"),["./CIMSymbolRasterizer-f4829d04.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./promiseUtils-6684e352.js","./screenUtils-410d12c0.js","./cimAnalyzer-721530a4.js","./fontUtils-b94d5e06.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Extent-69509002.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./BidiEngine-836b7ef6.js","./aaBoundingRect-4a760199.js","./jsonUtils-03c4af61.js","./enums-4b2a86a0.js","./utils-c81a5c52.js","./alignmentUtils-ae955d28.js","./definitions-2d0dd0cd.js","./mat2d-d0b91e3e.js","./vec2-2cef68de.js","./vec2f32-461e65a9.js","./number-954e4ab6.js","./Rect-ea14f53a.js","./callExpressionWithFeature-a7532499.js","./quantizationUtils-33aba427.js","./GeometryUtils-eebff0a0.js","./floatRGBA-fa8308d2.js","./Rasterizer-c5722a70.js","./_commonjsHelpers-a430e9ea.js","./imageutils-b39249d8.js","./rasterizingUtils-133923fb.js","./cimSymbolUtils-2e4dde89.js","./Symbol3DAnchorPosition2D-c0f4a14d.js"],import.meta.url)).CIMSymbolRasterizer;Cn(n),this._context.sharedResources.cimSymbolRasterizer||(this._context.sharedResources.cimSymbolRasterizer=new u(this._context.renderCoordsHelper.spatialReference,!0))}const s=this._context.layer.fields?this._context.layer.fields.map(u=>u.toJSON()):null;let a,o;if(this._cimLayers=await this._context.sharedResources.cimSymbolRasterizer.analyzeCIMSymbol(r,s,this._context.renderer&&this._context.renderer.type==="dictionary"?this._context.renderer.fieldMap:null,"esriGeometryPoint",{signal:n}),this._context.renderer&&this._context.renderer.type==="dictionary"&&this._context.renderer.scaleExpression){const u=this._context.renderer;if(isNaN(u.scaleExpression)){const d=u.scaleExpression,h=await w_e(d,this._context.layer.spatialReference,s);o=(p,m,g)=>{const _=wwe(h,p,{$view:g},"esriGeometryPoint",m);return _!==null?_:1}}else a=Number(u.scaleExpression)}this._cimScaleFactorOrFunction=a||o||1;const l=this._context.renderer?await this._context.renderer.getRequiredFields(this._context.layer.fieldsIndex):[];Cn(n);const c=this._context.layer.fieldsIndex;this._cimRequiredFields=l.map(u=>c.get(u).name),this._cimMaterialParametersInfo=e,this._cimMaterialParametersInfo.color=this._getFillColor(),this._cimMaterialParametersInfo.outlineColor=[0,0,0,0],this._cimMaterialParametersInfo.outlineSize=0,this._cimMaterialParametersInfo.textureIsSignedDistanceField=!1}_getPrimitive(){return this.symbolLayer.resource&&this.symbolLayer.resource.href?null:this.symbolLayer.resource&&this.symbolLayer.resource.primitive||zie}_getOutlineSize(){let e=0;const t=this.symbolLayer;return T(t.outline)&&t.outline.size!=null?Math.max(Hn(t.outline.size),0):(e=u4(this._getPrimitive())?Tht:0,Math.max(e,0))}_getOutlineColor(){const e=this._getLayerOpacity(),t=this.symbolLayer,n=ms(t,"outline","color");if(T(n)){const r=Xt.toUnitRGB(n),s=n.a*e;return[r[0],r[1],r[2],s]}return[0,0,0,0]}_getFillColor(){if(u4(this._getPrimitive()))return aht;const e=B(this._getPrimitive()),t=ms(this.symbolLayer,"material","color");return this._getCombinedOpacityAndColor(t,{hasIntrinsicColor:e})}_getAnchorPos(e,t){return e==="relative"?dn((t.x||0)+.5,.5-(t.y||0)):e in cI?cI[e]:cI.center}_createMaterialAndAddToStage(e,t){if(this._cimLayers?this._fastUpdates={enabled:!1}:this._fastUpdates=CA(this._context.renderer,this._fastVisualVariableConvertOptions()),this._fastUpdates.enabled&&Object.assign(e,this._fastUpdates.materialParameters),this._cimLayers){let n=T(e.textureId)?this._cimSymbolMaterials.get(e.textureId):null;return n||(n=new _C(e),this._cimSymbolMaterials.set(Jt(e.textureId,0),n),t.add(n)),n}return this._material=new _C(e),t.add(this._material),this._material}_setDrapingDependentMaterialParameters(){this.draped&&(this._forEachMaterial(e=>{e.setParameters({verticalOffset:null,screenSizePerspective:null,occlusionTest:!1,hasSlicePlane:!1,shaderPolygonOffset:0,isDraped:this.draped})}),this.layerOpacityChanged())}destroy(){super.destroy(),this._forEachMaterial(e=>this._context.stage.remove(e)),this._material=null,this._cimSymbolMaterials.clear(),this._cimSymbolTextures.forEach(e=>this._context.stage.remove(e)),this._cimSymbolTextures.clear(),this._releaseTexture=Lr(this._releaseTexture)}_getScaleFactor(e,t){if(this._drivenProperties.size&&e.size){for(let n=0;n<3;n++){const r=e.size[n];r&&r!=="symbol-value"&&r!=="proportional"&&(e.size[n]=Hn(r))}if(e.size[0]==="symbol-value")return 1;if(isFinite(+e.size[0]))return+e.size[0]/t;if(isFinite(+e.size[2]))return+e.size[2]/t}return 1}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;let n,r;if(this._cimLayers){if(!this._cimLayers.length)return null;const d=this._generateTextureCIM(t),h={textureId:d.id,...this._cimMaterialParametersInfo};r=this._createMaterialAndAddToStage(h,this._context.stage),n=[d.params.width,d.params.height]}else n=this._size,r=kt(this._material);const s=wA(t.geometry);if(B(s))return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const a=e.renderingInfo,o=this._getVertexOpacityAndColor(a);let l=1;if(!this._fastUpdates.enabled||!this._fastUpdates.visualVariables.size){const d=n[0]>n[1]?n[0]:n[1];l=this._getScaleFactor(a,d)}l*=this._symbolTextureRatio;const c=[n[0]*l,n[1]*l],u=this.setGraphicElevationContext(t,new Dd);return this.ensureDrapedStatus(u.mode==="on-the-ground")&&this._setDrapingDependentMaterialParameters(),this.draped?this._createAsOverlay(t,s,r,o,c,e.layer.uid):this._createAs3DShape(t,s,r,o,c,u,t.uid)}layerOpacityChanged(){const e=this._getFillColor(),t=this._getOutlineColor();this._forEachMaterial(n=>{n.setParameters({color:e}),n.setParameters({outlineColor:t})})}layerElevationInfoChanged(e,t,n){const r=this._elevationContext.mode,s=yM(aL.elevationModeChangeTypes,n,r);if(s!==Fr.UPDATE)return s;const a=Rd(r)||r==="absolute-height";return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){return this.draped||this._forEachMaterial(e=>{e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!!this._getPrimitive()}applyRendererDiff(e,t){for(const n in e.diff){if(n!=="visualVariables"||!TA(this._fastUpdates,t,this._fastVisualVariableConvertOptions()))return Ns.Recreate_Symbol;T(this._material)&&this._material.setParameters(this._fastUpdates.materialParameters)}return Ns.Fast_Update}_defaultElevationInfoNoZ(){return Mht}_createAs3DShape(e,t,n,r,s,a,o){const l=this.getFastUpdateAttrValues(e),c=l?m=>Z6(this._fastUpdates.materialParameters,l,m):null,u=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:o,layerUid:this._context.layer.uid}),d=[E6(PQ,null,r,s,Pht,null,l,u)],h=S7(this._context,t,d,[n],a,this._context.layer.uid,o,c);if(h===null)return null;const p=new wf(this,h.object,d,null,null,_A,a);return p.alignedSampledElevation=h.sampledElevation,p.needsElevationUpdates=Rd(a.mode)||a.mode==="absolute-height",p.getScreenSize=this._createScreenSizeGetter(s,c),p.calculateRelativeScreenBounds=m=>n.calculateRelativeScreenBounds(p.getScreenSize(),1,m),bA(p,t,this._context.elevationProvider),p}_createAsOverlay(e,t,n,r,s,a){n.renderPriority=this._renderPriority;const o=Dn();ya(t,o,this._context.overlaySR),o[2]=L7;const l=this._context.clippingExtent;if(T(l)&&!oz(l,o))return null;const c=this.getFastUpdateAttrValues(e),u=c?g=>Z6(this._fastUpdates.materialParameters,c,g):null,d=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:e.uid,layerUid:this._context.layer.uid}),h=E6(PQ,o,r,s,null,null,c,d),p=new wC(h,n,{layerUid:a,graphicUid:e.uid,calculateShaderTransformation:u});o[3]=0,Em(p.boundingSphere,o);const m=new wD(this,[p],null,this._context.drapeSourceRenderer);return m.getScreenSize=this._createScreenSizeGetter(s,u),m.calculateRelativeScreenBounds=g=>n.calculateRelativeScreenBounds(m.getScreenSize(),1,g),m}_createScreenSizeGetter(e,t){const n=this._outlineSize+2;if(this._fastUpdates.enabled){const r=e[0]/this._symbolTextureRatio,s=e[1]/this._symbolTextureRatio;return(a=xt())=>{const o=t(xht);return a[0]=o[0]*r+n,a[1]=o[5]*s+n,a}}{const r=e[0]/this._symbolTextureRatio+n,s=e[1]/this._symbolTextureRatio+n;return(a=xt())=>(a[0]=r,a[1]=s,a)}}_fastVisualVariableConvertOptions(){const e=this._size[0]>this._size[1]?this._size[0]:this._size[1],t=Gt(e,e,e),n=Gp(1),r=e*n;return{modelSize:t,symbolSize:Gt(r,r,r),unitInMeters:n,transformation:{anchor:wd,scale:Zv,rotation:wd}}}_getGraphicHash(e){let t="";for(const n of this._cimRequiredFields)t+=n+e.attributes[n];return t}_forEachMaterial(e){T(this._material)&&e(this._material),this._cimSymbolMaterials.forEach(e)}test(){return{...super.test(),material:this._material}}};function Aht(i){return i&&i.type==="point-3d"&&i.hasVisibleVerticalOffset()}function u4(i){return!B(i)&&(i==="cross"||i==="x")}aL.PRIMITIVE_SIZE=Eht,aL.elevationModeChangeTypes={definedChanged:Fr.UPDATE,staysOnTheGround:Fr.NONE,onTheGroundChanged:Fr.RECREATE};const Mht={mode:"relative-to-ground",offset:0},Pht=Xn(0,0,0,1);function Q6(i){switch(i){case"butt":return cx.BUTT;case"square":return cx.SQUARE;case"round":return cx.ROUND;default:return null}}function Oht(i){return i==="diamond"?"kite":i}function J6(i,e=null){const t=[],n=[];Rht(i,n,t);const r=n[0][1].data,s=t[0][1].length,a=new Array(s).fill(0);return Iht(i,n,t),$ht(i,n,t,a),kht(i,n,t,a),Lht(i,n,t,a),Dht(i,n,t,a),Fht(i,n,t,a),Nht(i,n,t,a),Vht(i,n,t,r),new Bs(n,t,xh.Line,e)}function Rht(i,e,t){const{attributeData:{position:n},removeDuplicateStartEnd:r}=i,s=Bht(n)&&r,a=n.length/3-(s?1:0),o=new Array(2*(a-1)),l=s?vie(n,0,n.length-3):n;let c=0;for(let u=0;u<a-1;u++)o[c++]=u,o[c++]=u+1;e.push([j.POSITION,{size:3,data:l,exclusive:s}]),t.push([j.POSITION,o])}function Iht(i,e,t){const n=i.attributeData.mapPosition;B(n)||(t.push([j.MAPPOS,t[0][1]]),e.push([j.MAPPOS,{size:3,data:n}]))}function $ht(i,e,t,n){if(T(i.attributeData.colorFeature))return;const r=i.attributeData.color;e.push([j.COLOR,{size:4,data:Jt(r,oh)}]),t.push([j.COLOR,n])}function Lht(i,e,t,n){if(!T(i.attributeData.normal))return;const r=i.attributeData.normal;e.push([j.NORMAL,{size:3,data:r}]),t.push([j.NORMAL,n])}function Dht(i,e,t,n){const r=i.attributeData.colorFeature;B(r)||(e.push([j.COLORFEATUREATTRIBUTE,{size:1,data:new Float32Array([r])}]),t.push([j.COLOR,n]))}function kht(i,e,t,n){if(T(i.attributeData.sizeFeature))return;const r=i.attributeData.size;e.push([j.SIZE,{size:1,data:[Jt(r,1)]}]),t.push([j.SIZE,n])}function Fht(i,e,t,n){const r=i.attributeData.sizeFeature;B(r)||(e.push([j.SIZEFEATUREATTRIBUTE,{size:1,data:new Float32Array([r])}]),t.push([j.SIZEFEATUREATTRIBUTE,n]))}function Nht(i,e,t,n){const r=i.attributeData.opacityFeature;B(r)||(e.push([j.OPACITYFEATUREATTRIBUTE,{size:1,data:new Float32Array([r])}]),t.push([j.OPACITYFEATUREATTRIBUTE,n]))}function Vht(i,e,t,n){if(B(i.overlayInfo)||i.overlayInfo.renderCoordsHelper.viewingMode!==Ot.Global||!i.overlayInfo.spatialReference.isGeographic)return;const r=new Float64Array(n.length),s=rn(i.overlayInfo.spatialReference);for(let h=0;h<r.length;h+=3)Cie(n,h,r,h,s);const a=n.length/3,o=new Float32Array(a+1);let l=zht,c=Uht,u=0,d=0;je(l,r[d++],r[d++],r[d++]),o[0]=0;for(let h=1;h<a+1;++h)h===a&&(d=0),je(c,r[d++],r[d++],r[d++]),u+=e0e(l,c),o[h]=u,[l,c]=[c,l];e.push([j.DISTANCETOSTART,{size:1,data:o}]),t.push([j.DISTANCETOSTART,t[0][1]])}function Bht(i){const e=i.length;return i[0]===i[e-3]&&i[1]===i[e-2]&&i[2]===i[e-1]}var OQ;(function(i){i[i.KEEP=0]="KEEP",i[i.REMOVE=1]="REMOVE"})(OQ||(OQ={}));const zht=q(),Uht=q();function wkt(i,e){if(B(i)||i.length===0)return[];const t=[];return i.forEach(n=>{const r=n.length,s=new Float64Array(3*r);n.forEach((o,l)=>{s[3*l+0]=o[0],s[3*l+1]=o[1],s[3*l+2]=o[2]});const a={attributeData:{position:s,normal:e},removeDuplicateStartEnd:!1};t.push(a)}),t}function Hht(i,e,t,n){const r=i.type==="polygon"?qx.CCW_IS_HOLE:qx.NONE,s=i.type==="polygon"?i.rings:i.paths,{position:a,outlines:o}=t3(s,i.hasZ,r),l=new Float64Array(a.length),c=Jpe(a,i.spatialReference,0,l,0,a,0,a.length/3,e,t,n),u=c!=null;return{lines:u?$fe(o,a,l):[],projectionSuccess:u,sampledElevation:c}}function Ght(i,e){const t=i.type==="polygon"?qx.CCW_IS_HOLE:qx.NONE,n=i.type==="polygon"?i.rings:i.paths,{position:r,outlines:s}=t3(n,!1,t),a=Kl(r,i.spatialReference,0,r,e,0,r.length/3);for(let o=2;o<r.length;o+=3)r[o]=L7;return{lines:a?$fe(s,r):[],projectionSuccess:a}}function $fe(i,e,t){const n=new Array;for(const{index:r,count:s}of i){if(s<=1)continue;const a=3*r,o=a+3*s;n.push({position:e.subarray(a,o),mapPosition:t?t.subarray(a,o):void 0})}return n}const Lfe=new Map([[j.POSITION,0],[j.UV0,2],[j.AUXPOS1,3],[j.NORMAL,4],[j.COLOR,5],[j.COLORFEATUREATTRIBUTE,5],[j.SIZE,6],[j.SIZEFEATUREATTRIBUTE,6],[j.OPACITYFEATUREATTRIBUTE,7]]);let F7=class extends _n{initializeProgram(e){return new gn(e.rctx,F7.shader.get().build(this.configuration),Lfe)}_makePipelineState(e,t){const n=this.configuration,r=e===ln.NONE;return yi({blending:n.output===Re.Color||n.output===Re.Alpha?r?xd:Ly(e):null,depthTest:{func:Eb(e)},depthWrite:r?n.writeDepth&&Lu:JL(e),colorWrite:$i,stencilWrite:n.hasOccludees?Gm:null,stencilTest:n.hasOccludees?t?ib:Ab:null,polygonOffset:{factor:0,units:-10}})}initializePipeline(){return this.configuration.occluder&&(this._occluderPipelineTransparent=yi({blending:xd,depthTest:XI,depthWrite:null,colorWrite:$i,stencilWrite:null,stencilTest:Wne}),this._occluderPipelineOpaque=yi({blending:xd,depthTest:XI,depthWrite:null,colorWrite:$i,stencilWrite:jne,stencilTest:qne}),this._occluderPipelineMaskWrite=yi({blending:null,depthTest:ZB,depthWrite:null,colorWrite:null,stencilWrite:Gm,stencilTest:ib})),this._occludeePipelineState=this._makePipelineState(this.configuration.transparencyPassType,!0),this._makePipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:this.configuration.occluder?e===at.TRANSPARENT_OCCLUDER_MATERIAL?this._occluderPipelineTransparent:e===at.OCCLUDER_MATERIAL?this._occluderPipelineOpaque:this._occluderPipelineMaskWrite:super.getPipelineState(e,t)}};F7.shader=new bn(Twe,()=>Ee(()=>import("./LineMarker.glsl-87de55bb.js"),["./LineMarker.glsl-87de55bb.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./floatRGBA-fa8308d2.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./Texture-bbae5d9d.js","./compilerUtils-034cacb8.js","./Error-653283ae.js","./Evented-515b9d9c.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec2f64-30dc1443.js","./vec4f64-e407da96.js","./mat4-44a0988f.js","./mat4f64-1e28eae0.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./assets-0b172f07.js","./Matrix3PassUniform-da8eddae.js","./vec3f32-c9aa289f.js","./MarkerSizing.glsl-c6fa192a.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./FloatPassUniform-d2dfc562.js","./sdfPrimitives-a24e9cb2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./TransparencyPassType-cd195b0e.js","./DefaultTechniqueConfiguration-e8962072.js","./LineMarker.glsl-8f444621.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./OutputDepth.glsl-179f1d8f.js","./RgbaFloatEncoding.glsl-6036ca34.js","./MultipassTerrainTest.glsl-e79d40de.js","./ReadLinearDepth.glsl-7ff30f7d.js","./AlphaCutoff-96178e0d.js"],import.meta.url));let Wht=class extends ug{constructor(e){super(e,new qht),this._vertexAttributeLocations=Lfe,this._configuration=new awe,this._layout=this.createLayout()}dispose(){}getConfiguration(e,t){return this._configuration.output=e,this._configuration.space=t.slot===at.DRAPED_MATERIAL?nk.Draped:this.parameters.worldSpace?nk.World:nk.Screen,this._configuration.hideOnShortSegments=this.parameters.hideOnShortSegments,this._configuration.hasCap=this.parameters.cap!==cx.BUTT,this._configuration.anchor=this.parameters.anchor,this._configuration.hasTip=this.parameters.hasTip,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.occluder=this.parameters.renderOccluded===Qr.OccludeAndTransparentStencil,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(){}createLayout(){const e=Js().vec3f(j.POSITION).vec2f(j.UV0).vec3f(j.AUXPOS1);return this.parameters.worldSpace&&e.vec3f(j.NORMAL),this.parameters.vvSizeEnabled?e.f32(j.SIZEFEATUREATTRIBUTE):e.f32(j.SIZE),this.parameters.vvColorEnabled?e.f32(j.COLORFEATUREATTRIBUTE):e.vec4f(j.COLOR),this.parameters.vvOpacityEnabled&&e.f32(j.OPACITYFEATUREATTRIBUTE),e}createBufferWriter(){return new Kht(this._layout,this.parameters)}requiresSlot(e,t){return t===Re.Color||t===Re.Alpha||t===Re.Highlight||t===Re.Depth?e===at.DRAPED_MATERIAL?!0:this.parameters.renderOccluded===Qr.OccludeAndTransparentStencil?e===at.OPAQUE_MATERIAL||e===at.OCCLUDER_MATERIAL||e===at.TRANSPARENT_OCCLUDER_MATERIAL:t===Re.Color||t===Re.Alpha?e===(this.parameters.writeDepth?at.TRANSPARENT_MATERIAL:at.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):e===at.OPAQUE_MATERIAL:!1}createGLMaterial(e){return new jht(e)}},jht=class extends Une{_updateParameters(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(F7,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==Re.Color&&this._output!==Re.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}},qht=class extends Rne{constructor(){super(...arguments),this.width=0,this.color=[1,1,1,1],this.placement="end",this.cap=cx.BUTT,this.anchor=cre.Center,this.hasTip=!1,this.worldSpace=!1,this.hideOnShortSegments=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.vvFastUpdate=!1,this.hasOccludees=!1}},Kht=class{constructor(e,t){this.vertexBufferLayout=e,this._parameters=t}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(){return this._parameters.placement==="begin-end"?12:6}write(e,t,n,r,s){const a=n.vertexAttributes.get(j.POSITION).data,o=a.length/3;let l=[1,0,0];const c=n.vertexAttributes.get(j.NORMAL);this._parameters.worldSpace&&T(c)&&(l=c.data);let u=1,d=0;this._parameters.vvSizeEnabled?d=n.vertexAttributes.get(j.SIZEFEATUREATTRIBUTE).data[0]:n.vertexAttributes.has(j.SIZE)&&(u=n.vertexAttributes.get(j.SIZE).data[0]);let h=[1,1,1,1],p=0;this._parameters.vvColorEnabled?p=n.vertexAttributes.get(j.COLORFEATUREATTRIBUTE).data[0]:n.vertexAttributes.has(j.COLOR)&&(h=n.vertexAttributes.get(j.COLOR).data);let m=0;this._parameters.vvOpacityEnabled&&(m=n.vertexAttributes.get(j.OPACITYFEATUREATTRIBUTE).data[0]);const g=new Float32Array(r.buffer);let _=s*(this.vertexBufferLayout.stride/4);const b=(S,E,A,P)=>{if(g[_++]=S[0],g[_++]=S[1],g[_++]=S[2],g[_++]=A[0],g[_++]=A[1],g[_++]=E[0],g[_++]=E[1],g[_++]=E[2],this._parameters.worldSpace&&(g[_++]=l[0],g[_++]=l[1],g[_++]=l[2]),this._parameters.vvSizeEnabled?g[_++]=d:g[_++]=u,this._parameters.vvColorEnabled)g[_++]=p;else{const O=Math.min(4*P,h.length-4);g[_++]=h[O+0],g[_++]=h[O+1],g[_++]=h[O+2],g[_++]=h[O+3]}this._parameters.vvOpacityEnabled&&(g[_++]=m)};let x;(function(S){S[S.ASCENDING=1]="ASCENDING",S[S.DESCENDING=-1]="DESCENDING"})(x||(x={}));const w=(S,E)=>{const A=je(Yht,a[3*S],a[3*S+1],a[3*S+2]),P=Xht;let O=S+E;do je(P,a[3*O],a[3*O+1],a[3*O+2]),O+=E;while(af(A,P)&&O>=0&&O<o);e&&($t(A,A,e),$t(P,P,e)),b(A,P,[-1,-1],S),b(A,P,[1,-1],S),b(A,P,[1,1],S),b(A,P,[-1,-1],S),b(A,P,[1,1],S),b(A,P,[-1,1],S)},C=this._parameters.placement;C!=="begin"&&C!=="begin-end"||w(0,x.ASCENDING),C!=="end"&&C!=="begin-end"||w(o-1,x.DESCENDING)}};const Yht=q(),Xht=q(),go={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},Zht={dash:go.dash,"dash-dot":[...go.dash,...go.dot],dot:go.dot,"long-dash":go["long-dash"],"long-dash-dot":[...go["long-dash"],...go.dot],"long-dash-dot-dot":[...go["long-dash"],...go.dot,...go.dot],none:null,"short-dash":go["short-dash"],"short-dash-dot":[...go["short-dash"],...go["short-dot"]],"short-dash-dot-dot":[...go["short-dash"],...go["short-dot"],...go["short-dot"]],"short-dot":go["short-dot"],solid:null},Qht=8;function Jht(i,e=2){return B(i)?i:{pattern:i.slice(),pixelRatio:e}}function Akt(i,e=2){return{pattern:[i,i],pixelRatio:e}}function Dfe(i){return T(i)&&i.type==="style"?ept(i.style):null}function ept(i){return T(i)?Jht(Zht[i],Qht):null}const tpt=["polyline","polygon","extent"];let N7=class extends xf{constructor(e,t,n,r){super(e,t,n,r)}async doLoad(){if(this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[1,1,1],unitInMeters:1,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=CA(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1},!this._drivenProperties.size&&(this.symbolLayer.size!=null?this.symbolLayer.size:Gp(1))<0)throw new Ze("graphics3dlinesymbollayer:invalid-size","Symbol sizes may not be negative values");this._markerTexture=T(this.symbolLayer.marker)&&T(this._context.sharedResources.textures)?owe(this._context.sharedResources.textures,Oht(this.symbolLayer.marker.style)):null}_getMaterialParameters(e,t=!1){var s;const n=this._getCombinedOpacityAndColor(t&&this._markerColor||this._materialColor);this._patternHidesLine&&!t&&(n[3]=0);const r={width:this._computeMaterialWidth((s=this.symbolLayer)==null?void 0:s.size),color:n,hasPolygonOffset:!0,join:this.symbolLayer.join||"miter",cap:Q6(this.symbolLayer.cap||"butt"),hasSlicePlane:this._context.slicePlaneEnabled,isClosed:e,stipplePattern:Dfe(this.symbolLayer.pattern),stippleScaleWithLineWidth:!0};return this._fastUpdates&&this._fastUpdates.visualVariables?{...r,...this._fastUpdates.materialParameters}:r}get _materialColor(){return Qa(this.symbolLayer.material,e=>e.color)}get _markerColor(){return Qa(this.symbolLayer.marker,e=>e.color)}get _lineMaterial(){return B(this._lineMaterialCached)&&(this._lineMaterialCached=new Kw(this._getMaterialParameters(!1)),this._context.stage.add(this._lineMaterialCached)),this._lineMaterialCached}get _ringMaterial(){return B(this._ringMaterialCached)&&(this._ringMaterialCached=new Kw(this._getMaterialParameters(!0)),this._context.stage.add(this._ringMaterialCached)),this._ringMaterialCached}get _wireframeLineMaterial(){return B(this._wireframeLineMaterialCached)&&(this._wireframeLineMaterialCached=new Kw({...this._getMaterialParameters(!1),wireframe:!0}),this._context.stage.add(this._wireframeLineMaterialCached)),this._wireframeLineMaterialCached}get _wireframeRingMaterial(){return B(this._wireframeRingMaterialCached)&&(this._wireframeRingMaterialCached=new Kw({...this._getMaterialParameters(!0),wireframe:!0}),this._context.stage.add(this._wireframeRingMaterialCached)),this._wireframeRingMaterialCached}get _markerMaterial(){return B(this._markerMaterialCached)&&T(this.symbolLayer.marker)&&T(this._markerTexture)&&(this._markerMaterialCached=new Wht({...this._getMaterialParameters(!1,!0),placement:this.symbolLayer.marker.placement,textureId:this._markerTexture.texture.id}),this._context.stage.add(this._markerMaterialCached)),this._markerMaterialCached}destroy(){super.destroy(),this._forEachMaterial(e=>this._context.stage.remove(e)),this._lineMaterialCached=null,this._ringMaterialCached=null,this._wireframeLineMaterialCached=null,this._wireframeRingMaterialCached=null,this._markerMaterialCached=null,this._markerTexture=Lr(this._markerTexture)}_getDrivenSize(e){return this._drivenProperties.size&&e.size?Hn(Jut(e.size)):1}_getSizeFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?$m(this._fastUpdates.visualVariables.size.field,e):null}_getDrivenColor(e){const t=Xn(1,1,1,1);return this._drivenProperties.color&&e.color&&(t[0]=e.color[0],t[1]=e.color[1],t[2]=e.color[2],e.color.length>0&&(t[3]=e.color[3])),this._drivenProperties.opacity&&e.opacity&&(t[3]=e.opacity),t}_getColorFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color?$m(this._fastUpdates.visualVariables.color.field,e):null}_getOpacityFeatureAttributeData(e){return this._fastUpdates.enabled&&this._fastUpdates.visualVariables.opacity?$m(this._fastUpdates.visualVariables.opacity.field,e):null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,tpt,this.symbolLayer.type))return null;const n=this.setGraphicElevationContext(t,new Dd);return this.ensureDrapedStatus(n.mode==="on-the-ground"),this.draped?this._createAsOverlay(e,this._context.layer.uid):this._createAs3DShape(e,n,t.uid)}applyRendererDiff(e,t){for(const n in e.diff){if(n!=="visualVariables"||!TA(this._fastUpdates,t,this._vvConvertOptions))return Ns.Recreate_Symbol;this._forEachMaterial(r=>r.setParameters(this._fastUpdates.materialParameters))}return Ns.Fast_Update}prepareSymbolLayerPatch(e){var s,a;if(e.diff.type!=="partial")return;const t=e.diff.diff,n={};((s=t.size)==null?void 0:s.type)==="complete"&&(n.width=this._computeMaterialWidth(t.size.newValue),delete t.size),((a=t.cap)==null?void 0:a.type)==="complete"&&(n.cap=Q6(Jt(t.cap.newValue,"butt")),delete t.cap);const r=this._prepareMarkerPatch(e,t);this._prepareMaterialPatch(e,t,r),e.symbolLayerStatePatches.push(()=>this._forEachMaterial(o=>o.setParameters(n)))}layerOpacityChanged(){this._forEachMaterial((e,t)=>this._updateMaterialLayerOpacity(e,t))}_forEachMaterial(e){T(this._lineMaterialCached)&&e(this._lineMaterialCached),T(this._ringMaterialCached)&&e(this._ringMaterialCached),T(this._wireframeLineMaterialCached)&&e(this._wireframeLineMaterialCached),T(this._wireframeRingMaterialCached)&&e(this._wireframeRingMaterialCached),T(this._markerMaterialCached)&&e(this._markerMaterialCached,!0)}_updateMaterialLayerOpacity(e,t=!1){const n=e.parameters.color,r=ms(this.symbolLayer,"material","color"),s=this._patternHidesLine&&!t?0:this._getCombinedOpacity(r),a=Xn(n[0],n[1],n[2],s);e.setParameters({color:a})}layerElevationInfoChanged(e,t,n){const r=this._elevationContext.mode,s=yM(N7.elevationModeChangeTypes,n,r);if(s!==Fr.UPDATE)return s;const a=Rd(r);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){const e={hasSlicePlane:this._context.slicePlaneEnabled};return this._forEachMaterial(t=>t.setParameters(e)),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_getGeometryAsPolygonOrPolyline(e){switch(e.type){case"extent":if(e instanceof fs)return Om.fromExtent(e);break;case"polygon":case"polyline":return e}return null}_createAs3DShape(e,t,n){const r=e.graphic,s=this._getGeometryAsPolygonOrPolyline(r.geometry),a=s.type==="polygon"?s.rings:s.paths,o=new Array,l=new Array,c=new Array,u=Go(),d=Hht(s,this._context.elevationProvider,this._context.renderCoordsHelper,t),h=s.type==="polygon"?"rings":"paths";this._logGeometryCreationWarnings(d,a,h,"LineSymbol3DLayer");for(let g=0;g<d.lines.length;g++){const{position:_,mapPosition:b}=d.lines[g];if(T(this._context.clippingExtent)&&(fr(u),Au(u,b),!fh(u,this._context.clippingExtent)))continue;const x=this._createGeometry(e,_,b,s.type,LE.ELEVATED,n);o.push(x),l.push(s.type==="polygon"?this._ringMaterial:this._lineMaterial),c.push(Ks),cn.LINE_WIREFRAMES&&(o.push(x.cloneShallow()),l.push(s.type==="polygon"?this._wireframeRingMaterial:this._wireframeLineMaterial),c.push(Ks));const w=this._markerMaterial;T(w)&&(o.push(x.cloneShallow()),l.push(w),c.push(Ks))}if(o.length===0)return null;const p=new xg({geometries:o,materials:l,transformations:c,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:n}}),m=new wf(this,p,o,null,null,Sut,t);return m.alignedSampledElevation=d.sampledElevation,m.needsElevationUpdates=Rd(t.mode),m}_createGeometry(e,t,n,r,s,a){const o=r==="polygon",l=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.color,c=this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size,u=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:a,layerUid:this._context.layer.uid});return J6({overlayInfo:s===LE.DRAPED?{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper}:null,removeDuplicateStartEnd:o,attributeData:{position:t,mapPosition:n,size:c?null:this._getDrivenSize(e.renderingInfo),color:l?null:this._getDrivenColor(e.renderingInfo),sizeFeature:this._getSizeFeatureAttributeData(e.graphic),colorFeature:this._getColorFeatureAttributeData(e.graphic),opacityFeature:this._getOpacityFeatureAttributeData(e.graphic)}},u)}_createAsOverlay(e,t){const n=e.graphic,r=this._getGeometryAsPolygonOrPolyline(n.geometry),s=r.type==="polygon"?r.rings:r.paths,a=r.type==="polygon"?this._ringMaterial:this._lineMaterial;a.renderPriority=this._renderPriority;const o=cn.LINE_WIREFRAMES?r.type==="polygon"?this._wireframeRingMaterial:this._wireframeLineMaterial:null,l=this._markerMaterial;T(o)&&(o.renderPriority=this._renderPriority-.001),T(l)&&(l.renderPriority=this._renderPriority-.002);const c=new Array,u=Go(),d=fr(),h=Ght(r,this._context.overlaySR),p=r.type==="polygon"?"rings":"paths";this._logGeometryCreationWarnings(h,s,p,"LineSymbol3DLayer");for(const m of h.lines){if(fr(u),Au(u,m.position),!fh(u,this._context.clippingExtent))continue;jx(d,u);const g=this._createGeometry(e,m.position,null,r.type,LE.DRAPED,n.uid),_=x=>{const w=new wC(g,x,{layerUid:t,graphicUid:n.uid});return c.push(w),w};if(T(l)){const x=_(l),w=kt(this.symbolLayer.marker).placement;w!=="begin"&&w!=="begin-end"||Au(u,m.position,0,1),w!=="end"&&w!=="begin-end"||Au(u,m.position,m.position.length-3,1),this._updateBoundingSphere(x,u)}const b=_(a);if(this._updateBoundingSphere(b,u),cn.LINE_WIREFRAMES){const x=_(o);this._updateBoundingSphere(x,u)}}return new wD(this,c,d,this._context.drapeSourceRenderer)}_updateBoundingSphere(e,t){dl(e.boundingSphere,.5*(t[0]+t[3]),.5*(t[1]+t[4]),0,.5*Math.sqrt((t[3]-t[0])*(t[3]-t[0])+(t[4]-t[1])*(t[4]-t[1])))}get _patternHidesLine(){const e=this.symbolLayer.pattern;return T(e)&&e.type==="style"&&e.style==="none"}_computeMaterialWidth(e){return e=Jt(e,Gp(1)),this._drivenProperties.size?this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size?Hn(1):1:Hn(e)}_prepareMaterialPatch(e,t,n){const r=t.material;if(B(r))return void(n.changed&&n.useMaterialColor&&this._patchMaterialColor(this._getCombinedOpacityAndColor(this._materialColor),this._markerMaterialCached,e));if(r.type==="collection")return;const s=r.type==="complete"?Qa(r.newValue,o=>o.color):r.diff.color.type==="complete"?r.diff.color.newValue:null,a=this._getCombinedOpacityAndColor(s);n.useMaterialColor&&this._patchMaterialColor(NB(a),this._markerMaterialCached,e),this._patternHidesLine&&(a[3]=0),this._patchMaterialColor(a,this._lineMaterialCached,e),delete t.material}_prepareMarkerPatch(e,t){const n=t.marker;if(B(n)||n.type!=="partial"||T(n.diff.style)||T(n.diff.placement)||T(n.diff.color)&&n.diff.color.type!=="complete")return{changed:!1,useMaterialColor:B(this._markerColor)};const r=n.diff.color;if(B(r))return delete t.marker,{changed:!1,useMaterialColor:B(this._markerColor)};const s=kt(r.newValue);return B(s)?(delete t.marker,{changed:!0,useMaterialColor:!0}):(this._patchMaterialColor(this._getCombinedOpacityAndColor(s),this._markerMaterialCached,e),delete t.marker,{changed:!0,useMaterialColor:!1})}_patchMaterialColor(e,t,n){B(t)||n.symbolLayerStatePatches.push(()=>t.setParameters({color:e}))}};var LE;N7.elevationModeChangeTypes={definedChanged:Fr.RECREATE,staysOnTheGround:Fr.NONE,onTheGroundChanged:Fr.RECREATE},function(i){i[i.DRAPED=0]="DRAPED",i[i.ELEVATED=1]="ELEVATED"}(LE||(LE={}));let V7=class extends _n{get _stippleEnabled(){return this.configuration.stippleEnabled&&this.configuration.output!==Re.Highlight}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,V7.shader.get().build(this.configuration),Mn)}initializePipeline(){const e=this.configuration,t=Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),n=(r,s=null,a=null)=>yi({blending:s,depthTest:ZB,depthWrite:a,colorWrite:$i,stencilWrite:e.hasOccludees?Gm:null,stencilTest:e.hasOccludees?r?ib:Ab:null});return e.output===Re.Color?(this._occludeePipelineState=n(!0,e.transparent||this._stippleEnabled?t:null,Lu),n(!1,e.transparent||this._stippleEnabled?t:null,Lu)):n(!1)}get primitiveType(){return Qi.LINES}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};V7.shader=new bn(Ewe,()=>Ee(()=>import("./NativeLine.glsl-f955fa9d.js"),["./NativeLine.glsl-f955fa9d.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./vec3-a020a6f6.js","./mat3f64-c6305894.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./vec4f64-e407da96.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./LineStipple.glsl-de782d6a.js","./RgbaFloatEncoding.glsl-6036ca34.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./Float4PassUniform-3a47b7b3.js","./FloatPassUniform-d2dfc562.js","./floatRGBA-fa8308d2.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./NativeLine.glsl-cdbbf172.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./VertexColor.glsl-db21b96c.js","./OutputHighlight.glsl-7364b03b.js","./AlphaCutoff-96178e0d.js"],import.meta.url));let nu=class extends yf{constructor(){super(...arguments),this.output=Re.Color,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.draped=!1,this.stippleEnabled=!1,this.stippleOffColorEnabled=!1,this.stipplePreferContinuous=!0,this.hasOccludees=!1}};f([Pe({count:Re.COUNT})],nu.prototype,"output",void 0),f([Pe()],nu.prototype,"hasSlicePlane",void 0),f([Pe()],nu.prototype,"hasVertexColors",void 0),f([Pe()],nu.prototype,"transparent",void 0),f([Pe()],nu.prototype,"draped",void 0),f([Pe()],nu.prototype,"stippleEnabled",void 0),f([Pe()],nu.prototype,"stippleOffColorEnabled",void 0),f([Pe()],nu.prototype,"stipplePreferContinuous",void 0),f([Pe()],nu.prototype,"hasOccludees",void 0),f([Pe({constValue:!1})],nu.prototype,"stippleRequiresClamp",void 0),f([Pe({constValue:!1})],nu.prototype,"stippleScaleWithLineWidth",void 0),f([Pe({constValue:!1})],nu.prototype,"stippleRequiresStretchMeasure",void 0);var oL;(function(i){i[i.START=0]="START",i[i.END=1]="END"})(oL||(oL={}));let RQ=class extends ug{constructor(e){super(e,new rpt),this._configuration=new nu}getConfiguration(e,t){this._configuration.output=e,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.transparent=this.parameters.color[3]<1||this.parameters.width<1,this._configuration.draped=t.slot===at.DRAPED_MATERIAL;const n=T(this.parameters.stipplePattern);return this._configuration.stippleEnabled=n,this._configuration.stippleOffColorEnabled=n&&T(this.parameters.stippleOffColor),this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.stipplePreferContinuous=this.parameters.stipplePreferContinuous,this._configuration}intersect(e,t,n,r,s,a,o,l,c){T(c)?Tbe(e,r,c,a,1,o):this._intersectLineGeometry(e,t,n,r,o)}_intersectLineGeometry(e,t,n,r,s){if(!r.options.selectionMode||ZL(t))return;if(!Yne(n))return void tt.getLogger("esri.views.3d.webgl-engine.materials.NativeLineMaterial").error("intersection assumes a translation-only matrix");const a=e.vertexAttributes.get(j.POSITION).data,o=r.camera,l=apt;Zs(l,r.point);const c=2;je(GT[0],l[0]-c,l[1]+c,0),je(GT[1],l[0]+c,l[1]+c,0),je(GT[2],l[0]+c,l[1]-c,0),je(GT[3],l[0]-c,l[1]-c,0);for(let m=0;m<4;m++)if(!o.unprojectFromRenderScreen(GT[m],Df[m]))return;Dp(o.eye,Df[0],Df[1],d4),Dp(o.eye,Df[1],Df[2],h4),Dp(o.eye,Df[2],Df[3],p4),Dp(o.eye,Df[3],Df[0],f4);let u=Number.MAX_VALUE,d=0;for(let m=0;m<a.length-5;m+=3){if(Zo[0]=a[m]+n[12],Zo[1]=a[m+1]+n[13],Zo[2]=a[m+2]+n[14],Qo[0]=a[m+3]+n[12],Qo[1]=a[m+4]+n[13],Qo[2]=a[m+5]+n[14],tr(d4,Zo)<0&&tr(d4,Qo)<0||tr(h4,Zo)<0&&tr(h4,Qo)<0||tr(p4,Zo)<0&&tr(p4,Qo)<0||tr(f4,Zo)<0&&tr(f4,Qo)<0)continue;if(o.projectToRenderScreen(Zo,d_),o.projectToRenderScreen(Qo,h_),d_[2]<0&&h_[2]>0){nt(Xh,Zo,Qo);const _=o.frustum,b=-tr(_[Jr.NEAR],Zo)/dt(Xh,ro(_[Jr.NEAR]));Ye(Xh,Xh,b),rt(Zo,Zo,Xh),o.projectToRenderScreen(Zo,d_)}else if(d_[2]>0&&h_[2]<0){nt(Xh,Qo,Zo);const _=o.frustum,b=-tr(_[Jr.NEAR],Qo)/dt(Xh,ro(_[Jr.NEAR]));Ye(Xh,Xh,b),rt(Qo,Qo,Xh),o.projectToRenderScreen(Qo,h_)}else if(d_[2]<0&&h_[2]<0)continue;d_[2]=0,h_[2]=0;const g=kB(D0(d_,h_,LQ),l);g<u&&(u=g,Ge(IQ,Zo),Ge($Q,Qo),d=m/3)}const h=r.rayBegin,p=r.rayEnd;if(u<c*c){let m=Number.MAX_VALUE;if(mne(D0(IQ,$Q,LQ),D0(h,p,spt),u_)){nt(u_,u_,h);const g=Et(u_);Ye(u_,u_,1/g),m=g/Gn(h,p)}s(m,u_,d,!1)}}computeAttachmentOrigin(e,t){const n=e.vertexAttributes;if(!n)return!1;const r=n.get(j.POSITION);return QB(r,null,!1,t)}requiresSlot(e,t){return!(t!==Re.Color&&t!==Re.Highlight&&t!==Re.ObjectAndLayerIdColor||e!==at.OPAQUE_MATERIAL&&e!==at.DRAPED_MATERIAL)}createGLMaterial(e){return new ipt(e)}createBufferWriter(){const e=this.parameters.hasVertexColors?bfe:Adt;return B(this.parameters.stipplePattern)?new _D(e):new npt(e.clone().vec3f(j.AUXPOS1).vec2f(j.UV0))}},ipt=class extends Sb{constructor(){super(...arguments),this._stipplePattern=null}dispose(){super.dispose(),this._stippleTextureRepository.release(this._stipplePattern),this._stipplePattern=null}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){this._output===Re.Color&&this._updateOccludeeState(e);const t=this._material.parameters.stipplePattern;return this._stipplePattern!==t&&(this._material.setParameters(this._stippleTextureRepository.swap(this._stipplePattern,t)),this._stipplePattern=t),this.ensureTechnique(V7,e)}},npt=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(j.POSITION).length}write(e,t,n,r,s){ez(n,this.vertexBufferLayout,e,t,r,s),this._writeAuxpos1(e,n,r,s),this._writeUV0(e,n,r,s)}_writeAuxpos1(e,t,n,r){const s=n.getField(j.AUXPOS1,xy),a=t.indices.get(j.POSITION),o=t.vertexAttributes.get(j.POSITION).data,l=e,c=s.typedBufferStride,u=s.typedBuffer;r*=c;for(let d=0;d<a.length-1;d+=2)for(const h of[1,0]){const p=3*a[d+h],m=o[p],g=o[p+1],_=o[p+2],b=l[0]*m+l[4]*g+l[8]*_+l[12],x=l[1]*m+l[5]*g+l[9]*_+l[13],w=l[2]*m+l[6]*g+l[10]*_+l[14];u[r]=b,u[r+1]=x,u[r+2]=w,r+=c}}_writeUV0(e,t,n,r){var w;const s=n.getField(j.UV0,nre),a=t.indices.get(j.POSITION),o=t.vertexAttributes.get(j.POSITION).data,l=(w=t.vertexAttributes.get(j.DISTANCETOSTART))==null?void 0:w.data,c=s.typedBufferStride,u=s.typedBuffer;let d=0;u[r*=c]=oL.START,u[r+1]=d,r+=c;const h=3*a[0],p=je(Zo,o[h],o[h+1],o[h+2]);e&&$t(p,p,e);const m=Qo,g=a.length-1;let _=1;const b=l?(C,S,E)=>d=l[E]:(C,S,E)=>d+=Gn(C,S);for(let C=1;C<g;C+=2){const S=3*a[C];je(m,o[S],o[S+1],o[S+2]),e&&$t(m,m,e),b(p,m,_++);for(let E=0;E<2;++E)u[r]=1-E,u[r+1]=d,r+=c;Ge(p,m)}const x=3*a[g];je(m,o[x],o[x+1],o[x+2]),e&&$t(m,m,e),b(p,m,_),u[r]=oL.END,u[r+1]=d}},rpt=class extends YA{constructor(){super(...arguments),this.color=oh,this.hasVertexColors=!1,this.hasSlicePlane=!1,this.width=1,this.stipplePreferContinuous=!0,this.hasOccludees=!1,this.stippleTexture=null}};const Zo=q(),Qo=q(),Xh=q(),u_=q(),d_=pa(),h_=pa(),IQ=q(),$Q=q(),LQ=$C(),spt=$C(),apt=q(),GT=[pa(),pa(),pa(),pa()],Df=[q(),q(),q(),q()],d4=Dr(),h4=Dr(),p4=Dr(),f4=Dr(),opt=["mesh"];let lpt=class extends xf{constructor(e,t,n,r){super(e,t,n,r),this._materials=new Map,this._textures=new Map,this.ensureDrapedStatus(!1)}async doLoad(){cn.DRAW_MESH_GEOMETRY_NORMALS&&(this._debugVertexNormalMaterial=new RQ({color:[1,0,1,1]}),this._debugFaceNormalMaterial=new RQ({color:[0,1,1,1]}))}destroy(){super.destroy(),this._context.stage.removeMany(Array.from(this._materials.values(),e=>e.material)),this._context.stage.removeMany(Array.from(this._textures.values())),this._materials.clear(),this._textures.clear()}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,opt,"fill on mesh-3d"))return null;const n=this.setGraphicElevationContext(t,new Dd),r=e.renderingInfo;return this._createAs3DShape(t,r,n,t.uid)}layerOpacityChanged(e,t){const n=this._getLayerOpacity();this._materials.forEach(r=>{r.material.setParameters({layerOpacity:n});const s=r.material.parameters;this._setMaterialTransparentParameter(s,r),r.material.setParameters({transparent:s.transparent})}),e.forEach(r=>{const s=t(r);T(s)&&s.layerOpacityChanged(n,this._context.isAsync)})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Iy)}slicePlaneEnabledChanged(e,t){return this._materials.forEach(n=>{n.material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),e.forEach(n=>{const r=t(n);T(r)&&r.slicePlaneEnabledChanged(this._context.slicePlaneEnabled,this._context.isAsync)}),!0}physicalBasedRenderingChanged(){const e=this._usePBR();return this._materials.forEach(t=>t.material.setParameters({usePBR:e})),!0}pixelRatioChanged(){return!0}_requiresSymbolVertexColors(){return this._drivenProperties.color||this._drivenProperties.opacity}_colorOrTextureUid(e){return B(e)?"-":e instanceof Xt?e.toHex():e.contentHash}_materialPropertiesDefault(e,t){const n=this._requiresSymbolVertexColors(),r=!!e.vertexAttributes.color,s=!!e.vertexAttributes.tangent;return{hasSymbolVertexColors:n,hasVertexColors:r,hasVertexTangents:s,uid:`vc:${r},vt:${s},vct${t},svc:${n}`}}_materialProperties(e,t,n){const r=this._materialPropertiesDefault(e,n);if(!t.material)return r;const{color:s,colorTexture:a,normalTexture:o,doubleSided:l,alphaCutoff:c,alphaMode:u}=t.material,d=this._colorOrTextureUid(s),h=this._colorOrTextureUid(a),p=this._colorOrTextureUid(o);if(r.color=s,r.colorTexture=a,r.normalTexture=o,r.uid=`${r.uid},cmuid:${d},ctmuid:${h},ntmuid:${p},ds:${l},ac:${c},am:${u}`,t.material instanceof nwe){const{metallic:m,roughness:g,metallicRoughnessTexture:_,emissiveColor:b,emissiveTexture:x,occlusionTexture:w}=t.material,C=this._colorOrTextureUid(_),S=this._colorOrTextureUid(b),E=this._colorOrTextureUid(x),A=this._colorOrTextureUid(w);r.metallic=m,r.roughness=g,r.metallicRoughnessTexture=_,r.emissiveColor=b,r.emissiveTexture=x,r.occlusionTexture=w,r.colorTextureTransform=t.material.colorTextureTransform,r.normalTextureTransform=t.material.normalTextureTransform,r.emissiveTextureTransform=t.material.emissiveTextureTransform,r.occlusionTextureTransform=t.material.occlusionTextureTransform,r.metallicRoughnessTextureTransform=t.material.metallicRoughnessTextureTransform,r.uid=`${r.uid},mrm:${m},mrr:${g},mrt:${C},emuid:${S},etmuid:${E},otmuid:${A}`}return r}_setInternalColorValueParameters(e,t){t.diffuse=Xt.toUnitRGB(e),t.opacity=e.a}_getLoadableTextureResource(e){return e.data?e.data:e.url}_getInternalTextureId(e){const t=this._getInternalTexture(e,vu.Opaque);return T(t)?t.id:null}_getInternalTexture(e,t){const n=this._getLoadableTextureResource(e);if(!n)return null;const r=`${e.contentHash}/${t}`;let s=this._textures.get(r);return s||(s=new i3(n,{mipmap:!0,wrap:this._castTextureWrap(e.wrap),noUnpackFlip:!0,preMultiplyAlpha:t!==vu.Opaque}),this._textures.set(r,s),this._context.stage.add(s),this._context.stage.loadImmediate(s)),s}_castTextureWrap(e="repeat"){if(typeof e=="string"){const t=this._castTextureWrapIndividual(e);return{s:t,t}}return{s:this._castTextureWrapIndividual(e.horizontal),t:this._castTextureWrapIndividual(e.vertical)}}_castTextureWrapIndividual(e){switch(e){case"clamp":return An.CLAMP_TO_EDGE;case"mirror":return An.MIRRORED_REPEAT;default:return An.REPEAT}}_setInternalMaterialParameters(e,t){if(T(e.color)&&this._setInternalColorValueParameters(e.color,t),T(e.colorTexture)){const n=this._getInternalTexture(e.colorTexture,t.textureAlphaMode);T(n)?(t.textureId=n.id,t.textureAlphaPremultiplied=!!n.params.preMultiplyAlpha):t.textureId=void 0}T(e.normalTexture)&&(t.normalTextureId=this._getInternalTextureId(e.normalTexture)),T(e.emissiveColor)&&(t.emissiveFactor=Xt.toUnitRGB(e.emissiveColor)),T(e.emissiveTexture)&&(t.emissiveTextureId=this._getInternalTextureId(e.emissiveTexture)),T(e.occlusionTexture)&&(t.occlusionTextureId=this._getInternalTextureId(e.occlusionTexture)),T(e.metallicRoughnessTexture)&&(t.metallicRoughnessTextureId=this._getInternalTextureId(e.metallicRoughnessTexture)),t.colorTextureTransformMatrix=uT(e.colorTextureTransform),t.normalTextureTransformMatrix=uT(e.normalTextureTransform),t.occlusionTextureTransformMatrix=uT(e.occlusionTextureTransform),t.emissiveTextureTransformMatrix=uT(e.emissiveTextureTransform),t.metallicRoughnessTextureTransformMatrix=uT(e.metallicRoughnessTextureTransform)}_setExternalMaterialParameters(e){const t=this._drivenProperties.color;let n=T(this.symbolLayer.material)?this.symbolLayer.material.colorMixMode:null;if(t)e.externalColor=oh;else{const r=T(this.symbolLayer.material)?this.symbolLayer.material.color:null;T(r)?e.externalColor=Xt.toUnitRGBA(r):(n=null,e.externalColor=oh)}n&&(e.colorMixMode=n),e.castShadows=!!this.symbolLayer.castShadows}_hasTransparentVertexColors(e){const t=e.vertexAttributes.color;if(B(t))return!1;for(let n=3;n<t.length;n+=4)if(t[n]!==255)return!0;return!1}_getOrCreateMaterial(e,t){var m,g,_;const n=(m=t.material)==null?void 0:m.color,r=(g=t.material)==null?void 0:g.colorTexture,s=(_=t.material)==null?void 0:_.alphaMode,a=s==="blend",o=s!=="opaque"&&(this._hasTransparentVertexColors(e)||T(n)&&n.a<1||T(r)&&r.transparent||a),l=this._materialProperties(e,t,o),c=this._materials.get(l.uid);if(c)return c.material;const u={material:null,isComponentTransparent:o,alphaMode:t.material?t.material.alphaMode:"opaque"},d=l.metallicRoughnessTexture==null&&l.metallic==null&&l.roughness==null,h={usePBR:this._usePBR(),isSchematic:d,hasVertexColors:l.hasVertexColors,hasSymbolColors:l.hasSymbolVertexColors,hasVertexTangents:l.hasVertexTangents,ambient:wd,diffuse:Zv,opacity:1,doubleSided:!0,doubleSidedType:"winding-order",cullFace:qs.None,layerOpacity:this._getLayerOpacity(),hasSlicePlane:this._context.slicePlaneEnabled,initTextureTransparent:!0};d||(h.mrrFactors=[l.metallic!=null?l.metallic:1,l.roughness!=null?l.roughness:1,.5]),t.material&&(h.doubleSided=t.material.doubleSided,h.cullFace=t.material.doubleSided?qs.None:qs.Back,h.textureAlphaCutoff=t.material.alphaCutoff),this._setExternalMaterialParameters(h),this._setMaterialTransparentParameter(h,u),this._setInternalMaterialParameters(l,h);const p=new v2(h);return u.material=p,this._materials.set(l.uid,u),this._context.stage.add(p),p}_usePBR(){return this._context.physicalBasedRenderingEnabled}_setMaterialTransparentParameter(e,t){e.transparent=this.needsDrivenTransparentPass||t.isComponentTransparent||e.layerOpacity<1||e.opacity<1||e.externalColor&&e.externalColor[3]<1,t.alphaMode==="auto"?e.textureAlphaMode=e.transparent?vu.MaskBlend:vu.Opaque:e.textureAlphaMode=t.alphaMode==="opaque"?vu.Opaque:t.alphaMode==="mask"?vu.Mask:vu.Blend}_addDebugNormals(e,t,n,r){const s=t.length,a=e.spatialReference.isGeographic?20015077/180:1,o=.1*Math.max(e.extent.width*a,e.extent.height*a,e.extent.zmax-e.extent.zmin),l=[],c=[],u=[],d=[];for(let m=0;m<s;m++){const g=t[m],_=g.vertexAttributes.get(j.POSITION),b=g.vertexAttributes.get(j.NORMAL),x=g.indices.get(j.POSITION),w=g.indices.get(j.NORMAL),C=_.data,S=b.data;for(let E=0;E<x.length;E++){const A=3*x[E],P=3*w[E];for(let O=0;O<3;O++)l.push(C[A+O]);for(let O=0;O<3;O++)l.push(C[A+O]+S[P+O]*o);if(c.push(c.length),c.push(c.length),E%3==0){this._calculateFaceNormal(C,x,E,E1),this._getFaceVertices(C,x,E,Ua,T1,S1),rt(Ua,Ua,T1),rt(Ua,Ua,S1),Ye(Ua,Ua,1/3);for(let O=0;O<3;O++)u.push(Ua[O]);for(let O=0;O<3;O++)u.push(Ua[O]+E1[O]*o);d.push(d.length),d.push(d.length)}}}const h=new Bs([[j.POSITION,{data:l,size:3,exclusive:!0}]],[[j.POSITION,c]],xh.Line);t.push(h),n.push(this._debugVertexNormalMaterial),r.push(iR(r[0]));const p=new Bs([[j.POSITION,{data:u,size:3,exclusive:!0}]],[[j.POSITION,d]],xh.Line);t.push(p),n.push(this._debugFaceNormalMaterial),r.push(iR(r[0]))}_createAs3DShape(e,t,n,r){const s=e.geometry;if(s.type!=="mesh")return null;const a=this._createGeometryInfo(s,t,r);if(!a)return null;const{geometries:o,materials:l,transformations:c,objectTransformation:u}=a;cn.DRAW_MESH_GEOMETRY_NORMALS&&this._addDebugNormals(s,o,l,c);const d=new xg({geometries:o,materials:l,transformations:c,metadata:{layerUid:this._context.layer.uid,graphicUid:r}});d.transformation=u;const h=this._createEdgeMaterial(),p=T(h)?{baseMaterial:l[0],edgeMaterials:[h],properties:{mergeGeometries:!0,hasSlicePlane:this._context.slicePlaneEnabled}}:null,m=new wf(this,d,o,null,null,_A,n,p);return m.needsElevationUpdates=Iy(n.mode),m.useObjectOriginAsAttachmentOrigin=!0,m.elevationContext.centerPointInElevationSR=this._getCenterPointInElevationSR(d),m.alignedSampledElevation=_A(m,m.elevationContext,this._context.elevationProvider,this._context.renderCoordsHelper),m}_getCenterPointInElevationSR(e){const t=Id(0,0,0,T(this._context.elevationProvider.spatialReference)?this._context.elevationProvider.spatialReference:null);return Tie([e.transformation[12],e.transformation[13],e.transformation[14]],this._context.renderCoordsHelper.spatialReference,t),t}_createComponentNormals(e,t,n,r){switch(n.shading||"flat"){case"source":return this._createComponentNormalsSource(e,t,n,r);case"flat":return this._createComponentNormalsFlat(e,r);case"smooth":return this._createComponentNormalsSmooth(e,r);default:return}}_createComponentNormalsSource(e,t,n,r){if(B(t))return this._createComponentNormalsFlat(e,r);let s=!1;if(!n.trustSourceNormals)for(let a=0;a<r.length;a+=3){this._calculateFaceNormal(e,r,a,E1);for(let o=0;o<3;o++){const l=3*r[a+o];Ua[0]=t[l+0],Ua[1]=t[l+1],Ua[2]=t[l+2],dt(E1,Ua)<0&&(t[l+0]=-t[l+0],t[l+1]=-t[l+1],t[l+2]=-t[l+2],s=!0)}}return{normals:t,indices:r,didFlipNormals:s}}_createComponentNormalsFlat(e,t){const n=new Float32Array(t.length),r=new Array(3*t.length);for(let s=0;s<t.length;s+=3){const a=this._calculateFaceNormal(e,t,s,E1);for(let o=0;o<3;o++)n[s+o]=a[o],r[s+o]=s/3}return{normals:n,indices:r,didFlipNormals:!1}}_createComponentNormalsSmooth(e,t){const n={};for(let a=0;a<t.length;a+=3){const o=this._calculateFaceNormal(e,t,a,E1);for(let l=0;l<3;l++){const c=t[a+l];let u=n[c];u||(u={normal:q(),count:0},n[c]=u),rt(u.normal,u.normal,o),u.count++}}const r=new Float32Array(3*t.length),s=new Array(3*t.length);for(let a=0;a<t.length;a++){const o=n[t[a]];o.count!==1&&(mt(o.normal,o.normal),o.count=1);for(let l=0;l<3;l++)r[3*a+l]=o.normal[l];s[a]=a}return{normals:r,indices:s,didFlipNormals:!1}}_getFaceVertices(e,t,n,r,s,a){const o=3*t[n+0],l=3*t[n+1],c=3*t[n+2];r[0]=e[o+0],r[1]=e[o+1],r[2]=e[o+2],s[0]=e[l+0],s[1]=e[l+1],s[2]=e[l+2],a[0]=e[c+0],a[1]=e[c+1],a[2]=e[c+2]}_calculateFaceNormal(e,t,n,r){return this._getFaceVertices(e,t,n,Ua,T1,S1),nt(T1,T1,Ua),nt(S1,S1,Ua),vi(Ua,T1,S1),mt(r,Ua),r}_getOrCreateComponents(e){return Jt(e.components,cpt)}_createPositionBuffer(e,t){let n=e.vertexAttributes.position;const r=t.reprojection===cu.ECEF?t.transformBeforeProject:null;if(T(r)&&(n=b1e(n,new Float64Array(n.length),r)),t.reprojection===cu.NONE)return t.needsBufferCopy?new Float64Array(n):n;const s=T(r)?n:new Float64Array(n.length);return Kl(n,e.spatialReference,0,s,this._context.renderCoordsHelper.spatialReference,0,n.length/3),s}_createNormalBuffer(e,t,n){let r=e.vertexAttributes.normal;if(B(r))return null;const s=n.reprojection===cu.ECEF?n.transformBeforeProject:null;if(T(s)&&(r=w1e(r,new Float32Array(r.length),s)),this._context.graphicsCoreOwner.view.viewingMode==="local"||n.reprojection===cu.NONE)return n.needsBufferCopy&&e.vertexAttributes.normal===r?new Float32Array(r):r;const a=e.vertexAttributes.position,o=T(s)?r:new Float32Array(r.length);return x1e(r,a,t,e.spatialReference,o)}_createTangentBuffer(e,t,n){let r=e.vertexAttributes.tangent;if(B(r))return null;const s=n.reprojection===cu.ECEF?n.transformBeforeProject:null;if(T(s)&&(r=C1e(r,new Float32Array(r.length),s)),this._context.graphicsCoreOwner.view.viewingMode==="local"||n.reprojection===cu.NONE)return n.needsBufferCopy&&e.vertexAttributes.normal===r?new Float32Array(r):r;const a=e.vertexAttributes.position,o=T(s)?r:new Float32Array(r.length);return T1e(r,a,t,e.spatialReference,o)}_createColorBuffer(e){return e.vertexAttributes.color}_createSymbolColorBuffer(e){if(this._requiresSymbolVertexColors()){const t=this._getVertexOpacityAndColor(e),n=Swe(ms(this.symbolLayer,"material","colorMixMode")),r=new Uint8Array(4);return hre(t,n,r),r}return null}_createBuffers(e,t){const n=e.vertexAttributes&&e.vertexAttributes.position;if(!n)return this.logger.warn("Mesh geometry must contain position vertex attributes"),null;const r=e.vertexAttributes.normal,s=e.vertexAttributes.uv,a=e.vertexAttributes.tangent;if(T(r)&&r.length!==n.length)return this.logger.warn("Mesh normal vertex buffer must contain the same number of elements as the position buffer"),null;if(T(a)&&a.length/4!=n.length/3)return this.logger.warn("Mesh tangent vertex buffer must contain the same number of elements as the position buffer"),null;if(T(s)&&s.length/2!=n.length/3)return this.logger.warn("Mesh uv vertex buffer must contain the same number of elements as the position buffer"),null;const o=this._computeReprojectionInfo(e),l=this._createPositionBuffer(e,o),c=this._createColorBuffer(e),u=this._createSymbolColorBuffer(t),d=this._createNormalBuffer(e,l,o),h=this._createTangentBuffer(e,l,o);return{positionBuffer:l,normalBuffer:d,tangentBuffer:h,uvBuffer:s,colorBuffer:c,symbolColorBuffer:u,objectTransformation:o.reprojection===cu.NONE&&T(o.objectTransformation)?o.objectTransformation:this._transformOriginLocal(e,l,d,h),geometryTransformation:o.reprojection===cu.NONE&&T(o.geometryTransformation)?o.geometryTransformation:St()}}_computeReprojectionInfo(e){const t=T(e.transform),n=t&&e.transform.geographic||this._context.renderCoordsHelper.viewingMode===Ot.Local?cu.NONE:cu.ECEF;if(t){if(n===cu.NONE){const s=St();return zm(e.spatialReference,e.transform.origin,s,this._context.renderCoordsHelper.spatialReference),{reprojection:n,objectTransformation:s,geometryTransformation:iR(e.transform.localMatrix),needsBufferCopy:!1}}const r=dne(St(),e.transform.origin);return Vs(r,r,e.transform.localMatrix),{reprojection:n,transformBeforeProject:r,needsBufferCopy:!0}}return{reprojection:n,needsBufferCopy:!0}}_transformOriginLocal(e,t,n,r){const s=this._context.renderCoordsHelper.spatialReference,a=e.anchor;QP[0]=a.x,QP[1]=a.y,QP[2]=a.z;const o=St();zm(e.spatialReference,QP,o,s);const l=wy.fromTypedArray(t);if(Da(DQ,o),are(l,l,DQ),T(n)||T(r)){if(Um(WT,o),cg(WT,WT),T(n)){const c=xy.fromTypedArray(n);e$(c,c,WT)}if(T(r)){const c=xy.fromTypedArray(r,4*r.BYTES_PER_ELEMENT);e$(c,c,WT)}}return o}_validateFaces(e,t){const n=e.vertexAttributes.position.length/3,r=t.faces;if(r){let s=-1;for(let a=0;a<r.length;a++){const o=r[a];o>s&&(s=o)}if(n<=s)return this.logger.warn(`Vertex index ${s} is out of bounds of the mesh position buffer`),!1}else if(n%3!=0)return this.logger.warn("Mesh position buffer length must be a multiple of 9 if no component faces are defined (3 values per vertex * 3 vertices per triangle)"),!1;return!0}_getOrCreateFaces(e,t){return t.faces?t.faces:nz(e.vertexAttributes.position.length/3)}_isOutsideClippingArea(e){if(!this._context.clippingExtent)return!1;const t=e.vertexAttributes&&e.vertexAttributes.position;if(!t)return!1;const n=this._context.elevationProvider.spatialReference;let r;const s=t.length/3;return T(n)&&!e.spatialReference.equals(n)?(r=new Float64Array(t.length),Kl(e.vertexAttributes.position,e.spatialReference,0,r,n,0,s)):r=t,fr(m4),Au(m4,r,0,s),!fh(m4,this._context.clippingExtent)}_createGeometryInfo(e,t,n){if(!$y(e.spatialReference,this._context.graphicsCoreOwner.view.spatialReference))return this.logger.warn("Geometry spatial reference is not compatible with the view"),null;if(this._isOutsideClippingArea(e))return null;const r=this._createBuffers(e,t);if(B(r))return null;const{positionBuffer:s,uvBuffer:a,colorBuffer:o,symbolColorBuffer:l,normalBuffer:c,tangentBuffer:u,objectTransformation:d,geometryTransformation:h}=r,p=this._getOrCreateComponents(e),m=[],g=[],_=[];let b=!1;for(const x of p){if(!this._validateFaces(e,x))return null;const w=this._getOrCreateFaces(e,x);if(w.length===0)continue;const C=this._createComponentNormals(s,c,x,w);C.didFlipNormals&&(b=!0);const S=[[j.POSITION,{size:3,data:s,exclusive:!0}],[j.NORMAL,{size:3,data:C.normals,exclusive:!0}]],E=[[j.POSITION,w],[j.NORMAL,C.indices]];T(o)&&(S.push([j.COLOR,{size:4,data:o,exclusive:!0}]),E.push([j.COLOR,w])),T(l)&&(S.push([j.SYMBOLCOLOR,{size:4,data:l,exclusive:!0}]),E.push([j.SYMBOLCOLOR,new Array(w.length).fill(0)])),T(a)&&(S.push([j.UV0,{size:2,data:a,exclusive:!0}]),E.push([j.UV0,w])),T(u)&&(S.push([j.TANGENT,{size:4,data:u,exclusive:!0}]),E.push([j.TANGENT,w]));const A=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:n,layerUid:this._context.layer.uid}),P=new Bs(S,E,xh.Triangle,A);m.push(P),g.push(h),_.push(this._getOrCreateMaterial(e,x))}return b&&this.logger.warn("Normals have been automatically flipped to be consistent with the counter clock wise face winding order. It is better to generate mesh geometries that have consistent normals."),{geometries:m,transformations:g,materials:_,objectTransformation:d}}_createEdgeMaterial(){const e={opacity:this._getLayerOpacity()};return sre(this.symbolLayer,e)}};const QP=q(),Ua=q(),T1=q(),S1=q(),E1=q(),DQ=St(),WT=Ho(),m4=Go(),cpt=[new iwe];var cu;(function(i){i[i.NONE=0]="NONE",i[i.ECEF=1]="ECEF"})(cu||(cu={}));let upt=class{constructor(e,t,n,r){this.graphics3DSymbolLayer=e,this.instanceIndex=t,this.elevationAligner=n,this.elevationContext=r,this.type="lod-instance",this._highlights=new Set,this.alignedSampledElevation=0,this.isElevationSource=!1,this.needsElevationUpdates=!1}initialize(){}setVisibility(e){const t=this._lodRenderer.instanceData;e!==t.getVisible(this.instanceIndex)&&t.setVisible(this.instanceIndex,e)}destroy(){this.instanceIndex!=null&&(this._lodRenderer.instanceData.removeInstance(this.instanceIndex),this.graphics3DSymbolLayer.notifyDestroyGraphicLayer(this))}alignWithElevation(e,t,n){if(this.elevationAligner){b7(this.elevationContext.featureExpressionInfoContext,n);const r=this.elevationAligner(this,this.elevationContext,e,t);T(r)&&(this.alignedSampledElevation=r)}}getCenterObjectSpace(e=q()){return this._lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,Zh),$t(e,this._lodRenderer.baseBoundingSphere.center,Zh)}getBoundingBoxObjectSpace(e=Go()){this._lodRenderer.instanceData.getCombinedLocalTransform(this.instanceIndex,Zh);const t=this._lodRenderer.baseBoundingBox;fr(e);for(let n=0;n<8;++n)je(zu,1&n?t[3]:t[0],2&n?t[4]:t[1],4&n?t[5]:t[2]),$t(zu,zu,Zh),Wx(e,zu);return e}computeAttachmentOrigin(e){this._lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,Zh),e.render.origin[0]+=Zh[12],e.render.origin[1]+=Zh[13],e.render.origin[2]+=Zh[14],e.render.num++}async getProjectedBoundingBox(e,t,n,r,s){const a=this.getBoundingBoxObjectSpace(s),o=dpt,l=rz(a)?1:o.length;this._lodRenderer.instanceData.getGlobalTransform(this.instanceIndex,Zh);for(let u=0;u<l;u++){const d=o[u];zu[0]=a[d[0]],zu[1]=a[d[1]],zu[2]=a[d[2]],$t(zu,zu,Zh),p_[3*u+0]=zu[0],p_[3*u+1]=zu[1],p_[3*u+2]=zu[2]}if(!e(p_,0,l))return null;fr(a);let c=null;this.calculateRelativeScreenBounds&&(c=this.calculateRelativeScreenBounds());for(let u=0;u<3*l;u+=3){for(let d=0;d<3;d++)a[d]=Math.min(a[d],p_[u+d]),a[d+3]=Math.max(a[d+3],p_[u+d]);c&&n.push({location:p_.slice(u,u+3),screenSpaceBoundingRect:c})}if(t&&(ph(a,g4),this.elevationContext.mode!=="absolute-height")){let u;const d=y7(a,t.service.spatialReference,t);try{u=await t.service.queryElevation(g4[0],g4[1],r,d,"ground")}catch{}T(u)&&tre(a,0,0,-this.alignedSampledElevation+u)}return a}addObjectState(e,t){if(e===nb.Highlight){const n=new iL(e);this._addHighlightId(n),t.addExternal(r=>{this._removeHighlightId(r)},n)}}removeObjectState(e){this._highlights.forEach(t=>e.remove(t))}_addHighlightId(e){this._highlights.add(e),this._lodRenderer.instanceData.setHighlight(this.instanceIndex,!0)}_removeHighlightId(e){this._highlights.delete(e),this._lodRenderer.instanceData.setHighlight(this.instanceIndex,this._highlights.size>0)}get _lodRenderer(){return this.graphics3DSymbolLayer.lodRenderer}};const p_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],zu=q(),g4=q(),dpt=[[0,1,2],[3,1,2],[0,4,2],[3,4,2],[0,1,5],[3,1,5],[0,4,5],[3,4,5]],Zh=St();function hpt(i){const e=[];return i.stageResources.geometries.forEach((t,n)=>{const r=i.stageResources.materials[n],s=i.stageResources.textures;e.push({material:r,geometry:t,textures:s})}),{components:e,minScreenSpaceRadius:T(i.lodThreshold)?i.lodThreshold:0,pivotOffset:i.pivotOffset}}function ppt(i){return{levels:i.map(e=>hpt(e))}}function fpt(i,e=gpt){const t=$ut(i);return Math.sqrt(t/(e*Math.PI))}function mpt(i){i.levels.forEach(e=>{e.minScreenSpaceRadius||(e.minScreenSpaceRadius=fpt(e))})}const gpt=.05;var er;function vpt(i){let e=Js().mat4f64(j.LOCALTRANSFORM).mat4f64(j.GLOBALTRANSFORM).vec4f64(j.BOUNDINGSPHERE).vec3f64(j.MODELORIGIN).mat3f(j.MODEL).mat3f(j.MODELNORMAL).vec2f(j.MODELSCALEFACTORS);return i.includes("color")&&(e=e.vec4f(j.COLOR)),i.includes("featureAttribute")&&(e=e.vec4f(j.FEATUREATTRIBUTE)),e=e.u8(j.STATE).u8(j.LODLEVEL),i.includes(j.OBJECTANDLAYERIDCOLOR)&&(e=e.vec4u8(j.OBJECTANDLAYERIDCOLOR)),e.alignTo(8),e}(function(i){i[i.ALLOCATED=1]="ALLOCATED",i[i.DEFAULT_ACTIVE=2]="DEFAULT_ACTIVE",i[i.VISIBLE=4]="VISIBLE",i[i.HIGHLIGHT=8]="HIGHLIGHT",i[i.HIGHLIGHT_ACTIVE=16]="HIGHLIGHT_ACTIVE",i[i.REMOVE=32]="REMOVE",i[i.TRANSFORM_CHANGED=64]="TRANSFORM_CHANGED",i[i.ACTIVE=18]="ACTIVE"})(er||(er={}));let ypt=class{constructor(e){this.localTransform=e.getField(j.LOCALTRANSFORM,dW),this.globalTransform=e.getField(j.GLOBALTRANSFORM,dW),this.modelOrigin=e.getField(j.MODELORIGIN,wy),this.model=e.getField(j.MODEL,b2),this.modelNormal=e.getField(j.MODELNORMAL,b2),this.modelScaleFactors=e.getField(j.MODELSCALEFACTORS,nre),this.boundingSphere=e.getField(j.BOUNDINGSPHERE,B1e),this.color=e.getField(j.COLOR,Wm),this.featureAttribute=e.getField(j.FEATUREATTRIBUTE,Wm),this.state=e.getField(j.STATE,hW),this.lodLevel=e.getField(j.LODLEVEL,hW),this.objectAndLayerIdColor=e.getField(j.OBJECTANDLAYERIDCOLOR,by)}},_pt=class extends Pn{constructor(e,t){super(),this._capacity=0,this._size=0,this._next=0,this._buffer=null,this._view=null,this._layout=vpt(e),this._shaderTransformation=t}get capacity(){return this._capacity}get size(){return this._size}get buffer(){return this._buffer.buffer}get view(){return this._view}addInstance(){this._size+1>this._capacity&&this._grow();const e=this._findSlot();return this._view.state.set(e,er.ALLOCATED),this._size++,this.emit("instance-added",{index:e}),e}removeInstance(e){const t=this._view.state;Ti(e>=0&&e<this._capacity&&t.get(e)&er.ALLOCATED,"invalid instance handle"),this._getStateFlag(e,er.ACTIVE)?this._setStateFlags(e,er.REMOVE):this.freeInstance(e),this.emit("instance-removed",{index:e})}freeInstance(e){const t=this._view.state;Ti(e>=0&&e<this._capacity&&t.get(e)&er.ALLOCATED,"invalid instance handle"),t.set(e,0),this._size--}setLocalTransform(e,t,n=!0){this._view.localTransform.setMat(e,t),n&&this.updateModelTransform(e)}getLocalTransform(e,t){this._view.localTransform.getMat(e,t)}setGlobalTransform(e,t,n=!0){this._view.globalTransform.setMat(e,t),n&&this.updateModelTransform(e)}getGlobalTransform(e,t){this._view.globalTransform.getMat(e,t)}updateModelTransform(e){const t=this._view,n=Gg,r=Vd;t.localTransform.getMat(e,kQ),t.globalTransform.getMat(e,v4);const s=Vs(v4,v4,kQ);je(n,s[12],s[13],s[14]),t.modelOrigin.setVec(e,n),Um(r,s),t.model.setMat(e,r);const a=H0e(Gg,s);a.sort(),t.modelScaleFactors.set(e,0,a[1]),t.modelScaleFactors.set(e,1,a[2]),IC(r,r),cg(r,r),t.modelNormal.setMat(e,r),this._setStateFlags(e,er.TRANSFORM_CHANGED),this.emit("instance-transform-changed",{index:e})}getModelTransform(e,t){const n=this._view;n.model.getMat(e,Vd),n.modelOrigin.getVec(e,Gg),t[0]=Vd[0],t[1]=Vd[1],t[2]=Vd[2],t[3]=0,t[4]=Vd[3],t[5]=Vd[4],t[6]=Vd[5],t[7]=0,t[8]=Vd[6],t[9]=Vd[7],t[10]=Vd[8],t[11]=0,t[12]=Gg[0],t[13]=Gg[1],t[14]=Gg[2],t[15]=1}applyShaderTransformation(e,t){this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t)}getCombinedModelTransform(e,t){return this.getModelTransform(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}getCombinedLocalTransform(e,t){return this._view.localTransform.getMat(e,t),this._shaderTransformation&&this._shaderTransformation.applyTransform(this,e,t),t}getCombinedMaxScaleFactor(e){let t=this._view.modelScaleFactors.get(e,1);if(this._shaderTransformation){const n=this._shaderTransformation.scaleFactor(Gg,this,e);t*=Math.max(n[0],n[1],n[2])}return t}getCombinedMedianScaleFactor(e){let t=this._view.modelScaleFactors.get(e,0);if(this._shaderTransformation){const n=this._shaderTransformation.scaleFactor(Gg,this,e);t*=bpt(n[0],n[1],n[2])}return t}getModel(e,t){this._view.model.getMat(e,t)}setFeatureAttribute(e,t){this._view.featureAttribute.setVec(e,t)}getFeatureAttribute(e,t){this._view.featureAttribute.getVec(e,t)}setColor(e,t){this._view.color.setVec(e,t)}setObjectAndLayerIdColor(e,t){this._view.objectAndLayerIdColor.setVec(e,t)}getColor(e,t){this._view.color.getVec(e,t)}setVisible(e,t){t!==this.getVisible(e)&&(this._setStateFlag(e,er.VISIBLE,t),this.emit("instance-visibility-changed",{index:e}))}getVisible(e){return this._getStateFlag(e,er.VISIBLE)}setHighlight(e,t){t!==this.getHighlight(e)&&(this._setStateFlag(e,er.HIGHLIGHT,t),this.emit("instance-highlight-changed",{index:e}))}getHighlight(e){return this._getStateFlag(e,er.HIGHLIGHT)}getState(e){return this._view.state.get(e)}getLodLevel(e){return this._view.lodLevel.get(e)}countFlags(e){let t=0;for(let n=0;n<this._capacity;++n)this.getState(n)&e&&++t;return t}_setStateFlags(e,t){const n=this._view.state;t=n.get(e)|t,n.set(e,t)}_clearStateFlags(e,t){const n=this._view.state;t=n.get(e)&~t,n.set(e,t)}_setStateFlag(e,t,n){n?this._setStateFlags(e,t):this._clearStateFlags(e,t)}_getStateFlag(e,t){return!!(this._view.state.get(e)&t)}_grow(){const e=Math.max(wpt,Math.floor(this._capacity*xpt)),t=this._layout.createBuffer(e);if(this._buffer){const n=new Uint8Array(this._buffer.buffer);new Uint8Array(t.buffer).set(n)}this._capacity=e,this._buffer=t,this._view=new ypt(this._buffer)}_findSlot(){const e=this._view.state;let t=this._next;for(;e.get(t)&er.ALLOCATED;)t=t+1===this._capacity?0:t+1;return this._next=t+1===this._capacity?0:t+1,t}};function bpt(i,e,t){return Math.max(Math.min(i,e),Math.min(Math.max(i,e),t))}const wpt=1024,xpt=2,Gg=q(),Vd=Ho(),kQ=St(),v4=St();let Cpt=class extends hh{constructor(e,t){super(n=>O0e(this._instanceData.view.boundingSphere.getVec(n,this._tmpSphere)),{maximumDepth:25}),this._tmpSphere=gf(),this._tmpMat4=St(),this._instanceData=e,this._boundingSphere=t}addInstance(e){const t=this._instanceData.view.boundingSphere,n=this._instanceData.getCombinedModelTransform(e,this._tmpMat4);$t(this._tmpSphere,this._boundingSphere.center,n),this._tmpSphere[3]=this._boundingSphere.radius*J0(n),t.setVec(e,this._tmpSphere),this.add([e])}removeInstance(e){this.remove([e])}},Tpt=class{constructor(e,t){this.thresholdScale=1,this._camera=new Nn,this._worldSpaceRadius=e,this._thresholds=t.map(n=>n)}updateCamera(e){this._camera.copyFrom(e)}selectLevel(e,t){const n=this._camera.computeScreenPixelSizeAt(e),r=this._worldSpaceRadius*t/n,s=this._thresholds;let a=-1;for(let o=0;o<s.length;++o)r>=s[o]*this.thresholdScale&&(a=o);return a}},Spt=class{constructor(e,t){const n=e.renderContext.rctx,{geometry:r,material:s}=t;this._materialRepository=e.materialRep,s.setParameters({instancedDoublePrecision:!0});const a=s.createBufferWriter(),o=a.vertexBufferLayout,l=a.elementCount(r),c=a.allocate(l);a.write(null,null,r,c,0),this.geometry=r,this.material=s,this.glMaterials=new _fe(s,this._materialRepository),this.vertexBufferLayout=o,this.vbo=In.createVertex(n,kn.STATIC_DRAW,c.buffer),this.vao=new lf(n,Mn,{geometry:Dh(o)},{geometry:this.vbo}),this.vertexCount=l}destroy(){this.glMaterials.destroy(),this.vbo.dispose(),this.vao.dispose()}get boundingInfo(){return this.geometry.boundingInfo}get triangleCount(){return this.vertexCount/3}intersect(e,t,n,r,s,a,o,l){const c=this.geometry.id;this.material.intersect(this.geometry,null,e.transform.transform,e,n,r,(u,d,h,p,m)=>{if(u>=0){if(t!=null&&!t(e.rayBegin,e.rayEnd,u))return;const g={layerUid:a.layerUid,graphicUid:a.graphicUid(s),geometryId:c,triangleNr:h,baseBoundingSphere:o,numLodLevels:l};if((e.results.min.drapedLayerOrder==null||m>=e.results.min.drapedLayerOrder)&&(e.results.min.dist==null||u<e.results.min.dist)&&e.results.min.set(Sr.LOD,g,u,d,e.transform.transform,m),e.options.store!==Fa.MIN&&(e.results.max.drapedLayerOrder==null||m>=e.results.max.drapedLayerOrder)&&(e.results.max.dist==null||u>e.results.max.dist)&&e.results.max.set(Sr.LOD,g,u,d,e.transform.transform,m),e.options.store===Fa.ALL){const _=YU(e.results.min.ray);_.set(Sr.LOD,g,u,d,e.transform.transform,m),e.results.all.push(_)}}})}},kfe=class{constructor(e,t){this.minScreenSpaceRadius=e,this.components=t}static async create(e,t,n){const r=await Promise.allSettled(t.components.map(a=>e.schedule(()=>new Spt(e,a),n))),s=r.map(a=>a.status==="fulfilled"?a.value:null).filter(a=>a);if(bu(n)||s.length!==r.length){s.forEach(a=>a.destroy()),Cn(n);for(const a of r)if(a.status==="rejected")throw a.reason}return new kfe(t.minScreenSpaceRadius,s)}destroy(){this.components.forEach(e=>e.destroy())}intersect(e,t,n,r,s,a,o){this.components.forEach(l=>l.intersect(e,t,n,r,s,a,this.boundingSphere,o))}get boundingBox(){if(B(this._boundingBox)){const e=fr();this.components.forEach(t=>{T(t.boundingInfo)&&(Wx(e,t.boundingInfo.bbMin),Wx(e,t.boundingInfo.bbMax))}),this._boundingBox=e}return this._boundingBox}get boundingSphere(){if(B(this._boundingSphere)){const e=this.boundingBox,t=q();ph(e,t),this._boundingSphere={center:t,radius:.5*ire(e)}}return this._boundingSphere}get triangleCount(){return this.components.reduce((e,t)=>e+t.triangleCount,0)}},Ept=class{constructor(e,t,n){this._elementSize=t,this._buffer=In.createVertex(e,kn.STATIC_DRAW),this.resize(n)}destroy(){this._buffer.dispose()}get elementSize(){return this._elementSize}get capacity(){return this._capacity}get array(){return this._array}get buffer(){return this._buffer}get memoryUsage(){return{cpu:this._capacity*this._elementSize,gpu:this._capacity*this._elementSize}}copyRange(e,t,n,r=0){const s=new Uint8Array(this.array,e*this.elementSize,(t-e)*this.elementSize);new Uint8Array(n.array,r*this.elementSize).set(s)}transferAll(){this._buffer.setData(this._array)}transferRange(e,t){const n=e*this._elementSize,r=t*this._elementSize;this._buffer.setSubData(new Uint8Array(this._array),n,n,r)}resize(e){const t=e*this._elementSize,n=new ArrayBuffer(t);this._array&&(e>=this._capacity?new Uint8Array(n).set(new Uint8Array(this._array)):new Uint8Array(n).set(new Uint8Array(this._array).subarray(0,e*this._elementSize))),this._array=n,this._buffer.setSize(t),this._capacity=e}},Apt=class{constructor(e){this.modelOriginHi=e.getField(j.MODELORIGINHI,xy),this.modelOriginLo=e.getField(j.MODELORIGINLO,xy),this.model=e.getField(j.MODEL,b2),this.modelNormal=e.getField(j.MODELNORMAL,b2),this.color=e.getField(j.INSTANCECOLOR,Wm),this.featureAttribute=e.getField(j.INSTANCEFEATUREATTRIBUTE,Wm),this.objectAndLayerIdColor=e.getField(j.OBJECTANDLAYERIDCOLOR_INSTANCED,by)}},FQ=class{constructor(e,t){this._headIndex=0,this._tailIndex=0,this._firstIndex=null,this._captureFirstIndex=!0,this._updating=!1,this._prevHeadIndex=0,this._resized=!1,this._rctx=e,this._instanceBufferLayout=t,this._elementSize=t.stride,this._capacity=1}destroy(){this._buffer&&this._buffer.destroy()}get buffer(){return this._buffer.buffer}get view(){return this._view}get capacity(){return this._capacity}get size(){const e=this._headIndex,t=this._tailIndex;return e>=t?e-t:e+this._capacity-t}get isEmpty(){return this._headIndex===this._tailIndex}get isFull(){return this._tailIndex===(this._headIndex+1)%this._capacity}get headIndex(){return this._headIndex}get tailIndex(){return this._tailIndex}get firstIndex(){return this._firstIndex}get memoryUsage(){return this._buffer?this._buffer.memoryUsage:{cpu:0,gpu:0}}reset(){this._headIndex=0,this._tailIndex=0,this._firstIndex=null}startUpdateCylce(){this._captureFirstIndex=!0}beginUpdate(){Ti(!this._updating,"already updating"),this._updating=!0,this._prevHeadIndex=this._headIndex}endUpdate(){Ti(this._updating,"not updating"),this.size<Ppt*this.capacity&&this._shrink(),this._resized?(this._buffer.transferAll(),this._resized=!1):this._transferRange(this._prevHeadIndex,this._headIndex),this._updating=!1}allocateHead(){Ti(this._updating,"not updating"),this.isFull&&this._grow();const e=this.headIndex;return this._captureFirstIndex&&(this._firstIndex=e,this._captureFirstIndex=!1),this._incrementHead(),Ti(this._headIndex!==this._tailIndex,"invalid pointers"),e}freeTail(){Ti(this._updating,"not updating"),Ti(this.size>0,"invalid size");const e=this._tailIndex===this._firstIndex;this._incrementTail(),e&&(this._firstIndex=this._tailIndex)}_grow(){const e=Math.max(NQ,Math.floor(this._capacity*Mpt));this._resize(e)}_shrink(){const e=Math.max(NQ,Math.floor(this._capacity*Opt));this._resize(e)}_resize(e){if(Ti(this._updating,"not updating"),e===this._capacity)return;const t=new Ept(this._rctx,this._elementSize,e);if(this._buffer){this._firstIndex&&(this._firstIndex=(this._firstIndex+this._capacity-this._tailIndex)%this._capacity);const n=this.size,r=this._compactInstances(t);Ti(r===n,"invalid compaction"),this._buffer.destroy(),this._tailIndex=0,this._headIndex=r,this._prevHeadIndex=0}this._resized=!0,this._capacity=e,this._buffer=t,this._view=new Apt(this._instanceBufferLayout.createView(this._buffer.array))}_compactInstances(e){const t=this._headIndex,n=this._tailIndex;return n<t?(this._buffer.copyRange(n,t,e),t-n):n>t?(this._buffer.copyRange(n,this._capacity,e),t>0&&this._buffer.copyRange(0,t,e,this._capacity-n),t+(this._capacity-n)):0}_incrementHead(e=1){this._headIndex=(this._headIndex+e)%this._capacity}_incrementTail(e=1){this._tailIndex=(this._tailIndex+e)%this._capacity}_transferRange(e,t){e<t?this._buffer.transferRange(e,t):e>t&&(t>0&&this._buffer.transferRange(0,t),this._buffer.transferRange(e,this._capacity))}};const NQ=1024,Mpt=2,Ppt=.3,Opt=.5,Rpt=i=>{const e=i.baseBoundingSphere.radius,t=i.levels.map(n=>n.minScreenSpaceRadius);return new Tpt(e,t)};let Ipt=class{constructor(e,t,n,r){this.type=Sr.LOD,this.isGround=!1,this._levels=[],this._defaultRenderInstanceData=[],this._highlightRenderInstanceData=[],this._instanceIndex=0,this._slicePlane=!1,this._lastCamera=new Nn,this._updateCyclesWithStaticCamera=-1,this._needFullCycle=!1,this.slots=[at.OPAQUE_MATERIAL,at.TRANSPARENT_MATERIAL],this.canRender=!0,this._symbol=e,this._optionalFields=t,this._metadata=n,this._instanceBufferLayout=Zbe({instancedDoublePrecision:!0,instanced:t}),this._glInstanceBufferLayout=Dh(this._instanceBufferLayout,1),this._instanceData=new _pt(this._optionalFields,r),this._instanceData.on("instance-added",()=>this._requestUpdateCycle()),this._instanceData.on("instance-removed",()=>this._requestUpdateCycle()),this._instanceData.on("instance-transform-changed",s=>{this._requestUpdateCycle(),this._metadata.notifyGraphicGeometryChanged(s.index)}),this._instanceData.on("instance-visibility-changed",s=>{this._requestUpdateCycle(!0),this._metadata.notifyGraphicVisibilityChanged(s.index)}),this._instanceData.on("instance-highlight-changed",()=>this._requestUpdateCycle(!0)),this._enableLevelSelection=this._symbol.levels.length>1}get levels(){return this._levels}get baseBoundingBox(){return this._levels[this._levels.length-1].boundingBox}get baseBoundingSphere(){return this._levels[this._levels.length-1].boundingSphere}get baseMaterial(){return this._levels[this._levels.length-1].components[0].material}get slicePlaneEnabled(){return this._slicePlane}set slicePlaneEnabled(e){this._slicePlane=e}get layerUid(){return this._metadata.layerUid}get instanceData(){return this._instanceData}get memoryUsage(){const e={cpu:0,gpu:0};return this._defaultRenderInstanceData.forEach(t=>{const n=t.memoryUsage;e.cpu+=n.cpu,e.gpu+=n.gpu}),this._highlightRenderInstanceData.forEach(t=>{const n=t.memoryUsage;e.cpu+=n.cpu,e.gpu+=n.gpu}),e}get renderStats(){const e=this._instanceData.size,t=[];return this._levels.forEach((n,r)=>{const s=this._defaultRenderInstanceData[r],a=this._highlightRenderInstanceData[r],o=s.size+a.size,l=n.triangleCount;t.push({renderedInstances:o,renderedTriangles:o*l,trianglesPerInstance:l})}),{totalInstances:e,renderedInstances:t.reduce((n,r)=>n+r.renderedInstances,0),renderedTriangles:t.reduce((n,r)=>n+r.renderedTriangles,0),levels:t}}async initializeRenderContext(e,t){this._context=e;const n=e.renderContext.rctx,r=await Promise.allSettled(this._symbol.levels.map(a=>(this._defaultRenderInstanceData.push(new FQ(n,this._instanceBufferLayout)),this._highlightRenderInstanceData.push(new FQ(n,this._instanceBufferLayout)),kfe.create(e,a,t)))),s=r.map(a=>a.status==="fulfilled"?a.value:null).filter(a=>a);if(bu(t)||s.length!==r.length){s.forEach(a=>a.destroy()),Cn(t);for(const a of r)if(a.status==="rejected")throw a.reason}this._levels=s,this._levelSelector=Rpt(this)}uninitializeRenderContext(){this._invalidateOctree(),this._levels.forEach(e=>e.destroy()),this._defaultRenderInstanceData.forEach(e=>e.destroy()),this._highlightRenderInstanceData.forEach(e=>e.destroy())}get needsTransparentPass(){return this._levels.some(e=>e.components.some(t=>t.material.requiresSlot(at.TRANSPARENT_MATERIAL,Re.Color)))}get needsHighlight(){return this._highlightRenderInstanceData.some(e=>e.size>0)}prepareRender(e){if(cn.LOD_INSTANCE_RENDERER_DISABLE_UPDATES)return;if(this._enableLevelSelection){const n=e.bindParameters.contentCamera.equals(this._lastCamera);this._lastCamera.copyFrom(e.bindParameters.contentCamera),n||this._requestUpdateCycle()}const t=this._needFullCycle?this._instanceData.size:2e3;this._needFullCycle=!1,this._updateInstances(e.bindParameters.contentCamera,t),this._needsUpdates&&this._context.requestRender()}render(e){!this.baseMaterial.isVisible()||!this.baseMaterial.isVisibleForOutput(e.output)||(e.rctx.bindVAO(),e.output!==Re.Highlight&&e.output!==Re.ShadowHighlight&&this._renderComponents(e,this._defaultRenderInstanceData),e.output!==Re.ShadowExludeHighlight&&this._renderComponents(e,this._highlightRenderInstanceData))}intersect(e,t,n,r){if(!this.baseMaterial.isVisible())return;const s=q();nt(s,r,n);const a=o=>{this._instanceData.getCombinedModelTransform(o,zQ),e.transform.set(zQ),$t(UQ,n,e.transform.inverse),$t(HQ,r,e.transform.inverse);const l=this._instanceData.getState(o),c=this._instanceData.getLodLevel(o),u=this._levels.length;Ti(l&er.ACTIVE,"invalid instance state"),Ti(c>=0&&c<u,"invaid lod level"),this._levels[c].intersect(e,t,UQ,HQ,o,this._metadata,u)};this.baseMaterial.parameters.verticalOffset?this._octree.forEach(a):this._octree.forEachAlongRay(n,s,a)}queryDepthRange(e){return this._queryDepthRangeOctree(e)}notifyShaderTransformationChanged(){this._invalidateOctree()}_requestUpdateCycle(e=!1){this._updateCyclesWithStaticCamera=-1,e&&(this._needFullCycle=!0),this._needsUpdates&&this._context.requestRender()}get _needsUpdates(){return this._instanceData.size>0&&this._updateCyclesWithStaticCamera<1}get _octree(){return B(this._octreeCached)&&(this._octreeCached=this._buildOctree()),this._octreeCached}_invalidateOctree(){this._octreeCached=_t(this._octreeCached)}_buildOctree(){const e=new Cpt(this._instanceData,this.baseBoundingSphere),t=this._instanceData,n=t.view?t.view.state:null;for(let r=0;r<this._instanceData.capacity;++r)n.get(r)&er.ACTIVE&&e.addInstance(r);return e}_queryDepthRangeOctree(e){const t=e.eye,n=e.viewForward,r=this._octree.findClosest(n,hh.DepthOrder.FRONT_TO_BACK,e.frustum),s=this._octree.findClosest(n,hh.DepthOrder.BACK_TO_FRONT,e.frustum);if(r!=null&&s!=null){this._instanceData.view.boundingSphere.getVec(r,Qh),nt(Qh,Qh,t);const a=dt(Qh,n)-Qh[3];this._instanceData.view.boundingSphere.getVec(s,Qh),nt(Qh,Qh,t);const o=dt(Qh,n)+Qh[3];return{near:Math.max(e.near,a),far:Math.min(e.far,o)}}return{near:1/0,far:-1/0}}_startUpdateCycle(){this._updateCyclesWithStaticCamera++,this._defaultRenderInstanceData.forEach(e=>{e.startUpdateCylce()}),this._highlightRenderInstanceData.forEach(e=>{e.startUpdateCylce()}),this._needsUpdates&&this._context.requestRender()}_updateInstances(e,t){const n=this._enableLevelSelection,r=this._levelSelector;r.updateCamera(e),this._defaultRenderInstanceData.forEach(u=>u.beginUpdate()),this._highlightRenderInstanceData.forEach(u=>u.beginUpdate());const s=this._instanceData,a=this._instanceData.view,o=s.size,l=s.capacity;let c=this._instanceIndex;t=Math.min(o,t);for(let u=0;u<t;++u){c===0&&this._startUpdateCycle();const d=a.state.get(c);let h=0;if(!(d&er.ALLOCATED)){c=c+1===l?0:c+1,t++;continue}const p=a.lodLevel.get(c);if(d&er.DEFAULT_ACTIVE&&this._defaultRenderInstanceData[p].freeTail(),d&er.HIGHLIGHT_ACTIVE&&this._highlightRenderInstanceData[p].freeTail(),d&er.REMOVE)s.freeInstance(c);else if(d&er.VISIBLE){let m=0;n&&(a.modelOrigin.getVec(c,BQ),m=r.selectLevel(BQ,s.getCombinedMedianScaleFactor(c))),h=d&~(er.ACTIVE|er.TRANSFORM_CHANGED),m>=0&&(d&er.HIGHLIGHT?(VQ(this._highlightRenderInstanceData[m],a,c),h|=er.HIGHLIGHT_ACTIVE):(VQ(this._defaultRenderInstanceData[m],a,c),h|=er.DEFAULT_ACTIVE)),a.state.set(c,h),a.lodLevel.set(c,m)}else h=d&~(er.ACTIVE|er.TRANSFORM_CHANGED),a.state.set(c,h);if(T(this._octreeCached)){const m=!!(d&er.ACTIVE),g=!!(h&er.ACTIVE);!m&&g?this._octreeCached.addInstance(c):m&&!g?this._octreeCached.removeInstance(c):m&&g&&d&er.TRANSFORM_CHANGED&&(this._octreeCached.removeInstance(c),this._octreeCached.addInstance(c))}c=c+1===l?0:c+1}this._instanceIndex=c,this._defaultRenderInstanceData.forEach(u=>u.endUpdate()),this._highlightRenderInstanceData.forEach(u=>u.endUpdate())}_renderComponents(e,t){this.levels.forEach((n,r)=>{n.components.forEach(s=>{this._renderComponent(e,t[r],s,r)})})}_renderComponent(e,t,n,r){const{bindParameters:s,rctx:a,output:o}=e;if(t.size===0||!n.material.requiresSlot(s.slot,e.output))return;const l=n.glMaterials.load(a,s.slot,o);if(B(l))return;const c=l.beginSlot(s),u=a.bindTechnique(c,n.material.parameters,s);a.bindVAO(n.vao),c.ensureAttributeLocations(n.vao),u.bindDraw(Lpt,s,n.material.parameters),cn.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL&&e.output===Re.Color&&(u.setUniform4fv("externalColor",GQ[Math.min(r,GQ.length-1)]),u.setUniform1i("colorMixMode",Sbe.replace));const d=a.capabilities.instancing,h=t.capacity,p=t.headIndex,m=t.tailIndex,g=t.firstIndex,_=this._glInstanceBufferLayout,b=(x,w)=>{Bne(a,Mn,t.buffer,_,x),d.drawArraysInstanced(c.primitiveType,0,n.vertexCount,w-x),zne(a,Mn,t.buffer,_)};n.material.parameters.transparent&&g!=null?p>m?(Ti(g>=m&&g<=p,"invalid firstIndex"),b(g,p),b(m,g)):p<m&&(g<=p?(Ti(g>=0&&g<=p,"invalid firstIndex"),b(g,p),b(m,h),b(0,g)):(Ti(g>=m&&g<=h,"invalid firstIndex"),b(g,h),b(0,p),b(m,g))):p>m?b(m,p):p<m&&(b(0,p),b(m,h)),a.bindVAO(null)}};function VQ(i,e,t){const n=i.allocateHead();$pt(e,t,i.view,n)}function $pt(i,e,t,n){Ebe(i.modelOrigin,e,t.modelOriginHi,t.modelOriginLo,n),t.model.copyFrom(n,i.model,e),t.modelNormal.copyFrom(n,i.modelNormal,e),i.color&&t.color&&t.color.copyFrom(n,i.color,e),i.objectAndLayerIdColor&&t.objectAndLayerIdColor&&t.objectAndLayerIdColor.copyFrom(n,i.objectAndLayerIdColor,e),i.featureAttribute&&t.featureAttribute&&t.featureAttribute.copyFrom(n,i.featureAttribute,e)}const BQ=q(),Qh=Dn(),zQ=St(),UQ=q(),HQ=q(),GQ=[Xn(1,0,1,1),Xn(0,0,1,1),Xn(0,1,0,1),Xn(1,1,0,1),Xn(1,0,0,1)],Lpt=new Xbe;let Dpt=class extends xf{constructor(e,t,n,r){super(e,t,n,r),this._resources=null,this._optionalFields=new Array,this._instanceIndexToGraphicUid=new Map,this._hasLoadedPBRTextures=!1,this._disposeResourceHandles=new Array,this.ensureDrapedStatus(!1),this._hasLoadedPBRTextures=n.physicalBasedRenderingEnabled}getCachedSize(){const[e,t,n]=T(this._resources)?this._resources.symbolSize:[1,1,1];return{width:e,depth:t,height:n}}async doLoad(e){if(!this._drivenProperties.size&&fD(this.symbolLayer))throw new Error;const t=this.symbolLayer;if(this._isPrimitive){const n=t.resource?t.resource.primitive:hB;this._resources=await this._createResourcesForPrimitive(n,e)}else this._resources=await this._createResourcesForUrl(t.resource.href,e);this.layerOpacityChanged(),this.slicePlaneEnabledChanged(),this.physicalBasedRenderingChanged(),this.complexity=this.computeComplexity()}get extentPadding(){return T(this._resources)?this._resources.extentPadding:0}get _isPrimitive(){return!(this.symbolLayer.resource&&this.symbolLayer.resource.href)}get lodRenderer(){return ms(this._resources,"lodRenderer")}_setMaterialTransparencyParams(e,t=ms(this.symbolLayer,"material","color")){const n=this._getCombinedOpacity(t),r=n<1||this.needsDrivenTransparentPass;return e.transparent=r,e.opacity=n,e.cullFace=r?qs.None:qs.Back,e}async _createResourcesForPrimitive(e,t){if(!Iut(e))throw new Error(`Unknown object symbol primitive: ${e}`);const n=this.symbolLayer,r=Go(Awe(e)),s=gu(kM(r)),a=gu(rk(s,n)),o=Et(a),l=!1,c=!1,u={usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0,ambient:Zv,diffuse:Zv,hasSlicePlane:this._context.slicePlaneEnabled,hasSliceHighlight:!1,castShadows:this.symbolLayer.castShadows,offsetTransparentBackfaces:!this.symbolLayer.isPrimitive},d=u.usePBR;this._setMaterialTransparencyParams(u);const h=this.symbol;if(h.type==="point-3d"&&h.verticalOffset){const{screenLength:b,minWorldLength:x,maxWorldLength:w}=h.verticalOffset;u.verticalOffset={screenLength:Hn(b),minWorldLength:x||0,maxWorldLength:T(w)?w:1/0},u.castShadows=!1}if(this._context.screenSizePerspectiveEnabled&&(u.screenSizePerspective=this._context.sharedResources.screenSizePerspectiveSettings),this._drivenProperties.color)u.externalColor=oh;else{const b=T(n.material)&&n.material.color,x=T(b)?Xt.toUnitRGBA(b):oh;u.externalColor=x}this._fastUpdates=CA(this._context.renderer,this._fastVisualVariableConvertOptions(r,a,s,qb)),u.instanced=["transformation"],this._fastUpdates.enabled?(Object.assign(u,this._fastUpdates.materialParameters),u.instanced.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(u.instanced.push("color"),this._optionalFields.push("color")),Fi("enable-feature:objectAndLayerId-rendering")&&(u.instanced.push("objectAndLayerIdColor"),this._optionalFields.push("objectAndLayerIdColor"));const p=new v2(u),m=afe(e,p);if(!m)throw new Error(`Unknown object symbol primitive: ${e}`);const g=UP(m).map(b=>({opacity:1,transparent:b.parameters.transparent})),_=await this._createStageResources(m,d);return{lodResources:m,lodRenderer:await this._createLodRenderer(m,t),stageResources:_,symbolSize:a,extentPadding:o,isEsriSymbolResource:l,isWosr:c,originalMaterialParameters:g,physicalBasedRenderingEnabled:d,resourceBoundingBox:r,resourceSize:s,pivotOffset:qb}}async _createResourcesForUrl(e,t){const n=["transformation"],r={materialParamsMixin:{instanced:n,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows},streamDataRequester:this._context.streamDataRequester,cache:this._context.sharedResources.objectResourceCache};this._fastUpdates=CA(this._context.renderer,this._fastVisualVariableConvertOptions(qb,qb,qb,qb)),this._fastUpdates.enabled?(Object.assign(r.materialParamsMixin,this._fastUpdates.materialParameters),n.push("featureAttribute"),this._optionalFields.push("featureAttribute")):this._hasPerInstanceColor()&&(n.push("color"),this._optionalFields.push("color")),Fi("enable-feature:objectAndLayerId-rendering")&&(n.push("objectAndLayerIdColor"),this._optionalFields.push("objectAndLayerIdColor"));const s=this.symbol;if(s.type==="point-3d"&&s.verticalOffset){const{screenLength:O,minWorldLength:M,maxWorldLength:V}=s.verticalOffset;r.materialParamsMixin.verticalOffset={screenLength:Hn(O),minWorldLength:M||0,maxWorldLength:T(V)?V:1/0},r.materialParamsMixin.castShadows=!1}r.signal=t,r.usePBR=this._context.physicalBasedRenderingEnabled,r.skipHighLods=this._context.skipHighSymbolLods;const a=r.usePBR,o=await Qbe(e,r),l=o.isEsriSymbolResource,c=o.isWosr,u=ppt(o.lods);mpt(u),u.levels.sort((O,M)=>O.minScreenSpaceRadius-M.minScreenSpaceRadius),u.levels[0].minScreenSpaceRadius=Math.min(2,u.levels[0].minScreenSpaceRadius);const d=this._context,h=this.symbolLayer.material,p=this._getExternalColorParameters(h),m=ms(this.symbolLayer,"material","color"),g=this._getCombinedOpacity(m,{hasIntrinsicColor:!0}),_=this.needsDrivenTransparentPass,b=UP(u),x=UP(u).map(O=>({opacity:O.parameters.opacity||1,transparent:O.parameters.transparent}));b.forEach(O=>{const M=O.parameters;O.setParameters(p);const V=M.opacity*g,L=V<1||_||M.transparent;O.setParameters({opacity:V,transparent:L}),d.screenSizePerspectiveEnabled&&O.setParameters({screenSizePerspective:d.sharedResources.screenSizePerspectiveSettings})});const w=o.referenceBoundingBox,C=gu(kM(w)),S=gu(u.levels[0].pivotOffset),E=gu(rk(C,this.symbolLayer)),A=Et(E);TA(this._fastUpdates,this._context.renderer,this._fastVisualVariableConvertOptions(w,E,C,S))&&b.forEach(O=>O.setParameters(this._fastUpdates.materialParameters));const P=await this._createStageResources(u,a);return{lodResources:u,lodRenderer:await this._createLodRenderer(u,t),stageResources:P,symbolSize:E,extentPadding:A,isEsriSymbolResource:l,isWosr:c,originalMaterialParameters:x,physicalBasedRenderingEnabled:a,resourceBoundingBox:w,resourceSize:C,pivotOffset:S}}_addDisposeResource(e){this._disposeResourceHandles.push(e)}async _createStageResources(e,t){const n=this._context.stage,r=UP(e);t!==this._context.physicalBasedRenderingEnabled&&this.physicalBasedRenderingChanged(),n.addMany(r),this._addDisposeResource(()=>n.removeMany(r));const s=DZ(e);n.addMany(s),this._addDisposeResource(()=>n.removeMany(s)),await n.load(s);const a=kZ(e);return n.addMany(a),this._addDisposeResource(()=>n.removeMany(a)),{materials:r,textures:s,geometries:a}}async _createLodRenderer(e,t){const n=this._context.stage,r={layerUid:this._context.layer.uid,graphicUid:o=>this._instanceIndexToGraphicUid.get(o),notifyGraphicGeometryChanged:o=>this._context.notifyGraphicGeometryChanged(this._instanceIndexToGraphicUid.get(o)),notifyGraphicVisibilityChanged:o=>this._context.notifyGraphicVisibilityChanged(this._instanceIndexToGraphicUid.get(o))},s=this._fastUpdates.enabled?{applyTransform:(o,l,c)=>{o.getFeatureAttribute(l,JP),da(c,Z6(this._fastUpdates.materialParameters,JP,c))},scaleFactor:(o,l,c)=>(l.getFeatureAttribute(c,JP),bht(o,this._fastUpdates.materialParameters,JP))}:null,a=new Ipt(e,this._optionalFields,r,s);return a.slicePlaneEnabled=this._context.slicePlaneEnabled,this._addDisposeResource(()=>{n.removeRenderPlugin(a)}),await n.addRenderPlugin(a.slots,a,t),a}_getExternalColorParameters(e){const t={};return this._drivenProperties.color?t.externalColor=oh:T(e)&&T(e.color)?t.externalColor=Xt.toUnitRGBA(e.color):(t.externalColor=oh,t.colorMixMode="ignore"),t}destroy(){super.destroy(),this._cleanupResources()}_cleanupResources(){this._disposeResourceHandles.forEach(e=>e()),this._disposeResourceHandles.length=0,this._resources=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry))return null;const n=wA(t.geometry);if(B(n))return this.logger.warn(`unsupported geometry type for icon symbol: ${t.geometry.type}`),null;const r=this.setGraphicElevationContext(t,new Dd),s=e.renderingInfo;return this._createAs3DShape(t,n,s,r,t.uid,e.layer.uid)}notifyDestroyGraphicLayer(e){this._instanceIndexToGraphicUid.delete(e.instanceIndex)}graphicLayerToGraphicId(){return 0}layerOpacityChanged(){if(B(this._resources))return;const e=this._drivenProperties.opacity,t=!this._isPrimitive,n=this._resources.stageResources.materials,r=this._resources.originalMaterialParameters;for(let s=0;s<n.length;s++){const a=n[s],o=ms(this.symbolLayer,"material","color"),l=r[s],c=this._getCombinedOpacity(o,{hasIntrinsicColor:t})*l.opacity,u=c<1||e||l.transparent;a.setParameters({opacity:c,transparent:u}),this._isPrimitive&&a.setParameters({cullFace:u?qs.None:qs.Back})}}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Iy)}slicePlaneEnabledChanged(){if(B(this._resources))return!0;this._resources.lodRenderer.slicePlaneEnabled=this._context.slicePlaneEnabled;for(const e of this._resources.stageResources.materials)e.setParameters({hasSlicePlane:this._context.slicePlaneEnabled});return!0}physicalBasedRenderingChanged(){if(B(this._resources))return!0;const{stageResources:e,isWosr:t}=this._resources;for(const n of e.materials)this._isPrimitive?n.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}):t||n.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!1});return this._hasLoadedPBRTextures!==!1||this._context.physicalBasedRenderingEnabled!==!0||(this._hasLoadedPBRTextures=!0,!1)}pixelRatioChanged(){return!0}applyRendererDiff(e,t){if(B(this._resources))return Ns.Recreate_Symbol;const{stageResources:{materials:n},lodRenderer:r,resourceBoundingBox:s,symbolSize:a,resourceSize:o,pivotOffset:l}=this._resources;for(const c in e.diff){if(c!=="visualVariables"||!TA(this._fastUpdates,t,this._fastVisualVariableConvertOptions(s,a,o,l)))return Ns.Recreate_Symbol;for(const u of n)u.setParameters(this._fastUpdates.materialParameters);r.notifyShaderTransformationChanged()}return Ns.Fast_Update}computeComplexity(){if(B(this._resources))return super.computeComplexity();const e=this._resources.lodResources,t=x7(e.levels[0]).reduce((s,a)=>s+a.indices.get(j.POSITION).length,0)/3,n=s=>Array.from(s.vertexAttributes.values()).reduce((a,o)=>{var l;return a+(((l=o.data.buffer)==null?void 0:l.byteLength)??0)},0)+Array.from(s.indices.values()).reduce((a,o)=>a+(Array.isArray(o)?12*o.length:o.buffer.byteLength),0),r=DZ(e).reduce((s,a)=>s+a.estimatedTexMemRequired,0)/4+kZ(e).reduce((s,a)=>s+n(a),0);return{primitivesPerFeature:t,primitivesPerCoordinate:0,drawCallsPerFeature:0,estimated:!1,memory:{...lfe(this.symbol,this.symbolLayer),resourceBytes:r}}}_hasLodRenderer(){return T(this._resources)}_createAs3DShape(e,t,n,r,s,a){if(!this._hasLodRenderer()||B(this._resources))return null;const o=this.getFastUpdateAttrValues(e),l=!this._fastUpdates.enabled&&this._hasPerInstanceColor()?PE(n.color,n.opacity):null,c=this._context.clippingExtent;if(ya(t,A1,this._context.elevationProvider.spatialReference),T(c)&&!oz(c,A1))return null;const u=this._requiresTerrainElevation(r),d=this._computeGlobalTransform(t,r,y4,eO),h=this._computeLocalTransform(this._resources,this.symbolLayer,n,WQ),p=this._resources.lodRenderer.instanceData,m=p.addInstance();this._instanceIndexToGraphicUid.set(m,s),p.setLocalTransform(m,h,!1),p.setGlobalTransform(m,d),o&&p.setFeatureAttribute(m,o),l&&p.setColor(m,l),Fi("enable-feature:objectAndLayerId-rendering")&&p.setObjectAndLayerIdColor(m,this._context.stage.renderView._objectAndLayerIdRenderHelper.getObjectAndLayerIdColor({graphicUid:s,layerUid:a}));const g=new upt(this,m,Tut,r);return u&&(g.alignedSampledElevation=eO.sampledElevation),g.needsElevationUpdates=Iy(r.mode),bA(g,t,this._context.elevationProvider),g}_computeGlobalTransform(e,t,n,r){return tg(e,this._context.elevationProvider,t,this._context.renderCoordsHelper,r),A1[0]=e.x,A1[1]=e.y,A1[2]=r.z,zm(e.spatialReference,A1,n,this._context.renderCoordsHelper.spatialReference),n}_computeLocalTransform(e,t,n,r){return Q0(r),this._applyObjectRotation(n,!1,r),this._applyObjectRotation(t,!0,r),this._applyObjectScale(e,n,r),this._applyAnchor(e,t,r),r}_applyObjectScale(e,t,n){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const r=this._drivenProperties.size&&t.size?t.size:e.symbolSize,s=$Z(r,e.symbolSize,e.resourceSize,this._context.renderCoordsHelper.unitInMeters);s[0]===1&&s[1]===1&&s[2]===1||pne(n,n,s)}prepareSymbolLayerPatch(e){if(e.diff.type!=="partial")return;const t=e.diff.diff;this._preparePatchTransform(e,t),this._preparePatchColor(e,t)}updateGeometry(e,t){if(B(this._resources))return!0;const n=t&&wA(t);if(B(n))return!1;const r=this.getGeometryElevationMode(t);return e.elevationContext.mode===r&&(this._computeGlobalTransform(n,e.elevationContext,y4,eO),this._requiresTerrainElevation(e.elevationContext)&&(e.alignedSampledElevation=eO.sampledElevation),this._resources.lodRenderer.instanceData.setGlobalTransform(e.instanceIndex,y4,!0),bA(e,n,this._context.elevationProvider),!0)}_preparePatchTransform(e,t){if(!(t.heading||t.tilt||t.roll||t.width||t.height||t.depth||t.anchor||t.anchorPosition)||B(this._resources))return;const n=(m,g,_)=>Jt(m!=null&&m.type==="complete"?m.newValue:g,_),r=n(t.heading,this.symbolLayer.heading,0),s=n(t.tilt,this.symbolLayer.tilt,0),a=n(t.roll,this.symbolLayer.roll,0),o=n(t.width,this.symbolLayer.width,void 0),l=n(t.height,this.symbolLayer.height,void 0),c=n(t.depth,this.symbolLayer.depth,void 0),u=n(t.anchor,this.symbolLayer.anchor,void 0),d=n(t.anchorPosition,this.symbolLayer.anchorPosition,void 0);delete t.heading,delete t.tilt,delete t.roll,delete t.width,delete t.height,delete t.depth,delete t.anchor,delete t.anchorPosition;const h={heading:r,tilt:s,roll:a,anchor:u,anchorPosition:d},p=this._resources;this.loadStatus===yu.LOADED&&e.symbolLayerStatePatches.push(()=>{p.symbolSize=gu(rk(p.resourceSize,{width:o,height:l,depth:c,isPrimitive:this.symbolLayer.isPrimitive}))}),e.graphics3DGraphicPatches.push((m,g)=>{const _=this._computeLocalTransform(p,h,g,WQ),b=m.instanceIndex;p.lodRenderer.instanceData.setLocalTransform(b,_,!0)})}_preparePatchColor(e,t){if(!t.material||t.material.type!=="partial")return;const n=t.material.diff;if(!n.color||n.color.type!=="complete"||n.color.newValue==null||n.color.oldValue==null)return;const r=n.color.newValue,s=T(r)?Xt.toUnitRGBA(r):oh;delete n.color;const a=this._resources;B(a)||e.graphics3DGraphicPatches.push(o=>{let l;this._hasPerInstanceColor()?(a.lodRenderer.instanceData.setColor(o.instanceIndex,s),l=this._setMaterialTransparencyParams({},r)):l=this._setMaterialTransparencyParams({externalColor:s},r);for(const c of a.stageResources.materials)c.setParameters(l)})}_requiresTerrainElevation(e){return e.mode!=="absolute-height"}_applyObjectRotation(e,t,n){if(!(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation&&t))return put(e.heading,e.tilt,e.roll,n)}_computeAnchor(e,t,n){const r=q();switch(n.anchor){case"center":Ge(r,ph(e)),No(r,r);break;case"top":{const s=ph(e);je(r,-s[0],-s[1],-e[5]);break}case"bottom":{const s=ph(e);je(r,-s[0],-s[1],-e[2]);break}case"relative":{const s=ph(e),a=kM(e),o=n.anchorPosition,l=o?Gt(o.x,o.y,o.z):wd;d0e(r,a,l),rt(r,r,s),No(r,r);break}default:T(t)?No(r,t):Ge(r,wd)}return r}_applyAnchor(e,t,n){if(this._fastUpdates.enabled&&this._fastUpdates.requiresShaderTransformation)return;const r=this._computeAnchor(e.resourceBoundingBox,e.pivotOffset,t);r&&of(n,n,r)}_hasPerInstanceColor(){return this._drivenProperties.color||this._drivenProperties.opacity}_fastVisualVariableConvertOptions(e,t,n,r){const s=T(e)?gu(kM(e)):Zv,a=T(e)?this._computeAnchor(e,r,this.symbolLayer):wd,o=this._context.renderCoordsHelper.unitInMeters,l=$Z(T(t)?t:void 0,t,n,o),c=Gt(this.symbolLayer.tilt||0,this.symbolLayer.roll||0,this.symbolLayer.heading||0);return{modelSize:s,symbolSize:T(t)?t:Zv,unitInMeters:o,transformation:{anchor:a,scale:l,rotation:c}}}};const A1=q(),WQ=St(),y4=St(),JP=Dn(),eO=new _M;function kpt(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function Fpt(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i}function B7(i,e,t,n,r){return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function Npt(i,e){if(i===e){const t=e[1];i[1]=e[2],i[2]=t}else i[0]=e[0],i[1]=e[2],i[2]=e[1],i[3]=e[3];return i}function Vpt(i,e){const t=e[0],n=e[1],r=e[2],s=e[3];let a=t*s-r*n;return a?(a=1/a,i[0]=s*a,i[1]=-n*a,i[2]=-r*a,i[3]=t*a,i):null}function Bpt(i,e){const t=e[0];return i[0]=e[3],i[1]=-e[1],i[2]=-e[2],i[3]=t,i}function zpt(i){return i[0]*i[3]-i[2]*i[1]}function Ffe(i,e,t){const n=e[0],r=e[1],s=e[2],a=e[3],o=t[0],l=t[1],c=t[2],u=t[3];return i[0]=n*o+s*l,i[1]=r*o+a*l,i[2]=n*c+s*u,i[3]=r*c+a*u,i}function Upt(i,e,t){const n=e[0],r=e[1],s=e[2],a=e[3],o=Math.sin(t),l=Math.cos(t);return i[0]=n*l+s*o,i[1]=r*l+a*o,i[2]=n*-o+s*l,i[3]=r*-o+a*l,i}function Hpt(i,e,t){const n=e[0],r=e[1],s=e[2],a=e[3],o=t[0],l=t[1];return i[0]=n*o,i[1]=r*o,i[2]=s*l,i[3]=a*l,i}function Gpt(i,e){const t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=t,i[2]=-t,i[3]=n,i}function Wpt(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=e[1],i}function jpt(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}function qpt(i){return Math.sqrt(i[0]**2+i[1]**2+i[2]**2+i[3]**2)}function Kpt(i,e,t,n){return i[2]=n[2]/n[0],t[0]=n[0],t[1]=n[1],t[3]=n[3]-i[2]*t[1],[i,e,t]}function Ypt(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}function Nfe(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}function Xpt(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}function Zpt(i,e){const t=i[0],n=i[1],r=i[2],s=i[3],a=e[0],o=e[1],l=e[2],c=e[3],u=CB();return Math.abs(t-a)<=u*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-o)<=u*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(r-l)<=u*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-c)<=u*Math.max(1,Math.abs(s),Math.abs(c))}function Qpt(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}function Jpt(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i}const eft=Ffe,tft=Nfe;Object.freeze(Object.defineProperty({__proto__:null,copy:kpt,identity:Fpt,set:B7,transpose:Npt,invert:Vpt,adjoint:Bpt,determinant:zpt,multiply:Ffe,rotate:Upt,scale:Hpt,fromRotation:Gpt,fromScaling:Wpt,str:jpt,frob:qpt,LDU:Kpt,add:Ypt,subtract:Nfe,exactEquals:Xpt,equals:Zpt,multiplyScalar:Qpt,multiplyScalarAndAdd:Jpt,mul:eft,sub:tft},Symbol.toStringTag,{value:"Module"}));let ift=class extends Bs{constructor(e,t,n,r,s,a,o){super(e,t,xh.Triangle,o),this.path=n,this.geometrySR=r,this.upVectorAlignment=s,this.stencilWidth=a}};function Vfe(i){return"upVectorAlignment"in i}function Bfe(){return[1,0,0,1]}function nft(i){return[i[0],i[1],i[2],i[3]]}function rft(i,e,t,n){return[i,e,t,n]}function sft(i,e){return new Float64Array(i,e,4)}Object.freeze(Object.defineProperty({__proto__:null,create:Bfe,clone:nft,fromValues:rft,createView:sft},Symbol.toStringTag,{value:"Module"}));function e8(){return{up:q(),right:q()}}function aft(i,e,t){$t(i.up,e.up,t),$t(i.right,e.right,t)}function oft(i,e,t){Bi(i,dt(t,e.right),dt(t,e.up))}let lft=class{constructor(){this.pos=q(),this.posES=q(),this.posGS=q(),this.vRight=q(),this.vLeft=q(),this.frame=e8(),this.rotationFrame=e8(),this.rotationRight=xt(),this.rotationAngle=0,this.miterStretch=Bfe()}setFrameFromUpVector(e){Ge(this.frame.up,e),rt(qu,this.vLeft,this.vRight),mt(qu,qu),Ye(qd,this.frame.up,dt(qu,this.frame.up)),nt(iO,qu,qd),mt(iO,iO),vi(this.frame.right,iO,this.frame.up)}computeRotationAxisAndAngleFromUpVector(){Ge(this.rotationFrame.up,this.frame.up),Ge(this.rotationFrame.right,this.frame.right),Bi(this.rotationRight,1,0),Ye(qd,this.frame.up,dt(this.frame.up,this.vLeft)),nt(qd,this.vLeft,qd),No(qd,qd),mt(qd,qd),Ye(qu,this.frame.up,dt(this.frame.up,this.vRight)),nt(qu,this.vRight,qu),mt(qu,qu),vi(t8,this.rotationFrame.up,this.vLeft);const e=Math.sign(dt(t8,this.vRight));if(this.rotationAngle=e*(Math.PI-Uo(dt(qd,qu))),Math.abs(this.rotationAngle)>0){const n=IN(Math.cos(.5*this.rotationAngle));B7(this.miterStretch,n-1+1,0,0,1)}const t=Math.PI-this.rotationAngle;this.maxStretchDistance=Math.abs(Math.min(this.vLeftLength,this.vRightLength)/Math.cos(.5*t))}},lL=class{constructor(){this.vertices=[],this.vertexIndices=[],this.vertexNormals=[],this.poles=[],this.poleIndices=[],this.uvs=null,this.uvIndices=null}addVertex(e,t){return this.vertices.push(dS(e)),this.vertexNormals.push(dS(t)),this.vertices.length-1}addUV(e){return this.uvs||(this.uvs=[],this.uvIndices=[]),this.uvs.push(e),this.uvs.length-1}addPole(e,t=null){return this.poles.push({position:dS(e),normal:t?dS(t):null}),this.poles.length-1}addSegment(e,t=null,n=null){this.vertexIndices.push(e.v0),this.vertexIndices.push(e.v1),t&&(this.uvIndices.push(t.v0),this.uvIndices.push(t.v1)),n&&(this.poleIndices.push(n.v0),this.poleIndices.push(n.v1))}get numSegments(){return this.vertexIndices.length/2}hasUV(){return this.uvs!=null}translate(e,t){for(const n of this.vertices)n[0]+=e,n[1]+=t;for(const n of this.poles)n.position[0]+=e,n.position[1]+=t}static circle(e=20){const n=new lL,r={v0:0,v1:0};n.addPole(dn(0,0));for(let o=0;o<e;++o){const l=2*o*Math.PI/e,c=Math.cos(l),u=Math.sin(l),d=dn(c*.5,u*.5),h=dn(c,u);n.addVertex(d,h),n.addUV(o/e)}n.addUV(1);for(let o=0;o<e-1;++o){const l={v0:o,v1:o+1},c=l;n.addSegment(l,c,r)}const s={v0:e-1,v1:0},a={v0:e-1,v1:e};return n.addSegment(s,a,r),n}static rect(){const n=new lL,r=dn(.5*-1,.5*-1),s=dn(.5*1,.5*-1),a=dn(.5*1,.5*1),o=dn(.5*-1,.5*1),l=dn(0,-1),c=dn(1,0),u=dn(0,1),d=dn(-1,0);n.addUV(0),n.addUV(1),n.addPole(dn(0,.5*1),u),n.addPole(dn(0,.5*1)),n.addPole(dn(0,.5*-1)),n.addPole(dn(0,.5*-1),l);const h={v0:0,v1:1};return n.addVertex(r,l),n.addVertex(s,l),n.addSegment({v0:0,v1:1},h,{v0:3,v1:3}),n.addVertex(s,c),n.addVertex(a,c),n.addSegment({v0:2,v1:3},h,{v0:2,v1:1}),n.addVertex(a,u),n.addVertex(o,u),n.addSegment({v0:4,v1:5},h,{v0:0,v1:0}),n.addVertex(o,d),n.addVertex(r,d),n.addSegment({v0:6,v1:7},h,{v0:1,v1:2}),n}},cft=class{constructor(e){this.vertices=[],this.offset=q(),this.xform=St(),this.vertices=e;const t=Math.floor((e.length-1)/2);Ge(this.offset,this.vertices[t].pos);for(const n of this.vertices)nt(n.pos,n.pos,this.offset);of(this.xform,this.xform,this.offset),this.updatePathVertexInformation()}updatePathVertexInformation(){const e=this.vertices.length;let t=this.vertices[0];t.index=0,je(t.vLeft,0,0,0),t.vLeftLength=0,nt(t.vRight,this.vertices[1].pos,t.pos),t.vRightLength=Et(t.vRight),mt(t.vRight,t.vRight);let n=t;for(let r=1;r<e;++r)t=this.vertices[r],t.index=r,Ge(t.vLeft,n.vRight),t.vLeftLength=n.vRightLength,r<e-1?(nt(t.vRight,this.vertices[r+1].pos,t.pos),t.vRightLength=Et(t.vRight),mt(t.vRight,t.vRight)):(Ge(t.vRight,t.vLeft),t.vRightLength=t.vLeftLength),n=t}};function uft(i,e){let t=null;const n=i.vertices.length,r=.99619469809,s=q(),a=q(),o=q(),l=q(),c=q(),u=q(),d=Dr();let h=i.vertices[0];Ge(a,e),je(s,0,1,0),F$(h.vRight,a,s,s,o,a,r),Ge(h.frame.up,a),Ge(h.frame.right,o),t=h;for(let p=1;p<n;++p){h=i.vertices[p],rt(c,h.vLeft,h.vRight);let m=Et(c);m>0?(m=1/Math.sqrt(m),c[0]=c[0]*m,c[1]=c[1]*m,c[2]=c[2]*m):(c[0]=h.vRight[0],c[1]=h.vRight[1],c[2]=h.vRight[2]),rt(u,t.pos,t.frame.up),Gx(h.pos,c,d),xb(d,Ah(u,h.vLeft),l)?(nt(l,l,h.pos),mt(a,l),vi(o,c,a),mt(o,o)):F$(c,t.frame.up,t.frame.right,s,o,a,r),Ge(h.frame.up,a),Ge(h.frame.right,o),t=h}}let dft=class{numProfilesPerJoin(){return 1}extrude(e,t,n){for(let r=0;r<t.vertices.length;++r)n(e.index,e.frame,t.vertices[r],t.vertexNormals[r],!1)}},_4=class{constructor(e=.8*Math.PI,t=1){this.cutoffAngle=e,this.numBendSubdivisions=t}numProfilesPerJoin(){return this.numBendSubdivisions+1}extrude(e,t,n){const r=yft;if(Math.abs(e.rotationAngle)>=this.cutoffAngle)for(let s=0;s<this.numBendSubdivisions+1;++s){Mh(KQ,.5*-e.rotationAngle+s*e.rotationAngle/this.numBendSubdivisions,e.rotationFrame.up),aft(r,e.frame,KQ);for(let a=0;a<t.vertices.length;++a)cr(t.vertices[a],e.rotationRight)*e.rotationAngle>=0?n(e.index,r,t.vertices[a],t.vertexNormals[a],!1):(FG(R0,t.vertices[a],e.miterStretch),n(e.index,e.frame,R0,t.vertexNormals[a],!0))}else for(let s=0;s<this.numBendSubdivisions+1;++s)for(let a=0;a<t.vertices.length;++a){const o=cr(t.vertices[a],e.rotationRight)*e.rotationAngle>=0;FG(R0,t.vertices[a],e.miterStretch),n(e.index,e.frame,R0,t.vertexNormals[a],!o)}}};const hft={generateUV:!1};let z7=class{rebuildConnectingProfileGeometry(e,t,n){for(let r=0;r<t.vertices.length;++r)n(e.index,e.frame,t.vertices[r],t.vertexNormals[r],0,0)}},jQ=class extends z7{constructor(){super()}getNumVertices(){return 0}getNumIndices(){return 0}rebuildCapGeometry(){}buildTopology(){}},tO=class extends z7{constructor(e,t=0,n=!1){super(),this.profile=e,this.profilePlaneOffset=t,this.flip=n}getNumVertices(){return this.profile.vertices.length}getNumIndices(){return 3*this.profile.numSegments}rebuildConnectingProfileGeometry(e,t,n){for(let r=0;r<t.vertices.length;++r)n(e.index,e.frame,t.vertices[r],t.vertexNormals[r],this.profilePlaneOffset,0)}rebuildCapGeometry(e,t){const n=U7;Bi(n,0,0);const r=this.flip?1:-1;for(let s=0;s<this.profile.vertices.length;++s)t(e.index,e.frame,this.profile.vertices[s],n,this.profilePlaneOffset,r)}buildTopology(e,t){const n=this.vertexBufferStart+this.profile.vertexIndices[0];for(let r=1;r<this.profile.numSegments;++r){const s=this.profile.vertexIndices[2*r+0],a=this.profile.vertexIndices[2*r+1],o=this.vertexBufferStart+s,l=this.vertexBufferStart+a;this.flip?t(l,o,n):t(n,o,l)}}},qQ=class extends z7{constructor(e){super(),this.flip=!1,this.sign=0,this.breakNormals=!1,this.numSegments=3,this.profile=e.profile,this.flip=e.flip,this.sign=this.flip?1:-1,this.breakNormals=e.breakNormals,this.numSegments=e.subdivisions}getNumVertices(){let e=0;return e=this.profile.vertices.length*(this.numSegments-1),this.breakNormals&&(e+=this.profile.vertices.length),e+=this.profile.poles.length,e}getNumIndices(){let e=0;e+=2*this.profile.numSegments*(this.numSegments-1);for(let t=0;t<this.profile.numSegments;++t){const n=this.profile.vertexIndices[2*t+0],r=this.profile.vertexIndices[2*t+1];this.profile.poleIndices[n]===this.profile.poleIndices[r]?e+=1:e+=2}return 3*e}rebuildCapGeometry(e,t){const n=e.frame,r=.5*this.sign,s=R0,a=U7;Bi(a,0,0);for(let o=0;o<this.profile.poles.length;++o){const l=this.profile.poles[o];l.normal?t(e.index,n,l.position,l.normal,r,0):t(e.index,n,l.position,a,r,this.sign)}if(this.breakNormals)for(let o=0;o<this.profile.vertices.length;++o)t(e.index,n,this.profile.vertices[o],this.profile.vertexNormals[o],0,0);for(let o=0;o<this.numSegments-1;++o){const l=(1-(o+1)/this.numSegments)*Math.PI*.5,c=Math.sin(l),u=Math.cos(l);for(let d=0;d<this.profile.vertices.length;++d){const h=this.profile.poles[this.profile.poleIndices[d]];Yn(s,this.profile.vertices[d],h.position),Po(s,s,c),h.normal?(sd(s,s,h.position),t(e.index,n,s,h.normal,r*u,0)):(my(a,s),Po(a,a,c),sd(s,s,h.position),t(e.index,n,s,a,r*u,this.sign*u))}}}buildTopology(e,t){const n=this.breakNormals?this.vertexBufferStart+this.profile.poles.length:this.firstProfileVertexIndex,r=this.breakNormals?this.vertexBufferStart+this.profile.poles.length+this.profile.vertices.length:this.vertexBufferStart+this.profile.poles.length;for(let s=0;s<this.profile.numSegments;++s){const a=this.profile.vertexIndices[2*s+0],o=this.profile.vertexIndices[2*s+1],l=this.vertexBufferStart+this.profile.poleIndices[a],c=this.vertexBufferStart+this.profile.poleIndices[o];let u=n+a,d=n+o;for(let h=0;h<this.numSegments-1;++h){const p=r+h*this.profile.vertices.length+a,m=r+h*this.profile.vertices.length+o;this.flip?(t(p,d,u),t(d,p,m)):(t(u,d,p),t(m,p,d)),u=p,d=m}this.flip?(t(l,d,u),l!==c&&t(l,c,d)):(t(u,d,l),l!==c&&t(d,c,l))}}},pft=class{constructor(e,t,n,r,s,a=hft){this.options=a,this._extrusionVertexCount=0,this.numExtrusionProfiles=0,this.numVerticesTotal=0,this.numNormalsTotal=0,this.numUVTotal=0,this.profile=t,this.path=e,this.extruder=n,this.startCap=r,this.endCap=s;const o=this.path.vertices.length-2;this.numExtrusionProfiles=n.numProfilesPerJoin()*o+2,this.numVerticesTotal=t.vertices.length*this.numExtrusionProfiles,this.numNormalsTotal=this.numVerticesTotal,this.startCap.vertexBufferStart=this.numVerticesTotal;const l=this.startCap.getNumVertices();this.numVerticesTotal+=l,this.numNormalsTotal+=l,this.endCap.vertexBufferStart=this.numVerticesTotal;const c=this.endCap.getNumVertices();this.numVerticesTotal+=c,this.numNormalsTotal+=c,this.pathVertexData=new Float32Array(1*this.numVerticesTotal),this.profileRightAxisData=new Float32Array(4*this.numVerticesTotal),this.profileUpAxisData=new Float32Array(4*this.numVerticesTotal),this.profileVertexAndNormalData=new Float32Array(4*this.numVerticesTotal),this.profile.hasUV()&&this.options.generateUV&&(this.numUVTotal=this.profile.uvs.length,this.uvData=new Float32Array(2*this.numUVTotal)),this.originData=new Float32Array(3*this.path.vertices.length),this._rebuildGeometry(),this.buildTopology()}emitVertex(e,t,n,r,s){if(this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=n[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=r[1],this.pathVertexData[this._extrusionVertexCount]=e,s){const a=this.path.vertices[e];this.profileRightAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[0]*a.maxStretchDistance,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a.rotationRight[1]*a.maxStretchDistance}else this.profileRightAxisData[4*this._extrusionVertexCount+3]=0,this.profileUpAxisData[4*this._extrusionVertexCount+3]=0;++this._extrusionVertexCount}emitCapVertex(e,t,n,r,s,a){this.profileRightAxisData[4*this._extrusionVertexCount+0]=t.right[0],this.profileRightAxisData[4*this._extrusionVertexCount+1]=t.right[1],this.profileRightAxisData[4*this._extrusionVertexCount+2]=t.right[2],this.profileUpAxisData[4*this._extrusionVertexCount+0]=t.up[0],this.profileUpAxisData[4*this._extrusionVertexCount+1]=t.up[1],this.profileUpAxisData[4*this._extrusionVertexCount+2]=t.up[2],this.profileVertexAndNormalData[4*this._extrusionVertexCount+0]=n[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+1]=n[1],this.profileVertexAndNormalData[4*this._extrusionVertexCount+2]=r[0],this.profileVertexAndNormalData[4*this._extrusionVertexCount+3]=r[1],this.pathVertexData[this._extrusionVertexCount]=e,this.profileRightAxisData[4*this._extrusionVertexCount+3]=s,this.profileUpAxisData[4*this._extrusionVertexCount+3]=a,++this._extrusionVertexCount}emitTriangle(e,t,n){this.vertexIndices.push(e),this.vertexIndices.push(t),this.vertexIndices.push(n),this.pathVertexIndices.push(this.pathVertexData[e]),this.pathVertexIndices.push(this.pathVertexData[t]),this.pathVertexIndices.push(this.pathVertexData[n]),this.normalIndices.push(e),this.normalIndices.push(t),this.normalIndices.push(n)}_rebuildGeometry(){const e=(n,r,s,a,o)=>this.emitVertex(n,r,s,a,o),t=(n,r,s,a,o,l)=>this.emitCapVertex(n,r,s,a,o,l);this._extrusionVertexCount=0;for(const n of this.path.vertices)this.originData[3*n.index+0]=n.pos[0],this.originData[3*n.index+1]=n.pos[1],this.originData[3*n.index+2]=n.pos[2];this.startCap.rebuildConnectingProfileGeometry(this.path.vertices[0],this.profile,t);for(let n=1;n<this.path.vertices.length-1;++n)this.extruder.extrude(this.path.vertices[n],this.profile,e);if(this.endCap.rebuildConnectingProfileGeometry(this.path.vertices[this.path.vertices.length-1],this.profile,t),this.startCap.rebuildCapGeometry(this.path.vertices[0],t),this.endCap.rebuildCapGeometry(this.path.vertices[this.path.vertices.length-1],t),this.profile.hasUV()&&this.options.generateUV)for(let n=0;n<this.profile.uvs.length;++n)this.uvData[2*n+0]=this.profile.uvs[n],this.uvData[2*n+1]=0}buildTopology(){const e=this.profile.vertices.length,t=this.profile.numSegments,n=this.numExtrusionProfiles-1;let r=3*(2*(t*n));this.startCap.indexBufferStart=r,this.startCap.firstProfileVertexIndex=0,r+=this.startCap.getNumIndices(),this.endCap.indexBufferStart=r,this.endCap.firstProfileVertexIndex=e*(this.numExtrusionProfiles-1),this.vertexIndices=new Array,this.normalIndices=new Array,this.pathVertexIndices=new Array,this.profile.hasUV()&&this.options.generateUV&&(this.uvIndices=new Array);for(let a=0;a<t;++a){const o=this.profile.vertexIndices[2*a],l=this.profile.vertexIndices[2*a+1];for(let c=0;c<n;++c){const u=c*e+o,d=(c+1)*e+o,h=(c+1)*e+l,p=c*e+l;this.emitTriangle(u,d,h),this.emitTriangle(u,h,p)}}const s=(a,o,l)=>this.emitTriangle(a,o,l);this.startCap.buildTopology(this.path.vertices[0],s),this.endCap.buildTopology(this.path.vertices[this.path.vertices.length-1],s)}onPathChanged(){this._rebuildGeometry()}},zfe=class{constructor(e){this.builder=e}get xform(){return this.builder.path.xform}onPathChanged(){this.builder.onPathChanged()}},Ufe=class extends zfe{constructor(e){super(e),this.vertexAttributePosition=null,this.vertexAttributeNormal=null,this.vertexAttributeColor=null,this.vertexAttributePosition=new Float32Array(3*this.builder.numVerticesTotal),this.vertexAttributeNormal=new Float32Array(3*this.builder.numNormalsTotal),this.vertexAttributeColor=new Uint8Array(4),this.vertexAttributeColor[0]=255,this.vertexAttributeColor[1]=255,this.vertexAttributeColor[2]=255,this.vertexAttributeColor[3]=255}bakeVertexColors(e){this.vertexAttributeColor[0]=255*e[0],this.vertexAttributeColor[1]=255*e[1],this.vertexAttributeColor[2]=255*e[2],this.vertexAttributeColor[3]=255*(e.length>3?e[3]:1)}bake(e){this.size=e;for(let t=0;t<this.builder.numVerticesTotal;++t){let n=this.builder.pathVertexData[t];const r=n===0||n===this.builder.path.vertices.length-1;n*=3;const s=mft;je(s,this.builder.originData[n++],this.builder.originData[n++],this.builder.originData[n]);const a=4*t,o=qd,l=R0,c=qu,u=t8,d=vft;let h=0,p=0;if(je(u,this.builder.profileRightAxisData[a],this.builder.profileRightAxisData[a+1],this.builder.profileRightAxisData[a+2]),je(d,this.builder.profileUpAxisData[a],this.builder.profileUpAxisData[a+1],this.builder.profileUpAxisData[a+2]),Bi(l,this.builder.profileVertexAndNormalData[a]*e[0],this.builder.profileVertexAndNormalData[a+1]*e[1]),r)vi(c,d,u),h=this.builder.profileRightAxisData[a+3]*e[0],p=this.builder.profileUpAxisData[a+3];else{const g=U7,_=gft;Bi(g,this.builder.profileRightAxisData[a+3],this.builder.profileUpAxisData[a+3]);const b=GI(g);my(g,g);const x=cr(l,g);if(Math.abs(x)>b){Bi(_,-g[1],g[0]);const w=cr(l,_);Po(g,g,b*Math.sign(x)),Po(_,_,w),sd(l,g,_)}je(c,0,0,0)}je(o,u[0]*l[0]+d[0]*l[1],u[1]*l[0]+d[1]*l[1],u[2]*l[0]+d[2]*l[1]),this.vertexAttributePosition[3*t+0]=s[0]+o[0]+c[0]*h,this.vertexAttributePosition[3*t+1]=s[1]+o[1]+c[1]*h,this.vertexAttributePosition[3*t+2]=s[2]+o[2]+c[2]*h;const m=R0;Bi(m,this.builder.profileVertexAndNormalData[a+2],this.builder.profileVertexAndNormalData[a+3]),this.vertexAttributeNormal[3*t+0]=u[0]*m[0]+d[0]*m[1]+c[0]*p,this.vertexAttributeNormal[3*t+1]=u[1]*m[0]+d[1]*m[1]+c[1]*p,this.vertexAttributeNormal[3*t+2]=u[2]*m[0]+d[2]*m[1]+c[2]*p}}createGeometryData(){const e=[[j.POSITION,this.builder.vertexIndices],[j.NORMAL,this.builder.normalIndices]],t=[[j.POSITION,{size:3,data:this.vertexAttributePosition,exclusive:!0}],[j.NORMAL,{size:3,data:this.vertexAttributeNormal,exclusive:!0}]];if(this.vertexAttributeColor){const n=this.builder.vertexIndices.length;e.push([j.COLOR,new Array(n).fill(0)]),t.push([j.COLOR,{size:4,data:this.vertexAttributeColor}])}return{vertexAttributes:t,indices:e}}onPathChanged(){super.onPathChanged(),this.bake(this.size)}intersect(e,t,n){const r=this.builder.vertexIndices,s={size:3,data:this.vertexAttributePosition},a=r.length/3;KB(e,t,0,a,r,s,void 0,void 0,n)}},fft=class extends zfe{constructor(e,t,n,r){super(e),this.sizeAttributeValue=t,this.colorAttributeValue=n,this.opacityAttributeValue=r,this.vvData=null,this.baked=new Ufe(e),this.vvData=new Float32Array(4*this.builder.path.vertices.length);for(let s=0;s<this.builder.path.vertices.length;++s){this.vvData[4*s+0]=t,this.vvData[4*s+1]=n,this.vvData[4*s+2]=r;const a=s===0||s===this.builder.path.vertices.length-1;this.vvData[4*s+3]=a?1:0}}createGeometryData(){return{vertexAttributes:[[j.POSITION,{size:3,data:this.builder.originData,exclusive:!0}],[j.PROFILERIGHT,{size:4,data:this.builder.profileRightAxisData,exclusive:!0}],[j.PROFILEUP,{size:4,data:this.builder.profileUpAxisData,exclusive:!0}],[j.PROFILEVERTEXANDNORMAL,{size:4,data:this.builder.profileVertexAndNormalData,exclusive:!0}],[j.FEATUREVALUE,{size:4,data:this.vvData,exclusive:!0}]],indices:[[j.POSITION,this.builder.pathVertexIndices],[j.PROFILERIGHT,this.builder.vertexIndices],[j.PROFILEUP,this.builder.vertexIndices],[j.PROFILEVERTEXANDNORMAL,this.builder.vertexIndices],[j.FEATUREVALUE,this.builder.pathVertexIndices]]}}};const mft=q(),R0=xt(),U7=xt(),gft=xt(),qd=q(),qu=q(),t8=q(),vft=q(),iO=q(),yft=e8(),KQ=St(),Hfe=new Map([[j.POSITION,0],[j.PROFILERIGHT,1],[j.PROFILEUP,2],[j.PROFILEVERTEXANDNORMAL,3],[j.FEATUREVALUE,4]]);let _ft=class extends Pwe{constructor(){super(...arguments),this.ambient=Gt(.2,.2,.2),this.diffuse=Gt(.8,.8,.8),this.specular=Gt(0,0,0),this.opacity=1}},H7=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2,t.spherical=e.viewingMode===Ot.Global,t.doublePrecisionRequiresObfuscation=QL(e.rctx)}initializeProgram(e){return new gn(e.rctx,H7.shader.get().build(this.configuration),Hfe)}initializePipeline(){const e=this.configuration.transparencyPassType,t=this.configuration,n=e===ln.NONE,r=e===ln.FrontFace;return yi({blending:t.output!==Re.Color&&t.output!==Re.Alpha||!t.transparent?null:n?xd:Ly(e),culling:t.hasSlicePlane&&!t.transparent&&t.doubleSidedMode!==$c.None&&vbe,depthTest:{func:Eb(e)},depthWrite:n||r?Lu:null,colorWrite:$i,stencilWrite:t.hasOccludees?Gm:null,stencilTest:t.hasOccludees?Ab:null,polygonOffset:n||r?null:XB})}};H7.shader=new bn(Mwe,()=>Ee(()=>import("./Path.glsl-2c2ca4b2.js"),["./Path.glsl-2c2ca4b2.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./vec3f32-c9aa289f.js","./vec3f64-2f9cef06.js","./VertexAttribute-9c5c630d.js","./mat4-44a0988f.js","./common-c186b691.js","./vec3-a020a6f6.js","./vec2f64-30dc1443.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./context-util-1e3c8cfc.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./promiseUtils-6684e352.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./vec2-2cef68de.js","./Texture2DPassUniform-6e8ae673.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./Normals.glsl-90e28525.js","./TransparencyPassType-cd195b0e.js","./Path.glsl-60b36878.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js"],import.meta.url));let na=class extends yf{constructor(){super(...arguments),this.output=Re.Color,this.doubleSidedMode=$c.None,this.transparencyPassType=ln.NONE,this.spherical=!1,this.receiveShadows=!1,this.receiveAmbientOcclusion=!1,this.vvSize=!1,this.vvColor=!1,this.vvOpacity=!1,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.doublePrecisionRequiresObfuscation=!1}};f([Pe({count:Re.COUNT})],na.prototype,"output",void 0),f([Pe({count:$c.COUNT})],na.prototype,"doubleSidedMode",void 0),f([Pe({count:ln.COUNT})],na.prototype,"transparencyPassType",void 0),f([Pe()],na.prototype,"spherical",void 0),f([Pe()],na.prototype,"receiveShadows",void 0),f([Pe()],na.prototype,"receiveAmbientOcclusion",void 0),f([Pe()],na.prototype,"vvSize",void 0),f([Pe()],na.prototype,"vvColor",void 0),f([Pe()],na.prototype,"vvOpacity",void 0),f([Pe()],na.prototype,"hasSlicePlane",void 0),f([Pe()],na.prototype,"transparent",void 0),f([Pe()],na.prototype,"hasOccludees",void 0),f([Pe()],na.prototype,"hasMultipassTerrain",void 0),f([Pe()],na.prototype,"cullAboveGround",void 0),f([Pe()],na.prototype,"doublePrecisionRequiresObfuscation",void 0),f([Pe({constValue:Ds.Disabled})],na.prototype,"pbrMode",void 0),f([Pe({constValue:!0})],na.prototype,"hasVvInstancing",void 0),f([Pe({constValue:!1})],na.prototype,"useCustomDTRExponentForWater",void 0),f([Pe({constValue:!1})],na.prototype,"useFillLights",void 0);let Gfe=class extends ug{constructor(e){super(e,new wft),this.supportsEdges=!0,this._vertexAttributeLocations=Hfe,this._configuration=new na,this._vertexBufferLayout=Gfe.getVertexBufferLayout(this.parameters)}getConfiguration(e,t){return this._configuration.output=e,this._configuration.vvSize=this.parameters.vvSizeEnabled,this._configuration.vvColor=this.parameters.vvColorEnabled,this._configuration.vvOpacity=this.parameters.vvOpacityEnabled,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.hasOccludees=this.parameters.hasOccludees,e!==Re.Color&&e!==Re.Alpha||(this._configuration.doubleSidedMode=this.parameters.doubleSided&&this.parameters.doubleSidedType==="normal"?$c.View:this.parameters.doubleSided&&this.parameters.doubleSidedType==="winding-order"?$c.WindingOrder:$c.None,this._configuration.receiveShadows=this.parameters.receiveShadows,this._configuration.receiveAmbientOcclusion=!!t.ssaoHelper.ready&&this.parameters.receiveSSAO),this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}isVisibleForOutput(e){return e!==Re.Shadow&&e!==Re.ShadowExludeHighlight&&e!==Re.ShadowHighlight||this.parameters.castShadows}isVisible(){return super.isVisible()&&this.parameters.opacity>0}intersect(e,t,n,r,s,a,o){const l=e;if(!Vfe(l))return;const c=l.path,u=[this.parameters.size[0],this.parameters.size[1]];if(this.parameters.vvSizeEnabled){const b=this.parameters.vvSizeOffset,x=this.parameters.vvSizeFactor,w=this.parameters.vvSizeMinSize,C=this.parameters.vvSizeMaxSize,S=c.sizeAttributeValue;u[0]*=lt(b[0]+S*x[0],w[0],C[0]),u[1]*=lt(b[2]+S*x[2],w[2],C[2])}const d=Math.max(u[0],u[1]),h=e.boundingInfo;if(B(h))return void this._intersectTriangles(c,u,s,a,o);const p=r5(h.bbMin[0]-d,h.bbMin[1]-d,h.bbMin[2]-d,h.bbMax[0]+d,h.bbMax[1]+d,h.bbMax[2]+d),m=[a[0]-s[0],a[1]-s[1],a[2]-s[2]],g=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]),_=[g/m[0],g/m[1],g/m[2]];$ne(p,s,_,r.tolerance)&&this._intersectTriangles(c,u,s,a,o)}_intersectTriangles(e,t,n,r,s){e.baked.size&&e.baked.size[0]===t[0]&&e.baked.size[1]===t[1]||e.baked.bake(t),e.baked.intersect(n,r,s)}computeAttachmentOrigin(e,t){const n=e.vertexAttributes;if(!n)return null;const r=n.get(j.POSITION);return QB(r,null,!1,t)}createBufferWriter(){return new xft(this._vertexBufferLayout)}requiresSlot(e,t){switch(t){case Re.Shadow:case Re.ShadowHighlight:case Re.ShadowExludeHighlight:if(!this.parameters.castShadows)return!1;case Re.Color:case Re.Alpha:case Re.Depth:case Re.Normal:case Re.Highlight:case Re.ObjectAndLayerIdColor:return e===(this.parameters.transparent?at.TRANSPARENT_MATERIAL:at.OPAQUE_MATERIAL)||e===at.DRAPED_MATERIAL;default:return!1}}createGLMaterial(e){return new bft(e)}static getVertexBufferLayout(e){const t=Js().vec3f(j.POSITION).vec4f(j.PROFILERIGHT).vec4f(j.PROFILEUP).vec4f(j.PROFILEVERTEXANDNORMAL);return(e.vvColorEnabled||e.vvSizeEnabled||e.vvOpacityEnabled)&&t.vec4f(j.FEATUREVALUE),t}},bft=class extends Sb{_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}_updateShadowState(e){(B(this.technique)||e.shadowMap.enabled!==this.technique.configuration.receiveShadows)&&this._material.setParameters({receiveShadows:e.shadowMap.enabled})}beginSlot(e){return this._output!==Re.Color&&this._output!==Re.Alpha||(this._updateShadowState(e),this._updateOccludeeState(e)),this.ensureTechnique(H7,e)}},wft=class extends _ft{constructor(){super(...arguments),this.doubleSided=!1,this.doubleSidedType="normal",this.receiveSSAO=!0,this.receiveShadows=!1,this.castShadows=!0,this.hasSlicePlane=!1,this.transparent=!1,this.hasOccludees=!1}},xft=class{constructor(e){this.vertexBufferLayout=e}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(j.POSITION).length}write(e,t,n,r,s){nO(j.PROFILERIGHT,n,r,s),nO(j.PROFILEUP,n,r,s),nO(j.PROFILEVERTEXANDNORMAL,n,r,s),this.vertexBufferLayout.hasField(j.FEATUREVALUE)&&nO(j.FEATUREVALUE,n,r,s),ez(n,this.vertexBufferLayout,e,t,r,s)}};function nO(i,e,t,n){if(e.vertexAttributes.has(i)){const r=e.vertexAttributes.get(i),s=e.indices.get(i);Ti(r.size===4);const a=t.getField(i,Wm);if(!a)throw new Error("unable to acquire view for "+i);g2(s,r.data,a,n)}}const Cft=["polyline"];let Tft=class extends xf{constructor(e,t,n,r){super(e,t,n,r),this._intrinsicSize=dn(1,1),this._upVectorAlignment="path",this._stencilWidth=.1,this.ensureDrapedStatus(!1)}async doLoad(){const e=T(this.symbolLayer.width)?this.symbolLayer.width:this.symbolLayer.height,t=T(this.symbolLayer.height)?this.symbolLayer.height:e;this._vvConvertOptions={modelSize:[1,1,1],symbolSize:[e,1,t],unitInMeters:this._context.renderCoordsHelper.unitInMeters,transformation:{anchor:[0,0,0],scale:[1,1,1],rotation:[0,0,0]},supportedTypes:{size:!0,color:!0,opacity:!0,rotation:!1}},this._context.renderer&&this._context.renderer.visualVariables&&this._context.renderer.visualVariables.length>0?this._fastUpdates=CA(this._context.renderer,this._vvConvertOptions):this._fastUpdates={enabled:!1};const n=this.symbolLayer.anchor||"center";this._upVectorAlignment="path",this.symbolLayer.profileRotation==="heading"&&(this._upVectorAlignment="world");const r=this.symbolLayer.profile||"circle";switch(r){case"circle":default:this._profile=lL.circle(Pft);break;case"quad":this._profile=lL.rect()}let s=[0,0];switch(n!=="center"&&(s={left:[.5,0],right:[-.5,0],top:[0,-.5],bottom:[0,.5]}[n],this._profile.translate(s[0],s[1])),this.symbolLayer.join||"simple"){case"round":this._extruder=new _4(0,Mft);break;case"bevel":this._extruder=new _4(0,1);break;case"miter":this._extruder=new _4(.8*Math.PI,1);break;default:this._extruder=new dft}const a=this.symbolLayer.cap||"butt";switch(a){case"none":this._startCap=new jQ,this._endCap=new jQ;break;case"butt":default:this._startCap=new tO(this._profile,0),this._endCap=new tO(this._profile,0,!0);break;case"square":this._startCap=new tO(this._profile,-.5),this._endCap=new tO(this._profile,.5,!0);break;case"round":{const p=r==="quad";this._startCap=new qQ({profile:this._profile,flip:!1,breakNormals:p,subdivisions:ZQ}),this._endCap=new qQ({profile:this._profile,flip:!0,breakNormals:p,subdivisions:ZQ});break}}const o=ms(this.symbolLayer,"material","color"),l=this._getCombinedOpacityAndColor(o),c=gu(l),u=l[3],d=u<1||this.needsDrivenTransparentPass,h={diffuse:c,ambient:c,opacity:u,transparent:d,hasVertexColors:!1,hasSlicePlane:this._context.slicePlaneEnabled,castShadows:this.symbolLayer.castShadows,cullFace:d||a==="none"?qs.None:qs.Back,offsetTransparentBackfaces:!0};if(!this._drivenProperties.size&&(Bi(this._intrinsicSize,e,t),!tL(this._intrinsicSize[0])||!tL(this._intrinsicSize[1])))throw new Ze("graphics3dpathsymbollayer:invalid-size","Symbol sizes may not be negative values");if(this._fastUpdates.enabled&&this._fastUpdates.visualVariables.size||Po(this._intrinsicSize,this._intrinsicSize,1/this._context.renderCoordsHelper.unitInMeters),this._fastUpdates.enabled){const p={...h,...this._fastUpdates.materialParameters,size:Zie(this._intrinsicSize)};this._material=new Gfe(p)}else h.hasVertexColors=this._drivenProperties.color||this._drivenProperties.opacity,this._material=new v2(h);this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),this._context.stage.add(this._material)}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,Cft,this.symbolLayer.type))return null;const n=this.setGraphicElevationContext(t,new Dd),r=e.renderingInfo;return this._createAs3DShape(t,r,n,t.uid)}layerOpacityChanged(){const e=ms(this.symbolLayer,"material","color"),t=this._getCombinedOpacity(e),n=t<1||this.needsDrivenTransparentPass;this._material.setParameters({opacity:t,transparent:n})}layerElevationInfoChanged(e,t){return this.updateGraphics3DGraphicElevationInfo(e,t,Iy)}slicePlaneEnabledChanged(){return this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return this._material.setParameters({usePBR:this._context.physicalBasedRenderingEnabled,isSchematic:!0}),!0}pixelRatioChanged(){return!0}applyRendererDiff(e,t){for(const n in e.diff){if(n!=="visualVariables"||!TA(this._fastUpdates,t,this._vvConvertOptions))return Ns.Recreate_Symbol;this._material.setParameters(this._fastUpdates.materialParameters)}return Ns.Fast_Update}getVertexData(e){let t=0;const n=e.paths,r=[],s=e.spatialReference,a=this._context.elevationProvider.spatialReference,o=this._context.renderCoordsHelper.spatialReference;for(const p of n)t+=p.length;const l=new Float64Array(3*t),c=new Float64Array(3*t),u=new Float64Array(3*t);let d=0;for(const p of n){r.push({index:d,numVertices:p.length});for(const m of p)l[d++]=m[0],l[d++]=m[1],l[d++]=e.hasZ?m[2]:0}let h=!0;return T(a)&&!s.equals(a)?h=Kl(l,s,0,c,a,0,t):this._copyVertices(l,0,c,0,t),T(a)&&!a.equals(o)?Kl(c,a,0,u,o,0,t):this._copyVertices(c,0,u,0,t),{pathVertexDataInfos:r,vertexDataGS:l,vertexDataES:c,vertexDataRS:u,projectionSuccess:h,terrainElevation:0}}_copyVertices(e,t,n,r,s){t*=3,r*=3;for(let a=0;a<s;++a)n[r++]=e[t++],n[r++]=e[t++],n[r++]=e[t++]}_createAs3DShape(e,t,n,r){const s=e.geometry,a=new Array,o=new Array,l=new Array,c=s.spatialReference,u=Go(),d=this._context.renderCoordsHelper;jfe.spatialReference=c;const h=this.getVertexData(s);if(!h.projectionSuccess)return this.logger.warn("PathSymbol3DLayer geometry failed to be created (failed to project geometry to view spatial reference)"),null;if(h.pathVertexDataInfos.length>0){for(let p=0;p<h.pathVertexDataInfos.length;++p){const m=h.pathVertexDataInfos[p],g=m.index,_=m.numVertices;if(_<2||T(this._context.clippingExtent)&&(fr(u),Au(u,h.vertexDataES,3*g,_),!fh(u,this._context.clippingExtent)))continue;const b=[];for(let O=g;O<g+3*_;){const M=O++,V=O++,L=O++,U=new lft;je(U.posGS,h.vertexDataGS[M],h.vertexDataGS[V],h.vertexDataGS[L]),je(U.posES,h.vertexDataES[M],h.vertexDataES[V],h.vertexDataES[L]);const G=fut(U.posES,this._context.elevationProvider,n,d);je(fd,h.vertexDataRS[M],h.vertexDataRS[V],h.vertexDataRS[L]),d.setAltitude(fd,G),je(U.pos,fd[0],fd[1],fd[2]),b.push(U)}const x=new cft(b);Wfe(x,this._upVectorAlignment,this._context.renderCoordsHelper);const w=new pft(x,this._profile,this._extruder,this._startCap,this._endCap);let C=null;if(this._fastUpdates.enabled){const O=this._fastUpdates.visualVariables,M=O.size?$m(O.size.field,e):0,V=O.color?$m(O.color.field,e):0,L=O.opacity?$m(O.opacity.field,e):0;C=new fft(w,M,V,L)}else{const O=[this._intrinsicSize[0],this._intrinsicSize[1]];this._drivenProperties.size&&(O[0]*=YQ(t.size[0],t.size[2]==="symbol-value"?this.symbolLayer.height||0:t.size[2],this.symbolLayer.width||0),O[1]*=YQ(t.size[2],t.size[0]==="symbol-value"?this.symbolLayer.width||0:t.size[0],this.symbolLayer.height||0));let M=null;this._drivenProperties.color&&(M=t.color),this._drivenProperties.opacity&&t.opacity!=null&&(M=M?[M[0],M[1],M[2],t.opacity]:[1,1,1,t.opacity]);const V=new Ufe(w);V.bake(O),M&&V.bakeVertexColors(M),C=V}const{vertexAttributes:S,indices:E}=C.createGeometryData(),A=this._context.stage.renderView._getObjectAndLayerIdColor({graphicUid:r,layerUid:this._context.layer.uid}),P=new ift(S,E,C,c,this._upVectorAlignment,this._stencilWidth,A);a.push(P),o.push(this._material),l.push(C.xform)}if(a.length>0){const p={layerUid:this._context.layer.uid,graphicUid:r},m=new xg({geometries:a,materials:o,transformations:l,metadata:p}),g=new wf(this,m,a,null,null,Eft,n);return g.alignedSampledElevation=h.terrainElevation,g.needsElevationUpdates=Iy(n.mode),g}}else s.paths.length!==0&&s.paths.some(p=>p.length>0)||this.logger.warn("PathSymbol3DLayer geometry failed to be created (no paths were defined)");return null}};function Wfe(i,e,t){switch(e){case"world":for(const n of i.vertices)rt(Jh,n.pos,i.offset),t.worldUpAtPosition(Jh,fd),n.setFrameFromUpVector(fd),n.computeRotationAxisAndAngleFromUpVector();break;case"path":rt(Jh,i.vertices[0].pos,i.offset),t.worldUpAtPosition(Jh,fd),uft(i,fd);for(const n of i.vertices){const r=Math.sign(dt(n.frame.right,n.vRight));vi(n.rotationFrame.up,n.vRight,n.vLeft),Ye(n.rotationFrame.up,n.rotationFrame.up,r),mt(n.rotationFrame.up,n.rotationFrame.up);const s=dt(n.rotationFrame.up,n.frame.up),a=dt(n.rotationFrame.up,n.frame.right);if(Ye(Jh,n.frame.up,-a),Ye(XQ,n.frame.right,s),rt(Jh,Jh,XQ),mt(n.rotationFrame.right,Jh),oft(n.rotationRight,n.frame,n.rotationFrame.right),No(Jh,n.vLeft),n.rotationAngle=-r*(Math.PI-Uo(dt(Jh,n.vRight))),Math.abs(n.rotationAngle)>0){const l=IN(Math.cos(.5*n.rotationAngle));B7(n.miterStretch,1+(l-1)*n.rotationRight[0]*n.rotationRight[0],(l-1)*n.rotationRight[0]*n.rotationRight[1],(l-1)*n.rotationRight[0]*n.rotationRight[1],1+(l-1)*n.rotationRight[1]*n.rotationRight[1])}const o=Math.PI-n.rotationAngle;n.maxStretchDistance=Math.abs(Math.min(n.vLeftLength,n.vRightLength)*IN(Math.cos(.5*o)))}}}function YQ(i,e,t){switch(i){case"symbol-value":return t;case"proportional":return e;default:return i}}function Sft(i,e,t,n){let r=0;for(const s of i.vertices)tg(s.posES,t,e,n,b4),r+=b4.sampledElevation,rt(fd,s.pos,i.offset),n.setAltitude(fd,b4.z),nt(s.pos,fd,i.offset);return i.updatePathVertexInformation(),r/i.vertices.length}function Eft(i,e,t,n){const r=i.stageObject,s=r.geometryRecords;let a=0;Aft.spatialReference=n.spatialReference;for(const o of s){const l=o.geometry;if(!Vfe(l))continue;const c=l.path,u=c.builder.path,d=l.geometrySR;jfe.spatialReference=d,a+=Sft(u,e,t,n),l.upVectorAlignment!=="world"&&Wfe(u,l.upVectorAlignment,n),c.onPathChanged(),l.invalidateBoundingInfo(),r.geometryVertexAttrsUpdated(o)}return a/s.length}const Aft=Id(0,0,0,null),jfe=Id(0,0,0,null),fd=q(),Jh=wr(),XQ=wr(),b4=new _M,Mft=3,ZQ=3,Pft=10;function Oft(i,e,t,n,r=1){if(t.isGeographic&&n===Ot.Global){const o=new Float64Array(e.typedBuffer.length),l=3*e.count,c=rn(t);for(let u=0;u<l;u+=3)Cie(e.typedBuffer,u,o,u,c);e=wy.fromTypedArray(o)}Bi($s,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);for(let o=0;o<e.count;o++)e.getVec(o,Pc),$s[0]=Math.min($s[0],Pc[0]),$s[1]=Math.min($s[1],Pc[1]);const s=$s[0]%r,a=$s[1]%r;ud[0]=$s[0]-s,ud[1]=$s[1]-a;for(let o=0;o<e.count;o++)e.getVec(o,Pc),i.setValues(o,(Pc[0]-ud[0])/r,(Pc[1]-ud[1])/r,ud[0]/r,ud[1]/r)}function qfe(i,e,t,n,r=1){je(f_,1,0,0),je(m_,0,1,0),je(M1,0,0,1),$ft(w4,e),Rft(e,QQ)&&Ift(QQ,f_,m_,M1,t,w4),Bi($s,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),Bi(g_,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(let l=0;l<e.count;l++){e.getVec(l,Pc);const c=dt(f_,Pc),u=dt(m_,Pc);$s[0]=Math.min($s[0],c),$s[1]=Math.min($s[1],u),g_[0]=Math.max(g_[0],c),g_[1]=Math.max(g_[1],u)}const s=dt(M1,w4);C4(Wg,$s[0],$s[1],s,f_,m_,M1),C4(v_,g_[0],$s[1],s,f_,m_,M1),C4(y_,$s[0],g_[1],s,f_,m_,M1),nt(v_,v_,Wg),Ye(v_,v_,.5),nt(y_,y_,Wg),Ye(y_,y_,.5),rt(Wg,Wg,v_),rt(Wg,Wg,y_);const a=$s[0]%r,o=$s[1]%r;ud[0]=$s[0]-a,ud[1]=$s[1]-o;for(let l=0;l<e.count;l++){e.getVec(l,Pc),i.setValues(l,(dt(f_,Pc)-ud[0])/r,(dt(m_,Pc)-ud[1])/r,ud[0]/r,ud[1]/r);for(let c=0;c<3;c++)n.set(l,c,Wg[c]),n.set(l,c+3,v_[c]),n.set(l,c+6,y_[c])}}const w4=q(),Pc=q(),QQ=Dr(),f_=q(),m_=q(),M1=q(),$s=xt(),g_=xt(),ud=xt(),Wg=q(),v_=q(),y_=q();function Rft(i,e){const t=i.count-1;return G0e(i,e,0,Math.floor(t/3),Math.floor(t*(2/3)))}function Ift(i,e,t,n,r,s){T(r)?(r.basisMatrixAtPosition(s,ep),je(rO,ep[0],ep[1],ep[2]),je(sO,ep[4],ep[5],ep[6]),je(x4,ep[8],ep[9],ep[10])):(je(rO,1,0,0),je(sO,0,1,0),je(x4,0,0,1));const a=ro(i);dt(a,x4)<0&&Ye(a,a,-1),Ge(n,a);const o=dt(a,sO),l=dt(a,rO);Math.abs(o)<Math.abs(l)?(gy(e,rO,a,-l),mt(e,e),vi(t,e,a),mt(t,t),Ye(t,t,-1)):(gy(t,sO,a,-o),mt(t,t),vi(e,t,a),mt(e,e))}const ep=St(),rO=q(),sO=q(),x4=q();function $ft(i,e){je(aO,0,0,0);for(let t=0;t<e.count-1;t++)e.getVec(t,Pc),rt(aO,aO,Pc);Ye(i,aO,1/(e.count-1))}const aO=q();function C4(i,e,t,n,r,s,a){je(i,e*r[0]+t*s[0]+n*a[0],e*r[1]+t*s[1]+n*a[1],e*r[2]+t*s[2]+n*a[2])}let G7=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,G7.shader.get().build(this.configuration),Mn)}_createPipeline(e,t){const n=this.configuration,r=e===ln.NONE,s=e===ln.FrontFace;return yi({blending:n.output!==Re.Color&&n.output!==Re.Alpha||!n.transparent?null:r?xd:Ly(e),culling:jB(n.cullFace),depthTest:{func:Eb(e)},depthWrite:r||s?n.writeDepth&&Lu:null,colorWrite:$i,stencilWrite:n.hasOccludees?Gm:null,stencilTest:n.hasOccludees?t?ib:Ab:null,polygonOffset:r||s?n.polygonOffset&&Lft:JB(n.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._createPipeline(this.configuration.transparencyPassType,!0),this._createPipeline(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};G7.shader=new bn(Owe,()=>Ee(()=>import("./ColorMaterial.glsl-8cfd20f5.js"),["./ColorMaterial.glsl-8cfd20f5.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./vec3f32-c9aa289f.js","./vec3f64-2f9cef06.js","./VertexAttribute-9c5c630d.js","./mat4-44a0988f.js","./common-c186b691.js","./vec3-a020a6f6.js","./vec4f64-e407da96.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./TransparencyPassType-cd195b0e.js","./ColorMaterial.glsl-8310ffb3.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./VertexColor.glsl-db21b96c.js","./OutputDepth.glsl-179f1d8f.js","./RgbaFloatEncoding.glsl-6036ca34.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./ReadLinearDepth.glsl-7ff30f7d.js","./AlphaCutoff-96178e0d.js","./Float4PassUniform-3a47b7b3.js"],import.meta.url));const Lft={factor:1,units:1};let vc=class extends yf{constructor(){super(...arguments),this.output=Re.Color,this.cullFace=qs.None,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.transparent=!1,this.polygonOffset=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=ln.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.objectAndLayerIdColorInstanced=!1}};f([Pe({count:Re.COUNT})],vc.prototype,"output",void 0),f([Pe({count:qs.COUNT})],vc.prototype,"cullFace",void 0),f([Pe()],vc.prototype,"hasSlicePlane",void 0),f([Pe()],vc.prototype,"hasVertexColors",void 0),f([Pe()],vc.prototype,"transparent",void 0),f([Pe()],vc.prototype,"polygonOffset",void 0),f([Pe()],vc.prototype,"enableOffset",void 0),f([Pe()],vc.prototype,"writeDepth",void 0),f([Pe()],vc.prototype,"hasOccludees",void 0),f([Pe({count:ln.COUNT})],vc.prototype,"transparencyPassType",void 0),f([Pe()],vc.prototype,"hasMultipassTerrain",void 0),f([Pe()],vc.prototype,"cullAboveGround",void 0),f([Pe()],vc.prototype,"objectAndLayerIdColorInstanced",void 0);let JQ=class extends ug{constructor(e){super(e,new kft),this.supportsEdges=!0,this._configuration=new vc}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<tz,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,n,r,s,a,o){qB(e,t,r,s,a,void 0,o)}requiresSlot(e,t){return t===Re.Color||t===Re.Alpha||t===Re.Highlight||t===Re.Depth&&this.parameters.writeLinearDepth||t===Re.ObjectAndLayerIdColor?e===at.DRAPED_MATERIAL?!0:t===Re.Highlight?e===at.OPAQUE_MATERIAL:e===(this.parameters.transparent?this.parameters.writeDepth?at.TRANSPARENT_MATERIAL:at.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:at.OPAQUE_MATERIAL):!1}createGLMaterial(e){return new Dft(e)}createBufferWriter(){return new _D(Fi("enable-feature:objectAndLayerId-rendering")?Pdt:bfe)}},Dft=class extends Sb{_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==Re.Color&&this._output!==Re.Alpha||this._updateOccludeeState(e),this.ensureTechnique(G7,e)}},kft=class extends YA{constructor(){super(...arguments),this.color=ox,this.transparent=!1,this.writeDepth=!0,this.writeLinearDepth=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=qs.None,this.hasOccludees=!1}},W7=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,W7.shader.get().build(this.configuration),Kfe)}_setPipelineState(e,t){const n=this.configuration,r=e===ln.NONE,s=e===ln.FrontFace;return yi({blending:n.output===Re.Color||n.output===Re.Alpha?r?xd:Ly(e):null,culling:jB(n.cullFace),depthTest:{func:Eb(e)},depthWrite:r?n.writeDepth&&Lu:JL(e),colorWrite:$i,stencilWrite:n.hasOccludees?Gm:null,stencilTest:n.hasOccludees?t?ib:Ab:null,polygonOffset:r||s?n.polygonOffset&&Fft:JB(n.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}};W7.shader=new bn(Rwe,()=>Ee(()=>import("./Pattern.glsl-0e8e50f1.js"),["./Pattern.glsl-0e8e50f1.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./vec3f32-c9aa289f.js","./vec3f64-2f9cef06.js","./VertexAttribute-9c5c630d.js","./mat4-44a0988f.js","./common-c186b691.js","./vec3-a020a6f6.js","./vec4f64-e407da96.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./TransparencyPassType-cd195b0e.js","./Pattern.glsl-d3388745.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./VertexColor.glsl-db21b96c.js","./OutputDepth.glsl-179f1d8f.js","./RgbaFloatEncoding.glsl-6036ca34.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./ReadLinearDepth.glsl-7ff30f7d.js","./AlphaCutoff-96178e0d.js","./Float4PassUniform-3a47b7b3.js","./FloatPassUniform-d2dfc562.js"],import.meta.url));const Fft={factor:1,units:1};let Jo=class extends yf{constructor(){super(...arguments),this.output=Re.Color,this.cullFace=qs.None,this.transparencyPassType=ln.NONE,this.hasSlicePlane=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.writeDepth=!0,this.hasOccludees=!1,this.enableOffset=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}};f([Pe({count:Re.COUNT})],Jo.prototype,"output",void 0),f([Pe({count:qs.COUNT})],Jo.prototype,"cullFace",void 0),f([Pe({count:Iv.COUNT})],Jo.prototype,"style",void 0),f([Pe({count:ln.COUNT})],Jo.prototype,"transparencyPassType",void 0),f([Pe()],Jo.prototype,"hasSlicePlane",void 0),f([Pe()],Jo.prototype,"hasVertexColors",void 0),f([Pe()],Jo.prototype,"polygonOffset",void 0),f([Pe()],Jo.prototype,"writeDepth",void 0),f([Pe()],Jo.prototype,"hasOccludees",void 0),f([Pe()],Jo.prototype,"patternSpacing",void 0),f([Pe()],Jo.prototype,"lineWidth",void 0),f([Pe()],Jo.prototype,"enableOffset",void 0),f([Pe()],Jo.prototype,"draped",void 0),f([Pe()],Jo.prototype,"hasMultipassTerrain",void 0),f([Pe()],Jo.prototype,"cullAboveGround",void 0);const Kfe=new Map([[j.POSITION,0],[j.COLOR,3],[j.UVMAPSPACE,4],[j.BOUNDINGRECT,5]]);let j7=class extends ug{constructor(e){super(e,new Bft),this.supportsEdges=!0,this._vertexAttributeLocations=Kfe,this._configuration=new Jo}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasVertexColors=this.parameters.hasVertexColors,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.style=this.parameters.style,this._configuration.patternSpacing=this.parameters.patternSpacing,this._configuration.lineWidth=this.parameters.lineWidth,this._configuration.draped=this.parameters.draped,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<tz,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,n,r,s,a,o){qB(e,t,r,s,a,void 0,o)}requiresSlot(e,t){return t===Re.Color||t===Re.Alpha||t===Re.Highlight||t===Re.Depth&&this.parameters.writeLinearDepth?e===at.DRAPED_MATERIAL?!0:t===Re.Highlight?e===at.OPAQUE_MATERIAL:e===(this.parameters.writeDepth?at.TRANSPARENT_MATERIAL:at.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL):!1}createGLMaterial(e){return new Nft(e)}createBufferWriter(){const e=Js().vec3f(j.POSITION).vec4u8(j.COLOR).vec4f(j.UVMAPSPACE);return this.parameters.draped||e.mat3f(j.BOUNDINGRECT),new Vft(e)}},Nft=class extends Sb{_updateParameters(e){return this.ensureTechnique(W7,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&this._material.setParameters({hasOccludees:e.hasOccludees})}beginSlot(e){return this._output!==Re.Color&&this._output!==Re.Alpha||this._updateOccludeeState(e),this._updateParameters(e)}},Vft=class extends _D{write(e,t,n,r,s){for(const a of this.vertexBufferLayout.fieldNames){const o=n.vertexAttributes.get(a),l=n.indices.get(a);if(o&&l)switch(a){case j.POSITION:{Ti(o.size===3);const c=r.getField(a,xy);c&&YB(l,o.data,e,c,s);break}case j.COLOR:{Ti(o.size===3||o.size===4);const c=r.getField(a,by);c&&Gne(l,o.data,o.size,c,s);break}case j.UVMAPSPACE:{Ti(o.size===4);const c=r.getField(a,Wm);c&&g2(l,o.data,c,s);break}case j.BOUNDINGRECT:{Ti(o.size===9);const c=r.getField(a,b2);c&&this.writeBoundingRect(l,o.data,e,c,s);break}}}}writeBoundingRect(e,t,n,r,s){const a=n,o=r.typedBuffer,l=r.typedBufferStride,c=e.length;s*=l;for(let u=0;u<c;++u){const d=9*e[u],h=t[d],p=t[d+1],m=t[d+2];o[s]=a[0]*h+a[4]*p+a[8]*m+a[12],o[s+1]=a[1]*h+a[5]*p+a[9]*m+a[13],o[s+2]=a[2]*h+a[6]*p+a[10]*m+a[14];for(let g=3;g<9;++g)o[s+g]=t[d+g];s+=l}}},Bft=class extends YA{constructor(){super(...arguments),this.color=Xn(1,1,1,1),this.writeDepth=!0,this.writeLinearDepth=!1,this.hasVertexColors=!1,this.polygonOffset=!1,this.hasSlicePlane=!1,this.cullFace=qs.None,this.hasOccludees=!1,this.style=Iv.Cross,this.patternSpacing=10,this.lineWidth=1,this.draped=!0}};function zft(i,e,t){return Hft(Uft(i),e,t)}function Uft(i){return i&&i.pattern||null}function Hft(i,e,t){return T(i)?i.style==="none"||i.style==="solid"?(i.style==="none"&&(e.color=Xn(0,0,0,0),e.transparent=!0),new JQ(e)):(e.style=Gft(i.style),e.draped=t.isDraped,new j7(e)):new JQ(e)}function Gft(i){switch(i){case"horizontal":return Iv.Horizontal;case"vertical":return Iv.Vertical;case"cross":return Iv.Cross;case"forward-diagonal":return Iv.ForwardDiagonal;case"backward-diagonal":return Iv.BackwardDiagonal;case"diagonal-cross":return Iv.DiagonalCross;default:return}}function Wft(i){return i.material instanceof j7&&!i.material.parameters.draped}function jft(i,e){if(Wft(i)){const t=i.geometry.vertexAttributes,n=t.get(j.POSITION).data,r=t.get(j.UVMAPSPACE).data,s=t.get(j.BOUNDINGRECT).data;qfe(Wm.fromTypedArray(r),wy.fromTypedArray(n),e,rre.fromTypedArray(s))}}function qft(i,e,t,n){const r=efe(i,e,t,n),s=i.stageObject.geometryRecords;for(let a=0;a<s.length;a++)jft(s[a],n);return r}const Kft=["polyline","polygon","extent"];let q7=class extends xf{constructor(e,t,n,r){super(e,t,n,r),this._needsUV=!1,this._hasOutline=!1}async doLoad(){}_ensureMaterials(){this._ensureFillMaterial(),this._ensureOutlineMaterial()}_ensureFillMaterial(){if(T(this._material))return;const e=ms(this.symbolLayer,"material","color"),t=this._getCombinedOpacityAndColor(e);this._material=zft(this.symbolLayer,{color:t,transparent:t[3]<1||this.needsDrivenTransparentPass,polygonOffset:!1,hasVertexColors:!0,writeLinearDepth:!0,hasSlicePlane:this._context.slicePlaneEnabled},{isDraped:this.draped}),this._needsUV=this._material instanceof j7,this._context.stage.add(this._material)}_ensureOutlineMaterial(){const e=this.symbolLayer.outline;if(T(this._outlineMaterial)||!this._isValidOutline(e))return;this._hasOutline=!0;const t=n=>{const r=Dfe(e.pattern);return new Kw({width:n,color:this._getOutlineColor(),hasPolygonOffset:!0,hasSlicePlane:this._context.slicePlaneEnabled,isClosed:!0,stipplePattern:r,stippleScaleWithLineWidth:!0,cap:Q6(e.patternCap||"butt")})};this._outlineMaterial=t(Hn(e.size)),this._context.stage.add(this._outlineMaterial)}_isValidOutline(e){return T(e)&&e.size&&e.size>0&&T(e.color)&&(B(e.pattern)||e.pattern.type!=="style"||e.pattern.style!=="none")}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null,this._context.stage.remove(this._outlineMaterial),this._outlineMaterial=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,Kft,this.symbolLayer.type))return null;const n=this._getVertexOpacityAndColor(e.renderingInfo,255),r=this.setGraphicElevationContext(t,new Dd);return this.ensureDrapedStatus(r.mode==="on-the-ground"),this._ensureMaterials(),this.draped?this._createAsOverlay(t,n):this._createAs3DShape(t,n,r)}layerOpacityChanged(){if(T(this._material)){const e=this._material.parameters.color,t=ms(this.symbolLayer,"material","color"),n=this._getCombinedOpacity(t);this._material.setParameters({color:[e[0],e[1],e[2],n],transparent:n<1||this.needsDrivenTransparentPass})}if(T(this._outlineMaterial)){const e=this._outlineMaterial.parameters.color;this._outlineMaterial.setParameters({color:[e[0],e[1],e[2],this._getOutlineOpacity()]})}}layerElevationInfoChanged(e,t,n){const r=this._elevationContext.mode,s=yM(q7.elevationModeChangeTypes,n,r);if(s!==Fr.UPDATE)return s;const a=Rd(r);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){if(T(this._material)&&this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),T(this._outlineMaterial)){const e={hasSlicePlane:this._context.slicePlaneEnabled};this._outlineMaterial.setParameters(e)}return!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_createAs3DShape(e,t,n){var u;const r=xA(e.geometry);if(B(r))return null;const s=D7(r,this._context.elevationProvider,this._context.renderCoordsHelper,n),a=new Yft(s,t,this._context.layer.uid,e.uid),o=a.renderData.position.length/3;if(this._needsUV&&(a.uvMapSpace=new Float32Array(4*o),a.boundingRect=new Float64Array(9*o)),a.objectAndLayerIdColor=(u=this._context.stage.renderView)==null?void 0:u._getObjectAndLayerIdColor({graphicUid:a.graphicsUid,layerUid:a.layerUid}),this._createAs3DShapeFill(a),this._hasOutline&&this._createAs3DShapeOutline(a),this._logGeometryCreationWarnings(a.renderData,r.rings,"rings","FillSymbol3DLayer"),a.outGeometries.length===0)return null;this._needsUV&&qfe(Wm.fromTypedArray(a.uvMapSpace),wy.fromTypedArray(a.renderData.position),this._context.renderCoordsHelper,rre.fromTypedArray(a.boundingRect));const l=new xg({geometries:a.outGeometries,materials:a.outMaterials,transformations:a.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:e.uid}}),c=new wf(this,l,a.outGeometries,null,null,qft,n);return c.alignedSampledElevation=a.renderData.sampledElevation,c.needsElevationUpdates=Rd(n.mode),c}_createAs3DShapeFill(e){const t=e.renderData.polygons;for(const{position:n,mapPosition:r,holeIndices:s,index:a,count:o}of t){if(T(this._context.clippingExtent)&&(fr(Ko),Au(Ko,r),!fh(Ko,this._context.clippingExtent)))continue;const l=w2(r,s,3);if(l.length===0)continue;const c=GZ({indices:l,attributeData:{position:n,color:e.color,mapPosition:r,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*a*e.uvMapSpace.BYTES_PER_ELEMENT,4*o):null,boundingRect:this._needsUV?new Float64Array(e.boundingRect.buffer,9*a*e.boundingRect.BYTES_PER_ELEMENT,9*o):null,objectAndLayerIdColor:e.objectAndLayerIdColor}});e.outGeometries.push(c),e.outMaterials.push(kt(this._material)),e.outTransforms.push(Ks)}}_createAs3DShapeOutline(e){if(!this._hasOutline)return;const t=e.renderData.outlines;for(let n=0;n<t.length;++n){const{mapPosition:r,position:s}=t[n];if(T(this._context.clippingExtent)&&(fr(Ko),Au(Ko,r),!fh(Ko,this._context.clippingExtent)))continue;const a=J6({overlayInfo:null,removeDuplicateStartEnd:!0,attributeData:{position:s,mapPosition:r}},e.objectAndLayerIdColor),o=a.vertexAttributes.get(j.POSITION);o.data===s&&(o.data=new Float64Array(s)),e.outGeometries.push(a),e.outMaterials.push(kt(this._outlineMaterial)),e.outTransforms.push(Ks)}}_createAsOverlay(e,t){var o;const n=xA(e.geometry);if(B(n))return null;kt(this._material).renderPriority=this._renderPriority+this._renderPriorityStep/2,T(this._outlineMaterial)&&(this._outlineMaterial.renderPriority=this._renderPriority);const r=Tfe(n,this._context.overlaySR),s=new Xft(r,t,this._context.layer.uid,e.uid),a=s.renderData.position.length/3;return this._needsUV&&(s.uvMapSpace=new Float32Array(4*a)),s.outBoundingBox=fr(),s.objectAndLayerIdColor=(o=this._context.stage.renderView)==null?void 0:o._getObjectAndLayerIdColor({graphicUid:s.graphicsUid,layerUid:s.layerUid}),this._createAsOverlayFill(s),this._hasOutline&&this._createAsOverlayOutline(s),this._logGeometryCreationWarnings(s.renderData,n.rings,"rings","FillSymbol3DLayer"),s.outGeometries.length===0?null:(this._needsUV&&Oft(Wm.fromTypedArray(s.uvMapSpace),wy.fromTypedArray(s.renderData.position),this._context.overlaySR,this._context.graphicsCoreOwner.view.state.viewingMode),new wD(this,s.outGeometries,s.outBoundingBox,this._context.drapeSourceRenderer))}_createAsOverlayFill(e){const t=e.renderData.polygons;for(const{position:n,holeIndices:r,index:s,count:a}of t){if(fr(Ko),Au(Ko,n),!fh(Ko,this._context.clippingExtent))continue;const o=w2(n,r,3);if(o.length===0)continue;jx(e.outBoundingBox,Ko);const l=GZ({indices:o,attributeData:{position:n,color:e.color,uvMapSpace:this._needsUV?new Float32Array(e.uvMapSpace.buffer,4*s*e.uvMapSpace.BYTES_PER_ELEMENT,4*a):null,objectAndLayerIdColor:e.objectAndLayerIdColor}}),c=new wC(l,kt(this._material),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),u=Ko;dl(c.boundingSphere,.5*(u[0]+u[3]),.5*(u[1]+u[4]),0,.5*Math.sqrt((u[3]-u[0])*(u[3]-u[0])+(u[4]-u[1])*(u[4]-u[1]))),e.outGeometries.push(c)}}_createAsOverlayOutline(e){if(!this._hasOutline)return;const t=e.renderData.outlines;for(let n=0;n<t.length;++n){const{position:r}=t[n];if(fr(Ko),Au(Ko,r),!fh(Ko,this._context.clippingExtent))continue;jx(e.outBoundingBox,Ko);const s=J6({overlayInfo:{spatialReference:this._context.overlaySR,renderCoordsHelper:this._context.renderCoordsHelper},removeDuplicateStartEnd:!0,attributeData:{position:r}},e.objectAndLayerIdColor),a=new wC(s,kt(this._outlineMaterial),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),o=Ko;dl(a.boundingSphere,.5*(o[0]+o[3]),.5*(o[1]+o[4]),0,.5*Math.sqrt((o[3]-o[0])*(o[3]-o[0])+(o[4]-o[1])*(o[4]-o[1]))),e.outGeometries.push(a)}}_getOutlineOpacity(){const e=ms(this.symbolLayer,"outline","color");return(this.draped?1:this._getLayerOpacity())*(T(e)?e.a:0)}_getOutlineColor(){const e=ms(this.symbolLayer,"outline","color"),t=this._getOutlineOpacity();return PE(T(e)?Xt.toUnitRGB(e):null,t)}test(){return{...super.test(),createAsOverlay:(e,t)=>this._createAsOverlay(e,t),createAs3DShape:(e,t,n)=>this._createAs3DShape(e,t,n)}}};q7.elevationModeChangeTypes={definedChanged:Fr.RECREATE,staysOnTheGround:Fr.NONE,onTheGroundChanged:Fr.RECREATE};const Ko=Go();let Yft=class extends gD{constructor(e,t,n,r){super(e,n,r),this.color=t}},Xft=class extends gD{constructor(e,t,n,r){super(e,n,r),this.color=t}},K7=class{constructor(e){this.definition=e,this.key=JSON.stringify(e),this.haloSize=Math.round(e.halo.size),this.textStyle=this._colorToRGBA(e.color),this.haloStyle=this._colorToRGB(e.halo.color),this.backgroundStyle=e.background.color[3]!==0?this._colorToRGBA(e.background.color):null}fontString(e){const t=this.definition.font;return`${t.style} ${t.weight} ${e}px ${t.family}, sans-serif`}_colorToRGB(e){return`rgb(${e.slice(0,3).map(t=>Math.floor(255*t)).toString()})`}_colorToRGBA(e){return`rgba(${e.slice(0,3).map(t=>Math.floor(255*t)).toString()},${e[3]})`}static async fromSymbol(e,t=1){const n=ms(e,"material","color"),r=Ov(n,ox,Xt.toUnitRGBA),s=Ov(e.size,12,Hn),a=e.lineHeight,o=T(e.background)?Xt.toUnitRGBA(e.background.color):ox,l={family:Ov(e.font,"sans-serif",p=>p.family),decoration:Ov(e.font,"none",p=>p.decoration),weight:Ov(e.font,"normal",p=>p.weight),style:Ov(e.font,"normal",p=>p.style)},c=e.halo,u=T(c)&&T(c.color)&&c.size>0?{size:Hn(c.size),color:Xt.toUnitRGBA(c.color)}:{size:0,color:ox},d=new K7({color:r,size:s,background:{color:o,padding:T(e.background)?[.65*s,.5*s]:[0,0],borderRadius:T(e.background)?s*(6/16):0},lineSpacingFactor:a,font:l,halo:u,pixelRatio:t}),h=d.fontString(s);try{await document.fonts.load(h)}catch{tt.getLogger("esri.views.3d.webgl-engine.lib.TextRenderParameters").warnOnce(`Failed to preload font '${h}'. Some text symbology may be rendered using the default browser font.`)}return d}},Zft=class{constructor(e,t,n){this._renderer=new Mfe(e,t,n)}get key(){return this._renderer.key}get baselineAnchorY(){return 1-this._renderer.firstRenderedBaselinePosition/this._renderer.renderedHeight}get displayWidth(){return this._renderer.displayWidth}get displayHeight(){return this._renderer.displayHeight}create(){const e=lI(Qft,this._renderer.renderedWidth,this._renderer.renderedHeight),t=e.getContext("2d");return t.save(),this._renderer.render(t,0,0),t.restore(),new i3(e,{wrap:{s:An.CLAMP_TO_EDGE,t:An.CLAMP_TO_EDGE},noUnpackFlip:!1,mipmap:!0,preMultiplyAlpha:!0,powerOfTwoResizeMode:iz.PAD})}};const Qft={canvas:null},Jft=[0,0,1];let emt=class extends xf{constructor(e,t,n,r){super(e,t,n,r),this._elevationOptions={supportsOffsetAdjustment:!0,supportsOnTheGround:!1},this.ensureDrapedStatus(!1)}async doLoad(){if(!this._drivenProperties.size){const e=fD(this.symbolLayer.size);if(e)throw new Ze("graphics3dtextsymbollayer:invalid-size",e)}await this._createTextRenderParameters()}async _createTextRenderParameters(){const e=this._context.graphicsCoreOwner.view.state.pixelRatio;this._textRenderParameters=await K7.fromSymbol(this.symbolLayer,e)}destroy(){super.destroy()}createGraphics3DGraphic(e){const t=e.graphic,n=wA(t.geometry);if(B(n))return this.logger.warn(`unsupported geometry type for text symbol: ${t.geometry.type}`),null;const r=this.symbolLayer.text;if(B(r)||r==="")return null;const s=pB(this.symbol)&&this.symbol.hasVisibleVerticalOffset()?this.symbol.verticalOffset:null;if(T(s)&&!Bie(this.symbolLayer))return this.logger.errorOncePerTick(`Callouts and vertical offset on text symbols are currently only supported with 'center' horizontal alignment (not with '${this.symbolLayer.horizontalAlignment}' alignment)`),null;const a={...nmt,verticalOffset:s,horizontalPlacement:this.symbolLayer.horizontalAlignment,verticalPlacement:hht(this.symbolLayer.verticalAlignment)};return this._createAs3DShape(t,n,r,a)}createLabel(e,t,n,r){const s=e.graphic,a=wA(s.geometry);if(B(a))return this.logger.warn(`unsupported geometry type for label: ${s.geometry.type}`),null;const o=t.text;return!o||/^\s+$/.test(o)?null:this._createAs3DShape(s,a,o,t,n,r)}setGraphicElevationContext(e,t,n=0){const r=super.setGraphicElevationContext(e,t);return r.addOffsetRenderUnits(n),r}layerOpacityChanged(){return this.logger.warn("layer opacity change not yet implemented in Graphics3DTextSymbolLayer"),!1}layerElevationInfoChanged(e,t){return eJ(e,t,(n,r)=>{this.updateGraphicElevationContext(r,n)}),Fr.UPDATE}slicePlaneEnabledChanged(e,t){return eJ(e,t,n=>{for(const r of n.stageObject.geometryRecords)r.material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled})}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!1}updateGraphicElevationContext(e,t){this.setGraphicElevationContext(e,t.elevationContext,t.metadata.elevationOffset),t.needsElevationUpdates=Rd(t.elevationContext.mode)||t.elevationContext.mode==="absolute-height"}_defaultElevationInfoNoZ(){return imt}_createAs3DShape(e,t,n,r,s,a){const o=this.setGraphicElevationContext(e,new Dd,r.elevationOffset),l=ms(e.geometry,"type")==="polyline",c=e.uid;let u=null,d=null;if(B(a)){const M=Ofe(r.horizontalPlacement);u=new Zft(n,M,this._textRenderParameters);let V=null;if(T(this._context.sharedResources.textures)){d=this._context.sharedResources.textures.fromData(u.key,()=>kt(u).create(),()=>{T(V)&&V.release()});const L=this._context.stage.renderView.textureRepository.acquire(d.texture.id);if(B(L)||BA(L))return d.release(),null;V=L}}const h=tmt(u,r),p={occlusionTest:!0,screenOffset:r.screenOffset,anchorPosition:h,polygonOffset:!0,color:[1,1,1,1],centerOffsetUnits:r.centerOffsetUnits,debugDrawLabelBorder:r.debugDrawLabelBorder,drawInSecondSlot:!0};if(T(d)&&(p.textureId=d.texture.id),T(a)&&(p.textureId=a.id),T(r.verticalOffset)){const{screenLength:M,minWorldLength:V,maxWorldLength:L}=r.verticalOffset;p.verticalOffset={screenLength:Hn(M),minWorldLength:V||0,maxWorldLength:T(L)?L:1/0}}if(this._context.screenSizePerspectiveEnabled){const{screenSizePerspectiveSettings:M,screenSizePerspectiveSettingsLabels:V}=this._context.sharedResources;p.screenSizePerspective=V.overridePadding(this._textRenderParameters.haloSize+this._textRenderParameters.definition.background.padding[0]),p.screenSizePerspectiveAlignment=M}let m;if(l&&(p.shaderPolygonOffset=1e-4),p.hasSlicePlane=this._context.slicePlaneEnabled,T(s)){const M=JSON.stringify(p);m=s.get(M),B(m)&&(m=new _C(p),s.add(M,m))}else m=new _C(p);const g=[m],_=r.translation,b=T(u)?[u.displayWidth,u.displayHeight]:[0,0],x=r.centerOffset,w=[E6(Jft,_,null,b,x,[0,0],null)],C=this._context.layer.uid,S=S7(this._context,t,w,g,o,C,c);if(S===null)return null;const E=new wf(this,S.object,w,B(s)?g:null,d,_A,o);E.alignedSampledElevation=S.sampledElevation,E.needsElevationUpdates=Rd(o.mode)||o.mode==="absolute-height";const{displayWidth:A,displayHeight:P}=T(u)?u:r;E.getScreenSize=(M=xt())=>(M[0]=A,M[1]=P,M);const O={labelText:n,elevationOffset:r.elevationOffset};return E.metadata=O,bA(E,t,this._context.elevationProvider),E}};function eJ(i,e,t){i&&i.forEach(n=>{const r=e(n);T(r)&&t(r,n.graphic)})}function tmt(i,e){if(e.verticalPlacement==="baseline"){const n=cht[e.horizontalPlacement],r=T(i)?i.baselineAnchorY:0;return dn(n,r)}const t=dht(e.horizontalPlacement,e.verticalPlacement);return cI[t]}const imt={mode:"relative-to-ground",offset:0},nmt={text:null,translation:[0,0,0],elevationOffset:0,centerOffset:[0,0,0,1],screenOffset:[0,0],horizontalPlacement:"center",verticalPlacement:"center",verticalOffset:null,centerOffsetUnits:null,debugDrawLabelBorder:!1,displayWidth:0,displayHeight:0},rmt={"calm-small":{waveStrength:.005,perturbationStrength:.02,textureRepeat:12,waveVelocity:.01},"rippled-small":{waveStrength:.02,perturbationStrength:.09,textureRepeat:32,waveVelocity:.07},"slight-small":{waveStrength:.05,perturbationStrength:.07,textureRepeat:28,waveVelocity:.1},"moderate-small":{waveStrength:.075,perturbationStrength:.07,textureRepeat:24,waveVelocity:.1},"calm-medium":{waveStrength:.003125,perturbationStrength:.01,textureRepeat:8,waveVelocity:.02},"rippled-medium":{waveStrength:.035,perturbationStrength:.015,textureRepeat:12,waveVelocity:.07},"slight-medium":{waveStrength:.06,perturbationStrength:.015,textureRepeat:8,waveVelocity:.12},"moderate-medium":{waveStrength:.09,perturbationStrength:.03,textureRepeat:4,waveVelocity:.12},"calm-large":{waveStrength:.01,perturbationStrength:0,textureRepeat:4,waveVelocity:.05},"rippled-large":{waveStrength:.025,perturbationStrength:.01,textureRepeat:8,waveVelocity:.11},"slight-large":{waveStrength:.06,perturbationStrength:.02,textureRepeat:3,waveVelocity:.13},"moderate-large":{waveStrength:.14,perturbationStrength:.03,textureRepeat:2,waveVelocity:.15}},smt=["polyline","polygon","extent"];let _m=class extends xf{constructor(e,t,n,r){super(e,t,n,r)}async doLoad(){}destroy(){super.destroy(),this._context.stage.remove(this._material),this._material=null}createGraphics3DGraphic(e){const t=e.graphic;if(!this._validateGeometry(t.geometry,smt,this.symbolLayer.type))return null;const n=this.setGraphicElevationContext(t,new Dd);return this.ensureDrapedStatus(n.mode==="on-the-ground"),this.ensureMaterial(),this.draped?this._createAsOverlay(t):this._createAs3DShape(t,n,t.uid)}ensureMaterial(){if(T(this._material))return;const e=new xfe,t=this.symbolLayer.color;T(t)&&(e.color=Xt.toUnitRGBA(t));const n=this._getCombinedOpacity(t,{hasIntrinsicColor:!0});e.color=[e.color[0],e.color[1],e.color[2],n],e.transparent=n<1||this.needsDrivenTransparentPass,e.waveDirection=T(this.symbolLayer.waveDirection)?_m.headingVectorFromAngle(this.symbolLayer.waveDirection):dn(0,0);const r=this.symbolLayer.waveStrength+"-"+this.symbolLayer.waterbodySize,s=rmt[r];e.waveStrength=s.waveStrength,e.waveTextureRepeat=s.textureRepeat,e.waveVelocity=s.waveVelocity,e.flowStrength=s.perturbationStrength,e.hasSlicePlane=this._context.slicePlaneEnabled,e.isDraped=this.draped,this._material=new wfe(e),this._context.stage.add(this._material)}layerOpacityChanged(){if(B(this._material))return;const e=this._material.parameters.color,t=this._getCombinedOpacity(this.symbolLayer.color,{hasIntrinsicColor:!0}),n=t<1||this.needsDrivenTransparentPass;this._material.setParameters({color:[e[0],e[1],e[2],t],transparent:n})}layerElevationInfoChanged(e,t,n){const r=this._elevationContext.mode,s=yM(_m.elevationModeChangeTypes,n,r);if(s!==Fr.UPDATE)return s;const a=Rd(r);return this.updateGraphics3DGraphicElevationInfo(e,t,()=>a)}slicePlaneEnabledChanged(){return T(this._material)&&this._material.setParameters({hasSlicePlane:this._context.slicePlaneEnabled}),!0}physicalBasedRenderingChanged(){return!0}pixelRatioChanged(){return!0}_createAs3DShape(e,t,n){const r=xA(e.geometry);if(B(r))return null;const s=D7(r,this._context.elevationProvider,this._context.renderCoordsHelper,t),a=s.position.length/3,o=new Float64Array(2*a),l=new amt(s,o);if(this._create3DShapeGeometries(l),this._logGeometryCreationWarnings(l.renderData,r.rings,"rings","WaterSymbol3DLayer"),l.outGeometries.length===0)return null;this._createUVCoordsFromVertices(l.uvCoords,l.renderData.mapPosition,a,this._context.elevationProvider.spatialReference);const c=new xg({geometries:l.outGeometries,materials:l.outMaterials,transformations:l.outTransforms,castShadow:!1,metadata:{layerUid:this._context.layer.uid,graphicUid:n}}),u=new wf(this,c,l.outGeometries,null,null,efe,t);return u.alignedSampledElevation=l.renderData.sampledElevation,u.needsElevationUpdates=Rd(t.mode),u}_createUVCoordsFromVertices(e,t,n,r){const s=rf(r);Eh(jg);for(let l=0;l<n;l++)Bi(tJ,t[3*l+0],t[3*l+1]),EB(jg,tJ);VB(jg,jg,s);const a=jg[0]%_m.unitSizeOfTexture,o=jg[1]%_m.unitSizeOfTexture;oO[0]=jg[0]-a,oO[1]=jg[1]-o;for(let l=0;l<n;l++)e[2*l+0]=(t[3*l+0]*s-oO[0])/_m.unitSizeOfTexture,e[2*l+1]=(t[3*l+1]*s-oO[1])/_m.unitSizeOfTexture}_create3DShapeGeometries(e){const t=e.renderData.polygons,n=e.uvCoords;for(const{count:r,index:s,position:a,mapPosition:o,holeIndices:l}of t){if(T(this._context.clippingExtent)&&(fr(qg),Au(qg,o),!fh(qg,this._context.clippingExtent)))continue;const c=w2(o,l,3);if(c.length===0)continue;const u=new Float64Array(n.buffer,2*s*n.BYTES_PER_ELEMENT,2*r),d=WZ({indices:c,attributeData:{position:a,uv0:u,mapPosition:o}});e.outGeometries.push(d),e.outMaterials.push(kt(this._material)),e.outTransforms.push(Ks)}}_createAsOverlay(e){const t=xA(e.geometry);if(B(t))return null;kt(this._material).renderPriority=this._renderPriority;const n=Tfe(t,this._context.overlaySR),r=n.position.length/3,s=new Float64Array(2*r),a=new omt(n,s,this._context.layer.uid,e.uid);return a.outBoundingBox=fr(),this._createAsOverlayWater(a),this._logGeometryCreationWarnings(a.renderData,t.rings,"rings","WaterSymbol3DLayer"),a.outGeometries.length===0?null:(this._createUVCoordsFromVertices(a.uvCoords,a.renderData.position,r,this._context.overlaySR),new wD(this,a.outGeometries,a.outBoundingBox,this._context.drapeSourceRenderer))}_createAsOverlayWater(e){const t=e.uvCoords,n=e.renderData.polygons;for(const{position:r,holeIndices:s,index:a,count:o}of n){if(fr(qg),Au(qg,r),!fh(qg,this._context.clippingExtent))continue;jx(e.outBoundingBox,qg);const l=w2(r,s,3);if(l.length===0)continue;const c=new Float64Array(t.buffer,2*a*t.BYTES_PER_ELEMENT,2*o),u=WZ({indices:l,attributeData:{position:r,uv0:c}}),d=new wC(u,kt(this._material),{layerUid:e.layerUid,graphicUid:e.graphicsUid}),h=qg;dl(d.boundingSphere,.5*(h[0]+h[3]),.5*(h[1]+h[4]),0,.5*Math.sqrt((h[3]-h[0])*(h[3]-h[0])+(h[4]-h[1])*(h[4]-h[1]))),e.outGeometries.push(d)}}static headingVectorFromAngle(e){const t=xt(),n=xB(e);return t[0]=Math.sin(n),t[1]=Math.cos(n),t}test(){return{...super.test(),create3DShape:e=>this._createAs3DShape(e.graphic,e.elevationContext,e.graphicUid),ensureMaterial:()=>this.ensureMaterial()}}};_m.unitSizeOfTexture=100,_m.elevationModeChangeTypes={definedChanged:Fr.RECREATE,staysOnTheGround:Fr.NONE,onTheGroundChanged:Fr.RECREATE};const oO=xt(),jg=qi(),tJ=xt(),qg=Go();let amt=class extends gD{constructor(e,t){super(e,null,null),this.uvCoords=t}},omt=class extends gD{constructor(e,t,n,r){super(e,n,r),this.uvCoords=t}};function lmt(i,e,t,n){const r=iJ[i.type]&&iJ[i.type][e.type]||cmt[e.type];return r?new r(i,e,t,n):(tt.getLogger("esri.views.3d.layers.graphics.Graphics3DSymbolLayerFactory").error("GraphicsLayerFactory#make",`unknown symbol type ${e.type}`),null)}const cmt={icon:aL,object:Dpt,line:N7,path:Tft,fill:q7,extrude:eht,text:emt,water:_m},iJ={"mesh-3d":{fill:lpt}};let umt=class extends w7{constructor(e,t,n){super(t.schedule),this._symbol=e,this._context=t,this._backgroundLayers=n,this._destroyed=!1,this.symbolLayers=new Array,this.referenced=0,this._extentPadding=0}set symbol(e){this._symbol=e;for(let t=0;t<e.symbolLayers.length;t++){const n=this.symbolLayers[t];B(n)||(n.symbol=e,n.symbolLayer=e.symbolLayers.items[t])}}get symbol(){return this._symbol}async doLoad(e){let t=this._symbol.symbolLayers;this._extentPadding=0,this._backgroundLayers&&(t=this._backgroundLayers.concat(t));const n=t.length;for(;this.symbolLayers.length<t.length;)this.symbolLayers.push(null);this.symbolLayers.length=t.length;const r=[];for(let s=0;s<n;s++){const a=t.getItemAt(s);if(a.enabled===!1)continue;lO.renderPriority=1-(1+s)/n,lO.renderPriorityStep=1/n,lO.ignoreDrivers=a._ignoreDrivers;const o=lmt(this.symbol,a,this._context,lO);r.push(fye(e,()=>{this.symbolLayers[s]=null,o.destroy()})),this.symbolLayers[s]=o}await _B(this.symbolLayers,async(s,a)=>{if(T(s))try{await s.load(),this._extentPadding+=Math.max(this._extentPadding,s.extentPadding)}catch{this.symbolLayers[a]=null}});for(const s of r)s==null||s.remove();if(r.length=0,Cn(e),this.symbolLayers.length&&!this.symbolLayers.some(s=>!!s))throw new Error}getSymbolLayerSize(e){const t=this.symbolLayers[e];return T(t)?t.getCachedSize():null}get extentPadding(){return this._extentPadding}get symbologySnappingSupported(){return this.symbolLayers.some(e=>T(e)&&e.queryForSnapping)}createGraphics3DGraphic(e,t){const n=e.graphic,r=new Array(this.symbolLayers.length);for(let a=0;a<this.symbolLayers.length;a++){const o=this.symbolLayers[a];r[a]=T(o)?o.createGraphics3DGraphic(e):null}const s=this._context.arcade||this._context.featureExpressionInfoContext&&this._context.featureExpressionInfoContext.arcade&&this._context.featureExpressionInfoContext.arcade.modules||null;return new Kut(n,t||this,r,e.layer,s)}get complexity(){return T7(this.symbolLayers.map(e=>ms(e,"complexity")))}globalPropertyChanged(e,t){const n=this.symbolLayers.length;for(let r=0;r<n;r++){const s=this.symbolLayers[r],a=o=>{const l=o.graphics[r];return l instanceof wf?l:null};if(T(s)&&!s.globalPropertyChanged(e,t,a))return!1}return!0}applyRendererDiff(e,t){return this.loadStatus!==yu.LOADED?Ns.Recreate_Symbol:this.symbolLayers.reduce((n,r)=>n!==Ns.Recreate_Symbol&&T(r)?Math.min(n,r.applyRendererDiff(e,t)):n,Ns.Fast_Update)}prepareSymbolPatch(e){if(this.loadStatus===yu.FAILED||e.diff.type!=="partial")return;const t=e.diff.diff;if(!t.symbolLayers||t.symbolLayers.type!=="partial")return;const n=t.symbolLayers.diff;this.symbolLayers.forEach((r,s)=>{if(B(r))return;const a=n[s];if(a){const o={diff:a,graphics3DGraphicPatches:[],symbolLayerStatePatches:[]};r.prepareSymbolLayerPatch(o),e.symbolStatePatches.push(...o.symbolLayerStatePatches),o.graphics3DGraphicPatches.length&&e.graphics3DGraphicPatches.push((l,c)=>{const u=l.graphics[s];T(u)&&o.graphics3DGraphicPatches.forEach(d=>d(u,c))})}})}updateGeometry(e,t){for(let n=0;n<this.symbolLayers.length;n++){const r=this.symbolLayers[n];if(B(r))continue;const s=e.graphics[n];if(B(s)||!r.updateGeometry(s,t))return!1}return!0}onRemoveGraphic(e){for(let t=0;t<this.symbolLayers.length;t++){const n=this.symbolLayers[t];if(B(n))continue;const r=e.graphics[t];T(r)&&n.onRemoveGraphic(r)}}getFastUpdateStatus(){let e=0,t=0,n=0;return this.symbolLayers.forEach(r=>{B(r)||(r.loadStatus===yu.LOADING?e++:r.isFastUpdatesEnabled()?n++:t++)}),{loading:e,slow:t,fast:n}}async queryForSnapping(e,t,n,r){const s=this.symbolLayers.filter(T).filter(o=>T(o.queryForSnapping)).map(o=>o.queryForSnapping(e,t,n,r)),a=await Promise.all(s);return Cn(r),a.flat()}destroy(){if(this.destroyed)console.error("Graphics3DSymbol.destroy called when already destroyed!");else{super.destroy();for(const e of this.symbolLayers)T(e)&&e.destroy();this.symbolLayers.length=0,this._destroyed=!0}}get destroyed(){return this._destroyed}};const lO={renderPriority:0,renderPriorityStep:1,ignoreDrivers:!1};let dmt=class extends w7{constructor(e,t,n){super(t),this.symbol=e,this._convert=n,this.symbologySnappingSupported=!1,this.graphics3DSymbol=null,this.referenced=0}getSymbolLayerSize(e){return T(this.graphics3DSymbol)?this.graphics3DSymbol.getSymbolLayerSize(e):null}get symbolLayers(){return T(this.graphics3DSymbol)?this.graphics3DSymbol.symbolLayers:[]}get extentPadding(){return T(this.graphics3DSymbol)?this.graphics3DSymbol.extentPadding:0}async doLoad(e){const t=await this.symbol.fetchSymbol({signal:e});t.id=this.symbol.id,this.graphics3DSymbol=this._convert(t),T(this.graphics3DSymbol)&&await this.graphics3DSymbol.load()}createGraphics3DGraphic(e){return T(this.graphics3DSymbol)?this.graphics3DSymbol.createGraphics3DGraphic(e,this):null}get complexity(){return T(this.graphics3DSymbol)?this.graphics3DSymbol.complexity:C7}globalPropertyChanged(e,t){return!!T(this.graphics3DSymbol)&&this.graphics3DSymbol.globalPropertyChanged(e,t)}applyRendererDiff(e,t){return T(this.graphics3DSymbol)?this.graphics3DSymbol.applyRendererDiff(e,t):Ns.Recreate_Symbol}prepareSymbolPatch(e){T(this.graphics3DSymbol)&&this.graphics3DSymbol.prepareSymbolPatch(e)}updateGeometry(e,t){return!!T(this.graphics3DSymbol)&&this.graphics3DSymbol.updateGeometry(e,t)}onRemoveGraphic(){}getFastUpdateStatus(){return T(this.graphics3DSymbol)?this.graphics3DSymbol.getFastUpdateStatus():{loading:1,fast:0,slow:0}}destroy(){T(this.graphics3DSymbol)&&this.graphics3DSymbol.destroy(),this.graphics3DSymbol=void 0,super.destroy()}get destroyed(){return this.graphics3DSymbol===void 0}};function Y7(i){return i instanceof dmt?i.graphics3DSymbol:i instanceof umt?i:null}const SA=tt.getLogger("esri.views.3d.layers.graphics.labelPlacement");function hmt(i){const e=wmt(i);if(B(e))return null;const t=pmt(i,e);if(B(t))return null;const n=t.anchor,r=!!e.hasLabelVerticalOffset;return mmt({anchor:n,verticalOffset:e.verticalOffset,screenOffset:xt(),centerOffset:Xn(0,0,0,-1),centerOffsetUnits:"world",translation:q(),elevationOffset:0,hasLabelVerticalOffset:r},t,i)}function pmt(i,e){if(e.anchor)return e;const t=i.labelClass.labelPlacement,n=vh[t],r=n||cL(i);return t&&!n&&SA.warnOncePerTick(`the requested label placement '${t}' is currently unsupported in SceneView.`),fmt(r,i)}function X7(i){const e=i.graphics3DGraphic.graphics3DSymbol,t=Y7(e);return T(t)?t.symbol.symbolLayers.getItemAt(0):null}function fmt(i,e){const t=e.graphics3DGraphic.graphic.geometry;if(B(t))return null;if(T(e.disablePlacement))return e.labelClass.labelPlacement?(SA.warnOncePerTick(nJ(i.placement,e.disablePlacement.logEntityDescription)),cL(e)):i;const n=t.type;switch(n){case"polyline":case"polygon":case"extent":case"multipoint":if(e.labelClass.labelPlacement)return SA.warnOncePerTick(nJ(i.placement,`'${n}' geometries`)),cL(e);break;case"point":case"mesh":return i}return i}function nJ(i,e){return`the requested label placement '${i}' is currently unsupported for ${e} in SceneView.`}function cL(i){const e=i.graphics3DGraphic.graphic.geometry;if(B(e))return null;switch(e.type){case"polyline":case"extent":case"multipoint":return{placement:"center-center",normalizedOffset:null,anchor:"center"};case"polygon":{const t=X7(i);return T(t)&&t.type==="extrude"?vh["above-center"]:{placement:"center-center",normalizedOffset:null,anchor:"center"}}case"point":case"mesh":return vh["above-center"];default:return}}function mmt(i,e,t){const n=t.graphics3DGraphic.graphic.geometry;if(B(n))return null;switch(n.type){case"point":vmt(i,e,t);break;case"polygon":gmt(i,e,t);break;case"mesh":Z7(i,e,t.graphics3DGraphic.graphics[0])}return i}function gmt(i,e,t){const n=X7(t);if(!B(n))switch(n.type){case"extrude":{const r=t.graphics3DGraphic.graphics[0];T(r)?(r.getBoundingBoxObjectSpace(DE),ph(DE,i.translation),i.translation[2]=az(DE)/2):je(i.translation,0,0,0),Z7(i,e,r);break}}}function vmt(i,e,t){const n=X7(t);if(B(n))return;const r=t.graphics3DGraphic.graphics[0];switch(T(r)?r.getCenterObjectSpace(i.translation):je(i.translation,0,0,0),n.type){case"icon":case"text":ymt(i,e,t,r);break;case"object":Z7(i,e,r)}}function ymt(i,e,t,n){const{graphics3DGraphic:r}=t,s=T(n)?n.getScreenSize():null;if(!r.isDraped&&T(s)){const a=_mt(t);jT[0]=s[0]/2*(e.normalizedOffset[0]-a[0]),jT[1]=s[1]/2*(e.normalizedOffset[1]-a[1]),i.screenOffset[0]=jT[0],i.hasLabelVerticalOffset?(i.centerOffset[1]=jT[1],i.centerOffsetUnits="screen"):i.screenOffset[1]=jT[1]}else i.hasLabelVerticalOffset||i.anchor==="center"||(vh[t.labelClass.labelPlacement]&&SA.warnOncePerTick(`the requested placement '${e.placement}' is currently unsupported for draped graphics`),i.anchor="center")}function _mt(i,e=xmt){const{graphics3DGraphic:t}=i,n=t.graphics[0],r=T(n)?n.stageObject.geometryRecords[0].material:null;if(r&&r instanceof _C){const s=r.parameters.anchorPosition;e[0]=2*(s[0]-.5),e[1]=2*(s[1]-.5)}else e[0]=0,e[1]=0;return e}function Z7(i,e,t){const n=T(t)?t.getBoundingBoxObjectSpace(DE):DE,r=Gt(n[3]-n[0],n[4]-n[1],n[5]-n[2]),s=Math.sqrt(r[0]*r[0]+r[1]*r[1]);i.centerOffset[0]=s/2*e.normalizedOffset[0];const a=i.translation[2],o=r[2]/2*e.normalizedOffset[1];i.translation[2]=0,i.elevationOffset=a+o;const l=Et(r);i.centerOffset[2]=l/2*e.normalizedOffset[2]}function bmt(i){return i==="above-center"}function wmt(i){const e=i.labelClass.labelPlacement,{labelSymbol:t,graphics3DGraphic:n}=i,r=Y7(n.graphics3DSymbol),s=Qa(r,o=>o.symbol.type==="point-3d"?o.symbol:null),a=vh[e]||cL(i);return T(s)&&s.supportsCallout()&&s.hasVisibleVerticalOffset()&&!n.isDraped?{placement:null,hasLabelVerticalOffset:!1,verticalOffset:rJ(s.verticalOffset),anchor:null,normalizedOffset:null}:t&&t.hasVisibleVerticalOffset()&&(B(s)||!s.supportsCallout()||!s.verticalOffset||n.isDraped)?bmt(a.placement)?{placement:"above-center",verticalOffset:rJ(t.verticalOffset),anchor:"bottom",normalizedOffset:[0,a.normalizedOffset[1],0],hasLabelVerticalOffset:!0}:(SA.errorOncePerTick("Callouts and vertical offset on labels are currently only supported with 'above-center' label placement (not with "+e+" placement)"),null):{placement:null,verticalOffset:null,anchor:null,normalizedOffset:null,hasLabelVerticalOffset:!1}}function rJ(i){const{screenLength:e,minWorldLength:t,maxWorldLength:n}=i;return{screenLength:e,minWorldLength:t,maxWorldLength:n}}const vh={"above-center":{placement:"above-center",normalizedOffset:[0,1,0],anchor:"bottom"},"above-left":{placement:"above-left",normalizedOffset:[-1,1,0],anchor:"bottom-right"},"above-right":{placement:"above-right",normalizedOffset:[1,1,0],anchor:"bottom-left"},"below-center":{placement:"below-center",normalizedOffset:[0,-1,2],anchor:"top"},"below-left":{placement:"below-left",normalizedOffset:[-1,-1,0],anchor:"top-right"},"below-right":{placement:"below-right",normalizedOffset:[1,-1,0],anchor:"top-left"},"center-center":{placement:"center-center",normalizedOffset:[0,0,1],anchor:"center"},"center-left":{placement:"center-left",normalizedOffset:[-1,0,0],anchor:"right"},"center-right":{placement:"center-right",normalizedOffset:[1,0,0],anchor:"left"}},sJ={"above-center":["default","esriServerPointLabelPlacementAboveCenter"],"above-left":["esriServerPointLabelPlacementAboveLeft"],"above-right":["esriServerPointLabelPlacementAboveRight"],"below-center":["esriServerPointLabelPlacementBelowCenter"],"below-left":["esriServerPointLabelPlacementBelowLeft"],"below-right":["esriServerPointLabelPlacementBelowRight"],"center-center":["esriServerPointLabelPlacementCenterCenter"],"center-left":["esriServerPointLabelPlacementCenterLeft"],"center-right":["esriServerPointLabelPlacementCenterRight"]};for(const i in sJ){const e=sJ[i],t=vh[i];e.forEach(n=>{vh[n]=t})}Object.freeze&&(Object.freeze(vh),Object.keys(vh).forEach(i=>{Object.freeze(vh[i]),Object.freeze(vh[i].normalizedOffset)}));const jT=[0,0],xmt=[0,0],DE=Go();let aJ=class{constructor(e){this._stage=e,this._materials=new Map}get(e){return this._materials.get(e)}add(e,t){this._materials.set(e,t),this._stage.add(t)}dispose(){this._stage.removeMany(Array.from(this._materials.values())),this._materials.clear()}};const T4=512,S4=4096,Cmt=.85,Tmt=.95;let LS=class extends et{constructor(e){super(e),this.type=LC.Texture,this.id=tf(),this.events=new Pn,this._glTexture=null,this._needsClear=!1,this._elementsToAddOrUpdate=new Map,this._elementsToRemove=new Map,this._elementsToRender=new Map,this._elements=new Map,this._stageObjects=new Map,this.updating=!1}initialize(){this._stage=this.view._stage,this._canvas=this._create2DCanvas(),this._ctx=this._canvas.getContext("2d"),this._stage.add(this);const e=this._computeAtlasResolution(this.view.width,this.view.height);this._createAtlasRegion(e),this._update2DCanvasSize(),this._resetAtlasCursor()}unload(){this._glTexture=Ht(this._glTexture),this.updating=!1,this.events.emit("unloaded")}get width(){return this._atlas.size.width}get height(){return this._atlas.size.height}get requiresFrameUpdates(){return!1}_createDescriptor(e){return{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,flipped:!0,samplingMode:fn.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,preMultiplyAlpha:!0,maxAnisotropy:e.parameters.maxMaxAnisotropy}}get glTexture(){return this._glTexture}load(e){return T(this._glTexture)||(this._glTexture=new Er(e,this._createDescriptor(e),this._canvas),this._frameWorker=this.view.resourceController.scheduler.registerTask($r.TEXT_TEXTURE_ATLAS,this),this.setDirty()),this._glTexture}dispose(){this._elements=null,this._elementsToAddOrUpdate=null,this._elementsToRemove=null,this._elementsToRender=null,this._frameWorker=Gr(this._frameWorker),this._glTexture&&(this._stage.remove(this),this._glTexture=Ht(this._glTexture)),this._canvas.width=0,this._canvas.height=0,this._canvas=null,this._ctx=null}_create2DCanvas(){const e=document.createElement("canvas");return e.setAttribute("id","canvas2d"),e.setAttribute("style","display:none"),e.setAttribute("width",T4.toString()),e.setAttribute("height",T4.toString()),e}_update2DCanvasSize(){this._canvas.setAttribute("width",this._atlas.size.width.toString()),this._canvas.setAttribute("height",this._atlas.size.height.toString())}_createAtlasRegion(e=T4){this._atlas={size:{width:e,height:e},cursor:{x:0,y:0},lineHeight:0}}_computeAtlasResolution(e,t){let n=Math.max(e,t);return n+=256,n=cB(n),n=Math.min(n,S4),n}_resizeAtlas(e,t){t=t||e;const n=this._atlas;n.size.width=e,n.size.height=t,T(this._glTexture)&&this._glTexture.resize(e,t),this._update2DCanvasSize()}_resetAtlasCursor(){const e=this._atlas;e.cursor.x=qT,e.cursor.y=qT+oJ,e.lineHeight=0,this._needsClear=!0}_getAtlasUsage(){const e=this._atlas;return(e.cursor.x+e.cursor.y*e.size.width)/(e.size.width*e.size.height)}_getExpectedAtlasUsage(){const e=this._elementsToRemove.size,t=this._elementsToAddOrUpdate.size,n=this._elements.size;return this._getAtlasUsage()/n*(n+t-e)}_addAtlasElement(e,t,n,r){const s=this._atlas,{renderedWidth:a,renderedHeight:o,displayWidth:l,displayHeight:c}=e.textRenderer;e.placement.offset.x=s.cursor.x,e.placement.offset.y=s.cursor.y,e.placement.size.width=a,e.placement.size.height=o,e.placement.size.displayWidth=l,e.placement.size.displayHeight=c,e.placement.uvMinMax=[e.placement.offset.x/s.size.width,1-(e.placement.offset.y+o)/s.size.height,(e.placement.offset.x+a)/s.size.width,1-e.placement.offset.y/s.size.height],s.cursor.x+=n,s.lineHeight=Math.max(s.lineHeight,r),this._elements.set(t,e)}_removeAtlasElement(e){if(e&&this._elements.has(e.textId)){const t=e.placement.offset,n=e.placement.size;this._ctx.clearRect(t.x,t.y,n.width,n.height),this._elements.delete(e.textId)}}_ensureStageObjects(e){const t=this._stageObjects.get(e);if(t)return t;const n=new Set;return this._stageObjects.set(e,n),n}_addStageObject(e,t){this._ensureStageObjects(e).add(t)}_removeStageObject(e,t){const n=this._stageObjects.get(e);n&&n.delete(t)&&(t.geometries[0].vertexAttributes.get(j.SIZE).data=[0,0],t.geometryVertexAttrsUpdated(t.geometryRecords[0]))}_processAddition(e,t){const n=this._atlas,r=e.textId,s=e.textRenderer.renderedWidth,a=e.textRenderer.renderedHeight,o=s+qT,l=a+qT+oJ;if(n.cursor.x+o<n.size.width&&n.cursor.y+l<n.size.height)this._addAtlasElement(e,r,o,l),this._elementsToRender.set(r,e),this._elementsToAddOrUpdate.delete(r);else{if(!(n.cursor.y+l+n.lineHeight<n.size.height)){const c=this._getExpectedAtlasUsage(),u=c>Cmt&&n.size.width<S4;return u&&this._resizeAtlas(2*n.size.width,2*n.size.height),!t||!u&&c>Tmt&&n.size.width===S4?(this._processRemovals(),Yw.OK):(this._repack(),Yw.REPACK)}n.cursor.x=qT,n.cursor.y+=n.lineHeight,n.lineHeight=0,this._addAtlasElement(e,r,o,l),this._elementsToRender.set(r,e),this._elementsToAddOrUpdate.delete(r)}return Yw.OK}_processRemovals(){this._elementsToRemove.forEach((e,t)=>{const n=this._stageObjects.get(t);n&&n.size!==0||this._removeAtlasElement(e),n&&n.size===0&&this._stageObjects.delete(t)}),this._elementsToRemove.clear()}_repack(){this._processRemovals(),this._elements.forEach((e,t)=>{e.rendered=!1,this._elementsToAddOrUpdate.set(t,e)}),this._elements.clear(),this._resetAtlasCursor(),this._elementsToRender.clear()}_processRenderingRequest(e){this._ctx.clearRect(e.placement.offset.x,e.placement.offset.y,e.placement.size.width,e.placement.size.height),e.textRenderer.render(this._ctx,e.placement.offset.x,e.placement.offset.y);const t=this._stageObjects.get(e.textId);t&&t.forEach(n=>{n.geometries[0].vertexAttributes.get(j.UV0).data=new Float32Array(e.placement.uvMinMax),n.geometries[0].vertexAttributes.get(j.SIZE).data=[e.placement.size.displayWidth,e.placement.size.displayHeight],n.geometryVertexAttrsUpdated(n.geometryRecords[0])}),e.rendered=!0}get running(){return this.updating}runTask(e,t=!0){if(!this._glTexture)return;let n=!1;if(ps(this._elementsToAddOrUpdate,(s,a)=>{const o=this._elements.get(a);if(o&&o.rendered){const l=this._stageObjects.get(a);return l&&l.forEach(c=>{const u=c.geometries[0].vertexAttributes,d=this._elements.get(a);u.get(j.UV0).data=new Float32Array(d.placement.uvMinMax),u.get(j.SIZE).data=new Float32Array([d.placement.size.displayWidth,d.placement.size.displayHeight]),c.geometryVertexAttrsUpdated(c.geometryRecords[0])}),this._elementsToAddOrUpdate.delete(a),!1}return this._processAddition(this._elementsToAddOrUpdate.get(a),t)===Yw.REPACK&&(n=!0,!0)}),n)return void this.runTask(WL,!1);let r=!1;this._elementsToRender.size>0&&this._needsClear&&(this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._needsClear=!1),ps(this._elementsToRender,(s,a)=>(this._processRenderingRequest(s),this._elementsToRender.delete(a),r=!0,e.madeProgress(),e.done)),r&&T(this._glTexture)&&this._glTexture.setData(this._canvas),this.updating=this._elementsToRender.size>0,!this.updating&&ldt.orderedRepackingEnabled&&this.repackOrdered()}addTextTexture(e,t){const n=e.key;this._elementsToAddOrUpdate.has(n)||this._elementsToAddOrUpdate.set(n,{textId:n,placement:{offset:{x:0,y:0},size:{width:0,height:0,displayWidth:0,displayHeight:0},uvMinMax:[]},textRenderer:e,rendered:!1}),this._addStageObject(n,t),this._elementsToRemove.delete(n),this.setDirty()}removeTextTexture(e,t){const n=e.key;this._elementsToRemove.set(n,this._elements.get(n)),this._removeStageObject(n,t)}setDirty(){this._glTexture&&(this.updating=!0)}repackOrdered(){if(this._elements.size===0)return;const e=[];this._elements.forEach((n,r)=>e.push({element:n,key:r}));let t=!0;for(let n=0;n<e.length-1;n++)if(e[n].key.localeCompare(e[n+1].key)>0){t=!1;break}if(!t||this._elementsToRemove.size){e.sort((n,r)=>n.key.localeCompare(r.key)),this._elements.clear();for(const{element:n,key:r}of e)this._elements.set(r,n);this._repack(),this.setDirty()}}get test(){const{_elements:e,_stageObjects:t,_elementsToRemove:n,_atlas:r}=this,s=this;return{elements:e,stageObjects:t,elementsToRemove:n,atlas:r,_resizeAtlas:(a,o)=>s._resizeAtlas(a,o),run:(a,o)=>s.runTask(a,o)}}};f([y({constructOnly:!0})],LS.prototype,"view",void 0),f([y({type:Boolean})],LS.prototype,"updating",void 0),LS=f([ge("esri.views.3d.webgl-engine.lib.TextTextureAtlas")],LS);const qT=2,oJ=2;var Yw;(function(i){i[i.OK=0]="OK",i[i.REPACK=1]="REPACK"})(Yw||(Yw={}));let B_=class extends et{constructor(e){super(e),this._dirty=!1,this._labels=new Map,this._labelsToAdd=new Map,this._labelsToRemove=new Map,this._labelingContexts=new Array}setup(){this.dispose(),this._handles=new mi,this._handles.add([ue(()=>{var e;return(e=this.view.state)==null?void 0:e.camera},()=>this.setDirty()),ue(()=>{var e;return(e=this.view.state)==null?void 0:e.pixelRatio},()=>this._resetAllLabels()),this.view.resourceController.scheduler.registerTask($r.LABELER,this)]),this._textTextureAtlas=new LS({view:this.view}),this._hudMaterialCollection=new aJ(this.view._stage),this._calloutMaterialCollection=new aJ(this.view._stage)}dispose(){this._handles=_t(this._handles),this._textTextureAtlas=Ht(this._textTextureAtlas),this._hudMaterialCollection=Ht(this._hudMaterialCollection),this._calloutMaterialCollection=Ht(this._calloutMaterialCollection),this._labelingContexts.length=0,this._labels.clear(),this._labelsToAdd.clear(),this._labelsToRemove.clear()}_activateLabelingContext(e){e.labels.forEach((t,n)=>{this._labels.set(n,t),t.graphics3DGraphic.setVisibilityFlag(xu.USER_SETTING,!0,Ia.LABEL)}),e.active=!0}_deactivateLabelingContext(e){e.labels.forEach((t,n)=>{t.graphics3DGraphic.setVisibilityFlag(xu.USER_SETTING,!1,Ia.LABEL),this.setLabelGraphicVisibility(t.graphics3DGraphic,!1),this._labels.delete(n)}),e.active=!1}_addLabelTextureToAtlas(e){for(const t of e.graphics3DGraphic.labelGraphics){if(!t._labelClass)continue;const n=e.textTextureResources.textRenderers[t._labelIndex];T(n)&&this._textTextureAtlas.addTextTexture(n,t.stageObject)}e.rendered=!0}_removeLabelTextureFromAtlas(e){for(const t of e.graphics3DGraphic.labelGraphics){if(!t._labelClass)continue;const n=e.textTextureResources.textRenderers[t._labelIndex];T(n)&&this._textTextureAtlas.removeTextTexture(n,t.stageObject)}e.rendered=!1}get running(){var e;return this.view.ready&&(this._dirty||((e=this._textTextureAtlas)==null?void 0:e.updating)||this.deconflictor.running)}runTask(e){this._updateLabels(e),!this._dirty&&this.deconflictor.running&&this.deconflictor.runTask(e)}_updateLabels(e){if(this._dirty){this._dirty=!1;for(const t of this._labelingContexts)if(Smt(t)){if(!lJ(t)){if(Emt(t)){this._deactivateLabelingContext(t);continue}if(this._createLabelClassContext(t),E4(t)){this._dirty=!0;continue}if(!lJ(t))continue}ps(t.labelsToInitialize,(n,r)=>(this._ensureGraphics3DResources(n)&&(this._labels.set(r,n),this.deconflictor.setDirty(),e.madeProgress()),(n.visible&&n.textTextureResources.initialized||!n.visible&&n.hasGraphics3DResources)&&(t.labelsToInitialize.delete(r),e.madeProgress()),e.done))&&(this._dirty=!0)}this._labelsToRemove.forEach(t=>this._removeLabelTextureFromAtlas(t)),this._labelsToAdd.forEach(t=>this._addLabelTextureToAtlas(t)),this._labelsToRemove.clear(),this._labelsToAdd.clear(),this._dirty||this.notifyChange("updating")}}async _createLabelClassContextAsync(e){const t=e.labelClassAbortController.signal;await e.layer.when(),Cn(t),e.scaleVisibility&&e.scaleVisibility.updateScaleRangeActive();const n=e.graphics3DCore,r=n.layer,s=r.labelingInfo&&r.labelingInfo.filter(l=>!!l.symbol);if(!s||s.length===0)return;const a=new Array(s.length);let o=!1;await _B(s,async(l,c)=>{const u=l.symbol,d=Y7(n.getOrCreateGraphics3DSymbol(u));if(B(d))return void tt.getLogger(this.declaredClass).error("Failed to create Graphics3DSymbol for label");await d.load(),Cn(t);let h=null;pB(u)&&u.hasVisibleCallout()&&(h=Gut(u,n.symbolCreationContext),await h.load(),Cn(t));const p=await l2(G1e(l,e.layer.fieldsIndex,this.view.spatialReference));if(Cn(t),p.ok===!0){const m=await this._createTextRenderParameters(d.symbol);Cn(t),a[c]={labelClass:l,labelFunction:p.value,graphics3DSymbol:d,graphics3DCalloutSymbolLayer:h,calloutSymbolLayerIndex:0,textRenderParameters:m}}else tt.getLogger(this.declaredClass).error(`Label expression failed to evaluate: ${p.error}`),o=!0}),Cn(t),o||(e.labelClassContexts=a)}async _createLabelClassContext(e){return e.labelClassPromise||(e.labelClassPromise=this._createLabelClassContextAsync(e).catch(t=>{if(zo(t))throw t;e.labelClassContexts=null}).then(()=>{e.labelClassAbortController=null,this.notifyChange("updating")}).catch(()=>{}),this.notifyChange("updating")),e.labelClassPromise}async _createTextRenderParameters(e){const t=e.symbolLayers.getItemAt(0);return t&&t.type==="text"?K7.fromSymbol(t,this.view.state.pixelRatio):null}_destroyLabelClassContext(e){for(const n of e.labelClassContexts)--n.graphics3DSymbol.referenced,n.graphics3DSymbol=null;const t=e.labelClassAbortController;e.labelClassAbortController=new AbortController,t&&t.abort(),e.labelClassContexts=[],e.labelClassPromise=null,this.notifyChange("updating")}_createTextSymbolGraphic(e,t,n,r,s){const a={text:e.text,centerOffset:n.centerOffset,translation:n.translation,elevationOffset:n.elevationOffset,screenOffset:n.screenOffset,centerOffsetUnits:n.centerOffsetUnits,horizontalPlacement:SQ(n.anchor),verticalPlacement:uht(n.anchor),verticalOffset:n.verticalOffset,debugDrawLabelBorder:cn.LABELS_SHOW_BORDER,displayWidth:e.displayWidth,displayHeight:e.displayHeight};return Kg.graphic=t,Kg.renderingInfo=null,Kg.layer=r,s.createLabel(Kg,a,this._hudMaterialCollection,this._textTextureAtlas)}_createLineCalloutGraphic(e,t,n,r,s){const a={symbol:t,translation:r.translation,elevationOffset:r.elevationOffset,screenOffset:r.screenOffset,centerOffset:r.centerOffset,centerOffsetUnits:r.centerOffsetUnits,materialCollection:this._calloutMaterialCollection};return Kg.graphic=e,Kg.renderingInfo=a,Kg.layer=s,n.createGraphics3DGraphic(Kg)}_ensureGraphics3DResources(e){if(e.hasGraphics3DResources)return!1;const t=e.graphics3DGraphic;if(t.destroyed)return!1;this._ensureTextTextureResources(e);const{textTextureResources:n}=e,r=e.labelingContext,s=r.labelClassContexts;if(!s||s.length===0||!r.emptySymbolLabelSupported&&t.graphics.length===0)return!1;let a=!1;const o=t.graphic,l=r.layer,c=YN(r.layer),u=this.view._stage;for(let d=0;d<s.length;d++){const h=n.textRenderers[d],p=n.labelPlacements[d];if(B(h)||B(p))continue;const m=s[d],g=m.graphics3DSymbol,_=g.symbol&&g.symbol.type==="label-3d"?g.symbol:null,b=g.symbolLayers[0];if(!b)continue;b.setElevationInfoOverride(r.elevationInfoOverride);const x=this._createTextSymbolGraphic(h,o,p,l,b);if(!x)return!1;x._labelClass=m.labelClass,x._labelIndex=d,t.addLabelGraphic(x,u,r.stageLayer),t.setVisibilityFlag(xu.USER_SETTING,c,Ia.LABEL),t.clearVisibilityFlag(xu.SCALE_RANGE,Ia.LABEL),t.setVisibilityFlag(xu.DECONFLICTION,!1,Ia.LABEL),a=!0;const w=m.graphics3DCalloutSymbolLayer;if(w&&p.hasLabelVerticalOffset){w.setElevationInfoOverride(r.elevationInfoOverride);const C=this._createLineCalloutGraphic(o,_,w,p,l);T(C)&&(m.calloutSymbolLayerIndex=t.labelGraphics.length,t.addLabelGraphic(C,u,r.stageLayer))}break}return r.scaleVisibility&&a&&r.scaleVisibility.updateGraphicLabelScaleVisibility(t),e.hasGraphics3DResources=!0,!0}_destroyGraphics3DResources(e){const t=e.labelingContext.labelClassContexts;for(const n of e.graphics3DGraphic.labelGraphics){if(n._labelClass==null)continue;const r=t[n._labelIndex].graphics3DSymbol.symbolLayers[0];r!=null&&r.onRemoveGraphic(n)}e.graphics3DGraphic.clearLabelGraphics(),e.hasGraphics3DResources=!1}_ensureTextTextureResources(e){const{textTextureResources:t}=e;if(t.initialized)return;const n=e.labelingContext,r=n.labelClassContexts;if(!r||r.length===0)return;const s=e.graphics3DGraphic.graphic;for(let a=0;a<r.length;a++){const o=r[a];if(t.textRenderers[a]=null,t.labelPlacements[a]=null,!o.textRenderParameters)continue;const l=o.labelFunction;let c;if(l.type==="arcade")try{const x=l.needsHydrationToEvaluate()?aut(s,n.layer):s;c=l.evaluate(x)}catch{c=null}else c=l.evaluate(s);if(B(c)||c===""||/^\s+$/.test(c))continue;const u=o.graphics3DSymbol,d=u.symbol&&u.symbol.type==="label-3d"?u.symbol:null;if(!u.symbolLayers[0])continue;const h=e.graphics3DGraphic,p=o.labelClass,m=n.disablePlacement,g=hmt({graphics3DGraphic:h,labelSymbol:d,labelClass:p,disablePlacement:m});if(B(g))continue;const _=SQ(g.anchor),b=Ofe(_);t.textRenderers[a]=new Mfe(c,b,o.textRenderParameters),t.labelPlacements[a]=g}t.initialized=!0}_destroyTextTextureResources(e){const{textTextureResources:t}=e;t.initialized=!1,t.textRenderers=[],t.labelPlacements=[]}_addGraphic(e,t){const n={hasGraphics3DResources:!1,visible:!1,rendered:!1,labelingContext:e,graphics3DGraphic:t,textTextureResources:{initialized:!1,textRenderers:[],labelPlacements:[]}},r=t.graphic.uid;e.labels.set(r,n),e.labelsToInitialize.set(r,n),this.setDirty(),this.deconflictor.setDirty()}_removeGraphic(e,t){const n=t.graphic.uid,r=e.labels.get(n);r&&(this._destroyGraphic(r,n),e.labels.delete(n),e.labelsToInitialize.delete(n),this.setDirty(),this.deconflictor.setDirty())}_destroyGraphic(e,t){this._labels.has(t)&&(this._labels.delete(t),this._labelsToAdd.delete(t),this._labelsToRemove.delete(t)),e.textTextureResources.initialized&&(this._removeLabelTextureFromAtlas(e),this._destroyTextTextureResources(e)),e.hasGraphics3DResources&&this._destroyGraphics3DResources(e)}async _labelingInfoChange(e,t){if(!t)return this._visibilityInfoChange(e),this._resetLabels(e),this._createLabelClassContext(e);for(const n of t){const r=e.labels.get(n);r&&(this._removeGraphic(e,r.graphics3DGraphic),this._addGraphic(e,r.graphics3DGraphic))}}_globalPropertyChanged(e,t){for(const n of t.labelClassContexts){const r=new Map;t.labels.forEach(a=>{const o=a.graphics3DGraphic;r.set(o.graphic.uid,o)});const s=a=>a.labelGraphics[0];if(kt(n.graphics3DSymbol.symbolLayers[0]).globalPropertyChanged(e,r,s),n.graphics3DCalloutSymbolLayer){const a=o=>o.labelGraphics[n.calloutSymbolLayerIndex];n.graphics3DCalloutSymbolLayer.globalPropertyChanged(e,r,a)}}}_visibilityInfoChange(e){const t=e.layer.labelsVisible;t&&!e.active&&this._activateLabelingContext(e),!t&&e.active&&this._deactivateLabelingContext(e),this.setDirty()}_resetAllLabels(){for(const e of this._labelingContexts)this._resetLabels(e)}_resetLabels(e){e.labels.forEach((t,n)=>{this._destroyGraphic(t,n),t.visible=!1,t.rendered=!1,e.labelsToInitialize.set(n,t)}),this._destroyLabelClassContext(e),this.setDirty(),this.deconflictor.setDirty()}_findLabelingContext(e){for(const t of this._labelingContexts)if(t.graphics3DCore===e)return t;return null}addGraphicsOwner(e,t,n){const r=n&&n.emptySymbolLabelSupported||!1,s=n&&n.elevationInfoOverride||null,a=n&&n.disablePlacement||null;if(this._findLabelingContext(e))return;const o=e.layer,l={graphics3DCore:e,layer:o,scaleVisibility:t,emptySymbolLabelSupported:r,elevationInfoOverride:s,disablePlacement:a,active:o.labelsVisible,labelClassPromise:null,labelClassAbortController:new AbortController,labelClassContexts:[],labels:new Map,labelsToInitialize:new Map,stageLayer:new pfe({isPickable:!0},o.uid)};return this.view._stage.add(l.stageLayer),this._labelingContexts.push(l),this.setDirty(),{addGraphic:c=>this._addGraphic(l,c),removeGraphic:c=>this._removeGraphic(l,c),featureReductionChange:()=>{},layerLabelsEnabled:()=>YN(l.layer),labelingInfoChange:c=>this._labelingInfoChange(l,c),elevationInfoChange:()=>this._globalPropertyChanged("elevationInfo",l),slicePlaneEnabledChange:()=>this._globalPropertyChanged("slicePlaneEnabled",l),visibilityInfoChange:()=>this._visibilityInfoChange(l),reset:()=>this._resetLabels(l),clear:()=>{}}}removeGraphicsOwner(e){const t=this._findLabelingContext(e);if(!t)return;const n=this._labelingContexts.indexOf(t);this._labelingContexts.splice(n,1),t.labels.forEach(r=>this._removeGraphic(t,r.graphics3DGraphic)),this.view._stage.remove(t.stageLayer),t.stageLayer=null,this.setDirty()}setLabelGraphicVisibility(e,t){const n=e.graphic.uid,r=this._labels.get(n);r&&r.visible!==t&&(t&&!r.rendered?(this._labelsToAdd.set(n,r),this._labelsToRemove.delete(n),r.textTextureResources.initialized||r.labelingContext.labelsToInitialize.set(n,r)):!t&&r.rendered&&(this._labelsToRemove.set(n,r),this._labelsToAdd.delete(n)),r.visible=t,this.setDirty())}setDirty(){!this._dirty&&this._labelingContexts.length>0&&(this._dirty=!0,this.notifyChange("updating"))}get updating(){var e;return this._dirty||((e=this._textTextureAtlas)==null?void 0:e.updating)||this.deconflictor.updating||this._labelingContexts.some(t=>E4(t))}get updatingProgress(){if(!this.updating||!this._textTextureAtlas)return 1;const e=this._labelingContexts.length>0?this._labelingContexts.reduce((t,n)=>t+(E4(n)?0:1),0)/this._labelingContexts.length:1;return(this._dirty?0:.3)+(this._textTextureAtlas.updating?0:.1)+.1*e+.5*this.deconflictor.updatingProgress}get test(){return{textTextureAtlas:this._textTextureAtlas,resetAllLabels:()=>this._resetAllLabels()}}};function Smt(i){return i.active&&YN(i.layer)}function E4(i){return i.labelClassPromise&&!!i.labelClassAbortController}function lJ(i){return i.labelClassContexts&&i.labelClassContexts.length}function Emt(i){return i.labelClassContexts===null}f([y({constructOnly:!0})],B_.prototype,"view",void 0),f([y({constructOnly:!0})],B_.prototype,"deconflictor",void 0),f([y()],B_.prototype,"_textTextureAtlas",void 0),f([y({type:Boolean,readOnly:!0})],B_.prototype,"updating",null),B_=f([ge("esri.views.3d.layers.graphics.Labeler")],B_);const Kg=new jut(null,null,null);let Ip=class{constructor(e,t,n,r=null){this.lij=[0,0,0],this.extent=qi(),this.resolution=0,this.loadPriority=0,this.measures={visibility:So.VISIBLE_ON_SURFACE,screenRect:qi(),distance:0,shouldSplit:!1},this.used=!1,r&&this.acquire(e,t,n,r)}acquire(e,t,n,r){this.tilingScheme=r,this.id=Ip.id(e,t,n),this.lij[0]=e,this.lij[1]=t,this.lij[2]=n,r.getExtent(e,t,n,this.extent),this.resolution=r.resolutionAtLevel(e)}release(){this.tilingScheme=null}getChildren(e){const t=this.lij[0]+1,n=2*this.lij[1],r=2*this.lij[2];return e?(e[0].acquire(t,n,r,this.tilingScheme),e[1].acquire(t,n+1,r,this.tilingScheme),e[2].acquire(t,n,r+1,this.tilingScheme),e[3].acquire(t,n+1,r+1,this.tilingScheme),e):[new Ip(t,n,r,this.tilingScheme),new Ip(t,n+1,r,this.tilingScheme),new Ip(t,n,r+1,this.tilingScheme),new Ip(t,n+1,r+1,this.tilingScheme)]}copyMeasurementsFrom(e){this.measures.visibility=e.measures.visibility,this.measures.shouldSplit=e.measures.shouldSplit,this.measures.distance=e.measures.distance,u2(e.measures.screenRect,this.measures.screenRect)}static id(e,t,n){return`${e}/${t}/${n}`}};var So;(function(i){i[i.INVISIBLE=0]="INVISIBLE",i[i.VISIBLE_WHEN_EXTENDED=1]="VISIBLE_WHEN_EXTENDED",i[i.VISIBLE_ON_SURFACE=2]="VISIBLE_ON_SURFACE"})(So||(So={}));const Yfe=.5*Math.PI,Amt=Yfe/Math.PI*180;let Mmt=class{constructor(e){this._renderCoordsHelper=e.renderCoordsHelper,this._extent=new Array(4),this._planes=new Array(6),this._maxSpan=0,this._center={origin:q(),direction:q()};for(let t=0;t<4;t++)this._extent[t]={origin:q(),direction:q(),cap:{next:null,direction:q()}},this._planes[t]=Dr();this._planes[Jr.NEAR]=Dr(),this._planes[Jr.FAR]=Dr(),this._planesWithoutFar=this._planes.slice(0,5)}update(e,t,n,r=!0){const s=this._extent;this._toRenderBoundingExtent(e,t,n),rt(this._center.origin,s[0].origin,s[2].origin),Ye(this._center.origin,this._center.origin,.5),this._renderCoordsHelper.worldUpAtPosition(this._center.origin,this._center.direction),r||Ye(this._center.direction,this._center.direction,-1);for(let a=0;a<4;a++){const o=s[a];this._renderCoordsHelper.worldUpAtPosition(o.origin,o.direction);const l=s[a===3?0:a+1];o.cap.next=l.origin,Hm(o.cap.direction,o.origin,l.origin),p2(o.direction,o.cap.direction,o.origin,this._planes[a]),r||Ye(o.direction,o.direction,-1)}p2(s[0].cap.direction,s[1].cap.direction,s[0].origin,this._planes[Jr.NEAR]),r?KN(this._planes[Jr.NEAR],this._planes[Jr.FAR]):(nE(this._planes[Jr.FAR],this._planes[Jr.NEAR]),KN(this._planes[Jr.NEAR],this._planes[Jr.NEAR])),this._maxSpan=Math.max(Math.abs(e[0]-e[2]),Math.abs(e[1]-e[3])),this._maxSpanSpatialReference=t,this._minGlobalAltitude=.9*rn(this._maxSpanSpatialReference).radius}isVisibleInFrustum(e,t,n=!1){if(e==null)return!1;if(this._renderCoordsHelper.viewingMode===Ot.Global){const s=this._maxSpanSpatialReference.isGeographic?Amt:Yfe*t;if(this._maxSpan>s)return!0;if(e.altitude!=null&&e.altitude>=this._minGlobalAltitude)return this._isVisibleInFrustumGlobal(e)}if(this._maxSpan===0){const s=this._extent[0];return!(n||!e.intersectsRay(Ah(s.origin,s.direction)))}for(let s=0;s<this._extent.length;s++){const a=this._extent[s];if(!n&&e.intersectsRay(Ah(a.origin,a.direction))||e.intersectsLineSegment(D0(a.origin,a.cap.next,Omt),a.cap.direction))return!0}const r=n?this._planes:this._planesWithoutFar;for(let s=0;s<e.lines.length;s++){const a=e.lines[s];if(kst(r,a.origin,a.endpoint,a.direction))return!0}return!1}_toRenderBoundingExtentGlobal(e,t,n){AB(e,Bd),Bd[2]=n,zm(t,Bd,A4,this._renderCoordsHelper.spatialReference),Da(cJ,A4),fr(lc);for(const{x0:s,x1:a,y0:o,y1:l}of Pmt)for(let c=0;c<5;c++){const u=c/4;Bd[0]=ki(e[s],e[a],u),Bd[1]=ki(e[o],e[l],u),Bd[2]=n,no(Bd,t,Bd,this._renderCoordsHelper.spatialReference),$t(Bd,Bd,cJ),Wx(lc,Bd)}je(this._extent[0].origin,lc[0],lc[1],lc[2]),je(this._extent[1].origin,lc[3],lc[1],lc[2]),je(this._extent[2].origin,lc[3],lc[4],lc[2]),je(this._extent[3].origin,lc[0],lc[4],lc[2]);for(let s=0;s<4;++s)$t(this._extent[s].origin,this._extent[s].origin,A4)}_toRenderBoundingExtentLocal(e,t,n){zL(e,t,kf,this._renderCoordsHelper.spatialReference),je(this._extent[0].origin,kf[0],kf[1],n),je(this._extent[1].origin,kf[2],kf[1],n),je(this._extent[2].origin,kf[2],kf[3],n),je(this._extent[3].origin,kf[0],kf[3],n)}_toRenderBoundingExtent(e,t,n){switch(this._renderCoordsHelper.viewingMode){case Ot.Global:this._toRenderBoundingExtentGlobal(e,t,n);break;case Ot.Local:this._toRenderBoundingExtentLocal(e,t,n);break;default:Do(this._renderCoordsHelper.viewingMode)}}_isVisibleInFrustumGlobal(e){if(tr(e.planes[Jr.NEAR],this._center.origin)<0&&dt(this._center.direction,e.direction)<0)return!0;for(let t=0;t<4;t++){const n=this._extent[t];if(tr(e.planes[Jr.NEAR],n.origin)<0&&dt(n.direction,e.direction)<0)return!0}return!1}};const Pmt=[{x0:0,y0:1,x1:2,y1:1},{x0:0,y0:3,x1:2,y1:3},{x0:0,y0:1,x1:0,y1:3},{x0:2,y0:1,x1:2,y1:3}],Bd=q(),A4=St(),cJ=St(),lc=Go(),kf=qi(),Omt=$C();let Rmt=class{constructor(e){this._renderCoordsHelper=e,this._surfaceElevation=0,this._cache=new Map,this._frustum=new jv(e),this._extendedFrustum=new jv(e),this._intersector=new Mmt({renderCoordsHelper:e}),this._renderCoordsHelper=e}begin(e,t){this._surfaceElevation=t,this._aboveGround=this._renderCoordsHelper.getAltitude(e.eye)>t,this._frustum.update(e),this._shortenFrustumFarPlane(this._frustum),this._updateExtendedFrustum(e)}end(){this._cache.clear()}calculate(e){if(this._allTilesInvisible)return So.INVISIBLE;const t=this._renderCoordsHelper.viewingMode===Ot.Global&&e.lij[0]>=Imt&&e.lij[0]<$mt,n=this._getOrCalculateSingleTileVisibility(e,!t);return n!==So.INVISIBLE&&t?this._calculateAggregatedChildrenVisibility(e):n}_shortenFrustumFarPlane(e){const t=jv.nearFarLineIndices,n=e.mutablePoints;for(const r of t){const[s,a]=r,o=n[s],l=n[a];nt(Yc,l,o),Ye(Yc,Yc,Dmt),rt(n[a],o,Yc)}e.updatePoints(n)}_calculateAggregatedChildrenVisibility(e){let t=So.INVISIBLE;const n=this._cache.get(e.id);if(n!=null)return n;const r=pJ.acquire();e.getChildren(r);for(const s of r){const a=this.calculate(s);if(a!==So.INVISIBLE&&(t=a,a===So.VISIBLE_ON_SURFACE))break}return pJ.release(r),this._cache.set(e.id,t),t}_getOrCalculateSingleTileVisibility(e,t){const n=this._cache.get(e.id);if(n!=null)return n;const r=this._calculateSingleTileVisibility(e);return t&&this._cache.set(e.id,r),r}_calculateSingleTileVisibility(e){return!this._aboveGround&&this._renderCoordsHelper.viewingMode===Ot.Global&&e.lij[0]<Lmt?this._calculateSingleTileVisibilitySided(e,!1)===So.INVISIBLE?this._calculateSingleTileVisibilitySided(e,!0):void 0:this._calculateSingleTileVisibilitySided(e,this._aboveGround)}_calculateSingleTileVisibilitySided(e,t){this._intersector.update(e.extent,e.tilingScheme.spatialReference,this._surfaceElevation,t);const n=rn(e.tilingScheme.spatialReference).radius;return this._intersector.isVisibleInFrustum(this._extendedFrustum,n)?this._intersector.isVisibleInFrustum(this._frustum,n,!0)?So.VISIBLE_ON_SURFACE:So.VISIBLE_WHEN_EXTENDED:So.INVISIBLE}_updateExtendedFrustum(e){this._extendedFrustum.update(e),this._shortenFrustumFarPlane(this._extendedFrustum);const t=this._renderCoordsHelper.worldUpAtPosition(e.eye,Yc);this._aboveGround||No(t,t);const n=Uo(-dt(t,e.viewForward));if(this._allTilesInvisible=n>(Math.PI+e.fovY)/2,this._allTilesInvisible||(this._hasExtendedFrustum=n>e.fovY/2,!this._hasExtendedFrustum))return;const r=this._extendedFrustumParameters(),s=this._extendedFrustum.mutablePoints;for(let a=0;a<4;a++){const o=r.pointIndices[a],l=s[o],c=this._renderCoordsHelper.getAltitude(l);if(r.needsAltitudeAdjustment(c)){switch(this._renderCoordsHelper.worldUpAtPosition(l,Yc),o){case Jn.FAR_BOTTOM_LEFT:case Jn.FAR_TOP_LEFT:case Jn.NEAR_BOTTOM_LEFT:case Jn.NEAR_TOP_LEFT:HG(this._extendedFrustum.planes[Jr.LEFT],Yc,Yc);break;case Jn.FAR_BOTTOM_RIGHT:case Jn.FAR_TOP_RIGHT:case Jn.NEAR_BOTTOM_RIGHT:case Jn.NEAR_TOP_RIGHT:HG(this._extendedFrustum.planes[Jr.RIGHT],Yc,Yc)}Ye(Yc,Yc,r.direction),this._renderCoordsHelper.intersectInfiniteManifold(Ah(l,Yc),r.zWithMargin,l)}}if(this._extendedFrustum.updatePoints(s),Dp(s[Jn.NEAR_BOTTOM_LEFT],s[Jn.NEAR_BOTTOM_RIGHT],s[Jn.NEAR_TOP_RIGHT],dJ),Dp(s[Jn.NEAR_BOTTOM_RIGHT],s[Jn.NEAR_TOP_RIGHT],s[Jn.NEAR_TOP_LEFT],hJ),dt(ro(dJ),ro(hJ))<0){const a=this._extendedFrustum.mutablePoints;this._aboveGround?[a[Jn.NEAR_BOTTOM_LEFT],a[Jn.NEAR_BOTTOM_RIGHT]]=[a[Jn.NEAR_BOTTOM_RIGHT],a[Jn.NEAR_BOTTOM_LEFT]]:[a[Jn.NEAR_TOP_LEFT],a[Jn.NEAR_TOP_RIGHT]]=[a[Jn.NEAR_TOP_RIGHT],a[Jn.NEAR_TOP_LEFT]],this._extendedFrustum.updatePoints(a)}}_extendedFrustumParameters(){return this._aboveGround?this._extendedFrustumParametersAboveSurface():this._extendedFrustumParametersBelowSurface()}_extendedFrustumParametersAboveSurface(){const e=this._surfaceElevation-uJ;return{zWithMargin:e,pointIndices:jv.planePointIndices.bottom,direction:-1,needsAltitudeAdjustment:t=>t>e}}_extendedFrustumParametersBelowSurface(){const e=this._surfaceElevation+uJ;return{zWithMargin:e,pointIndices:jv.planePointIndices.top,direction:1,needsAltitudeAdjustment:t=>t<e}}};const Imt=2,$mt=6,Lmt=12,Dmt=.95,uJ=1,Yc=q(),dJ=Dr(),hJ=Dr(),pJ=new Ic(Array,i=>{i.length!==4&&(i[0]=new Ip,i[1]=new Ip,i[2]=new Ip,i[3]=new Ip)},i=>{i[0].release(),i[1].release(),i[2].release(),i[3].release()});let kmt=class{constructor(e){this._camera=new Nn,this._focusOnMap=[0,0],this._screenRect=qi(),this._tileSize=e.tileSize,this._renderCoordsHelper=e.renderCoordsHelper,this._tilingScheme=e.tilingScheme,this._visibility=new Rmt(e.renderCoordsHelper)}begin(e,t,n){this._camera.copyFrom(e),this._surfaceElevation=n,this._focusOnMap[0]=t.x,this._focusOnMap[1]=t.y,sne(0,0,e.fullWidth,e.fullHeight,this._screenRect),this._visibility.begin(this._camera,n)}end(){this._visibility.end()}updateTile(e){e.measures.visibility=this._visibility.calculate(e),e.measures.distance=v0e(e.extent,this._focusOnMap),e.measures.visibility!==So.INVISIBLE&&this._updateScreenMeasure(e)}_updateScreenMeasure(e){const t=Fmt,n=1<<t,r=e.measures.screenRect;Eh(r);let s=0;const a=e.lij[0]+t,o=e.lij[1]<<t,l=e.lij[2]<<t,c=this._tileSizeWithBias(e),u=c*c;for(let d=0;d<n;d++)for(let h=0;h<n;h++)if(s+=this._computeScreenArea(e,a,o+d,l+h,r),s>u)return void(e.measures.shouldSplit=!0);e.measures.shouldSplit=!1}_tileSizeWithBias(e){return e.measures.visibility===So.VISIBLE_WHEN_EXTENDED?this._tileSize*Nmt:this._tileSize}_computeScreenArea(e,t,n,r,s){const a=e.measures.visibility===So.VISIBLE_WHEN_EXTENDED;this._projectToScreen(t,n,r,a,Yg),Eh(M4);for(let o=0;o<4;o++)EB(M4,Yg[o]);return ry(s,M4,s),sW(Yg[0],Yg[1],Yg[2])+sW(Yg[0],Yg[2],Yg[3])}_projectToScreen(e,t,n,r,s){this._tilingScheme.ensureMaxLod(e),this._tilingScheme.getExtent(e,t,n,KT),this._toRenderCoords(KT,0,3,Xg[0]),this._toRenderCoords(KT,2,3,Xg[1]),this._toRenderCoords(KT,2,1,Xg[2]),this._toRenderCoords(KT,0,1,Xg[3]),r&&(this._projectToPlane(Xg,this._camera.frustum[Jr.NEAR]),this._projectToPlane(Xg,this._camera.frustum[Jr.TOP]),this._projectToPlane(Xg,this._camera.frustum[Jr.BOTTOM]));for(let a=0;a<4;a++)this._camera.projectToRenderScreen(Xg[a],fJ),this._camera.renderToScreen(fJ,s[a])}_projectToPlane(e,t){for(let r=0;r<4;r++)XT[r]=tr(t,e[r]);const n=Math.max(XT[0],XT[1],XT[2],XT[3]);if(n>0){const r=Ye(YT,ro(t),-n);for(let s=0;s<4;s++)rt(e[s],e[s],r)}}_toRenderCoords(e,t,n,r){return YT[0]=e[t],YT[1]=e[n],YT[2]=this._surfaceElevation,this._renderCoordsHelper.toRenderCoords(YT,this._tilingScheme.spatialReference,r),r}};const M4=qi(),Fmt=2,Nmt=5,Yg=[Fn(),Fn(),Fn(),Fn()],KT=qi(),YT=q(),Xg=[q(),q(),q(),q()],XT=[0,0,0,0],fJ=pa();function WFt(i,e,t){if(B(i)||B(t))return!1;let n=!0;return Is[0]=i.xmin!=null?i.xmin:0,Is[1]=i.ymin!=null?i.ymin:0,Is[2]=i.zmin!=null?i.zmin:0,n=n&&Kl(Is,i.spatialReference,0,e,t,0,1),Is[0]=i.xmax!=null?i.xmax:0,Is[1]=i.ymax!=null?i.ymax:0,Is[2]=i.zmax!=null?i.zmax:0,n=n&&Kl(Is,i.spatialReference,0,e,t,3,1),i.xmin==null&&(e[0]=-1/0),i.ymin==null&&(e[1]=-1/0),i.zmin==null&&(e[2]=-1/0),i.xmax==null&&(e[3]=1/0),i.ymax==null&&(e[4]=1/0),i.zmax==null&&(e[5]=1/0),n}function Xfe(i,e,t){if(B(i)||B(t))return!1;let n=!0;return Is[0]=i.xmin!=null?i.xmin:0,Is[1]=i.ymin!=null?i.ymin:0,Is[2]=i.zmin!=null?i.zmin:0,n=n&&Kl(Is,i.spatialReference,0,Is,t,0,1),e[0]=Is[0],e[1]=Is[1],Is[0]=i.xmax!=null?i.xmax:0,Is[1]=i.ymax!=null?i.ymax:0,Is[2]=i.zmax!=null?i.zmax:0,n=n&&Kl(Is,i.spatialReference,0,Is,t,0,1),e[2]=Is[0],e[3]=Is[1],i.xmin==null&&(e[0]=-1/0),i.ymin==null&&(e[1]=-1/0),i.xmax==null&&(e[2]=1/0),i.ymax==null&&(e[3]=1/0),n}const Is=q();let Aa=class extends et{constructor(e){super(e),this.tiles=new _i,this.tileSize=512,this._idToTile=new Map,this._handles=new mi,this._clients=new Set,this._dirty=!1,this._newTiles=new pn}get tilingScheme(){const e=this.tilingSchemeOwner.tilingScheme;return e?e.clone():null}set filterExtent(e){if(T(e)&&!e.spatialReference.equals(this.viewState.spatialReference))return void tt.getLogger(this.declaredClass).error("#extent","extent spatial reference needs to be in the same spatial reference as the view");const t=this._get("filterExtent");if(t===e||T(t)&&e&&t.equals(e))return;const n=T(e)?e.clone():null;this._set("filterExtent",n),this._setDirty()}get _filterExtentRect(){if(B(this.filterExtent)||!this.tilingScheme)return null;const e=qi();return Xfe(this.filterExtent,e,this.tilingScheme.spatialReference),e}get _rootTileIds(){return this._filterExtentRect?this.tilingScheme.rootTilesInExtent(this._filterExtentRect):[[0,0,0]]}set suspended(e){e!==this._get("suspended")&&(this._set("suspended",e),this._setDirty())}get updating(){return this._dirty||!!this._pendingTiles}initialize(){this._handles.add([ue(()=>[this.tilingScheme,this.tileSize],()=>this._reset(),on),ue(()=>{var e,t,n;return[this.tileSize,(e=this.cameraOnSurface)==null?void 0:e.location,this.tilingScheme,(t=this.viewState)==null?void 0:t.contentCamera,(n=this.focus)==null?void 0:n.location]},()=>this._setDirty(),hn)]),this.scheduler&&(this._frameWorker=this.scheduler.registerTask($r.FEATURE_TILE_TREE,this))}destroy(){this._frameWorker=Gr(this._frameWorker),this._handles=_t(this._handles)}addClient(){const e=Bmt();return this._clients.add(e),this._clients.size===1&&this._setDirty(),{remove:()=>this._removeClient(e)}}_removeClient(e){this._clients.delete(e),this._hasClients||this._clear()}get _hasClients(){return this._clients.size>0}_setDirty(){!this._hasClients||this.suspended||this._dirty||(this._frameWorker?(this._dirty=!0,this.notifyChange("updating")):this.runTask(WL))}_clear(){this.tiles.removeAll(),this._idToTile.clear(),this._reset(),this._dirty=!1,this.notifyChange("updating")}get running(){return this.updating}runTask(e){this._dirty=!1,this._pendingTiles||(this._startUpdate(),T(this._frameWorker)&&(this._frameWorker.priority=$r.FEATURE_TILE_TREE_ACTIVE)),this._subdivideTilesForView(e),!this._pendingTiles&&T(this._frameWorker)&&(this._frameWorker.priority=$r.FEATURE_TILE_TREE),this.notifyChange("updating")}_startUpdate(){if(this.suspended)return;if(!this.tilingScheme)return void this._clear();this._tileMeasurements||(this._tileMeasurements=new kmt({renderCoordsHelper:this.renderCoordsHelper,tilingScheme:this.tilingScheme,tileSize:this.tileSize}));const e=this.viewState.contentCamera;this._tileMeasurements.begin(e,this.focus.location,this.cameraOnSurface.location.z),this._pendingTiles=this._getRootTiles()}_reset(){this._newTiles.clear(),this._tileMeasurements=null,this._pendingTiles=null,this._setDirty()}_getRootTiles(){return this._rootTileIds.map(e=>new Ip(e[0],e[1],e[2],this.tilingScheme))}_purgeHorizonTiles(e){e.sort((t,n)=>{const r=t.measures.screenRect,s=n.measures.screenRect;return r[1]+r[3]-(s[1]+s[3])}),Eh(cO);for(let t=0;t<e.length;t++)if(ry(cO,e.data[t].measures.screenRect,cO),vy(cO)>zmt)return e.data.slice(t,e.length);return[]}_subdivideTilesForView(e){if(this._pendingTiles){for(;this._pendingTiles.length>0&&!e.done;){const t=this._pendingTiles.pop();e.madeProgress(),this._filterExtentRect&&!jL(this._filterExtentRect,t.extent)||(this._tileMeasurements.updateTile(t),t.measures.visibility!==So.INVISIBLE&&(t.measures.shouldSplit?(this.tilingScheme.ensureMaxLod(t.lij[0]+1),this._pendingTiles.push(...t.getChildren())):this._newTiles.push(t)))}this._pendingTiles.length===0&&(this._updateTiles(this._purgeHorizonTiles(this._newTiles)),this._newTiles.clear(),this._tileMeasurements.end(),this._pendingTiles=null)}}_updateTiles(e){for(const r of this.tiles.items)r.used=!1;const t=e.filter(r=>{const s=this._idToTile.get(r.id);return s?(s.copyMeasurementsFrom(r),s.used=!0):this._idToTile.set(r.id,r),!s}),n=this.tiles.items.filter(r=>!r.used&&(this._idToTile.delete(r.id),!0));this.tiles.removeMany(n),this.tiles.addMany(t),this._sortTiles()}_sortTiles(){this.viewState.fixedContentCamera||this.tiles.sort((e,t)=>e.measures.visibility!==t.measures.visibility?e.measures.visibility===So.VISIBLE_ON_SURFACE?-1:1:e.measures.distance-t.measures.distance),this.tiles.forEach((e,t)=>e.loadPriority=t)}};f([y({constructOnly:!0})],Aa.prototype,"scheduler",void 0),f([y({constructOnly:!0})],Aa.prototype,"renderCoordsHelper",void 0),f([y({constructOnly:!0})],Aa.prototype,"tilingSchemeOwner",void 0),f([y({constructOnly:!0})],Aa.prototype,"cameraOnSurface",void 0),f([y({constructOnly:!0})],Aa.prototype,"focus",void 0),f([y({constructOnly:!0})],Aa.prototype,"viewState",void 0),f([y({constructOnly:!0})],Aa.prototype,"terrain",void 0),f([y()],Aa.prototype,"tiles",void 0),f([y()],Aa.prototype,"tileSize",void 0),f([y({readOnly:!0})],Aa.prototype,"tilingScheme",null),f([y()],Aa.prototype,"filterExtent",null),f([y({readOnly:!0})],Aa.prototype,"_filterExtentRect",null),f([y({readOnly:!0})],Aa.prototype,"_rootTileIds",null),f([y({value:!1})],Aa.prototype,"suspended",null),f([y({readOnly:!0})],Aa.prototype,"updating",null),Aa=f([ge("esri.views.3d.layers.support.FeatureTileTree3D")],Aa);let Vmt=0;function Bmt(){return Vmt++}const cO=qi(),zmt=10;let ra=class extends et{constructor(){super(...arguments),this._propertiesPool=new Zm({camera:Nn},this),this._lastSeenCameraProjectionValues=new Nn,this.events=new Pn,this.viewingMode=Ot.Global,this._cameraChanged=!1,this._updateQueue=new Array,this._processingUpdates=!1}init(e,t){this._set("viewingMode",e),this._set("spatialReference",t),this._set("constraints",new Jf({mode:this.viewingMode}))}exit(){this.cameraController=null,this._propertiesPool.destroy(),this._propertiesPool=new Zm({camera:Nn},this)}createInitialCamera(){if(this.viewingMode===Ot.Global){const e=rn(this.spatialReference).radius;this.camera=new Nn(Gt(4*e,0,0),Gt(e,0,0),Gt(0,0,1))}else this.camera=new Nn(Gt(0,0,100),Gt(0,0,0),Gt(0,1,0))}get animation(){return this.cameraController instanceof fA&&T(this.cameraController.viewAnimation)?this.cameraController.viewAnimation:null}get camera(){return this._get("camera")}set camera(e){e!==Uu&&Uu.copyFrom(e),Uu.computeUp(this.viewingMode),mJ.camera=Uu,this.events.emit("before-camera-change",mJ);const t=this._get("camera");if(this._cameraProjectionChanged(this._lastSeenCameraProjectionValues,Uu)&&(this._lastSeenCameraProjectionValues.copyFrom(Uu),gJ.camera=this._lastSeenCameraProjectionValues,this.events.emit("camera-projection-changed",gJ)),(!t||!t.equals(Uu))&&(this._set("camera",this._propertiesPool.get("camera").copyFrom(Uu)),this._cameraChanged=!t||!t.almostEquals(Uu),this._cameraChanged)){const n=sie(()=>{this._cameraChanged=!1,n.remove()})}}get pixelRatio(){return this.camera.pixelRatio}get contentCamera(){return T(this._contentCamera)?this._contentCamera:this.camera}set contentCamera(e){this._contentCamera=T(e)?e.clone():null}get fixedContentCamera(){return T(this._contentCamera)}get isGlobal(){return this.viewingMode===Ot.Global}get isLocal(){return this.viewingMode===Ot.Local}get navigating(){return!(!this.cameraController||!this.cameraController.isInteractive)}get stationary(){return!this._cameraChanged&&!this.navigating}get cameraController(){return this._get("cameraController")}set cameraController(e){this.stopActiveCameraController()?(e&&(this.addHandles(rs(()=>e.state===xr.Finished||e.state===xr.Stopped,()=>{this._set("cameraController",null),this.updateCamera(t=>e.onControllerEnd(t))},{sync:!0,once:!0})),e.onControllerStart(this.camera)),this._set("cameraController",e)):e&&(e.state=xr.Rejected)}switchCameraController(e){return this.cameraController=e,e.state!==xr.Rejected}stopActiveCameraController(){return!(this.cameraController&&!this.cameraController.stopController())}updateCamera(e){this._updateQueue.push(e),this._processUpdateQueue()}_processUpdateQueue(){if(this._updateQueue.length===0||this._processingUpdates)return;this._processingUpdates=!0;const e=this._updateQueue.shift();Uu.copyFrom(this._get("camera")),e(Uu),this.camera=Uu,this._processingUpdates=!1,this._processUpdateQueue()}_cameraProjectionChanged(e,t){return e.fov!==t.fov||e.fullViewport[0]!==t.fullViewport[0]||e.fullViewport[1]!==t.fullViewport[1]||e.fullViewport[2]!==t.fullViewport[2]||e.fullViewport[3]!==t.fullViewport[3]||e.padding[li.TOP]!==t.padding[li.TOP]||e.padding[li.RIGHT]!==t.padding[li.RIGHT]||e.padding[li.BOTTOM]!==t.padding[li.BOTTOM]||e.padding[li.LEFT]!==t.padding[li.LEFT]}};f([y()],ra.prototype,"mode",void 0),f([y({readOnly:!0,type:Qm})],ra.prototype,"animation",null),f([y({type:Nn})],ra.prototype,"camera",null),f([y()],ra.prototype,"pixelRatio",null),f([y({})],ra.prototype,"_contentCamera",void 0),f([y({type:Nn})],ra.prototype,"contentCamera",null),f([y({readOnly:!0})],ra.prototype,"fixedContentCamera",null),f([y({readOnly:!0})],ra.prototype,"constraints",void 0),f([y({readOnly:!0})],ra.prototype,"events",void 0),f([y({readOnly:!0})],ra.prototype,"isGlobal",null),f([y({readOnly:!0})],ra.prototype,"isLocal",null),f([y({readOnly:!0})],ra.prototype,"viewingMode",void 0),f([y({readOnly:!0})],ra.prototype,"spatialReference",void 0),f([y()],ra.prototype,"navigating",null),f([y()],ra.prototype,"stationary",null),f([y()],ra.prototype,"_cameraChanged",void 0),f([y()],ra.prototype,"cameraController",null),ra=f([ge("esri.views.3d.state.ViewState")],ra);const Umt=ra,Uu=new Nn,mJ={camera:null},gJ={camera:null};let Hmt=class{constructor(e,t,n){this.viewingMode=e,this._forEachLayer=t,this._view=n,this._externalIntersectionHandlers=new pn,this._tolerance=gC,this._tmpRay=Oc(),this._tmpRegion=qi(),this._validateHUDIntersector=Od(this.viewingMode),this._validateHUDIntersector.options.hud=!1}intersectScreen(e,t,n){return this.intersectRay(this._getPickRay(e,this._tmpRay),vJ(this.viewingMode),t,n)}intersectScreenFreePointFallback(e,t,n){return this.intersectRayFreePointFallback(this._getPickRay(e,this._tmpRay),t,n)}intersectRayFreePointFallback(e,t,n){return this.intersectRay(e,vJ(this.viewingMode),t,n)||this._intersectRayFreePointLocal(e,t)}intersectRay(e,t,n,r){return t.options.selectionMode=!1,t.options.store=Fa.MIN,this.computeIntersection(e,t,r),!!t.results.min&&t.results.min.getIntersectionPoint(n)}getCenterRayWithSubpixelOffset(e,t,n=.5,r=.5){return e.getRenderCenter(hO,n,r),hO[0]+=.0466,hO[1]-=.0123,s7(e,hO,t)}intersectIntersectorScreen(e,t,n){this.computeIntersection(this._getPickRay(e,this._tmpRay),t,n)}intersectToolIntersectorScreen(e,t,n){const r=this._getPickRay(e,this._tmpRay);this.intersectToolIntersectorRay(r,t,n)}intersectToolIntersectorRay(e,t,n){t.options.selectionMode=!0,this.computeIntersection(e,t,n);const r=t.results.min;this._view.basemapTerrain&&this._view.basemapTerrain.opaque||bf(r)&&r.intersector!==Sr.TERRAIN||(t.options.selectionMode=!1,this.computeIntersection(e,t,n))}setTolerance(e=gC){this._tolerance=e}addIntersectionHandler(e){this._externalIntersectionHandlers.push(e),this._externalIntersectionHandlers.sort((t,n)=>t.type===Sr.TERRAIN?1:n.type===Sr.TERRAIN?-1:0)}removeIntersectionHandler(e){this._externalIntersectionHandlers.removeUnordered(e)!=null&&this._externalIntersectionHandlers.sort((t,n)=>t.type===Sr.TERRAIN?1:n.type===Sr.TERRAIN?-1:0)}_getPickRay(e,t){const n=this._view.state.camera;return Zhe(n,e,t)}_intersectRayFreePointLocal(e,t){if(this.viewingMode!==Ot.Local||B(e))return!1;const n=this._view.renderDataExtent;if(B(n))return rt(t,e.origin,mt(si.get(),e.direction)),!0;const r={x:n.xmax-n.xmin,y:n.ymax-n.ymin,z:8*Math.max(n.xmax-n.xmin,n.ymax-n.ymin)},s=Math.max(r.x,r.y,r.z);if(s===0)return rt(t,e.origin,mt(si.get(),e.direction)),!0;const a=this._view.state.camera,o=Math.max(0,n.xmin-a.eye[0],a.eye[0]-n.xmax),l=Math.max(0,n.ymin-a.eye[1],a.eye[1]-n.ymax),c=Math.sqrt(o*o+l*l),u=Math.abs(a.relativeElevation)+Number.MIN_VALUE,d=Math.max(0,Math.log(s/u))**2;let h=s/Math.max(1,d);h=Math.max(h,Math.min(c,s));const p=Et(e.direction),m=Ye(si.get(),e.direction,p===0?h:h/p);return rt(t,e.origin,m),!0}intersectElevationFromScreen(e,t,n=0,r=null){return this._intersectElevation(this._getPickRay(e,this._tmpRay),t,n,r)}_intersectElevation(e,t,n=0,r=null){if(B(e))return null;const s=T(t)?t.mode:"absolute-height",a=T(t)?Jt(t.offset,0):0,o=s!=="on-the-ground"?a+n:0,l=o/this._view.renderCoordsHelper.unitInMeters;if(s==="absolute-height"){if(this._view.renderCoordsHelper.intersectInfiniteManifold(e,o,dO)){const x=this._view.computeMapPointFromVec3d(dO);return x.z-=a,x}return null}const c=this._view.state.camera,u=Vx(si.get());c.projectToRenderScreen(e.origin,u);const d=new yJ(null,this._forEachLayer),h=this._view.slicePlane,p=T(h)?YX(h):null,m=Od(this.viewingMode);m.options.store=Fa.MIN,m.options.verticalOffset=l;const g=e.origin,_=rt(si.get(),g,e.direction);m.reset(g,_,c),m.point=u;const b=T(r)?"type"in r&&r.type==="graphics"?x=>x.metadata.layerUid!==r.uid:x=>x.metadata.graphicUid!==r.uid:null;switch(s){case"relative-to-scene":{const x=w=>(B(b)||b(w))&&w.metadata&&w.metadata.isElevationSource;m.intersect(d.layers,u,this._tolerance,null,x),this._externalIntersectionHandlers.forAll(w=>{if(w.type===Sr.I3S||w.type===Sr.TERRAIN){const C=w.slicePlaneEnabled?p:null;w.intersect(m,C,m.rayBegin,m.rayEnd,u)}})}break;case"on-the-ground":case"relative-to-ground":this._externalIntersectionHandlers.forAll(x=>{if(x.isGround){const w=x.slicePlaneEnabled?p:null;x.intersect(m,w,m.rayBegin,m.rayEnd,u)}})}if(m.results.min.getIntersectionPoint(dO)){const x=this._view.computeMapPointFromVec3d(dO);return x.z=n,x}return null}computeIntersection(e,t,n){if(B(e))return;const r=this._view.state.camera,s=Vx(si.get());r.projectToRenderScreen(e.origin,s);const a=new yJ(n,this._forEachLayer);t.options.selectOpaqueTerrainOnly=!n||!("include"in n||"exclude"in n);const o=e.origin,l=rt(si.get(),e.origin,e.direction);t.reset(o,l,r),t.intersect(a.layers,s,this._tolerance);const c=this._view.slicePlane,u=T(c)?YX(c):null;t.intersect(a.sliceableLayers,s,this._tolerance,u);const d=n&&(n.requiresGroundFeedback||n.enableDraped);this._externalIntersectionHandlers.forAll(m=>{if(t.options.isFiltered=!a.filterLayerUid(m.layerUid),m.isGround&&d||!t.options.isFiltered){const g=m.slicePlaneEnabled?u:null;m.intersect(t,g,o,l,s)}});const h=si.get(),p=this._view.basemapTerrain;if(n&&n.enableDraped&&T(p.spatialReference)&&t.results.ground.getIntersectionPoint(h)){const m=p.overlayManager.renderer,g=this._view.renderCoordsHelper.spatialReference,_=si.get();this._view.renderCoordsHelper.fromRenderCoords(h,_,p.spatialReference),_[2]=Jt(this._view.elevationProvider.getElevation(h[0],h[1],h[2],g,"ground"),0),m.intersect(t,_,t.results.ground,b=>a.filterRenderGeometry(b))}t.sortResults(),this._processHUDResults(t)}_processHUDResults(e){const t=e.results.hud;u2(this._tmpRegion,y0e);const n=this._view.state.camera,r=[],s=this._tmpRegion,a=b=>{const x=new Wmt(b);n.projectToRenderScreen(b.target.center,x.screenPoint),x.screenPoint[0]=Math.floor(x.screenPoint[0]),x.screenPoint[1]=Math.floor(x.screenPoint[1]),r.push(x),EB(s,x.screenPoint)};e.sortResults(t.all),T(t.min.dist)&&a(t.min);for(const b of t.all)t.min.target.object!==b.target.object&&t.max.target.object!==b.target.object&&a(b);if(T(t.max.dist)&&t.max.target.object!==t.min.target.object&&a(t.max),!r.length)return;s[0]===s[2]&&(s[2]+=1),s[1]===s[3]&&(s[3]+=1);const o=n.fullWidth,l=n.fullHeight,c=Math.max(0,s[0]-DS),u=Math.max(0,s[1]-DS),d=Math.min(Mp(s)+2*DS,o-c),h=Math.min(vy(s)+2*DS,l-u),p=new Uint8Array(d*h*4);this._view._stage.renderView.readHUDVisibility(c,u,d,h,p);let m=!0;const g=B(e.results.max.dist);let _=0;for(const b of r)for(const x of Gmt)if(p[4*(Math.min(b.screenPoint[0]+x[0],o)-s[0]+(Math.min(b.screenPoint[1]+x[1],l)-s[1])*d)]){m&&(e.results.min.copy(b.result),m=!1),g&&e.results.max.copy(b.result),e.options.store===Fa.ALL&&e.results.all.splice(_++,0,b.result);break}}};const DS=1,Gmt=(()=>{const i=[],e=DS;for(let t=-e;t<=e;t++)for(let n=-e;n<=e;n++)i.push([n+e,t+e]);return i})();let Wmt=class{constructor(e){this.result=e,this.screenPoint=pa()}},uO;function vJ(i){return uO&&uO.viewingMode===i||(uO=Od(i)),uO}let yJ=class{constructor(e,t){this.layers=new Array,this.sliceableLayers=new Array,this.include=e==null?void 0:e.include,this.exclude=e==null?void 0:e.exclude,t(n=>{n.isPickable&&this.filterLayerUid(n.apiLayerUid)&&(n.isSliceable?this.sliceableLayers:this.layers).push(n)})}filterLayerUid(e){const{include:t,exclude:n}=this;return B(e)?t==null&&n==null:(t==null||t.has(e))&&(n==null||!n.has(e))}filterRenderGeometry(e){return this.filterLayerUid(e.layerUid)}};function _J(i){return typeof i=="object"&&"intersect"in i}const dO=q(),hO=pa();let ZFt=class{constructor(e,t){this.spatialReference=e,this._view=t}getElevation(e,t,n){return this._view.elevationProvider.getElevation(e,t,0,this.spatialReference,n)}async queryElevation(e,t,n,r,s){return this._view.elevationProvider.queryElevation(e,t,0,this.spatialReference,s,n,r)}},jmt=class{constructor(e,t,n,r){this.spatialReference=t,this._getElevationQueryProvider=n,this._queries=new Array,this._queryOptions={...r,ignoreInvisibleLayers:!0},this._frameTask=e.registerTask($r.ELEVATION_QUERY,this)}destroy(){this._frameTask.remove()}queryElevation(e,t,n,r=0){return new Promise((s,a)=>{const o={x:e,y:t,minDemResolution:r,result:{resolve:s,reject:a},signal:n};this._queries.push(o),Bm(n,()=>{BI(this._queries,o),a(js())})})}get running(){return this._queries.length>0}runTask(){const e=this._queries;this._queries=[];const t=this._getElevationQueryProvider();if(!t)return void e.forEach(c=>c.result.reject());const n=e.map(c=>[c.x,c.y]),r=e.reduce((c,u)=>Math.min(c,u.minDemResolution),1/0),s=new V_e({points:n,spatialReference:this.spatialReference}),a=e.length>1&&e.some(c=>!!c.signal)?new AbortController:null,o=T(a)?a.signal:e[0].signal;if(T(a)){let c=0;e.forEach(u=>Bm(u.signal,()=>{c++,u.result.reject(js()),c===e.length&&a.abort()}))}const l={...this._queryOptions,minDemResolution:r,signal:o};t.queryElevation(s,l).then(c=>{e.forEach((u,d)=>{T(u.signal)&&u.signal.aborted?u.result.reject(js()):u.result.resolve(c.geometry.points[d][2])})}).catch(c=>{e.forEach(u=>u.result.reject(c))})}get test(){const e=this;return{update:()=>e._queries.length>0&&e.runTask()}}},kS=class extends Pn.EventedMixin(et){constructor(e){super(e),this._im=new Array,this._ground=new Array,this._scene=new Array,this._handles=new Map,this.lastElevationQuery=null,this.elevationCacheEnabled=!1}get spatialReference(){var e,t;return(t=(e=this.view)==null?void 0:e.basemapTerrain)==null?void 0:t.spatialReference}destroy(){this._elevationQueryCached=_t(this._elevationQueryCached)}get _elevationQuery(){return B(this._elevationQueryCached)&&(this._elevationQueryCached=new jmt(this.view.resourceController.scheduler,this.view.spatialReference,()=>this.view.map&&this.view.map.ground,{maximumAutoTileRequests:4})),this._elevationQueryCached}enableElevationCache(e){e||(this.lastElevationQuery=null),this.elevationCacheEnabled=e}getElevation(e,t,n,r,s){if(this.elevationCacheEnabled&&this.lastElevationQuery!=null){const o=this.lastElevationQuery;if(e===o.x&&t===o.y&&n===o.z&&Vc(r,o.spatialReference)&&s===o.queryContext)return o.result}let a=null;return a=pO(a,this._im,e,t,n,r,s),B(a)&&(a=pO(a,this._ground,e,t,n,r,s)),s==="scene"&&(a=pO(a,this._scene,e,t,n,r,s)),this.elevationCacheEnabled&&(this.lastElevationQuery={x:e,y:t,z:n,spatialReference:r,queryContext:s,result:a}),a}queryElevation(e,t,n,r,s,a=null,o=0){const l=_b();return this._elevationQuery.queryElevation(e,t,a,o).then(c=>{s==="scene"&&(c=pO(c,this._scene,e,t,n,r,s)),l.resolve(c)}).catch(c=>{zo(c)?l.reject(c):l.resolve(this.getElevation(e,t,n,r,s))}),l.promise}register(e,t){this._handles.set(t,t.on("elevation-change",n=>this.emit("elevation-change",n))),this._providersFromContext(e).push(t)}unregister(e){this._handles.has(e)&&(this._handles.get(e).remove(),this._handles.delete(e));for(const t of[this._im,this._ground,this._scene]){const n=t.indexOf(e);n>-1&&t.splice(n,1)}}_providersFromContext(e){switch(e){case"ground":return this._ground;case"im":return this._im;case"scene":return this._scene}}};function pO(i,e,t,n,r,s,a){for(const o of e){const l=o.getElevation(t,n,r,s,a);T(l)&&(i=T(i)?Math.max(l,i):l)}return i}f([y({constructOnly:!0})],kS.prototype,"view",void 0),f([y()],kS.prototype,"spatialReference",null),kS=f([ge("esri.views.3d.support.CombinedElevationProvider")],kS);let I0=class{static isValidProfile(e){return e in I0.profiles}static getDefaultProfile(){return Fi("trident")||Fi("esri-iPhone")?"low":"medium"}static apply(e,t){const n=I0.profiles[e];t.graphics3D.maxTotalNumberOfFeatures=n.graphics3D.maxTotalNumberOfFeatures,t.graphics3D.maxTotalNumberOfPrimitives=n.graphics3D.maxTotalNumberOfPrimitives,t.graphics3D.polygonLodFactor=n.graphics3D.polygonLodFactor,t.graphics3D.polylineLodFactor=n.graphics3D.polylineLodFactor,t.graphics3D.snapshotAvailable=n.graphics3D.snapshotAvailable,t.graphics3D.skipHighSymbolLods=n.graphics3D.skipHighSymbolLods;{const r=t.sceneService.object,s=n.sceneService.object;r.lodFactor=s.lodFactor,r.lodCrossfadeinDuration=s.lodCrossfadeinDuration,r.lodCrossfadeoutDuration=s.lodCrossfadeoutDuration,r.lodCrossfadeUncoveredDuration=s.lodCrossfadeUncoveredDuration}t.sceneService.point.lodFactor=n.sceneService.point.lodFactor,t.sceneService.integratedMesh.lodFactor=n.sceneService.integratedMesh.lodFactor,t.sceneService.pointCloud.lodFactor=n.sceneService.pointCloud.lodFactor,t.sceneService.uncompressedTextureDownsamplingEnabled=n.sceneService.uncompressedTextureDownsamplingEnabled,t.tiledSurface.lodBias=n.tiledSurface.lodBias,t.tiledSurface.angledSplitBias=n.tiledSurface.angledSplitBias,t.tiledSurface.reduceTileLevelDifferences=n.tiledSurface.reduceTileLevelDifferences,t.tiledSurface.textureFadeDuration=n.tiledSurface.textureFadeDuration,t.heatmap.pixelRatio=n.heatmap.pixelRatio,t.heatmap.maxTotalNumberOfFeatures=n.heatmap.maxTotalNumberOfFeatures,t.weatherFadeDuration=n.weatherFadeDuration,t.antialiasingEnabled=n.antialiasingEnabled,t.physicallyBasedRenderingEnabled=n.physicalBasedRenderingEnabled,t.highQualityTransparency=n.highQualityTransparency,t.memoryLimit=n.memoryLimit,t.additionalCacheMemory=n.additionalCacheMemory,t.frameRate=n.frameRate,t.maximumRenderResolution=n.maximumRenderResolution,t.maximumPixelRatio=n.maximumPixelRatio}};function bJ(){const i=!!Fi("esri-mobile"),e=!!Fi("ios"),t=Wi(400);return{low:{graphics3D:{maxTotalNumberOfFeatures:25e3,maxTotalNumberOfPrimitives:85e4,polygonLodFactor:.5,polylineLodFactor:1,snapshotAvailable:!1,skipHighSymbolLods:!0},heatmap:{pixelRatio:.125,maxTotalNumberOfFeatures:25e3},sceneService:{object:{lodFactor:.2,lodCrossfadeinDuration:Wi(0),lodCrossfadeoutDuration:Wi(0),lodCrossfadeUncoveredDuration:Wi(0)},point:{lodFactor:1},integratedMesh:{lodFactor:.6},pointCloud:{lodFactor:.5},uncompressedTextureDownsamplingEnabled:!0},tiledSurface:{lodBias:-1,angledSplitBias:.5,reduceTileLevelDifferences:!1,textureFadeDuration:Wi(0)},weatherFadeDuration:Wi(0),antialiasingEnabled:!1,physicalBasedRenderingEnabled:!1,highQualityTransparency:!1,memoryLimit:200,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:void 0,maximumPixelRatio:1},medium:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:i?.8:1,polylineLodFactor:i?1.2:1.5,snapshotAvailable:!e,skipHighSymbolLods:!1},heatmap:{pixelRatio:.25,maxTotalNumberOfFeatures:5e4},sceneService:{object:{lodFactor:1,lodCrossfadeinDuration:Wi(0),lodCrossfadeoutDuration:Wi(0),lodCrossfadeUncoveredDuration:t},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:i},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!Fi("disable-feature:reduce-map-tile-levels"),textureFadeDuration:t},weatherFadeDuration:t,antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:i?600:750,additionalCacheMemory:i?0:150,frameRate:0,maximumRenderResolution:void 0,maximumPixelRatio:1},high:{graphics3D:{maxTotalNumberOfFeatures:5e4,maxTotalNumberOfPrimitives:17e5,polygonLodFactor:i?1.2:2,polylineLodFactor:i?1.2:2,snapshotAvailable:!e,skipHighSymbolLods:!1},heatmap:{pixelRatio:.5,maxTotalNumberOfFeatures:5e4},sceneService:{object:{lodFactor:1,lodCrossfadeinDuration:Wi(0),lodCrossfadeoutDuration:Wi(0),lodCrossfadeUncoveredDuration:t},point:{lodFactor:1},integratedMesh:{lodFactor:1},pointCloud:{lodFactor:1},uncompressedTextureDownsamplingEnabled:!1},tiledSurface:{lodBias:0,angledSplitBias:1,reduceTileLevelDifferences:!Fi("disable-feature:reduce-map-tile-levels"),textureFadeDuration:t},weatherFadeDuration:t,antialiasingEnabled:!0,physicalBasedRenderingEnabled:!0,highQualityTransparency:!0,memoryLimit:i?900:1500,additionalCacheMemory:0,frameRate:0,maximumRenderResolution:i?void 0:4096,maximumPixelRatio:i?1:void 0}}}I0.debug={reset(){const i=bJ();for(const e in i)I0.profiles[e]=i[e]}},function(i){i.profiles=bJ()}(I0||(I0={}));const uI=I0;let up=class extends et{constructor(){super(...arguments),this.color=new Xt([0,255,255]),this.haloColor=null,this.haloOpacity=1,this.fillOpacity=.25,this.shadowOpacity=.4,this.shadowColor=new Xt([0,0,0]),this.shadowDifference=.2}static toEngineOptions(e){const t=Xt.toUnitRGBA(e.color),n=T(e.haloColor)?Xt.toUnitRGBA(e.haloColor):t,r=Xt.toUnitRGBA(e.shadowColor);return{color:Kx(t[0],t[1],t[2],t[3]),haloColor:Kx(n[0],n[1],n[2],n[3]),haloOpacity:e.haloOpacity,haloOpacityOccluded:.25*e.haloOpacity,fillOpacity:e.fillOpacity,fillOpacityOccluded:.25*e.fillOpacity,shadowOpacity:e.shadowOpacity,shadowColor:Xn(r[0],r[1],r[2],r[3]),occludedShadowOpacity:e.shadowOpacity*(1-e.shadowDifference)}}};f([y({type:Xt})],up.prototype,"color",void 0),f([y({type:Xt})],up.prototype,"haloColor",void 0),f([y()],up.prototype,"haloOpacity",void 0),f([y()],up.prototype,"fillOpacity",void 0),f([y()],up.prototype,"shadowOpacity",void 0),f([y({type:Xt})],up.prototype,"shadowColor",void 0),f([y()],up.prototype,"shadowDifference",void 0),up=f([ge("esri.views.3d.support.HighlightOptions")],up);const i8=up;let z_=class extends Wo{constructor(e){super(e),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(r=>r.toJSON()),t=this.geometries[0],n={};return n.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),n.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),n.geometries=JSON.stringify({geometryType:bie(t),geometries:e}),this.transformation&&(n.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(n.transformForward=this.transformForward),n}};f([y()],z_.prototype,"geometries",void 0),f([y({json:{read:{source:"outSR"}}})],z_.prototype,"outSpatialReference",void 0),f([y()],z_.prototype,"transformation",void 0),f([y()],z_.prototype,"transformForward",void 0),z_=f([ge("esri.rest.support.ProjectParameters")],z_);const Q7=z_,qmt=kL(Q7);async function Zfe(i,e,t){e=qmt(e);const n=B_e(i),r={...n.query,f:"json",...e.toJSON()},s=e.outSpatialReference,a=bie(e.geometries[0]),o=z_e(r,t);return Mc(n.path+"/project",o).then(({data:{geometries:l}})=>U_e(l,a,s))}async function J7(i=null,e){var r,s;if(QE.geometryServiceUrl)return QE.geometryServiceUrl;if(!i)throw new Ze("internal:geometry-service-url-not-configured");let t;t="portal"in i?i.portal||cz.getDefault():i,await t.load({signal:e});const n=(s=(r=t.helperServices)==null?void 0:r.geometry)==null?void 0:s.url;if(!n)throw new Ze("internal:geometry-service-url-not-configured");return n}async function Kmt(i,e,t=null,n){const r=await J7(t,n),s=new Q7;s.geometries=[i],s.outSpatialReference=e;const a=await Zfe(r,s,{signal:n});if(a&&Array.isArray(a)&&a.length===1)return a[0];throw new Ze("internal:geometry-service-projection-failed")}const Ymt=Object.freeze(Object.defineProperty({__proto__:null,getGeometryServiceURL:J7,projectGeometry:Kmt},Symbol.toStringTag,{value:"Module"}));let Xmt=class{constructor(e,t){this.spatialReference=t,this.unitInMeters=rf(this.spatialReference,rn(this.spatialReference).metersPerDegree),this._geometryServiceURLPromise=J7(e&&e.get("portalItem")).catch(()=>{throw new Ze("mapcoordshelper:missing-geometry-service","Must specify geometryService in esri/config")})}async toGeographic(e){const t=await this._geometryServiceURLPromise;let n,r=!0;Array.isArray(e[0])&&typeof e[0]!="number"?n=e:(n=[e],r=!1);const s=n.map(l=>l instanceof Wt?l:new Wt(l,this.spatialReference)),a=new Q7({geometries:s,outSpatialReference:$n.WGS84}),o=(await Zfe(t,a)).map(l=>l.type==="point"?[l.x,l.y]:void 0);return r?o:o[0]}},Jd=class extends et{constructor(){super(...arguments),this.minTotalNumberOfFeatures=2e3,this.maxTotalNumberOfFeatures=5e4,this.maxTotalNumberOfPrimitives=17e5,this.snapshotAvailable=!0,this.polygonLodFactor=1,this.polylineLodFactor=1,this.skipHighSymbolLods=!1}};f([y()],Jd.prototype,"minTotalNumberOfFeatures",void 0),f([y()],Jd.prototype,"maxTotalNumberOfFeatures",void 0),f([y()],Jd.prototype,"maxTotalNumberOfPrimitives",void 0),f([y()],Jd.prototype,"snapshotAvailable",void 0),f([y()],Jd.prototype,"polygonLodFactor",void 0),f([y()],Jd.prototype,"polylineLodFactor",void 0),f([y()],Jd.prototype,"skipHighSymbolLods",void 0),Jd=f([ge("esri.views.3d.support.QualitySettings.Graphics3DSettings")],Jd);let Yp=class extends et{constructor(){super(...arguments),this.lodFactor=1}};f([y()],Yp.prototype,"lodFactor",void 0),Yp=f([ge("esri.views.3d.support.QualitySettings.LoDFactorSettings")],Yp);let uL=class extends Yp{constructor(){super(...arguments),this.lodCrossfadeinDuration=Wi(0),this.lodCrossfadeoutDuration=Wi(0),this.lodCrossfadeUncoveredDuration=Wi(0)}};uL=f([ge("esri.views.3d.support.QualitySettings.LoDFactor3DObjectSettings")],uL);let um=class extends et{constructor(){super(...arguments),this.object=new uL,this.point=new Yp,this.integratedMesh=new Yp,this.pointCloud=new Yp,this.uncompressedTextureDownsamplingEnabled=!1}};f([y({type:uL})],um.prototype,"object",void 0),f([y({type:Yp})],um.prototype,"point",void 0),f([y({type:Yp})],um.prototype,"integratedMesh",void 0),f([y({type:Yp})],um.prototype,"pointCloud",void 0),f([y()],um.prototype,"uncompressedTextureDownsamplingEnabled",void 0),um=f([ge("esri.views.3d.support.QualitySettings.SceneServiceSettings")],um);let Fv=class extends et{constructor(){super(...arguments),this.lodBias=0,this.angledSplitBias=1,this.reduceTileLevelDifferences=!0,this.textureFadeDuration=Wi(400)}};f([y()],Fv.prototype,"lodBias",void 0),f([y()],Fv.prototype,"angledSplitBias",void 0),f([y()],Fv.prototype,"reduceTileLevelDifferences",void 0),f([y()],Fv.prototype,"textureFadeDuration",void 0),Fv=f([ge("esri.views.3d.support.QualitySettings.TiledSurfaceSettings")],Fv);let Xw=class extends et{constructor(){super(...arguments),this.pixelRatio=1,this.maxTotalNumberOfFeatures=5e4}};f([y()],Xw.prototype,"pixelRatio",void 0),f([y()],Xw.prototype,"maxTotalNumberOfFeatures",void 0),Xw=f([ge("esri.views.3d.support.QualitySettings.HeatmapSettings")],Xw);let el=class extends et{constructor(){super(...arguments),this.graphics3D=new Jd,this.sceneService=new um,this.tiledSurface=new Fv,this.heatmap=new Xw,this.weatherFadeDuration=Wi(400),this.antialiasingEnabled=!0,this.physicallyBasedRenderingEnabled=!1,this.highQualityTransparency=!0,this.memoryLimit=void 0,this.additionalCacheMemory=void 0,this.frameRate=void 0,this.maximumRenderResolution=void 0,this.maximumPixelRatio=void 0}};f([y({type:Jd})],el.prototype,"graphics3D",void 0),f([y({type:um})],el.prototype,"sceneService",void 0),f([y({type:Fv})],el.prototype,"tiledSurface",void 0),f([y({type:Xw})],el.prototype,"heatmap",void 0),f([y()],el.prototype,"weatherFadeDuration",void 0),f([y()],el.prototype,"antialiasingEnabled",void 0),f([y()],el.prototype,"physicallyBasedRenderingEnabled",void 0),f([y()],el.prototype,"highQualityTransparency",void 0),f([y()],el.prototype,"memoryLimit",void 0),f([y()],el.prototype,"additionalCacheMemory",void 0),f([y()],el.prototype,"frameRate",void 0),f([y()],el.prototype,"maximumRenderResolution",void 0),f([y()],el.prototype,"maximumPixelRatio",void 0),el=f([ge("esri.views.3d.support.QualitySettings.QualitySettings")],el);const wJ=el;function Zmt(i){return mie(i)&&i.length>=3}function Qmt(i){return(gie(i)||Array.isArray(i))&&i.length>=3}function Jmt(i){return Zmt(i)||Qmt(i)}let n8=class{constructor(e,t,n,r){this.viewingMode=e,this.spatialReference=t,this.unitInMeters=n,this._coordinateSystem=r,this._tmpCoordinateSystem=vnt(r)}set extent(e){e&&ynt(this._coordinateSystem,e,this._coordinateSystem)}getAltitude(e){return Ent(this._coordinateSystem,e)}setAltitude(e,t,n=e){return mhe(this._coordinateSystem,n,t,e)}setAltitudeOfTransformation(e,t){Ant(this._coordinateSystem,t,e,t)}worldUpAtPosition(e,t){return xnt(this._coordinateSystem,e,t)}worldBasisAtPosition(e,t,n){return Cnt(this._coordinateSystem,e,t,n)}basisMatrixAtPosition(e,t){const n=this.worldBasisAtPosition(e,dh.X,si.get()),r=this.worldBasisAtPosition(e,dh.Y,si.get()),s=this.worldBasisAtPosition(e,dh.Z,si.get());return hne(t,n[0],n[1],n[2],0,r[0],r[1],r[2],0,s[0],s[1],s[2],0,0,0,0,1),t}headingAtPosition(e,t){const n=this.worldUpAtPosition(e,si.get()),r=this.worldBasisAtPosition(e,dh.Y,si.get()),s=lne(t,r,n);return ql(s)}intersectManifoldClosestSilhouette(e,t,n){return uF(this._coordinateSystem,t,this._tmpCoordinateSystem),Snt(this._tmpCoordinateSystem,e,n),n}intersectManifold(e,t,n){uF(this._coordinateSystem,t,this._tmpCoordinateSystem);const r=si.get();return Tnt(this._tmpCoordinateSystem,e,r)?Ge(n,r):null}intersectInfiniteManifold(e,t,n){if(this.viewingMode===Ot.Global)return this.intersectManifold(e,t,n);uF(this._coordinateSystem,t,this._tmpCoordinateSystem);const r=this._tmpCoordinateSystem.value,s=si.get();return xb(r.plane,e,s)?Ge(n,s):null}toRenderCoords(e,t,n){return K$(e)?ya(e,t,this.spatialReference):no(e,t,n,this.spatialReference)}fromRenderCoords(e,t,n=null){return K$(t)?(T(n)&&(t.spatialReference=n),Tie(e,this.spatialReference,t)):Jmt(t)?no(e,this.spatialReference,t,n)?t:null:fy(e,this.spatialReference,t)}static create(e,t){switch(e){case Ot.Local:return new n8(Ot.Local,t,rf(t),wnt());case Ot.Global:return new n8(Ot.Global,t,1,bnt(t))}}static renderUnitScaleFactor(e,t){return xJ(e)/xJ(t)}};function xJ(i){if(vA(i,Ot.Global))return 1;const e=ghe(!1,i);return rf(e)}var $p;(function(i){i[i.ELEVATION=0]="ELEVATION",i[i.BASEMAP=1]="BASEMAP",i[i.I3S_INDEX=2]="I3S_INDEX",i[i.I3S_DATA=3]="I3S_DATA",i[i.SYMBOLOGY=4]="SYMBOLOGY"})($p||($p={}));const egt=(()=>{const i=new Array;return i[$p.ELEVATION]=10,i[$p.BASEMAP]=10,i[$p.I3S_INDEX]=10,i[$p.I3S_DATA]=10,i[$p.SYMBOLOGY]=5,i})(),tgt=30;function Qfe(i){return typeof i.getUsedMemory=="function"}function igt(i){return new Pl({view:i})}const fO=1,P4=1,ngt=.75,rgt=.6,CJ=1.3;let Pl=class extends et{constructor(e){super(e),this._quality=1,this._memoryUsed=0,this._updating=!1,this.minQuality=.1,this._stableQuality=0,this._downscaleMemoryUsed=0,this._canFastRecover=!1,this._memoryPredicted=0,this._cacheStorage=new _we,this._warnMemoryUsage=null,this._numQualityChanges=0,this._maxMemory=500,this._additionalCacheMemory=100}destroy(){this._cacheStorage.destroy()}set maxMemory(e){e==null||e<=0||(this._stableQuality=0,this._canFastRecover=!1,this._maxMemory<e&&this._updateQuality(fO),this._maxMemory=e)}get maxMemory(){return this._maxMemory}set additionalCacheMemory(e){e!=null&&e>=0&&(this._additionalCacheMemory=e)}get additionalCacheMemory(){return this._additionalCacheMemory}get memoryFactor(){return this._quality}get updating(){return this._updating}get usedMemory(){return this._memoryUsed}newCache(e,t){return new bwe(e,this._cacheStorage,t)}resetStableQuality(){this._stableQuality=0}disableMemCache(){this.additionalCacheMemory=-4096}update(){if(this._updateMemory(),this._memoryPredicted<=0&&!this._updating)return;let e=this._layersUpdating();if(this._memoryPredicted<rgt&&this._canFastRecover)this._downscaleMemoryUsed=0,this._stableQuality=0,this._canFastRecover=!1,this._updateQuality(fO);else if(e)(this._memoryPredicted>1.1*P4||this._memoryUsed>P4)&&(this._stableQuality>0?(this._downscaleMemoryUsed=0,this._updateQuality(this._stableQuality)):this._quality>this.minQuality&&this._downscaleMemoryUsed<this._memoryUsed&&(this._updateQuality(this._quality/CJ),this._downscaleMemoryUsed=this._memoryUsed,this._canFastRecover=!1));else if(this._downscaleMemoryUsed=0,this._memoryUsed>P4)this._stableQuality=0,this._canFastRecover=!1,e=this._updateQuality(this._quality/CJ),this._downscaleMemoryUsed=this._memoryPredicted;else if(this._stableQuality!==this._quality)if(this._memoryUsed<ngt&&this._quality<fO){this._stableQuality=this._quality;const t=.05;e=this._updateQuality(this._quality+t)}else this._quality<1&&(this._canFastRecover=!0);this._updating=e}_updateQuality(e){return(e=Math.min(Math.max(e,this.minQuality),fO))!==this._quality&&(this._quality=e,++this._numQualityChanges,!0)}_layersUpdating(){return this.view.allLayerViews.some(e=>!!e.updating)}_updateMemory(){let e=0,t=0;this.view.basemapTerrain&&this.view.basemapTerrain.getUsedMemory&&(e+=this.view.basemapTerrain.getUsedMemory());const n=this.view._stage&&this.view._stage.renderView&&this.view._stage.renderView.edgeView;T(n)&&(e+=n.usedMemory),this.view.allLayerViews&&this.view.allLayerViews.forEach(o=>{if(Qfe(o)){const l=o.ignoresMemoryFactor()?this._quality:1;e+=o.getUsedMemory()*l,t+=o.getUnloadedMemory()*l}});const r=B(this._warnMemoryUsage)||Math.round(10*e)!==Math.round(10*this._warnMemoryUsage),s=1048576*this.maxMemory;if(e>s&&r){this._warnMemoryUsage=e;const o=c=>(c/1048576).toLocaleString(void 0,{maximumFractionDigits:1})+" MB",l=Math.round(100*this._quality);tt.getLogger(this.declaredClass).warn(`Memory Limit exceeded! Limit: ${o(s)} Current: ${o(e)} Projected: ${o(e+t)} Quality: ${l}%`)}this._memoryUsed=e/s,this._memoryPredicted=(e+t)/s;const a=s-e;this._cacheStorage.maxSize=Math.max(0,a+1048576*this.additionalCacheMemory)}get test(){const e=this;return{cacheStorage:this._cacheStorage,resetQualityChanges:()=>{const t=e._numQualityChanges;return e._numQualityChanges=0,t}}}};f([y({constructOnly:!0})],Pl.prototype,"view",void 0),f([y()],Pl.prototype,"maxMemory",null),f([y()],Pl.prototype,"additionalCacheMemory",null),f([y()],Pl.prototype,"memoryFactor",null),f([y()],Pl.prototype,"updating",null),f([y()],Pl.prototype,"usedMemory",null),f([y()],Pl.prototype,"_quality",void 0),f([y()],Pl.prototype,"_memoryUsed",void 0),f([y()],Pl.prototype,"_updating",void 0),f([y()],Pl.prototype,"_stableQuality",void 0),f([y()],Pl.prototype,"_maxMemory",void 0),f([y()],Pl.prototype,"_additionalCacheMemory",void 0),Pl=f([ge("esri.views.3d.support.MemoryControllerImpl")],Pl);let sgt=class{constructor(e){this.client=e,this._cancelled=!1,this.size=0,this.duration=0}},agt=class{constructor(e){this.typeWorkerQuota=e,this.tasks=new Array,this.numWorkers=0,this.statistics=new ogt}},ogt=class{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}},lgt=class{constructor(e,t,n,r){this._workerFunc=e,this._callbackFunc=t,this._maxTotalNumWorkers=n,this._totalNumWorkers=0,this._clients=r.map(s=>new agt(s))}destroy(){this._clients.length=0}hasQuota(e){const t=this._clients[e];return!!t&&(this._totalNumWorkers<this._maxTotalNumWorkers||t.numWorkers+t.tasks.length<t.typeWorkerQuota)}push(e){const t=this._clients[e.client];t&&(this._totalNumWorkers<this._maxTotalNumWorkers?(t.numWorkers++,this._totalNumWorkers++,this._workerFunc(e,(n,r)=>this._taskCallback(n,r))):t.tasks.push(e))}cancel(e){this._taskFinished(e),e._cancelled=!0}_taskFinished(e){const t=this._clients[e.client];this._totalNumWorkers--,t.numWorkers--,t.statistics.requests++,t.statistics.size+=e.size||0,t.statistics.duration+=e.duration||0,t.statistics.speed=t.statistics.duration>0?t.statistics.size/t.statistics.duration:0,Ti(t.numWorkers>=0),this._next()}_next(){for(const e of this._clients)if(e&&e.numWorkers<e.typeWorkerQuota&&this._processQueue(e))return;for(const e of this._clients)if(e&&this._processQueue(e))return}_processQueue(e){for(;e.tasks.length>0;)if(this._workerFunc(e.tasks.shift(),(t,n)=>this._taskCallback(t,n)))return e.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(e,t){e._cancelled||(this._callbackFunc(e,t),this._taskFinished(e))}getStatsForType(e){const t=this._clients[e];return t?{quota:t.typeWorkerQuota,workers:t.numWorkers,queueSize:t.tasks.length,requestStats:t.statistics}:null}get test(){const e=this;return{set workerFunc(t){e._workerFunc=t}}}},dI=class extends et{constructor(){super(...arguments),this._tasks=new Map,this._onLoadQueue=new Array,this._doneQueue=new Array,this.updating=!1}setup(e,t,n){this._loadQueue=new lgt((r,s)=>this._startLoading(r,s),(r,s)=>this._doneLoadingCB(r,s),e,t),n&&(this._frameTask=n.registerTask($r.STREAM_DATA_LOADER,this))}destroy(){this._frameTask=Gr(this._frameTask),this._tasks.forEach(e=>ll(e.abortController)),this._loadQueue=_t(this._loadQueue),this._onLoadQueue=null,this._doneQueue=null,this._tasks=null}hasDownloadSlots(e){return this._loadQueue.hasQuota(e)}request(e,t,n,r={}){const s=_b();s.__signal=T(r)?r.signal:null;const a=this._createOrUpdateTask(e,t,n,r,s);return Bm(r,()=>this._cancelRequest(a,s)),s.promise}_createTask(e,t,n,r,s,a){const o=new dgt(e,t,n,r,s);return this._updateTask(o,a),this._tasks.set(s,o),this._tasks.size===1&&this._set("updating",!0),this._loadQueue.push(o),o}_cancelRequest(e,t){var n;yie(e.resolvers,t),t.reject(js()),e.resolvers.length===0&&(e.status===ed.DOWNLOADING&&(e.status=ed.CANCELLED,this._loadQueue.cancel(e),(n=e.abortController)==null||n.abort(),e.request=null,e.abortController=null),e.status=ed.CANCELLED,this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1))}_updateTask(e,t){e.resolvers.push(t)}_createOrUpdateTask(e,t,n,r,s){const a=hgt(T(r)&&r.uid||e,t,n),o=this._tasks.get(a);return o?(this._updateTask(o,s),o):this._createTask(e,r,t,n,a,s)}_doneLoadingCB(e,t){this._loadQueue&&(Ti(e.status===ed.DOWNLOADING),e.status=ed.DOWNLOADED,this._frameTask?this._doneQueue.push({task:e,err:t}):this._doneLoading(e,t))}get running(){return this._doneQueue.length>0||this._onLoadQueue.length>0}runTask(e){for(;!e.done&&this._onLoadQueue.length>0;){const t=this._onLoadQueue.shift();Cn(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress()}for(;!e.done&&this._doneQueue.length>0;){const t=this._doneQueue.shift();t.task.status!==ed.DOWNLOADED&&(t.err=t.err||js()),this._doneLoading(t.task,t.err),e.madeProgress()}}_doneLoading(e,t){if(t&&!zo(t)&&e.numRetries>0)return--e.numRetries,void this._loadQueue.push(e);let n=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const r of e.resolvers)if(t)zo(t)?r.reject(t):r.reject(new Ze("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${t}`,{url:e.url,error:t}));else{--n;const s=n<=0?e.result:ko(e.result);r.resolve(s)}this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1)}_startLoading(e,t){if(e.status===ed.CANCELLED)return!1;let n,r;switch(e.startTime=performance.now(),e.status=ed.DOWNLOADING,e.docType){case"binary":r="array-buffer",n=0;break;case"image":r="image";break;case"image+type":r="array-buffer";break;default:r="json"}e.abortController=new AbortController;const s=e.abortController.signal;e.request=Mc(e.url,{...e.options,responseType:r,timeout:n,signal:s});let a=()=>{};const o=c=>{e.duration=performance.now()-e.startTime,e.size=c instanceof ArrayBuffer?c.byteLength:e.size||0,e.result=c,this._frameTask?this._onLoadQueue.push({callback:t,task:e}):(e.abortController=null,t(e))},l=c=>{e.status===ed.DOWNLOADING&&t(e,c),a()};return e.docType!=="image+type"?(e.request.then(c=>o(c.data),l),!0):(e.request.then(c=>{const u=c.data,d=ugt(u);if(r="image",e.size=u.byteLength,d==="unknown")return e.request=Mc(e.url,{responseType:r,timeout:n,signal:s}),void e.request.then(m=>o(m.data),l);const h=new Blob([u],{type:d}),p=window.URL.createObjectURL(h);a=()=>window.URL.revokeObjectURL(p),e.request=Mc(p,{responseType:r,timeout:n,signal:s}),e.request.then(m=>o(new CD(m.data,d,a)),l)},l),!0)}get test(){return{loadQueue:this._loadQueue}}};f([y({readOnly:!0})],dI.prototype,"updating",void 0),dI=f([ge("esri.views.3d.support.StreamDataLoader")],dI);const cgt={numRetries:0};function ugt(i){if(i.byteLength<2)return"unknown";const e=new Uint8Array(i,0,i.byteLength);return e[0]===137&&e[1]===80?"image/png":e[0]===71&&e[1]===73?"image/gif":e[0]===66&&e[1]===77?"image/bmp":e[0]===255&&e[1]===216?"image/jpeg":"unknown"}let CD=class{constructor(e,t,n){this.image=e,this.type=t,this.release=n}get isOpaque(){return this.type==="image/jpeg"}},dgt=class extends sgt{constructor(e,t,n,r,s){super(r),this.url=e,this.options=t,this.docType=n,this.key=s,this.result=null,this.status=ed.QUEUED,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0,this.numRetries=cgt.numRetries}};function hgt(i,e,t){return`${i}:${e}:${t}`}var ed;(function(i){i[i.QUEUED=1]="QUEUED",i[i.DOWNLOADING=2]="DOWNLOADING",i[i.DOWNLOADED=3]="DOWNLOADED",i[i.CANCELLED=4]="CANCELLED"})(ed||(ed={}));let hI=class extends et{constructor(){super(...arguments),this.updating=!1}};function pgt(i){return new em({view:i})}f([y({readOnly:!0})],hI.prototype,"updating",void 0),hI=f([ge("esri.views.3d.support.ResourceControllerMain")],hI);let em=class extends hI{constructor(){super(...arguments),this._scheduler=null,this._memoryController=null,this._streamDataLoader=null,this._scheduleTask=GA,this._handles=new mi,this._frameTask=null}initialize(){this._scheduler=K_e(),this._memoryController=igt(this.view),this._streamDataLoader=new dI,this._streamDataLoader.setup(tgt,egt,this._scheduler),this._handles.add([ue(()=>{var e;return(e=this.view.state)==null?void 0:e.mode},e=>this._scheduler.state=e,on),ue(()=>this.view.stationary,()=>this._stationaryChangedHandler())]),this._frameTask=Vm({update:e=>this._frame(e)}),this._scheduleTask=this._scheduler.registerTask($r.RESOURCE_CONTROLLER)}destroy(){this._handles=_t(this._handles),this._scheduleTask.remove(),this._frameTask=Gr(this._frameTask),this._streamDataLoader=_t(this._streamDataLoader),this._memoryController=_t(this._memoryController),this._scheduler=_t(this._scheduler)}get updating(){var e,t,n;return!!((e=this._memoryController)!=null&&e.updating||(t=this._streamDataLoader)!=null&&t.updating||(n=this._scheduleTask)!=null&&n.updating)}get scheduler(){return this._scheduler}get memoryController(){return this._memoryController}schedule(e,t,n){return this._scheduleTask.schedule(e,t,n)}createStreamDataRequester(e){const t=this._streamDataLoader;return{request:(n,r,s)=>t.request(n,r,e,s),get busy(){return!t.hasDownloadSlots(e)}}}_frame(e){this.view.suspended||this.view.stateManager&&(this.view.stateManager.step(sB(e.deltaTime)),!this._scheduler)||(this._scheduler.updateBudget(e)?(this._memoryController.update(),this._scheduler.frame()):this._memoryController.updating&&this._memoryController.update())}_stationaryChangedHandler(){this.memoryController.resetStableQuality()}get test(){return{getQueueStats:e=>this._streamDataLoader.test.loadQueue.getStatsForType(e)}}};f([y({constructOnly:!0})],em.prototype,"view",void 0),f([y()],em.prototype,"_scheduler",void 0),f([y()],em.prototype,"_memoryController",void 0),f([y()],em.prototype,"_streamDataLoader",void 0),f([y()],em.prototype,"_scheduleTask",void 0),f([y({readOnly:!0})],em.prototype,"updating",null),em=f([ge("esri.views.3d.support.ResourceControllerImpl")],em);function fgt(i){return"performanceInfo"in i}const P1=q(),mgt=q(),Ff=q(),Nf=q();function ggt(i,e,t=0){const n=i.extent;if(B(n))return!1;if(t===0)return rne(n,e);const r=Math.min(n[2]-n[0],n[3]-n[1]);return _0e(n,e,t*r)}function mO(i,e,t,n){Ge(P1,t),P1[n]=e[n];const r=nt(P1,P1,e),s=nt(mgt,i,e),a=dt(s,r),o=dt(r,r);let l;l=a<=0?e:o<=a?t:rt(P1,e,Ye(r,r,a/o));const c=nt(P1,i,l);return Math.PI/2-Math.atan(c[2]/Math.sqrt(c[0]*c[0]+c[1]*c[1]))}function vgt(i,e,t){const n=i.extent;if(B(n))return 0;Ff[0]=n[0],Ff[1]=n[1],Ff[2]=t,Nf[0]=n[2],Nf[1]=n[3],Nf[2]=t;let r=1/0,s=1/0;return e[0]<Ff[0]?r=mO(e,Ff,Nf,0):e[0]>Nf[0]&&(r=mO(e,Nf,Ff,0)),e[1]<Ff[1]?s=mO(e,Ff,Nf,1):e[1]>Nf[1]&&(s=mO(e,Nf,Ff,1)),Math.min(r,s)}function ygt(i,e,t){if(B(i))return FU();if(i.spatialReference.isGeographic&&!X0(i.spatialReference))return new Ze("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const n=ur.checkUnsupported(i);if(T(n))return n;if(B(t))return new Ze("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const r=_gt(i,t);if(r)return r;const s=i.spatialReference;return T(e)&&!(s.equals(e)||e.isWGS84&&s.isWebMercator)?new Ze("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null}function _gt(i,e){const t=i.lods,n=t[0].resolution*2**t[0].level,r=[n*i.size[0],n*i.size[1]],s=[i.origin.x,i.origin.y],a=ane(e),o=qi();ur.computeRowColExtent(a,r,s,o);const l=(o[2]-o[0])*(o[3]-o[1]);if(l>Bw){const c=t[0].scale*2**t[0].level;let u=Math.max((a[3]-a[1])/i.size[1],(a[2]-a[0])/i.size[0])*c/n;const d=Math.floor(Math.log(u)/Math.log(10));return u=Math.ceil(u/10**d)*10**d,new Ze("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(c).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+u.toLocaleString()+".",{level0Scale:c,suggestedLevel0Scale:u,requiredNumRootTiles:l,allowedNumRootTiles:Bw})}return null}const bgt=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:ggt,tiltToExtentEdge:vgt,checkIfTileInfoSupportedForViewSR:ygt},Symbol.toStringTag,{value:"Module"}));function wgt(){return!0}function xgt(){return 0}function Cgt(i,e){if(B(i))return FU();const t=i.lods.length-1,n=i.spatialReference,r=X0(n)||zA(n)||UA(n);if(n.isWebMercator){if(!ur.makeWebMercatorAuxiliarySphere(t).compatibleWith(i))return new Ze("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!r)return new Ze("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!ur.makeGCSWithTileSize(i.spatialReference,i.size[0],t).compatibleWith(i))return i.spatialReference.isWGS84?new Ze("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new Ze("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return T(e)&&!i.spatialReference.equals(e)?new Ze("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene"):void 0}const Tgt=Object.freeze(Object.defineProperty({__proto__:null,isInsideExtent:wgt,tiltToExtentEdge:xgt,checkIfTileInfoSupportedForViewSR:Cgt},Symbol.toStringTag,{value:"Module"})),Sgt={[Ot.Global]:Tgt,[Ot.Local]:bgt};function xp(i,e){i||console.warn("Terrain: "+e)}let fa=!1,dL=!1;function Egt(i){dL=i,fa=fa||i}function Agt(i){fa=i}function yt(i,e){if(fa&&!i){const t=new Error().stack.slice(5);throw console.warn("Terrain internal: "+(e||"")+" at "+t),new Error("Assertion failed"+(e?": "+e:""))}}function r8(i){return TD(i)?{fullExtent:i.fullExtent,minScale:i.layer.minScale,maxScale:i.layer.maxScale,tilemapCache:null}:i.layer}function hL(i){return(i==null?void 0:i.type)==="imagery-tile"||(i==null?void 0:i.type)==="wcs"}function TD(i){return(i==null?void 0:i.type)==="imagery-tile-3d"}function eH(i){return(i==null?void 0:i.type)==="tile-3d"}function EA(i){return(i==null?void 0:i.type)==="vector-tile-3d"}function Jfe(i){return(i==null?void 0:i.type)==="wmts-3d"}function s8(i){return(i==null?void 0:i.type)==="elevation-3d"}function ZT(i){return(i==null?void 0:i.type)==="group"}function xC(i){return(i==null?void 0:i.type)==="group"}function pL(i){return i&&(eH(i)||Jfe(i)||TD(i)||EA(i))}function a8(i){return i&&(eH(i)||TD(i)||EA(i)||Jfe(i))}function AA(i){return a8(i)||s8(i)}function Mgt(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return T(e)&&"type"in e&&e.type==="raster-tile"}function Pgt(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return T(e)&&"type"in e&&e.type==="vector-tile"}function Ogt(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return T(e)&&"type"in e&&e.type==="tile-texture"}function Rgt(i){var t;const e=(t=i==null?void 0:i.sourceLayerInfo)==null?void 0:t.data;return e instanceof HTMLImageElement||e instanceof CD||e instanceof HTMLCanvasElement||e instanceof ImageData}function Sx(i){return T(i)&&"release"in i&&i.release(),null}function TJ(i){return i.fetchTile&&i.hasOverriddenFetchTile!==!1}function MA(i,e,t,n){return Sgt[n].checkIfTileInfoSupportedForViewSR(i,t,e)}function SD(i,e,t){let n=null,r=null;if((i==null?void 0:i.type)==="wmts"){const s=eme(i,e,t);n=s.tileInfo,r=s.fullExtent}else{r=hL(i)?i.getCompatibleFullExtent(e):i.fullExtent;const s=t===Ot.Local;if(hL(i))n=i.getCompatibleTileInfo(e,r,s);else if((i==null?void 0:i.type)==="vector-tile"){const a=s&&!Igt(e)||$gt.force512VTL,o=i.tileInfo.spatialReference.isGeographic;n=a?i.tileInfo:i.tileInfo.getOrCreateCompatible(256,o?1:2)}else n=i.tileInfo}return T(n)&&T(r)&&MA(n,r,e,t)==null?{tileInfo:n,fullExtent:r}:null}function eme(i,e,t){const n=K0e(i);if(T(n)){if(!_i.isCollection(n))return{tileInfo:n.tileInfo,fullExtent:n.fullExtent};{const r=n.find(s=>MA(s.tileInfo,s.fullExtent,e,t)==null);if(r)return{tileInfo:r.tileInfo,fullExtent:r.fullExtent}}}return{tileInfo:null,fullExtent:null}}function Igt(i){return i.isWGS84||i.isWebMercator||_ye(i)||!NI(i)}const $gt={force512VTL:!1};function SJ(i){return"["+i[0]+","+i[1]+","+i[2]+"]"}function Vf(i){return"("+i[0]+","+i[1]+","+i[2]+")"}function Lgt(i,e,t=Fgt){return Math.abs(i-e)<t}function o8(i){return i===ei.NORTH_EAST?ei.SOUTH_WEST:i===ei.NORTH_WEST?ei.SOUTH_EAST:i===ei.SOUTH_WEST?ei.NORTH_EAST:ei.NORTH_WEST}function fL(i){return i===ei.NORTH?ei.SOUTH:i===ei.EAST?ei.WEST:i===ei.SOUTH?ei.NORTH:ei.EAST}function Dgt(i){return i===ei.NORTH_WEST||i===ei.SOUTH_WEST}function kgt(i){return i===ei.NORTH_WEST||i===ei.NORTH_EAST}function EJ(i){return i===ei.NORTH_WEST||i===ei.WEST||i===ei.SOUTH_WEST}function AJ(i){return i===ei.NORTH_EAST||i===ei.EAST||i===ei.SOUTH_EAST}function MJ(i){return i===ei.SOUTH_EAST||i===ei.SOUTH||i===ei.SOUTH_WEST}function PJ(i){return i===ei.NORTH_EAST||i===ei.NORTH||i===ei.NORTH_WEST}const zp=[ei.NORTH,ei.EAST,ei.SOUTH,ei.WEST],mL=[ei.NORTH_EAST,ei.SOUTH_EAST,ei.SOUTH_WEST,ei.NORTH_WEST],Fgt=1e-5;let Ngt=class{constructor(e,t){if(this.layer=null,this.memory=0,this.displayedNumberOfFeatures=0,this.maximumNumberOfFeatures=null,this.totalNumberOfFeatures=null,this.layer=e.layer,this.memory=AA(e)?t.basemapTerrain.getUsedMemoryForLayerView(e):e.getUsedMemory(),fgt(e)){const n=e.performanceInfo;this.displayedNumberOfFeatures=n.displayedNumberOfFeatures,this.maximumNumberOfFeatures=n.maximumNumberOfFeatures,this.totalNumberOfFeatures=n.totalNumberOfFeatures}}},Vgt=class{constructor(e){if(this.totalMemory=0,this.usedMemory=0,this.quality=1,this.load=0,this.terrainMemory=0,this.edgesMemory=0,this.layerPerformanceInfos=new Array,T(e.resourceController)){const n=e.resourceController.memoryController;this.totalMemory=n.maxMemory*LN.MEGABYTES,this.usedMemory=Math.round(n.usedMemory*this.totalMemory),this.quality=n.memoryFactor,this.load=e.resourceController.scheduler.load}this.terrainMemory=e.basemapTerrain?e.basemapTerrain.getUsedMemory():0;const t=e._stage&&e._stage.renderView&&e._stage.renderView.edgeView;this.edgesMemory=T(t)?t.usedMemory:0,e.allLayerViews.items.forEach(n=>{(Qfe(n)||AA(n))&&this.layerPerformanceInfos.push(new Ngt(n,e))}),this.layerPerformanceInfos.sort((n,r)=>r.memory-n.memory)}},Bgt=class{constructor(e){this._gltfLoading=new Map,this._wosrLoading=new Map,this._gltfMemCache=e("gltf-resources",()=>{}),this._wosrMemCache=e("wosr-resources",()=>{})}destroy(){this._gltfLoading.forEach(e=>e.abortController.abort()),this._wosrLoading.forEach(e=>e.abortController.abort()),this._gltfMemCache.destroy(),this._wosrMemCache.destroy()}loadGLTF(e,t,n){const r=n?`gltfPBR:${e}`:`gltf:${e}`,s=this._gltfMemCache.get(r);return T(s)?Promise.resolve(s):this._loadOnce(this._gltfLoading,this._gltfMemCache,r,a=>d1e(new h1e(a.streamDataRequester),e,a,n),t)}loadWOSR(e,t){const n=`wosr:${e}:${t.disableTextures}`,r=this._wosrMemCache.get(n);return T(r)?Promise.resolve(r):this._loadOnce(this._wosrLoading,this._wosrMemCache,n,s=>Jbe(e,s),t)}async _loadOnce(e,t,n,r,s){Cn(s);const a=Bm(s,()=>this._abortLoad(e,n));let o=e.get(n);if(o)o.refCount++;else{const l=new AbortController;o={refCount:1,abortController:l,promise:r({...s,signal:l.signal})},e.set(n,o)}try{const l=await o.promise;return t.put(n,l,l.size),e.delete(n),Cn(s),l}finally{Gr(a)}}_abortLoad(e,t){const n=e.get(t);T(n)&&--n.refCount>0||(e.delete(t),T(n)&&n.abortController.abort())}},zgt=class extends Nw{constructor(e,t,n,r){super(t,r),this._streamDataRequester=e,this._parameters=n}async fromUrl(e,t,n){Cn(n);const r=T(n)&&n.signal,s=this.makeUid(e,t);let a=this._textureRequests.get(s);if(!a){const o=new AbortController,l=this._streamDataRequester.request(e,"image",{uid:s,signal:o.signal});a={referenceCount:0,texture:null,textureAsync:null,abortController:o},this._textureRequests.set(s,a),a.textureAsync=l.then(async c=>{const u=this._createTexture(e,c,t);return a.texture=u,a.abortController=null,this._stage.add(u),await this._stage.load(u),{uid:s,texture:u,release:()=>this._release(s)}},c=>{throw a.abortController=null,c})}return a.referenceCount++,new Promise((o,l)=>{Bm(r,()=>{l(js())}),a.textureAsync.then(o,l)}).catch(o=>{throw this._release(s),o})}_createTexture(e,t,n){const r={...this._parameters,powerOfTwoResizeMode:iz.PAD};if(lB(e)){if(n||t.width===0&&t.height===0){const s=t.width?t.height/t.width:1;n=n||64,s>1?(t.width=Math.round(n/s),t.height=n):(t.width=n,t.height=Math.round(n*s))}this._stage.renderView&&this._stage.renderView.renderingContext.driverTest.svgAlwaysPremultipliesAlpha&&(r.preMultiplyAlpha=!1)}return r.width=t.width,r.height=t.height,new i3(t,r)}},Ugt=class{constructor(e){this.textures=null,this.streamDataRequester=null,this._graphicsOwners=[],this._screenSizePerspectiveHandles=null,this.cimSymbolRasterizer=null,this._viewState=e.viewState,this._view=e.view,this._pointsOfInterest=e.pointsOfInterest,this.streamDataRequester=e.resourceController.createStreamDataRequester($p.SYMBOLOGY),this.objectResourceCache=new Bgt((n,r)=>e.resourceController.memoryController.newCache(n,r)),this.textures=new zgt(this.streamDataRequester,e.view._stage,{preMultiplyAlpha:!0,wrap:{s:An.CLAMP_TO_EDGE,t:An.CLAMP_TO_EDGE}},e.resourceController.scheduler);const t=rn(this._view.spatialReference).radius;this.screenSizePerspectiveSettings=Lne(e.viewingMode,t),this.screenSizePerspectiveSettingsLabels=Abe(e.viewingMode,t)}destroy(){_t(this.textures),this.textures=null,this.streamDataRequester=null}addGraphicsOwner(e){if(!e)return bh();this._graphicsOwners.push(e);const t=ue(()=>{var n;return(n=e.layer)==null?void 0:n.screenSizePerspectiveEnabled},()=>this._updateScreenSizePerspectiveEnabled());return this._updateScreenSizePerspectiveEnabled(),bh(()=>{t.remove(),yie(this._graphicsOwners,e),this._updateScreenSizePerspectiveEnabled()})}_updateScreenSizePerspectiveEnabled(){const e=this._graphicsOwners.some(t=>{var n;return((n=t.layer)==null?void 0:n.screenSizePerspectiveEnabled)===!0});if(e&&!this._screenSizePerspectiveHandles){this._screenSizePerspectiveHandles=new mi;const t=()=>this._updateScreenSizePerspectiveSettings();this._screenSizePerspectiveHandles.add([ue(()=>this._pointsOfInterest.centerOnSurfaceInfrequent.distance,t,on),this._viewState.events.on("camera-projection-changed",t)]),this._updateScreenSizePerspectiveSettings()}else!e&&this._screenSizePerspectiveHandles&&(this._screenSizePerspectiveHandles.destroy(),this._screenSizePerspectiveHandles=null)}_updateScreenSizePerspectiveSettings(){const e=this._pointsOfInterest;gO.distance=e.centerOnSurfaceInfrequent.distance,gO.fovY=this._viewState.camera.fovY,this.screenSizePerspectiveSettings.update(gO),this.screenSizePerspectiveSettingsLabels.update(gO),this._view._stage.renderView.requestRender()}get test(){return{screenSizePerspectiveHandles:this._screenSizePerspectiveHandles}}};const gO={distance:0,fovY:0};let _v=class{constructor(e,t,n=""){this.graphics=e,this._symbol=new O_e({symbolLayers:[new R_e({material:{color:t},outline:{color:[255,255,255],size:1},resource:{primitive:"circle"}}),new I_e({text:n,halo:{color:"white",size:1/.75},material:{color:t},size:12})]})}show(e,t){if(B(t))return;this.hide();const n=new Wt({x:e[0],y:e[1],z:e[2],spatialReference:t});this._graphic=new ao({geometry:n,symbol:this._symbol}),this.graphics.add(this._graphic)}hide(){T(this._graphic)&&(this.graphics.remove(this._graphic),this._graphic=null)}},qv=class extends et{constructor(e){super(e),this.handles=new mi}destroy(){this.handles.destroy()}};f([y({constructOnly:!0})],qv.prototype,"renderCoordsHelper",void 0),f([y({constructOnly:!0})],qv.prototype,"surface",void 0),f([y({constructOnly:!0})],qv.prototype,"state",void 0),qv=f([ge("esri.views.3d.support.PointOfInterest")],qv);const Hgt=Array;let uu=class extends qv{constructor(e){super(e),this._dirty=!1,this._propertiesPool=new Zm({location:Wt,renderLocation:Hgt},this),this._estimatedSurfaceAltitude=0,this._pendingElevationQueryController=null,this.cameraName="camera",this.renderLocation=q(),this._tmpPoint=new Wt}initialize(){if(this.scheduler&&this.handles.add(this.scheduler.registerTask(this.task,this)),this.runTask(),this.map){const e=()=>this._setDirty();this.handles.add(Sn(()=>{var t,n;return(n=(t=this.map)==null?void 0:t.ground)==null?void 0:n.layers},"change",e,{onListenerAdd:e,onListenerRemove:e}))}this._updateRenderLocation()}destroy(){this._cancelPendingRequest(),this._propertiesPool.destroy(),this._propertiesPool=null}get _camera(){return this.state[this.cameraName]}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get scale(){const e=this._camera,t=Gn(e.eye,this.renderLocation),n={renderCoordsHelper:this.renderCoordsHelper,state:{camera:e}};return db(n,t,0)}get updating(){return this._dirty||this._pendingElevationQueryController!=null}updateRenderLocation(){this._setDirty(),this._updateRenderLocation()}_setDirty(){this._dirty||(this._dirty=!0,this.notifyChange("updating"))}_cancelPendingRequest(){const e=this._pendingElevationQueryController;e&&(this._pendingElevationQueryController=null,e.abort(),this.notifyChange("updating"))}get running(){return!this._pendingElevationQueryController&&this._dirty}runTask(){if(this._cancelPendingRequest(),this._dirty=!1,this.notifyChange("updating"),!this.map||!this.map.ground)return void this._updateSurfaceAltitude(0);const e=this.state.spatialReference;this.renderCoordsHelper.fromRenderCoords(this._camera.eye,this._tmpPoint,e);const t=this._tmpPoint.z>Ggt&&this.renderCoordsHelper.viewingMode===Ot.Global&&(e.isWGS84||e.isWebMercator);let n=new AbortController;this.map.ground.queryElevation(this._tmpPoint,{signal:n.signal,cache:this.cache,minDemResolution:t?Wgt:0}).then(r=>this._updateSurfaceAltitude(r.geometry.z)).catch(r=>{zo(r)||this._updateSurfaceAltitude(0)}).catch(()=>{}).then(()=>{this._pendingElevationQueryController===n&&(this._pendingElevationQueryController=null,this.notifyChange("updating")),n=null}),this._pendingElevationQueryController=n}_updateSurfaceAltitude(e){this._estimatedSurfaceAltitude!==e&&(this._estimatedSurfaceAltitude=e,this._updateRenderLocation())}_updateRenderLocation(){this.renderCoordsHelper.setAltitude(O4,this._estimatedSurfaceAltitude,this._camera.eye),uh(this._get("renderLocation"),O4)||(this._set("renderLocation",Ge(this._propertiesPool.get("renderLocation"),O4)),this.notifyChange("renderLocation"))}};f([y({constructOnly:!0})],uu.prototype,"scheduler",void 0),f([y({constructOnly:!0})],uu.prototype,"cache",void 0),f([y({constructOnly:!0})],uu.prototype,"task",void 0),f([y({constructOnly:!0})],uu.prototype,"cameraName",void 0),f([y({readOnly:!0})],uu.prototype,"location",null),f([y({constructOnly:!0})],uu.prototype,"map",void 0),f([y({readOnly:!0})],uu.prototype,"renderLocation",void 0),f([y({readOnly:!0})],uu.prototype,"scale",null),f([y({readOnly:!0})],uu.prototype,"updating",null),uu=f([ge("esri.views.3d.support.CameraOnSurface")],uu);const O4=q(),Ggt=1e5,Wgt=1e6,jgt=Array;let Tc=class extends qv{constructor(e){super(e),this._propertiesPool=new Zm({location:Wt,renderLocation:jgt},this),this._currentSurfaceAltitude=0,this._latestSurfaceAltitude=0,this.cameraName="camera",this.distance=0,this.renderLocation=q(),this.updating=!1}initialize(){this._frameWorker=this.scheduler.registerTask(this.task,this),this.runTask()}destroy(){this._frameWorker=Gr(this._frameWorker),this._propertiesPool=_t(this._propertiesPool)}get _camera(){return this.state[this.cameraName]}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}updateRenderLocation(){this.updating=!0,this._updateRenderLocation()}get estimatedSurfaceAltitude(){return this._latestSurfaceAltitude}get running(){return this.updating}runTask(){this._latestSurfaceAltitude=this.estimateSurfaceAltitudeAtCenter(),this._updateRenderLocation(),this.updating=!1}_updateRenderLocation(){const e=Kgt;let t=this._calculateSurfaceIntersection(this._currentSurfaceAltitude,e);const n=this._currentSurfaceAltitude!==this._latestSurfaceAltitude;!t&&n&&(t=this._calculateSurfaceIntersection(this._latestSurfaceAltitude,e),t&&(this._currentSurfaceAltitude=this._latestSurfaceAltitude));const r=Ygt;t&&this._latestSurfaceAltitudeChangesDistanceSignificantly(e,r)&&(Ge(e,r),this._currentSurfaceAltitude=this._latestSurfaceAltitude),t?this.distance=Gn(this._camera.eye,e):(Ye(e,this._camera.viewForward,this._get("distance")),rt(e,e,this._camera.eye)),uh(this._get("renderLocation"),e)||this._set("renderLocation",Ge(this._propertiesPool.get("renderLocation"),e))}_calculateSurfaceIntersection(e,t){const n=this._camera;if(!this.renderCoordsHelper.intersectManifold(n.ray,e,t))return!1;if(this.state.isGlobal){const r=rn(this.renderCoordsHelper.spatialReference).radius,s=r+e,a=dd(n.eye),o=a<s*s,l=Gn(n.eye,t);if(o&&l>r/4){const c=s-Math.sqrt(a);return Ye(t,n.viewForward,c),rt(t,t,n.eye),!0}}else{const r=this.surface.ready?this.surface.extent:null;T(r)&&zL(r,this.surface.spatialReference,QT,this.renderCoordsHelper.spatialReference)&&(t[0]=lt(t[0],QT[0],QT[2]),t[1]=lt(t[1],QT[1],QT[3]))}return!0}_latestSurfaceAltitudeChangesDistanceSignificantly(e,t){if(this._latestSurfaceAltitude===this._currentSurfaceAltitude||e==null)return!1;if(this._calculateSurfaceIntersection(this._latestSurfaceAltitude,t)){if(cn.TESTS_DISABLE_OPTIMIZATIONS)return!0;const n=this._camera.eye,r=Gn(n,e),s=Gn(n,t);if(Math.abs(s-r)/r>qgt)return!0}return!1}};f([y({constructOnly:!0})],Tc.prototype,"scheduler",void 0),f([y({constructOnly:!0})],Tc.prototype,"task",void 0),f([y({constructOnly:!0})],Tc.prototype,"cameraName",void 0),f([y()],Tc.prototype,"distance",void 0),f([y({constructOnly:!0})],Tc.prototype,"estimateSurfaceAltitudeAtCenter",void 0),f([y({readOnly:!0})],Tc.prototype,"location",null),f([y({readOnly:!0})],Tc.prototype,"renderLocation",void 0),f([y()],Tc.prototype,"updating",void 0),Tc=f([ge("esri.views.3d.support.CenterOnSurface")],Tc);const qgt=.05,Kgt=q(),Ygt=q(),QT=qi();let Xgt=class{constructor(e){this._handles=new mi,this.events=new Pn,this._contentLayerViews=e.contentLayerViews,this._handles.add(this._contentLayerViews.on("change",t=>this._layerViewsChanged(t))),this._layerViewsChanged({added:this._contentLayerViews.toArray(),removed:[],moved:[],target:this._contentLayerViews})}destroy(){this._handles&&(this._handles.destroy(),this._handles=null)}_layerViewsChanged(e){e.added.forEach(t=>{t.declaredClass==="esri.views.3d.layers.SceneLayerView3D"&&this._handles.add(t.on("visible-geometry-changed",()=>this._contentChanged()),t.uid)}),e.removed.forEach(t=>this._handles.remove(t.uid))}_contentChanged(){this.events.emit("request-update",Zgt)}};const Zgt={},Qgt=Array;let dp=class extends qv{constructor(e){super(e),this._propertiesPool=new Zm({location:Wt,renderLocation:Qgt},this),this._dirty=!0,this.renderLocation=this._propertiesPool.get("renderLocation")}initialize(){this.handles.add([ue(()=>this.centerOnSurface.renderLocation,()=>this.updateRenderLocation()),ue(()=>this.state.contentCamera,()=>this.updateRenderLocation())]),this.scheduler&&this.handles.add(this.scheduler.registerTask($r.POINT_OF_INTEREST_FREQUENT,this))}destroy(){this._propertiesPool.destroy(),this._propertiesPool=null}get updating(){return this._dirty||this.centerOnSurface.updating}get location(){const e=this._propertiesPool.get("location");return this.renderCoordsHelper.fromRenderCoords(this.renderLocation,e,this.state.spatialReference),e}get running(){return this._dirty}runTask(){const e=this._get("renderLocation"),t=this.centerOnSurface.renderLocation,n=this.renderCoordsHelper,r=this.state.contentCamera;this._dirty=!1,n.worldUpAtPosition(t,OJ);const s=Math.max(0,(Math.acos(dt(OJ,r.viewForward))-.5*Math.PI)*(r.aboveGround?1:-1));if(Number.isNaN(s)){if(!e||!af(e,t)){const c=this._propertiesPool.get("renderLocation");Ge(c,t),this._set("renderLocation",c)}return}const a=1-lt(s/(.5*Math.PI),0,1),o=a*a*a;this._calculateScreenHorizontalEdgeOnSurface(RJ);const l=this._propertiesPool.get("renderLocation");oo(l,t,RJ,o),e&&af(e,l)||this._set("renderLocation",l)}_calculateScreenHorizontalEdgeOnSurface(e){const t=this.state.contentCamera,n=t.getRenderCenter(pa());if(n[1]=t.aboveGround?t.padding[li.BOTTOM]:t.fullHeight-t.padding[li.TOP],this.estimateSurfaceIntersectionAtRenderPoint(n,e))return e;const r=this.renderCoordsHelper.getAltitude(this.centerOnSurface.renderLocation);if(t.unprojectFromRenderScreen(n,JT)){nt(JT,JT,t.eye);const s=mt(JT,JT);if(this.renderCoordsHelper.intersectManifold(Ah(t.eye,s),r,e))return e}return this.renderCoordsHelper.setAltitude(e,r,t.eye)}updateRenderLocation(){this._dirty=!0}};f([y()],dp.prototype,"_dirty",void 0),f([y({constructOnly:!0})],dp.prototype,"scheduler",void 0),f([y({constructOnly:!0})],dp.prototype,"centerOnSurface",void 0),f([y({constructOnly:!0})],dp.prototype,"estimateSurfaceIntersectionAtRenderPoint",void 0),f([y({readOnly:!0})],dp.prototype,"updating",null),f([y({readOnly:!0})],dp.prototype,"location",null),f([y({readOnly:!0})],dp.prototype,"renderLocation",void 0),dp=f([ge("esri.views.3d.support.pointsOfInterest.Focus")],dp);const OJ=q(),JT=q(),RJ=q();let tm=class extends et{constructor(e){super(e),this.location=null,this._updateController=null,this._handles=new mi}get surface(){var e;return(e=this.view.map)==null?void 0:e.ground}get surfaceView(){return this.view.basemapTerrain}get renderLocation(){if(!this.location)return null;const e=q();return this.view.renderCoordsHelper.toRenderCoords(this.location,e),e}initialize(){this.view.state.isLocal&&(this._handles.add([ue(()=>{var e,t;return[(e=this.surfaceView)==null?void 0:e.spatialReference,(t=this.surfaceView)==null?void 0:t.extent]},()=>this._update()),Sn(()=>{var e;return(e=this.surface)==null?void 0:e.layers},"change",()=>this._update())]),this._update())}destroy(){this._handles.destroy()}_update(){if(this._updateController&&(this._updateController.abort(),this._updateController=null),!this.surfaceView||B(this.surfaceView.extent)||B(this.surfaceView.spatialReference))return void this._set("location",null);const e=AB(this.surfaceView.extent),t=new Wt({x:e[0],y:e[1],z:0,spatialReference:this.surfaceView.spatialReference});this.surface&&this.surface.layers.length>0?(this._set("location",null),this._updateController=new AbortController,this.surface.queryElevation(t,{noDataValue:0,signal:this._updateController.signal,cache:this.cache}).then(n=>{this._updateController=null,this._set("location",n.geometry)}).catch(n=>{zo(n)||n&&n.name==="elevation-query:invalid-layer"||console.error("StableSurfaceCenter failed to update: ",n)})):this._set("location",t)}};f([y({constructOnly:!0})],tm.prototype,"view",void 0),f([y({constructOnly:!0})],tm.prototype,"cache",void 0),f([y()],tm.prototype,"surface",null),f([y()],tm.prototype,"surfaceView",null),f([y({readOnly:!0})],tm.prototype,"location",void 0),f([y({readOnly:!0})],tm.prototype,"renderLocation",null),tm=f([ge("esri.views.3d.terrain.StableSurfaceCenter")],tm);let im=class extends et{constructor(e){super(e),this._handles=new mi,this._tileGeometryUpdateExtent=Eh(),this._tileGeometryUpdateSpatialReference=null,this.events=new Pn,this.updating=!1}initialize(){this._handles.add([this.surface.on("elevation-change",e=>this._tileGeometryChanged(e)),this.scheduler.registerTask($r.SURFACE_GEOMETRY_UPDATES,this)])}destroy(){this._handles=_t(this._handles)}get running(){return this.updating}runTask(){this.updating&&(this._centerIntersectsExtent(this._tileGeometryUpdateExtent,this._tileGeometryUpdateSpatialReference)&&this.events.emit("request-update",Jgt),Eh(this._tileGeometryUpdateExtent),this._set("updating",!1))}_tileGeometryChanged(e){this._tileGeometryUpdateSpatialReference=kt(e.spatialReference),ry(this._tileGeometryUpdateExtent,e.extent,this._tileGeometryUpdateExtent),this._set("updating",!0)}_furthestCenterOnSurface(){let e=this.centerOnSurfaces[0];for(let t=1;t<this.centerOnSurfaces.length;t++){const n=this.centerOnSurfaces[t];n.distance>e.distance&&(e=n)}return e}_centerIntersectsExtent(e,t){const n=this.state.camera.eye,r=evt,s=this._furthestCenterOnSurface();return this.renderCoordsHelper.fromRenderCoords(n,__,t),this.renderCoordsHelper.fromRenderCoords(s.renderLocation,b_,t),__[0]<b_[0]?(r[0]=__[0],r[2]=b_[0]):(r[0]=b_[0],r[2]=__[0]),__[1]<b_[1]?(r[1]=__[1],r[3]=b_[1]):(r[1]=b_[1],r[3]=__[1]),jL(r,e)}};f([y({constructOnly:!0})],im.prototype,"state",void 0),f([y({constructOnly:!0})],im.prototype,"centerOnSurfaces",void 0),f([y({constructOnly:!0})],im.prototype,"renderCoordsHelper",void 0),f([y({constructOnly:!0})],im.prototype,"scheduler",void 0),f([y({constructOnly:!0})],im.prototype,"surface",void 0),f([y({readOnly:!0})],im.prototype,"updating",void 0),im=f([ge("esri.views.3d.support.SurfaceGeometryUpdates")],im);const Jgt={},__=q(),b_=q(),evt=Eh();let wo=class extends et{constructor(e){super(e),this._handles=new mi,this._tmpRay=Oc(),this._centerRayDirty=!0,this._surfaceAltitudeAtCenter=0,this._surfaceAltitudeAtCenterDirty=!0,this._contentAltitudeAtCenter=0,this._contentAltitudeAtCenterDirty=!0,this._propertiesPool=new Zm({renderPointOfView:tvt},this),this.renderPointOfView=q(),this._pois=new Array,this._debugCenters=new Map}initialize(){var u;const{state:e,basemapTerrain:t,renderCoordsHelper:n,map:r}=this.view;this._surfaceIntersector=Od(e.viewingMode),e.isGlobal?this._surfaceIntersector.options.backfacesTerrain=!1:this._surfaceIntersector.options.backfacesTerrain=!0,this._surfaceIntersector.options.invisibleTerrain=!1,this._surfaceIntersector.options.store=Fa.MIN,this._contentIntersector=Od(e.viewingMode);const s=()=>this._estimateSurfaceAltitudeAtCenter(),a=this.view.resourceController.scheduler,o=kt((u=this.view.basemapTerrain)==null?void 0:u.elevationQueryCache),l={state:e,scheduler:a,surface:t,renderCoordsHelper:n};this._set("centerOnSurfaceInfrequent",new Tc({...l,task:$r.POINT_OF_INTEREST_INFREQUENT,estimateSurfaceAltitudeAtCenter:s})),this._set("centerOnSurfaceFrequent",new Tc({...l,task:$r.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:s})),this._set("contentCenterOnSurface",new Tc({...l,task:$r.POINT_OF_INTEREST_INFREQUENT,estimateSurfaceAltitudeAtCenter:s,cameraName:"contentCamera"})),this._set("centerOnContent",new Tc({...l,task:$r.POINT_OF_INTEREST_FREQUENT,estimateSurfaceAltitudeAtCenter:()=>this._estimateContentAltitudeAtCenter()})),this._set("cameraOnSurface",new uu({...l,cache:o,task:$r.POINT_OF_INTEREST_INFREQUENT,map:r})),this._set("contentCameraOnSurface",new uu({...l,cache:o,task:$r.POINT_OF_INTEREST_INFREQUENT,map:r,cameraName:"contentCamera"})),this._set("surfaceGeometryUpdates",new im({...l,centerOnSurfaces:[this.centerOnSurfaceFrequent,this.centerOnContent,this.centerOnSurfaceInfrequent]})),this._set("contentGeometryUpdates",new Xgt({contentLayerViews:this.view.allLayerViews,renderCoordsHelper:n})),this._set("surfaceOrigin",new tm({cache:o,view:this.view})),this._set("focus",new dp({state:e,scheduler:a,surface:t,renderCoordsHelper:n,centerOnSurface:this.contentCenterOnSurface,estimateSurfaceIntersectionAtRenderPoint:(d,h)=>this._estimateSurfaceIntersectionAtRenderPoint(d,this.view.state.contentCamera,h)})),this._pois.push(this.centerOnContent,this.centerOnSurfaceFrequent,this.centerOnSurfaceInfrequent,this.contentCenterOnSurface,this.cameraOnSurface,this.contentCameraOnSurface,this.focus);const c=this.view.graphics;this._debugCenters.set(this.centerOnContent,new _v(c,"red","CenterOnContent")),this._debugCenters.set(this.centerOnSurfaceFrequent,new _v(c,"red","CenterOnSurface")),this._debugCenters.set(this.centerOnSurfaceInfrequent,new _v(c,"red","CenterOnSurface")),this._debugCenters.set(this.contentCenterOnSurface,new _v(c,"red","ContentCenterOnSurface")),this._debugCenters.set(this.cameraOnSurface,new _v(c,"blue","CameraOnSurface")),this._debugCenters.set(this.contentCameraOnSurface,new _v(c,"blue","ContentCameraOnSurface")),this._debugCenters.set(this.focus,new _v(c,"green","Focus")),this._handles.add([ue(()=>e.camera,d=>this._cameraChanged(d),on),ue(()=>t.extent,()=>this._updateCenterPointsOfInterest()),rs(()=>!t.updating,()=>this._updateCenterPointsOfInterest(),on),Sn(()=>this.surfaceGeometryUpdates.events,"request-update",()=>this._updateCenterPointsOfInterest()),Sn(()=>this.contentGeometryUpdates.events,"request-update",()=>this._updateCenterOnContent()),rs(()=>cn.SHOW_POI,d=>this._setDebug(d),At)]),this._cameraChanged(this.view.state.camera);for(const d of this._pois)d.runTask()}destroy(){this._setDebug(!1),this._handles.destroy(),this._propertiesPool.destroy();for(const e of this._pois)e.destroy();this.surfaceOrigin.destroy()}get updating(){var e;return!(!((e=this.surfaceGeometryUpdates)!=null&&e.updating)&&!this._pois.some(t=>t.updating))}get _centerRay(){return this._centerRayDirty&&(this._centerRayCached=this.view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(this.view.state.camera,this._tmpRay),this._centerRayDirty=!1),this._centerRayCached}_estimateContentAltitudeAtCenter(){if(!this._contentAltitudeAtCenterDirty)return this._contentAltitudeAtCenter;this._contentAltitudeAtCenterDirty=!1;const e=this._centerRay;return B(e)||(this.view.sceneIntersectionHelper.intersectRay(e,this._contentIntersector,O1,nvt)?this._contentAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(O1):this._contentAltitudeAtCenter=this._estimateSurfaceAltitudeAtCenter()),this._contentAltitudeAtCenter}_estimateSurfaceAltitudeAtCenter(){if(!this.view.basemapTerrain)return 0;if(!this._surfaceAltitudeAtCenterDirty)return this._surfaceAltitudeAtCenter;this._surfaceAltitudeAtCenterDirty=!1;const e=this._centerRay;if(B(e))return this._surfaceAltitudeAtCenter;const t=e.origin,n=rt(O1,e.origin,e.direction);return this._surfaceIntersector.resetWithRay(e,this.view.state.camera),this.view.basemapTerrain.intersect(this._surfaceIntersector,null,t,n),this._surfaceIntersector.results.min.getIntersectionPoint(O1)&&(this._surfaceAltitudeAtCenter=this.view.renderCoordsHelper.getAltitude(O1)),this._surfaceAltitudeAtCenter}_estimateSurfaceIntersectionAtRenderPoint(e,t,n){const r=s7(t,e,ivt);if(B(r))return null;const s=r.origin,a=rt(O1,r.origin,r.direction);return this._surfaceIntersector.resetWithRay(r,t),this.view.basemapTerrain.intersect(this._surfaceIntersector,null,s,a),this._surfaceIntersector.results.min.getIntersectionPoint(n)?n:null}_cameraChanged(e){this._updateCenterPointsOfInterest();const t=e.eye;uh(this.renderPointOfView,t)||this._set("renderPointOfView",Ge(this._propertiesPool.get("renderPointOfView"),t))}_updateCenterPointsOfInterest(){this._centerRayDirty=!0,this._surfaceAltitudeAtCenterDirty=!0,this._contentAltitudeAtCenterDirty=!0;for(const e of this._pois)e.updateRenderLocation()}_updateCenterOnContent(){this._contentAltitudeAtCenterDirty=!0,this.centerOnContent.updateRenderLocation()}_setDebug(e){if(!e)return this._debugCenters.forEach(t=>t.hide()),void this._handles.remove("debug");for(const t of this._pois)this._handles.add(ue(()=>t.renderLocation,n=>this._debugCenters.get(t).show(n,t.renderCoordsHelper.spatialReference),At),"debug")}get test(){return{update:()=>{this.surfaceGeometryUpdates.runTask();for(const e of this._pois)e.runTask()},surfaceGeometryUpdates:this.surfaceGeometryUpdates}}};f([y({readOnly:!0})],wo.prototype,"centerOnContent",void 0),f([y({readOnly:!0})],wo.prototype,"centerOnSurfaceFrequent",void 0),f([y({readOnly:!0})],wo.prototype,"centerOnSurfaceInfrequent",void 0),f([y({readOnly:!0})],wo.prototype,"contentCenterOnSurface",void 0),f([y({readOnly:!0})],wo.prototype,"cameraOnSurface",void 0),f([y({readOnly:!0})],wo.prototype,"contentCameraOnSurface",void 0),f([y({readOnly:!0})],wo.prototype,"focus",void 0),f([y({readOnly:!0})],wo.prototype,"renderPointOfView",void 0),f([y({readOnly:!0})],wo.prototype,"surfaceOrigin",void 0),f([y({readOnly:!0})],wo.prototype,"contentGeometryUpdates",void 0),f([y({readOnly:!0})],wo.prototype,"surfaceGeometryUpdates",void 0),f([y({constructOnly:!0})],wo.prototype,"view",void 0),f([y({readOnly:!0})],wo.prototype,"updating",null),wo=f([ge("esri.views.3d.support.PointsOfInterest")],wo);const tvt=Array,O1=q(),ivt=Oc(),nvt={exclude:new Set([lh])};let rvt=class{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,t){this._store.put(e,t,t.values.byteLength+256)}},svt=class{constructor(e){this.xTile=0,this.yTile=0,this.hash=0,this.priority=1,this.colliders=[],this.textVertexRanges=[],this.iconVertexRanges=[],this.tile=e}},V4t=class{constructor(){this.tileSymbols=[],this.parts=[{startTime:0,startOpacity:0,targetOpacity:0,show:!1},{startTime:0,startOpacity:0,targetOpacity:0,show:!1}],this.show=!1}};function z4t(i,e,t,n,r,s){const a=t-r;if(a>=0)return(e>>a)+(n-(s<<a))*(i>>a);const o=-a;return e-(s-(n<<o))*(i>>o)<<o}let U4t=class{constructor(e,t,n){this._rows=Math.ceil(t/n),this._columns=Math.ceil(e/n),this._cellSize=n,this.cells=new Array(this._rows);for(let r=0;r<this._rows;r++){this.cells[r]=new Array(this._columns);for(let s=0;s<this._columns;s++)this.cells[r][s]=[]}}getCell(e,t){const n=Math.min(Math.max(Math.floor(t/this._cellSize),0),this._rows-1),r=Math.min(Math.max(Math.floor(e/this._cellSize),0),this._columns-1);return this.cells[n]&&this.cells[n][r]||null}getCellSpan(e,t,n,r){return[Math.min(Math.max(Math.floor(e/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(t/this._cellSize),0),this.rows-1),Math.min(Math.max(Math.floor(n/this._cellSize),0),this.columns-1),Math.min(Math.max(Math.floor(r/this._cellSize),0),this.rows-1)]}get cellSize(){return this._cellSize}get columns(){return this._columns}get rows(){return this._rows}};function avt(i,e,t,n,r,s){const a=e[n++];for(let o=0;o<a;o++){const l=new svt(s);l.xTile=e[n++],l.yTile=e[n++],l.hash=e[n++],l.priority=e[n++];const c=e[n++];for(let h=0;h<c;h++){const p=e[n++],m=e[n++],g=e[n++],_=e[n++],b=!!e[n++],x=e[n++],w=t[n++],C=t[n++],S=e[n++],E=e[n++];l.colliders.push({xTile:p,yTile:m,dxPixels:g,dyPixels:_,hard:b,partIndex:x,width:S,height:E,minLod:w,maxLod:C})}const u=i[n++];for(let h=0;h<u;h++)l.textVertexRanges.push([i[n++],i[n++]]);const d=i[n++];for(let h=0;h<d;h++)l.iconVertexRanges.push([i[n++],i[n++]]);r.push(l)}return n}function G4t(i,e,t){for(const[n,r]of i.symbols)ovt(i,e,t,r,n)}function ovt(i,e,t,n,r){const s=i.layerData.get(r);if(s.type===rd.SYMBOL){for(const a of n){const o=a.unique;let l;if(a.selectedForRendering){const c=o.parts[0],u=c.startOpacity,d=c.targetOpacity;i.allSymbolsFadingOut=i.allSymbolsFadingOut&&d===0;const h=t?Math.floor(127*u)|d<<7:d?255:0;l=h<<24|h<<16|h<<8|h}else l=0;for(const[c,u]of a.iconVertexRanges)for(let d=c;d<c+u;d+=4)s.iconOpacity[d/4]=l;if(a.selectedForRendering){const c=o.parts[1],u=c.startOpacity,d=c.targetOpacity;i.allSymbolsFadingOut=i.allSymbolsFadingOut&&d===0;const h=t?Math.floor(127*u)|d<<7:d?255:0;l=h<<24|h<<16|h<<8|h}else l=0;for(const[c,u]of a.textVertexRanges)for(let d=c;d<c+u;d+=4)s.textOpacity[d/4]=l}s.lastOpacityUpdate=e,s.opacityChanged=!0}}let ED=class{constructor(e,t){this.layerUIDs=[],this.isDestroyed=!1,this._data=e,this.memoryUsed=e.byteLength;let n=1;const r=new Uint32Array(e);this.layerUIDs=[];const s=r[n++];for(let a=0;a<s;a++)this.layerUIDs[a]=r[n++];this.bufferDataOffset=n,t&&(this.layer=t.getStyleLayerByUID(this.layerUIDs[0]))}get isPreparedForRendering(){return B(this._data)}get offset(){return this.bufferDataOffset}destroy(){this.isDestroyed||(this.doDestroy(),this.isDestroyed=!0)}prepareForRendering(e){B(this._data)||(this.doPrepareForRendering(e,this._data,this.bufferDataOffset),this._data=null)}},lvt=class extends ED{constructor(e,t){super(e,t),this.type=rd.LINE,this.lineIndexStart=0,this.lineIndexCount=0;const n=new Uint32Array(e);let r=this.bufferDataOffset;this.lineIndexStart=n[r++],this.lineIndexCount=n[r++];const s=n[r++];if(s>0){const a=new Map;for(let o=0;o<s;o++){const l=n[r++],c=n[r++],u=n[r++];a.set(l,[c,u])}this.patternMap=a}this.bufferDataOffset=r}hasData(){return this.lineIndexCount>0}triangleCount(){return this.lineIndexCount/3}doDestroy(){T(this.lineVertexArrayObject)&&this.lineVertexArrayObject.dispose(),T(this.lineVertexBuffer)&&this.lineVertexBuffer.dispose(),T(this.lineIndexBuffer)&&this.lineIndexBuffer.dispose(),this.lineVertexArrayObject=null,this.lineVertexBuffer=null,this.lineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,n){const r=new Uint32Array(t),s=new Int32Array(r.buffer),a=r[n++];this.lineVertexBuffer=In.createVertex(e,kn.STATIC_DRAW,new Int32Array(s.buffer,4*n,a)),n+=a;const o=r[n++];this.lineIndexBuffer=In.createIndex(e,kn.STATIC_DRAW,new Uint32Array(r.buffer,4*n,o)),n+=o;const l=this.layer.lineMaterial;this.lineVertexArrayObject=new Ph(e,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.lineVertexBuffer},this.lineIndexBuffer)}},cvt=class extends ED{constructor(e,t){super(e,t),this.type=rd.FILL,this.fillIndexStart=0,this.fillIndexCount=0,this.outlineIndexStart=0,this.outlineIndexCount=0;const n=new Uint32Array(e);let r=this.bufferDataOffset;this.fillIndexStart=n[r++],this.fillIndexCount=n[r++],this.outlineIndexStart=n[r++],this.outlineIndexCount=n[r++];const s=n[r++];if(s>0){const a=new Map;for(let o=0;o<s;o++){const l=n[r++],c=n[r++],u=n[r++];a.set(l,[c,u])}this.patternMap=a}this.bufferDataOffset=r}hasData(){return this.fillIndexCount>0||this.outlineIndexCount>0}triangleCount(){return(this.fillIndexCount+this.outlineIndexCount)/3}doDestroy(){T(this.fillVertexArrayObject)&&this.fillVertexArrayObject.dispose(),T(this.fillVertexBuffer)&&this.fillVertexBuffer.dispose(),T(this.fillIndexBuffer)&&this.fillIndexBuffer.dispose(),this.fillVertexArrayObject=null,this.fillVertexBuffer=null,this.fillIndexBuffer=null,T(this.outlineVertexArrayObject)&&this.outlineVertexArrayObject.dispose(),T(this.outlineVertexBuffer)&&this.outlineVertexBuffer.dispose(),T(this.outlineIndexBuffer)&&this.outlineIndexBuffer.dispose(),this.outlineVertexArrayObject=null,this.outlineVertexBuffer=null,this.outlineIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,n){const r=new Uint32Array(t),s=new Int32Array(r.buffer),a=r[n++];this.fillVertexBuffer=In.createVertex(e,kn.STATIC_DRAW,new Int32Array(s.buffer,4*n,a)),n+=a;const o=r[n++];this.fillIndexBuffer=In.createIndex(e,kn.STATIC_DRAW,new Uint32Array(r.buffer,4*n,o)),n+=o;const l=r[n++];this.outlineVertexBuffer=In.createVertex(e,kn.STATIC_DRAW,new Int32Array(s.buffer,4*n,l)),n+=l;const c=r[n++];this.outlineIndexBuffer=In.createIndex(e,kn.STATIC_DRAW,new Uint32Array(r.buffer,4*n,c)),n+=c;const u=this.layer,d=u.fillMaterial,h=u.outlineMaterial;this.fillVertexArrayObject=new Ph(e,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.fillVertexBuffer},this.fillIndexBuffer),this.outlineVertexArrayObject=new Ph(e,h.getAttributeLocations(),h.getLayoutInfo(),{geometry:this.outlineVertexBuffer},this.outlineIndexBuffer)}},uvt=class extends ED{constructor(e,t,n){super(e,t),this.type=rd.SYMBOL,this.iconPerPageElementsMap=new Map,this.glyphPerPageElementsMap=new Map,this.symbolInstances=[],this.isIconSDF=!1,this.opacityChanged=!1,this.lastOpacityUpdate=0,this.symbols=[];const r=new Uint32Array(e),s=new Int32Array(e),a=new Float32Array(e);let o=this.bufferDataOffset;this.isIconSDF=!!r[o++];const l=r[o++];for(let h=0;h<l;h++){const p=r[o++],m=r[o++],g=r[o++];this.iconPerPageElementsMap.set(p,[m,g])}const c=r[o++];for(let h=0;h<c;h++){const p=r[o++],m=r[o++],g=r[o++];this.glyphPerPageElementsMap.set(p,[m,g])}const u=r[o++],d=r[o++];this.iconOpacity=new Int32Array(u),this.textOpacity=new Int32Array(d),o=avt(r,s,a,o,this.symbols,n),this.bufferDataOffset=o}hasData(){return this.iconPerPageElementsMap.size>0||this.glyphPerPageElementsMap.size>0}triangleCount(){let e=0;for(const[t,n]of this.iconPerPageElementsMap)e+=n[1];for(const[t,n]of this.glyphPerPageElementsMap)e+=n[1];return e/3}doDestroy(){T(this.iconVertexArrayObject)&&this.iconVertexArrayObject.dispose(),T(this.iconVertexBuffer)&&this.iconVertexBuffer.dispose(),T(this.iconOpacityBuffer)&&this.iconOpacityBuffer.dispose(),T(this.iconIndexBuffer)&&this.iconIndexBuffer.dispose(),this.iconVertexArrayObject=null,this.iconVertexBuffer=null,this.iconOpacityBuffer=null,this.iconIndexBuffer=null,T(this.textVertexArrayObject)&&this.textVertexArrayObject.dispose(),T(this.textVertexBuffer)&&this.textVertexBuffer.dispose(),T(this.textOpacityBuffer)&&this.textOpacityBuffer.dispose(),T(this.textIndexBuffer)&&this.textIndexBuffer.dispose(),this.textVertexArrayObject=null,this.textVertexBuffer=null,this.textOpacityBuffer=null,this.textIndexBuffer=null,this.memoryUsed=0}updateOpacityInfo(){if(!this.opacityChanged)return;this.opacityChanged=!1;const e=kt(this.iconOpacity),t=kt(this.iconOpacityBuffer);e.length>0&&e.byteLength===t.size&&t.setSubData(e,0,0,e.length);const n=kt(this.textOpacity),r=kt(this.textOpacityBuffer);n.length>0&&n.byteLength===r.size&&r.setSubData(n,0,0,n.length)}doPrepareForRendering(e,t,n){const r=new Uint32Array(t),s=new Int32Array(r.buffer),a=r[n++];this.iconVertexBuffer=In.createVertex(e,kn.STATIC_DRAW,new Int32Array(s.buffer,4*n,a)),n+=a;const o=r[n++];this.iconIndexBuffer=In.createIndex(e,kn.STATIC_DRAW,new Uint32Array(r.buffer,4*n,o)),n+=o;const l=r[n++];this.textVertexBuffer=In.createVertex(e,kn.STATIC_DRAW,new Int32Array(s.buffer,4*n,l)),n+=l;const c=r[n++];this.textIndexBuffer=In.createIndex(e,kn.STATIC_DRAW,new Uint32Array(r.buffer,4*n,c)),n+=c,this.iconOpacityBuffer=In.createVertex(e,kn.STATIC_DRAW,kt(this.iconOpacity).buffer),this.textOpacityBuffer=In.createVertex(e,kn.STATIC_DRAW,kt(this.textOpacity).buffer);const u=this.layer,d=u.iconMaterial,h=u.textMaterial;this.iconVertexArrayObject=new Ph(e,d.getAttributeLocations(),d.getLayoutInfo(),{geometry:this.iconVertexBuffer,opacity:this.iconOpacityBuffer},this.iconIndexBuffer),this.textVertexArrayObject=new Ph(e,h.getAttributeLocations(),h.getLayoutInfo(),{geometry:this.textVertexBuffer,opacity:this.textOpacityBuffer},this.textIndexBuffer)}},dvt=class extends ED{constructor(e,t){super(e,t),this.type=rd.CIRCLE,this.circleIndexStart=0,this.circleIndexCount=0;const n=new Uint32Array(e);let r=this.bufferDataOffset;this.circleIndexStart=n[r++],this.circleIndexCount=n[r++],this.bufferDataOffset=r}hasData(){return this.circleIndexCount>0}triangleCount(){return this.circleIndexCount/3}doDestroy(){T(this.circleVertexArrayObject)&&this.circleVertexArrayObject.dispose(),T(this.circleVertexBuffer)&&this.circleVertexBuffer.dispose(),T(this.circleIndexBuffer)&&this.circleIndexBuffer.dispose(),this.circleVertexArrayObject=null,this.circleVertexBuffer=null,this.circleIndexBuffer=null,this.memoryUsed=0}doPrepareForRendering(e,t,n){const r=new Uint32Array(t),s=new Int32Array(r.buffer),a=r[n++];this.circleVertexBuffer=In.createVertex(e,kn.STATIC_DRAW,new Int32Array(s.buffer,4*n,a)),n+=a;const o=r[n++];this.circleIndexBuffer=In.createIndex(e,kn.STATIC_DRAW,new Uint32Array(r.buffer,4*n,o)),n+=o;const l=this.layer.circleMaterial;this.circleVertexArrayObject=new Ph(e,l.getAttributeLocations(),l.getLayoutInfo(),{geometry:this.circleVertexBuffer},this.circleIndexBuffer)}},pI=class extends Iwe{constructor(e,t,n,r,s,a,o,l=null){super(e,t,n,r,s,a,4096,4096),this._memCache=l,this.type="vector-tile",this._referenced=0,this._hasSymbolBuckets=!1,this._memoryUsedByLayerData=0,this.layerData=new Map,this.layerCount=0,this.status="loading",this.allSymbolsFadingOut=!1,this.lastOpacityUpdate=0,this.symbols=new Map,this.isCoverage=!1,this.neededForCoverage=!1,this.decluttered=!1,this.invalidating=!1,this.parentTile=null,this.childrenTiles=new Set,this._processed=!1,this._referenced=1,this.styleRepository=o,this.id=e.id}get hasSymbolBuckets(){return this._hasSymbolBuckets}get isFading(){return this._hasSymbolBuckets&&performance.now()-this.lastOpacityUpdate<bW}get isHoldingForFade(){return this._hasSymbolBuckets&&(!this.allSymbolsFadingOut||performance.now()-this.lastOpacityUpdate<bW)}get wasRequested(){return this.status==="errored"||this.status==="loaded"||this.status==="reloading"}setData(e){this.changeDataImpl(e),this.requestRender(),this.ready(),this.invalidating=!1,this._processed=!0}deleteLayerData(e){let t=!1;for(const n of e)if(this.layerData.has(n)){const r=this.layerData.get(n);this._memoryUsedByLayerData-=r.memoryUsed,r.type===rd.SYMBOL&&this.symbols.has(n)&&(this.symbols.delete(n),t=!0),r.destroy(),this.layerData.delete(n),this.layerCount--}T(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData),t&&this.emit("symbols-changed"),this.requestRender()}processed(){return this._processed}hasData(){return this.layerCount>0}dispose(){this.status!=="unloaded"&&(tme.delete(this),pI._destroyRenderBuckets(this.layerData),this.layerData=null,this.layerCount=0,this._memoryUsedByLayerData=0,this.destroy(),this.status="unloaded")}release(){return--this._referenced==0&&(this.dispose(),this.stage=null,!0)}retain(){++this._referenced}get referenced(){return this._referenced}get memoryUsage(){return(this._memoryUsedByLayerData+256)/(this._referenced||1)}changeDataImpl(e){let t=!1;if(e){const{bucketsWithData:n,emptyBuckets:r}=e,s=this._createRenderBuckets(n);if(r&&r.byteLength>0){const a=new Uint32Array(r);for(const o of a)this._deleteLayerData(o)}for(const[a,o]of s)this._deleteLayerData(a),o.type===rd.SYMBOL&&(this.symbols.set(a,o.symbols),t=!0),this._memoryUsedByLayerData+=o.memoryUsed,this.layerData.set(a,o),this.layerCount++;T(this._memCache)&&this._memCache.updateSize(this.key.id,this,this._memoryUsedByLayerData)}this._hasSymbolBuckets=!1;for(const[n,r]of this.layerData)r.type===rd.SYMBOL&&(this._hasSymbolBuckets=!0);t&&this.emit("symbols-changed")}attachWithContext(e){this.stage={context:e,trashDisplayObject(t){t.processDetach()},untrashDisplayObject:()=>!1}}setTransform(e){super.setTransform(e);const t=this.resolution/(e.resolution*e.pixelRatio),n=this.width/this.rangeX*t,r=this.height/this.rangeY*t,s=[0,0];e.toScreen(s,[this.x,this.y]);const a=this.transforms.tileUnitsToPixels;Qie(a),UN(a,a,s),Jie(a,a,Math.PI*e.rotation/180),ene(a,a,[n,r,1])}_createTransforms(){return{dvs:ny(),tileMat3:ny(),tileUnitsToPixels:ny()}}static _destroyRenderBuckets(e){if(!e)return;const t=new Set;e.forEach(n=>{t.has(n)||(n.destroy(),t.add(n))}),e.clear()}_createRenderBuckets(e){const t=new Map,n=new Map;for(const r of e){const s=this._deserializeBucket(r,n);for(const a of s.layerUIDs)t.set(a,s)}return t}_deserializeBucket(e,t){let n=t.get(e);if(n)return n;switch(new Uint32Array(e)[0]){case rd.FILL:n=new cvt(e,this.styleRepository);break;case rd.LINE:n=new lvt(e,this.styleRepository);break;case rd.SYMBOL:n=new uvt(e,this.styleRepository,this);break;case rd.CIRCLE:n=new dvt(e,this.styleRepository)}return t.set(e,n),n}_deleteLayerData(e){if(!this.layerData.has(e))return;const t=this.layerData.get(e);this._memoryUsedByLayerData-=t.memoryUsed,t.destroy(),this.layerData.delete(e),this.layerCount--}};const tme=new Map;function hvt(){tme.forEach((i,e)=>{console.log(`
${e.key}:`),i[0].forEach(t=>console.log(t)),console.log("========"),i[1].forEach(t=>console.log(t))})}const Z4t={value:.5,readOnly:!0},pvt={readOnly:!0,value:.5,get(){return this.updating?this.updatingProgressValue:1}};let Zw=class{constructor(e=0,t=0){this.min=e,this.max=t,this.level=0,this.hasNoDataValues=!1}copyFrom(e){this.min=e.min,this.max=e.max,this.level=e.level,this.hasNoDataValues=e.hasNoDataValues}},fvt=class{constructor(e,t,n){this.type="elevation",this.level=e[0],this.i=e[1],this.j=e[2],this.extent=t;const r=n.noDataValue,s=n.values;let a=1/0,o=-1/0,l=!0,c=!1;for(let u=0;u<s.length;u++){const d=s[u];d!==r?(a=d<a?d:a,o=d>o?d:o,l=!1):c=!0}l&&(a=0,o=0),o=o>-3e38?o:0,this.samplerData=new X0e(n,t),this.bounds=[a,o],this.hasNoDataValues=c}release(){this.samplerData=null,this.bounds=null}computeMinMaxValue(e,t,n,r){r.min=1/0,r.max=-1/0,r.hasNoDataValues=!1;const s=e-this.level;if(s<=0)return r;const a=2**s;if(!(Math.floor(t/a)===this.i&&Math.floor(n/a)===this.j))return r;let o=1/0,l=-1/0;const c=this.samplerData.width,u=this.samplerData.pixelData,d=.5*lA;let h=(c-1)/a,p=(n-this.j*a)*h,m=(t-this.i*a)*h;if(h<1){const g=Math.floor(p),_=Math.floor(m),b=g+_*c,x=u[b],w=u[b+1],C=u[b+c],S=u[b+c+1];if(x+w+C+S<d){const E=p-g,A=m-_,P=LM(x,w,C,S,E,A),O=LM(x,w,C,S,E+h,A),M=LM(x,w,C,S,E,A+h),V=LM(x,w,C,S,E+h,A+h);return r.min=Math.min(P,O,M,V),r.max=Math.max(P,O,M,V),r}p=g,m=_,h=1}else p=Math.floor(p),m=Math.floor(m),h=Math.ceil(h);for(let g=p;g<=p+h;g++)for(let _=m;_<=m+h;_++){const b=u[g+_*c];b<d?(o=Math.min(o,b),l=Math.max(l,b)):r.hasNoDataValues=!0}return r.min=o,r.max=l,r}};const mvt=.5*lA;function ir(i,e,t){if(B(t))return null;for(const n of t){if(!n)continue;const r=n.safeWidth;let s=lt(n.dy*(n.y1-e),0,r),a=lt(n.dx*(i-n.x0),0,r);const o=Math.floor(s),l=Math.floor(a),c=n.width,u=o*c+l,d=n.pixelData,h=d[u],p=d[u+1],m=u+c,g=d[m],_=d[m+1];if(h+g+p+_<mvt){s-=o,a-=l;const b=h+(p-h)*a;return b+(g+(_-g)*a-b)*s}}return null}let Ju=class extends et{constructor(e){super(e),this._handles=new mi}initialize(){this._handles.add([this.layerViews.on("change",()=>this.notifyChange("stencilEnabledExtents"))])}destroy(){this._handles.destroy(),this._handles=null}get layerViewsExtent(){return this._computeLayerViewsExtent()}get tiledLayersExtent(){return this._computeTiledLayersExtent()}get stencilEnabledExtents(){return this._computeStencilEnabledExtents()}_computeStencilEnabledExtents(){const e=[];return this.layerViews.forEach(t=>{const n=t.layer;if(n.operationalLayerType==="IntegratedMeshLayer"&&this.viewSpatialReference!=null){const r=ime(n.fullExtent,this.viewSpatialReference);T(r)&&e.push(ane(r))}}),e}};function gvt(i,e){return i===Ot.Global?new l8(e):new c8(e)}f([y({readOnly:!0})],Ju.prototype,"layerViewsExtent",null),f([y({readOnly:!0})],Ju.prototype,"tiledLayersExtent",null),f([y({readOnly:!0})],Ju.prototype,"stencilEnabledExtents",null),f([y()],Ju.prototype,"viewSpatialReference",void 0),f([y()],Ju.prototype,"tilingScheme",void 0),f([y()],Ju.prototype,"defaultTiledLayersExtent",void 0),f([y({constructOnly:!0})],Ju.prototype,"layers",void 0),f([y({constructOnly:!0})],Ju.prototype,"layerViews",void 0),Ju=f([ge("esri.views.3d.terrain.ExtentHelper")],Ju);let l8=class extends Ju{_computeLayerViewsExtent(){return this._globalExtent}_computeTiledLayersExtent(){return this._globalExtent}get _globalExtent(){return this.viewSpatialReference.isWebMercator?yhe:Ont}};l8=f([ge("esri.views.3d.terrain.ExtentHelperGlobal")],l8);let c8=class extends Ju{_computeLayerViewsExtent(){const e=Eh(),t=this.viewSpatialReference;this.layerViews.forEach(s=>{const a=s.layer;if(s.isResolved()&&(a.type!=="graphics"||!a.internal)){const o=ime("fullExtentInLocalViewSpatialReference"in s&&s.fullExtentInLocalViewSpatialReference||s.layer.fullExtent,t);ry(e,o,e)}});const n=GN(e)?e:null,r=this._get("layerViewsExtent");return $0(n,r)?r:n}_computeTiledLayersExtent(){const e=this.tilingScheme;if(!e)return null;const t=this.viewSpatialReference,n=Eh();this.layers.forEach(a=>{if(a.loaded&&ax(a)){const o=SD(a,t,Ot.Local);if(B(o))return;const{tileInfo:l,fullExtent:c}=o;T(l)&&T(c)&&(hL(a)||e.compatibleWith(l)&&c.spatialReference.equals(e.spatialReference))&&ry(n,c,n)}}),ry(n,this.defaultTiledLayersExtent,n);const r=GN(n)?n:null,s=this._get("tiledLayersExtent");return $0(r,s)?s:r}};function ime(i,e){return T(i)&&!i.spatialReference.equals(e)?Wye(i,i.spatialReference,e):i}c8=f([ge("esri.views.3d.terrain.ExtentHelperLocal")],c8);var Li;(function(i){i[i.ELEVATION=0]="ELEVATION",i[i.MAP=1]="MAP"})(Li||(Li={}));const U_=[Li.ELEVATION,Li.MAP];function nme(){var e;const i=(e=globalThis.require)==null?void 0:e.modules;if(i){const t=Object.keys(i);for(const n of t)n.search(".glsl")!==-1&&delete i[n]}}const vvt=[[-.1,-2,3.9,2],[-.1,-3.9,3.9,.1],[-2,-3.9,2,.1],[-3.9,-3.9,.1,.1],[-3.9,-2,.1,2],[-3.9,-.1,.1,3.9],[-2,-.1,2,3.9],[-.1,-.1,3.9,3.9]];let Zg,Ol=class extends et{constructor(e){super(e),this._handles=new mi,this._spatialReference=null,this._renderSR=null,this._overlaySREqualsRenderSR=!0,this._drapeSources=new Set,this._drapeTargets=new Set,this._placementDirty=!1,this._contentUpdated=!1,this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1,this._hasUnusedRenderTargets=!1,this._longitudeCyclical=null,this._latestOriginId=0,this._maxResolution=Fi("esri-mobile")?2048:4096,this._animationTimeLast=0}get running(){return this._placementDirty&&(this._drapeSources.size>0||this._view.graphics.length>0||cn.OVERLAY_DRAW_DEBUG_TEXTURE)&&!!this._spatialReference&&!this.suspended&&this.surface.ready}get _isSpherical(){return this._view.state.isGlobal}get _worldToPCSRatio(){return T(this._spatialReference)&&this._spatialReference.isGeographic&&!this._view.state.isLocal?rn(this._spatialReference).metersPerDegree:1}get _view(){return this.surface.view}get suspended(){return this.surface.suspended}get updating(){return this.running||this.renderer.updating||this._contentUpdated}get hasHighlights(){return this.renderer.hasHighlights}get rendersOccluded(){return this.renderer.rendersOccluded}initialize(){var t;const e=this._view;this.renderer=new cp({view:e,worldToPCSRatio:this._worldToPCSRatio,spatialReference:this._spatialReference}),this._groundIntersector=Od(this._view.state.viewingMode),this._groundIntersector.options.backfacesTerrain=!0,this._groundIntersector.options.invisibleTerrain=!0,this._groundIntersector.options.hud=!1,this._handles.add([this.renderer.events.on("has-highlights",()=>{this.setDrawTexturesDirty(),this.notifyChange("hasHighlights")}),this.renderer.events.on("has-water",n=>{var r;return(r=e._stage)==null?void 0:r.renderView.setRenderParameters({hasOverlayWater:n})}),this.renderer.events.on("renders-occluded",()=>{this.setDrawTexturesDirty(),this.notifyChange("rendersOccluded")}),this.renderer.events.on("content-changed",()=>this.setDrawTexturesDirty()),this.renderer.events.on("textures-disposed",()=>this.updateOverlayResult()),ue(()=>{var n,r,s;return[(n=e.pointsOfInterest)==null?void 0:n.renderPointOfView,(s=(r=e.pointsOfInterest)==null?void 0:r.centerOnSurfaceFrequent)==null?void 0:s.location]},()=>this.setPlacementDirty()),ue(()=>{var n;return(n=e.state)==null?void 0:n.pixelRatio},()=>this.setPlacementDirty(),on),this.surface.on("elevation-change",()=>this.setPlacementDirty()),e.on("resize",()=>this.setPlacementDirty()),e.resourceController.scheduler.registerTask($r.OVERLAY,this),e._stage.renderView.events.on("force-camera-for-screenshot",n=>{this._updateOverlays(n,ds.BACKGROUND),this.renderer.hasOverlays&&this._drawOverlayTextures(this.renderer.overlays,ds.BACKGROUND,n)})]),(t=e._stage)==null||t.renderView.setRenderParameters({renderOverlay:n=>{this._contentUpdated=!1,this.renderer.processSyncDrapeSources(),this.renderer.hasOverlays&&(this._dispatchAnimationUpdate(n),this._drawOverlayTextures(this.renderer.overlays,ds.UPDATE)),this._hasUnusedRenderTargets&&this._collectUnusedRenderTargetMemory()}})}destroy(){this.renderer.dispose(),this._handles&&(this._handles.destroy(),this._handles=null),T(Zg)&&(Zg.hide(),Zg=null)}get hasOverlays(){return this.renderer.hasOverlays}setSpatialReference(e){this._spatialReference=e,this.renderer.spatialReference=e,this._longitudeCyclical=null;const t=this._view.renderSpatialReference;T(e)&&T(t)?(this._renderSR=t,this._overlaySREqualsRenderSR=e.equals(this._renderSR),this._isSpherical&&(this._longitudeCyclical=e.isWebMercator?new i2(-20037508342787e-6,20037508342787e-6):new i2(-180,180),this.renderer.longitudeCyclical=this._longitudeCyclical),this.renderer&&(this.renderer.worldToPCSRatio=this._worldToPCSRatio)):this.renderer.disposeOverlays()}get gpuMemoryUsage(){return this.renderer.gpuMemoryUsage}registerDrapeSource(e,t,n){this._drapeSources.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const r=this.renderer.createDrapeSourceRenderer(e,t,n);return this._updateDrapeSourceExtent(e),this._setContentDirty(),this.notifyChange("running"),r}registerGeometryDrapeSource(e){return this.registerDrapeSource(e,yp)}_updateDrapeSourceExtent(e){this.renderer.overlays.length===2&&T(e.setDrapingExtent)&&T(this._spatialReference)&&e.setDrapingExtent(this.renderer.overlays,this._spatialReference)}unregisterDrapeSource(e){this._drapeSources.has(e)&&(this._drapeSources.delete(e),this.renderer.removeDrapeSourceRenderer(e),this.renderer.ensureDrapeSources(this._drapeSources),this._setContentDirty(),this.notifyChange("running"))}registerDrapeTarget(e){this._drapeTargets.add(e),this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources)}updateOverlayResult(){var e;(e=this._view._stage)==null||e.renderView.setRenderParameters({overlays:this.renderer.overlays})}unregisterDrapeTarget(e){this._drapeTargets.delete(e),this.renderer.ensureDrapeTargets(this._drapeTargets)}_setContentDirty(){this.setPlacementDirty(),this.setDrawTexturesDirty()}setPlacementDirty(){this._placementDirty=!0}runTask(){this._updateOverlays(this._view.state.camera,ds.UPDATE)}_updateOverlays(e,t){if(!this._spatialReference)return;const n=tdt(e.fullWidth,e.fullHeight,this._maxResolution);this._computeOverlayExtents(e,n,Bf);const r=Mp(Bf.inner)/Mp(Bf.outer);this.renderer.ensureOverlays(this._drapeTargets,this._drapeSources);const s=this._updateOverlay(br.INNER,Bf.inner,n,1*Bf.pixelRatioAdjustment,Bf.mapUnitsPerPixel),a=this._updateOverlay(br.OUTER,Bf.outer,n,r*Bf.pixelRatioAdjustment,Bf.mapUnitsPerPixel);s!==_p.EXTENT&&a!==_p.EXTENT||(this._drapeSources.forEach(o=>this._updateDrapeSourceExtent(o)),this.surface.updateTileOverlayParams(t)),s===_p.NONE&&a===_p.NONE||this.setDrawTexturesDirty(),this._placementDirty=!1}_updateOverlay(e,t,n,r,s){if(this.renderer.overlays.length===0)return _p.NONE;const a=this.renderer.overlays[e],o=a.mapUnitsPerPixel;if(a.mapUnitsPerPixel=s,a.pixelRatio=r,yvt(t,a.extent)&&n===a.resolution)return o===s?_p.NONE:_p.RERENDER_ONLY;u2(a.extent,t),a.resolution=n;const l=AB(a.extent);return a.renderLocalOrigin=IE(l[0],l[1],0,"OV_"+this._latestOriginId++),_p.EXTENT}setTileParameters(e){const t=e.renderData.overlay;if(this.renderer.overlays.length>0){const n=this.renderer.overlays[br.INNER],r=this.renderer.overlays[br.OUTER],s=e.extent;this._rectInsideRect(n.extent,s)||this._rectanglesOverlap(s,n.extent)||this._rectanglesOverlap(s,r.extent)?(this._setTileOverlayData(s,br.INNER,t),this._setTileOverlayData(s,br.OUTER,t)):(this._clearTileOverlayData(br.INNER,t),this._clearTileOverlayData(br.OUTER,t))}else this._clearTileOverlayData(br.INNER,t),this._clearTileOverlayData(br.OUTER,t)}overlayPixelSizeInMapUnits(e){if(this.renderer.overlays.length===0)return 0;const t=this.renderer.overlays[br.INNER],n=this.renderer.overlays[br.OUTER],r=this._pointIsInExtent(e,t.extent)?t:n;return(r.extent[2]-r.extent[0])/r.resolution}_setTileOverlayData(e,t,n){if(this.renderer.overlays.length===0)return;const r=this.renderer.overlays[t].extent,s=Mp(r),a=vy(r);let o=e[0];if(this._longitudeCyclical){o=this._longitudeCyclical.minimalMonotonic(r[0],o);const l=this._longitudeCyclical.minimalMonotonic(r[0],e[2]);o>l&&(o=l-(e[2]-e[0]))}n.setScale(t,Mp(e)/s,vy(e)/a),n.setOffset(t,(o-r[0])/s,(e[1]-r[1])/a)}_clearTileOverlayData(e,t){t.setScale(e,-1,-1),t.setOffset(e,-1,-1)}async reloadShaders(){nme(),await this.renderer.reloadShaders(),this.setDrawTexturesDirty(),this.runTask()}_dispatchAnimationUpdate(e){const t=Wi(e-this._animationTimeLast);e=Jt(this._view.state.forcedAnimationTime,e),(t>=this.surface.view._stage.renderView.animationTimestep||T(this._view.state.forcedAnimationTime)||this._drawTexturesDirty||this._drawTexturesAnimateDirty)&&(this.renderer.updateAnimation({time:e,camera:this._view.state.camera})&&(this._drawTexturesAnimateDirty=!0),this._animationTimeLast=e)}setDrawTexturesDirty(){this.renderer.hasOverlays?(this._contentUpdated=!0,this._drawTexturesDirty=!0,this._view._stage.renderView.requestRender()):this.setPlacementDirty()}_intersectGroundFromView(e,t,n,r){const s=this._view.sceneIntersectionHelper.getCenterRayWithSubpixelOffset(e,wvt,t,n);if(B(s))return!1;const a=s.origin,o=rt(vO,s.origin,s.direction);return this._groundIntersector.reset(a,o,e),this._groundIntersector.intersect([],null),this._view.basemapTerrain.intersect(this._groundIntersector,null,a,o),this._groundIntersector.results.min.getIntersectionPoint(r)}_findHorizonBasedPointOfInterest(e,t){let n=.5;const r=.55,s=this._view.renderCoordsHelper.getAltitude(e.eye),a=this._view.pointsOfInterest.centerOnSurfaceFrequent,o=1e-5,l=lt(a.estimatedSurfaceAltitude,e.aboveGround?-1/0:s+o,e.aboveGround?s-o:1/0),c=e.aboveGround;if(this._view.viewingMode==="global"){const u=vO;KL(PB(OB,rn(this._view.spatialReference).radius+l),Ah(e.eye,e.viewForward),u),nt(u,u,e.eye);const d=py.normalize(lne(e.viewForward,u,e.viewRight))/e.fovY+.5,h=d<=0||d>=1?.5:r;n=c?h*d:d+h*(1-d)}else{const u=.5*Math.PI-Math.acos(-e.viewForward[2]),d=Math.tan(u),h=Xn(0,d,1,0),p=Sm(h,h,e.projectionMatrix)[1],m=lt(.5+.5*p,0,1);n=m===1||m===0?.5:c?m*r:1-(1-m)*r}return!!this._intersectGroundFromView(e,.5,n,t)&&tne(t,e.eye)<a.distance*a.distance}_computeOverlayExtents(e,t,n){const r=this._view.pointsOfInterest.centerOnSurfaceFrequent.renderLocation,s=q();this._findHorizonBasedPointOfInterest(e,s)||Ge(s,r);const a=Math.max(.1,Gn(e.eye,s)),o=Oy(this._view.renderCoordsHelper,r,e.eye),l=Math.PI/2-Math.abs(o-Math.PI/2);cn.OVERLAY_SHOW_CENTER?(B(Zg)&&(Zg=new _v(this._view.graphics,"red")),Zg.show(s,this._renderSR)):T(Zg)&&Zg.hide(),this._overlaySREqualsRenderSR||no(s,this._renderSR,s,this._spatialReference);const c=this.surface.extent,u=!this._isSpherical&&T(this._spatialReference)&&this._spatialReference.isGeographic,d=u&&T(this._spatialReference)?1/rn(this._spatialReference).metersPerDegree:1,h=e.perRenderPixelRatio*a*d;n.mapUnitsPerPixel=h/this._worldToPCSRatio;let p=t*h/2,m=!1,g=u?90:1/0;this._isSpherical&&T(c)&&T(this._spatialReference)&&(this._spatialReference.isWebMercator?(p/=Math.cos(ON(s[1])),g=c[3]):(m=!0,p/=rn(this._spatialReference).metersPerDegree,g=90),p>=g&&(p=g,s[1]=0,this._spatialReference.isWebMercator&&(s[0]=0)));let _=1;m&&(_=1/Math.max(.2,Math.cos(Math.abs(zi(s[1])))),p*_>180&&(_=180/p),n.mapUnitsPerPixel*=_);const b=Math.log(2)/12;p=Math.exp(Math.round(Math.log(p)/b)*b);const x=p*_,w=32,C=.5*t/(w*x),S=.5*t/(w*p);s[0]=Math.round(s[0]*C)/C,s[1]=Math.round(s[1]*S)/S;const E=n.inner;E[0]=s[0]-x,E[1]=s[1]-p,E[2]=s[0]+x,E[3]=s[1]+p,this._isSpherical&&this._shiftExtentToFitBounds(E,1/0,g);const A=n.outer;if(6*x>Mp(c))u2(A,kt(c));else if(l<=.25*Math.PI)A[0]=E[0]-x,A[1]=E[1]-p,A[2]=E[2]+x,A[3]=E[3]+p;else{no(e.eye,this._renderSR,vO,this._spatialReference),Yn(w_,s,vO);let O=-Math.atan2(w_[1],w_[0])+.125*Math.PI;O<0&&(O+=2*Math.PI);const M=Math.floor(O/(.25*Math.PI));VB(w_,vvt[M],2*p),w_[0]*=_,w_[2]*=_,J0e(A,E,w_)}if(this._isSpherical)A[0]=this._longitudeCyclical.clamp(A[0]),A[2]=this._longitudeCyclical.clamp(A[2]),A[1]=Math.max(A[1],-g),A[3]=Math.min(A[3],g);else{const O=WN(E,c,_vt),M=WN(A,c,bvt);BG(O,M)&&(A[2]=A[0],A[3]=A[1])}const P=Math.abs(E[2]-E[0])/t;n.mapUnitsPerPixel=Math.max(n.mapUnitsPerPixel,P),n.pixelRatioAdjustment=n.mapUnitsPerPixel/P}_drawOverlayTextures(e,t,n=this._view.state.camera){if(e.length===0||!this._drawTexturesDirty&&!this._drawTexturesAnimateDirty)return;const r=this._drawTexturesDirty;this._drawTexturesDirty=!1,this._drawTexturesAnimateDirty=!1;const s=this._drawOverlay(e[br.INNER],n),a=this._drawOverlay(e[br.OUTER],n);s!==ZI.CHANGED&&a!==ZI.CHANGED||this.surface.updateTileOverlayParams(ds.UPDATE),this._collectUnusedRenderTargetMemory(),this.updateOverlayResult(),r?(this.surface.requestRender(t),t===ds.UPDATE&&this.surface.requestUpdate()):this.surface.requestRender(ds.BACKGROUND)}_drawOverlay(e,t){return this._longitudeCyclical?e.setupGeometryViewsCyclical(this._longitudeCyclical):e.setupGeometryViewsDirect(),e.draw(this.renderer,t.pixelRatio)}_collectUnusedRenderTargetMemory(){if(this._hasUnusedRenderTargets=!1,this.renderer.hasOverlays){const e=performance.now();this._hasUnusedRenderTargets=this.renderer.collectUnusedRenderTargetMemory(e)}}_rectanglesOverlap(e,t){return!B(e)&&(this._longitudeCyclical?(this._longitudeCyclical.contains(t[0],t[2],e[0])||this._longitudeCyclical.contains(t[0],t[2],e[2])||this._longitudeCyclical.contains(e[0],e[2],t[0]))&&!(e[1]>t[3]||e[3]<t[1]):jL(e,t))}_rectInsideRect(e,t){return!B(t)&&(this._longitudeCyclical?this._longitudeCyclical.contains(e[0],e[2],t[0])&&this._longitudeCyclical.contains(e[0],e[2],t[2])&&t[1]>e[1]&&t[3]<e[3]:BG(e,t))}_pointIsInExtent(e,t){if(this._longitudeCyclical)return this._longitudeCyclical.contains(t[0],t[2],e.x)&&e.y>=t[1]&&e.y<=t[3];const n=e.x,r=e.y;return n>t[0]&&n<t[2]&&r>t[1]&&r<t[3]}_shiftExtentToFitBounds(e,t,n){let r=0,s=0;e[0]<-t?r=e[0]+t:e[2]>t&&(r=t-e[2]),e[1]<-n?s=e[1]+n:e[3]>n&&(s=n-e[3]),jI(e,r,s)}get test(){return{renderer:this.renderer,update:()=>this.runTask()}}};function yvt(i,e){const n=cn.TESTS_DISABLE_OPTIMIZATIONS?0:1e-5*Math.max(i[2]-i[0],i[3]-i[1],e[2]-e[0],e[3]-e[1]);return Math.abs(e[0]-i[0])<=n&&Math.abs(e[1]-i[1])<=n&&Math.abs(e[2]-i[2])<=n&&Math.abs(e[3]-i[3])<=n}f([y()],Ol.prototype,"_spatialReference",void 0),f([y({readOnly:!0})],Ol.prototype,"running",null),f([y()],Ol.prototype,"_placementDirty",void 0),f([y()],Ol.prototype,"_contentUpdated",void 0),f([y()],Ol.prototype,"_isSpherical",null),f([y()],Ol.prototype,"_worldToPCSRatio",null),f([y()],Ol.prototype,"renderer",void 0),f([y({constructOnly:!0})],Ol.prototype,"surface",void 0),f([y()],Ol.prototype,"suspended",null),f([y()],Ol.prototype,"updating",null),f([y({type:Boolean})],Ol.prototype,"hasHighlights",null),f([y({type:Boolean})],Ol.prototype,"rendersOccluded",null),Ol=f([ge("esri.views.3d.terrain.OverlayManager")],Ol);const w_=Dn(),vO=q(),Bf={inner:qi(),outer:qi(),mapUnitsPerPixel:0,pixelRatioAdjustment:1},_vt=qi(),bvt=qi(),wvt=Oc();var _p;(function(i){i[i.NONE=0]="NONE",i[i.EXTENT=1]="EXTENT",i[i.RERENDER_ONLY=2]="RERENDER_ONLY"})(_p||(_p={}));let gL=class{constructor(e,t){this._factoryCallback=e,this._lengthCallback=t,this._pool=new Map}acquire(e){if(!gL.test.disabled){const t=this._pool.get(e);if(t&&t.length!==0)return t.pop()}try{return this._factoryCallback(e)}catch(t){const n=window.performance&&window.performance.memory;let r="";throw n&&(r=`
  totalJSHeapSize: ${n.totalJSHeapSize}, usedJSHeapSize: ${n.usedJSHeapSize}, jsHeapSizeLimit: ${n.jsHeapSizeLimit}`),console.log("Array allocation of size "+e+" failed: "+t+r),t}}release(e){if(gL.test.disabled)return;const t=this._lengthCallback(e);let n=this._pool.get(t);n||(n=new pn({shrink:!0}),this._pool.set(t,n)),n.push(e)}clear(){this._pool.clear()}get test(){return{size:this._pool.size}}};gL.test={disabled:!1};let xvt=class{constructor(){this.indices=null,this.vertexAttributes=null,this.boundingBox=fr(),this.indexCount=0,this.numVerticesPerSide=0,this.uvRange=[0,0,1,1],this.outerEdges=[null,null,null,null],this.innerEdges=[null,null,null,null]}},IJ=class{constructor(e,t,n,r,s){this.attributes=e,this.localOrigin=t,this.index0=n,this.stride=r,this.count=s}getVertexIndex(e){return this.getAttributeIndex(e)}getAttributeIndex(e){return yt(0<=e&&e<this.count),this.index0+this.stride*e}_getVertexRaw(e,t){this.attributes.position.getVec(e,t)}_getNormalRaw(e,t){this.attributes.normalCompressed.getVec(e,t)}getVertexPos(e,t){this._getVertexRaw(this.getAttributeIndex(t),e),rt(e,e,this.localOrigin)}getNormal(e,t){const n=xt();this._getNormalRaw(this.getAttributeIndex(t),n),Evt(e,n)}_setNormal(e,t,n,r){PA(this.attributes.normalCompressed,e,t,n,r)}_setUV(e,t,n){Fc(this.attributes.uv0,e,t,n)}setNormalFromValues(e,t,n,r){this._setNormal(this.getAttributeIndex(e),t,n,r)}setVertexFromValuesRawPositionUV(e,t,n,r,s,a){const o=this.getAttributeIndex(e);this.attributes.position.setValues(o,t,n,r),this._setUV(o,s,a)}setVertexFromValuesRawPositionUVNormal(e,t,n,r,s,a,o,l,c){const u=this.getAttributeIndex(e);this.attributes.position.setValues(u,t,n,r),this._setUV(u,s,a),this._setNormal(u,o,l,c)}};const Cvt=Js().vec3f(j.POSITION).vec2i16(j.UV0).vec2i16(j.NORMALCOMPRESSED,{glNormalized:!0}),tH=new gL(i=>Cvt.createBuffer(i),i=>i.count);function Tvt(){tH.clear()}function rme(i){return tH.acquire(i)}function Svt(i){tH.release(i.vertexAttributes),i.vertexAttributes=null,i.indices=null}function PA(i,e,t,n,r){const s=1/(Math.abs(t)+Math.abs(n)+Math.abs(r)),a=t*s,o=n*s,l=r<=0?(a>=0?1:-1)*(1-Math.abs(o)):a,c=r<=0?(o>=0?1:-1)*(1-Math.abs(a)):o;i.setValues(e,LJ(l),LJ(c))}function Evt(i,e){const t=DJ(e[0]),n=DJ(e[1]),r=1-Math.abs(t)-Math.abs(n);i[2]=r,r<0?(i[0]=(t>=0?1:-1)*(1-Math.abs(n)),i[1]=(n>=0?1:-1)*(1-Math.abs(t))):(i[0]=t,i[1]=n),mt(i,i)}const $J=16384;function Fc(i,e,t,n){i.setValues(e,t*$J,n*$J)}function LJ(i){return lt(Math.round(32767*i),-32767,32767)}function DJ(i){return lt(i/32767,-1,1)}function cl(i,e,t,n){i<n[0]?n[0]=i:i>n[3]&&(n[3]=i),e<n[1]?n[1]=e:e>n[4]&&(n[4]=e),t<n[2]?n[2]=t:t>n[5]&&(n[5]=t)}let Avt=class{constructor(){this.sinLonLUT=new Array(bS+1),this.cosLonLUT=new Array(bS+1),this.sinLatLUT=new Array(bS+1),this.cosLatLUT=new Array(bS+1)}update(e,t,n){const r=t[0],s=t[2];for(let a=0;a<=e;a++){const o=a/e,l=r*(1-o)+s*o;this.sinLonLUT[a]=Math.sin(l),this.cosLonLUT[a]=Math.cos(l);const c=n(o);this.sinLatLUT[a]=Math.sin(c),this.cosLatLUT[a]=Math.cos(c)}}},yO=class{constructor(){this.cornerTiles=[null,null,null,null],this.cornerTileSamplerVersions=[-1,-1,-1,-1]}},Mvt=class{constructor(){this.cornerNeighborData=[new yO,new yO,new yO,new yO],this.edgeResolutions=[-1,-1,-1,-1],this.edgePeerNeighbors=[null,null,null,null],this.edgePeerNeighborSamplerVersions=[-1,-1,-1,-1],this.cornerPeerNeighbors=[null,null,null,null]}},Pvt=class{constructor(){this.numVerticesPerSide=0,this.samplerData=null,this.clippingArea=null,this.wireframe=!1,this.shading=!1,this.samplerDataVersion=0,this.neighborData=new Mvt}},kE=class{constructor(e){this._getFadeDuration=e,this._fadeStart=0,this._delayedTime=0}clear(){this._current=_t(this._current),this._next=_t(this._next),this._waiting=_t(this._waiting),this._delayed=_t(this._delayed)}get current(){if(B(this._current))return null;if(!this._isFadingEnabled){const t=this._delayed||this._waiting||this._next||this._current;t!==this._current&&(this._current=null,this.clear(),this._current=t)}let e=kE.test.fadeMoment;if(T(this._delayed)&&(e=e||performance.now(),e>=this._delayedTime&&(this._push(this._delayed,Lm.Immediate),this._delayed=null)),T(this._next)){e=e||performance.now();const t=this._fadeDuration,n=T(this._current)&&this._next.texture===this._current.texture,r=this._next.type!==ha.FADING,s=e-this._fadeStart>=t;(n||r||s)&&(_t(this._current),this._current=this._next,this._next=this._waiting,this._waiting=null,this._fadeStart=this._alignFadeStart(e))}return this._current}get next(){return this._next}get fadeFactor(){if(B(this._next))return 1;const e=kE.test.fadeMoment||performance.now(),t=Math.max(0,e-this._fadeStart),n=this._fadeDuration;return t>n?0:1-t/n}get isFading(){return T(this._next)||T(this._delayed)}push(e,t=Lm.Immediate){this._delayed=_t(this._delayed),this._push(e,t)}_push(e,t){if(this._isFadingEnabled||this.clear(),B(this._current))return void(this._current=e);const n=kE.test.fadeMoment||performance.now();return t!==Lm.Immediate?(this._delayed=e,void(this._delayedTime=n+t)):B(this._next)?(this._next=e,void(this._fadeStart=this._alignFadeStart(n))):void(B(e)||(_t(this._waiting),this._waiting=e))}get _fadeDuration(){return B(this._waiting)?this._getFadeDuration():.5*this._getFadeDuration()}_alignFadeStart(e){const t=this._getFadeDuration();return e+t-e%t}get _isFadingEnabled(){return this._getFadeDuration()>0}};var Lm;kE.test={fadeMoment:0},function(i){i[i.Immediate=0]="Immediate",i[i.Delayed=5e3]="Delayed"}(Lm||(Lm={}));let sme=class{constructor(){this._queue=new pn,this._last=null,this.remove=()=>{}}get done(){return this._queue.length===0&&(!this._last||this._last.isLeaf)}resetOne(e){this._queue.clear(),this._queue.push(e),this._last=null}reset(e=null){this._queue.clear(),T(e)&&this._queue.pushArray(e),this._last=null}skipSubtree(){this._last=null}next(){return this._last&&!this._last.isLeaf&&this._queue.pushArray(this._last.children),this._last=this._queue.pop(),this._last}},Ovt=class{constructor(){this._q=new pn}get done(){return this._q.length===0}reset(e){if(this._q.clear(),!B(e)){this._q.pushArray(e);for(let t=0;t<this._q.length;++t){const n=this._q.data[t];n.isLeaf||this._q.pushArray(n.children)}}}next(){return this._q.pop()}};function FE(i,e,t){if(B(e)||B(e.fullExtent))return!1;const n=e.fullExtent,r=i.extent;if(t){if(r[0]<n.xmin||r[1]<n.ymin||r[2]>n.xmax||r[3]>n.ymax)return!1}else if(n.xmin>r[2]||n.ymin>r[3]||n.xmax<r[0]||n.ymax<r[1])return!1;const s=i.surface.tilingScheme.levels[i.level].scale;return!(e.minScale>0&&s>1.00000001*e.minScale)&&!(e.maxScale>0&&s<.99999999*e.maxScale)}function Dm(i,e){return i.lij[0]-e.lij[0]||i.lij[1]-e.lij[1]||i.lij[2]-e.lij[2]}function ame(i,e,t=null){B(t)||t.length===0?e.sort((n,r)=>iH(n,r,i)):e.sort((n,r)=>Rvt(n,r,i,t))}function iH(i,e,t){const n=i.screenDepth,r=e.screenDepth;return n<r?-t:n>r?t:Dm(i,e)}function Rvt(i,e,t,n){return kJ(i,n)===kJ(e,n)?iH(i,e,t):i?t:-t}function kJ(i,e){for(const t of e)if(i.intersectsExtent(t))return!0;return!1}function Ivt(i,e){const t=new Map;i.forAll(n=>t.set(n.lij,n.distanceToSquared(e))),i.sort((n,r)=>t.get(n.lij)-t.get(r.lij)||Dm(n,r))}function $vt(i,e,t){let n=1,r=0,s=0;for(;i!==e;)if(n*=.5,r*=.5,s*=.5,1&i.lij[2]&&(r+=.5),!(1&i.lij[1])&&(s+=.5),(i=i.parent)==null)throw new Error("tile was not a descendant of upsampleTile");t.init(e,r,s,n)}function Lvt(i){for(let e=0;e<i.length;e++){const t=i[e],n=t.parent;if(n)for(let r=0;r<4;r++){const s=n.children[r];if(s&&s!==t)return!0}}return!1}function fNt(i,e){if(!i||!e||i[0]===e[0])return!1;const t=i[0]<e[0],n=t?i:e,r=t?e:i,s=1<<r[0]-n[0];return Math.floor(r[1]/s)===n[1]&&Math.floor(r[2]/s)===n[2]}let nH=class{get updating(){return!!this._tileRequested}init(e,t,n,r){this.tile=e,this._layerIdx=t,this._layerClass=n,this._suspended=r,this._tileLayerInfo=e.getLayerInfo(t,n),this._tileRequested=null;const s=this._findAncestorWithData();this._setUpsampleTile(s)}startLoading(){return this._requestNext()}dispose(){this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null),this.tile=null,this._tileLayerInfo=null}setSuspension(e){e!==this._suspended&&(this._suspended=e,e?this._tileRequested&&(this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null):this._tileLayerInfo.data||this.update())}update(){const e=this._findAncestorWithData();return this._setUpsampleTile(e),this._requestNext()}dataArrived(e){this._setUpsampleTile(e),this._tileRequested=null,e===this.tile?this.tile.updateRenderData(this._layerClass,ha.FADING):this._requestNext()}dataMissing(){this._tileRequested=null,this._tileLayerInfo.data=null,this._requestNext()}_agentDone(){this.tile.agentDone(this._layerIdx,this._layerClass),this.dispose()}_requestNext(){if(this._suspended)return!0;const e=this._findNextDownload();if(this._tileRequested){if(e===this._tileRequested)return!0;this._tileRequested.unrequestLayerData(this._layerIdx,this._layerClass,this),this._tileRequested=null}return T(e)?e.requestLayerData(this._layerIdx,this._layerClass,this)&&(this._tileRequested=e):this._agentDone(),!!this._tileRequested}_findNextDownload(){const e=this._layerIdx,t=this._layerClass,n=this.tile.surface.layerViewByIndex(e,t),r=r8(n),{minLevel:s,maxLevel:a}=n.dataLevelRange,o=this._desiredMinLevelDelta,l=this._progressiveLevelModulo+o,c=this._scaleRangeEnabled?FE:()=>!0;let u=this.tile;const d=u.level;let h;const p=this._tileLayerInfo.upsampleInfo,m=T(p)?p.tile.level:-1,g=!!T(p)&&m-d>=o,_=ms(r,"tilemapCache");for(;u&&c(u,r,!1)&&u.level>=s;){const b=u.level,x=d-b,w=u.layerInfo[t][e];if(w.data&&x>=o){(!g||b>m)&&this._setUpsampleTile(u),w.dataInvalidated&&(h=u);break}if((B(_)||_.getAvailability(u.lij[0],u.lij[1],u.lij[2])!=="unavailable")&&b<=a&&!w.data&&!w.dataMissing&&((B(h)||u.level===s||b%vhe==0||d-h.level<o)&&(h=u),x>=l))break;u=u.parent}return T(h)&&d-h.level<o&&this._tileLayerInfo.upsampleInfo&&(h=null),h}_findAncestorWithData(){const e=this.tile.vlevel,t=this._desiredMinLevelDelta;let n;for(let r=this.tile;r;r=r.parent)if(r.hasLayerData(this._layerIdx,this._layerClass)){if(e-r.level>=t)return r;n=r}return n}_setUpsampleTile(e){this._tileLayerInfo.setUpsampleInfo(this.tile,e),this.tile.updateRenderData(this._layerClass,ha.FADING)}get test(){return{findNextDownload:()=>this._findNextDownload(),tileLayerInfo:this._tileLayerInfo}}},Dvt=class extends nH{get _desiredMinLevelDelta(){throw FJ}get _progressiveLevelModulo(){throw FJ}dispose(){}};const FJ=new Error("Abstract method called on TileAgent"),cc=new Dvt;let ome=class extends nH{constructor(){super(...arguments),this._scaleRangeEnabled=!1}get _desiredMinLevelDelta(){return JR(this.tile.level)-(this.tile.vlevel-this.tile.level)}get _progressiveLevelModulo(){return 0}},lme=class extends nH{constructor(){super(),this._scaleRangeEnabled=!0}get _desiredMinLevelDelta(){return 0}get _progressiveLevelModulo(){return vhe}};var j0,fb;(function(i){i[i.Stretch=0]="Stretch",i[i.Lut=1]="Lut",i[i.Hillshade=2]="Hillshade",i[i.COUNT=3]="COUNT"})(j0||(j0={})),function(i){i[i.Noop=0]="Noop",i[i.PerBand=1]="PerBand",i[i.COUNT=2]="COUNT"}(fb||(fb={}));function kvt(i,e){i.fragment.uniforms.add([new sn("u_colormap",t=>t.u_colormap),new Hi("u_colormapOffset",t=>t.colormap.u_colormapOffset),new Hi("u_colormapMaxIndex",t=>t.colormap.u_colormapMaxIndex),new Hi("u_opacity",t=>t.common.u_opacity)]),i.fragment.code.add(ee`
    vec4 colormap(vec4 currentPixel, bool isFloat) {
      float colorIndex = isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;
      vec4 result;
      // handle no data and out of range pixels
      if (currentPixel.a == 0.0 || colorIndex > u_colormapMaxIndex) {
        result = vec4(0.0, 0.0, 0.0, 0.0);
      } else {
        // colormap lookup
        vec2 texelCoordinates = vec2((colorIndex + 0.5), 0.5);
        result = ${Eu(e,"u_colormap","texelCoordinates","(1.0 / vec2(u_colormapMaxIndex + 1.0, 1.0))")};
      }
      return result;
    }
  `)}function Fvt(i,e){i.fragment.uniforms.add(Tne("u_transformGrid",t=>t.u_transformGrid,e.hasWebGL2Context?Ou.None:Ou.InvSize)),i.fragment.uniforms.add(new hl("u_transformSpacing",t=>t.common.u_transformSpacing)),i.fragment.uniforms.add(new hl("u_targetImageSize",t=>t.common.u_targetImageSize)),i.fragment.code.add(ee`
    vec2 projectPixelLocation(vec2 coords) {
      // Pixel index in row/column, corresponds to upperleft corner, e.g. [100, 20]
      vec2 index_image = floor(coords * u_targetImageSize);

      // Pixel's corresponding cell index in transform grid
      // Each transform cell corresponds to 4 pixels: 6 coefficients from lowerleft triangle followed by 6 coefficients from upperright triangle
      vec2 oneTransformPixel = vec2(4.0, 1.0);
      vec2 index_transform = floor(index_image / u_transformSpacing) * oneTransformPixel;

      // Correspoding position in transform grid cell, cell center coordinates
      vec2 pos = fract((index_image + 0.5) / u_transformSpacing);

      // Pixel's corresponding transform cell location, cell center coordinates
      vec2 transform_location = index_transform + 0.5;

      vec2 srcLocation;

      // Use lower triangle or upper triangle
      if (pos.s <= pos.t) {
        vec3 ll_abc = ${Eu(e,"u_transformGrid","transform_location")}.rgb;
        vec3 ll_def = ${Eu(e,"u_transformGrid","vec2(transform_location.s + 1.0, transform_location.t)")}.rgb;
        srcLocation.s = dot(ll_abc, vec3(pos, 1.0));
        srcLocation.t = dot(ll_def, vec3(pos, 1.0));
      } else {
        vec3 ur_abc = ${Eu(e,"u_transformGrid","vec2(transform_location.s + 2.0, transform_location.t)")}.rgb;
        vec3 ur_def = ${Eu(e,"u_transformGrid","vec2(transform_location.s + 3.0, transform_location.t)")}.rgb;
        srcLocation.s = dot(ur_abc, vec3(pos, 1.0));
        srcLocation.t = dot(ur_def, vec3(pos, 1.0));
      }

      return srcLocation;
    }
  `)}let cme=class extends Es{constructor(){super(...arguments),this.scale=1,this.offset=Z0}};function ume(i){i.attributes.add(j.POSITION,"vec2"),i.attributes.add(j.UV0,"vec2"),i.vertex.uniforms.add(new Hi("scale",e=>e.scale)),i.vertex.uniforms.add(new hl("offset",e=>e.offset)),i.varyings.add("uv","vec2"),i.varyings.add("vuv","vec2"),i.vertex.code.add(ee`void main(void) {
gl_Position = vec4(position, 0.0, 1.0);
uv = uv0 * scale + offset;
vuv = uv0;
}`)}let Nvt=class extends cme{constructor(e,t,n){super(),this.common=e,this.u_image=t,this.u_transformGrid=n}};function Vvt(i,e){i.include(Fvt,e),i.fragment.uniforms.add([new sn("u_image",t=>t.u_image),new f2("u_flipY",t=>t.common.u_flipY),new f2("u_applyTransform",t=>t.common.u_applyTransform)]),i.fragment.code.add(ee`vec2 getPixelLocation(vec2 coords) {
vec2 targetLocation = u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;
if (!u_applyTransform) {
return targetLocation;
}
return projectPixelLocation(targetLocation);
}
bool isOutside(vec2 coords){
if (coords.t>1.00001 ||coords.t<-0.00001 || coords.s>1.00001 ||coords.s<-0.00001) {
return true;
} else {
return false;
}
}
vec4 getPixel(vec2 pixelLocation) {
return texture2D(u_image, pixelLocation);
}`)}var Ct;(function(i){i[i.Normal=0]="Normal",i[i.Average=1]="Average",i[i.Lighten=2]="Lighten",i[i.Lighter=3]="Lighter",i[i.Plus=4]="Plus",i[i.Screen=5]="Screen",i[i.ColorDodge=6]="ColorDodge",i[i.Darken=7]="Darken",i[i.Multiply=8]="Multiply",i[i.ColorBurn=9]="ColorBurn",i[i.Overlay=10]="Overlay",i[i.SoftLight=11]="SoftLight",i[i.HardLight=12]="HardLight",i[i.VividLight=13]="VividLight",i[i.Hue=14]="Hue",i[i.Saturation=15]="Saturation",i[i.Luminosity=16]="Luminosity",i[i.Color=17]="Color",i[i.DestinationOver=18]="DestinationOver",i[i.DestinationAtop=19]="DestinationAtop",i[i.DestinationIn=20]="DestinationIn",i[i.DestinationOut=21]="DestinationOut",i[i.SourceAtop=22]="SourceAtop",i[i.SourceIn=23]="SourceIn",i[i.SourceOut=24]="SourceOut",i[i.Xor=25]="Xor",i[i.Difference=26]="Difference",i[i.Exclusion=27]="Exclusion",i[i.Minus=28]="Minus",i[i.Invert=29]="Invert",i[i.Reflect=30]="Reflect",i[i.COUNT=31]="COUNT"})(Ct||(Ct={}));const u8={normal:Ct.Normal,average:Ct.Average,lighten:Ct.Lighten,lighter:Ct.Lighter,screen:Ct.Screen,plus:Ct.Plus,"color-dodge":Ct.ColorDodge,darken:Ct.Darken,multiply:Ct.Multiply,"color-burn":Ct.ColorBurn,overlay:Ct.Overlay,"soft-light":Ct.SoftLight,"hard-light":Ct.HardLight,"vivid-light":Ct.VividLight,hue:Ct.Hue,saturation:Ct.Saturation,luminosity:Ct.Luminosity,color:Ct.Color,difference:Ct.Difference,exclusion:Ct.Exclusion,minus:Ct.Minus,invert:Ct.Invert,reflect:Ct.Reflect,"destination-over":Ct.DestinationOver,"destination-atop":Ct.DestinationAtop,"destination-in":Ct.DestinationIn,"destination-out":Ct.DestinationOut,"source-atop":Ct.SourceAtop,"source-in":Ct.SourceIn,"source-out":Ct.SourceOut,xor:Ct.Xor};function Bvt(i){return i===Ct.DestinationOver||i===Ct.DestinationAtop||i===Ct.DestinationIn||i===Ct.DestinationOut||i===Ct.SourceAtop||i===Ct.SourceIn||i===Ct.SourceOut||i===Ct.Xor}function rH(i){i.code.add(ee`
    float lineFactorAtPosition(float value) {
      float pos = value * ${ee.float(257)};
      if(pos < 0.5 || pos > ${ee.float(257-.5)}) {
        return 1.0;
      }

      pos = pos + 0.5;
      float modulo = mod(pos, 16.0);
      return modulo <= 2.0 ?  1.0 - abs(modulo - 1.0) : 0.0;
    }

    float lineFactorAtUV(vec2 uv) {
      return max(lineFactorAtPosition(uv.x), lineFactorAtPosition(uv.y));
    }

    float lineFactor(vec2 uv) {
      vec2 offset = fwidth(uv) * 0.25;
      return (lineFactorAtUV(vec2(uv.x + offset.x, uv.y + offset.y)) +
              lineFactorAtUV(vec2(uv.x - offset.x, uv.y + offset.y)) +
              lineFactorAtUV(vec2(uv.x + offset.x, uv.y - offset.y)) +
              lineFactorAtUV(vec2(uv.x - offset.x, uv.y - offset.y))) / 4.0;
    }

    vec4 gridColor(vec2 uv) {
      float line = lineFactor(uv) * 0.1 + 0.9;
      return vec4(vec3(1.0, 0.972, 0.918) * line, 1.0);
    }`)}function zvt(i,e){const t=e.blendMode;t!==Ct.Normal&&(t===Ct.Reflect&&i.code.add(ee`float reflectBlend(in float cb, in float cl) {
return (cl == 1.0) ? cl : min(cb * cb / (1.0 - cl), 1.0);
}`),t!==Ct.ColorDodge&&t!==Ct.VividLight||i.code.add(ee`float colorDodge(in float cb, in float cl) {
return (cb == 0.0) ? 0.0 : (cl == 1.0) ? 1.0 : min(1.0, cb / (1.0 - cl));
}`),t!==Ct.ColorBurn&&t!==Ct.VividLight||i.code.add(ee`float colorBurn(in float cb, in float cl) {
return (cb == 1.0) ? 1.0 : (cl == 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - cb) / cl);
}`),t===Ct.Overlay&&i.code.add(ee`float overlay(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * (1.0 - 2.0 * (1.0 - cl ) * (1.0 - cb)) + step(0.5, cl) * (2.0 * cl * cb);
}`),t===Ct.HardLight&&i.code.add(ee`float hardLight(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * (2.0 * cl * cb) + step(0.5, cl) * (1.0 - 2.0 * (1.0 - cl) * (1.0 - cb));
}`),t===Ct.SoftLight&&i.code.add(ee`float softLight(in float cb, in float cl) {
if (cl <= 0.5) {
return cb - (1.0 - 2.0 * cl) * cb * (1.0 - cb);
}
if (cb <= 0.25) {
return cb + (2.0 * cl - 1.0) * cb * ((16.0 * cb - 12.0) * cb + 3.0);
}
return cb + (2.0 * cl - 1.0) * (sqrt(cb) - cb);
}`),t===Ct.VividLight&&i.code.add(ee`float vividLight(in float cb, in float cl) {
return (1.0 - step(0.5, cl)) * colorBurn(cb, 2.0 * cl) + step(0.5, cl) * colorDodge(cb, (2.0 * (cl - 0.5)));
}`),t!==Ct.Hue&&t!==Ct.Saturation&&t!==Ct.Color&&t!==Ct.Luminosity||(i.code.add(ee`float minv3(in vec3 c) {
return min(min(c.r, c.g), c.b);
}
float maxv3(in vec3 c) {
return max(max(c.r, c.g), c.b);
}
float lumv3(in vec3 c) {
return dot(c, vec3(0.3, 0.59, 0.11));
}
vec3 clipColor(vec3 color) {
float lum = lumv3(color);
float mincol = minv3(color);
float maxcol = maxv3(color);
if (mincol < 0.0) {
color = lum + ((color - lum) * lum) / (lum - mincol);
}
if (maxcol > 1.0) {
color = lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);
}
return color;
}
vec3 setLum(vec3 cbase, vec3 clum) {
return clipColor(cbase + vec3(lumv3(clum) - lumv3(cbase)));
}`),t!==Ct.Hue&&t!==Ct.Saturation||i.code.add(ee`float satv3(vec3 c) {
return maxv3(c) - minv3(c);
}
vec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)
{
float minbase = minv3(cbase);
float sbase = satv3(cbase);
float ssat = satv3(csat);
return setLum(sbase > 0.0 ? (cbase - minbase) * ssat / sbase : vec3(0.0), clum);
}`)),i.code.add(ee`
    vec4 applyBlendMode(vec3 cl, float ol, vec3 cb, float ob) {
      ${t===Ct.Multiply?ee`return vec4(cl * ol * cb * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Average?ee`return vec4((cb + cl) * 0.5 * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Lighten?ee`return vec4(max(cb, cl) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Darken?ee`return vec4(min(cl, cb) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Lighter?ee`return vec4(cl * ol + cb * ob, ol + ob);`:t===Ct.Plus?ee`return clamp(vec4(cl.rgb + cb.rgb, ol + ob), 0.0, 1.0);`:t===Ct.Minus?ee`return vec4(clamp(vec3(cb.rgb - cl.rgb), 0.0, 1.0), ob * ol);`:t===Ct.Screen?ee`return vec4((cl + cb - cl * cb) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Difference?ee`return vec4(abs(cb - cl) * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Invert?ee`return vec4((1.0 - cb) * ol * ob + cb * ob * (1.0 - ol), ob);`:t===Ct.DestinationOver?ee`return vec4(cl * ol * (1.0 - ob) + cb * ob, ol + ob - ol * ob);`:t===Ct.DestinationAtop?ee`return vec4(cl * ol * (1.0 - ob) + cb * ob * ol, ol);`:t===Ct.DestinationOut?ee`return vec4(cb * ob * (1.0 - ol), ob * (1.0 - ol));`:t===Ct.SourceAtop?ee`return vec4(cl * ol * ob + cb * ob * (1.0 - ol), ob);`:t===Ct.SourceOut?ee`return vec4(cl * ol * (1.0 - ob), ol * (1.0 - ob));`:t===Ct.Xor?ee`return vec4(cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), ol * (1.0 - ob) + ob * (1.0 - ol));`:t===Ct.DestinationIn?ee`return vec4(cb * ob * ol, ol * ob);`:t===Ct.SourceIn?ee`return vec4(cl * ol * ob, ol * ob);`:t===Ct.Hue?ee`
          vec3 f = setLumSat(cl, cb, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Saturation?ee`
          vec3 f = setLumSat(cb, cl, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Color?ee`
          vec3 f = setLum(cl, cb);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Luminosity?ee`
          vec3 f = setLum(cb, cl);
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Exclusion?ee`
          vec3 f = cl + cb - 2.0 * cl * cb;
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Reflect?ee`
          vec3 f = vec3(reflectBlend(cb.r, cl.r), reflectBlend(cb.g, cl.g), reflectBlend(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.ColorDodge?ee`
          vec3 f = vec3(colorDodge(cb.r, cl.r), colorDodge(cb.g, cl.g), colorDodge(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.ColorBurn?ee`
          vec3 f = vec3(colorBurn(cb.r, cl.r), colorBurn(cb.g, cl.g), colorBurn(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.Overlay?ee`
          vec3 f = vec3(overlay(cb.r, cl.r), overlay(cb.g, cl.g), overlay(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.SoftLight?ee`
          vec3 f = vec3(softLight(cb.r, cl.r), softLight(cb.g, cl.g), softLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.HardLight?ee`
          vec3 f = vec3(hardLight(cb.r, cl.r), hardLight(cb.g, cl.g), hardLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:t===Ct.VividLight?ee`
          vec3 f = vec3(vividLight(cb.r, cl.r), vividLight(cb.g, cl.g), vividLight(cb.b, cl.b));
          return vec4(f * ol * ob + cl * ol * (1.0 - ob) + cb * ob * (1.0 - ol), mix(ob, 1.0, ol));`:ee``}
    }
  `))}var Hs,yh,ih;(function(i){i[i.Composite=0]="Composite",i[i.ColorComposite=1]="ColorComposite",i[i.GridComposite=2]="GridComposite",i[i.GroupBackgroundComposite=3]="GroupBackgroundComposite",i[i.COUNT=4]="COUNT"})(Hs||(Hs={})),function(i){i[i.NotRequired=0]="NotRequired",i[i.Required=1]="Required",i[i.COUNT=2]="COUNT"}(yh||(yh={})),function(i){i[i.Off=0]="Off",i[i.On=1]="On",i[i.COUNT=2]="COUNT"}(ih||(ih={}));function dme(i,e){const t=e.output===Hs.GridComposite,n=e.output===Hs.ColorComposite,r=e.output===Hs.GroupBackgroundComposite,s=e.output===Hs.Composite;t&&(i.extensions.add("GL_OES_standard_derivatives"),i.fragment.include(rH)),n&&i.fragment.uniforms.add(new Io("backgroundColor",c=>c.backgroundColor));const a=e.baseOpacityMode===yh.Required;if(a&&i.fragment.uniforms.add(new Hi("baseOpacity",c=>c.baseOpacity)),s){const c=e.hasWebGL2Context?Ou.None:Ou.InvSize;i.fragment.uniforms.add(Tne("fboColor",u=>u.fboTexture,c))}const o=e.blendMode!==Ct.Normal,l=e.premultipliedSource===ih.On;i.fragment.include(zvt,e),i.fragment.code.add(ee`
    vec4 getBackground(vec2 uv) {
      return ${a?ee`baseOpacity *`:""} ${r?ee`vec4(0.0, 0.0, 0.0, 0.0)`:n?ee`vec4(backgroundColor, 1.0)`:t?ee`gridColor(uv)`:ee`${Eu(e,"fboColor","gl_FragCoord.xy")}`};
    }

    vec4 blendLayers(vec4 bgColor, vec4 colorLayer, float opacity) {
      ${o?ee`
          vec3 Cb = bgColor.a == 0.0 ? bgColor.rgb : vec3(bgColor.rgb * bgColor.a);
          return applyBlendMode(colorLayer.rgb, colorLayer.a * opacity, Cb, bgColor.a);`:ee`
          vec4 pmColorLayer = vec4(colorLayer.xyz, 1.0);
          float composeAlpha = colorLayer.a * opacity;
          return ${l?ee`bgColor * (1.0 - composeAlpha) + colorLayer * opacity;`:s&&!a||r?ee`pmColorLayer * composeAlpha;`:ee`mix(bgColor, pmColorLayer, composeAlpha);`}`}
    }`)}let AD=class extends Nvt{constructor(e,t,n,r,s,a){super(e,r,s),this.colormap=t,this.symbolizer=n,this.u_colormap=a,this.backgroundColor=wd,this.fboTexture=null,this.baseOpacity=1}},Uvt=class extends AD{},Hvt=class extends AD{};function Gvt(i){const e=new Nr;return e.include(ume),e.include(Vvt,i),e.include(kvt,i),e.include(dme,i),e.fragment.code.add(ee`vec4 applyBackgroundBlend(vec4 layerColor) {
vec4 bgColor = getBackground(vuv);
return blendLayers(bgColor, layerColor, u_opacity);
}`),i.colorizerType===j0.Stretch?jvt(e,i):i.colorizerType===j0.Lut?Wvt(e):i.colorizerType===j0.Hillshade&&qvt(e,i),e}function Wvt(i){i.fragment.code.add(ee`void main() {
vec2 pixelLocation = getPixelLocation(uv);
if (isOutside(pixelLocation)) {
gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
return;
}
vec4 currentPixel = getPixel(pixelLocation);
gl_FragColor = applyBackgroundBlend(colormap(currentPixel, true));
}`)}function jvt(i,e){i.fragment.uniforms.add([new BB("u_bandCount",n=>n.symbolizer.u_bandCount),new xm("u_minCutOff",n=>n.symbolizer.u_minCutOff,3),new xm("u_maxCutOff",n=>n.symbolizer.u_maxCutOff,3),new xm("u_factor",n=>n.symbolizer.u_factor,3),new Hi("u_minOutput",n=>n.symbolizer.u_minOutput),new Hi("u_maxOutput",n=>n.symbolizer.u_maxOutput),new f2("u_useGamma",n=>n.symbolizer.u_useGamma),new xm("u_gamma",n=>n.symbolizer.u_gamma,3),new xm("u_gammaCorrection",n=>n.symbolizer.u_gammaCorrection,3),new Hi("u_opacity",n=>n.common.u_opacity)]),i.fragment.code.add(ee`float stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {
if (val >= maxCutOff) {
return maxOutput;
} else if (val <= minCutOff) {
return minOutput;
}
float stretchedVal;
if (useGamma) {
float tempf = 1.0;
float outRange = maxOutput - minOutput;
float relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);
if (gamma > 1.0) {
tempf -= pow(1.0 / outRange, relativeVal * gammaCorrection);
}
stretchedVal = (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;
} else {
stretchedVal = minOutput + (val - minCutOff) * factor;
}
return stretchedVal;
}`);const t=e.applyColormap?ee`gl_FragColor = applyBackgroundBlend(colormap(vec4(grayVal, grayVal, grayVal, currentPixel.a), !u_useGamma));`:ee`gl_FragColor = applyBackgroundBlend(vec4(grayVal, grayVal, grayVal, currentPixel.a));`;i.fragment.code.add(ee`
      void main() {
        vec2 pixelLocation = getPixelLocation(uv);
        if (isOutside(pixelLocation)) {
          gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
          return;
        }

        vec4 currentPixel = getPixel(pixelLocation);
        ${e.stretchType===fb.Noop?ee`
        gl_FragColor = applyBackgroundBlend(currentPixel);`:ee`
        if (currentPixel.a == 0.0) {
          gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
          return;
        }
        if (u_bandCount == 1) {
          float grayVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);
          ${t}
        } else {
          float redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);
          float greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);
          float blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);
          gl_FragColor = applyBackgroundBlend(vec4(redVal, greenVal, blueVal, currentPixel.a));
        }`}
      }`)}function qvt(i,e){const t=i.fragment;t.uniforms.add([new sn("u_image",r=>r.u_image),new BB("u_hillshadeType",r=>r.symbolizer.u_hillshadeType),new xm("u_sinZcosAs",r=>r.symbolizer.u_sinZcosAs,6),new xm("u_sinZsinAs",r=>r.symbolizer.u_sinZsinAs,6),new xm("u_cosZs",r=>r.symbolizer.u_cosZs,6),new xm("u_weights",r=>r.symbolizer.u_weights,6),new hl("u_factor",r=>r.symbolizer.u_factor),new Hi("u_minValue",r=>r.symbolizer.u_minValue),new Hi("u_maxValue",r=>r.symbolizer.u_maxValue),new hl("u_srcImageSize",r=>r.common.u_srcImageSize)]),t.include(Nne),t.code.add(ee`vec4 overlay(float val, float minValue, float maxValue, float hillshade, float alpha) {
val = clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);
vec3 hsv = rgb2hsv(colormap(vec4(val, val, val, 1.0), false).rgb);
hsv.z = hillshade;
return vec4(hsv2rgb(hsv) * alpha, alpha);
}`),t.code.add(ee`float getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){
if (a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0 || a == 0.0 || a == 0.0 || a==0.0) {
return 0.0;
}  else {
return e;
}
}`);const n=e.applyColormap?ee`gl_FragColor = applyBackgroundBlend(overlay(ve.r, u_minValue, u_maxValue, hillshade, alpha));`:ee`hillshade *= alpha;
gl_FragColor = applyBackgroundBlend(vec4(hillshade, hillshade, hillshade, alpha));`;t.code.add(ee`
    void main() {
      vec2 pixelLocation = getPixelLocation(uv);
      if (isOutside(pixelLocation)) {
        gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
        return;
      }

      vec4 currentPixel = getPixel(pixelLocation);
      if (currentPixel.a == 0.0) {
        gl_FragColor = applyBackgroundBlend(vec4(0.0, 0.0, 0.0, 0.0));
        return;
      }

      //mirror edge pixels
      vec2 axy = vec2(-1.0, -1.0);
      vec2 bxy = vec2(0.0, -1.0);
      vec2 cxy = vec2(1.0, -1.0);
      vec2 dxy = vec2(-1.0, 0.0);
      vec2 fxy = vec2(1.0, 0.0);
      vec2 gxy = vec2(-1.0, 1.0);
      vec2 hxy = vec2(0.0, 1.0);
      vec2 ixy = vec2(1.0, 1.0);
      vec2 onePixel = 1.0 / u_srcImageSize;
      if (pixelLocation.s < onePixel.s) {
        axy[0] = 1.0;
        dxy[0] = 1.0;
        gxy[0] = 1.0;
      }
      if (pixelLocation.t < onePixel.t) {
        axy[1] = 1.0;
        bxy[1] = 1.0;
        cxy[1] = 1.0;
      }
      if (pixelLocation.s > 1.0 - onePixel.s) {
        cxy[0] = -1.0;
        fxy[0] = -1.0;
        ixy[0] = -1.0;
      }
      if (pixelLocation.t > 1.0 - onePixel.t) {
        gxy[1] = -1.0;
        hxy[1] = -1.0;
        ixy[1] = -1.0;
      }

      // calculate hillshade
      vec4 va = texture2D(u_image, pixelLocation + onePixel * axy);
      vec4 vb = texture2D(u_image, pixelLocation + onePixel * bxy);
      vec4 vc = texture2D(u_image, pixelLocation + onePixel * cxy);
      vec4 vd = texture2D(u_image, pixelLocation + onePixel * dxy);
      vec4 ve = texture2D(u_image, pixelLocation);
      vec4 vf = texture2D(u_image, pixelLocation + onePixel * fxy);
      vec4 vg = texture2D(u_image, pixelLocation + onePixel * gxy);
      vec4 vh = texture2D(u_image, pixelLocation + onePixel * hxy);
      vec4 vi = texture2D(u_image, pixelLocation + onePixel * ixy);

      // calculate the rate of z change along the x, y, and diagonal direction
      float dzx = (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;
      float dzy = (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;
      float dzd = sqrt(1.0 + dzx * dzx + dzy * dzy);
      float hillshade = 0.0;

      // traditional single light source
      if (u_hillshadeType == 0){
        float cosDelta = u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;
        float z = (u_cosZs[0] + cosDelta) / dzd;
        if (z < 0.0)  z = 0.0;
        hillshade = z;
      } else {
        // multi-directional with 6 light sources
        for (int k = 0; k < 6; k++) {
        float cosDelta = u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;
        float z = (u_cosZs[k] + cosDelta) / dzd;
        if (z < 0.0) z = 0.0;
        hillshade = hillshade + z * u_weights[k];
        if (k == 5) break;
        }
      }

      // set color
      float alpha = getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);
      alpha *= u_opacity;
      ${n}
    }
  `)}const Kvt=Object.freeze(Object.defineProperty({__proto__:null,ColorizerUniforms:AD,ColorizerStretchUniforms:Uvt,ColorizerHillshadeUniforms:Hvt,build:Gvt},Symbol.toStringTag,{value:"Module"})),NJ={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};let Yvt=class{constructor(e,t,n=null,r=null){this.type="raster-tile",this._memoryUsed=null,this._source=null,this._symbolizerParameters=null,this._bandIds=null,this._interpolation=null,this._dirty=!1,this._transformGrid=null,this.isRendereredSource=!1,this.symbolizerRenderer=null,this.rawPixelData=null,this.lij=null,this.opacity=1,this.lij=e,this.source=t,this.width=n||t.width,this.height=r||t.height}get source(){return this._source}set source(e){this._source=e,this._rasterTexture=Ht(this._rasterTexture),this._memoryUsed=null}get symbolizerParameters(){return this.isRendereredSource?{...NJ,maxCutOff:[1,1,1],factor:[1,1,1]}:this._symbolizerParameters||NJ}set symbolizerParameters(e){this._symbolizerParameters=e}get bandIds(){return this._bandIds}set bandIds(e){T(e)&&e.length>0?this._bandIds&&e.every((t,n)=>!!this._bandIds[n]&&t===this._bandIds[n])||(this._bandIds=e,this._dirty=!0):this._bandIds=null}get interpolation(){return this._interpolation||"nearest"}set interpolation(e){if(this._interpolation=e,T(this._rasterTexture)){const t=this._getRasterTextureInterpolation(e);this._rasterTexture.setSamplingMode(t==="bilinear"?fn.LINEAR:fn.NEAREST)}}get transformGrid(){return this._transformGrid}set transformGrid(e){this._transformGrid=e,this._transformGridTexture=Ht(this._transformGridTexture),this._memoryUsed=null}bind(e){return!!(this.source&&this.source.pixels&&this.source.pixels.length>0)&&((B(this._rasterTexture)||this._dirty)&&this._updateRasterTexture(e,this.bandIds),T(this._rasterTexture)&&(this._updateColormapTexture(e),this.transformGrid&&B(this._transformGridTexture)&&(this._transformGridTexture=$we(e,this.transformGrid))),!0)}getUniforms(){const{symbolizerParameters:e,transformGrid:t,width:n,height:r,opacity:s}=this,a=Lwe(t,[n,r],[this.source.width,this.source.height],s),o=Dwe(e.colormap,e.colormapOffset),l=this.symbolizerParameters.type==="stretch"?kwe(this.symbolizerParameters):null,c=this.symbolizerParameters.type==="hillshade"?Fwe(this.symbolizerParameters):null;return new AD(a,o,l||c,this._rasterTexture,this._transformGridTexture,this._colormapTexture)}get memoryUsage(){if(B(this._memoryUsed)){const e=[this._rasterTexture,this._transformGridTexture,this._colormapTexture];this._memoryUsed=e.map(t=>T(t)?t.descriptor.width*t.descriptor.height*4:0).reduce((t,n)=>t+n,0)}return this._memoryUsed}release(){return this._rasterTexture=Ht(this._rasterTexture),this._transformGridTexture=Ht(this._transformGridTexture),this._colormapTexture=Ht(this._colormapTexture),this.source=null,this.transformGrid=null,this.rawPixelData=null,!0}_updateRasterTexture(e,t){const n=this.source?this.source.extractBands(t):null;if(!(n&&n.pixels&&n.pixels.length>0))return void(this._rasterTexture=Ht(this._rasterTexture));const r=B(t)&&B(this.bandIds)||T(t)&&T(this.bandIds)&&t.join("")===this.bandIds.join("");if(T(this._rasterTexture)&&r)return;this._rasterTexture=Ht(this._rasterTexture);const s=this._getRasterTextureInterpolation(this.interpolation);this._rasterTexture=Nwe(e,n,s,this.isRendereredSource||this.hasStretchTypeNone())}hasStretchTypeNone(){return"stretchType"in this.symbolizerParameters&&this.symbolizerParameters.stretchType==="none"&&!this.symbolizerParameters.useGamma&&this.source.pixelType==="u8"}_getRasterTextureInterpolation(e){return this.symbolizerParameters.type==="lut"||e==="nearest"||e==="majority"?"nearest":"bilinear"}_updateColormapTexture(e){const t=this._colormap,n=this.symbolizerParameters.colormap;return n?t?n.length!==t.length||n.some((r,s)=>r!==t[s])?(this._colormapTexture=Ht(this._colormapTexture),this._colormapTexture=yW(e,n),void(this._colormap=n)):void 0:(this._colormapTexture=yW(e,n),void(this._colormap=n)):(this._colormapTexture=Ht(this._colormapTexture),void(this._colormap=null))}},fI=class{constructor(){this.waitingAgents=new pn,this._upsampleInfo=null,this.loadingAgent=null,this.requestPromise=null,this.requestAbort=null,this.pendingUpdates=0}static acquire(e){const t=R4.acquire();return t._init(e),t}release(){this.dispose(),mI.delete(this),R4.release(this)}dispose(){this.loadingAgent=Ht(this.loadingAgent),this.abortRequest(),this._unsetUpsampleInfo(),this.pendingUpdates=0,this._data=Sx(this._data)}static prune(){R4.prune(0)}_init(e){this.waitingAgents.clear(),this._data=Sx(this._data),this.dataMissing=!1,this.dataInvalidated=!1,this._unsetUpsampleInfo(),this.abortRequest(),this.loadingAgent=null,this.pendingUpdates=0,this._pool=e,this.elevationBounds=null}invalidateSourceData(){this.dataInvalidated=!0,this.dataMissing=!1,this._unsetUpsampleInfo()}abortRequest(){this.requestAbort=ll(this.requestAbort),this.requestPromise=null}get upsampleInfo(){return this._upsampleInfo}_unsetUpsampleInfo(){T(this._upsampleInfo)&&(this._upsampleInfo.tile.unrefMapData(),this._pool.release(this._upsampleInfo),this._upsampleInfo=null)}setUpsampleInfo(e,t){if(e===t||B(t))this._unsetUpsampleInfo();else{if(B(this._upsampleInfo))this._upsampleInfo=this._pool.acquire();else{if(this._upsampleInfo.tile===t)return;this._upsampleInfo.tile.unrefMapData()}t.refMapData(),$vt(e,t,this._upsampleInfo)}}get data(){return this._data}set data(e){Sx(this._data),this._data=e}};const R4=new Ic(fI,null,()=>{}),mI=new Map;function Xvt(){mI.size>0&&(console.log(`${mI.size} live TilePerLayerInfo allocations:`),mI.forEach(i=>console.log(i,`
`)))}let vw=class{constructor(e){this._texture=e,this.type="tile-texture",this._refCount=1}retain(){++this._refCount}release(){--this._refCount,this._refCount===0&&this._texture.dispose()}get texture(){return this._texture}generateMipmap(){this._texture.generateMipmap()}get descriptor(){return this._texture.descriptor}};var Qt;(function(i){i[i.NONE=0]="NONE",i[i.NONE_HIT_MAXLOD=1]="NONE_HIT_MAXLOD",i[i.SPLIT=2]="SPLIT",i[i.VSPLITMERGE=4]="VSPLITMERGE",i[i.MERGE=8]="MERGE",i[i.RENDERDATA=16]="RENDERDATA",i[i.GEOMETRY=32]="GEOMETRY",i[i.TEXTURE_NOFADING=64]="TEXTURE_NOFADING",i[i.TEXTURE_FADING=128]="TEXTURE_FADING"})(Qt||(Qt={}));const I4=q(),R1=q(),Ca=q(),Zvt=.1;let Qvt=class{constructor(){this.fovX=0,this.fovY=0,this.relativeWidthLimit=0,this.relativeHeightLimit=0,this.maxLod=0,this.angledSplitBias=0,this.aboveGround=!0}},sH=class{constructor(){this.lij=[0,0,0],this._children=[null,null,null,null],this._pendingUpdates=0,this._dirty=!0,this._previouslyRendered=!1,this.extent=qi(),this._elevationBounds=xt(),this.layerInfo=[[],[]],this.extentInRadians=qi(),this.centerAtSeaLevel=q(),this._center=[q(),gf(),q()],this.up=m0e(),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._maxTesselation=0,this._usedMemory=null,this._mapTileMemoryInternal=0,this._mapDataRefCount=0,this._screenDepth=0,this.renderOrder=0,this._edgeLen=0,this._edgeLen2=0,this._curvatureHeight=0,this.extentMidX=0,this.extentMidY=0}static prune(){aH.prune(0),oH.prune(0),fI.prune()}get _isCached(){return!this.shouldLoad&&this._mapDataRefCount<=0}get maxTesselation(){return this._maxTesselation}get isWithinClippingArea(){return this._isWithinClippingArea}get intersectsClippingArea(){return this._intersectsClippingArea}get clippingArea(){return this._clippingArea}get parent(){return this._parent}get children(){return this._children}get surface(){return this._surface}get elevationBounds(){return this._elevationBounds}get level(){return this.lij[0]}get key(){return`${this.lij[0]}/${this.lij[1]}/${this.lij[2]}`}get edgeLen(){return this._edgeLen}get radius(){return this._center[rl.MIDDLE][3]}get screenDepth(){return this._screenDepth}get visible(){return this._dirty&&this.computeVisibility(),this._visible}get frustumVisibility(){return this._dirty&&this.computeVisibility(),this._frustumVisibility}computeVisibility(){var n;this._dirty=!1;const e=((n=this.parent)==null?void 0:n.frustumVisibility)??Eo.INTERSECTS;this._frustumVisibility=e===Eo.INSIDE?Eo.INSIDE:e===Eo.OUTSIDE?Eo.OUTSIDE:this._calculateFrustumVisibilityStatus(this.surface.frustum);const t=this._frustumVisibility!==Eo.OUTSIDE&&this._intersectsClippingArea;t!==this._visible&&(this._visible=t,this._surface.emit("tiles-visibility-changed"),this._surface.renderer.setDirty(),this.updateAgentSuspension())}get loadable(){return this.visible||this._surface.view.state.fixedContentCamera}get rendered(){const e=!!this.renderData;return e!==this._previouslyRendered&&(this._surface.emit("tiles-visibility-changed"),this._previouslyRendered=e,this._surface.renderer.setDirty()),e}get shouldLoad(){const e=this._surface.snapLevel;if(T(e)){const t=this.level-e;if(t===0)return!0;if(t===1)return!1}return this.isLeaf}init(e,t,n){this.lij[0]=e[0],this.lij[1]=e[1],this.lij[2]=e[2],this.ellipsoid=rn(n.tilingScheme.spatialReference),n.tilingScheme.getExtent(e[0],e[1],e[2],this.extent),n.tilingScheme.convertExtentToRadians(this.extent,this.extentInRadians),this.extentMidX=.5*(this.extent[0]+this.extent[2]),this.extentMidY=.5*(this.extent[1]+this.extent[3]),this._isWithinClippingArea=!0,this._intersectsClippingArea=!0,this._clippingArea=null,this._mapDataRefCount=0,n.upsampleMapCache.pop(this.key),this._edgeLen=0,this._edgeLen2=0,this._center[rl.MIDDLE][3]=0,this.vlevel=e?e[0]:0,t&&t.elevationBounds?Zs(this._elevationBounds,t.elevationBounds):Bi(this._elevationBounds,0,0),this._pendingUpdates=0,this.renderData=null,this._screenDepth=0,this._visible=!1,this._previouslyRendered=!1,this._parent=t,this.unsetChildren(),this._surface=n,this.updateVisibility();for(const r of U_){const s=n.numLayers(r),a=this.layerInfo[r];for(const o of a)o.release();a.length=s;for(let o=0;o<s;o++)a[o]=fI.acquire(this._surface.upsampleInfoPool),r===Li.ELEVATION&&this.findElevationBoundsForLayer(o,-1)}this.computeElevationBounds(),this._maxTesselation=Math.min(n.tilingScheme.pixelSize,bS)}release(){xp(!this.renderData,"tile.renderData was not unloaded"),this._surface.upsampleMapCache.pop(this.key);for(const e of U_){for(const t of this.layerInfo[e])t.release();this.layerInfo[e].length=0}this._parent=null;for(let e=0;e<4;++e)this._children[e]=null;this._surface=null,this.setMemoryDirty()}refMapData(){++this._mapDataRefCount,this._isCached||this._surface.upsampleMapCache.pop(this.key)}unrefMapData(){if(--this._mapDataRefCount,this._isCached){this.setMemoryDirty();const e=this._cachedMemory;e>0&&this._surface.upsampleMapCache.put(this.key,this,e)}}setMemoryDirty(){this._usedMemory=null}get usedMemory(){return this._ensureUsedMemory()+(this._isCached?0:this._mapTileMemoryInternal)}get _cachedMemory(){return this._isCached?this._mapTileMemory:0}get _mapTileMemory(){return this._ensureUsedMemory(),this.layerInfo[Li.MAP].reduce((e,t)=>e+(t instanceof pI?t.memoryUsage:0),this._mapTileMemoryInternal)}get _cpuImageMemorySize(){const t=this._surface.tilingScheme.pixelSize;return t*t*4}_ensureUsedMemory(){if(T(this._usedMemory))return this._usedMemory;this._usedMemory=0,this._mapTileMemoryInternal=0;let e=0;for(const{data:n}of this.layerInfo[Li.MAP])n instanceof pI?e+=this._getTerrainDataMemory(n):this._mapTileMemoryInternal+=this._getTerrainDataMemory(n);const t=this._cpuImageMemorySize;for(const n of this.layerInfo[Li.ELEVATION])this._usedMemory+=n.data?t:0;return this.renderData&&(this._usedMemory+=this.renderData.estimatedGeometryMemoryUsage,this._mapTileMemoryInternal+=YI(this.renderData.textureDescriptor)),this._isCached&&this._surface.upsampleMapCache.updateSize(this.key,this,this._mapTileMemoryInternal+e),this._usedMemory}getUsedMemoryForLayer(e,t){const n=this.layerInfo[e][t];return n!=null&&n.data?e===Li.MAP?this._isCached?0:this._getTerrainDataMemory(n.data):e===Li.ELEVATION?this._cpuImageMemorySize:0:0}_getTerrainDataMemory(e){return e instanceof vw?YI(e.texture):e instanceof HTMLImageElement||e instanceof CD?this._cpuImageMemorySize:e instanceof pI||e instanceof Yvt?e.memoryUsage:0}updateScreenDepth(e){const t=this._center[rl.MIDDLE],n=e,r=t[0],s=t[1],a=t[2],o=n[2]*r+n[6]*s+n[10]*a+n[14];this._screenDepth=o<0?0:o/(n[3]*r+n[7]*s+n[11]*a+n[15])}shouldSplit(e,t,n){if(!this.visible||T(e.frustum)&&(!this._intersectsClippingArea||this._calculateFrustumVisibilityStatus(e.frustum)===Eo.OUTSIDE))return Qt.NONE;const r=this.level;nt(I4,this._center[rl.MIDDLE],t);let s=dd(I4),a=rl.MIDDLE;nt(R1,this._center[rl.TOP],t);const o=dd(R1);o<s&&(s=o,a=rl.TOP),nt(R1,this._center[rl.BOTTOM],t);const l=dd(R1);if(l<s&&(s=l,a=rl.BOTTOM),this._edgeLen2>s&&r<e.maxLod)return Qt.SPLIT;const c=Math.sqrt(s),u=e.fovX*c*2,d=this._edgeLen/u,h=()=>{const _=r+Math.ceil(-Math.log2(e.relativeWidthLimit/d));return _!==this.vlevel?(this.vlevel=_,Qt.VSPLITMERGE):Qt.NONE_HIT_MAXLOD};if(T(n)&&n-r===1)return r>=e.maxLod?h():Qt.SPLIT;const p=dt(this.up,I4),m=this._elevationBounds[1]-this._elevationBounds[0],g=m/this.edgeLen;if(e.aboveGround&&p>0&&g<.001&&p/c-Math.sin(this._curvatureHeight/(this.edgeLen*Math.SQRT1_2)*Math.PI)-g>0)return Qt.NONE;if(d<e.relativeWidthLimit)return this.vlevel!==this.level?(this.vlevel=this.level,Qt.VSPLITMERGE):Qt.NONE;if(r>=e.maxLod)return h();if(r>6){nt(R1,this._center[a],t),Ye(Ca,this.up,p),nt(Ca,Ca,R1);const _=dd(Ca);if(_>this.radius*this.radius){Ye(Ca,Ca,this.radius/Math.sqrt(_)),rt(Ca,Ca,this._center[a]),nt(Ca,t,Ca);const b=Math.min(1,(Math.abs(dt(Ca,this.up))+.5*m+this._curvatureHeight)/Et(Ca)),x=Zvt/e.angledSplitBias,w=e.fovY*c*2;if(b*(this._edgeLen/w)<x*e.relativeHeightLimit)return Qt.NONE}}return Qt.SPLIT}setChildren(e,t,n,r){xp(!!(e&&t&&n&&r),"Null child passed"),this._children[0]=e,this._children[1]=t,this._children[2]=n,this._children[3]=r}unsetChildren(){this._children[0]=null,this._children[1]=null,this._children[2]=null,this._children[3]=null}get isLoaded(){var e;return((e=this.renderData)==null?void 0:e.hasGeometry)??!1}load(){this.refMapData();for(const e of U_)this._createOrUpdateAgents(0,e);this.surface.renderer.loadTile(this)}unload(e){e.unloadTile(this);for(const t of U_){const n=this.layerInfo[t];for(const r of n)r.loadingAgent&&r.loadingAgent!==cc&&(_O(r.loadingAgent),r.loadingAgent=null),r.pendingUpdates=0}this.resetPendingUpdate(Qt.GEOMETRY),this.resetPendingUpdate(Qt.TEXTURE_NOFADING),this.resetPendingUpdate(Qt.TEXTURE_FADING),this.unrefMapData()}unloadMapData(){const e=this.layerInfo[Li.MAP];for(const t of e)t.loadingAgent&&t.loadingAgent!==cc&&(_O(t.loadingAgent),t.loadingAgent=null),t.pendingUpdates=0;this.renderData&&this.renderData.releaseTexture(),this.setMemoryDirty()}updateClippingStatus(e){if($0(e,this._clippingArea))return!1;const t=this._intersectsClippingArea,n=this._isWithinClippingArea;T(e)?(this._intersectsClippingArea=this.intersectsExtent(e),this._isWithinClippingArea=this._isWithinExtent(e)):(this._intersectsClippingArea=!0,this._isWithinClippingArea=!0),this._clippingArea=e,this.updateVisibility();const r=n&&this._isWithinClippingArea,s=!(n||t||this._isWithinClippingArea||this._intersectsClippingArea);return!this.renderData||r||s||this.setPendingUpdate(Qt.GEOMETRY),!0}updateVisibility(){this._dirty=!0,this._surface.setTileTreeDirty()}getLayerInfo(e,t){return this.layerInfo[t][e]}hasLayerData(e,t){const n=this.layerInfo[t][e];return!(!n||!n.data||n.dataInvalidated)}get updating(){if(this.hasPendingUpdates)return!0;for(const e of U_){const t=this.layerInfo[e];for(const n of t)if(n.loadingAgent&&n.loadingAgent!==cc&&n.loadingAgent.updating)return!0}return!1}_isSuspended(e){return!!this.hasPendingUpdate(Qt.SPLIT)||e!==Li.ELEVATION&&!this.loadable}get hasPendingUpdates(){return this._pendingUpdates!==0}hasPendingUpdate(e){return(this._pendingUpdates&e)===e}setPendingUpdate(e){this._pendingUpdates|=e,e===Qt.SPLIT||e===Qt.MERGE?this._surface.setTileTreeDirty():this._surface.requestUpdate()}resetPendingUpdate(e){return!!this.hasPendingUpdate(e)&&(this._pendingUpdates&=~e,!0)}requestLayerData(e,t,n){const r=this.layerInfo[t][e];if(r.waitingAgents.has(n))return console.warn("agent already requested this piece of map data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),n.tile.lij.toString(),t,e),!0;if(r.waitingAgents.push(n),r.data&&!r.dataInvalidated)return console.warn("agent requested existing data (tile %s, agent tile %s, layer: %d/%d)",this.lij.toString(),n.tile.lij.toString(),t,e),n.dataArrived(this),!0;if(r.requestPromise)return!0;ll(r.requestAbort),r.requestAbort=new AbortController;const s=this._surface.requestTileData(this,e,t,r.requestAbort);if(!s)return r.requestAbort=null,!1;const a=()=>{r.requestPromise===s&&(r.requestPromise=null,r.requestAbort=null)};return r.requestPromise=s,s.then(a,a),!0}get isLeaf(){return this._children[0]==null}hasLij(e){return this.lij[0]===e[0]&&this.lij[1]===e[1]&&this.lij[2]===e[2]}findByLij(e){return this.hasLij(e)?this:this.isLeaf?null:this._children[0].findByLij(e)||this._children[1].findByLij(e)||this._children[2].findByLij(e)||this._children[3].findByLij(e)||null}distanceToSquared(e){return dd(nt(Ca,this._center[rl.MIDDLE],e))}containsPoint(e){const t=this.extent;return e[0]>=t[0]&&e[1]>=t[1]&&e[0]<=t[2]&&e[1]<=t[3]}containsPointXY(e,t){const n=this.extent;return e>=n[0]&&t>=n[1]&&e<=n[2]&&t<=n[3]}unrequestLayerData(e,t,n){const r=this.layerInfo[t][e],s=r.waitingAgents,a=s.removeUnordered(n)!=null;xp(a,"agent has not requested this piece of map data"),s.length<1&&(r.abortRequest(),this.setMemoryDirty())}dataArrived(e,t,n){const r=this.layerInfo[t][e];r.data=n,r.dataInvalidated=!1,r.waitingAgents.forAll(s=>s.dataArrived(this)),r.waitingAgents.clear(),this.setMemoryDirty()}dataMissing(e,t,n){n.notInTilemap||console.error(`Tile ${this.lij.toString()} layer ${t}/${e} error ${n}`);const r=this.layerInfo[t][e];r.dataMissing=!0,r.waitingAgents.forAll(s=>s.dataMissing()),r.waitingAgents.clear(),this.setMemoryDirty()}updateRenderData(e,t){switch(e){case Li.MAP:return this._updateTexture(t);case Li.ELEVATION:return this._updateGeometry()}}_updateTexture(e){this.renderData&&(this.resetPendingUpdate(e===ha.FADING?Qt.TEXTURE_NOFADING:Qt.TEXTURE_FADING),this.setPendingUpdate(e===ha.FADING?Qt.TEXTURE_FADING:Qt.TEXTURE_NOFADING))}_updateGeometry(){this.setPendingUpdate(Qt.GEOMETRY);for(const e of this.layerInfo[Li.ELEVATION])e.pendingUpdates|=Qt.GEOMETRY}invalidateLayerData(e,t){this.layerInfo[t][e].invalidateSourceData(),this.restartAgents(t)}computeElevationBounds(){const e=this._elevationBounds;Bi(e,1/0,-1/0);const t=this.layerInfo[Li.ELEVATION];let n=!0;for(const r of t)T(r.elevationBounds)&&(e[0]=Math.min(e[0],r.elevationBounds.min),e[1]=Math.max(e[1],r.elevationBounds.max),r.elevationBounds.hasNoDataValues||(n=!1));n&&(e[0]=Math.min(e[0],0),e[1]=Math.max(e[1],0)),this.updateRadiusAndCenter(),this._surface.setTileTreeDirty()}_updateCenter(){const e=this._elevationBounds,t=.5*(e[0]+e[1]);Ye(Ca,this.up,t),rt(this._center[rl.MIDDLE],this.centerAtSeaLevel,Ca),Ye(Ca,this.up,e[0]),rt(this._center[rl.TOP],this.centerAtSeaLevel,Ca),Ye(Ca,this.up,e[1]),rt(this._center[rl.BOTTOM],this.centerAtSeaLevel,Ca)}findElevationBoundsForLayer(e,t){const n=this.layerInfo[Li.ELEVATION][e];if(T(n.elevationBounds)&&n.elevationBounds.level>=t)return;const r=this._surface.layerViewByIndex(e,Li.ELEVATION),s=r8(r);if(!FE(this,s,!1))return;const a=eyt;let o=!1;if(n.data){const l=n.data;a.min=l.bounds[0],a.max=l.bounds[1],a.hasNoDataValues=l.hasNoDataValues,a.level=this.level,o=!0}else{let l,c,u=0;for(let d=this._parent;d&&(!c||u<JR(this.level))&&(u=this.vlevel-d.level,l=c||l,c=d.layerInfo[Li.ELEVATION][e].data,!(!c&&l&&u>=JR(this.level)));d=d.parent);c=c||l,c&&(c.computeMinMaxValue(this.lij[0],this.lij[1],this.lij[2],a),a.min!==1/0&&(a.level=c.level,o=!0))}o&&(B(n.elevationBounds)&&(n.elevationBounds=new Zw),n.elevationBounds.copyFrom(a))}modifyLayers(e,t,n){const r=this.layerInfo[n];for(const o of r)o.loadingAgent&&o.loadingAgent!==cc&&(_O(o.loadingAgent),o.loadingAgent=null),o.waitingAgents.clear();for(let o=0;o<r.length;++o)e[o]===void 0&&r[o].release();const s=new Array(...r),a=t.length;r.length=a;for(let o=0;o<a;o++){const l=t[o];r[o]=l>-1?s[l]:fI.acquire(this._surface.upsampleInfoPool)}this.setMemoryDirty()}restartAgents(e){this.renderData&&(this._createOrUpdateAgents(0,e),this.updateRenderData(e,ha.FADING))}updateAgents(e){if(this.renderData){const t=this.layerInfo[e];for(const n of t)n.loadingAgent===cc&&(n.loadingAgent=null);this._createOrUpdateAgents(0,e)}}updateAgentSuspension(){for(const e of U_){const t=this._isSuspended(e);for(const n of this.layerInfo[e])n.loadingAgent&&n.loadingAgent!==cc&&(n.loadingAgent.setSuspension(t),n.loadingAgent===cc&&this.updateRenderData(e,ha.FADING))}}removeLayerAgent(e,t){const n=this.layerInfo[t][e];n.loadingAgent&&n.loadingAgent!==cc&&n.loadingAgent.dispose(),n.loadingAgent=null}agentDone(e,t){const n=this.layerInfo[t][e];n.loadingAgent=cc,!n.data&&B(n.upsampleInfo)&&this._createOrUpdateAgents(e+1,t)}_hasBlendableAncestor(e){return e.blendMode!=="normal"||xC(e.parent)&&this._hasBlendableAncestor(e.parent)}_hasBlendModes(e,t,n){var r,s,a;for(let o=e;o<t;++o){const l=this._surface.layerViewByIndex(o,n);if(pL(l)&&((r=l==null?void 0:l.layer)==null?void 0:r.blendMode)!=="normal"||xC((s=l==null?void 0:l.layer)==null?void 0:s.parent)&&this._hasBlendableAncestor((a=l==null?void 0:l.layer)==null?void 0:a.parent))return!0}return!1}_createOrUpdateAgents(e,t){const n=this.layerInfo[t];if(n.length===0)return;const r=this._isSuspended(t);for(let s=e;s<n.length;++s){const a=n[s];let o=!1;const l=this._surface.layerViewByIndex(s,t),c=r8(l);if(a.loadingAgent?FE(this,c,!1)?(a.loadingAgent!==cc&&a.loadingAgent.setSuspension(r),a.loadingAgent!==cc&&(o=a.loadingAgent.update())):a.dispose():FE(this,c,!1)&&(a.loadingAgent=Jvt(this,s,t,r),o=a.loadingAgent.startLoading(),o?a.loadingAgent===cc&&this.setPendingUpdate(Qt.GEOMETRY):(_O(a.loadingAgent),a.loadingAgent=cc)),a.loadingAgent===cc&&this.updateRenderData(t,ha.FADING),!this._hasBlendModes(e,n.length,t)&&o&&l.isOpaque)return}}_isWithinExtent(e){const t=this.extent;return t[0]>=e[0]&&e[2]>=t[2]&&t[1]>=e[1]&&e[3]>=t[3]}intersectsExtent(e){const t=this.extent;return t[2]>=e[0]&&e[2]>=t[0]&&t[3]>=e[1]&&e[3]>=t[1]}getElevationBasedVerticesPerSide(e){const t=this.vlevel-this.level,n=Math.max(this.level-e,JR(this.level)-t);return lt(1+(this.maxTesselation>>n),2,this.maxTesselation+1)}get test(){return{cachedMemory:this._cachedMemory}}_findLIJ(e,t){if(!e)return null;const n=this.surface.rootTiles;if(T(n)){for(const r of n)if(tyt(r,e)){let s=r,a=e[0]-s.level-1;for(;a>=0&&!s.isLeaf&&!t(s);){const o=e[1]>>a&1,l=e[2]>>a&1;s=s.children[2*o+l],a--}return t(s)?s:null}}return null}findNeighborTile(e,t){const n=this.lij,r=this.getNeighborLIJ(n,e);return r?iyt(n,r)?t(this)?this:null:this._findLIJ(r,t):null}findCorner(e,t){const n=e===ei.NORTH_EAST?1:e===ei.NORTH_WEST?0:e===ei.SOUTH_WEST?2:3;let r=this;for(;!(r.isLeaf||t&&t(r));)r=r.children[n];return r}findNeighborCornerTileExact(e,t){var n;return(n=this.findNeighborTile(e,r=>t(r)||r.level===this.level))==null?void 0:n.findCorner(o8(e),t)}forAllSubtreeOnSide(e,t){const n=e===ei.NORTH?[0,1]:e===ei.NORTH_EAST?[1]:e===ei.EAST?[1,3]:e===ei.SOUTH_EAST?[3]:e===ei.SOUTH?[2,3]:e===ei.SOUTH_WEST?[2]:e===ei.WEST?[0,2]:[0],r=s=>{t(s)||s.isLeaf||n.forEach(a=>r(s.children[a]))};r(this)}forallNeighbors(e){mL.forEach(t=>this.findNeighborCornerTileExact(t,e)),zp.forEach(t=>{var n;return(n=this.findNeighborTile(t,r=>r.level===this.level||e(r)))==null?void 0:n.forAllSubtreeOnSide(fL(t),e)})}getNeighborEdgeStartVertexIndex(e,t){if(!t)return 0;const n=this.level-t.level;if(yt(!fa||n>=0),n===0)return 0;const r=2**n,s=(1&e)==1,a=s?0:1,o=t.lij[a+1]*r,l=this.lij[a+1],c=l-o,u=s?r-1-c:c;return fa&&(yt(o<=l&&l<o+r),yt(0<=u&&u<r)),u}forEachLoadedNeighbor(e){const t=this.level,n=r=>r.level===t||r.isLoaded;zp.forEach(r=>{const s=this.findNeighborTile(r,n);s!=null&&s!==this&&s.forAllSubtreeOnSide(fL(r),a=>!!a.isLoaded&&(e(a,r),!0))}),mL.forEach(r=>{var a;const s=(a=this.findNeighborTile(r,n))==null?void 0:a.findCorner(o8(r),o=>o.isLoaded);yt(!s||d8(this,s,r)),s!=null&&s.isLoaded&&e(s,r)})}getNeighborLIJ(e,t){const n=PJ(t)?-1:MJ(t)?1:0,r=EJ(t)?-1:AJ(t)?1:0,s=[e[0],e[1]+n,e[2]+r];return s[1]<0?null:this.surface.isGlobal?this.wrapLIJ(s):s[2]<0?null:s}wrapLIJ(e){return!e||e[1]<0||e[1]>=2**e[0]?null:this.surface.wrapEastWest(e)}get westNeighborWestExtent(){return this.extent[0]*(this.isWestEnd?-1:1)}get eastNeighborEastExtent(){return this.extent[2]*(this.isEastEnd?-1:1)}get isEastEnd(){return this.lij[2]===this.surface.lijEastEnd(this.level)-1}get isWestEnd(){return this.lij[2]===0}get isNorthEnd(){return this.lij[1]===0}get isSouthEnd(){return this.extent[1]+CB()>=this.surface.extent[1]}compareLIJs(e){const t=this.lij,n=t[0],r=e[0];if(n===r)return[t,e];const s=n-r;if(s<0){const a=2**-s;return[[r,t[1]*a,t[2]*a],e]}{const a=2**s;return[t,[n,e[1]*a,e[2]*a]]}}checkGeometryWaterproofness(){dL&&(yt(this.isLoaded),this.renderData.checkGeometryWaterproofness())}shouldHaveNeighbor(e){const t=this.extent,n=this.surface.rootTilesExtent,r=.25*(t[2]-t[0]);if(PJ(e)&&t[3]+r>=n[3]||MJ(e)&&t[1]-r<=n[1])return!1;const s=this.surface.isGlobal;return!(!s&&EJ(e)&&t[0]-r<=n[0])&&!(!s&&AJ(e)&&t[2]+r>=n[2])}};function Jvt(i,e,t,n){const r=t===Li.ELEVATION?oH.acquire():aH.acquire();return r.init(i,e,t,n),r}function _O(i){i.dispose(),i instanceof ome?oH.release(i):i instanceof lme&&aH.release(i)}const aH=new Ic(lme),oH=new Ic(ome),eyt=new Zw;var rl;function tyt(i,e){const t=i.level,n=e[0];if(t>n)return!1;const r=n-t,s=Math.floor(e[1]/2**r),a=Math.floor(e[2]/2**r);return s===i.lij[1]&&a===i.lij[2]}function iyt(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}function bm(i,e,t){return Math.abs(i-e)<=t}function nyt(i,e,t){if(B(i)||B(e))return!1;if(i.level===0&&e.level===0&&(i.isEastEnd&&e.isWestEnd&&t===ei.EAST||i.isWestEnd&&e.isEastEnd&&t===ei.WEST))return!0;const n=Math.max(1e-6*(i.extent[2]-i.extent[0]),1);switch(t){case ei.NORTH:return bm(i.extent[3],e.extent[1],n);case ei.SOUTH:return bm(i.extent[1],e.extent[3],n);case ei.EAST:return bm(i.extent[2],e.extent[0],n)||bm(i.extent[2],-e.extent[0],n);case ei.WEST:return bm(i.extent[0],e.extent[2],n)||bm(i.extent[0],-e.extent[2],n)}}function d8(i,e,t){return!B(i)&&!B(e)&&e!==i&&(i.level>=e.level?VJ(i,e,t):VJ(e,i,o8(t)))}function VJ(i,e,t){yt(i.level>=e.level);const n=Dgt(t),r=kgt(t),s=i.extent,a=e.extent,o=[n?s[0]:s[2],r?s[3]:s[1]],l=[n?a[2]:a[0],r?a[1]:a[3]],c=1e-5*(s[2]-s[0]),u=bm(o[0],l[0],c)||i.surface.isGlobal&&bm(o[0],-l[0],c),d=bm(o[1],l[1],c);if(u&&d)return!0;if(i.level===e.level||!u&&!d)return yt(!1),!1;const h=u?BJ(a[1],a[3],s[1],s[3],c):BJ(a[0],a[2],s[0],s[2],c);return yt(h),h}function BJ(i,e,t,n,r=CB()){return i-r<=t&&t<=n&&n<=e+r}(function(i){i[i.TOP=0]="TOP",i[i.MIDDLE=1]="MIDDLE",i[i.BOTTOM=2]="BOTTOM"})(rl||(rl={}));let ryt=class{constructor(){this._scales=Xn(-1,-1,-1,-1),this._offsets=Xn(-1,-1,-1,-1)}clear(){this._scales[0]=this._scales[1]=this._scales[2]=this._scales[3]=-1,this._offsets[0]=this._offsets[1]=this._offsets[2]=this._offsets[3]=-1}setScale(e,t,n){this._scales[2*e]=t,this._scales[2*e+1]=n}setOffset(e,t,n){this._offsets[2*e]=t,this._offsets[2*e+1]=n}get scales(){return this._scales}get offsets(){return this._offsets}};function syt(i,e){i.varyings.add("tbnTangent","vec3"),i.varyings.add("tbnBiTangent","vec3"),e.spherical?i.vertex.code.add(ee`void forwardVertexTangent(vec3 n) {
tbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), n));
tbnBiTangent = normalize(cross(n, tbnTangent));
}`):i.vertex.code.add(ee`void forwardVertexTangent(vec3 n) {
tbnTangent = vec3(1.0, 0.0, 0.0);
tbnBiTangent = normalize(cross(n, tbnTangent));
}`),i.fragment.code.add(ee`mat3 getTBNMatrix(vec3 n) {
return mat3(tbnTangent, tbnBiTangent, n);
}`)}let lH=class extends hwe{constructor(){super(...arguments),this.slicePlaneLocalOrigin=q(),this.origin=this.slicePlaneLocalOrigin}};var Cu,us;(function(i){i[i.Material=0]="Material",i[i.ShadowMap=1]="ShadowMap",i[i.Highlight=2]="Highlight"})(Cu||(Cu={})),function(i){i[i.Color=0]="Color",i[i.Alpha=1]="Alpha",i[i.Depth=2]="Depth",i[i.Normal=3]="Normal",i[i.ObjectAndLayerIdColor=4]="ObjectAndLayerIdColor"}(us||(us={}));let ayt=class extends lH{constructor(){super(...arguments),this.identifier=Cu.Material,this.transparent=!1,this.integratedMesh=!1}},oyt=class extends lH{constructor(){super(...arguments),this.identifier=Cu.ShadowMap}},lyt=class extends lH{constructor(){super(...arguments),this.identifier=Cu.Highlight}},vL=class extends Cb{constructor(e,t){super(e,"vec4",WB.Draw,(n,r,s)=>n.setUniform4fv(e,t(r,s)))}};var km;function cyt(i,e){const{vertex:t,fragment:n}=i;t.uniforms.add([new vL("overlayTexOffset",(r,s)=>uyt(r,s)),new vL("overlayTexScale",(r,s)=>dyt(r,s))]),n.constants.add("overlayOpacity","float",1),n.uniforms.add(new sn("ovColorTex",(r,s)=>h8(r,s))),hme(i,e)}function hme(i,e){i.extensions.add("GL_OES_standard_derivatives"),e.pbrMode!==Ds.Water&&e.pbrMode!==Ds.WaterOnIntegratedMesh||i.include(dbe,e);const{vertex:t,fragment:n}=i;i.varyings.add("vtcOverlay","vec4"),t.code.add(ee`void setOverlayVTC(in vec2 uv) {
vtcOverlay = vec4(uv, uv) * overlayTexScale + overlayTexOffset;
}`),n.code.add(ee`bool isValid(vec2 uv, vec2 dxdy) {
return (uv.x >= 0.0 + dxdy.x) && (uv.x <= 1.0 - dxdy.x) && (uv.y >= 0.0 + dxdy.y) && (uv.y <= 1.0 - dxdy.y);
}
vec4 getOverlayColor(sampler2D ov0Tex, vec4 texCoords) {
vec4 color0 = texture2D(ov0Tex, vec2(texCoords.x * 0.5, texCoords.y));
vec4 color1 = texture2D(ov0Tex, vec2(texCoords.z * 0.5 + 0.5, texCoords.w));
bool isValid0 = isValid(texCoords.xy, fwidth(texCoords.xy));
bool isValid1 = isValid(texCoords.zw, vec2(0.0, 0.0));
return mix(color1 * float(isValid1), color0, float(isValid0));
}`),n.code.add(ee`vec4 getCombinedOverlayColor() {
return overlayOpacity * getOverlayColor(ovColorTex, vtcOverlay);
}`),e.pbrMode!==Ds.Water&&e.pbrMode!==Ds.WaterOnIntegratedMesh||(XL(n),zB(n),n.code.add(ee`vec4 getOverlayWaterColor(vec4 maskInput, vec4 colorInput, vec3 vposEyeDir,
float shadow, vec3 localUp, mat3 tbn, vec3 position, vec3 positionWorld) {
vec3 n = normalize(tbn *  (2.0 * maskInput.rgb - vec3(1.0)));
vec3 v = vposEyeDir;
vec3 final = getSeaColor(n, v, mainLightDirection, colorInput.rgb, mainLightIntensity, localUp, 1.0 - shadow, maskInput.w, position, positionWorld);
return vec4(final, colorInput.w);
}`))}function h8(i,e){return e.overlays.length===0?null:i.identifier===Cu.Material&&i.subPass===us.Color?e.overlays[br.INNER].getColorTextureNoRasterImage():i.identifier===Cu.Highlight?e.overlays[br.INNER].getValidTexture(Ur.Highlight):null}function uyt(i,e){for(const t of e.overlays){const{index:n,extent:r}=t;one(r)>0&&(Ex[2*n]=i.toMapSpace[0]/Mp(r)-r[0]/Mp(r),Ex[2*n+1]=i.toMapSpace[1]/vy(r)-r[1]/vy(r))}return Ex}function dyt(i,e){for(const t of e.overlays){const{index:n,extent:r}=t;one(r)>0&&(Ex[2*n]=i.toMapSpace[2]/Mp(r),Ex[2*n+1]=i.toMapSpace[3]/vy(r))}return Ex}(function(i){i[i.Disabled=0]="Disabled",i[i.Enabled=1]="Enabled",i[i.EnabledWithWater=2]="EnabledWithWater",i[i.COUNT=3]="COUNT"})(km||(km={}));const Ex=Dn();var Up;(function(i){i[i.LayerOnly=0]="LayerOnly",i[i.ColorComposite=1]="ColorComposite",i[i.GridComposite=2]="GridComposite",i[i.COUNT=3]="COUNT"})(Up||(Up={}));let hyt=class extends Es{constructor(){super(...arguments),this.overlayOpacity=1}};function bO(i,e){i.vertex.uniforms.add([new yL("overlayTexOffset"),new yL("overlayTexScale")]),i.fragment.uniforms.add([new Hi("overlayOpacity",t=>t.overlayOpacity),new sn("ovColorTex",(t,n)=>n.overlays.length===0?null:n.overlays[br.INNER].getColorTexture(t.overlaySource))]),hme(i,e)}function pyt(i,e){const{vertex:t,fragment:n,varyings:r}=i;r.add("vtc","vec2"),t.uniforms.add(new yL("texOffsetAndScale")),n.uniforms.add(new zJ("tex")),n.uniforms.add(new $4("textureOpacities"));const s=e.textureFadingEnabled&&!e.renderOccluded;s&&(t.uniforms.add(new yL("nextTexOffsetAndScale")),r.add("nvtc","vec2"),n.uniforms.add(new zJ("texNext")),n.uniforms.add(new $4("nextTexOpacities")),n.uniforms.add(new fyt("fadeFactor")));const a=e.tileBlendInput===Up.ColorComposite,o=e.tileBlendInput===Up.GridComposite;o&&n.include(rH),a&&n.uniforms.add(new $4("backgroundColor")),t.code.add(ee`
  void forwardTextureCoordinatesWithTransform(in vec2 uv) {
    vtc = uv * texOffsetAndScale.zw + texOffsetAndScale.xy;
    ${s?ee`nvtc = uv * nextTexOffsetAndScale.zw + nextTexOffsetAndScale.xy;`:ee``}
  }`),n.code.add(ee`
    vec4 getColor(vec4 color, vec2 uv, vec3 opacities) {
      ${o||a?ee`
              if (opacities.y <= 0.0) {
                return color * opacities.z * opacities.x;
              }
              vec4 bg = ${a?ee`vec4(backgroundColor, 1.0)`:ee`gridColor(uv)`} * opacities.y;
              float alpha = opacities.z * color.a;
              return mix(bg, color, alpha) * opacities.x;`:ee`return color;`}
    }`),s?n.code.add(ee`vec4 getTileColor() {
vec4 color = getColor(texture2D(tex, vtc), vtc, textureOpacities);
if (fadeFactor >= 1.0) {
return color;
}
vec4 nextColor = getColor(texture2D(texNext, nvtc), nvtc, nextTexOpacities);
return mix(nextColor, color, fadeFactor);
}`):n.code.add(ee`vec4 getTileColor() {
return getColor(texture2D(tex, vtc), vtc, textureOpacities);
}`)}let fyt=class extends Cb{constructor(e){super(e,"float")}},$4=class extends Cb{constructor(e){super(e,"vec3")}},yL=class extends Cb{constructor(e){super(e,"vec4")}},zJ=class extends Cb{constructor(e){super(e,"sampler2D")}},pme=class extends hyt{};function myt(i){const e=new Nr,{vertex:t,fragment:n,varyings:r}=e;e.include(Nbe),e.include(pwe,i),e.include(YL,i);const s=()=>{e.include(qwe,i),t.code.add(ee`
  vec3 decodeNormalTerrain(vec2 e) {
    float z = 1.0 - abs(e.x) - abs(e.y);
    vec3 n = vec3(e + vec2(e.x >= 0.0 ? 1.0 : -1.0, e.y >= 0.0 ? 1.0 : -1.0) * min(z,0.0),z);
    return normalize(n);
  }

  vec3 getNormal() {
    return  ${i.shading?ee`normalize(decodeNormalTerrain(normalCompressed))`:ee`getLocalUp(position, localOrigin)`};
  }
  `)};hbe(t,i),e.include(Kne,i);const a=i.overlayMode!==km.Disabled;switch(i.output){case Re.Color:{e.include(pyt,i),e.include(KI,i);const o=i.overlayMode===km.EnabledWithWater;a&&e.include(bO,{...i,pbrMode:Ds.Water}),o&&e.include(syt,i),r.add("vnormal","vec3"),r.add("vpos","vec3"),s(),(i.atmosphere||i.screenSizePerspective)&&KG(t);const l=i.receiveShadows&&!i.renderOccluded;l&&e.include(Vne,i),i.atmosphere&&r.add("wnormal","vec3"),i.screenSizePerspective&&(r.add("screenSizeDistanceToCamera","float"),r.add("screenSizeCosAngle","float")),t.code.add(ee`
        void main(void) {
          //Position
          vpos = position;
          vec3 positionWorld = position + localOrigin;
          gl_Position = transformPosition(proj, view, vpos);

          //Normal
          vnormal = getNormal();

          ${o?ee`forwardVertexTangent(vnormal);`:ee``}

          ${i.atmosphere?ee`
          wnormal = normalize((viewNormal * vec4(normalize(positionWorld), 1.0)).xyz);`:""}

          //Texture UV
          vec2 uv = getUV0();
          forwardTextureCoordinatesWithTransform(uv);
          ${a?ee`setOverlayVTC(uv);`:""}
          ${i.tileBorders?ee`forwardTextureCoordinates();`:""}

          ${i.screenSizePerspective?ee`
          vec3 viewPos = (view * vec4(vpos, 1.0)).xyz;
          screenSizeDistanceToCamera = length(viewPos);
          vec3 viewSpaceNormal = (viewNormal * vec4(normalize(positionWorld), 1.0)).xyz;
          screenSizeCosAngle = abs(viewSpaceNormal.z);`:""}

          ${l?ee`forwardLinearDepth();`:""}

        }
      `),e.extensions.add("GL_OES_standard_derivatives"),e.extensions.add("GL_EXT_shader_texture_lod"),e.include(pre,i),e.include(KI,i),e.include(ybe,i),e.include(wne,i),o&&pbe(n,i),_be(n),Mne(n),n.uniforms.add([t.uniforms.get("localOrigin"),new Io("viewDirection",(c,u)=>mt(UJ,je(UJ,u.camera.viewMatrix[12],u.camera.viewMatrix[13],u.camera.viewMatrix[14])))]),o&&n.uniforms.add([new sn("ovWaterTex",(c,u)=>u.overlays.length===0?null:u.overlays[br.INNER].getNormalTexture(c.overlaySource)),new fbe("view",(c,u)=>of(gyt,u.camera.viewMatrix,c.origin))]),n.code.add(ee`const float sliceOpacity = 0.2;
float lum(vec3 c) {
return (min(min(c.r, c.g), c.b) + max(max(c.r, c.g), c.b)) * 0.5;
}`),XL(n),zB(n),n.code.add(ee`
        void main() {
          vec3 normal = normalize(vnormal);
          float vndl = dot(normal, mainLightDirection);

          float additionalAmbientScale = smoothstep(0.0, 1.0, clamp(vndl*2.5, 0.0, 1.0));
          float shadow = ${i.receiveShadows&&!i.renderOccluded?"readShadowMap(vpos, linearDepth)":i.spherical&&i.shading?"lightingGlobalFactor * (1.0 - additionalAmbientScale)":"0.0"};

          float ssao = evaluateAmbientOcclusionInverse();
          vec4 tileColor = getTileColor();

          ${a?ee`
              vec4 overlayColorOpaque = getOverlayColor(ovColorTex, vtcOverlay);
              vec4 overlayColor = overlayOpacity * overlayColorOpaque;
              ${i.transparent?ee`if (overlayColor.a == 0.0) { discard; }`:""}
              vec4 groundColor = tileColor;
              tileColor = tileColor * (1.0 - overlayColor.a) + overlayColor;`:""}
          if (rejectBySlice(vpos)) {
            tileColor *= sliceOpacity;
          }
          ${i.atmosphere?ee`
              float ndotl = clamp(vndl, 0.0, 1.0);
              vec3 atm = vec3(clamp(1.0 - dot(-viewDirection, wnormal), 0.0, 1.0));
              atm *= clamp(1.0 - lum(tileColor.rgb) * 1.5, 0.0, 1.0); // avoid atmosphere on bright base maps
              atm *= clamp(ndotl * 2.0, 0.0, 1.0); // avoid atmosphere on dark side of the globe
              atm *= tileColor.a; // premultiply with tile alpha`:""}

          vec3 albedo = ${i.atmosphere?ee`atm + tileColor.rgb;`:ee`tileColor.rgb;`}

          // heuristic shading function used in the old terrain, now used to add ambient lighting

          vec3 additionalLight = ssao * mainLightIntensity * additionalAmbientScale * ambientBoostFactor * lightingGlobalFactor;

          gl_FragColor = vec4(evaluateSceneLighting(normal, albedo, shadow, 1.0 - ssao, additionalLight), tileColor.a);
          ${o?ee`
              vec4 overlayWaterMask = getOverlayColor(ovWaterTex, vtcOverlay);
              float waterNormalLength = length(overlayWaterMask);
              if (waterNormalLength > 0.95) {
                mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, vnormal);
                vec4 waterOverlayColor = vec4(overlayColor.w > 0.0 ? overlayColorOpaque.xyz/overlayColor.w : vec3(1.0), overlayColor.w);
                vec4 viewPosition = view*vec4(vpos, 1.0);
                vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, waterOverlayColor, -normalize(vpos - cameraPosition), shadow, vnormal, tbnMatrix, viewPosition.xyz,  vpos + localOrigin);
                vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));
                // un-gamma the ground color to mix in linear space
                gl_FragColor = mix(groundColor, waterColorNonLinear, waterColorLinear.w);
              }`:""}
          ${i.screenSizePerspective?ee`
            float perspectiveScale = screenSizePerspectiveScaleFloat(1.0, screenSizeCosAngle, screenSizeDistanceToCamera, vec4(0.0, 0.0, 0.0, 0.0));
            if (perspectiveScale <= 0.25) {
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), perspectiveScale * 4.0);
            }
            else if (perspectiveScale <= 0.5) {
              gl_FragColor = mix(gl_FragColor, vec4(0.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.25) * 4.0);
            }
            else if (perspectiveScale >= 0.99) {
              gl_FragColor = mix(gl_FragColor, vec4(0.0, 1.0, 0.0, 1.0), 0.2);
            }
            else {
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 1.0, 1.0), (perspectiveScale - 0.5) * 2.0);
            }`:""}
          ${i.visualizeNormals?i.spherical?ee`
              vec3 localUp = normalize(vpos + localOrigin);
              vec3 right = normalize(cross(vec3(0.0,0.0,1.0),localUp));
              vec3 forward = normalize(cross(localUp,right));
              mat3 tbn = mat3(right, forward, localUp);
              vec3 tNormal = normalize(normal* tbn);
              gl_FragColor = vec4(vec3(0.5) + 0.5 * tNormal, 0.0);
          `:ee`
          vec3 tNormal = normalize(normal);
          gl_FragColor = vec4(vec3(0.5) + 0.5 * tNormal, 0.0);
      `:""}
          ${i.tileBorders?ee`
              vec2 dVuv = fwidth(vuv0);
              vec2 edgeFactors = smoothstep(vec2(0.0), 1.5 * dVuv, min(vuv0, 1.0 - vuv0));
              float edgeFactor = 1.0 - min(edgeFactors.x, edgeFactors.y);
              gl_FragColor = mix(gl_FragColor, vec4(1.0, 0.0, 0.0, 1.0), edgeFactor);`:""}
          gl_FragColor = highlightSlice(gl_FragColor, vpos);
        }
      `)}break;case Re.Depth:e.include(bO,i),e.include(a5,i),eW(e),tW(e),t.code.add(ee`
              void main(void) {
                ${a?ee`setOverlayVTC(getUV0());`:""}
                gl_Position = transformPositionWithDepth(proj, view, position, nearFar, linearDepth);
              }
          `),n.code.add(ee`
              void main() {
                ${a?ee`
                  vec4 overlayColor = getCombinedOverlayColor();
                  ${i.transparent?ee`if (overlayColor.a == 0.0) { discard; }`:""}`:""}
                outputDepth(linearDepth);
              }
          `);break;case Re.Shadow:case Re.ShadowHighlight:case Re.ShadowExludeHighlight:e.include(a5,i),eW(e),tW(e),t.code.add(ee`void main(void) {
gl_Position = transformPositionWithDepth(proj, view, position, nearFar, linearDepth);
}`),n.code.add(ee`void main() {
outputDepth(linearDepth);
}`);break;case Re.Normal:r.add("vnormal","vec3"),KG(t),s(),t.code.add(ee`void main(void) {
vec3 normal = getNormal();
gl_Position = transformPosition(proj, view, position);
vnormal = normalize((viewNormal * vec4(normal, 1.0)).xyz);
}`),n.code.add(ee`void main() {
vec3 normal = normalize(vnormal);
if (gl_FrontFacing == false) {
normal = -normal;
}
gl_FragColor = vec4(vec3(0.5) + 0.5 * normal, 0.0);
}`);break;case Re.Highlight:e.include(bO,i),t.code.add(ee`void main() {
setOverlayVTC(getUV0());
gl_Position = transformPosition(proj, view, position);
}`),e.include(fre,i),n.code.add(ee`void main() {
vec4 overlayColor = getCombinedOverlayColor();
if (overlayColor.a == 0.0) {
discard;
}
outputHighlight();
}`)}return i.output===Re.ObjectAndLayerIdColor&&(e.include(bO,{...i,pbrMode:Ds.Disabled}),t.code.add(ee`void main(void) {
gl_Position = transformPosition(proj, view, position);
setOverlayVTC(getUV0());
}`),n.code.add(ee`
        void main() {
          vec2 texDim =  ${qA(i,"ovColorTex")};
          gl_FragColor =  ${Eu(i,"ovColorTex","vec2(vtcOverlay.x * 0.5, vtcOverlay.y)*texDim")};
        }
    `)),e}const gyt=St(),UJ=q(),vyt=Object.freeze(Object.defineProperty({__proto__:null,TerrainPassParameters:pme,build:myt},Symbol.toStringTag,{value:"Module"}));let cH=class extends _n{constructor(){super(...arguments),this.useStencil=!1}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2,t.spherical=e.viewingMode===Ot.Global}initializeProgram(e){return new gn(e.rctx,cH.shader.get().build(this.configuration),fme)}initializePipeline(){return this._stencilPipelineState=this._createPipeline(!0),this._createPipeline(!1)}_createPipeline(e){const t=this.configuration,n=t.backfaceCullingEnabled&&!t.renderOccluded;return yi({blending:t.renderOccluded?vf(vt.ONE,vt.ONE_MINUS_SRC_ALPHA):null,culling:n&&Sne,depthTest:!t.renderOccluded&&{func:lo.LESS},depthWrite:!t.renderOccluded&&Lu,colorWrite:$i,stencilTest:e?e1e(sE.IntegratedMeshMaskExcluded):null})}getPipelineState(e,t){return this.useStencil?this._stencilPipelineState:super.getPipelineState(e,t)}};cH.shader=new bn(vyt,()=>Ee(()=>import("./Terrain.glsl-a082fea1.js"),["./Terrain.glsl-a082fea1.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./vec3-a020a6f6.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./MixExternalColor.glsl-25f0049c.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./ShaderTechniqueConfiguration-9f5b4555.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./context-util-1e3c8cfc.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./compilerUtils-034cacb8.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const fme=new Map([[j.POSITION,0],[j.UV0,1],[j.NORMALCOMPRESSED,2]]);let yyt=class{constructor(){this.geometryInfo=new xvt,this.intersectionData=null,this.geometryState=null,this._textureRef=new kE(()=>this.tile.surface.textureFadeDuration),this.overlay=new ryt,this._geometryStateChangedSinceLastUpdate=!0,this._hasGeometry=!1,this._numVerticesPerSideChanged=!1,this._samplerDataChanged=!1,this._clippingAreaChanged=!1,this._wireframeChanged=!1,this._shadingChanged=!1,this._dirtyEdgeResolutions=15,this._dirtyEdges=15,this._dirtyCorners=15}get tile(){return this._tile}init(e){this.clear(),this._tile=e;const t=this.geometryInfo;t.indices=null,t.vertexAttributes=null,fr(t.boundingBox),t.indexCount=0,t.numVerticesPerSide=0,this.intersectionData=null,this.geometryState=new Pvt,this.localOrigin=null,this.overlay.clear()}clear(){this._releaseGeometry(),this.releaseTexture(),this._textureRef.clear(),this._tile=null,this.intersectionData=null,this.geometryState=null}updateGeometryIfNeeded(e){if((!this._vao||this._geometryStateChangedSinceLastUpdate||this._wireframeChanged||this._shadingChanged||this._clippingAreaChanged||this._samplerDataChanged||this._numVerticesPerSideChanged||this._dirtyCorners||this._dirtyEdgeResolutions||this._dirtyEdges)&&(this._updateGeometry(e),this._geometryStateChangedSinceLastUpdate=!1),fa&&this.tile.intersectsClippingArea)for(let t=0;t<4;++t)yt(this.geometryInfo.outerEdges[t].count===this.geometryState.neighborData.edgeResolutions[t]+1)}_calculateEdgeResolution(e,t){var l;const n=this.tile,r=this.geometryState.numVerticesPerSide-1;if(!n.surface.isGlobal){const c=n.surface.extent;if(T(c)&&(e===0&&n.extent[3]>c[3]||e===1&&n.extent[2]>c[2]||e===2&&n.extent[1]<c[1]||e===3&&n.extent[0]<c[0]))return r}const s=n.level,a=zp[e];if(!t)return yt(B((l=n.surface)==null?void 0:l.rootTiles)||n.surface.updatingRootTiles||!n.shouldHaveNeighbor(a)),r;if(t.isLoaded){const c=t,u=c.renderData.geometryState,d=s-c.level;if(yt(d>=0),d===0){const m=u.numVerticesPerSide-1;return Math.max(m,r)}const h=2**d,p=u.neighborData.edgeResolutions[(e+2)%4]/h;return Math.max(1,p)}yt(!t.isLeaf);let o=r;return t.forAllSubtreeOnSide(fL(a),c=>c===n||(c.isLoaded?(o=Math.max(o,2**(c.level-s)),!0):(yt(!c.isLeaf),!1))),o}updateNeighborData(){var o;const e=this.tile;if(!e.intersectsClippingArea)return;const t=e.renderData.geometryState.neighborData,n=l=>(l.isLoaded||l.level===e.level)&&(l==null?void 0:l.intersectsClippingArea),r=t.edgePeerNeighbors,s=t.edgePeerNeighborSamplerVersions;for(let l=0;l<4;++l){const c=e.findNeighborTile(zp[l],n),u=Kv(e,c),d=((o=u==null?void 0:u.renderData)==null?void 0:o.geometryState.samplerDataVersion)??-1,h=r[l],p=u!==Kv(e,h),m=s[l]!==d;r[l]=c,(p||m)&&(s[l]=d,this._markEdgeDirty(l));const g=t.edgeResolutions[l],_=this._calculateEdgeResolution(l,c);yt(n2(_)),yt(_>=1),t.edgeResolutions[l]=_,g!==_&&this._markEdgeResolutionDirty(l)}const a=t.cornerPeerNeighbors;for(let l=0;l<4;++l){const c=e.findNeighborTile(mL[l],n);a[l]=c;const u=Kv(e,r[l]),d=Kv(e,r[(l+1)%4]),h=Kv(e,c);zd[l]=h,zd[(l+1)%4]=d,zd[(l+2)%4]=e,zd[(l+3)%4]=u,yt(zd.some(_=>(_==null?void 0:_.isLoaded)||_===e));const p=zd.reduce((_,b)=>Math.min(_,(b==null?void 0:b.level)??1/0),1/0);zd.forEach((_,b)=>{(_==null?void 0:_.level)>p&&(zd[b]=null)}),yt(zd.some(_=>(_==null?void 0:_.isLoaded)||_===e));const m=t.cornerNeighborData[l].cornerTiles,g=t.cornerNeighborData[l].cornerTileSamplerVersions;for(let _=0;_<4;++_){const b=zd[_],x=(b==null?void 0:b.renderData.geometryState.samplerDataVersion)??-1,w=m[_]!==b,C=!w&&g[_]!==x;(w||C)&&(m[_]=b,g[_]=x,this._markCornerDirty(l))}yt(m.some(_=>(_==null?void 0:_.isLoaded)||_===e))}fa&&yt(this.geometryState.neighborData.edgeResolutions.every(l=>l>0));for(let l=0;l<4;++l)zd[l]=null}_updateGeometry(e){if(!this.tile.intersectsClippingArea)return;fa&&yt(!this.tile.intersectsClippingArea||this.geometryState.neighborData.edgeResolutions.every(l=>l>0)),this.intersectionData=null;const t=this.tile,n=this._vao,r=this.geometryInfo.vertexAttributes,s=!n||!r||this._wireframeChanged||this._shadingChanged||this._numVerticesPerSideChanged||this._samplerDataChanged||this._clippingAreaChanged||this._dirtyEdgeResolutions,a=!s&&(this._dirtyEdges!==0||this._dirtyEdgeResolutions!==0),o=!a&&this._dirtyCorners!==0;s?(this._releaseGeometry(),this._createGeometry(e)):a||o?t.updateEdgeElevations():o?t.updateCornerElevations():console.warn("Update for no reason?"),this._numVerticesPerSideChanged=!1,this._samplerDataChanged=!1,this._dirtyEdgeResolutions=0,this._dirtyEdges=0,this._dirtyCorners=0,this._clippingAreaChanged=!1,this._wireframeChanged=!1}releaseGeometry(){return this._releaseGeometry()}get hasGeometry(){return this._hasGeometry}ensureTexture(e,t){return T(this._texture)&&this._texture.descriptor.width!==e&&this.releaseTexture(),B(this._texture)&&(this._texture=t(),this.tile.setMemoryDirty()),this._texture}releaseTexture(){T(this._texture)&&(this._texture.release(),this._texture=null,this.tile.setMemoryDirty())}_markCornerDirty(e){const t=1<<e;this._dirtyCorners|=t}_markEdgeDirty(e){const t=1<<e;this._dirtyEdges|=t}_markEdgeResolutionDirty(e){const t=1<<e;this._dirtyEdgeResolutions|=t,this._dirtyEdges|=t}_markAllEdgesAndCornersDirty(){this._dirtyCorners=15,this._dirtyEdges=15,this._dirtyEdgeResolutions=15}updateGeometryState(){const e=this._getElevationInfo(),t=this.tile,n=e.samplerData?t.getElevationBasedVerticesPerSide(e.maxTileLevel):t.getDefaultVerticesPerRowOnLevel(),r=Math.max(n,5);let s=t.clippingArea;t.intersectsClippingArea&&!t.isWithinClippingArea||(s=null);const a=this.geometryState;let o=!1;a.numVerticesPerSide!==r&&(this._numVerticesPerSideChanged=!0,a.numVerticesPerSide=r,a.samplerDataVersion++,o=!0),e.changed&&(this._samplerDataChanged=!0,a.samplerData=e.samplerData,a.samplerDataVersion++,o=!0),K0(a.clippingArea,s)||(this._clippingAreaChanged=!0,a.clippingArea=s,o=!0);const l=t.surface,c=l.wireframe;a.wireframe!==c&&(this._wireframeChanged=!0,a.wireframe=c,o=!0);const u=l.shading;return a.shading!==u&&(this._shadingChanged=u,a.shading=u,o=u),this._geometryStateChangedSinceLastUpdate||(this._geometryStateChangedSinceLastUpdate=o),o&&this._markAllEdgesAndCornersDirty(),this._hasGeometry=!0,this._geometryStateChangedSinceLastUpdate}_createGeometry(e){this.tile.createGeometry();const t=this.geometryInfo.vertexAttributes,n=this.geometryInfo.indices,r=e.gl;this._vao=new lf(e,fme,{geometry:Dh(t.layout)},{geometry:In.createVertex(e,r.STATIC_DRAW,t.buffer)},In.createIndex(e,r.STATIC_DRAW,n)),this._hasGeometry=!0}_releaseGeometry(){return this._hasGeometry=!1,this.intersectionData=null,!!this._vao&&(this._vao.dispose(),this._vao=null,Svt(this.geometryInfo),!0)}get vao(){return this._vao}setTextureReference(e,t=Lm.Immediate){T(e)&&e.texture!==this._texture&&this.releaseTexture(),this._textureRef.push(e,t)}get textureReference(){return this._textureRef.current}get nextTextureReference(){return this._textureRef.next}get textureFadeFactor(){return this._textureRef.fadeFactor}get textureIsFading(){return this._textureRef.isFading}_getElevationInfo(){const e=this.geometryState.samplerData,t=this.tile.layerInfo[Li.ELEVATION],n=t.length;let r=new Array(n),s=0,a=0,o=!1;for(let l=0;l<n;l++){const c=t[l];if(T(c.upsampleInfo)){const u=c.upsampleInfo.tile,d=u.layerInfo[Li.ELEVATION][l].data,h=d&&d.samplerData;e&&e[s]===h||(o=!0),r[s++]=h,a=Math.max(a,u.lij[0])}else if(c.data){const u=this.tile.surface.layerViewByIndex(l,Li.ELEVATION);if(FE(this.tile,u.layer,!1)){const d=c.data;e&&e[s]===d.samplerData||(o=!0),r[s++]=d.samplerData,a=this.tile.level}}}return T(e)&&e.length!==s&&(o=!0),s>0?r.length=s:r=null,{changed:o,samplerData:r,maxTileLevel:a}}get estimatedGeometryMemoryUsage(){var t,n;const e=Ov(this.intersectionData,0,r=>r.estimatedMemoryUsage);return(((t=this.geometryInfo.indices)==null?void 0:t.byteLength)??0)+(((n=this.geometryInfo.vertexAttributes)==null?void 0:n.byteLength)??0)+e}get textureDescriptor(){return T(this._texture)?this._texture.descriptor:null}get test(){return{hasTexture:this._texture!=null}}checkGeometryWaterproofness(){if(!fa)return;const e=this.tile;if(yt(e==null?void 0:e.isLoaded),!e.isLoaded||!e.intersectsClippingArea||e.level===0)return;const t=e.surface.extent;if(T(t)&&!e.intersectsExtent(t))return;const n=zp.map((o,l)=>!!T(t)&&(l<2?-1:1)*(e.extent[3-l]-t[3-l])<0),r=e.level;yt(this._dirtyCorners===0),yt(this._dirtyEdges===0),yt(this._dirtyEdgeResolutions===0),yt(!this._numVerticesPerSideChanged),yt(!this._samplerDataChanged),yt(!this._clippingAreaChanged),yt(!this._wireframeChanged);const s=mL.map(o=>e.findNeighborCornerTileExact(o,l=>!l.intersectsClippingArea||l.isLoaded||l.level===e.level)??null).map(o=>o!=null&&o.intersectsClippingArea?o:null),a=this.geometryState.neighborData;for(let o=0;o<4;++o){const l=a.cornerPeerNeighbors[o],c=s[o];yt(c===l,`Tile[${e.lij}].corner[${o}] out of date: cur=[${l==null?void 0:l.lij}] exp=[${c==null?void 0:c.lij}]`)}zp.forEach((o,l)=>{if(n[l])return;const c=e.findNeighborTile(o,k=>(k.level===r||(k==null?void 0:k.isLoaded))&&(k==null?void 0:k.intersectsClippingArea));if(!c){const k=!e.surface.updatingRootTiles&&T(e.surface.rootTiles)&&e.surface.rootTiles.length>0&&e.shouldHaveNeighbor(o);return void yt(!k)}yt(c.isLoaded||c.level===e.level),yt(c===this.geometryState.neighborData.edgePeerNeighbors[l]);const u=r-c.level;if(!c.isLoaded)return yt(!c.isLeaf),void yt(u===0);yt(nyt(e,c,o)),yt(u>=0);const d=2**u;if(u<0)return void yt(!1);const h=e.renderData.geometryInfo,p=h.outerEdges[l],m=h.numVerticesPerSide-1,g=c.renderData.geometryInfo;if(!g)return void yt(!1);{const k=this.geometryState.neighborData.edgePeerNeighbors[l];(k!=null&&k.isLoaded||k.isLoaded)&&(yt(k==k),yt(e.renderData.geometryState.neighborData.edgePeerNeighborSamplerVersions[l]===k.renderData.geometryState.samplerDataVersion),yt(this.geometryState.neighborData.edgePeerNeighborSamplerVersions[l]===k.renderData.geometryState.samplerDataVersion))}const _=(l+2)%4,b=g.outerEdges[_],x=p.count-1,w=b.count-1;yt(x*d===w,`Tile[${e.lij}]:e${l},res=${x} edgeRes mismatch with Neighbor[${c.lij}]:e${_},res=${w} (expected:${x*d})`);const C=e.extent,S=o===ei.NORTH||o===ei.SOUTH,E=b.count-1,A=E/2**u,P=p.count-1;if(A<1)return void yt(P===1);yt(A===P),yt(n2(A));const O=g.numVerticesPerSide-1;yt(u>0||A===Math.max(O,m));const M=e.getNeighborEdgeStartVertexIndex(l,c);yt(0<=M&&M<d);const V=M*A;yt(0<=V&&V<=E-A);let L=0,U=V;p.getVertexPos(tp,0),p.getVertexPos(ip,p.count-1);const G=Gn(tp,ip),H=Math.max(_yt,1e-4*G);for(let k=0;k<=A;++k){p.getVertexPos(tp,L),b.getVertexPos(ip,U);const D=k/A,$=S?C[0]+D*(C[2]-C[0]):o===ei.WEST?C[0]:C[2],F=S?o===ei.SOUTH?C[1]:C[3]:C[1]+D*(C[3]-C[1]),Y=e.surface.extent;if(B(Y)||b0e(Y,$,F)){const ne=ine(tp,ip),X=vp(tp)-Rc.radius,J=vp(ip)-Rc.radius,he=ne<H;if(!he){console.warn(`Tile edge vertex position mismatch: between [${e.lij}].edge${l}[${L}/${p.count}] and [${c.lij}].edge${_}[${U}/${b.count}]`),T(Y)&&console.warn("  surface extent= ",Y," x,y=",$,",",F);const ye=q();nt(ye,e.renderData.localOrigin,c.renderData.localOrigin),vp(ye)>0&&console.warn(`   localOrigins: ${e.renderData.localOrigin} vs ${c.renderData.localOrigin} d=${vp(ye)} [${ye}]`),(()=>{const Te=Ts(tp),ce=Ts(ip);e.updateEdgeElevations(),c.updateEdgeElevations(),p.getVertexPos(tp,L),b.getVertexPos(ip,U);const ae=q();pr(ae,tp,Te),vp(ae)>0&&console.warn(`  XXX Tile[${e.lij}] edge out of date: ${Te} vs ${tp} d=${vp(ae)} [${ae}]`),pr(ae,ip,ce),vp(ae)>0&&console.warn(`  XXX Neighbor[${c.lij}] edge out of date: ${ce} vs ${ip} d=${vp(ae)} [${ae}]`)})(),yt(he,`Mismatch in tile [${e.lij}].edge[${l}][${L}/${p.count}] vs neighbor [${c.lij}].edge[${_}][${U}/${b.count}] ${Vf(tp)} vs ${Vf(ip)}  dist=${ne} h(t|n|d)=${X}|${J}|${J-X}`)}if(e.surface.shading){p.getNormal(I1,L),b.getNormal($1,U),mt(HJ,I1),mt(GJ,$1);const ye=dt(HJ,GJ),Te=!1,ce=1-ye<.01||Te||e===c;if(!ce){const ae=q();pr(ae,I1,$1);const le=()=>`Mismatch in tile edge normal ${SJ(e.lij)} (${L}/${p.count-1}) edge ${l} vs neighbor ${SJ(c.lij)}  (${U}/${b.count-1}) nedge ${_} :${Vf(I1)} vs ${Vf($1)}  dot = ${ye} : ${Vf(ae)}`;console.warn("Mismatch in tile edge normal: ",le());{e.updateEdgeElevations(),c.updateEdgeElevations();const fe=q(),Ue=q();p.getNormal(fe,L),b.getNormal(Ue,U),af(I1,fe)||console.warn("Missing update in tile normal: ",Vf(I1)," => ",Vf(fe)),af($1,Ue)||console.warn("Missing update in neighbor normal: ",Vf($1)," => ",Vf(Ue))}yt(ce,le())}}}L+=1,U+=1}})}};const tp=q(),ip=q(),I1=q(),$1=q(),HJ=q(),GJ=q(),_yt=1,zd=[null,null,null,null];function Kv(i,e){return e!=null&&e.isLoaded||e===i?e:null}const byt=65536;function wyt(i,e){const t=i.tile,{extent:n,extentInRadians:r,surface:s}=t,a=i.localOrigin,o=i.geometryState,l=s.isWebMercator,c=s.shading||mb,u=o.numVerticesPerSide,d=u-1,h=(u-2)**2,p=l&&(e===cd.HAS_SOUTH_POLE||e===cd.HAS_BOTH_POLES),m=l&&(e===cd.HAS_NORTH_POLE||e===cd.HAS_BOTH_POLES),g=6,_=((p?1:0)+(m?1:0))*g*(d+1),b=o.neighborData,x=b.edgeResolutions.reduce((P,O)=>P+O+1,0),w=rme(h+_+x),C=i.geometryInfo;C.numVerticesPerSide=o.numVerticesPerSide,C.vertexAttributes=w;const S=C.boundingBox;fr(S);const E=uH(i);ws.update(d,r,E),xyt(i),Cme(i,h),mme(i);const A=[];if((()=>{let P=h+x;const O=a[0],M=a[1],V=a[2],L=t.ellipsoid.radius,U=n[1],G=n[3],H=(k,D)=>{const $=D*u;cl(-O,-M,k*L-V,S),A.push({connectedRowOffset:$,connectedOuterEdgeOffset:k===1?0:2,rowOffset:P,latitudeResolution:g});const F=yme(k===-1?U:G,L),Y=k*Math.PI/2-F,ne=.99*(k===1?1:-1),X=L+0,J=w.position,he=w.uv0,ye=w.normalCompressed;for(let Te=1;Te<=g;++Te){const ce=F+Y*(Te/g),ae=Math.cos(ce),le=Math.sin(ce);for(let fe=0;fe<=d;fe++){const Ue=fe/d,ie=ws.sinLonLUT[fe],oe=ws.cosLonLUT[fe]*ae,we=ie*ae,Ae=le,Oe=oe*X-O,ve=we*X-M,ke=Ae*X-V;cl(Oe,ve,ke,S),J.setValues(P,Oe,ve,ke),Fc(he,P,Ue,ne),c&&PA(ye,P,oe,we,Ae),++P}}};p&&H(-1,0),m&&H(1,d)})(),xme(C,o.numVerticesPerSide,A,[0,u-1],[0,u-1],o.wireframe),i.intersectionData=null,fa)for(let P=0;P<4;++P)yt(C.outerEdges[P].count===b.edgeResolutions[P]+1)}function xyt(i){const e=i.tile;e.intersectsClippingArea&&(e.surface.shading||mb?Tyt(i):Cyt(i))}function Cyt(i){const e=i.geometryState,t=e.numVerticesPerSide,n=t-2,r=t-1,s=i.geometryInfo,a=s.vertexAttributes,o=a.position,l=a.uv0,c=i.tile,u=c.extent,d=u[0],h=u[2],p=u[1],m=u[3],g=c.ellipsoid.radius,_=e.samplerData,b=i.localOrigin,x=b[0],w=b[1],C=b[2],S=s.boundingBox,E=o.typedBuffer,A=o.typedBufferStride;let P=0;for(let O=1;O<=n;O++){const M=O/r,V=p*(1-M)+m*M,L=ws.sinLatLUT[O],U=ws.cosLatLUT[O];for(let G=1;G<=n;G++){const H=G/r,k=d*(1-H)+h*H,D=ws.sinLonLUT[G],$=ws.cosLonLUT[G],F=g+ir(k,V,_),Y=$*U*F-x,ne=D*U*F-w,X=L*F-C;cl(Y,ne,X,S);const J=P*A;E[J+0]=Y,E[J+1]=ne,E[J+2]=X,Fc(l,P,H,M),++P}}}function Tyt(i){const e=i.geometryState,t=e.numVerticesPerSide,n=t-2,r=t-1,s=i.geometryInfo,a=s.vertexAttributes,o=a.position,l=a.uv0,c=a.normalCompressed,u=i.tile,d=u.extent,h=d[0],p=d[2],m=d[1],g=d[3],_=u.ellipsoid.radius,b=e.samplerData,x=i.localOrigin,w=x[0],C=x[1],S=x[2],E=o.typedBuffer,A=o.typedBufferStride,P=1/r,O=s.boundingBox;let M=0;if(1<=n){const V=P,L=m*(1-V)+g*V,U=ws.sinLatLUT[1],G=ws.cosLatLUT[1];for(let H=1;H<=n;H++){const k=H*P,D=h*(1-k)+p*k,$=ws.sinLonLUT[H],F=ws.cosLonLUT[H],Y=_+ir(D,L,b),ne=Y*F*G-w,X=Y*$*G-C,J=Y*U-S;cl(ne,X,J,O);const he=(H-1)*A;E[he+0]=ne,E[he+1]=X,E[he+2]=J,Fc(l,H-1,k,V)}}for(let V=1;V<=n;V++){const L=V*P,U=m*(1-L)+g*L,G=ws.sinLatLUT[V],H=ws.cosLatLUT[V],k=V+1,D=k*P,$=m*(1-D)+g*D,F=ws.sinLatLUT[k],Y=ws.cosLatLUT[k],ne=ws.sinLonLUT[0],X=ws.cosLonLUT[0],J=_+ir(h,U,b);let he=X*H*J-w,ye=ne*H*J-C,Te=G*J-S;const ce=M*A;let ae=E[ce+0],le=E[ce+1],fe=E[ce+2];for(let Ue=1;Ue<=n;Ue++){const ie=Ue*P,oe=h*(1-ie)+p*ie,we=ws.sinLonLUT[Ue],Ae=ws.cosLonLUT[Ue],Oe=Ae*H,ve=we*H,ke=G;let be=0,$e=0,Le=0;{let Be=0,He=0,Xe=0;if(Ue<n){const De=(M+1)*A;Be=E[De+0],He=E[De+1],Xe=E[De+2]}else{const De=ws.sinLonLUT[r],Tt=ws.cosLonLUT[r],Zt=_+ir(p,U,b);Be=Tt*H*Zt-w,He=De*H*Zt-C,Xe=G*Zt-S}const Je=he,it=ye,Qe=Te;he=ae,ye=le,Te=fe,ae=Be,le=He,fe=Xe;const te=Be-Je,me=He-it,Ie=Xe-Qe,K=me*ke-Ie*ve,se=Ie*Oe-te*ke,Me=te*ve-me*Oe;be=se*Ie-Me*me,$e=Me*te-K*Ie,Le=K*me-se*te}{let Be=0,He=0,Xe=0;if(V>1){const Je=(M-n)*A;Be=E[Je+0],He=E[Je+1],Xe=E[Je+2]}else{const Je=ws.sinLatLUT[0],it=ws.cosLatLUT[0],Qe=_+ir(oe,m,b);Be=Ae*it*Qe-w,He=we*it*Qe-C,Xe=Je*Qe-S}{const Je=_+ir(oe,$,b),it=Ae*Y*Je-w,Qe=we*Y*Je-C,te=F*Je-S;if(V<n){const Tt=M+n,Zt=Tt*A;E[Zt+0]=it,E[Zt+1]=Qe,E[Zt+2]=te,cl(it,Qe,te,O),Fc(l,Tt,ie,D)}const me=Be-it,Ie=He-Qe,K=Xe-te,se=Ie*ke-K*ve,Me=K*Oe-me*ke,De=me*ve-Ie*Oe;be+=Me*K-De*Ie,$e+=De*me-se*K,Le+=se*Ie-Me*me}}const Ce=1/Math.sqrt(be*be+$e*$e+Le*Le);PA(c,M,be*Ce,$e*Ce,Le*Ce),++M}}}function Syt(i){i.tile.intersectsClippingArea&&(mme(i),MD(i))}function Eyt(i){i.tile.intersectsClippingArea&&(vme(i),gme(i,!0),MD(i))}function mme(i){i.tile.intersectsClippingArea&&(vme(i),gme(i))}function gme(i,e=!1){const t=i.geometryState,n=i.geometryInfo,r=t.neighborData,s=i.tile,a=s.level,o=s.extent,l=s.ellipsoid.radius,c=s.extentInRadians,u=c[0],d=c[2],h=c[1],p=c[3],m=t.samplerData,g=o[0],_=o[2],b=o[1],x=o[3],w=uH(i),C=n.boundingBox,S=i.localOrigin,E=S[0],A=S[1],P=S[2],O=s.surface.shading||mb,M=n.vertexAttributes,V=M.position,L=V.typedBuffer,U=V.typedBufferStride,G=M.uv0;for(let H=0;H<4;++H){const k=H===1||H===3,D=r.edgeResolutions[H];yt(n2(D));const $=D+1,F=Kv(s,r.edgePeerNeighbors[H]);if(Eme(s,F,H)){Tme(i,H);continue}const Y=T(F);yt(!Y||F.level===s.level),yt(!Y||Dm(s,F)<=0);const ne=F==null?void 0:F.renderData,X=ne==null?void 0:ne.geometryState;if(fa){const Je=s.surface;if(!F&&Je&&!Je.updatingRootTiles){const it=zp[H],Qe=s.findNeighborTile(it,te=>te.isLoaded||te.isLeaf||te.level===s.level);Qe?Qe.intersectsClippingArea&&(yt(!Qe.isLoaded),yt(!Qe.isLeaf),yt(Qe.level===a)):yt(B(Je==null?void 0:Je.rootTiles)||!s.shouldHaveNeighbor(it))}}const J=H===1?o[2]:o[0],he=F==null?void 0:F.extent,ye=Y&&k?H===1?he[0]:he[2]:J,Te=H===0?o[3]:o[1],ce=H===1?1:0,ae=H===0?1:0,le=H===1?d:u,fe=H===0?p:h,Ue=Math.sin(le),ie=Math.cos(le),oe=Math.sin(fe),we=Math.cos(fe),Ae=X==null?void 0:X.samplerData,Oe=(Je,it,Qe)=>ir(Je,it,m),ve=(Je,it,Qe)=>.5*(ir(Je,it,m)+ir(Qe,it,Ae)),ke=Y?ve:Oe,be=n.outerEdges[H],$e=e&&$>3?$-3:1,Le=T(m)&&m.some(Je=>Je!=null),Ce=T(Ae)&&Ae.some(Je=>Je!=null),Be=Le||Ce,He=1/D,Xe=be.index0;O?(yt(!Y||Lgt(he[2]-he[0],o[2]-o[0])),(()=>{const Je=H===1?-1:H===3?1:0,it=H===0?-1:H===2?1:0,Qe=(o[2]-o[0])*He,te=Je*Qe,me=it*Qe,Ie=k?Je*((d-u)*He):0,K=k?0:it*He,se=ae,Me=k?le+Ie:le,De=k?Math.sin(Me):Ue,Tt=k?Math.cos(Me):ie,Zt=k?le-Ie:le,tn=k?Math.sin(Zt):Ue,vn=k?Math.cos(Zt):ie,ui=k?fe:w(se+K),di=k?oe:Math.sin(ui),ze=k?we:Math.cos(ui),ft=k?fe:w(se-K),Bt=k?oe:Math.sin(ft),Kt=k?we:Math.cos(ft),wn=(Xe+0)*U;let bi=L[wn+0]+E,xn=L[wn+1]+A,As=L[wn+2]+P,jr=0,ea=0,Uc=0;{const ss=1*He,Fb=k?J:g*(1-ss)+_*ss,JC=k?ye:Fb,eT=k?b*(1-ss)+x*ss:Te,tT=k?le:u*(1-ss)+d*ss,AM=k?Ue:Math.sin(tT),MM=k?ie:Math.cos(tT),Nb=k?w(ss):fe,iT=k?Math.sin(Nb):oe,Vb=k?Math.cos(Nb):we,nT=l+ke(Fb,eT,JC);jr=MM*Vb*nT,ea=AM*Vb*nT,Uc=iT*nT}for(let ss=1;ss<$-1;ss+=$e){let Fb=0,JC=0,eT=0;{const zh=(Xe+ss+1)*U;if(ss<$-2){const jo=(ss+1)*He,Uh=k?J:g*(1-jo)+_*jo,Cf=k?ye:Uh,ho=k?b*(1-jo)+x*jo:Te,Hc=k?le:u*(1-jo)+d*jo,Tg=k?Ue:Math.sin(Hc),Hy=k?ie:Math.cos(Hc),Sg=k?w(jo):fe,Gy=k?Math.sin(Sg):oe,rT=k?Math.cos(Sg):we,jb=l+ke(Uh,ho,Cf);Fb=Hy*rT*jb,JC=Tg*rT*jb,eT=Gy*jb}else Fb=L[zh+0]+E,JC=L[zh+1]+A,eT=L[zh+2]+P}const tT=Fb,AM=JC,MM=eT,Nb=jr,iT=ea,Vb=Uc;jr=tT,ea=AM,Uc=MM;{const zh=Xe+ss,jo=zh*U,Uh=Nb-E,Cf=iT-A,ho=Vb-P;L[jo+0]=Uh,L[jo+1]=Cf,L[jo+2]=ho,cl(Uh,Cf,ho,C);const Hc=ss*He;Fc(G,zh,k?ce:Hc,k?Hc:ae)}const nT=bi,iye=xn,nye=As;bi=Nb,xn=iT,As=Vb;const Bb=Nb,zb=iT,Ub=Vb;let Hb=0,Gb=0,Wb=0;if(Be){const zh=1/Math.sqrt(Bb*Bb+zb*zb+Ub*Ub),jo=Bb*zh,Uh=zb*zh,Cf=Ub*zh;{const ho=tT-nT,Hc=AM-iye,Tg=MM-nye,Hy=Hc*Cf-Tg*Uh,Sg=Tg*jo-ho*Cf,Gy=ho*Uh-Hc*jo;Hb+=Sg*Tg-Gy*Hc,Gb+=Gy*ho-Hy*Tg,Wb+=Hy*Hc-Sg*ho}{const ho=ss*He,Hc=k?J:g*(1-ho)+_*ho,Tg=k?ye:Hc,Hy=k?b*(1-ho)+x*ho:Te,Sg=k?le:u*(1-ho)+d*ho,Gy=k?Ue:Math.sin(Sg),rT=k?ie:Math.cos(Sg),jb=k?w(ho):fe,dG=k?Math.sin(jb):oe,hG=k?Math.cos(jb):we;let KD=Bb,YD=zb,XD=Ub;if(Y){const Wy=l+ir(Tg-te,Hy-me,Ae),sT=k?hG:Kt;KD=(k?vn:rT)*sT*Wy,YD=(k?tn:Gy)*sT*Wy,XD=(k?dG:Bt)*Wy}{const Wy=l+ir(Hc+te,Hy+me,m),sT=k?hG:ze,pG=(k?Tt:rT)*sT*Wy,fG=(k?De:Gy)*sT*Wy,mG=(k?dG:di)*Wy;Y||(KD=2*Bb-pG,YD=2*zb-fG,XD=2*Ub-mG);const PM=KD-pG,OM=YD-fG,RM=XD-mG,gG=OM*Cf-RM*Uh,vG=RM*jo-PM*Cf,yG=PM*Uh-OM*jo;Hb+=vG*RM-yG*OM,Gb+=yG*PM-gG*RM,Wb+=gG*OM-vG*PM}}}else Hb=Bb,Gb=zb,Wb=Ub;const qD=1/Math.sqrt(Hb*Hb+Gb*Gb+Wb*Wb);be.setNormalFromValues(ss,Hb*qD,Gb*qD,Wb*qD)}})()):(()=>{for(let Je=1;Je<$-1;Je+=$e){const it=Je*He,Qe=k?ce:it,te=k?it:ae,me=k?J:g*(1-it)+_*it,Ie=k?b*(1-it)+x*it:Te,K=k?ye:me,se=k?le:u*(1-it)+d*it,Me=k?Ue:Math.sin(se),De=k?ie:Math.cos(se),Tt=k?w(it):fe,Zt=k?Math.sin(Tt):oe,tn=k?Math.cos(Tt):we,vn=ke(me,Ie,K),ui=l+vn,di=De*tn*ui-E,ze=Me*tn*ui-A,ft=Zt*ui-P;cl(di,ze,ft,C);const Bt=Xe+Je,Kt=Bt*U;L[Kt+0]=di,L[Kt+1]=ze,L[Kt+2]=ft,Fc(G,Bt,Qe,te)}})()}}function vme(i){Sme(i)}function yme(i,e){return Math.PI/2-2*Math.atan(Math.exp(-i/e))}function Ayt(i,e,t,n){return yme(i*(1-n)+e*n,t)}function Myt(i,e,t){return i*(1-t)+e*t}function uH(i){const e=i.tile;if(e.surface.isWebMercator){const n=e.extent,r=e.ellipsoid.radius;return s=>Ayt(n[1],n[3],r,s)}const t=e.extentInRadians;return n=>Myt(t[1],t[3],n)}function Pyt(i,e){const t=i.tile.extent,n=i.geometryState,r=t[0],s=t[1],a=t[2]-r,o=t[3]-s,l=n.clippingArea,c=T(l)?Math.max(0,(l[0]-r)/a):0,u=T(l)?Math.max(0,(l[1]-s)/o):0,d=T(l)?Math.min(1,(l[2]-r)/a):1,h=T(l)?Math.min(1,(l[3]-s)/o):1,p=n.numVerticesPerSide,m=(p-2)**2,g=n.neighborData.edgeResolutions.reduce((w,C)=>w+C+1,0),_=rme(m+g),b=i.geometryInfo,x=b.boundingBox;fr(x),b.numVerticesPerSide=n.numVerticesPerSide,b.vertexAttributes=_,dl(b.uvRange,c,u,d,h),Oyt(i),Cme(i,m),_me(i),xme(b,n.numVerticesPerSide,[],[0,p-1],[0,p-1],n.wireframe),i.intersectionData=null}function Oyt(i){const e=i.tile;e.intersectsClippingArea&&(e.surface.shading?Iyt(i):Ryt(i))}function Ryt(i){const e=i.geometryState,t=e.samplerData,n=i.tile,r=n.surface,s=i.localOrigin,a=r.isWebMercatorOnPlateeCarree,o=e.clippingArea,l=T(o)?o:PD,c=n.extent,u=c[0],d=c[1],h=c[2],p=c[3],m=Math.max(u,l[0]),g=Math.min(h,l[2]),_=Math.max(d,l[1]),b=Math.min(p,l[3]),x=s[0],w=s[1],C=s[2],S=n.ellipsoid.radius,E=n.horizontalScale,A=dH(a,S,E),P=e.numVerticesPerSide,O=P-1,M=P-2,V=i.geometryInfo,L=V.uvRange,U=L[0],G=L[1],H=L[2],k=L[3],D=V.boundingBox,$=V.vertexAttributes,F=$.position,Y=$.uv0;let ne=0;for(let X=1;X<=M;X++){const J=X/O,he=lt(d*(1-J)+p*J,_,b),ye=lt(J,G,k),Te=A(he)-w;for(let ce=1;ce<=M;ce++){const ae=ce/O,le=lt(u*(1-ae)+h*ae,m,g),fe=lt(ae,U,H),Ue=le*E-x,ie=ir(le,he,t)-C;cl(Ue,Te,ie,D),F.setValues(ne,Ue,Te,ie),Fc(Y,ne,fe,ye),++ne}}}function Iyt(i){const e=i.tile,t=e.surface;if(!(t.shading||mb))return;const n=i.geometryState,r=n.samplerData,s=i.localOrigin,a=t.isWebMercatorOnPlateeCarree,o=n.clippingArea,l=T(o)?o:PD,c=e.extent,u=c[0],d=c[1],h=c[2],p=c[3],m=Math.max(u,l[0]),g=Math.min(h,l[2]),_=Math.max(d,l[1]),b=Math.min(p,l[3]),x=e.ellipsoid.radius,w=e.horizontalScale,C=n.numVerticesPerSide,S=C-1,E=C-2,A=i.geometryInfo,P=A.vertexAttributes,O=P.position,M=P.uv0,V=P.normalCompressed,L=A.uvRange,U=L[0],G=L[1],H=L[2],k=L[3],D=A.boundingBox,$=s[0],F=s[1],Y=s[2],ne=O.typedBuffer,X=O.typedBufferStride;let J=0;const he=lt(d,_,b),ye=a?(Math.PI/2-2*Math.atan(Math.exp(-he/x)))*x:he*w,Te=1/S,ce=lt(d*(1-Te)+p*Te,_,b);let ae=ye,le=a?(Math.PI/2-2*Math.atan(Math.exp(-ce/x)))*x:ce*w;for(let fe=1;fe<=E;fe++){const Ue=fe/S,ie=lt(d*(1-Ue)+p*Ue,_,b),oe=lt(Ue,G,k),we=le,Ae=(fe-1)/S,Oe=lt(d*(1-Ae)+p*Ae,_,b),ve=ae,ke=(fe+1)/S,be=lt(d*(1-ke)+p*ke,_,b),$e=a?(Math.PI/2-2*Math.atan(Math.exp(-be/x)))*x:be*w,Le=lt(ke,G,k);ae=le,le=$e;const Ce=lt(u,m,g);let Be=Ce*w,He=ir(Ce,ie,r);const Xe=1/S,Je=lt(Xe,U,H),it=lt(u*(1-Je)+h*Je,m,g);let Qe=Je,te=it,me=it*w,Ie=ir(it,ie,r);if(fe===1){const K=me-$,se=ae-F,Me=Ie-Y,De=0*X;ne[De+0]=K,ne[De+1]=se,ne[De+2]=Me,cl(K,se,Me,D);const Tt=lt(Xe,U,H);Fc(M,J,Tt,oe)}for(let K=1;K<=E;K++){const se=me,Me=Ie,De=(K+1)/S,Tt=lt(De,U,H),Zt=lt(u*(1-De)+h*De,m,g),tn=te;te=Zt;{const wn=J+1,bi=wn*X;if(fe===1||K===E){const xn=Zt*w,As=we,jr=ir(Zt,ie,r);if(fe===1&&K<E){const ea=xn-$,Uc=As-F,ss=jr-Y;ne[bi+0]=ea,ne[bi+1]=Uc,ne[bi+2]=ss,cl(ea,Uc,ss,D),Fc(M,wn,Tt,oe)}me=xn,Ie=jr}else me=ne[bi+0]+$,Ie=ne[bi+2]+Y}const vn=me,ui=Ie,di=Be,ze=He;Be=se,He=Me;const ft=(J-E)*X,Bt=fe===1?ir(tn,Oe,r):ne[ft+2]+Y,Kt=ir(tn,be,r);if(fe<E){const wn=J+E,bi=wn*X,xn=se-$,As=$e-F,jr=Kt-Y;ne[bi+0]=xn,ne[bi+1]=As,ne[bi+2]=jr,cl(xn,As,jr,D);const ea=Qe;Qe=Tt,Fc(M,wn,ea,Le)}{const wn=vn-di,bi=-wn*(ui-ze),xn=ve-$e,As=-xn*(Bt-Kt),jr=wn*wn+xn*xn,ea=bi*bi+As*As+jr*jr;if(ea===0)PA(V,J,0,0,1);else{const Uc=1/Math.sqrt(ea);PA(V,J,bi*Uc,As*Uc,jr*Uc)}}++J}}}function $yt(i,e){i.tile.intersectsClippingArea&&(wme(i),bme(i,!0),MD(i))}function Lyt(i,e){i.tile.intersectsClippingArea&&(_me(i),MD(i))}function _me(i,e){i.tile.intersectsClippingArea&&(wme(i),bme(i,!1))}function bme(i,e){const t=i.geometryState,n=t.neighborData,r=i.tile,s=r.surface,a=s.shading||mb,o=r.extent,l=t.clippingArea,c=T(l)?l:PD,u=o[0],d=o[2],h=o[1],p=o[3],m=[p>c[3],d>c[2],h<c[1],u<c[0]],g=i.geometryInfo,_=r.horizontalScale,b=dH(s.isWebMercatorOnPlateeCarree,r.ellipsoid.radius,_),x=g.boundingBox,w=g.uvRange[0],C=g.uvRange[1],S=g.uvRange[2],E=g.uvRange[3],A=Math.max(u,c[0]),P=Math.min(d,c[2]),O=Math.max(h,c[1]),M=Math.min(p,c[3]),V=i.localOrigin,L=V[0],U=V[1],G=V[2],H=t.samplerData;for(let k=0;k<4;++k){const D=k===1||k===3,$=n.edgeResolutions[k];yt(n2($));const F=$+1,Y=m[k],ne=Kv(r,n.edgePeerNeighbors[k]);if(!Y&&Eme(r,ne,k)){Tme(i,k);continue}const X=T(ne)&&!Y,J=ne==null?void 0:ne.renderData,he=J==null?void 0:J.geometryState;if(fa&&(yt(!X||ne.level===r.level),yt(!X||Dm(r,ne)<=0),r&&!ne&&!s.updatingRootTiles)){const Ae=zp[k],Oe=r.findNeighborTile(Ae,ve=>ve.isLoaded||ve.isLeaf||ve.level===r.level);s.updatingRootTiles||(Oe?Oe.intersectsClippingArea&&(yt(!Oe.isLoaded),yt(!Oe.isLeaf),yt(Oe.level===r.level)):yt(B(s==null?void 0:s.rootTiles)||!r.shouldHaveNeighbor(Ae)))}const ye=lt(k===1?d:u,A,P),Te=lt(k===0?p:h,O,M),ce=he==null?void 0:he.samplerData,ae=g.outerEdges[k],le=e&&F>3?F-3:1,fe=lt(k===1?1:0,w,S),Ue=lt(k===0?1:0,C,E),ie=(Ae,Oe)=>ir(Ae,Oe,H),oe=(Ae,Oe)=>.5*(ir(Ae,Oe,ce)+ir(Ae,Oe,H)),we=X?oe:ie;if(a){const Ae=(d-u)/$,Oe=D?k===1?Ae:-Ae:0,ve=D?0:k===0?Ae:-Ae,ke=-Oe,be=-ve,$e=ae.attributes.position.typedBuffer,Le=ae.attributes.position.typedBufferStride,Ce=ae.index0,Be=ae.stride,He=Ce*Le;let Xe=$e[He+0]+L,Je=$e[He+1]+U,it=$e[He+2]+G,Qe=0,te=0,me=0;{const Ie=1/$,K=D?ye:lt(u*(1-Ie)+d*Ie,A,P),se=D?lt(h*(1-Ie)+p*Ie,O,M):Te,Me=we(K,se),De=K*_,Tt=b(se);Qe=De,te=Tt,me=Me}for(let Ie=1;Ie<F-1;Ie+=le){const K=Ie/$,se=Qe,Me=te,De=me;{const bi=D?fe:lt(K,w,S),xn=D?lt(K,C,E):Ue,As=se-L,jr=Me-U,ea=De-G;cl(se,jr,ea,x),ae.setVertexFromValuesRawPositionUV(Ie,As,jr,ea,bi,xn)}const Tt=Ie+1;if(Ie===F-1){const bi=(Ce+Tt*Be)*Le;Qe=$e[bi+0]+L,te=$e[bi+1]+U,me=$e[bi+2]+G}else{const bi=Tt/$,xn=D?ye:lt(u*(1-bi)+d*bi,A,P),As=D?lt(h*(1-bi)+p*bi,O,M):Te,jr=we(xn,As);Qe=xn*_,te=b(As),me=jr}const Zt=Qe,tn=te,vn=me,ui=Xe,di=Je,ze=it;Xe=se,Je=Me,it=De;let ft=0,Bt=0,Kt=0;if(D){{const bi=tn-Me,xn=di-Me;Bt-=xn*(ze-De)+bi*(vn-De),Kt+=xn*xn+bi*bi}{const bi=lt(h*(1-K)+p*K,O,M),xn=ye+ke,As=xn*_-se;if(ft-=As*(ir(xn,bi,H)-De),Kt+=As*As,X){const jr=ye+Oe,ea=jr*_-se;ft-=ea*(ir(jr,bi,ce)-De),Kt+=ea*ea}}}else{{const bi=Zt-se,xn=ui-se;ft-=bi*(vn-De)+xn*(ze-De),Kt+=bi*bi+xn*xn}{const bi=lt(u*(1-K)+d*K,A,P),xn=Te+be,As=ir(bi,xn,H)-De,jr=b(xn)-Me;if(Bt-=jr*As,Kt+=jr*jr,X){const ea=bi,Uc=Te+ve,ss=b(Uc)-Me;Bt-=ss*(ir(ea,Uc,ce)-De),Kt+=ss*ss}}}const wn=1/Math.sqrt(ft*ft+Bt*Bt+Kt*Kt);ae.setNormalFromValues(Ie,ft*wn,Bt*wn,Kt*wn)}}else for(let Ae=1;Ae<F-1;Ae+=le){const Oe=Ae/$,ve=D?ye:lt(u*(1-Oe)+d*Oe,A,P),ke=D?lt(h*(1-Oe)+p*Oe,O,M):Te,be=D?fe:lt(Oe,w,S),$e=D?lt(Oe,C,E):Ue,Le=we(ve,ke),Ce=ve*_-L,Be=b(ke)-U,He=Le-G;cl(Ce,Be,He,x),ae.setVertexFromValuesRawPositionUV(Ae,Ce,Be,He,be,$e)}}}function wme(i,e){Sme(i)}function Dyt(i,e){return(Math.PI/2-2*Math.atan(Math.exp(-i/e)))*e}function kyt(i,e){return i*e}function dH(i,e,t){return i?n=>Dyt(n,e):n=>kyt(n,t)}function xme(i,e,t,n,r,s){const a=e-1,o=i.vertexAttributes.count,l=2*(Math.min(e-2,n[1])-Math.max(1,n[0]))*(Math.min(e-2,r[1])-Math.max(1,r[0])),c=zp.map((x,w)=>w===0&&r[1]<e-2||w===1&&n[1]<e-2||w===2&&r[0]>1||w===3&&n[0]>1),u=i.outerEdges.reduce((x,w,C)=>x+(c[C]?0:a-2+w.count-1),0),d=t.reduce((x,w)=>x+a*(2*(w.latitudeResolution-1)+1),0),h=s?2:1,p=3*(l+u+d)*h,m=o>=byt?new Uint32Array(p):new Uint16Array(p);let g=0;const _=e-2,b=a-2;if(yt(b>=0),s){const x=(C,S,E)=>{m[g++]=C,m[g++]=S,m[g++]=S,m[g++]=E,m[g++]=E,m[g++]=C,fa&&(yt(C<o),yt(S<o),yt(E<o),yt(g<=p))};(()=>{for(let C=Math.max(r[0],1)-1;C<Math.min(r[1],e-2)-1;++C)for(let S=Math.max(n[0],1)-1;S<Math.min(n[1],e-2)-1;++S){const E=C*_+S,A=E+1,P=A+_,O=P-1;x(E,A,P),x(P,O,E)}})(),yt(g===3*l*h),(()=>{for(let C=0;C<4;++C){const S=g;if(c[C])continue;const E=i.outerEdges[C],A=i.innerEdges[C];let P=0,O=0;const M=E.count,V=A.count;yt(V===a-1);let L=0;const U=C===1||C===2?(G,H,k)=>x(G,H,k):(G,H,k)=>x(G,k,H);for(;P<M-1||O<V-1;){const G=A.getVertexIndex(O),H=E.getVertexIndex(P),k=P<M-1,D=O<V-1,$=k?0+a*(P+.5)/(M-1):0,F=D?1+b*(O+.5)/(V-1):0;k&&(!D||$<=F)?(++P,fa&&yt(P<M),U(G,H,E.getVertexIndex(P)),L++):(++O,fa&&yt(O<V),U(G,H,A.getVertexIndex(O)),L++)}fa&&(yt(P===M-1),yt(O===V-1),yt(L===M+V-2),yt(L===a-2+E.count-1),yt(g===S+3*L*h))}})(),yt(g===3*(l+u)*h);const w=C=>{const S=i.outerEdges[C.connectedOuterEdgeOffset];let E=S.getVertexIndex(0),A=S.stride;for(let P=0;P<C.latitudeResolution;++P){const O=P===0?C.rowOffset:E+e;for(let M=0;M<a;M++)x(E,E+1,O+M),P<C.latitudeResolution-1&&x(E+1,O+M+1,O+M),E+=A;E=O,A=1}};t.forEach(w)}else{(()=>{const w=Math.max(r[0],1)-1,C=Math.min(r[1],e-2)-1,S=Math.max(n[0],1)-1,E=Math.min(n[1],e-2)-1;for(let A=w;A<C;++A){const P=A*_;for(let O=S;O<E;++O){const M=P+O,V=M+1,L=V+_,U=L-1;m[g+0]=M,m[g+1]=V,m[g+2]=L,m[g+3]=L,m[g+4]=U,m[g+5]=M,g+=6}}})(),yt(g===3*l*h),(()=>{for(let w=0;w<4;++w){if(c[w])continue;const C=i.outerEdges[w],S=i.innerEdges[w];let E=0,A=0;const P=C.count,O=S.count;yt(O===a-1);const M=w===1||w===2,V=M?1:2,L=M?2:1,U=C.index0,G=C.stride,H=S.index0,k=S.stride;for(;E<P-1||A<O-1;){const D=H+A*k,$=U+E*G,F=E<P-1,Y=A<O-1,ne=F?0+a*(E+.5)/(P-1):0,X=Y?1+b*(A+.5)/(O-1):0,J=F&&(!Y||ne<=X);J?++E:++A;const he=J?$+G:D+k;m[g+0]=D,m[g+V]=$,m[g+L]=he,g+=3}}})(),yt(g===3*(l+u)*h);const x=w=>{const C=i.outerEdges[w.connectedOuterEdgeOffset];let S=C.getVertexIndex(0),E=C.stride;for(let A=0;A<w.latitudeResolution;++A){const P=A===0?w.rowOffset:S+e;for(let O=0;O<a;O++){const M=P+O;m[g+0]=S,m[g+1]=S+1,m[g+2]=M,A<w.latitudeResolution-1?(m[g+3]=S+1,m[g+4]=M+1,m[g+5]=M,g+=6):g+=3,S+=E}S=P,E=1}};t.forEach(x)}yt(g===p),i.indices=m,i.indexCount=p}function Cme(i,e){const t=i.localOrigin,n=i.geometryInfo,r=i.geometryState.neighborData.edgeResolutions,s=n.numVerticesPerSide-2,a=n.vertexAttributes;let o=e;for(let l=0;l<4;++l){{const c=l===0||l===2,u=(l===0?s-1:0)*s+(l===1?s-1:0),d=(c?0:1)*s+(c?1:0);n.innerEdges[l]=new IJ(a,t,u,d,s)}{const c=o,u=r[l]+1;n.outerEdges[l]=new IJ(a,t,c,1,u),o+=u}}}function Tme(i,e){const t=(e+2)%4,n=i.geometryState,r=i.tile,s=n.neighborData,a=Kv(r,s.edgePeerNeighbors[e]),o=r.level-a.level,l=e===1||e===3,c=s.edgeResolutions[e];yt(n2(c));const u=c+1,d=i.geometryInfo,h=d.boundingBox,p=d.outerEdges[e],m=d.uvRange[0],g=d.uvRange[1],_=d.uvRange[2],b=d.uvRange[3],x=lt(e===1?1:0,m,_),w=lt(e===0?1:0,g,b),C=a.renderData,S=C.geometryState,E=C.geometryInfo.outerEdges[t],A=r.getNeighborEdgeStartVertexIndex(e,a)*c,P=c*2**o;yt(S.neighborData.edgeResolutions[t]===P),yt(E.count-1===P);const O=C.localOrigin[0]-i.localOrigin[0],M=C.localOrigin[1]-i.localOrigin[1],V=C.localOrigin[2]-i.localOrigin[2],L=p.attributes,U=p.index0,G=p.stride,H=L.position.typedBuffer,k=L.position.typedBufferStride,D=L.normalCompressed.typedBuffer,$=L.normalCompressed.typedBufferStride,F=L.uv0,Y=E.attributes,ne=E.index0,X=E.stride,J=Y.position.typedBuffer,he=Y.position.typedBufferStride,ye=Y.normalCompressed.typedBuffer,Te=Y.normalCompressed.typedBufferStride;for(let ce=1;ce<u-1;++ce){const ae=U+G*ce,le=ne+X*(A+ce),fe=ae*k,Ue=le*he,ie=J[Ue+0]+O,oe=J[Ue+1]+M,we=J[Ue+2]+V;H[fe+0]=ie,H[fe+1]=oe,H[fe+2]=we,cl(ie,oe,we,h);const Ae=ae*$,Oe=le*Te;D[Ae+0]=ye[Oe+0],D[Ae+1]=ye[Oe+1];const ve=ce/c,ke=l?x:lt(ve,m,_),be=l?lt(ve,g,b):w;Fc(F,ae,ke,be)}}function Sme(i){var ae;const e=i.geometryState,t=e.neighborData,n=i.localOrigin,r=t.cornerNeighborData,s=i.geometryInfo,a=s.outerEdges,o=s.boundingBox,l=i.tile,c=((ae=i.tile.surface.view)==null?void 0:ae.viewingMode)==="local",u=l.ellipsoid.radius,d=l.extentInRadians,h=l.horizontalScale;let p=0,m=0,g=0,_=0,b=0,x=0;const w=(le,fe,Ue)=>{const ie=d[fe===0?1:3],oe=d[le===0?0:2],we=Math.cos(ie),Ae=Math.sin(ie),Oe=Math.sin(oe),ve=Math.cos(oe),ke=u+Ue;p=ve*we*ke,m=Oe*we*ke,g=Ae*ke},C=c?(()=>{const le=i.geometryState.clippingArea,fe=l.extent,Ue=T(le)&&(fe[3]>le[3]||fe[2]>le[2]||fe[1]<le[1]||fe[0]<le[0]),ie=dH(l.surface.isWebMercatorOnPlateeCarree,l.ellipsoid.radius,h);return(oe,we,Ae)=>{const Oe=oe===0?M[0]:M[2],ve=we===0?M[1]:M[3],ke=Ue?lt(Oe,le[0],le[2]):Oe,be=Ue?lt(ve,le[1],le[3]):ve,$e=Ae;p=ke*h,m=ie(be),g=$e}})():w;let S=0,E=0,A=0;const P=c&&i.tile.surface.isWebMercatorOnPlateeCarree,O=(le,fe,Ue,ie)=>{if(c){const oe=fe*h,we=P?(Math.PI/2-2*Math.atan(Math.exp(-Ue/u)))*u:Ue*h,Ae=oe-p,Oe=we-m,ve=ie-g;S+=-Ae*ve,E+=-Oe*ve,A+=Ae*Ae+Oe*Oe}else{const oe=uH(le),we=le.tile,Ae=we.extent,Oe=we.extentInRadians,ve=(fe-Ae[0])/(Ae[2]-Ae[0]),ke=(Ue-Ae[1])/(Ae[3]-Ae[1]),be=Oe[0]*(1-ve)+Oe[2]*ve,$e=oe(ke),Le=Math.cos($e),Ce=Math.sin($e),Be=Math.sin(be),He=Math.cos(be),Xe=u+ie,Je=He*Le*Xe-p,it=Be*Le*Xe-m,Qe=Ce*Xe-g,te=it*x-Qe*b,me=Qe*_-Je*x,Ie=Je*b-it*_;S+=me*Qe-Ie*it,E+=Ie*Je-te*Qe,A+=te*it-me*Je}},M=l.extent,V=e.clippingArea,L=T(V)?V:PD,U=M[0],G=M[2],H=M[1],k=M[3],D=[k>L[3],G>L[2],H<L[1],U<L[0]],$=Math.max(U,L[0]),F=Math.min(G,L[2]),Y=Math.max(H,L[1]),ne=Math.min(k,L[3]),X=s.uvRange[0],J=s.uvRange[1],he=s.uvRange[2],ye=s.uvRange[3],Te=l.surface.shading||mb,ce=le=>{var ke;if(!c){const be=1/Math.sqrt(p*p+m*m+g*g);_=p*be,b=m*be,x=g*be}const fe=r[le].cornerTiles;S=0,E=0,A=0;let Ue=1/0;for(let be=0;be<4;++be)Ue=Math.min(Ue,((ke=fe[be])==null?void 0:ke.level)??1/0);for(let be=0;be<4;++be){const $e=fe[be];eS[be]=($e==null?void 0:$e.level)===Ue?$e:null}let ie=1,oe=0;for(let be=0;be<4;++be){const $e=eS[be];$e&&(ie=Math.max(ie,$e==null?void 0:$e.renderData.geometryState.numVerticesPerSide),oe=$e.extent[2]-$e.extent[0])}const we=oe,Ae=ie;yt(Ae>1);const Oe=we/Ae;for(let be=0;be<4;++be){const $e=eS[(be+3)%4],Le=eS[(be+0)%4];if(!$e&&!Le)continue;const Ce=be===0?1:be===1?2:be===2?3:0,Be=be===0?2:be===1?3:be===2?0:1;if($e&&Le){const He=L4[be][0]*Oe,Xe=L4[be][1]*Oe,Je=$e.extent,it=Je[Ce===0||Ce===1?2:0]+He,Qe=Je[Ce===0||Ce===3?3:1]+Xe,te=Le.extent,me=te[Be===0||Be===1?2:0]+He,Ie=te[Be===0||Be===3?3:1]+Xe,K=$e.renderData,se=Le.renderData,Me=ir(it,Qe,K.geometryState.samplerData),De=ir(me,Ie,se.geometryState.samplerData);O(K,it,Qe,.5*(Me+De))}else{const He=$e??Le,Xe=$e?Ce:Be,Je=He.extent,it=L4[be],Qe=Je[Xe===0||Xe===1?2:0]+it[0]*Oe,te=Je[Xe===0||Xe===3?3:1]+it[1]*Oe,me=He.renderData,Ie=ir(Qe,te,me.geometryState.samplerData);O(me,Qe,te,Ie)}}const ve=1/Math.sqrt(S*S+E*E+A*A);S*=ve,E*=ve,A*=ve};for(let le=0;le<4;++le){const fe=le,Ue=(le+1)%4,ie=le===0||le===1?1:0,oe=le===0||le===3?1:0,we=lt(ie,X,he),Ae=lt(oe,J,ye),Oe=a[fe],ve=le===0||le===3?Oe.count-1:0,ke=a[Ue],be=le===0||le===1?ke.count-1:0,$e=r[le].cornerTiles;let Le=-1;for(let He=0;He<4;++He){const Xe=$e[He];Xe&&(Le===-1||Dm($e[Le],Xe)>0)&&(Le=He)}const Ce=Le,Be=$e[Ce];if(S=0,E=0,A=1,Be!==l){const He=l.level-Be.level,Xe=2**He,Je=[Be.lij[0]+He,Be.lij[1]*Xe,Be.lij[2]*Xe],it=[Je[1]+Xe===l.lij[1],le===0&&(Ce===1||Ce===0&&Be!==$e[3])||le===1&&(Ce===0||Ce===1&&Be!==$e[2]),Je[1]===l.lij[1]+1,le===2&&(Ce===3||Ce===2&&Be!==$e[1])||le===3&&(Ce===2||Ce===3&&Be!==$e[0])],Qe=it.reduce((se,Me)=>se+(Me?1:0),0);yt(Qe===1||Qe===2);let te=-1,me=-1;const Ie=Be.renderData;if(Qe===1){const se=it.findIndex(De=>De);yt(0<=se&&se<=3),te=(se+2)%4;const Me=i.geometryState.neighborData.edgeResolutions[se];me=l.getNeighborEdgeStartVertexIndex(se,Be)*Me+Me*(se===0&&le===0||se===1&&le===0||se===2&&le===1||se===3&&le===3?1:0)}else{yt(it[1]||it[3]),te=it[1]?3:1;const se=Ie.geometryState.neighborData.edgeResolutions[te];me=le===0||le===3?0:se}const K=Ie.geometryInfo.outerEdges[te];{const se=Oe.index0+ve*Oe.stride,Me=ke.index0+be*ke.stride,De=K.index0+me*K.stride;{const Tt=K.attributes.position,Zt=Tt.typedBuffer,tn=De*Tt.typedBufferStride,vn=i.localOrigin,ui=K.localOrigin,di=Zt[tn+0]+ui[0]-vn[0],ze=Zt[tn+1]+ui[1]-vn[1],ft=Zt[tn+2]+ui[2]-vn[2];cl(di,ze,ft,o);{const Bt=Oe.attributes.position,Kt=Bt.typedBuffer,wn=se*Bt.typedBufferStride;Kt[wn+0]=di,Kt[wn+1]=ze,Kt[wn+2]=ft}{const Bt=ke.attributes.position,Kt=Bt.typedBuffer,wn=Me*Bt.typedBufferStride;Kt[wn+0]=di,Kt[wn+1]=ze,Kt[wn+2]=ft}}Fc(Oe.attributes.uv0,se,we,Ae),Fc(ke.attributes.uv0,Me,we,Ae);{const Tt=K.attributes.normalCompressed.typedBuffer,Zt=De*K.attributes.normalCompressed.typedBufferStride;{const tn=Oe.attributes.normalCompressed,vn=tn.typedBuffer,ui=se*tn.typedBufferStride;vn[ui+0]=Tt[Zt+0],vn[ui+1]=Tt[Zt+1]}{const tn=ke.attributes.normalCompressed,vn=tn.typedBuffer,ui=Me*tn.typedBufferStride;vn[ui+0]=Tt[Zt+0],vn[ui+1]=Tt[Zt+1]}}}}else{const He=D[fe],Xe=D[Ue];let Je;if(He||Xe){const me=lt(U*(1-ie)+G*ie,$,F),Ie=lt(H*(1-oe)+k*oe,Y,ne),K=e.samplerData;Je=ir(me,Ie,K)}else Je=Fyt($e);C(ie,oe,Je),(Te||mb)&&ce(le);const it=p-n[0],Qe=m-n[1],te=g-n[2];cl(it,Qe,te,o),Oe.setVertexFromValuesRawPositionUVNormal(ve,it,Qe,te,we,Ae,S,E,A),ke.setVertexFromValuesRawPositionUVNormal(be,it,Qe,te,we,Ae,S,E,A)}}for(let le=0;le<4;++le)eS[le]=null}function Fyt(i){var s,a;const e=i.reduce((o,l)=>Math.min(o,(l==null?void 0:l.level)??1/0),1/0);fa&&(yt(!i[0]||!i[2]||d8(i[0],i[2],ei.SOUTH_WEST)),yt(!i[1]||!i[3]||d8(i[1],i[3],ei.NORTH_WEST)));let t=0,n=0;for(let o=0;o<4;++o){const l=i[o];if(l&&l.level===e){const c=o===0||o===1,u=o===0||o===3,d=l.extent,h=d[c?0:2],p=d[u?1:3],m=(a=(s=l.renderData)==null?void 0:s.geometryState)==null?void 0:a.samplerData;n+=ir(h,p,m),t++}}const r=t?n/t:0;return yt(r!=null),r}function MD(i){const e=i.vao,t=i.geometryInfo.vertexAttributes.position.typedBuffer;e.vertexBuffers.geometry.setSubData(t,0,0,t.length)}const L4=[[0,1],[1,0],[0,-1],[-1,0]],ws=new Avt,PD=sne(-1/0,-1/0,1/0,1/0),eS=[null,null,null,null];function Eme(i,e,t){if(!e)return!1;const n=Dm(i,e);return n>0||n===0&&t<2}const mb=!0;let Nyt=class extends sH{constructor(e,t,n){super(),this._horizontalScaleFactor=1,this._extentInRenderSR=qi(),e!==void 0&&this.init(e,t,n)}get horizontalScale(){return this._horizontalScaleFactor}init(e,t,n){super.init(e,t,n);const r=n.view.renderSpatialReference,s=n.spatialReference,a=T(r)&&pie(r)&&T(s)&&s.isGeographic?this.ellipsoid.radius*Math.PI/180:1;this._horizontalScaleFactor=a;const o=this.surface.isWebMercatorOnPlateeCarree,l=this._extentInRenderSR,c=this.extent;if(o){const u=Gt(c[0],c[1],0);no(u,$n.WebMercator,u,$n.PlateCarree);const d=Gt(c[2],c[3],0);no(d,$n.WebMercator,d,$n.PlateCarree),l[0]=u[0],l[1]=u[1],l[2]=d[0],l[3]=d[1]}else for(let u=0;u<4;++u)l[u]=c[u]*a;this.centerAtSeaLevel[0]=.5*(l[0]+l[2]),this.centerAtSeaLevel[1]=.5*(l[1]+l[3]),this.centerAtSeaLevel[2]=0,this._edgeLen=Math.max(l[2]-l[0],l[3]-l[1]),this._edgeLen2=this._edgeLen*this._edgeLen,this.updateRadiusAndCenter()}updateRadiusAndCenter(){this._updateCenter();const e=this._extentInRenderSR,t=.5*(e[2]-e[0]),n=.5*(e[3]-e[1]),r=Math.sqrt(t*t+n*n),s=.5*(this.elevationBounds[0]-this.elevationBounds[1]),a=Math.max(r,s);this._center[rl.MIDDLE][3]=a}_calculateFrustumVisibilityStatus(e){const t=this._aabb(),n=t[0],r=t[1],s=t[2],a=t[3],o=t[4],l=t[5];let c=!0;for(let u=0;u<6;u++){const d=e[u],h=d[0],p=d[1],m=d[2],g=d[3];if(h*(h>0?n:a)+p*(p>0?r:o)+m*(m>0?s:l)+g>=0)return Eo.OUTSIDE;c=c&&h*(h<0?n:a)+p*(p<0?r:o)+m*(m<0?s:l)+g<=0}return c?Eo.INSIDE:Eo.INTERSECTS}_aabb(){const e=this._extentInRenderSR;return V1e(e[0],e[1],this.elevationBounds[0],e[2],e[3],this.elevationBounds[1])}intersectsRay(e,t,n,r){return wO[0]=1/t[0],wO[1]=1/t[1],wO[2]=1/t[2],Dne(this._aabb(),e,wO,n,r)}createGeometry(){Pyt(this.renderData,this._horizontalScaleFactor),this.setMemoryDirty()}getDefaultVerticesPerRowOnLevel(){return this.level<9?3:2}updateCornerElevations(){$yt(this.renderData,this._horizontalScaleFactor)}updateEdgeElevations(){Lyt(this.renderData,this._horizontalScaleFactor)}};const wO=q();var OA;(function(i){i[i.BACK_TO_FRONT=-1]="BACK_TO_FRONT",i[i.NONE=0]="NONE",i[i.FRONT_TO_BACK=1]="FRONT_TO_BACK"})(OA||(OA={}));let Vyt=class extends sH{constructor(e,t,n){super(),this._obb=new Array(8);for(let r=0;r<8;r++)this._obb[r]=q();e!==void 0&&this.init(e,t,n)}init(e,t,n){super.init(e,t,n);const r=this.ellipsoid.radius,s=this.extentInRadians[0],a=this.extentInRadians[1],o=this.extentInRadians[2],l=this.extentInRadians[3],c=e[0],u=ki(a,l,.5),d=ki(s,o,.5),h=c===0?0:Math.min(Math.abs(a),Math.abs(l));this._edgeLen=(o-s)*Math.cos(h)*r,this._edgeLen2=this._edgeLen*this._edgeLen,this._curvatureHeight=r-Math.sqrt(r*r-this._edgeLen2/4),lT(this.centerAtSeaLevel,d,u,this.ellipsoid.radius);const p=gu(this.centerAtSeaLevel);mt(p,p),this.up=p,this._updateOBB(),this.updateRadiusAndCenter()}updateRadiusAndCenter(){if(this.lij[0]===0)je(this._center[eh.MIDDLE],0,0,0),je(this._center[eh.TOP],0,0,0),je(this._center[eh.BOTTOM],0,0,0),this.ellipsoid||(this.ellipsoid=rn(this.surface.spatialReference)),this._center[eh.MIDDLE][3]=this.ellipsoid.radius+this.elevationBounds[1];else{this._updateCenter();const e=Math.max(Fo(this._center[eh.MIDDLE],this._obb[0]),Fo(this._center[eh.MIDDLE],this._obb[1]));this._center[eh.MIDDLE][3]=Math.sqrt(e)}}_calculateFrustumVisibilityStatus(e){if(!e3(e,this._center[eh.MIDDLE]))return Eo.OUTSIDE;if(this.lij[0]<10)return Eo.INTERSECTS;const t=this._obb,n=this.surface.view.state.camera.near;let r=!0;for(let s=0;s<O1e.NUM;s++){const a=s===Jr.NEAR,o=e[s],l=o[0],c=o[1],u=o[2],d=o[3]-(a?n:0);let h=!1;for(let p=0;p<8;++p){const m=t[p];if(l*m[0]+c*m[1]+u*m[2]+d<0){if(h=!0,!r)break}else r=!1}if(!h)return Eo.OUTSIDE}return r?Eo.INSIDE:Eo.INTERSECTS}computeElevationBounds(){super.computeElevationBounds(),this._updateOBB()}createGeometry(){const e=this._getPatchType(this.lij[1],this.lij[0]);wyt(this.renderData,e),this.setMemoryDirty()}_updateOBB(){const e=this.extentInRadians,t=this._obb;for(let n=0;n<2;n++){const r=this.elevationBounds[n];let s=4*n;lT(t[s++],e[0],e[1],this.ellipsoid.radius+r),lT(t[s++],e[0],e[3],this.ellipsoid.radius+r),lT(t[s++],e[2],e[3],this.ellipsoid.radius+r),lT(t[s++],e[2],e[1],this.ellipsoid.radius+r)}if(this.surface.isWebMercator)switch(this._getPatchType(this.lij[1],this.lij[0])){case cd.HAS_NORTH_POLE:je(t[1],0,0,this.ellipsoid.radius),je(t[2],0,0,this.ellipsoid.radius),je(t[5],0,0,this.ellipsoid.radius),je(t[6],0,0,this.ellipsoid.radius);break;case cd.HAS_SOUTH_POLE:je(t[0],0,0,-this.ellipsoid.radius),je(t[3],0,0,-this.ellipsoid.radius),je(t[4],0,0,-this.ellipsoid.radius),je(t[7],0,0,-this.ellipsoid.radius)}}_getPatchType(e,t){return e===(1<<t)-1?e===0?cd.HAS_BOTH_POLES:cd.HAS_SOUTH_POLE:e===0?cd.HAS_NORTH_POLE:cd.REGULAR}intersectsRay(e,t,n,r){const s=this._center[eh.MIDDLE],a=s[3]+n,o=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],l=s[0]-e[0],c=s[1]-e[1],u=s[2]-e[2],d=(l*t[0]+c*t[1]+u*t[2])/o,h=t[0]*d-l,p=t[1]*d-c,m=t[2]*d-u;return h*h+p*p+m*m<a*a}getDefaultVerticesPerRowOnLevel(){return this.level<WJ.length?WJ[this.level]+1:2}updateCornerElevations(){Eyt(this.renderData)}updateEdgeElevations(){Syt(this.renderData)}};const WJ=[128,64,32,16,16,8,8,4];var eh;(function(i){i[i.TOP=0]="TOP",i[i.MIDDLE=1]="MIDDLE",i[i.BOTTOM=2]="BOTTOM"})(eh||(eh={}));let Byt=class{constructor(){this.extent=Dn(),this.minLevel=0,this.maxLevel=0,this.callback=null}},zyt=class{constructor(){this._queries=new pn({initialSize:10}),this._queriesInvPtr=0,this._queryQueue=new pn({initialSize:30}),this._queryPool=new Ic(Byt)}queryVisibleLevelRange(e,t,n,r){const s=this._queryPool.acquire();Em(s.extent,e),s.minLevel=t||-Number.MAX_VALUE,s.maxLevel=n??Number.MAX_VALUE,s.callback=r,this._queryQueue.push(s)}hasPendingQueries(){return this._queryQueue.length!==0}prepareQueries(){for(;this._queries.length<this._queries.data.length&&this._queryQueue.length>0;){const e=this._queryQueue.pop();this._queries.push(e)}this._queriesInvPtr=this._queries.length}processQueries(){for(let e=0;e<this._queries.length;e++){const t=this._queries.data[e];this._queryPool.release(t),t.callback(e>=this._queriesInvPtr),t.callback=null}this._queries.clear()}scaleQueriesForTile(e){const t=e.level;let n=0;for(;n<this._queriesInvPtr;){const r=this._queries.data[n],s=r.extent;t>=r.minLevel&&t<=r.maxLevel&&s[0]<=e.extent[2]&&s[2]>=e.extent[0]&&s[1]<=e.extent[3]&&s[3]>=e.extent[1]?(this._queries.swapElements(n,this._queriesInvPtr-1),this._queriesInvPtr--):n++}}},Ame=class extends ic{constructor(){super(...arguments),this.blendMode=Ct.Normal}};f([Pe({count:Ct.COUNT})],Ame.prototype,"blendMode",void 0);let Qw=class extends Ame{constructor(){super(...arguments),this.output=Hs.Composite,this.baseOpacityMode=yh.NotRequired,this.premultipliedSource=ih.Off,this.hasWebGL2Context=!1}};f([Pe({count:Hs.COUNT})],Qw.prototype,"output",void 0),f([Pe({count:yh.COUNT})],Qw.prototype,"baseOpacityMode",void 0),f([Pe()],Qw.prototype,"premultipliedSource",void 0),f([Pe()],Qw.prototype,"hasWebGL2Context",void 0);var gb;function Uyt(i){const e=new Nr;if(e.include(ume),i.background===gb.Only){const t=i.output===Hs.ColorComposite;return t?e.fragment.uniforms.add(new Io("backgroundColor",n=>n.backgroundColor)):(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.include(rH)),e.fragment.code.add(ee`
    void main() {
      gl_FragColor = ${t?ee`vec4(backgroundColor, 1.0)`:ee`gridColor(uv)`};
    }
  `),e}return e.include(dme,i),e.fragment.uniforms.add(new sn("tex",t=>t.texture)),e.fragment.uniforms.add(new Hi("opacity",t=>t.opacity)),e.fragment.code.add(ee`void main() {
vec4 bgColor = getBackground(uv);
gl_FragColor = blendLayers(bgColor, texture2D(tex, uv), opacity);
}`),e}(function(i){i[i.BelowLayer=0]="BelowLayer",i[i.Only=1]="Only",i[i.COUNT=2]="COUNT"})(gb||(gb={}));const Hyt=Object.freeze(Object.defineProperty({__proto__:null,get BackgroundMode(){return gb},build:Uyt},Symbol.toStringTag,{value:"Module"}));let Gyt=class extends cme{constructor(){super(...arguments),this.opacity=1,this.baseOpacity=1,this.texture=null,this.fboTexture=null,this.backgroundColor=wd}},hH=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,hH.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:vf(vt.ONE,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i})}};hH.shader=new bn(Hyt,()=>Ee(()=>import("./BlendLayers.glsl-ab283d41.js"),["./BlendLayers.glsl-ab283d41.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2f64-30dc1443.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let Mme=class extends Qw{constructor(){super(...arguments),this.background=gb.BelowLayer}};f([Pe()],Mme.prototype,"background",void 0);let D4=class{constructor(e,t,n,r,s,a){this.texture=e,this.type=t,e.retain(),this.offsetAndScale=Xn(n.offset[0],n.offset[1],n.scale,n.scale),this.opacities=Gt(r,s,a)}destroy(){this.texture.release()}};const Wyt=.125;let jyt=class{constructor(){this._renderParams={context:null,drawPhase:1,state:new t6({viewpoint:new ga({targetGeometry:new Wt(0,0),scale:1,rotation:0}),size:[256,256]}),stationary:!0,pixelRatio:1,displayLevel:-1,requiredLevel:-1,globalOpacity:1,renderPass:"background",styleLayer:null,styleLayerUID:-1,painter:null,glyphMosaic:null,spriteMosaic:null,profiler:null,renderingOptions:null,requestRender:null,allowDelayedRender:!1,deltaTime:-1,timeline:null,time:0,hasClipping:!1,blendMode:null,dataUploadCounter:0,effects:null,inFadeTransition:!1,requireFBO:!1}}dispose(){this._renderParams=null}render(e,t,n,r,s,a,o,l,c,u){const d=a.adjustLevel(t[0]),h=this._renderParams;h.context=e,h.painter=r,h.glyphMosaic=r.glyphMosaic,h.spriteMosaic=r.spriteMosaic,h.pixelRatio=u,h.displayLevel=d,h.requiredLevel=d;const p=a.getScale(t[0]),[m,g]=a.getShift(t,o*p),_=Wyt*o*p/c,b=n.transforms.dvs;b[0]=_,b[4]=-_,b[6]=-1-m-l[0]*o*2,b[7]=1+g+(1-l[1])*o*2-2,h.state.size[0]=c,h.state.size[1]=c,n.stage||n.attachWithContext(e),n.triangleCount=0,r.drawTile(h,n,s)}},pH=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,pH.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:vf(vt.ONE,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i})}};pH.shader=new bn(Kvt,()=>Ee(()=>import("./RasterColorizer.glsl-8d06f3c6.js"),["./RasterColorizer.glsl-8d06f3c6.js","./vec3f64-2f9cef06.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let gI=class extends Qw{constructor(){super(...arguments),this.colorizerType=j0.Stretch,this.stretchType=fb.Noop,this.applyColormap=!0}};f([Pe({count:j0.COUNT})],gI.prototype,"colorizerType",void 0),f([Pe({count:fb.COUNT})],gI.prototype,"stretchType",void 0),f([Pe()],gI.prototype,"applyColormap",void 0);let jJ=class{constructor(e){this._rctx=e,this._fbos=new Map}get(e){return this._getPool(e)}dispose(){this._fbos.forEach(e=>e.dispose()),this._fbos.clear()}_getPool(e){const t=this._fbos.get(e);if(t)return t;const n=new ma(this._rctx,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.DEPTH_RENDER_BUFFER,width:e,height:e});return this._fbos.set(e,n),n}};const qyt=tt.getLogger("esri.views.3d.terrain");let Kyt=class{constructor(e,t){this._rctx=e,this._techniqueRepository=t,this._fbos=[],this._vectorTileHelper=new jyt,this._bindParameters=new nD(null,null,null),this._blendLayersTechniqueConfig=new Mme,this._current=0,this._lastUsedIds=new Array,this._lastCreatedBufferId=0,this._onHoldIds=new Array,this._vaoQuad=tc(this._rctx,KA)}dispose(){this._fbos.forEach(e=>{e.dispose(),e=null}),this._fbos=null,this._vtFBO=Ht(this._vtFBO),this._vaoQuad=Ht(this._vaoQuad),this._vectorTileHelper=Ht(this._vectorTileHelper),this._backgroundTechnique=Lr(this._backgroundTechnique),this._applyOpacityTechnique=Lr(this._applyOpacityTechnique),this._blendLayersTechnique=Lr(this._blendLayersTechnique)}_getBlendLayersTechnique(e,t,n,r=ih.Off,s=gb.BelowLayer){return this._blendLayersTechniqueConfig.output=t,this._blendLayersTechniqueConfig.blendMode=e,this._blendLayersTechniqueConfig.baseOpacityMode=n,this._blendLayersTechniqueConfig.premultipliedSource=r,this._blendLayersTechniqueConfig.background=s,this._blendLayersTechnique=this._techniqueRepository.releaseAndAcquire(hH,this._blendLayersTechniqueConfig,this._blendLayersTechnique),this._blendLayersTechnique}drawBackground(e,t){const n=this._getBlendLayersTechnique(Ct.Normal,t?Hs.ColorComposite:Hs.GridComposite,yh.NotRequired,ih.Off,gb.Only),r=this._rctx.bindTechnique(n,e,this._bindParameters);this._render(r)}_render(e){this._rctx.bindVAO(this._vaoQuad),e.assertCompatibleVertexAttributeLocations(this._vaoQuad),this._rctx.drawArrays(Qi.TRIANGLE_STRIP,0,al(this._vaoQuad,"geometry"))}drawGroup(e,t,n,r,s,a=ih.On){t===Hs.Composite&&(e.fboTexture=this._fbos[this.getLastOnHoldId()].get(n).colorTexture),e.texture=this.currentFBO(n).colorTexture,this.closeGroup(n);const o=this._getBlendLayersTechnique(r,t,s,a),l=this._rctx.bindTechnique(o,e,this._bindParameters);this._render(l)}drawRasterData(e,t,n,r,s,a=ih.Off){if(B(e.texture))return;e.fboTexture=t===Hs.GroupBackgroundComposite||r===Ct.Normal&&s===yh.NotRequired&&a===ih.Off?null:this.switch(n).colorTexture;const o=this._getBlendLayersTechnique(r,t,s,a),l=this._rctx.bindTechnique(o,e,this._bindParameters);this._render(l)}drawImageryTileData(e,t,n,r,s,a){const o=a.sourceLayerInfo.data;if(!o.source||(a.tile.surface.layerViewByIndex(a.layerIndex,Li.MAP).ensureSymbolizerParameters(o),!o.bind(this._rctx)))return;e.fboTexture=r===Ct.Normal&&s===yh.NotRequired?null:this.switch(n).colorTexture;const l=this._getRasterColorizerTechnique(o,t,r,s);o.opacity=e.opacity;const c=o.getUniforms();c.scale=a.scale,c.offset=a.offset,c.backgroundColor=e.backgroundColor,c.fboTexture=e.fboTexture,c.baseOpacity=e.baseOpacity;const u=this._rctx.bindTechnique(l,c,null);this._render(u)}_getRasterColorizerTechnique(e,t,n,r){const s=e.symbolizerParameters,a=["stretch","lut","hillshade"].indexOf(s.type);return B(this._rasterColorizerConfig)&&(this._rasterColorizerConfig=new gI,this._rctx.gl.getExtension("WEBGL_color_buffer_float"),this._rctx.gl.getExtension("OES_texture_float")),this._rasterColorizerConfig.output=t,this._rasterColorizerConfig.blendMode=n,this._rasterColorizerConfig.baseOpacityMode=r,this._rasterColorizerConfig.colorizerType=a,this._rasterColorizerConfig.applyColormap=!!s.colormap,this._rasterColorizerConfig.stretchType=e.hasStretchTypeNone()?fb.Noop:fb.PerBand,this._rasterColorizerTechnique=this._techniqueRepository.releaseAndAcquire(pH,this._rasterColorizerConfig,this._rasterColorizerTechnique),this._rasterColorizerTechnique}drawVectorData(e,t,n,r,s,a,o,l,c){const u=this._rctx,d=a.sourceLayerInfo.data,h=a.tile.surface.layerViewByIndex(a.layerIndex,Li.MAP),p=s===yh.Required||e.opacity<1||r!==Ct.Normal||t!==Hs.Composite,m=p?ih.On:ih.Off;this._getBlendLayersTechnique(r,t,s,m).bindPipelineState(u);let g=null,_=null;p?(_=this.currentFBO(n),B(this._vtFBO)&&(this._vtFBO=new jJ(this._rctx)),g=this._vtFBO.get(n),u.bindFramebuffer(g),this._clearCurrentFBO()):c&&u.clearSafe(hr.DEPTH_BUFFER_BIT);try{this._vectorTileHelper.render(u,a.sourceLod,d,h.painter,h.layer.styleRepository,h.schemaHelper,Math.round(1/a.scale),a.offset,l,o)}catch(b){qyt.warnOnce("A render call containing vector tiles did not resolve correctly.",b)}return!T(g)||(u.bindFramebuffer(_),e.texture=g.colorTexture,e.offset=Z0,e.scale=1,this.drawRasterData(e,t,n,r,s,m),c)}copyFBOToTexture(e){const t=this._rctx,n=t.bindTexture(e.texture,Er.TEXTURE_UNIT_FOR_UPDATES),r=e.descriptor;t.gl.copyTexImage2D(Wn.TEXTURE_2D,0,r.pixelFormat,0,0,r.width,r.height,0),e.generateMipmap(),t.bindTexture(n,Er.TEXTURE_UNIT_FOR_UPDATES)}_clearCurrentFBO(){this._rctx.setClearColor(0,0,0,0),this._rctx.setClearDepth(1),this._rctx.clearSafe(hr.COLOR_BUFFER_BIT|hr.DEPTH_BUFFER_BIT)}_initFBO(e,t,n){this._rctx.bindFramebuffer(e),n&&(this._rctx.setViewport(0,0,t,t),this._clearCurrentFBO())}ensureBuffer(e){this._lastUsedIds.length=0,this._lastUsedIds.push(1),this._lastCreatedBufferId=1,this._onHoldIds.length=0,this.bind(e)}bind(e,t=0,n=!0){if(this._current=t,t>=this._fbos.length)for(let r=this._fbos.length;r<=t;r++)this._fbos.push(new jJ(this._rctx));this._initFBO(this._fbos[t].get(e),e,n)}_bindNextFreeBuffer(e){this._lastUsedIds.length>0?this.bind(e,this._lastUsedIds.pop()):(this._lastCreatedBufferId++,this.bind(e,this._lastCreatedBufferId))}openGroup(e){this._onHoldIds.push(this._current),this._bindNextFreeBuffer(e)}switch(e){const t=this.currentFBO(e),n=this._current;return this._bindNextFreeBuffer(e),this._lastUsedIds.push(n),t}getLastOnHoldId(){return this._onHoldIds[this._onHoldIds.length-1]}closeGroup(e){const t=this._current;this._bindNextFreeBuffer(e),this._lastUsedIds.push(t),this._lastUsedIds.push(this._onHoldIds.pop())}unbind(){this._rctx.bindFramebuffer(null)}currentFBO(e){return this._fbos[this._current].get(e)}},Yyt=class{constructor(e,t,n,r){this.start=e,this.end=t,this.blendMode=n,this.opacity=r}},Xyt=class{constructor(e,t,n){this._rctx=e,this.tileSize=t,this._techniqueRepository=n,this._passParameters=new Gyt,this._backgroundTexture=null,this._backgroundColor=null,this._backgroundDirty=!1,this._blackTex=null,this._maxAnisotropy=this._rctx.parameters.maxMaxAnisotropy,this._composition=new Kyt(this._rctx,this._techniqueRepository),this._blackTex=new vw(Mbe(this._rctx,[0,0,0,1])),this._ensureBackgroundTexture(this.tileSize)}dispose(){this._composition=Ht(this._composition),this._backgroundTexture=Lr(this._backgroundTexture),this._blackTex=Lr(this._blackTex)}get backgroundIsGrid(){return B(this._backgroundColor)}get backgroundColor(){return this._backgroundColor}updateTileTexture(e,t){if(!e.renderData)return;const n=e.surface,r=n.baseOpacity;let s=0,a=0,o=this.tileSize,l=!1;const c=n.view.state.pixelRatio;let u=!1;NE.clear(),L1.length=0;const d=e.layerInfo[Li.MAP];let h=d.length,p=0;for(;p<d.length;p++){const _=n.layerViewByIndex(p,Li.MAP),b=_.layer.opacity;qJ[p]=b;const x=_.fullOpacity;if(KJ[p]=x,vne(_.layer)&&h>=d.length&&(h=p),pL(_)){YJ[p]=_.layer.blendMode;let C=_.layer.blendMode!=="normal";if(xC(_.layer.parent)){const S=p8(_.layer.parent);T(S)&&S!==""&&(C=Pme(_.layer.parent)||C)}C&&(u=C,l=!1)}if(b===0&&!u){d[p].pendingUpdates&=~(Qt.TEXTURE_NOFADING&Qt.TEXTURE_FADING);continue}++a;const w=k4(e,p);if(w){if(d[p].pendingUpdates&=~(Qt.TEXTURE_NOFADING&Qt.TEXTURE_FADING),xC(_.layer.parent)){const C=p8(_.layer.parent);T(C)&&C!==""&&Ome(_.layer.parent,p)}EA(_)?o=Math.max(o,this.tileSize*c):r===1&&x===1&&(_.isOpaque||this._dataToTexture(w)&&w.sourceLayerInfo.data.descriptor.isOpaque)&&(l=!0),++s}}o=Zyt(o);const m=o/this.tileSize,g=p-1;this._ensureBackgroundTexture(this.tileSize),s!==0?s===1&&!u&&this._useLayerTexture(e,g,h,KJ[g])||this._composeMapLayers(e,t,g,h,qJ,YJ,o,m,!l||u,NE,u):this._useBackgroundTexture(e,a)}_ensureBackgroundTexture(e){B(this._backgroundTexture)&&(this._backgroundTexture=this._buildTexture(e),this._backgroundDirty=!0),this._backgroundDirty&&(this._composition.bind(e),this._passParameters.offset=Z0,this._passParameters.scale=1,this._passParameters.opacity=1,T(this.backgroundColor)&&(this._passParameters.backgroundColor=this.backgroundColor),this._composition.drawBackground(this._passParameters,T(this.backgroundColor)),this._composition.copyFBOToTexture(this._backgroundTexture),this._composition.unbind(),this._backgroundDirty=!1)}_useBackgroundTexture(e,t){let n=Lm.Immediate;(e.surface.view.layerViewManager.updating||t>0)&&(n=Lm.Delayed),this._backgroundTexture&&B(e.renderData.textureReference)&&(n=Lm.Immediate),e.renderData.setTextureReference(T(this._backgroundTexture)?new D4(this._backgroundTexture,ha.FADING,XJ,e.surface.baseOpacity,0,1):null,n)}_useLayerTexture(e,t,n,r){const s=t<n,a=s?1:e.surface.baseOpacity,o=s?e.surface.baseOpacity:1,l=k4(e,t);return!!this._dataToTexture(l)&&(e.renderData.setTextureReference(new D4(l.sourceLayerInfo.data,ha.FADING,l,a,o,r)),!0)}_composeMapLayers(e,t,n,r,s,a,o,l,c,u,d){this._composition.ensureBuffer(o);const h=e.surface.baseOpacity;let p=!1,m=fn.LINEAR_MIPMAP_LINEAR,g=!1,_=0;for(let x=n;x>=0;x--){const w=k4(e,x);if(!w||s[x]===0&&!d)continue;const C=x<r&&h<1&&!p;this._passParameters.baseOpacity=C?h:1;const S=this._passParameters.baseOpacity<1?yh.Required:yh.NotRequired;C&&(p=!0);let E=!1;u.forEach(M=>{M.start===x&&(L1.push(M),this._composition.openGroup(o),E=!0)});const A=_===0,P=E?Hs.GroupBackgroundComposite:c&&A?this.backgroundIsGrid?Hs.GridComposite:Hs.ColorComposite:Hs.Composite,O=u8[a[x]];for(Pgt(w)?(this._passParameters.opacity=s[x],g=this._composition.drawVectorData(this._passParameters,P,o,O,S,w,l,this.tileSize,g)):Mgt(w)?(this._passParameters.opacity=s[x],this._composition.drawImageryTileData(this._passParameters,P,o,O,S,w),this._hasNearestInterpolation(w)&&(m=fn.NEAREST)):this._dataToTexture(w)&&(this._passParameters.texture=w.sourceLayerInfo.data.texture,this._passParameters.offset=w.offset,this._passParameters.scale=w.scale,this._passParameters.opacity=s[x],this._composition.drawRasterData(this._passParameters,P,o,O,S));L1.length>0&&L1[L1.length-1].end===x;){const M=L1.pop();this._passParameters.opacity=M.opacity,this._passParameters.offset=Z0,this._passParameters.scale=1;const V=c&&A?this.backgroundIsGrid?Hs.GridComposite:Hs.ColorComposite:Hs.Composite;this._composition.drawGroup(this._passParameters,V,o,u8[M.blendMode],S)}_++}const b=e.renderData.ensureTexture(o,()=>this._buildTexture(o,m));this._composition.copyFBOToTexture(b),this._composition.unbind(),e.renderData.setTextureReference(new D4(b,t,XJ,p?1:h,0,1))}_hasNearestInterpolation(e){const t=e.sourceLayerInfo.data;return!!t.source&&t.interpolation==="nearest"}_dataToTexture(e){if(Rgt(e)){const t=e.sourceLayerInfo;t.data=this._buildTexture(t.data),e.tile.setMemoryDirty()}return Ogt(e)}setBackground(e){this._backgroundColor!==e&&(this._backgroundColor=e,this._backgroundDirty=!0)}_buildTexture(e,t=fn.LINEAR_MIPMAP_LINEAR){if(B(e))return null;const n={target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:t,maxAnisotropy:this._maxAnisotropy,flipped:!0,hasMipmap:!0},r=this._rctx;let s;if(typeof e=="number")n.width=n.height=e,s=new vw(new Er(r,n));else if(e instanceof CD)n.isOpaque=e.isOpaque,s=new vw(new Er(r,n,e.image)),e.release();else try{n.width=e.width,n.height=e.height,s=new vw(new Er(r,n,e))}catch{s=new vw(kne(r)),console.warn("TileRenderer: failed to execute 'texImage2D', cross-origin image may not be loaded.")}const a=r.bindTexture(s.texture,Er.TEXTURE_UNIT_FOR_UPDATES);return s.generateMipmap(),r.bindTexture(a,Er.TEXTURE_UNIT_FOR_UPDATES),s}get test(){return{backgroundTexture:this._backgroundTexture}}};function Zyt(i){const e=cB(i),t=e*e,n=i*i;if(t===n)return i;const r=e/2;return t-n<n-r*r?e:r}function k4(i,e){Xc.layerIndex=e;const t=i.layerInfo[Li.MAP][e];if(T(t.data))return Bi(Xc.offset,0,0),Xc.tile=i,Xc.scale=1,Xc.sourceLod=i.lij,Xc.sourceLayerInfo=t,Xc;const n=t.upsampleInfo;if(T(n)){const r=n.tile.layerInfo[Li.MAP][e];return Xc.tile=n.tile,Zs(Xc.offset,n.offset),Xc.scale=n.scale,Xc.sourceLod=n.tile.lij,Xc.sourceLayerInfo=r,Xc}return null}function p8(i){return i.get("uid")}function Pme(i){let e=i.blendMode!=="normal";return xC(i.parent)&&(e=Pme(i.parent)||e),e}function Ome(i,e){xC(i.parent)&&Ome(i.parent,e);const t=p8(i);T(t)&&t!==""&&(NE.has(t)?NE.get(t).start=e:NE.set(t,new Yyt(e,e,i.blendMode,i.opacity)))}const qJ=new Array,KJ=new Array,YJ=new Array,NE=new Map,L1=new Array,Xc={tile:null,sourceLayerInfo:null,sourceLod:null,offset:[0,0],scale:1,layerIndex:0},XJ={offset:[0,0],scale:1},Rme=200,F4=40,Qyt=.8,Jyt=10,FS=1e-6;function e_t(i,e,t){const n=e,r=t;let s=0,a=1/0;for(let o=0;o<3;++o){{const l=i[o];if(n[o]<l){if(r[o]<=FS)return!1;const c=(l-n[o])/r[o];s=Math.max(s,c)}else if(r[o]<=-FS){const c=(l-n[o])/r[o];a=Math.min(a,c)}if(s>a)return!1}{const l=i[o+3];if(n[o]>l){if(r[o]>=-FS)return!1;const c=(l-n[o])/r[o];s=Math.max(s,c)}else if(r[o]>=FS){const c=(l-n[o])/r[o];a=Math.min(a,c)}if(s>a)return!1}}return!0}let ZJ=class{constructor(e,t,n,r,s){this.aabb=e,this.axis=t,this.d=n,this.midStartIndex=r,this.rightStartIndex=s}},RA=class{constructor(e,t,n,r){this.globalTriangleVertexIndices=e,this.firstTriangleIndex=t,this.positionAttribute=r,this._rayDirection=q(),this.bspNodeTree=new Array,this.vertexPositionBuffer=r.data,this.vertexPositionStride=r.stride;const s=n-t,a=s<=Ime?new Uint16Array(s):new Uint32Array(s);this.indices=a;for(let o=0;o<s;++o)a[o]=o;{const o=s_t(e,t,n,r.data,r.stride),l=lt(Math.log2(s/F4),2,Jyt),c=(u,d,h)=>{const p=n_t(a,o,u,d),m=d-u;if(m<=F4){const C=new ZJ(p,void 0,0,u,d);return this.bspNodeTree.push(C),C}const{axis:g,midValue:_}=r_t(p),b=i_t(a,o,u,d,g,_),x=(C,S)=>{if(h>l)return;const E=S-C;return E<F4||E>=Qyt*m?void 0:c(C,S,h+1)},w=new ZJ(p,g,_,b.next,b.mid);return this.bspNodeTree.push(w),w.leftNode=x(u,b.next),w.rightNode=x(b.mid,d),w};c(0,s,0),this.triangleVertexIndices=a_t(a,e,t,n)}}intersectRayTriangleRange(e,t){{if(e>=t)return;const n=this.triangleVertexIndices,r=this.positionAttribute.data,s=this.positionAttribute.stride,a=this._rayOrigin,o=a[0],l=a[1],c=a[2],u=this._rayDirection,d=u[0],h=u[1],p=u[2];for(let m=e,g=3*e;m<t;++m){let _=n[g++]*s;const b=r[_++],x=r[_++],w=r[_];_=n[g++]*s;const C=r[_++],S=r[_++],E=r[_];_=n[g++]*s;const A=C-b,P=S-x,O=E-w,M=r[_++]-b,V=r[_++]-x,L=r[_]-w,U=h*L-V*p,G=p*M-L*d,H=d*V-M*h,k=A*U+P*G+O*H;if(Math.abs(k)<=Number.EPSILON)continue;const D=o-b,$=l-x,F=c-w,Y=D*U+$*G+F*H;if(k>0){if(Y<0||Y>k)continue}else if(Y>0||Y<k)continue;const ne=$*O-P*F,X=F*A-O*D,J=D*P-A*$,he=d*ne+h*X+p*J;if(k>0){if(he<0||Y+he>k)continue}else if(he>0||Y+he<k)continue;const ye=(M*ne+V*X+L*J)/k;if(ye>=0){const Te=this.indices[m]+this.firstTriangleIndex,ce=Pbe(A,P,O,M,V,L,t_t);this._callback(ye,ce,Te,!1)}}}RA.numFacesTested+=t-e}intersectRay(e,t){RA.numFacesTested=0;const n=Gt(e.r0[0],e.r0[1],e.r0[2]),r=Gt(e.r1[0],e.r1[1],e.r1[2]),s=r[0]-n[0],a=r[1]-n[1],o=r[2]-n[2];if(s*s+a*a+o*o<FS)return;this._rayOrigin=n;const l=this._rayDirection;l[0]=s,l[1]=a,l[2]=o;const c=this.triangleVertexIndices.length/3;this._callback=t;const u=this.bspNodeTree[0];this.intersectRayBSP(u,0,c)}intersectRayBSP(e,t,n){const r=this._rayOrigin,s=this._rayDirection;if(!e_t(e.aabb,r,s))return;const a=e.axis,o=e.d;if(r[a]<o||s[a]<0){const l=t,c=e.midStartIndex;if(l<c){const u=e.leftNode;u!==void 0?this.intersectRayBSP(u,l,c):this.intersectRayTriangleRange(l,c)}}if(this.intersectRayTriangleRange(e.midStartIndex,e.rightStartIndex),r[a]>o||s[a]>0){const l=e.rightStartIndex,c=n;if(l<c){const u=e.rightNode;u!==void 0?this.intersectRayBSP(u,l,c):this.intersectRayTriangleRange(l,c)}}}get estimatedMemoryUsage(){return this.triangleVertexIndices.byteLength+this.indices.byteLength}};RA.numFacesTested=0;const t_t=q(),D1=[1/0,1/0,1/0],k1=[-1/0,-1/0,-1/0];function i_t(i,e,t,n,r,s){let a=t,o=n;for(;a<o;){const c=i[a];e[6*c+r+3]<=s?++a:(--o,i[a]=i[o],i[o]=c)}let l=a;for(o=n;l<o;){const c=i[o-1];e[6*c+r]>=s?--o:(i[o-1]=i[l],i[l]=c,++l)}return{next:a,mid:l}}function n_t(i,e,t,n){if(n<=t)return r5(NaN,NaN,NaN,NaN,NaN,NaN);{const r=6*i[t];for(let s=0;s<3;++s)D1[s]=e[r+0+s],k1[s]=e[r+3+s]}for(let r=t+1;r<n;++r){const s=6*i[r];for(let a=0;a<3;++a)D1[a]=Math.min(D1[a],e[s+0+a]),k1[a]=Math.max(k1[a],e[s+3+a])}return r5(D1[0],D1[1],D1[2],k1[0],k1[1],k1[2])}function r_t(i){const e=i[3]-i[0],t=i[4]-i[1],n=i[5]-i[2],r=e>t?e>n?0:t>n?1:2:t>n?1:n>e?2:0;return{axis:r,midValue:(i[r]+i[r+3])/2}}function s_t(i,e,t,n,r){const s=t-e,a=new Float32Array(6*s);for(let o=0;o<s;++o){const l=3*(o+e),c=i[l+0]*r,u=i[l+1]*r,d=i[l+2]*r;for(let h=0;h<3;++h){const p=n[c+h],m=n[u+h],g=n[d+h];a[6*o+h]=Math.min(p,m,g),a[6*o+3+h]=Math.max(p,m,g)}}return a}function a_t(i,e,t,n){const r=n-t;let s=0;for(let o=t;o<n;++o)for(let l=0;l<3;++l)s=Math.max(e[3*o+l],s);const a=s<=Ime?new Uint16Array(3*r):new Uint32Array(3*r);for(let o=0;o<r;++o){const l=3*(i[o]+t);for(let c=0;c<3;++c){const u=e[l+c];a[3*o+c]=u}}return a}const Ime=65535;let vr=class extends yf{constructor(){super(...arguments),this.output=Re.Color,this.overlayMode=km.Disabled,this.tileBlendInput=Up.LayerOnly,this.spherical=!1,this.doublePrecisionRequiresObfuscation=!1,this.atmosphere=!1,this.receiveShadows=!1,this.hasSlicePlane=!1,this.backfaceCullingEnabled=!1,this.stencilEnabled=!1,this.textureFadingEnabled=!1,this.renderOccluded=!1,this.hasScreenSpaceReflections=!1,this.hasCloudsReflections=!1,this.shading=!cn.TERRAIN_USE_LEGACY_SHADING,this.useLegacyTerrainShading=cn.TERRAIN_USE_LEGACY_SHADING,this.transparent=!1,this.tileBorders=!1,this.visualizeNormals=!1,this.screenSizePerspective=!1,this.receiveAmbientOcclusion=!1}};f([Pe({count:Re.COUNT})],vr.prototype,"output",void 0),f([Pe({count:km.COUNT})],vr.prototype,"overlayMode",void 0),f([Pe({count:Up.COUNT})],vr.prototype,"tileBlendInput",void 0),f([Pe()],vr.prototype,"spherical",void 0),f([Pe()],vr.prototype,"doublePrecisionRequiresObfuscation",void 0),f([Pe()],vr.prototype,"atmosphere",void 0),f([Pe()],vr.prototype,"receiveShadows",void 0),f([Pe()],vr.prototype,"hasSlicePlane",void 0),f([Pe()],vr.prototype,"backfaceCullingEnabled",void 0),f([Pe()],vr.prototype,"stencilEnabled",void 0),f([Pe()],vr.prototype,"textureFadingEnabled",void 0),f([Pe()],vr.prototype,"renderOccluded",void 0),f([Pe()],vr.prototype,"hasScreenSpaceReflections",void 0),f([Pe()],vr.prototype,"hasCloudsReflections",void 0),f([Pe()],vr.prototype,"shading",void 0),f([Pe()],vr.prototype,"useLegacyTerrainShading",void 0),f([Pe()],vr.prototype,"transparent",void 0),f([Pe()],vr.prototype,"tileBorders",void 0),f([Pe()],vr.prototype,"visualizeNormals",void 0),f([Pe()],vr.prototype,"screenSizePerspective",void 0),f([Pe()],vr.prototype,"receiveAmbientOcclusion",void 0),f([Pe({constValue:Ds.Disabled})],vr.prototype,"pbrMode",void 0),f([Pe({constValue:hd.CompressedAttribute})],vr.prototype,"normalType",void 0),f([Pe({constValue:yy.Compressed})],vr.prototype,"textureCoordinateType",void 0),f([Pe({constValue:!1})],vr.prototype,"highStepCount",void 0),f([Pe({constValue:!1})],vr.prototype,"useCustomDTRExponentForWater",void 0),f([Pe({constValue:!1})],vr.prototype,"useFillLights",void 0);const N4=7,o_t=10,V4=Go();var Ao;(function(i){i[i.Opaque=0]="Opaque",i[i.Semitransparent=1]="Semitransparent",i[i.Invisible=2]="Invisible"})(Ao||(Ao={}));let yc=class extends et{constructor(e){super(e),this.type=Sr.TERRAIN,this.isGround=!0,this._tileSize=256,this._techniqueConfiguration=new vr,this._passParameters=new pme,this._rctx=null,this._scaleRangeQueries=new zyt,this._renderDataPool=new Ic(yyt),this._patchGroups=new Map,this._patchGroupsDirty=!0,this._patchSortingDirty=!0,this._tileIterator=new sme,this._highestVisibleLODTile=null,this._visible=!0,this._transparencyState=Ao.Opaque,this._velvetOverground=!0,this._castShadows=!0,this._emptyTex=null,this._tileRenderer=null,this._stencilEnabledLayerExtents=new Array,this._numTilesRendered=0,this._numTilesCulled=0,this._numOriginsRendered=0,this.needsHighlight=!1,this.renderOccludedFlags=Qr.Occlude}get _isGlobal(){return this._stage.viewingMode===Ot.Global}get shading(){return this._techniqueConfiguration.shading}set shading(e){this._techniqueConfiguration.shading=e}initialize(){const e=[at.OPAQUE_TERRAIN,at.TRANSPARENT_TERRAIN,at.OCCLUDED_TERRAIN];this._stage.addRenderPlugin(e,this)}destroy(){this._stage.removeRenderPlugin(this),Tvt()}get canRender(){return this._visible&&!!this._rootTiles&&!this.renderingDisabled}set renderingDisabled(e){this._set("renderingDisabled",!!e),this.setDirty()}set transparency(e){this._transparencyState!==e&&(this._techniqueConfiguration.transparent=e===Ao.Invisible,this._transparencyState=e,this.setNeedsRender())}get transparency(){return this._transparencyState}get needsLinearDepth(){return this._overlayRenderer.hasWater}get renderPatchBorders(){return!!this._techniqueConfiguration.tileBorders}set renderPatchBorders(e){this._techniqueConfiguration.tileBorders!==e&&(this._techniqueConfiguration.tileBorders=e,this.setNeedsRender(),this.notifyChange("renderPatchBorders"))}get visualizeNormals(){return!!this._techniqueConfiguration.visualizeNormals}set visualizeNormals(e){this._techniqueConfiguration.visualizeNormals!==e&&(this._techniqueConfiguration.visualizeNormals=e,this.setNeedsRender(),this.notifyChange("visualizeNormals"))}get cullBackFaces(){return this._techniqueConfiguration.backfaceCullingEnabled}set cullBackFaces(e){this._techniqueConfiguration.backfaceCullingEnabled!==e&&(this._techniqueConfiguration.backfaceCullingEnabled=e,this.notifyChange("cullBackFaces"),this.setNeedsRender())}set renderOrder(e){this._set("renderOrder",e),this._setSortingDirty()}set velvetOverground(e){this._velvetOverground!==e&&(this._velvetOverground=e,this.setNeedsRender())}get layerUid(){return lh}get slicePlaneEnabled(){return this._techniqueConfiguration.hasSlicePlane}set slicePlaneEnabled(e){this._techniqueConfiguration.hasSlicePlane!==e&&(this._techniqueConfiguration.hasSlicePlane=e,this.setNeedsRender())}set textureFadingEnabled(e){this._techniqueConfiguration.textureFadingEnabled!==e&&(this._techniqueConfiguration.textureFadingEnabled=e,this.setNeedsRender())}setDebugScreenSizePerspective(e){this._techniqueConfiguration.screenSizePerspective!==e&&(this._techniqueConfiguration.screenSizePerspective=e,this.setNeedsRender())}setRootTiles(e){this._rootTiles=e,this.setDirty()}setNeedsHighlight(e){this.needsHighlight=e,this.setNeedsRender()}setRenderOccludedOverlay(e){this.renderOccludedFlags=e?rL:Qr.Occlude,this.setNeedsRender()}setStencilEnabledLayerExtents(e){this._stencilEnabledLayerExtents=e,this._setSortingDirty()}setTileSize(e){this._tileSize=e,T(this._tileRenderer)&&(this._tileRenderer.tileSize=e),this.setDirty()}_prepareTileForLoading(e){e.renderData||(e.renderData=this._renderDataPool.acquire(),e.renderData.init(e),e.renderData.localOrigin=this._getLocalOriginOfTile(e))}loadTile(e){this._prepareTileForLoading(e),this.updateTileGeometryState(e),this.updateTileTexture(e,Qt.TEXTURE_FADING)}queryVisibleLevelRange(e,t,n,r){this._scaleRangeQueries.queryVisibleLevelRange(e,t,n,r),this.setNeedsRender()}updateTileTexture(e,t){T(this._tileRenderer)&&(this._tileRenderer.updateTileTexture(e,t===Qt.TEXTURE_FADING?ha.FADING:ha.UNFADED),this.setNeedsRender(),e.resetPendingUpdate(t))}updateTileGeometryState(e){for(const n of e.layerInfo[Li.ELEVATION])n.pendingUpdates&=~Qt.GEOMETRY;e.resetPendingUpdate(Qt.GEOMETRY);const t=e.renderData.updateGeometryState();return t&&this.setDirty(),t}updateGeometryIfNeeded(e){e.isLoaded&&e.renderData.updateGeometryIfNeeded(this._rctx)}unloadTile(e){const t=e.renderData;t&&(t.releaseGeometry(),this._renderDataPool.release(t),t.clear(),e.renderData=null,e.setMemoryDirty(),this.setDirty())}_getLocalOriginOfTile(e){const t=o_t-N4,n=Math.max(0,Math.floor((e.level-t)/N4)*N4);if(this._isGlobal&&n===0)return wd;for(;e.parent&&e.level>n;)e=e.parent;return e.centerAtSeaLevel}setVisibility(e){this._visible=e,this.setDirty()}getStats(){return{numTilesRendered:this._numTilesRendered,numTilesCulled:this._numTilesCulled,numOriginsRendered:this._numOriginsRendered}}set wireframe(e){this._get("wireframe")!==e&&(this._set("wireframe",e),this.setNeedsRender())}setDirty(e=ds.UPDATE){this._patchGroupsDirty=!0,this._context.requestRender(e)}_setSortingDirty(e=ds.UPDATE){this._patchSortingDirty=!0,this._context.requestRender(e)}setNeedsRender(e=ds.UPDATE){this._context.requestRender(e)}initializeRenderContext(e){this._context=e,this._rctx=e.renderContext.rctx,this._techniqueRepository=e.shaderTechniqueRepository,this._tileRenderer=new Xyt(this._rctx,this._tileSize,this._techniqueRepository),this.updateTileBackground(),this._emptyTex=kne(this._rctx)}uninitializeRenderContext(){this._emptyTex=Ht(this._emptyTex),this._tileRenderer=Ht(this._tileRenderer)}intersect(e,t,n,r){if(!this._rootTiles||e.options.selectOpaqueTerrainOnly&&e.options.selectionMode&&this.transparency!==Ao.Opaque)return;const s=l_t,a=c_t;nt(s,r,n),je(a,1/s[0],1/s[1],1/s[2]);const o=e.results.min,l=e.results.max,c=e.results.ground,u=e.options.store===Fa.MIN,d=!!e.results.ground.target,h=t1e(e.verticalOffset),p=e.tolerance;let m,g=u&&T(o.dist)?o.dist:1/0;const _=x=>{const w=x.renderData;if(!(w!=null&&w.vao))return;const C=w.geometryInfo;lz(V4,C.boundingBox);const S=w.localOrigin;T(h)&&(h.localOrigin=S,h.applyToAabb(V4));const E=V4;if(F1[0]=n[0]-S[0],F1[1]=n[1]-S[1],F1[2]=n[2]-S[2],!Dne(E,F1,a,p,g))return;const A=(G,H,k)=>{G.set(this.type,x,H,k,Ks),g=u&&T(o.dist)?o.dist:1/0},P=(G,H)=>{if(T(H)&&G>=0&&(e.options.backfacesTerrain||dt(H,s)<0)&&(e.options.invisibleTerrain||!e.options.selectionMode||t==null||t(n,r,G))){if((c.dist==null||G<c.dist)&&A(c,G,H),e.options.isFiltered)return;e.options.store===Fa.ALL&&(B(m)?(m=YU(e.ray),A(m,G,H),e.results.all.push(m)):G<m.dist&&A(m,G,H)),(o.dist==null||G<o.dist)&&A(o,G,H),e.options.store!==Fa.MIN&&(l.dist==null||G>l.dist)&&A(l,G,H)}},O=u_t;nt(O,r,S);const M=C.indices,V=C.vertexAttributes,L={data:V.getField(j.POSITION,xy).typedBuffer,size:3,stride:V.stride/4},U=C.indexCount/3;if(B(h)&&U>Rme){const G=x.renderData;B(G.intersectionData)&&(G.intersectionData=new RA(M,0,U,L)),G.intersectionData.intersectRay({r0:F1,r1:O},P)}else KB(F1,O,0,U,M,L,null,h,P)},b=this._rootTiles;T(b)&&(()=>{const x=this._tileIterator;x.reset(b);const w=e.options.invisibleTerrain;for(;!x.done;){const C=x.next();!(C.visible||w&&C.intersectsClippingArea)||!T(h)&&!C.intersectsRay(n,s,p,g)||d&&this._useStencilForTile(C)?x.skipSubtree():_(C)}})()}prepareTechnique(e){if(e.bindParameters.slot===at.OCCLUDED_TERRAIN){if(!(e.renderOccludedMask&rL))return null}else{const t=this.transparency===Ao.Opaque?at.OPAQUE_TERRAIN:at.TRANSPARENT_TERRAIN;if(e.bindParameters.slot!==t)return null}switch(e.output){case Re.Color:{this._techniqueConfiguration.hasScreenSpaceReflections=e.bindParameters.ssr.enabled,this._techniqueConfiguration.hasCloudsReflections=T(e.bindParameters.cloudsFade.data),this._techniqueConfiguration.receiveShadows=e.bindParameters.shadowMap.ready,this._techniqueConfiguration.receiveAmbientOcclusion=e.bindParameters.ssaoHelper.ready,this._techniqueConfiguration.overlayMode=this._overlayRenderer.isEmpty()?km.Disabled:this._overlayRenderer.hasWater?km.EnabledWithWater:km.Enabled;const t=e.bindParameters.slot===at.OCCLUDED_TERRAIN?ja.Occluded:ja.ColorAndWater;return this._updateTechnique(Re.Color,t===ja.Occluded)}case Re.Shadow:case Re.ShadowExludeHighlight:return this._castShadows&&e.bindParameters.lighting.globalFactor===1?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(Re.Shadow,!1)):null;case Re.Depth:return this.transparency===Ao.Invisible&&this._overlayRenderer.isEmpty()?null:(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(Re.Depth,!1));case Re.Normal:return this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(Re.Normal,!1);case Re.ObjectAndLayerIdColor:return this._updateTechnique(Re.ObjectAndLayerIdColor,!1);case Re.Highlight:return this.needsHighlight?(this._techniqueConfiguration.receiveShadows=this._techniqueConfiguration.receiveAmbientOcclusion=!1,this._updateTechnique(Re.Highlight,!1)):null}return null}render(e,t){const n=e.bindParameters.lighting.globalFactor===1;switch(this._updatePatchGroups(),t.useStencil=!1,e.output){case Re.Color:{const r=e.bindParameters.slot===at.OCCLUDED_TERRAIN?ja.Occluded:ja.ColorAndWater;this.transparency===Ao.Opaque?this._renderMaterialPass(e,t,r):e.offscreenRenderingHelper.renderToTargets(()=>this._renderMaterialPass(e,t,r),e.offscreenRenderingHelper.tmpColor,e.offscreenRenderingHelper.mainDepth,[0,0,0,0]);break}case Re.Shadow:case Re.ShadowExludeHighlight:this._castShadows&&n&&this._renderAuxiliaryPass(e,t,ja.None);break;case Re.Depth:this.transparency===Ao.Invisible&&this._overlayRenderer.isEmpty()||this._renderAuxiliaryPass(e,t,ja.None);break;case Re.Normal:this._renderAuxiliaryPass(e,t,ja.None);break;case Re.ObjectAndLayerIdColor:this._renderAuxiliaryPass(e,t,ja.ObjectAndLayerIdColor);break;case Re.Highlight:this.needsHighlight&&this._renderAuxiliaryPass(e,t,ja.Highlight)}this._scaleRangeQueries.hasPendingQueries()&&this.setNeedsRender()}_renderMaterialPass(e,t,n){const{rctx:r}=e;this._passParameters.overlaySource=n,r.bindTechnique(t,this._passParameters,e.bindParameters),this._numTilesRendered=0,this._numTilesCulled=0,this._numOriginsRendered=0,this._scaleRangeQueries.prepareQueries(),this._renderPatchGroups(e,t,n),this._scaleRangeQueries.processQueries()}_renderAuxiliaryPass(e,t,n){const r=e.rctx;this._passParameters.overlaySource=n,r.bindTechnique(t,this._passParameters,e.bindParameters),this._renderPatchGroupsAuxiliary(e,t,n)}updateTileBackground(e=null){if(B(this._tileRenderer))return;const t=this._tileRenderer;let n=null;if(T(e)){const r=Xt.toUnitRGBA(e);n=Gt(r[0]||0,r[1]||0,r[2]||0)}t.setBackground(n),this._allTiles.forAll(r=>t.updateTileTexture(r,ha.FADING)),this._techniqueConfiguration.tileBlendInput=t.backgroundIsGrid?Up.GridComposite:T(t.backgroundColor)?Up.ColorComposite:Up.LayerOnly,this.setNeedsRender()}_updatePatchGroups(){if(this._patchGroupsDirty&&(this._highestVisibleLODTile=null,this._rebuildPatchGroups(),this._patchGroupsDirty=!1,this._patchSortingDirty=!0),this._patchSortingDirty&&this.renderOrder!==OA.NONE){const e=Array.from(this._patchGroups.values());e.forEach(t=>ame(this.renderOrder,t,this._stencilEnabledLayerExtents)),e.sort((t,n)=>iH(t[0],n[0],this.renderOrder)),this._patchGroups=new Map(e.map(t=>[t[0].renderData.localOrigin,t])),this._patchSortingDirty=!1}}_rebuildPatchGroups(){var t;const e=this._rootTiles;if(!B(e)){(t=e[0])==null||t.surface.checkAllTilesWaterproofness(),this._patchGroups.clear();for(const n of e)this._rebuildPatchGroupsForRootTile(n)}}_rebuildPatchGroupsForRootTile(e){const t=this._tileIterator;for(t.resetOne(e);!t.done;){const n=t.next(),r=n.renderData;if(!r||n.visible)if(n.rendered){if(r){const s=this._patchGroups.get(r.localOrigin)||new Array;this._patchGroups.set(r.localOrigin,s),s.push(n),(!this._highestVisibleLODTile||n.vlevel>this._highestVisibleLODTile.vlevel)&&(this._highestVisibleLODTile=n),t.skipSubtree()}}else this._numTilesCulled++;else this._numTilesCulled++,t.skipSubtree()}}_useStencilForTile(e){for(const t of this._stencilEnabledLayerExtents)if(e.intersectsExtent(t))return!0;return!1}_renderPatchGroupsAuxiliary(e,t,n){const r=this._stencilEnabledLayerExtents.length>0;this._patchGroups.forEach(s=>{const a=s[0].renderData.localOrigin;t.program.bindDraw(new K6(a),e.bindParameters,this._passParameters);for(let o=0;o<s.length;o++)this._renderPatch(e,t,s[o],Qi.TRIANGLES,r,n)}),e.rctx.bindVAO(null)}_renderPatchGroups(e,t,n){const r=e.bindParameters.camera,s=t.program;if(this._techniqueConfiguration.screenSizePerspective&&this.pointsOfInterest){const u=Lne(this._stage.viewingMode,this._ellipsoidRadius),d=this.pointsOfInterest.centerOnSurfaceFrequent.distance;u.update({distance:d,fovY:r.fovY})}const a=this._stencilEnabledLayerExtents.length>0,o=n===ja.Occluded;o&&(s.bindTexture("tex",this._emptyTex),s.setUniform1f("blend",1),s.setUniform4fv("texOffsetAndScale",ox));const l=T(this._tileRenderer)&&T(this._tileRenderer.backgroundColor)?this._tileRenderer.backgroundColor:wd;this._techniqueConfiguration.tileBlendInput===Up.ColorComposite&&s.setUniform3fv("backgroundColor",l);const c=this.wireframe?Qi.LINES:Qi.TRIANGLES;this._techniqueConfiguration.textureFadingEnabled&&s.bindTexture("texNext",this._emptyTex),this._patchGroups.forEach(u=>{const d=u[0].renderData.localOrigin;t.program.bindDraw(new K6(d),e.bindParameters,this._passParameters),this._numOriginsRendered++;for(let h=0;h<u.length;h++){const p=u[h],m=p.renderData.textureReference;if(!B(m)){if(!o){this._scaleRangeQueries.scaleQueriesForTile(p),s.setUniform4fv("texOffsetAndScale",m.offsetAndScale),s.bindTexture("tex",m.texture.texture);const g=p.renderData.textureFadeFactor,_=g<1?p.renderData.nextTextureReference:null;this._techniqueConfiguration.textureFadingEnabled&&T(_)&&g<1?(s.setUniform1f("fadeFactor",g),s.setUniform4fv("nextTexOffsetAndScale",_.offsetAndScale),s.setUniform3fv("nextTexOpacities",_.opacities),s.bindTexture("texNext",_.texture.texture)):s.setUniform1f("fadeFactor",1),p.renderData.textureIsFading&&this.setNeedsRender(),s.setUniform3fv("textureOpacities",m.opacities)}this._renderPatch(e,t,p,c,a,n),p.renderOrder=this._numTilesRendered,this._numTilesRendered++}}}),e.rctx.bindVAO(null)}_renderPatch(e,t,n,r,s,a){const o=n.renderData,l=o.vao,c=l.indexBuffer;if(B(c))return void(fa&&console.error("Rendered tile with no indices: ",n.lij," : ",o));const u=t.program;a!==ja.None&&this._bindOverlayPatchData(u,o.overlay),s&&(t.useStencil=this._useStencilForTile(n),t.bindPipelineState(e.rctx,e.bindParameters.slot));const d=o.geometryInfo.indexCount;e.rctx.bindVAO(l),u.assertCompatibleVertexAttributeLocations(l),e.rctx.drawElements(r,d,c.indexType,0)}_bindOverlayPatchData(e,t){e.setUniform4fv("overlayTexOffset",t.offsets),e.setUniform4fv("overlayTexScale",t.scales)}_updateTechnique(e,t){return this._techniqueConfiguration.output=e,e===Re.Color&&(this._techniqueConfiguration.atmosphere=this._isGlobal&&this._velvetOverground),this._techniqueConfiguration.renderOccluded=t,this._techniqueConfiguration.stencilEnabled=!1,this._shaderTechnique=this._techniqueRepository.releaseAndAcquire(cH,this._techniqueConfiguration,this._shaderTechnique),this._shaderTechnique}get test(){return{tileRenderer:this._tileRenderer}}};f([y({constructOnly:!0})],yc.prototype,"_overlayRenderer",void 0),f([y({constructOnly:!0})],yc.prototype,"_stage",void 0),f([y({readOnly:!0})],yc.prototype,"_isGlobal",null),f([y({constructOnly:!0})],yc.prototype,"_allTiles",void 0),f([y({constructOnly:!0})],yc.prototype,"_ellipsoidRadius",void 0),f([y({value:!1})],yc.prototype,"renderingDisabled",null),f([y()],yc.prototype,"renderPatchBorders",null),f([y()],yc.prototype,"visualizeNormals",null),f([y()],yc.prototype,"cullBackFaces",null),f([y({value:OA.FRONT_TO_BACK})],yc.prototype,"renderOrder",null),f([y()],yc.prototype,"wireframe",null),yc=f([ge("esri.views.3d.terrain.TerrainRenderer")],yc);const l_t=q(),c_t=q(),F1=q(),u_t=q();let d_t=class{constructor(){this.numNodes=0,this.numLeaves=0,this.numVisible=0,this.numRendered=0,this.numSplit=0,this.numMerged=0,this.numRenderedPerLevel=new Array,this.numLoadedPerLevel=new Array}},hp=class extends et{constructor(e){super(e),this._handles=new mi}initialize(){this._handles.add(this.layers.on("change",()=>this._update())),this._handles.add(ue(()=>this.extentHelper.layerViewsExtent,()=>this._setAdHocTilingScheme())),this._update(),this.tilingSchemeLocked||this._setAdHocTilingScheme()}destroy(){this._handles=_t(this._handles),this._waitTask=null}_update(){if(this._waitTask=null,this.tilingSchemeLocked)return;let e;if(this.layers.some(t=>!(!ax(t)||t.isRejected())&&!(t.isFulfilled()&&!h_t(t,this.viewSpatialReference,this.viewingMode))&&(e=t,!((t==null?void 0:t.type)==="vector-tile"||hL(t)))),e)if(e.isResolved()){const t=SD(e,this.viewSpatialReference,this.viewingMode);if(T(t)){const n=new ur(t.tileInfo);this._lockTilingScheme(n)}}else this._updateWhen(e)}_updateWhen(e){const t=e.when().catch(()=>{}).then(()=>{t!==this._waitTask||this.destroyed||this._update()});this._waitTask=t}_lockTilingScheme(e){if(this.viewingMode===Ot.Global){const t=e.levels.length-1;e.spatialReference.isWebMercator?e=ur.makeWebMercatorAuxiliarySphere(t):X0(e.spatialReference)&&(e=ur.makeGCSWithTileSize(e.spatialReference,e.pixelSize,t))}this.tilingSchemeLocked=!0,this.tilingScheme=e,this.extentHelper.tilingScheme=this.tilingScheme,this._updateTiledLayerExtent(),this._handles.removeAll(),this._handles.add(ue(()=>this.extentHelper.tiledLayersExtent,()=>this._updateTiledLayerExtent()))}_updateTiledLayerExtent(){this._set("extent",this.extentHelper.tiledLayersExtent)}_setAdHocTilingScheme(){if(this.viewingMode===Ot.Global){const e=this.extentHelper.viewSpatialReference,t=X0(e)||zA(e)||UA(e);e.isWebMercator?this.tilingScheme=ur.WebMercatorAuxiliarySphere:t&&(this.tilingScheme=ur.makeGCSWithTileSize(e,256)),this._set("extent",this.extentHelper.layerViewsExtent)}else{const e=this.extentHelper.layerViewsExtent;T(e)&&!$0(e,this.extent)&&(this.tilingScheme=ur.fromExtent(e,this.extentHelper.viewSpatialReference),this._set("extent",e))}}get test(){return{lockTilingScheme:e=>this._lockTilingScheme(e),done:!this._waitTask}}};function h_t(i,e,t){return T(SD(i,e,t))}f([y()],hp.prototype,"tilingScheme",void 0),f([y({readOnly:!0})],hp.prototype,"extent",void 0),f([y({value:!1})],hp.prototype,"tilingSchemeLocked",void 0),f([y({constructOnly:!0})],hp.prototype,"viewSpatialReference",void 0),f([y({constructOnly:!0})],hp.prototype,"layers",void 0),f([y({constructOnly:!0})],hp.prototype,"extentHelper",void 0),f([y({constructOnly:!0})],hp.prototype,"viewingMode",void 0),hp=f([ge("esri.views.3d.terrain.TilingSchemeLogic")],hp);let p_t=class{constructor(){this.offset=xt(),this.scale=0,this.tile=null}init(e,t,n,r){this.tile=e,this.offset[0]=t,this.offset[1]=n,this.scale=r}dispose(){this.tile=null,this.offset[0]=0,this.offset[1]=0,this.scale=0}},Pi=class extends Pn.EventedMixin(et){constructor(i){var e,t;super(i),this._iteratorPool=new Ic(sme,n=>n.remove=()=>this._iteratorPool.release(n)),this._postorderIterator=new Ovt,this._hasPendingUpdates=!1,this._pendingUpdates=0,this._asyncWorkItems=0,this._allTilesDirty=!0,this._allTilesSorted=!0,this._visibleCached=!1,this._usedMemory=null,this._performanceInfo=new d_t,this._viewChanged=!1,this._inFrameTask=!1,this._viewChangeUpdateDirty=!1,this._eyePosRenderSR=q(),this._eyePosSurfaceSR=q(),this._splitLimits=new Qvt,this._frustum=_2(),this._viewProjectionMatrix=St(),this._layerViews=[new Array,new Array],this._layerIndexByUid=[new Map,new Map],this._basemapLayerViewHandles=new Map,this._handles=new mi,this._watchUpdatingTracking=new wb,this._frameTask=GA,this._allTiles=new pn,this._upsampleInfoPool=new Ic(p_t),this._rootTilesExtent=qi(),this._maxNumUpdating=1,this.maxTextureScale=1.2,this._spatialReference=$n.WebMercator,this.visibleElevationBounds=new Zw(1/0,-1/0),this.rootTileElevationBounds=new Zw(1/0,-1/0),this._updatingRootTiles=!1,this._pendingTilesForElevationUpdateEvent=new Set,this._pendingTilesToUpdate=new Set,this.totalGeometryUpdates=0,this.totalTileUpdates=0,this.oneBatchPerFrameTask=!0,this._layerViewsDirty=!1,this._shading=!0,this._isWebMercator=!1,this._isWebMercatorOnPlateeCarree=!1,this._isGlobal=!((t=(e=i.view)==null?void 0:e.state)!=null&&t.isLocal)}initialize(){this._lercDecoder=Hwe(this.view.resourceController),this._tilePool=this.view.state.isLocal?new Ic(Nyt):new Ic(Vyt);const i=this.view.resourceController.memoryController;this._upsampleMapCache=i.newCache("esri.views.3d.terrain.upsample",r=>r.unloadMapData()),this._elevationQueryCache=new rvt(i.newCache("elevation-query")),this._set("overlayManager",new Ol({surface:this})),this._handles.add([ue(()=>this.overlayManager.hasHighlights,r=>this._renderer.setNeedsHighlight(r)),ue(()=>this.overlayManager.rendersOccluded,r=>this._renderer.setRenderOccludedOverlay(r))],"overlayManager"),this._renderer=new yc({_overlayRenderer:this.overlayManager.renderer,_ellipsoidRadius:rn(this.view.spatialReference).radius,_stage:this.view._stage,_allTiles:this._allTiles}),this._handles.add([ue(()=>this.baseOpacity,r=>{this._handleLayerViewChanges(),this._updateBaseOpacity(r)},hn),ue(()=>this.hasCompositeBlendMode,()=>{this._updateBaseOpacity(this.baseOpacity)},hn),ue(()=>this.renderingDisabled,()=>{var r,s;return(s=(r=this.view)==null?void 0:r._stage)==null?void 0:s.renderView.setRenderParameters({terrainRenderingEnabled:!this.renderingDisabled})},on),ue(()=>this.backgroundColor,r=>{this._handleLayerViewChanges(),this._renderer.updateTileBackground(r)},hn),ue(()=>this.snapLevel,()=>this._viewChanged=!0,on),ue(()=>this.view.pointsOfInterest,r=>{this._renderer.pointsOfInterest=r,this._watchUpdatingTracking.removeAll(),r&&this._watchUpdatingTracking.add(()=>r.focus.renderLocation,()=>this._allTilesSorted=!1)}),ue(()=>cn.TERRAIN_TILE_TREE_SHOW_TILES,r=>{r&&!this._treeDebugger?Ee(()=>import("./TerrainTileTree3DDebugger-984eaea3.js"),["./TerrainTileTree3DDebugger-984eaea3.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./reactiveUtils-f41a4e00.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./TileTreeDebugger-5ce82b98.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js"],import.meta.url).then(({TerrainTileTree3DDebugger:s})=>{!this._treeDebugger&&cn.TERRAIN_TILE_TREE_SHOW_TILES&&(this._treeDebugger=new s({view:this.view}))}):r||(this._treeDebugger=_t(this._treeDebugger))},At)]),this._extentHelper=gvt(this.viewingMode,{layers:this.view.map.allLayers,layerViews:this.view.allLayerViews,viewSpatialReference:this.view.spatialReference});const e=new t2({getCollections:()=>{var r,s,a;return(a=(s=(r=this.view)==null?void 0:r.defaultsFromMap)==null?void 0:s.mapCollections)==null?void 0:a.map(({layers:o})=>o)},getChildrenFunction:r=>r&&"layers"in r?r.layers:null}),t=new hp({layers:e,extentHelper:this._extentHelper,viewingMode:this.viewingMode,viewSpatialReference:this.view.spatialReference});this._set("tilingSchemeLogic",t),this._updateTilingScheme(),this._elevationDataRequester=this.view.resourceController.createStreamDataRequester($p.ELEVATION),this._mapDataRequester=this.view.resourceController.createStreamDataRequester($p.BASEMAP);const n=this.view.resourceController.scheduler;this._frameTask=n.registerTask($r.TERRAIN_SURFACE,this),this._handles.add([ue(()=>this._extentHelper.stencilEnabledExtents,r=>this._renderer.setStencilEnabledLayerExtents(r),At),ue(()=>this.tilingSchemeLogic.tilingScheme,()=>this._updateTilingScheme(),on),ue(()=>this.extent,()=>this._updateRootTiles(),At),this.view.on("resize",()=>this._viewChangeUpdate()),ue(()=>{var a,o;const r=this.view,s=r.state;return[this._lodBias,this.lodSnapping,(o=(a=r.resourceController)==null?void 0:a.memoryController)==null?void 0:o.memoryFactor,s.camera,s.contentCamera,s.fixedContentCamera]},()=>this._viewChangeUpdate(),hn),ue(()=>{var r,s;return(s=(r=this.view.qualitySettings)==null?void 0:r.tiledSurface)==null?void 0:s.textureFadeDuration},r=>this._renderer.textureFadingEnabled=r>0,At),ue(()=>this._userClippingExtent,()=>this._updateClippingExtent(),on)]),this._handles.add(this.view.allLayerViews.on("after-changes",()=>this._layerViewsDirty=!0)),this._handles.add([ue(()=>{var r;return(r=this.view)==null?void 0:r.map.ground.shading},()=>{this._updateShadingIfChanged()})]),this._updateShading(),this._layerViewsDirty=!0,this._handleLayerViewChanges()}destroy(){this._frameTask.remove(),this._handles.destroy(),this._watchUpdatingTracking.destroy(),this._lercDecoder=Lr(this._lercDecoder),this._removeAllTiles(),this._upsampleMapCache=_t(this._upsampleMapCache),this._elevationQueryCache=_t(this._elevationQueryCache);const i=this.tilingSchemeLogic.layers;this._set("tilingSchemeLogic",_t(this.tilingSchemeLogic)),i.destroy(),this._basemapLayerViewHandles.forEach((e,t)=>this._unregisterTiledLayerView(t)),this._elevationDataRequester=null,this._mapDataRequester=null,this._set("overlayManager",_t(this.overlayManager)),this._tilePool=_t(this._tilePool),sH.prune(),this._treeDebugger&&(this._treeDebugger.destroy(),this._treeDebugger=null),this._renderer=_t(this._renderer),this._iteratorPool=_t(this._iteratorPool),this._set("view",null),this._upsampleInfoPool=_t(this._upsampleInfoPool),hvt(),Xvt()}get renderer(){return this._renderer}get frustum(){return this._frustum}get snapLevel(){var i,e;if(this.lodSnapping===RE.ON){const t=this.view,n=this.tilingScheme,r=(e=(i=t.pointsOfInterest)==null?void 0:i.contentCameraOnSurface)==null?void 0:e.scale;if(r&&n){const s=t.state.contentCamera;let a=uD(t,s.eye,s.viewForward,s.up).tilt;a>90&&(a=180-a);const o=2*(a/90)**2,l=n.levelAtScale(r)-o;return Math.round(l)}}return null}get lodSnapping(){return this.view.qualitySettings.tiledSurface.reduceTileLevelDifferences?RE.ON:RE.OFF}get upsampleInfoPool(){return this._upsampleInfoPool}get upsampleMapCache(){return this._upsampleMapCache}get elevationQueryCache(){return this._elevationQueryCache}get mapTileRequester(){return this._mapDataRequester}get _userClippingExtent(){const{spatialReference:i}=this,{clippingArea:e}=this.view;if(B(e)||B(i))return null;const t=qi(),n=Xfe(e,t,i)?t:null,r=this._get("extent");return $0(n,r)?r:n}get rootTilesExtent(){return this._rootTilesExtent}get extent(){const i=WN(this.groundExtent,this._userClippingExtent,qi()),e=this._get("extent");return $0(i,e)?e:i}get groundExtent(){return T(this._tilingSchemeExtent)?this._tilingSchemeExtent:this._rootTilesExtent}get _tilingSchemeExtent(){var i;return(i=this.tilingSchemeLogic)==null?void 0:i.extent}get updating(){return this._hasPendingUpdates||(this._maxNumUpdating=1),!!((this.running||this._watchUpdatingTracking.updating||this._asyncWorkItems>0)&&this.ready&&!this.suspended||this.overlayManager.updating)}get running(){return(this._hasPendingUpdates||this._viewChanged||this._allTilesDirty||!this._allTilesSorted||this._layerViewsDirty||this._frameTask.updating)&&this.ready&&!this.suspended}get updatingProgressValue(){return this._maxNumUpdating=Math.max(this._pendingUpdates,this._maxNumUpdating),1-this._pendingUpdates/this._maxNumUpdating}get baseOpacity(){return this.view.map.ground.opacity}set baseOpacity(i){this.view.map.ground.opacity=i}get viewingMode(){return this.view.state.viewingMode}get ready(){return T(this.rootTiles)}set renderOrder(i){this._renderer.renderOrder=i,this._set("renderOrder",i)}get spatialReference(){var i;return((i=this.tilingScheme)==null?void 0:i.spatialReference)??null}get backgroundColor(){return this.view.map.ground.surfaceColor}set backgroundColor(i){this.view.map.ground.surfaceColor=i}set slicePlaneEnabled(i){this._renderer.slicePlaneEnabled=i,this._set("slicePlaneEnabled",i),this._evaluateTransparency(this.baseOpacity)}get tilingSchemeLocked(){var i;return((i=this.tilingSchemeLogic)==null?void 0:i.tilingSchemeLocked)??!1}set velvetOverground(i){i!==this.velvetOverground&&(this._renderer.velvetOverground=i),this._set("velvetOverground",i)}get wireframe(){return this._renderer.wireframe}set wireframe(i){i!==this._renderer.wireframe&&(this._renderer.wireframe=i,this._updateAllTileGeometries())}set _visible(i){i!==this._visibleCached&&(this._visibleCached=i,this._renderer.setVisibility(i),this.suspended=!i)}get opaque(){return this._renderer.transparency===Ao.Opaque}set suspended(i){this._set("suspended",i),this._viewChangeUpdate()}get textureFadeDuration(){return this.view.qualitySettings.tiledSurface.textureFadeDuration??0}intersect(i,e,t,n){this._renderer.intersect(i,e,t,n)}getElevation(i,e,t,n){const r=this.rootTiles;if(B(r)||!r.length||r[0].layerInfo[Li.ELEVATION].length===0)return null;const s=Tl;return s[0]=i,s[1]=e,s[2]=t,no(s,n,s,this._spatialReference)?JJ(r,s[0],s[1]):(tt.getLogger(this.declaredClass).error("TerrainSurface.getElevation(): could not project given point to tiling scheme coordinate system"),null)}getElevations(i,e,t){const n=this.rootTiles,r=n?n[0].layerInfo[Li.ELEVATION].length:0;if(!B(n)&&n.length&&r!==0)for(let s=0;s<e;++s){const a=3*s;t(s,JJ(n,i[a+0],i[a+1]))}else for(let s=0;s<e;++s)t(s,null)}getScale(i){if(this.tilingScheme){if(!ya(i,Tl,this.spatialReference))return tt.getLogger(this.declaredClass).error("TerrainSurface.getScale(): could not project given point to tiling scheme coordinate system"),null;const e=this.rootTiles;if(T(e)){for(let t of e)if(t!=null&&t.containsPoint(Tl)){for(;!t.isLeaf&&!t.rendered;){let n=0;Tl[0]>t.children[0].extent[2]&&(n+=1),Tl[1]<t.children[0].extent[1]&&(n+=2),t=t.children[n]}return this._getLodBiasCorrectedScale(t.level)}}}return 1e100}getSphereElevationBounds(i,e,t,n,r){var c;if(Tl[0]=i,Tl[1]=e,Tl[2]=t,Tl[3]=n,!no(Tl,r,Tl,(c=this.tilingScheme)==null?void 0:c.spatialReference))return tt.getLogger(this.declaredClass).error("TerrainSurface.getSphereElevationBounds(): could not project given point to tiling scheme coordinate system"),null;let s=1/0,a=-1/0;const o=u=>{if(u&&zG(u.extent,Tl))if(u.isLeaf||u.rendered)s=Math.min(s,u.elevationBounds[0]),a=Math.max(a,u.elevationBounds[1]);else for(const d of u.children)o(d)},l=this.rootTiles;if(T(l))for(const u of l)o(u);return{min:s,max:a}}getSphereScale(i,e){if(!this.tilingScheme)return null;if(!ya(i,Tl,this.spatialReference))return tt.getLogger(this.declaredClass).error("TerrainSurface.getSphereScale(): could not project given point to tiling scheme coordinate system"),null;Tl[3]=e;let t=null;const n=s=>{if(s&&zG(s.extent,Tl))if(s.isLeaf||s.rendered){const a=this._getLodBiasCorrectedScale(s.level);t=t==null?a:Math.min(t,a)}else for(const a of s.children)n(a)},r=this.rootTiles;if(T(r))for(const s of r)n(s);return t}queryVisibleScaleRange(i,e,t,n){const r=e?this.tilingScheme.levelAtScale(e):0,s=t?this.tilingScheme.levelAtScale(t):1/0,a=this._lodBias;this._renderer.queryVisibleLevelRange(i,r+a,s+a,n)}_evaluateTransparency(i){var r,s;const e=this._renderer.transparency,t=this._allSurfaceLayersTransparent()?Ao.Invisible:i>=1&&!this.hasCompositeBlendMode&&!this._renderer.slicePlaneEnabled?Ao.Opaque:Ao.Semitransparent,n=e!==t;return n&&(this._renderer.transparency=t,(s=(r=this.view)==null?void 0:r._stage)==null||s.renderView.setRenderParameters({terrainTransparency:this._renderer.transparency})),n}_updateBaseOpacity(i){const e=this._evaluateTransparency(i);this._updateTileTextures(e?ha.UNFADED:ha.IMMEDIATE)}_updateTilingScheme(){var e,t,n,r;const i=this.tilingSchemeLogic.tilingScheme;i!==this.tilingScheme&&(xp(!!i,"tiling scheme cannot be reset to undefined"),this._isGlobal=!((t=(e=this.view)==null?void 0:e.state)!=null&&t.isLocal),this.tilingScheme&&this._removeAllTiles(),this._spatialReference=(i==null?void 0:i.spatialReference)??$n.WebMercator,this._set("tilingScheme",i),this._updateClippingExtent(),i&&(this._updateTiledLayers(),this._renderer.setTileSize(i.pixelSize),this.overlayManager.setSpatialReference(i.spatialReference),this._updateRootTiles()),this._isWebMercator=!!((n=this.tilingScheme)!=null&&n.spatialReference.isWebMercator),this._isWebMercatorOnPlateeCarree=this._isWebMercator&&pie((r=this.view)==null?void 0:r.renderSpatialReference))}_acquireTile(i,e,t,n){const r=this._tilePool.acquire();return xO[0]=i,xO[1]=e,xO[2]=t,r.init(xO,n,this),r}get updatingRootTiles(){return this._updatingRootTiles}_updateRootTiles(){const{extent:i,tilingScheme:e}=this;if(!e)return;const t=g_t;let n=e.rootTilesInExtent(i,t,5*Bw);if(T(this.rootTiles)){if(n.length>Bw)return void tt.getLogger(this.declaredClass).warn(Rnt);const r=this.rootTiles.map(a=>a.lij),s=xye(r,n,QJ);if(this._updatingRootTiles=!0,s.removed.length>0||s.added.length>0){const a=this.rootTiles.filter(o=>!(s.removed.findIndex(l=>QJ(l,o.lij))>-1)||(this._purgeTile(o),!1));s.added.forEach(o=>a.push(this._newRootTile(o))),this._setRootTiles(a)}}else this._updatingRootTiles=!0,n.length>Bw&&(tt.getLogger(this.declaredClass).warn(Int),n=e.rootTilesInExtent(i,t,Bw)),this._setRootTiles(n.map(r=>this._newRootTile(r)));$0(t,this._rootTilesExtent)||(this._rootTilesExtent=qi(t)),this._visible=!0,this._viewChangeUpdate(),this.overlayManager.setPlacementDirty(),this.notifyChange("ready"),this._updateAllTileGeometries(),this._updatingRootTiles=!1,this.checkAllTilesWaterproofness()}_updateAllTileGeometries(){const i=this._allTiles.filter(e=>e.isLoaded&&e.intersectsClippingArea);i.forEach(e=>this._renderer.updateTileGeometryState(e)),i.forEach(e=>e.renderData.updateNeighborData()),this._updateTilesGeometries(i),this._pendingTilesToUpdate.clear()}_updateTilesGeometries(i){if(i.length===0)return;i.sort(Dm);const e=this.renderer;i.forEach(t=>e.updateGeometryIfNeeded(t)),i.forEach(t=>this._pendingTilesForElevationUpdateEvent.add(t))}_shouldSplit(i){return i.shouldSplit(this._splitLimits,this._eyePosRenderSR,this.snapLevel)===Qt.SPLIT}_newRootTile(i){const e=this._acquireTile(0,i[1],i[2],null);return this._shouldSplit(e)&&e.setPendingUpdate(Qt.SPLIT),this._loadTile(e),this._markTileToUpdate(e),this._updateRootTileElevationBounds(),e}_setRootTiles(i){if(this._set("rootTiles",i),this._allTiles.clear(),T(i)){const e=this._iteratorPool.acquire();for(e.reset(i);!e.done;)this._allTiles.push(e.next());e.remove()}this._renderer.setRootTiles(this.rootTiles),this._updateTilesVisibility(i)}_runViewChangeUpdateIfDirty(){this._viewChangeUpdateDirty&&(this._viewChangeUpdateDirty=!1,this._viewChangeUpdate())}_viewChangeUpdate(){this.view&&!this.suspended&&this.tilingScheme&&this._visibleCached&&(this._inFrameTask?this._viewChangeUpdateDirty=!0:(this._viewChangeUpdateDirty=!1,this._updateViewDependentParameters(),this._updateTilesVisibility(this.rootTiles)))}_updateClippingStatus(i){i.updateClippingStatus(this.extent)&&i.resetPendingUpdate(Qt.GEOMETRY)&&this._updateTileGeometryState(i)}_updateTilesVisibility(i){if(B(i))return;const e=Lvt(i),t=this.visibleElevationBounds;let n=e?t.min:1/0,r=e?t.max:-1/0;const s=this.extent,a=this._viewProjectionMatrix;this.setTileTreeDirty();const o=this._iteratorPool.acquire();for(o.reset(i);!o.done;){const l=o.next();l.updateClippingStatus(s)&&l.resetPendingUpdate(Qt.GEOMETRY)&&this._updateTileGeometryState(l),l.setPendingUpdate(Qt.RENDERDATA),l.computeVisibility(),l.updateScreenDepth(a),l.renderData&&(n=Math.min(l.elevationBounds[0],n),r=Math.max(l.elevationBounds[1],r))}o.remove(),this._viewChanged=!0,this._allTilesDirty=!0,this._batchUpdatePendingTileGeometries(),isFinite(n)&&isFinite(r)&&(t.min!==n||t.max!==r)&&(this.visibleElevationBounds=new Zw(n,r))}_updateRootTileElevationBounds(){let i=1/0,e=-1/0;const t=this.rootTiles;T(t)&&t.forEach(({elevationBounds:r})=>{i=Math.min(i,r[0]),e=Math.max(e,r[1])});const n=this.rootTileElevationBounds;n.min===i&&n.max===e||(this.rootTileElevationBounds=new Zw(i,e))}_updateViewDependentParameters(){const i=this.view.state.camera,e=this.view.state.contentCamera,t=Math.tan(.5*e.fovX),n=Math.tan(.5*e.fovY),r=this.tilingScheme.pixelSize,s=2**-this._lodBias*i.pixelRatio;this._splitLimits.aboveGround=i.aboveGround,this._splitLimits.fovX=t,this._splitLimits.fovY=n,this._splitLimits.relativeWidthLimit=r/i.width*this.maxTextureScale*s,this._splitLimits.relativeHeightLimit=r/i.height*this.maxTextureScale*s,this._splitLimits.maxLod=this.tilingScheme.getMaxLod(),this._splitLimits.angledSplitBias=this.view.qualitySettings.tiledSurface.angledSplitBias,this.view.state.fixedContentCamera?(B(this._splitLimits.frustum)&&(this._splitLimits.frustum=_2()),JI(this._splitLimits.frustum,e.frustum)):this._splitLimits.frustum=null,JI(this._frustum,i.frustum),Vs(this._viewProjectionMatrix,e.projectionMatrix,e.viewMatrix),Ge(this._eyePosRenderSR,e.eye),no(i.eye,this.view.renderSpatialReference,this._eyePosSurfaceSR,this.spatialReference)}_updateRenderData(i){i.rendered&&!i.shouldLoad&&($me(i)?this._loadChildren(i):m_t(i)&&this._loadParent(i))}_updateTileGeometryState(i){i.updateVisibility(),this._renderer.updateTileGeometryState(i)&&this._markTileToUpdate(i),this._usedMemory=null}_markAllTileNeighborsForGeometryUpdate(i){const e=this._pendingTilesToUpdate;i.forEachLoadedNeighbor(t=>{e.add(t)})}_updateTileTexture(i,e){const t=i.resetPendingUpdate(Qt.TEXTURE_FADING)?Qt.TEXTURE_FADING:!!i.resetPendingUpdate(Qt.TEXTURE_NOFADING)&&Qt.TEXTURE_NOFADING;t&&(this._renderer.updateTileTexture(i,t),this._usedMemory=null,e.madeProgress())}_emitElevationUpdateEventForTiles(){const i=z4.extent;Eh(i),this._pendingTilesForElevationUpdateEvent.forEach(e=>ry(i,e.extent,i)),this._pendingTilesForElevationUpdateEvent.clear(),z4.spatialReference=this.spatialReference,this.emit("elevation-change",z4)}runTask(i){this._handleLayerViewChanges(i),this._frameTask.processQueue(i),this._inFrameTask=!0,this._pendingUpdates=0,this._hasPendingUpdates=!1,this._updateAllTilesStatus(i),this._sortTiles(i);const e=!this.view.state.fixedContentCamera;this._mergeAndSplit(i,e),this._updateElevation(i),this._updateTextures(i),e||this._mergeAndSplit(i,!0),this._inFrameTask=!1,this._runViewChangeUpdateIfDirty(),this._batchUpdatePendingTileGeometries(),this._emitElevationUpdateEventForTiles(),i.done?this.requestUpdate():this.getUsedMemory(),this.notifyChange("updatingProgressValue")}_updateAllTilesStatus(i){if(!this._viewChanged||!this.rootTiles||i.done)return;this._viewChanged=!1;const e=this._iteratorPool.acquire();e.reset(this.rootTiles);const t=this.snapLevel,n=this._splitLimits,r=this._eyePosRenderSR;for(;!e.done;){const s=e.next(),a=s.shouldSplit(n,r,t);if(a!==Qt.SPLIT){if(s.resetPendingUpdate(Qt.SPLIT)&&s.updateAgentSuspension(),a===Qt.VSPLITMERGE&&s.updateAgents(Li.ELEVATION),e.skipSubtree(),!s.isLeaf){s.setPendingUpdate(Qt.MERGE),s.resetPendingUpdate(Qt.SPLIT);const o=this._iteratorPool.acquire();o.resetOne(s);const l=this._viewProjectionMatrix;for(let c=o.next();!o.done;c=o.next())this._updateClippingStatus(c),c.updateVisibility(),c.updateScreenDepth(l);o.remove()}}else s.resetPendingUpdate(Qt.MERGE),s.isLeaf&&(s.setPendingUpdate(Qt.SPLIT),e.skipSubtree()),s.rendered&&s.setPendingUpdate(Qt.RENDERDATA)}e.remove(),this.requestUpdate(),(this.shortBatches||!this.oneBatchPerFrameTask)&&this._batchUpdatePendingTileGeometries(),i.madeProgress()}_sortTiles(i){i.done||this._allTilesSorted||(Ivt(this._allTiles,this.view.pointsOfInterest.focus.renderLocation),this._allTilesSorted=!0,this._treeDebugger&&this._treeDebugger.update(),i.madeProgress())}_markTileToUpdate(i){yt(i.isLoaded),i.intersectsClippingArea&&(this._pendingTilesToUpdate.add(i),this._markAllTileNeighborsForGeometryUpdate(i))}_batchUpdatePendingTileGeometries(){const i=this._pendingTilesToUpdate;if(i.size===0)return;const e=Array.from(this._pendingTilesToUpdate.keys()).filter(r=>r.isLoaded&&r.intersectsClippingArea),t=(r,s)=>{!(s!=null&&s.isLoaded)||!s.intersectsClippingArea||s.level<r.level||i.has(s)||(i.add(s),e.push(s),s.renderData.updateNeighborData())};e.sort(Dm);const n=e.length;for(let r=0;r<n;++r){const s=e[r];yt(s.isLoaded),yt(s.intersectsClippingArea);const a=s.renderData;a.updateNeighborData();const o=a._dirtyEdgeResolutions,l=a.geometryState.neighborData;for(let c=0;c<4;++c)if(o&1<<c){const u=s.renderData.geometryState.neighborData.edgePeerNeighbors[c];u&&(u==null?void 0:u.level)>=s.level&&u.forAllSubtreeOnSide(fL(zp[c]),d=>!(!d.isLoaded||!d.intersectsClippingArea)&&(yt(i.has(d)||Dm(s,d)<0),t(s,d),!0)),t(s,l.cornerPeerNeighbors[c]),t(s,l.cornerPeerNeighbors[(c+1)%4])}}i.clear(),this._updateTilesGeometries(e),fa&&dL&&this.checkAllTilesWaterproofness()}_mergeAndSplit(i,e){if(this.suspended||i.done||!this._allTilesDirty)return;this._allTilesDirty=!1,this.requestUpdate();let t=!1,n=!1;for(;!i.done;){n=!0;let r=!1;const s=!this._allTiles.some(a=>{var l;if(!t&&!a.loadable)return i.done;let o=a;if(a.resetPendingUpdate(Qt.MERGE)){if(!e)return a.setPendingUpdate(Qt.MERGE),i.done;for(;(l=o.parent)!=null&&l.resetPendingUpdate(Qt.MERGE);)o=o.parent;this._mergeTile(o),r=!0,i.madeProgress()}else a.resetPendingUpdate(Qt.SPLIT)&&(this._splitTile(a),r=!0,i.madeProgress());return!i.done&&o===a&&a.resetPendingUpdate(Qt.RENDERDATA)&&(this._updateRenderData(a),i.madeProgress()),i.done});if(r&&(this._allTilesSorted=!1,this._allTilesDirty=!0),s){if(!t){t=!0;continue}if(!r)break}else this._allTilesDirty=!0}n||(this._allTilesDirty=!0),!this.oneBatchPerFrameTask&&this._batchUpdatePendingTileGeometries(),this._sortTiles(i)}_updateElevation(i){i.done||(this._allTiles.some(e=>(e.resetPendingUpdate(Qt.GEOMETRY)&&(this._updateTileGeometryState(e),this._updateTileTexture(e,i),this.shortBatches&&this._batchUpdatePendingTileGeometries(),i.madeProgress()),i.done)),!this.oneBatchPerFrameTask&&this._batchUpdatePendingTileGeometries())}_updateTextures(i){i.done||this._allTiles.some(e=>(this._updateTileTexture(e,i),i.done))}_updateClippingExtent(){this.spatialReference&&(this.updateTileOverlayParams(ds.UPDATE),this.overlayManager.setPlacementDirty(),this._updateRootTiles())}get _lodBias(){const i=this.view.resourceController.memoryController.memoryFactor;return this.view.qualitySettings.tiledSurface.lodBias-(1-i)*Pnt}_getLodBiasCorrectedScale(i){const e=this.tilingScheme.levels,t=lt(i-this._lodBias,0,e.length-1),n=t-Math.floor(t);return e[Math.floor(t)].scale*(1-n)+e[Math.ceil(t)].scale*n}_removeAllTiles(){T(this.rootTiles)&&(this.rootTiles.forEach(i=>this._purgeTile(i)),this._setRootTiles(null),this.notifyChange("ready")),this._allTiles.clear(),this._visible=!1}_purgeDescendantTiles(i){if(i.isLeaf)return!1;let e=!1;for(let t=0;t<4;++t)e=this._purgeTile(i.children[t])||e;return i.unsetChildren(),e}_purgeTile(i){const e=this._purgeDescendantTiles(i)||i.rendered;return this._allTiles.removeUnordered(i),this._unloadTile(i),this._tilePool.release(i),e}_unloadTile(i){this._pendingTilesToUpdate.delete(i),this._pendingTilesForElevationUpdateEvent.delete(i),i.unload(this._renderer)}_splitTile(i){xp(i.isLeaf,"tile that is already split should not be split again!");const e=i.level+1,t=2*i.lij[1],n=2*i.lij[2];i.setChildren(this._createTile(e,t,n,i),this._createTile(e,t,n+1,i),this._createTile(e,t+1,n,i),this._createTile(e,t+1,n+1,i)),i.setPendingUpdate(Qt.RENDERDATA),i.updateAgentSuspension(),this._allTiles.pushArray(i.children),this._allTilesDirty=!0,++this._performanceInfo.numSplit}_emitTileScaleChange(i,e=i.level){CO.spatialReference=this.spatialReference,CO.extent=i.extent,CO.scale=this._getLodBiasCorrectedScale(e),this.emit("scale-change",CO)}_createTile(i,e,t,n){xp(!!n,"_createTile sanity check");const r=this._acquireTile(i,e,t,n);return r.updateClippingStatus(this.extent),r.updateScreenDepth(this._viewProjectionMatrix),this._shouldSplit(r)&&r.setPendingUpdate(Qt.SPLIT),r}get shortBatches(){return this.view.state.mode!==Ap.IDLE}_mergeTile(i){xp(!i.hasPendingUpdate(Qt.SPLIT),"_mergeTile sanity check"),this._purgeDescendantTiles(i)&&(xp(!i.renderData,"_mergeTile sanity check"),this._loadTile(i),this._markTileToUpdate(i),this._emitTileScaleChange(i),this.shortBatches&&this._batchUpdatePendingTileGeometries()),this._allTilesDirty=!0,++this._performanceInfo.numMerged}_loadChildren(i){xp(i.rendered,"parent should be rendered"),this._unloadTile(i);const e=i.children;e.forEach(t=>this._loadTile(t)),e.forEach(t=>this._pendingTilesToUpdate.add(t)),this._markAllTileNeighborsForGeometryUpdate(i),this._emitTileScaleChange(i,i.level+1),this.shortBatches&&this._batchUpdatePendingTileGeometries()}_loadParent(i){const e=i.parent;this._unloadChildren(e),this._loadTile(e),this._markTileToUpdate(e),this._emitTileScaleChange(e,e.level),this.shortBatches&&this._batchUpdatePendingTileGeometries()}_unloadChildren(i){if(!i.isLeaf)for(let e=0;e<4;++e){const t=i.children[e];this._unloadChildren(t),this._unloadTile(t)}}_loadTile(i){i.load(),i.setPendingUpdate(Qt.RENDERDATA),this.requestUpdate(),this._allTilesDirty=!0,this.overlayManager&&this.overlayManager.hasOverlays&&this.overlayManager.setTileParameters(i)}_elevationDataArrived(i,e,t){const n=new fvt(i.lij,i.extent,t);i.dataArrived(e,Li.ELEVATION,n);const r=[i],s=i.level,a=this._iteratorPool.acquire();for(a.reset(r);!a.done;){const o=a.next();o.findElevationBoundsForLayer(e,s),o.computeElevationBounds()}s===0&&this._updateRootTileElevationBounds(),a.remove(),this._updateTilesVisibility(r)}_handleLayerViewChanges(i=WL){if(!this._layerViewsDirty)return;this._layerViewsDirty=!1;let e=!1;const t=new Set;let n=-1;for(const r of this.view.allLayerViews.items)if(t.add(r.uid),AA(r)||ZT(r))if(this._basemapLayerViewHandles.has(r.uid)&&!ZT(r)){const s=this._layerClassFromLayerView(r),a=this._getLayerIdxByUID(s,r.uid);T(a)&&((a<n||B(n))&&(e=!0),n=a)}else this._registerTiledLayerView(r),r.layer.loaded&&(e=!0);this._basemapLayerViewHandles.forEach((r,s)=>{t.has(s)||(this._unregisterTiledLayerView(s),e=!0)}),e&&this._updateTiledLayers(),this._renderer.transparency=this._allSurfaceLayersTransparent()?Ao.Invisible:this._renderer.transparency,this.hasCompositeBlendMode=this._hasCompositeBlendMode(),i.madeProgress()}_allSurfaceLayersTransparent(){var e,t;let i=((t=(e=this.view.map)==null?void 0:e.ground)==null?void 0:t.opacity)===0;for(const n of this.view.allLayerViews.items)if(a8(n)&&!vne(n.layer)&&n.fullOpacity!==0)return i=!1,i;return i}_hasCompositeBlendMode(){for(const i of this.view.allLayerViews.items)if((pL(i)||ZT(i))&&Bvt(u8[i.layer.blendMode]))return!0;return!1}_layerClassFromLayerView(i){return s8(i)?Li.ELEVATION:Li.MAP}_registerTiledLayerView(i){const e=[];if((pL(i)||ZT(i))&&e.push(ue(()=>i.layer.blendMode,()=>{this.hasCompositeBlendMode=this._hasCompositeBlendMode(),this._updateTileTextures(ha.UNFADED)})),ZT(i))return;const t=this._layerClassFromLayerView(i);e.push(ue(()=>i.suspended,()=>this._updateTiledLayers())),e.push(ue(()=>i.fullOpacity,()=>this._updateTileTextures(ha.UNFADED))),e.push(ue(()=>"effectiveScaleRange"in i.layer?i.layer.effectiveScaleRange:null,()=>this._restartAllAgents(t))),i.on("data-changed",()=>{const n=this._getLayerIdxByUID(t,i.uid);T(n)&&this._invalidateLayerData(n,t)}),this._basemapLayerViewHandles.set(i.uid,e)}_unregisterTiledLayerView(i){const e=this._basemapLayerViewHandles.get(i);if(e){for(let t=0;t<e.length;t++)e[t].remove();this._basemapLayerViewHandles.delete(i)}}_updateTiledLayers(){if(!this.tilingScheme||this.view.suspended)return;const i=this.view.allLayerViews,e=[[],[]];let t=null;i.forEach(n=>{if(!n.layer||n.suspended||!AA(n)||!n.fullExtent)return;const r=this._layerClassFromLayerView(n);if(r===Li.MAP){const s=n.displayLevelRange.maxLevel;s!==1/0&&(t===null||s>t)&&(t=s)}e[r].push(n)});for(const n of U_){const r=this._layerViews[n],s=e[n];s.reverse();const a=s.length;let o=r.length!==a;const l=new Array(a),c=new Array(r.length);this._layerIndexByUid[n].clear();for(let u=0;u<a;u++){const d=s[u].uid;this._layerIndexByUid[n].set(d,u);const h=r.indexOf(s[u]);l[u]=h,u!==h&&(o=!0),h>-1&&(c[h]=u)}if(o){const u=this._postorderIterator;for(u.reset(this.rootTiles);!u.done;)u.next().modifyLayers(c,l,n);this._layerViews[n]=s,this._restartAllAgents(n),this._updateTilesVisibility(this.rootTiles)}}this.tilingScheme.ensureMaxLod(t)&&this._viewChangeUpdate()}_restartAllAgents(i){const e=this._postorderIterator;for(e.reset(this.rootTiles);!e.done;){const t=e.next();t.restartAgents(i),i===Li.ELEVATION&&t.computeElevationBounds()}this._updateRootTileElevationBounds()}layerViewByIndex(i,e){return this._layerViews[e][i]}numLayers(i){return this._layerViews[i].length}_updateTileTextures(i){this._allTiles.forAll(e=>{e.updateAgents(Li.MAP),i===ha.IMMEDIATE?this.renderer.updateTileTexture(e,Qt.TEXTURE_NOFADING):e.updateRenderData(Li.MAP,i)}),this._renderer.transparency=this._allSurfaceLayersTransparent()?Ao.Invisible:this._renderer.transparency}_invalidateLayerData(i,e){this._allTiles.forAll(t=>t.removeLayerAgent(i,e)),this._allTiles.forAll(t=>t.invalidateLayerData(i,e))}setTileTreeDirty(){this._allTilesDirty=!0}requestRender(i=ds.UPDATE){this.renderer.setNeedsRender(i)}requestUpdate(){++this._pendingUpdates==1&&(this._hasPendingUpdates=!0)}requestTileData(i,e,t,n){const r=this.layerViewByIndex(e,t),s=r.layer;return!s.tilemapCache||EA(r)?this._requestTileData(i,t,r,n):(++this._asyncWorkItems,s.tilemapCache.fetchAvailability(i.lij[0],i.lij[1],i.lij[2],{...n,timeout:6e3}).then(()=>--this._asyncWorkItems).catch(a=>{throw--this._asyncWorkItems,Cn(n),zo(a)||this._dataMissing(i,t,r,{notInTilemap:!0}),a}).then(()=>this._frameTask.schedule(()=>this._requestTileData(i,t,r,n),n.signal)))}_requestTileData(i,e,t,n){return e===Li.ELEVATION?s8(t)?this._requestElevationTileData(i,t,n):Promise.reject():a8(t)?this._requestMapTileData(i,t,n):Promise.reject()}_requestElevationTileData(i,e,t){++this._asyncWorkItems;const n=a=>{if(bu(t))return;const o=this._layerIndexByUid[Li.ELEVATION].get(e.uid);o!=null?(this._usedMemory=null,this.requestUpdate(),this._elevationDataArrived(i,o,a)):tt.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer %d %s",Li.ELEVATION,i.lij.toString())},r=a=>{zo(a)||(this._dataMissing(i,Li.ELEVATION,e,a),this.requestUpdate())};if(TJ(e.layer))return e.layer.fetchTile(i.lij[0],i.lij[1],i.lij[2],{noDataValue:lA,signal:t.signal}).then(a=>{if(!bu(t))return this._frameTask.schedule(()=>n(a),t.signal,r);tt.getLogger(this.declaredClass).warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true.")},r).finally(()=>{--this._asyncWorkItems});const s=e.getTileUrl(i.lij[0],i.lij[1],i.lij[2]);return this._elevationDataRequester.request(s,"binary",t).then(a=>this._lercDecoder.decode(a,{noDataValue:lA},t.signal)).then(a=>{a?n({values:a.pixelData,width:a.width,height:a.height,noDataValue:a.noDataValue,minValue:a.minValue,maxValue:a.maxValue}):r(new Error("LERC decoding failed"))},r).finally(()=>{--this._asyncWorkItems})}_requestMapTileData(i,e,t){++this._asyncWorkItems;const n=(c,u)=>{--this._asyncWorkItems,Sx(u),bu(t)||(this._dataMissing(i,Li.MAP,e,c),this.requestUpdate())},r=c=>u=>n(u,c),s=c=>this._frameTask.schedule(()=>{--this._asyncWorkItems,this.requestUpdate(),bu(t)?Sx(c):this._mapTileDataArrived(i,e,c)},t.signal,r(c)).catch(r(c)),a=(c,u=null)=>this._frameTask.schedule(()=>n(c,u));if(EA(e)){const c=e.schemaHelper.getLevelRowColumn(i.lij);return e.fetchTile(c[0],c[1],c[2],t).then(s,a)}if(TD(e))return e.fetchTile(i.lij[0],i.lij[1],i.lij[2],t).then(s,a);if(eH(e)&&TJ(e.layer))return e.layer.fetchTile(i.lij[0],i.lij[1],i.lij[2],t).then(c=>{if(bu(t))return tt.getLogger(this.declaredClass).warnOnce("A call to fetchTile resolved even though the request was aborted. fetchTile should not resolve if options.signal.aborted is true."),void a(js());s(c)},a);let o=e.getTileUrl(i.lij[0],i.lij[1],i.lij[2]);Uwe(e.layer)&&e.layer.refreshTimestamp&&(o+=`${o.includes("?")?"&":"?"}_ts=${e.layer.refreshTimestamp}`);const l=e.hasMixedImageFormats?"image+type":"image";return this._mapDataRequester.request(o,l,t).then(s,a)}_mapTileDataArrived(i,e,t){const n=this._getLayerIdxByUID(Li.MAP,e.uid);T(n)?i.dataArrived(n,Li.MAP,t):(Sx(t),tt.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer"))}_getLayerIdxByUID(i,e){return this._layerIndexByUid[i].get(e)}_dataMissing(i,e,t,n){const r=this._getLayerIdxByUID(e,t.uid);T(r)?i.dataMissing(r,e,n):tt.getLogger(this.declaredClass).warn("TerrainSurface: received data from unknown layer")}updateTileOverlayParams(i){this.rootTiles&&this.overlayManager&&(this._allTiles.forAll(e=>{e.renderData&&this.overlayManager.setTileParameters(e)}),this._renderer.setNeedsRender(i))}get performanceInfo(){const i=this._performanceInfo;return i.numNodes=this._allTiles.length,i.numLeaves=i.numVisible=i.numRendered=i.numLoadedPerLevel.length=i.numRenderedPerLevel.length=0,this._allTiles.forAll(e=>{e.isLeaf&&i.numLeaves++;const t=e.level;e.renderData&&(i.numLoadedPerLevel[t]=(i.numLoadedPerLevel[t]||0)+1),e.visible&&(i.numVisible++,e.rendered&&(i.numRenderedPerLevel[t]=(i.numRenderedPerLevel[t]||0)+1,i.numRendered++))}),i}getUsedMemory(){return this.tilingScheme?(B(this._usedMemory)&&(this._usedMemory=this._recalculateUsedMemory()),T(this._usedMemory)?this._usedMemory:0):0}_recalculateUsedMemory(){return this.tilingScheme?this._allTiles.reduce((i,e)=>i+e.usedMemory,0):null}getUsedMemoryForLayerView(i){let e=0;const t=this._layerClassFromLayerView(i),n=this._getLayerIdxByUID(t,i.uid);return T(n)&&this._allTiles.forAll(r=>e+=r.getUsedMemoryForLayer(t,n)),e}getTile(i){if(B(i)||B(this.rootTiles))return null;const e=i.split("/").map(a=>+a);if(e[0]===0)return this.rootTiles.find(a=>a.lij[1]===e[1]&&a.lij[2]===e[2]);const t=2**e[0],n=Math.floor(e[1]/t),r=Math.floor(e[2]/t);let s;if(this.rootTiles.some(a=>a.lij[1]===n&&a.lij[2]===r&&(s=a,!0)),s){let a=1<<e[0]-1;for(;s.lij[0]<e[0];){let o=e[1]&a?2:0;if((e[2]&a)>0&&o++,!s.children[o])return null;s=s.children[o],a>>=1}return xp(s.lij[0]===e[0]&&s.lij[1]===e[1]&&s.lij[2]===e[2],"not the right tile?"),s}return null}get renderPatchBorders(){return this._renderer.renderPatchBorders}set renderPatchBorders(i){this._renderer.renderPatchBorders=i}get visualizeNormals(){return this._renderer.visualizeNormals}set visualizeNormals(i){this._renderer.visualizeNormals=i}get renderingDisabled(){return this._renderer.renderingDisabled}set renderingDisabled(i){this._renderer.renderingDisabled=i}get test(){const i=this;return{renderer:i._renderer,lercDecoder:i._lercDecoder,forceReload:()=>{T(i.rootTiles)&&(i._mergeTile(i.rootTiles[0]),i._viewChangeUpdate())},getTiles:()=>i._allTiles.toArray(),getRenderedTiles(){B4.clear(),i._allTiles.forAll(t=>{t.visible&&t.rendered&&B4.push(t)});const e=B4.toArray();return ame(i.renderOrder,e),e},lockTilingScheme(e,t){i._extentHelper.defaultTiledLayersExtent=t,i.tilingSchemeLogic.test.lockTilingScheme(e)}}}checkAllTilesWaterproofness(){if(!dL)return;const i=this.rootTiles;if(B(i))return;const e=s=>{var a,o,l;return((l=(o=(a=s==null?void 0:s.renderData)==null?void 0:a.geometryInfo)==null?void 0:o.indices)==null?void 0:l.length)>0},t=(s,a)=>{e(s)&&console.error("Tile[",s.lij,"] has geometry although parent[",a.lij,"] has geom")},n=s=>{var a,o;if(s.intersectsClippingArea)if(s.renderData&&!s.renderData.geometryState&&console.error("Tile[",s.lij,"] has renderData but not geometryState"),s.renderData&&!s.renderData.geometryInfo&&console.error("Tile[",s.lij,"] has renderData but not geometryInfo"),!((a=s.renderData)!=null&&a.geometryInfo)||(((o=s.renderData.geometryInfo.indices)==null?void 0:o.length)??0)>0||console.error("Tile[",s.lij,"] has renderData but no indices - geometryInfo: ",s.renderData.geometryInfo),e(s)){s.checkGeometryWaterproofness();for(const l of s.children)t(l,s)}else if(s.isLeaf)console.error("Tile[",s.lij,"] has no geometry and no children, from root to leaf");else for(const l of s.children)n(l)},r=s=>{var c;const a=((c=s.parent)==null?void 0:c.visible)??!0,o=s.visible;s.computeVisibility();const l=s.visible;if(o!==l&&a&&console.error(" Tile[",s.lij,"] has out of date visibility: ",o," instead of ",l),!s.isLeaf)for(const u of s.children)r(u)};for(const s of i)n(s),r(s)}get isGlobal(){return this._isGlobal}get shading(){return this._shading}_updateShadingIfChanged(){var e,t,n;((n=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:n.shading)!==this._shading&&this._updateShading()}_updateShading(){var e,t,n;const i=(n=(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.ground)==null?void 0:n.shading;this._shading=i,this.renderer&&(this.renderer.shading=i,this.renderer.setNeedsRender()),this._updateAllTileGeometries()}get isWebMercator(){return this._isWebMercator}get isWebMercatorOnPlateeCarree(){return this._isWebMercatorOnPlateeCarree}isEastEndWrap(i){return this.isGlobal&&i[2]===this.lijEastEnd(i[0])-1}isWestEndWrap(i){return this.isGlobal&&i[2]===0}lijEastEnd(i){return 2**(i+(T(this.spatialReference)&&this.spatialReference.isGeographic?1:0))}wrapEastWest(i){const e=this.lijEastEnd(i[0]),t=i[2];if(0<=t&&t<e)return i;if(!this.isGlobal)return null;const n=(t+(t<0?e:0))%e;return[i[0],i[1],n]}enableInternalChecks(i){Agt(i)}enableWaterproofnessChecks(i){Egt(i)}};f([y()],Pi.prototype,"_renderer",void 0),f([y()],Pi.prototype,"_hasPendingUpdates",void 0),f([y()],Pi.prototype,"_asyncWorkItems",void 0),f([y()],Pi.prototype,"_allTilesDirty",void 0),f([y()],Pi.prototype,"_allTilesSorted",void 0),f([y()],Pi.prototype,"_viewChanged",void 0),f([y({readOnly:!0})],Pi.prototype,"_watchUpdatingTracking",void 0),f([y()],Pi.prototype,"_frameTask",void 0),f([y({readOnly:!0})],Pi.prototype,"snapLevel",null),f([y({readOnly:!0})],Pi.prototype,"lodSnapping",null),f([y({constructOnly:!0})],Pi.prototype,"view",void 0),f([y()],Pi.prototype,"_userClippingExtent",null),f([y()],Pi.prototype,"_rootTilesExtent",void 0),f([y({readOnly:!0})],Pi.prototype,"extent",null),f([y({readOnly:!0})],Pi.prototype,"groundExtent",null),f([y({readOnly:!0})],Pi.prototype,"_tilingSchemeExtent",null),f([y({readOnly:!0})],Pi.prototype,"updating",null),f([y({readOnly:!0})],Pi.prototype,"running",null),f([y(pvt)],Pi.prototype,"updatingProgress",void 0),f([y({readOnly:!0})],Pi.prototype,"updatingProgressValue",null),f([y()],Pi.prototype,"_maxNumUpdating",void 0),f([y()],Pi.prototype,"baseOpacity",null),f([y()],Pi.prototype,"hasCompositeBlendMode",void 0),f([y({readOnly:!0})],Pi.prototype,"overlayManager",void 0),f([y({readOnly:!0})],Pi.prototype,"viewingMode",null),f([y()],Pi.prototype,"maxTextureScale",void 0),f([y({readOnly:!0})],Pi.prototype,"ready",null),f([y({value:OA.FRONT_TO_BACK})],Pi.prototype,"renderOrder",null),f([y({readOnly:!0})],Pi.prototype,"rootTiles",void 0),f([y({readOnly:!0})],Pi.prototype,"spatialReference",null),f([y({type:Xt})],Pi.prototype,"backgroundColor",null),f([y({value:!1})],Pi.prototype,"slicePlaneEnabled",null),f([y({readOnly:!0})],Pi.prototype,"tilingScheme",void 0),f([y({readOnly:!0})],Pi.prototype,"tilingSchemeLocked",null),f([y({readOnly:!0})],Pi.prototype,"tilingSchemeLogic",void 0),f([y({value:!0})],Pi.prototype,"velvetOverground",null),f([y()],Pi.prototype,"wireframe",null),f([y({value:!1})],Pi.prototype,"suspended",null),f([y()],Pi.prototype,"textureFadeDuration",null),f([y()],Pi.prototype,"visibleElevationBounds",void 0),f([y()],Pi.prototype,"rootTileElevationBounds",void 0),f([y()],Pi.prototype,"_layerViewsDirty",void 0),f([y()],Pi.prototype,"renderPatchBorders",null),f([y()],Pi.prototype,"visualizeNormals",null),f([y()],Pi.prototype,"renderingDisabled",null),Pi=f([ge("esri.views.3d.terrain.TerrainSurface")],Pi);const f_t=Pi;function QJ(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}function $me(i){return!i.isLeaf&&(i.children.some(e=>e.shouldLoad)||i.children.some(e=>$me(e)))}function m_t(i){return i.isLeaf&&i.parent&&i.parent.shouldLoad}const Tl=Dn(),g_t=qi(),xO=[0,0,0],B4=new pn,z4={spatialReference:null,extent:qi(),context:"ground"},CO={spatialReference:null,extent:null,scale:0};function JJ(i,e,t){var n;for(const r of i){if(!r.containsPointXY(e,t))continue;let s=r;for(;s&&!s.renderData;){const o=(e>s.extentMidX?1:0)+(t<s.extentMidY?2:0);s=s.children[o]}const a=((n=s==null?void 0:s.renderData)==null?void 0:n.geometryState.samplerData)??null;return ir(e,t,a)}return null}let v_t=class{constructor(e,t){this.geometryRecord=e,this.renderGeometry=t}},y_t=class{constructor(e,t,n){this.operation=e,this.geometryRecord=t,this.states=n}},NS=class extends et{constructor(e){super(e),this._residentGeomRecords=new Map,this._dirtyGeomRecords=new Map,this.dirty=!1}commit(e){this.dirty=!1,this._dirtyGeomRecords.forEach((t,n)=>this.commitLayer(n,e))}commitLayer(e,t){const n=this._dirtyGeomRecords.get(e);n&&(n.forEach((r,s)=>{const a=this._ensureGeomRecord(e,s);r.forEach(({geometryRecord:o,operation:l,states:c},u)=>{let d=!1;if(l===_r.UPDATE){const h=a.get(u);if(h){const p=h.renderGeometry;if(c&Ls.TRANSFORMATION){const m=this.model.getObject(s);this.model.updateRenderGeometryTransformation(m,o,p)&&(d=!0)}d||t.updates.push({renderGeometry:p,updateType:c})}else Ti(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid update")}if(l===_r.REMOVE||d){const h=a.get(u);h?(t.removes.push(h.renderGeometry),a.delete(u),h.geometryRecord.disposed&&pb.pool.release(h.geometryRecord)):l===_r.REMOVE&&Ti(!1,"ModelDirtySet.getAddRemoveListFilteredByLayers: invalid remove")}if(l===_r.ADD||d){const h=this.model.getObject(s);if(T(h)){const p=this.model.getRenderGeometry(h,o),m=new v_t(o,p);t.adds.push(p),a.set(u,m)}}}),a.size===0&&this._residentGeomRecords.get(e).delete(s)}),this._residentGeomRecords.get(e).size===0&&this._residentGeomRecords.delete(e),this._dirtyGeomRecords.delete(e))}getResidentRenderGeometries(e,t){const n=this._residentGeomRecords.get(e);n&&n.forEach(r=>r.forEach(s=>t.push(s.renderGeometry)))}_objectStateChanged(e,t){for(const n of t.geometryRecords)this._updateOrCreateDirtyRecord(t,n,null,_r.UPDATE,e)}visibilityChanged(e){this._objectStateChanged(Ls.VISIBILITIES,e)}highlightChanged(e){this._objectStateChanged(Ls.HIGHLIGHTS,e)}occlusionChanged(e){this._objectStateChanged(Ls.OCCLUDEES,e)}vertexAttrsUpdated(e){this._updateOrCreateDirtyRecord(e.object,e.record,null,_r.UPDATE,Ls.VERTEXATTRS)}layerAdded(e){e.objects.forAll(t=>this._layerObjectAdded(e,t))}layerRemoved(e){e.objects.forAll(t=>this._layerObjectRemoved(e,t))}layerObjectAdded(e){this._layerObjectAdded(e.layer,e.object)}_layerObjectAdded(e,t){const n=e.id;for(const r of t.geometryRecords)this._objectGeometryAdded(t,r,n)}layerObjectRemoved(e){this._layerObjectRemoved(e.layer,e.object)}layerObjectsAdded(e){for(const t of e.objects)this._layerObjectAdded(e.layer,t)}layerObjectsRemoved(e){for(const t of e.objects)this._layerObjectRemoved(e.layer,t)}_layerObjectRemoved(e,t){const n=e.id;for(const r of t.geometryRecords)this._objectGeometryRemoved(t,r,n)}shaderTransformationChanged(e){const t=this._residentGeomRecords.get(e.id);t&&t.forEach((n,r)=>{const s=this.model.getObject(r);s&&s.hasVolativeTransformation()&&n.forEach(a=>{a.renderGeometry.shaderTransformationChanged()})})}objectTransformation(e){const t=this._getParentLayerId(e),n=e.id;this._ensureGeomRecord(t,n).forEach(r=>{this._updateOrCreateDirtyRecord(e,r.geometryRecord,t,_r.UPDATE,Ls.TRANSFORMATION)})}objectGeometryAdded(e){this._objectGeometryAdded(e.object,e.record)}_objectGeometryAdded(e,t,n=null){this._updateOrCreateDirtyRecord(e,t,n,_r.ADD)}objectGeometryRemoved(e){this._objectGeometryRemoved(e.object,e.record)}_objectGeometryRemoved(e,t,n=null){this._updateOrCreateDirtyRecord(e,t,n,_r.REMOVE)}_updateOrCreateDirtyRecord(e,t,n,r,s=Ls.NONE){n=Jt(n,this._getParentLayerId(e));const a=e.id,o=t.id,l=this._ensureDirtyRecord(n,a),c=l.get(o);if(c){const u=c.operation;u===_r.REMOVE&&r===_r.ADD&&c.states!==Ls.NONE?c.operation=_r.UPDATE:u===_r.REMOVE&&r===_r.ADD||u===_r.ADD&&r===_r.REMOVE?(l.delete(o),c.geometryRecord.disposed&&pb.pool.release(c.geometryRecord)):u!==_r.UPDATE||r!==_r.REMOVE&&r!==_r.UPDATE?(Ti((u===_r.REMOVE||u===_r.ADD)&&r===_r.UPDATE,"ModelDirtySet.objectGeometryAdded: inconsistent state"),c.states|=s):(c.operation=r,c.states|=s)}else l.set(o,new y_t(r,t,s));this.dirty=this._hasDirtyGeometryRecords}_ensureGeomRecord(e,t){let n=this._residentGeomRecords.get(e);n||(n=new Map,this._residentGeomRecords.set(e,n));let r=n.get(t);return r||(r=new Map,n.set(t,r)),r}get _hasDirtyGeometryRecords(){return ps(this._dirtyGeomRecords,e=>ps(e,t=>t&&t.size>0))}_ensureDirtyRecord(e,t){let n=this._dirtyGeomRecords.get(e);n||(n=new Map,this._dirtyGeomRecords.set(e,n));let r=n.get(t);return r||(r=new Map,n.set(t,r)),r}_getParentLayerId(e){return T(e.parentLayer)?e.parentLayer.id:aye}formatDebugInfo(){const e=["ADD","UPD",void 0,"REM"];let t="";return this._dirtyGeomRecords.forEach((n,r)=>{n.forEach((s,a)=>{t.length>0&&(t+=`
`),t+=r+"."+a;const o=[];s.forEach(l=>{const c=l.operation;o[c]||(o[c]=[]),o[c].push(l.geometryRecord.geometry.id)});for(let l=0;l<o.length;l++)if(o[l]){t+=" "+e[l-1]+": ";for(let c=0;c<o[l].length;c++)t+=o[l][c]+", "}})}),t}get test(){const e=this;return{get residentLayerCount(){return e._residentGeomRecords.size},get residentObjectCount(){return Array.from(e._residentGeomRecords.values()).reduce((t,n)=>t+n.size,0)}}}};f([y({constructOnly:!0})],NS.prototype,"model",void 0),f([y()],NS.prototype,"dirty",void 0),NS=f([ge("esri.views.3d.webgl-engine.lib.ModelDirtySet")],NS);const __t=NS;let vI=class extends et{constructor(){super(...arguments),this.dirtySet=new __t({model:this}),this._content=new Map,this._originFactory=new O7(null)}getObject(e){return this._content.get(e)}add(e){const t=e.id;Ti(!this._content.has(t),"Model/Stage already contains object to be added"),this._content.set(t,e),nL(e)&&this.dirtySet.layerAdded(e)}remove(e){Ti(this._content.has(e.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(e.id),e.unload(),nL(e)&&this.dirtySet.layerRemoved(e)}addMany(e){for(const t of e)T(t)&&(Ti(!this._content.has(t.id),"Model/Stage already contains object to be added"),this._content.set(t.id,t))}removeMany(e){for(const t of e)Ti(this._content.has(t.id),"Model/Stage doesn't contain object to be removed"),this._content.delete(t.id),t.unload()}has(e){return this._content.has(e.id)}forEachOfType(e,t){this._content.forEach(n=>{n.type===e&&t(n)})}getRenderGeometry(e,t){const{geometry:n,material:r,id:s,shaderTransformation:a,origin:o,instanceParameters:l}=t,c=new wC(n,r,{id:s,boundingInfo:n.boundingInfo,calculateShaderTransformation:a,castShadow:e.castShadow});return c.updateTransformation(u=>e.getCombinedStaticTransformation(t,u)),c.origin=T(o)?o:this._originFactory.getOrigin(c.boundingSphere),c.instanceParameters=l,c}updateRenderGeometryTransformation(e,t,n){if(B(e))return!1;n.updateTransformation(s=>e.getCombinedStaticTransformation(t,s));const r=this._originFactory.getOrigin(n.boundingSphere);return n.origin!==r}getStats(){const e={},t=Array.from(this._content.values());for(let n=0;n<LC.COUNT;++n)e[n]=t.filter(r=>r.type===n).length;return{contentTypes:e,dirtySet:this.dirtySet.formatDebugInfo()}}get test(){return{content:Array.from(this._content.values())}}};f([y({constructOnly:!0})],vI.prototype,"dirtySet",void 0),vI=f([ge("esri.views.3d.webgl-engine.parts.Model")],vI);let b_t=class{constructor(e){this._totalCount=e,this._indexRanges=[0,e]}allVisible(){return this.componentCount()===this._totalCount}allInvisible(){return this._indexRanges.length===0}componentCount(){const e=this._indexRanges;let t=0;for(let n=0;n<e.length;n+=2)t+=e[n+1];return t}reset(e){e==="all"||e.length===this._totalCount?this._indexRanges=[0,this._totalCount]:this._indexRanges=w_t(e)}forEachComponent(e){const t=this._indexRanges;for(let n=0;n<t.length;n+=2){const r=t[n],s=r+t[n+1];for(let a=r;a<s;a++)if(!e(a))return!1}return!0}forEachComponentRange(e){const t=this._indexRanges;for(let n=0;n<t.length;n+=2){const r=t[n];if(!e(r,r+t[n+1]))return!1}return!0}computeOffsetRanges(e){const t=new Array(this._indexRanges.length),n=this._indexRanges;for(let r=0;r<n.length;r+=2){const s=n[r],a=s+n[r+1],o=e[s],l=e[a];t[r]=o,t[r+1]=l-o}return t}};function w_t(i){const e=new Array;if(i.length===0)return e;let t=i[0],n=1;for(let r=1;r<i.length;r++){const s=i[r];t+n===s?n+=1:(e.push(t),e.push(n),t=s,n=1)}return e.push(t),e.push(n),e}let x_t=class extends yD{constructor(e,t){super(),this.pickability=null,this.highlightCounts=null,this.verticalOffsets=null,this.cachedGeometryRanges=null,this.cachedHighlightRanges=null,this.cachedDefaultRanges=null,this.offsets=vie(t);const n=this.count;this.visibility=new b_t(n),this.materialDataBuffer=e.getBuffer(n),this.materialDataIndices=new Uint16Array(n);for(let r=0;r<n;r++)this.materialDataIndices[r]=this.materialDataBuffer.acquireIndex()}dispose(){super.dispose();for(let e=0;e<this.count;e++)this.materialDataBuffer.releaseIndex(this.materialDataIndices[e])}get count(){return this.offsets.length-1}get geometryRanges(){return B(this.cachedGeometryRanges)&&(this.cachedGeometryRanges=this.visibility.computeOffsetRanges(this.offsets)),this.cachedGeometryRanges}get highlightRanges(){return B(this.highlightCounts)?null:(this._updateCachedHighlightRanges(),this.cachedHighlightRanges)}get defaultShadowMapRanges(){return B(this.highlightCounts)?this.geometryRanges:(this._updateCachedHighlightRanges(),this.cachedDefaultRanges)}highlightsDirty(){this.cachedHighlightRanges=null,this.cachedDefaultRanges=null}visibilityDirty(){this.cachedGeometryRanges=null,this.highlightsDirty()}_updateCachedHighlightRanges(){if((B(this.cachedHighlightRanges)||B(this.cachedDefaultRanges))&&T(this.highlightCounts)){const{highlightRanges:e,defaultRanges:t}=C_t(this.highlightCounts,this.visibility,this.offsets);this.cachedHighlightRanges=e,this.cachedDefaultRanges=t}}};function C_t(i,e,t){const n=[],r=[];let s=t.length,a=t.length;return e.forEachComponent(o=>(i[o]>0?(s!==o-1&&(n.length&&n.push(t[s+1]-n[n.length-1]),n.push(t[o])),s=o):(a!==o-1&&(r.length&&r.push(t[a+1]-r[r.length-1]),r.push(t[o])),a=o),!0)),n.length&&n.push(t[s+1]-n[n.length-1]),r.length&&r.push(t[a+1]-r[r.length-1]),{highlightRanges:n,defaultRanges:r}}let f8=class extends yD{constructor(){super(...arguments),this.visible=Ax.Hidden}};var Ax;f([qa()],f8.prototype,"renderable",void 0),f([qa()],f8.prototype,"components",void 0),function(i){i[i.Hidden=0]="Hidden",i[i.Visible=1]="Visible"}(Ax||(Ax={}));function T_t(i,e,t,n){if(t>=e)return i;i==null&&(i=S_t());const r=i.isVisibleBit;let s=i.data;const a=Dme(s),o=t/a|0,l=t-a*o,c=(e-1)/a|0,u=s,d=n===r;if(!(t<u.length*a)&&d){const p=o+1,m=Math.ceil(u.length*1.5),g=c+1;let _=Math.max(p,m);_=Math.min(_,g),s=new Uint32Array(_),s.set(u)}return o<s.length&&(s[o]=A_t(s[o],l,d)),i.data=s,i}function Lme(i,e){if(i==null)return!0;const{isVisibleBit:t,data:n}=i,r=Dme(n);return e<n.length*r?E_t(t,n,e,r):!i.isVisibleBit}function S_t(i=!0){return{isVisibleBit:!i,data:new Uint32Array(0)}}function E_t(i,e,t,n){const r=t/n|0,s=t-r*n;return M_t(e[r],s)===i}function Dme(i){return i.BYTES_PER_ELEMENT*8}function A_t(i,e,t){return i&~(1<<e)|(t?1:0)<<e}function M_t(i,e){return(i&1<<e)!=0}let P_t=class{constructor(e,t){this._indices=T(e.indices)?e.indices:nz(e.positions.length/3),this._positions=new xy(e.positions),this._components=t,this._componentIntersectionData=new Array(t.count)}getComponentAabb(e,t){if(T(this._perComponentAabbs)){for(let n=0;n<6;n++)t[n]=this._perComponentAabbs[6*e+n];return t}return this._computePerComponentAabbs(),this.getComponentAabb(e,t)}getComponentPositions(e,t){t.indices=this._indices,t.data=this._positions.typedBuffer,t.stride=this._positions.typedBufferStride,t.startIndex=this._components.offsets[e],t.endIndex=this._components.offsets[e+1]}intersect(e,t,n,r,s,a,o){const l={data:this._positions.typedBuffer,stride:this._positions.typedBufferStride,size:3},c=this._indices,u=this._components.offsets,d=Obe(e,t,O_t),h=e[2],p=t[2];this._components.visibility.forEachComponent(m=>{if(!Lme(this._components.pickability,m))return!0;const g=this.getComponentAabb(m,R_t);if(T(a)){const C=a[m];T(s)?s.componentOffset=C:(e[2]=h-C,t[2]=p-C)}if(T(s)&&s.applyToAabb(g),!$ne(g,e,d,n))return!0;const _=u[m]/3,b=u[m+1]/3,x=(C,S,E)=>{o(m,C,Lp(S,S,r),E)},w=b-_;return B(s)&&w>Rme?(this._componentIntersectionData[m]==null&&(this._componentIntersectionData[m]=new RA(this._indices,_,b,l)),this._componentIntersectionData[m].intersectRay({r0:e,r1:t},x)):KB(e,t,_,b,c,l,void 0,s,x),!0})}_computePerComponentAabbs(){const e=this._components.count;this._perComponentAabbs=new Float32Array(6*e);const t=this._indices,n=this._positions.typedBuffer,r=this._positions.typedBufferStride,s=this._components.offsets;let a=0;for(let o=0;o<e;o++){const l=s[o],c=s[o+1];let u=1/0,d=1/0,h=1/0,p=-1/0,m=-1/0,g=-1/0;for(let _=l;_<c;_++){const b=t[_]*r,x=n[b],w=n[b+1],C=n[b+2];u=Math.min(u,x),d=Math.min(d,w),h=Math.min(h,C),p=Math.max(p,x),m=Math.max(m,w),g=Math.max(g,C)}this._perComponentAabbs[a++]=u,this._perComponentAabbs[a++]=d,this._perComponentAabbs[a++]=h,this._perComponentAabbs[a++]=p,this._perComponentAabbs[a++]=m,this._perComponentAabbs[a++]=g}}get positions(){return this._positions}get indices(){return this._indices}};const O_t=q(),R_t=Go();let I_t=class{constructor(e,t,n){this.material=e,this.geometry=t,this.meta=n}dispose(){this.material.dispose(),this.geometry.dispose()}},kme=class extends yD{constructor(e,t,n,r){super(),this.primitiveType=t,this.parameters=n,this.indexed=r,this.vao=e}};f([qa()],kme.prototype,"vao",void 0);function $_t(i,e){return{near:i,far:e}}function bM(i){return i?IA(i,1/0,-1/0):$_t(1/0,-1/0)}function IA(i,e,t){return i.near=e,i.far=t,i}function CC(i,e,t=i){return t.near=Math.min(i.near,e.near),t.far=Math.max(i.far,e.far),t}function TO(i,e){return i.near<=e&&e<=i.far}const m8={near:0,far:0};function L_t(i,e){const t=bM(),{eye:n,frustum:r,viewForward:s}=i;e.forAll(a=>{const o=T(a.offsetObb)?a.offsetObb:a.obb,l=dt(pr(ru,o.center,n),s),c=K1e(o,s);if(TO(t,l-c)&&TO(t,l+c))return;const u=V_t(o,r);if(u===-1)return;if(u===0)return zf.far=l+c,zf.near=l-c,void CC(t,zf);const d=SO.pushNew();d.near=l-c,d.far=l+c,d.mask=u,d.object=a});for(let a=0;a<SO.length;a++){const o=SO.data[a];if(TO(t,o.near)&&TO(t,o.far))continue;zf.far=o.far,zf.near=1/0,N_t(T(o.object.offsetObb)?o.object.offsetObb:o.object.obb,n,D_t,c=>{let u=k_t;for(let d=0;d<Fme&&c.length>0;d++){if(!(o.mask&1<<d))continue;F_t(r[d],c,u);const h=c;c=u,u=h}for(let d=0;d<c.length;d+=3){je(kl,c.data[d+0],c.data[d+1],c.data[d+2]);const h=dt(pr(kl,kl,n),s);zf.near=Math.min(zf.near,h)}})===0&&(zf.near=0),CC(t,zf)}return SO.length=0,t}const SO=new pn({allocator:i=>i||{near:1/0,far:-1/0,mask:0,object:null},deallocator:i=>(i.object=RN(i.object),i)}),zf=bM(),kl=q(),x_=q(),D_t=new pn({deallocator:null}),k_t=new pn({deallocator:null});function F_t(i,e,t){t.length=0;const n=e.length-3;U4(kl,e,n);const r=tr(i,kl);r<=0&&(t.push(kl[0]),t.push(kl[1]),t.push(kl[2]));let s=0,a=r;for(;s<n;s+=3){U4(x_,e,s);const o=tr(i,x_);a*o<0&&(oo(kl,x_,kl,o/(o-a)),Fl(t,kl)),o<=0&&Fl(t,x_),a=o,Ge(kl,x_)}a*r<0&&(U4(x_,e,n),oo(kl,x_,kl,r/(r-a)),Fl(t,kl))}function U4(i,e,t){return je(i,e.data[t+0],e.data[t+1],e.data[t+2])}function Fl(i,e){i.push(e[0]),i.push(e[1]),i.push(e[2])}function N_t(i,e,t,n){R1e(tee,i.quaternion),pr(ru,e,i.center),HN(ru,ru,tee);const r=8*((ru[0]<-i.halfSize[0]?-1:ru[0]>i.halfSize[0]?1:0)+3*(ru[1]<-i.halfSize[1]?-1:ru[1]>i.halfSize[1]?1:0)+9*(ru[2]<-i.halfSize[2]?-1:ru[2]>i.halfSize[2]?1:0)+13),s=eee[r];if(s===0)return s;s0e(EO,i.quaternion),ene(EO,EO,i.halfSize);const a=(o,l)=>{const c=eee[r+l+1];return je(o,((1&c)<<1)-1,(2&c)-1,((4&c)>>1)-1),Lp(o,o,EO),rt(o,i.center,o)};return t.length=0,Fl(t,a(H4,0)),Fl(t,a(iee,1)),Fl(t,a(ru,2)),Fl(t,a(nee,3)),n(t),s===1||(t.length=0,Fl(t,H4),Fl(t,nee),Fl(t,a(ru,4)),Fl(t,a(ree,5)),n(t),s===2||(t.length=0,Fl(t,H4),Fl(t,ree),Fl(t,a(ru,6)),Fl(t,iee),n(t))),s}const eee=(()=>{const i=new Int8Array(216);let e=0;const t=n=>{for(let r=0;r<n.length;r++)i[e+r]=n[r];e+=8};return t([3,0,6,2,3,1,5,4]),t([2,0,2,3,1,5,4,0]),t([3,1,0,2,3,7,5,4]),t([2,0,1,3,2,6,4,0]),t([1,0,1,3,2,0,0,0]),t([2,1,5,7,3,2,0,0]),t([3,2,0,1,3,7,6,4]),t([2,2,0,1,3,7,6,0]),t([3,3,0,1,5,7,6,2]),t([2,0,1,5,4,6,2,0]),t([1,0,1,5,4,0,0,0]),t([2,1,3,7,5,4,0,0]),t([1,0,2,6,4,0,0,0]),t([0,0,0,0,0,0,0,0]),t([1,1,3,7,5,0,0,0]),t([2,2,3,7,6,4,0,0]),t([1,2,3,7,6,0,0,0]),t([2,3,1,5,7,6,2,0]),t([3,4,0,1,5,7,6,2]),t([2,5,7,6,4,0,1,0]),t([3,5,0,1,3,7,6,4]),t([2,4,5,7,6,2,0,0]),t([1,4,5,7,6,0,0,0]),t([2,5,1,3,7,6,4,0]),t([3,6,0,2,3,7,5,4]),t([2,6,2,3,7,5,4,0]),t([3,7,6,2,3,1,5,4]),i})(),Fme=4;function V_t(i,e){let t=0;for(let n=0;n<Fme;n++){const r=Y1e(i,e[n]);if(r>0)return-1;r===0&&(t|=1<<n)}return t}const EO=Ho(),tee=n5(),ru=q(),H4=q(),iee=q(),nee=q(),ree=q();let B_t=class{constructor(e){this._objects=e}submit(e,t){this._objects.preSubmit(t),this._objects.visibleObjects.forAll(n=>n.renderable.material.submit(e,t,n))}queryShadowCasterDepthRange(e){return this._objects.visibleObjects.length?L_t(e,this._objects.visibleObjects):null}};function z_t(i){const e=Js().vec3f(j.POSITION);return i.normals&&e.vec2i16(j.NORMALCOMPRESSED,{glNormalized:!0}),i.textureCoordinates===yy.Default?e.vec2f(j.UV0):i.textureCoordinates===yy.Atlas&&(e.vec2f(j.UV0),e.vec4u16(j.UVREGION,{glNormalized:!0})),i.colors&&e.vec4u8(j.COLOR,{glNormalized:!0}),e.alignTo(4)}let U_t=class extends Cb{constructor(e,t){super(e,"int",WB.Draw,(n,r,s)=>n.setUniform1i(e,t(r,s)))}};var Xp;(function(i){i[i.Uniform=0]="Uniform",i[i.Varying=1]="Varying",i[i.COUNT=2]="COUNT"})(Xp||(Xp={}));const fH=429496.7296;function Nme(i,e){o5(i/fH*.5+.5,e)}function H_t(i,e){switch(e.componentData){case Xp.Varying:return G_t(i,e);case Xp.Uniform:return W_t(i);case Xp.COUNT:return;default:Do(e.componentData)}}function G_t(i,e){const{vertex:t,fragment:n}=i;t.include(Tb),t.uniforms.add(r3("componentColorTex",s=>s.componentParameters.texture.texture,e.hasWebGL2Context?Ou.None:Ou.Size)),i.attributes.add(j.COMPONENTINDEX,"float"),i.varyings.add("vExternalColorMixMode","mediump float"),i.varyings.add("vExternalColor","vec4");const r=e.output===Re.ObjectAndLayerIdColor;r&&i.varyings.add("vObjectAndLayerIdColor","vec4"),i.include(fwe),t.constants.add("elevationScale","float",2*fH),t.constants.add("stride","float",Fi("enable-feature:objectAndLayerId-rendering")?3:2),t.code.add(ee`
  vec2 getComponentTextureCoordinates(float componentIndex, float typeOffset) {
    vec2 textureSize = ${qA(e,"componentColorTex")};

    float index = componentIndex * stride + typeOffset;
    float coordX = mod(index, textureSize.x);
    float coordY = floor(index / textureSize.x);

    return vec2(coordX, coordY) + 0.5;
  }
  `),t.code.add(ee`
  vec4 _readComponentColor() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 0.0);

    return ${Eu(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
   }

   float readElevationOffset() {
    vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 1.0);

    vec4 encodedElevation = ${Eu(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
    return (rgba2float(encodedElevation) - 0.5) * elevationScale;
  }

  ${r?ee`
          void forwardObjectAndLayerIdColor() {
            vec2 textureCoordinates = getComponentTextureCoordinates(componentIndex, 2.0);

            vObjectAndLayerIdColor = ${Eu(e,"componentColorTex","textureCoordinates","1.0 / componentColorTexSize")};
          }`:ee`void forwardObjectAndLayerIdColor() {}`}

  vec4 forwardExternalColor(out bool castShadows) {
    vec4 componentColor = _readComponentColor() * 255.0;

    float shadowFlag = mod(componentColor.b * 255.0, 2.0);
    componentColor.b -= shadowFlag;
    castShadows = shadowFlag >= 1.0;

    int decodedColorMixMode;
    vExternalColor = decodeSymbolColor(componentColor, decodedColorMixMode) * 0.003921568627451; // = 1/255;
    vExternalColorMixMode = float(decodedColorMixMode) + 0.5; // add 0.5 to avoid interpolation artifacts

    return vExternalColor;
  }
`),n.code.add(ee`
  void readExternalColor(out vec4 externalColor, out int externalColorMixMode) {
    externalColor = vExternalColor;
    externalColorMixMode = int(vExternalColorMixMode);
  }

  void outputObjectAndLayerIdColor() {
     ${r?ee`gl_FragColor = vObjectAndLayerIdColor;`:""}
  }
`)}function W_t(i){const{vertex:e,fragment:t}=i;e.uniforms.add(new vL("externalColor",n=>n.componentParameters.externalColor)),t.uniforms.add(new U_t("externalColorMixMode",n=>n.componentParameters.externalColorMixMode)),i.varyings.add("vExternalColor","vec4"),e.code.add(ee`float readElevationOffset() {
return 0.0;
}
void forwardObjectAndLayerIdColor() {
}
vec4 forwardExternalColor(out bool castShadows) {
vExternalColor = externalColor;
castShadows = true;
return externalColor;
}`),t.code.add(ee`void readExternalColor(out vec4 color, out int colorMixMode) {
color = vExternalColor;
colorMixMode = externalColorMixMode;
}
void outputObjectAndLayerIdColor() {
gl_FragColor = vec4(1.0,0.0,0.0,0.0);
}`)}var md;function j_t(i,e){const t=i.vertex;switch(t.code.add(ee`#define VERTEX_DISCARD_CUTOFF (1.0 - 1.0 / 255.0)`),e.vertexDiscardMode){case md.None:t.code.add(ee`#define vertexDiscardByOpacity(_opacity_) {}`);break;case md.Opaque:t.code.add(ee`#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ >  VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`);break;case md.Transparent:t.code.add(ee`#define vertexDiscardByOpacity(_opacity_) { if (_opacity_ <= VERTEX_DISCARD_CUTOFF) {  gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`)}}(function(i){i[i.None=0]="None",i[i.Transparent=1]="Transparent",i[i.Opaque=2]="Opaque",i[i.COUNT=3]="COUNT"})(md||(md={}));var Zp;function S5t(i){return i&&zA(i)?Zp.Mars:i&&UA(i)?Zp.Moon:Zp.Earth}(function(i){i[i.Earth=1]="Earth",i[i.Mars=2]="Mars",i[i.Moon=3]="Moon",i[i.COUNT=4]="COUNT"})(Zp||(Zp={}));var _u;(function(i){i[i.None=0]="None",i[i.NoOverlay=1]="NoOverlay",i[i.ColorOverlay=2]="ColorOverlay",i[i.ColorOverlayWithWater=3]="ColorOverlayWithWater",i[i.COUNT=4]="COUNT"})(_u||(_u={}));let Ni=class extends ic{constructor(){super(...arguments),this.output=Re.Color,this.textureCoordinateType=yy.None,this.componentData=Xp.Uniform,this.cullFace=qs.Back,this.vertexDiscardMode=md.None,this.doubleSidedMode=$c.WindingOrder,this.alphaDiscardMode=vu.Opaque,this.integratedMeshMode=_u.None,this.transparencyPassType=ln.NONE,this.ellipsoidMode=Zp.Earth,this.pbrMode=Ds.Disabled,this.normalType=hd.Attribute,this.spherical=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasVertexColors=!1,this.hasNormals=!1,this.hasSlicePlane=!1,this.hasBaseColorTexture=!1,this.receiveAmbientOcclusion=!0,this.receiveShadows=!0,this.blendingEnabled=!0,this.hasScreenSpaceReflections=!1,this.hasPolygonOffset=!1,this.hasMetallicRoughnessTexture=!1,this.hasEmissionTexture=!1,this.hasOcclusionTexture=!1,this.hasNormalTexture=!1,this.hasOccludees=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.useLegacyTerrainShading=!1,this.hasCloudsReflections=!0,this.snowCover=!1,this.objectAndLayerIdColor=!1,this.hasWebGL2Context=!1}};f([Pe({count:Re.COUNT})],Ni.prototype,"output",void 0),f([Pe({count:yy.COUNT})],Ni.prototype,"textureCoordinateType",void 0),f([Pe({count:Xp.COUNT})],Ni.prototype,"componentData",void 0),f([Pe({count:qs.COUNT})],Ni.prototype,"cullFace",void 0),f([Pe({count:md.COUNT})],Ni.prototype,"vertexDiscardMode",void 0),f([Pe({count:$c.COUNT})],Ni.prototype,"doubleSidedMode",void 0),f([Pe({count:vu.COUNT})],Ni.prototype,"alphaDiscardMode",void 0),f([Pe({count:_u.COUNT})],Ni.prototype,"integratedMeshMode",void 0),f([Pe({count:ln.COUNT})],Ni.prototype,"transparencyPassType",void 0),f([Pe({count:Zp.COUNT})],Ni.prototype,"ellipsoidMode",void 0),f([Pe({count:Ds.COUNT})],Ni.prototype,"pbrMode",void 0),f([Pe({count:hd.COUNT})],Ni.prototype,"normalType",void 0),f([Pe()],Ni.prototype,"spherical",void 0),f([Pe()],Ni.prototype,"doublePrecisionRequiresObfuscation",void 0),f([Pe()],Ni.prototype,"hasVertexColors",void 0),f([Pe()],Ni.prototype,"hasNormals",void 0),f([Pe()],Ni.prototype,"hasSlicePlane",void 0),f([Pe()],Ni.prototype,"hasBaseColorTexture",void 0),f([Pe()],Ni.prototype,"receiveAmbientOcclusion",void 0),f([Pe()],Ni.prototype,"receiveShadows",void 0),f([Pe()],Ni.prototype,"blendingEnabled",void 0),f([Pe()],Ni.prototype,"hasScreenSpaceReflections",void 0),f([Pe()],Ni.prototype,"hasPolygonOffset",void 0),f([Pe()],Ni.prototype,"hasMetallicRoughnessTexture",void 0),f([Pe()],Ni.prototype,"hasEmissionTexture",void 0),f([Pe()],Ni.prototype,"hasOcclusionTexture",void 0),f([Pe()],Ni.prototype,"hasNormalTexture",void 0),f([Pe()],Ni.prototype,"hasOccludees",void 0),f([Pe()],Ni.prototype,"hasMultipassTerrain",void 0),f([Pe()],Ni.prototype,"cullAboveGround",void 0),f([Pe()],Ni.prototype,"useLegacyTerrainShading",void 0),f([Pe()],Ni.prototype,"hasCloudsReflections",void 0),f([Pe()],Ni.prototype,"snowCover",void 0),f([Pe()],Ni.prototype,"objectAndLayerIdColor",void 0),f([Pe()],Ni.prototype,"hasWebGL2Context",void 0),f([Pe({constValue:WB.Draw})],Ni.prototype,"pbrTextureBindType",void 0),f([Pe({constValue:!0})],Ni.prototype,"hasSliceHighlight",void 0),f([Pe({constValue:!1})],Ni.prototype,"hasSliceInVertexProgram",void 0),f([Pe({constValue:!1})],Ni.prototype,"useCustomDTRExponentForWater",void 0),f([Pe({constValue:!1})],Ni.prototype,"hasVertexTangents",void 0),f([Pe({constValue:!0})],Ni.prototype,"supportsTextureAtlas",void 0),f([Pe({constValue:!1})],Ni.prototype,"highStepCount",void 0),f([Pe({constValue:!1})],Ni.prototype,"instancedDoublePrecision",void 0),f([Pe({constValue:!0})],Ni.prototype,"useFillLights",void 0),f([Pe({constValue:!1})],Ni.prototype,"objectAndLayerIdColorInstanced",void 0);function see(i,e){i.include(vre,e),i.fragment.include(mwe);const t=i.fragment;t.uniforms.add(new vL("baseColor",n=>n.baseColor)),t.uniforms.add(new ux("objectOpacity",n=>n.objectOpacity)),e.hasVertexColors?t.code.add(ee`vec3 _baseColor() {
return baseColor.rgb * vColor.rgb;
}
float _baseOpacity() {
return baseColor.a * vColor.a;
}`):t.code.add(ee`vec3 _baseColor() {
return baseColor.rgb;
}
float _baseOpacity() {
return baseColor.a;
}`),t.code.add(ee`vec4 computeMaterialColor(vec4 textureColor, vec4 externalColor, int externalColorMixMode) {
vec3 baseColor = _baseColor();
float baseOpacity = _baseOpacity();
vec3 color = mixExternalColor(
baseColor,
textureColor.rgb,
externalColor.rgb,
externalColorMixMode
);
float opacity = objectOpacity * mixExternalOpacity(
baseOpacity,
textureColor.a,
externalColor.a,
externalColorMixMode
);
return vec4(color, opacity);
}`)}function aee(i,e){const t=i.fragment;switch(e.doubleSidedMode){case $c.None:t.code.add(ee`vec3 _adjustDoublesided(vec3 normal) {
return normal;
}`);break;case $c.View:i.include(aR,e),t.code.add(ee`vec3 _adjustDoublesided(vec3 normal) {
return dot(normal, vPositionWorldCameraRelative) > 0.0 ? -normal : normal;
}`);break;case $c.WindingOrder:t.code.add(ee`vec3 _adjustDoublesided(vec3 normal) {
return gl_FrontFacing ? normal : -normal;
}`);break;default:Do(e.doubleSidedMode);case $c.COUNT:}switch(e.normalType){case hd.Attribute:case hd.CompressedAttribute:i.include(ure,e),t.code.add(ee`vec3 shadingNormalWorld() {
return _adjustDoublesided(normalize(vNormalWorld));
}
vec3 shadingNormal_view() {
vec3 normal = normalize(vNormalView);
return gl_FrontFacing ? normal : -normal;
}`);break;case hd.ScreenDerivative:i.extensions.add("GL_OES_standard_derivatives"),i.include(aR,e),t.code.add(ee`vec3 shadingNormalWorld() {
return normalize(cross(
dFdx(vPositionWorldCameraRelative),
dFdy(vPositionWorldCameraRelative)
));
}
vec3 shadingNormal_view() {
return normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view)));
}`);break;case hd.Ground:e.spherical?(i.include(aR,e),t.code.add(ee`vec3 shadingNormalWorld() {
return normalize(positionWorld());
}`)):t.code.add(ee`vec3 shadingNormalWorld() {
return vec3(0.0, 0.0, 1.0);
}`),i.extensions.add("GL_OES_standard_derivatives"),t.code.add(ee`vec3 shadingNormal_view() {
return normalize(cross(dFdx(vPosition_view),dFdy(vPosition_view))).xyz;
}`);break;default:Do(e.normalType);case hd.COUNT:}}function q_t(i,e){const t=i.fragment;if(e.hasBaseColorTexture&&(e.output===Re.Color||e.alphaDiscardMode!==vu.Opaque)){i.include(nbe,e);const n=e.textureCoordinateType===yy.Atlas;t.uniforms.add(r3("baseColorTexture",r=>r.texture,n?e.hasWebGL2Context?Ou.None:Ou.Size:Ou.None)),n?(i.include(rbe),t.code.add(ee`
        vec4 readBaseColorTexture() {
          vec2 textureSize = ${qA(e,"baseColorTexture")};
          return textureAtlasLookup(baseColorTexture, textureSize, vuv0, vuvRegion);
        }
      `)):t.code.add(ee`vec4 readBaseColorTexture() {
return texture2D(baseColorTexture, vuv0);
}`)}else t.code.add(ee`vec4 readBaseColorTexture() { return vec4(1.0); }`)}function K_t(i){const e=new Nr;e.include(aR,i),e.include(ure,i),e.include(vre,i),e.include(YL,i),e.include(Vne,i),e.include(H_t,i),e.include(gwe,i),e.include(Wwe,i),e.include(q_t,i),e.include(j_t,i);const{vertex:t,fragment:n}=e;i.pbrMode!==Ds.Normal&&i.pbrMode!==Ds.Schematic||(e.include(sbe,i),i.hasNormalTexture&&e.include(Kwe,i));const r=i.output===Re.Shadow||i.output===Re.ShadowHighlight||i.output===Re.ShadowExludeHighlight;r&&i.componentData===Xp.Varying?t.code.add(ee`#define discardShadows(castShadows) { if(!castShadows) { gl_Position = vec4(1e38, 1e38, 1e38, 1.0); return; } }`):t.code.add(ee`#define discardShadows(castShadows) {}`);const s=i.integratedMeshMode===_u.ColorOverlay||i.integratedMeshMode===_u.ColorOverlayWithWater,a=s&&i.output===Re.Color&&i.pbrMode===Ds.WaterOnIntegratedMesh;return s&&(e.include(KI,i),e.include(cyt,i),i.spherical?t.code.add(ee`
      const float invEllipsoidRadius = ${ee.float(1/(i.ellipsoidMode===Zp.Earth?Rc.radius:i.ellipsoidMode===Zp.Mars?Z0e.radius:Q0e.radius))};
      vec2 projectOverlay(vec3 pos) {
        return pos.xy / (1.0 + invEllipsoidRadius * pos.z);
      }
      `):t.code.add(ee`vec2 projectOverlay(vec3 pos) { return pos.xy; }`)),a&&(e.varyings.add("tbnTangent","vec3"),e.varyings.add("tbnBiTangent","vec3"),e.varyings.add("groundNormal","vec3")),t.code.add(ee`
    void main() {
      bool castShadows;
      vec4 externalColor = forwardExternalColor(castShadows);
      discardShadows(castShadows);

      vertexDiscardByOpacity(externalColor.a);

      if (externalColor.a < ${ee.float(Ywe)}) {
        // Discard this vertex
        gl_Position = vec4(1e38, 1e38, 1e38, 1.0);
        return;
      }

      forwardPosition(readElevationOffset());
      forwardNormal();
      forwardTextureCoordinates();
      forwardVertexColor();
      forwardLinearDepth();
      ${i.output===Re.ObjectAndLayerIdColor?ee`forwardObjectAndLayerIdColor();`:""}
      ${a?i.spherical?ee`
                groundNormal = normalize(positionWorld());
                tbnTangent = normalize(cross(vec3(0.0, 0.0, 1.0), groundNormal));
                tbnBiTangent = normalize(cross(groundNormal, tbnTangent));`:ee`
                groundNormal = vec3(0.0, 0.0, 1.0);
                tbnTangent = vec3(1.0, 0.0, 0.0);
                tbnBiTangent = vec3(0.0, 1.0, 0.0);`:""}
      ${s?ee`setOverlayVTC(projectOverlay(position));`:""}
    }
  `),i.output===Re.Alpha&&(n.include(eb),e.include(e5,i),e.include(see,i),s&&n.uniforms.add(new sn("ovColorTex",(o,l)=>h8(o,l))),n.code.add(ee`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);
        ${i.hasMultipassTerrain?ee`terrainDepthTest(gl_FragCoord, vPosition_view.z);`:""}

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        vec4 externalColor;
        int externalColorMixMode;
        readExternalColor(externalColor, externalColorMixMode);

        vec4 materialColor = computeMaterialColor(
          textureColor,
          externalColor,
          externalColorMixMode
        );
        ${s?ee`
                vec4 overlayColor = getOverlayColor(ovColorTex, vtcOverlay);
                materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        gl_FragColor = vec4(materialColor.a);
      }
    `)),i.output===Re.Color&&(n.include(eb),e.include(e5,i),e.include(see,i),e.include(aee,i),e.include(KI,i),i.receiveShadows?(e.include(xne,i),n.code.add(ee`float evaluateShadow() {
return readShadowMap(vPositionWorldCameraRelative, linearDepth);
}`)):n.code.add(ee`float evaluateShadow() { return 0.0; }`),s&&n.uniforms.add(new sn("ovColorTex",(o,l)=>h8(o,l))),n.code.add(ee`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);
        ${i.hasMultipassTerrain?ee`terrainDepthTest(gl_FragCoord, vPosition_view.z);`:""}

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        vec4 externalColor;
        int externalColorMixMode;
        readExternalColor(externalColor, externalColorMixMode);

        vec4 materialColor = computeMaterialColor(
          textureColor,
          externalColor,
          externalColorMixMode
        );
        ${s?ee`vec4 overlayColor = getOverlayColor(ovColorTex, vtcOverlay);`:""}
    `),i.pbrMode===Ds.Normal||i.pbrMode===Ds.Schematic?(zB(n),n.code.add(ee`
        ${i.pbrMode===Ds.Normal?ee`
                applyPBRFactors();
                if (int(externalColorMixMode) == 3) {
                  mrr = vec3(0.0, 0.6, 0.2);
                }`:""}
        vec3 normalVertex = shadingNormalWorld();
        float additionalIrradiance = 0.02 * mainLightIntensity[2];
      `),i.hasNormalTexture?n.code.add(ee`mat3 tangentSpace = computeTangentSpace(normalVertex, vPositionWorldCameraRelative, vuv0);
vec3 shadingNormal = computeTextureNormal(tangentSpace, vuv0);`):n.code.add(ee`vec3 shadingNormal = normalVertex;`),n.code.add(ee`${i.spherical?ee`vec3 normalGround = normalize(positionWorld());`:ee`vec3 normalGround = vec3(0.0, 0.0, 1.0);`}
      `),n.code.add(ee`
        vec3 viewDir = normalize(vPositionWorldCameraRelative);
        float ssao = 1.0 - occlusion * (1.0 - evaluateAmbientOcclusion());

        ${i.snowCover?ee`
                vec3 surfaceNormal = normalize(shadingNormalWorld());
                float snow = smoothstep(0.5, 0.55, dot(surfaceNormal, normalize(positionWorld())));
                materialColor.rgb = mix(materialColor.rgb, vec3(1), snow);

                shadingNormal = mix(shadingNormal, surfaceNormal, snow);
                ssao = mix(ssao, 0.0, snow);
                mrr = mix(mrr, vec3(0.0, 1.0, 0.04), snow);
                emission = mix(emission, vec3(0.0), snow);`:""}

        ${s?ee` materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        vec3 additionalLight = evaluateAdditionalLighting(ssao, positionWorld());
        vec4 shadedColor = vec4(evaluateSceneLightingPBR(shadingNormal, materialColor.rgb, evaluateShadow(), ssao, additionalLight, viewDir, normalGround, mrr, emission, additionalIrradiance), materialColor.a);
        `)):(i.receiveShadows?n.code.add(ee`float shadow = evaluateShadow();`):i.spherical?(Mne(n),n.code.add(ee`float additionalAmbientScale = additionalDirectedAmbientLight(positionWorld());
float shadow = lightingGlobalFactor * (1.0 - additionalAmbientScale);`)):n.code.add(ee`float shadow = 0.0;`),a&&n.uniforms.add(new sn("ovNormalTex",(o,l)=>mH(l))),i.snowCover&&(e.extensions.add("GL_OES_standard_derivatives"),n.code.add(ee`vec3 surfaceNormal = normalize(cross(dFdx(vPositionWorldCameraRelative), dFdy(vPositionWorldCameraRelative)));
float snow = smoothstep(0.5, 0.55, dot(surfaceNormal, normalize(positionWorld())));
materialColor.rgb = mix(materialColor.rgb, vec3(1), snow);`)),n.code.add(ee`
        float ambientOcclusion = evaluateAmbientOcclusion();
        vec3 additionalLight = evaluateAdditionalLighting(ambientOcclusion, positionWorld());

        ${s?ee` materialColor = materialColor * (1.0 - overlayColor.a) + overlayColor;`:""}

        vec4 shadedColor = vec4(evaluateSceneLighting(shadingNormalWorld(), materialColor.rgb, shadow, ambientOcclusion, additionalLight), materialColor.a);
      ${a?ee`
              vec4 overlayWaterMask = getOverlayColor(ovNormalTex, vtcOverlay);
              float waterNormalLength = length(overlayWaterMask);
              if (waterNormalLength > 0.95) {
                mat3 tbnMatrix = mat3(tbnTangent, tbnBiTangent, groundNormal);
                vec4 waterColorLinear = getOverlayWaterColor(overlayWaterMask, overlayColor, -normalize(vPositionWorldCameraRelative), shadow, groundNormal, tbnMatrix, vPosition_view, positionWorld());
                vec4 waterColorNonLinear = delinearizeGamma(vec4(waterColorLinear.xyz, 1.0));
                // un-gamma the ground color to mix in linear space
                shadedColor = mix(shadedColor, waterColorNonLinear, waterColorLinear.w);
              }`:""}
      `)),n.code.add(ee`
        gl_FragColor = highlightSlice(shadedColor, vPositionWorldCameraRelative);
        ${i.transparencyPassType===ln.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
      }
    `)),(i.output===Re.Depth||r)&&(e.include(a5,i),n.code.add(ee`void main() {
discardBySlice(vPositionWorldCameraRelative);
vec4 textureColor = readBaseColorTexture();
discardOrAdjustAlpha(textureColor);
outputDepth(linearDepth);
}`)),i.output===Re.Normal&&(e.include(aee,i),n.code.add(ee`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        // note: the alpha component needs to be 1.0 in order for this material
        // to influence ambient occlusion, see the ssao fragment shader
        float alpha = ${i.normalType===hd.Ground?"0.0":"1.0"};
        gl_FragColor = vec4(vec3(.5) + .5 * shadingNormal_view(), alpha);
      }
    `)),i.output===Re.ObjectAndLayerIdColor&&e.fragment.code.add(ee`void main() {
discardBySlice(vPositionWorldCameraRelative);
vec4 textureColor = readBaseColorTexture();
discardOrAdjustAlpha(textureColor);
outputObjectAndLayerIdColor();
}`),i.output===Re.Highlight&&(e.include(fre,i),n.code.add(ee`
      void main() {
        discardBySlice(vPositionWorldCameraRelative);

        vec4 textureColor = readBaseColorTexture();
        discardOrAdjustAlpha(textureColor);

        ${s?ee`
                vec4 overlayColor = getCombinedOverlayColor();
                if (overlayColor.a == 0.0) {
                  gl_FragColor = vec4(0.0);
                  return;
                }`:""}

        outputHighlight();
      }
    `)),e}function mH(i){return i.overlays.length===0?null:i.overlays[br.INNER].getValidTexture(Ur.Water)}const Y_t=Object.freeze(Object.defineProperty({__proto__:null,build:K_t,getOverlayNormalTexture:mH},Symbol.toStringTag,{value:"Module"}));let gH=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2,t.spherical=e.viewingMode===Ot.Global,t.doublePrecisionRequiresObfuscation=QL(e.rctx)}initializeProgram(e){return new gn(e.rctx,gH.shader.get().build(this.configuration),Vme)}_setPipelineState(e){const t=this.configuration,n=t.integratedMeshMode!==_u.None,r=e===ln.NONE,s=e===ln.FrontFace;return yi({blending:t.output!==Re.Color&&t.output!==Re.Alpha||!t.blendingEnabled?null:r?xd:Ly(e),culling:jB(t.cullFace),depthTest:{func:Eb(e)},depthWrite:r||s?Lu:null,colorWrite:$i,stencilWrite:n||t.hasOccludees?Gm:null,stencilTest:n?i1e(sE.IntegratedMeshMaskExcluded):t.hasOccludees?Ab:null,polygonOffset:r||s?t.hasPolygonOffset?{factor:2,units:2}:null:XB})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}};gH.shader=new bn(Y_t,()=>Ee(()=>import("./ComponentShader.glsl-87f4a66d.js"),["./ComponentShader.glsl-87f4a66d.js","./Ellipsoid-89682c5e.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./vec3f32-c9aa289f.js","./vec3f64-2f9cef06.js","./VertexAttribute-9c5c630d.js","./mat4-44a0988f.js","./common-c186b691.js","./vec3-a020a6f6.js","./MixExternalColor.glsl-25f0049c.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./Texture2DPassUniform-6e8ae673.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./ShaderTechniqueConfiguration-9f5b4555.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./context-util-1e3c8cfc.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./aaBoundingRect-4a760199.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./compilerUtils-034cacb8.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./sphere-4f5e644f.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const Vme=new Map([[j.POSITION,0],[j.NORMAL,1],[j.NORMALCOMPRESSED,1],[j.COLOR,2],[j.UV0,3],[j.UVREGION,4],[j.COMPONENTINDEX,5]]);let X_t=class extends Es{constructor(){super(...arguments),this._dirty=!0}_setDirty(){this._dirty=!0}_setClean(){if(this._dirty=!1,this._parameterBlocks!=null)for(const e of this._parameterBlocks)this[e]._setClean()}get dirty(){return this._dirty||this._checkParameterBlocksDirty()}_checkParameterBlocksDirty(){if(this._parameterBlocks==null)return!1;for(const e of this._parameterBlocks)if(this[e].dirty)return!0;return!1}},vH=class{constructor(){this._dirty=!0}_setDirty(){this._dirty=!0}_setClean(){this._dirty=!1}get dirty(){return this._dirty}};function Ir(i={}){return(e,t)=>{const n=e._parameterCount??0;if(e._parameterCount=n+1,i.vectorOps){const r=i.vectorOps;Object.defineProperty(e,t,{get(){return this[n]},set(s){const a=this[n];if(a==null)this[n]=s;else{if(r.equals(a,s))return;r.copy(a,s)}this._setDirty()}})}else Object.defineProperty(e,t,{get(){return this[n]},set(r){this[n]!==r&&(i.dispose&&this[n]&&this[n].dispose(),this[n]=r,this._setDirty())}})}}function oee(){return(i,e)=>{const t=i._parameterCount??0;i._parameterCount=t+1,i._parameterBlocks=i._parameterBlocks||[],i._parameterBlocks.push(t),Object.defineProperty(i,e,{get(){return this[t]},set(n){this[t]!==n&&(this[t]=n,this._setDirty())}})}}let OD=class{constructor(e){this._low=wr(),this._high=wr(),e&&this.set(e)}get low(){return this._low}get high(){return this._high}set(e){const t=this._low,n=this._high;Ge(t,e),pr(n,e,t)}setElements(e,t,n){je(lee,e,t,n),this.set(lee)}get(e){return rt(e,this._low,this._high)}getLowScaled(e){return Ye(e,this._low,1)}};const lee=q();let sa=class extends X_t{constructor(e,t){super(),this.toMapSpace=t,this.baseColor=Kx(1,1,1,1),this.usePBR=!1,this.hasParametersFromSource=!1,this.mrrFactors=Un(1,1,.5),this.emissiveFactor=Un(0,0,0),this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.emissionTexture=null,this.occlusionTexture=null,this.normalTexture=null,this.objectOpacity=1,this.commonMaterialParameters=new yI,this.componentParameters=new VE,this.textureAlphaCutoff=Xwe,this.alphaDiscardMode=vu.Opaque,this.isIntegratedMesh=!1,this.polygonOffsetEnabled=!1,this.ellipsoidMode=Zp.Earth,this.hasOccludees=!1,this._techniqueConfiguration=new Ni;const n=new OD(e.position),r=a0e(e.rotationScale);IC(r,r),this.transformNormalGlobalFromModel=cg(r,r),this.transformWorldFromModelTL=n.low,this.transformWorldFromModelTH=n.high,this.transformWorldFromModelRS=e.rotationScale}dispose(){this._technique=Lr(this._technique),this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.emissionTexture=null,this.occlusionTexture=null,this.normalTexture=null}get texture(){return T(this.baseColorTexture)?this.baseColorTexture.glTexture:null}get textureMetallicRoughness(){return T(this.metallicRoughnessTexture)?this.metallicRoughnessTexture.glTexture:null}get textureEmissive(){return T(this.emissionTexture)?this.emissionTexture.glTexture:null}get textureOcclusion(){return T(this.occlusionTexture)?this.occlusionTexture.glTexture:null}get textureNormal(){return T(this.normalTexture)?this.normalTexture.glTexture:null}prepareTechnique(e,t,n,r){const s=this._techniqueConfiguration;s.hasVertexColors=r.colors,s.hasNormals=r.normals,s.textureCoordinateType=r.textureCoordinates,s.hasMetallicRoughnessTexture=T(this.metallicRoughnessTexture),s.hasEmissionTexture=T(this.emissionTexture),s.hasOcclusionTexture=T(this.occlusionTexture),s.hasNormalTexture=T(this.normalTexture),s.transparencyPassType=t.identifier===Cu.Material&&n.transparencyPassType!=null?n.transparencyPassType:ln.NONE,s.hasMultipassTerrain=t.identifier===Cu.Material&&n.multipassTerrain!=null&&n.multipassTerrain.enabled,s.cullAboveGround=t.identifier===Cu.Material&&n.multipassTerrain!=null&&n.multipassTerrain.cullAboveGround,s.ellipsoidMode=this.ellipsoidMode,s.componentData=this.componentParameters.type,s.cullFace=this.commonMaterialParameters.cullFace,s.doubleSidedMode=this.commonMaterialParameters.doubleSided?$c.View:$c.None,s.hasBaseColorTexture=T(this.baseColorTexture);const a=this._computeWhichMaterialPass();s.blendingEnabled=a===nl.Transparent||a===nl.OpaqueAndTransparent,s.alphaDiscardMode=this.alphaDiscardMode,s.integratedMeshMode=this.isIntegratedMesh?J_t(n)?mH(n)?_u.ColorOverlayWithWater:_u.ColorOverlay:_u.NoOverlay:_u.None,s.useLegacyTerrainShading=this.isIntegratedMesh&&cn.TERRAIN_USE_LEGACY_SHADING,s.hasPolygonOffset=this.polygonOffsetEnabled;const o=this.hasParametersFromSource&&B(this.baseColorTexture);return s.pbrMode=s.integratedMeshMode===_u.ColorOverlayWithWater?Ds.WaterOnIntegratedMesh:this.usePBR?o?Ds.Schematic:Ds.Normal:Ds.Disabled,s.normalType=s.integratedMeshMode===_u.None?s.hasNormals?hd.CompressedAttribute:hd.ScreenDerivative:hd.Ground,s.hasSlicePlane=T(n.slicePlane)&&this.commonMaterialParameters.hasSlicePlane,t.identifier===Cu.ShadowMap?(s.output=Re.Shadow,s.vertexDiscardMode=md.None):t.identifier===Cu.Highlight?(s.output=Re.Highlight,s.vertexDiscardMode=md.None):(this._computeWhichMaterialPass()===nl.OpaqueAndTransparent?s.vertexDiscardMode=t.transparent?md.Opaque:md.Transparent:s.vertexDiscardMode=md.None,s.output=Z_t(t.subPass),t.subPass===us.Alpha&&(s.hasOccludees=n.hasOccludees),t.subPass===us.Color?(s.receiveAmbientOcclusion=n.ssaoHelper.ready,s.hasOccludees=n.hasOccludees,s.receiveShadows=n.shadowMap.ready,s.hasScreenSpaceReflections=n.ssr.enabled,s.hasCloudsReflections=T(n.cloudsFade.data)):(s.receiveAmbientOcclusion=!1,s.receiveShadows=!1),s.snowCover=this.hasSnowCover(n),t.subPass===us.ObjectAndLayerIdColor&&(s.objectAndLayerIdColor=!0)),this._technique=e.releaseAndAcquire(gH,s,this._technique),this._setClean(),this._technique}hasSnowCover(e){return T(e.weather)&&e.weatherVisible&&e.weather.type==="snowy"&&e.weather.snowCover==="enabled"}submit(e,t,n){if(this.objectOpacity===0)return;const r=n.renderable.geometry,s=n.components,a=n.renderable.meta.cameraDepthSquared,o=s.geometryRanges,l=s.highlightRanges,c=s.defaultShadowMapRanges;switch(this._computeWhichMaterialPass()){case nl.Opaque:e.materialOpaque.submitDraw(this,r,o,a);break;case nl.Transparent:e.materialTransparent.submitDraw(this,r,o,a);break;case nl.OpaqueAndTransparent:e.materialOpaque.submitDraw(this,r,o,a),e.materialTransparent.submitDraw(this,r,o,a);break;case nl.IntegratedMesh:e.materialIntegratedMesh.submitDraw(this,r,o,a),Q_t(t)&&e.highlightIntegratedMesh.submitDraw(this,r,o,a)}const u=this.componentParameters.castShadows!==Gs.None;u&&e.shadowMap.submitDraw(this,r,o,a),T(l)&&(e.highlight.submitDraw(this,r,l,a),u&&e.highlightShadowMap.submitDraw(this,r,l,a)),u&&T(c)&&e.defaultShadowMap.submitDraw(this,r,c,a)}_computeWhichMaterialPass(){return this.isIntegratedMesh?nl.IntegratedMesh:this.objectOpacity<1?nl.Transparent:this.componentParameters.opaqueOverride===Gs.All?nl.Opaque:this.baseColor[3]<1||this.alphaDiscardMode===vu.Blend||this.alphaDiscardMode===vu.MaskBlend?nl.Transparent:this.componentParameters.transparent===Gs.None?nl.Opaque:this.componentParameters.transparent===Gs.All?nl.Transparent:nl.OpaqueAndTransparent}};var nl,Gs;f([Ir({vectorOps:_ne})],sa.prototype,"baseColor",void 0),f([Ir()],sa.prototype,"usePBR",void 0),f([Ir()],sa.prototype,"hasParametersFromSource",void 0),f([Ir({vectorOps:VG})],sa.prototype,"mrrFactors",void 0),f([Ir({vectorOps:VG})],sa.prototype,"emissiveFactor",void 0),f([Ir({dispose:!0})],sa.prototype,"baseColorTexture",void 0),f([Ir({dispose:!0})],sa.prototype,"metallicRoughnessTexture",void 0),f([Ir({dispose:!0})],sa.prototype,"emissionTexture",void 0),f([Ir({dispose:!0})],sa.prototype,"occlusionTexture",void 0),f([Ir({dispose:!0})],sa.prototype,"normalTexture",void 0),f([Ir()],sa.prototype,"objectOpacity",void 0),f([oee()],sa.prototype,"commonMaterialParameters",void 0),f([oee()],sa.prototype,"componentParameters",void 0),f([Ir()],sa.prototype,"textureAlphaCutoff",void 0),f([Ir()],sa.prototype,"alphaDiscardMode",void 0),f([Ir()],sa.prototype,"isIntegratedMesh",void 0),f([Ir()],sa.prototype,"polygonOffsetEnabled",void 0),f([Ir()],sa.prototype,"ellipsoidMode",void 0),f([Ir()],sa.prototype,"hasOccludees",void 0),function(i){i[i.Opaque=0]="Opaque",i[i.Transparent=1]="Transparent",i[i.OpaqueAndTransparent=2]="OpaqueAndTransparent",i[i.IntegratedMesh=3]="IntegratedMesh"}(nl||(nl={}));let yI=class extends vH{constructor(){super(...arguments),this.doubleSided=!1,this.cullFace=qs.Back,this.hasSlicePlane=!0}};f([Ir()],yI.prototype,"doubleSided",void 0),f([Ir()],yI.prototype,"cullFace",void 0),f([Ir()],yI.prototype,"hasSlicePlane",void 0);let VE=class extends vH{constructor(){super(...arguments),this.externalColor=Kx(1,1,1,1),this.externalColorMixMode=t$.Multiply,this.castShadows=Gs.All}get transparent(){return this.externalColor[3]<1?Gs.All:Gs.None}get opaqueOverride(){return this.externalColorMixMode===t$.Replace&&this.externalColor[3]===1?Gs.All:Gs.None}get visible(){return this.externalColor[3]>0?Gs.All:Gs.None}get type(){return Xp.Uniform}};f([Ir({vectorOps:_ne})],VE.prototype,"externalColor",void 0),f([Ir()],VE.prototype,"externalColorMixMode",void 0),f([Ir()],VE.prototype,"castShadows",void 0),function(i){i[i.All=0]="All",i[i.Some=1]="Some",i[i.None=2]="None"}(Gs||(Gs={}));let VS=class extends vH{constructor(){super(...arguments),this.texture=null,this.transparent=Gs.None,this.opaqueOverride=Gs.None,this.castShadows=Gs.None}get type(){return Xp.Varying}};function Z_t(i){switch(i){case us.Color:return Re.Color;case us.Alpha:return Re.Alpha;case us.Depth:return Re.Depth;case us.Normal:return Re.Normal;case us.ObjectAndLayerIdColor:return Re.ObjectAndLayerIdColor}}function Q_t(i){return i.overlays.length!==0&&T(i.overlays[br.INNER].getValidTexture(Ur.Highlight))}function J_t(i){return i.overlays.length!==0&&T(i.overlays[br.INNER].getColorTextureNoRasterImage())}f([Ir()],VS.prototype,"texture",void 0),f([Ir()],VS.prototype,"transparent",void 0),f([Ir()],VS.prototype,"opaqueOverride",void 0),f([Ir()],VS.prototype,"castShadows",void 0);let e0t=class{constructor(e){this._maxCount=e,this._nextIndex=0,this._recycledIndices=[]}get activeCount(){return this._nextIndex-this._recycledIndices.length}get availableCount(){return this._recycledIndices.length+this._maxCount-this._nextIndex}acquire(){return this._recycledIndices.length>0?this._recycledIndices.pop():this.availableCount?this._nextIndex++:void 0}release(e){this._recycledIndices.push(e)}},t0t=class{constructor(e,t=1){this._rctx=e,this._fieldCount=t,this.textureWidth=4096,this._dirty=!0,this._texture=new Er(this._rctx,{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.NEAREST,wrapMode:An.CLAMP_TO_EDGE,width:this.textureWidth,height:1,flipped:!1}),this._data=new by(new ArrayBuffer(4*this.textureWidth))}dispose(){this._texture.dispose(),this._texture=void 0,this._data=void 0}setData(e,t,n,r,s,a){const o=e*this._fieldCount+t;this._dirty=!0,this._data.set(o,0,n),this._data.set(o,1,r),this._data.set(o,2,s),this._data.set(o,3,a)}setDataElement(e,t,n,r){const s=e*this._fieldCount+t;this._dirty=!0,this._data.set(s,n,r)}resizeToFit(e){const t=e*this._fieldCount;if(t>=this._data.count){const n=Math.ceil((t+1)/this.textureWidth)*this.textureWidth,r=new by(new ArrayBuffer(4*n));r.typedBuffer.set(this._data.typedBuffer),this._data=r}}updateTexture(){if(!this._dirty)return;const e=this._texture.descriptor.width,t=this._texture.descriptor.height;this._data.count>e*t&&this._texture.resize(e,this._data.count/e),this._texture.setData(this._data.typedBuffer),this._dirty=!1}get texture(){return this._texture}};const Bme=65536;let i0t=class{constructor(e,t=1){this.textureBuffer=new t0t(e,t),this._indexManager=new e0t(Bme)}dispose(){this.textureBuffer.dispose(),this.textureBuffer=void 0}get availableCount(){return this._indexManager.availableCount}get activeCount(){return this._indexManager.activeCount}acquireIndex(){const e=this._indexManager.acquire();return this.textureBuffer.resizeToFit(e),e}releaseIndex(e){this._indexManager.release(e)}},zme=class{constructor(e,t=1){this._rctx=e,this._fieldCount=t,this._buffers=[]}garbageCollect(){this._buffers=this._buffers.filter(e=>e.activeCount!==0||(e.dispose(),!1))}destroy(){this._buffers.forEach(e=>e.dispose()),this._buffers=[]}getBuffer(e){for(const n of this._buffers)if(n.availableCount>=e)return n;if(e>Bme)return null;const t=new i0t(this._rctx,this._fieldCount);return this._buffers.push(t),t}updateTextures(){for(const e of this._buffers)e.textureBuffer.updateTexture()}};const cee=tt.getLogger("esri.views.3d.webgl-engine.collections.Component.ComponentObjectCollection");let n0t=class{constructor(e,t){this._renderManager=e,this._viewingMode=t,this._objects=[new pn,new pn],this._renderSubmit=new B_t(this),this._renderManager.register(this._renderSubmit),this._hasObjectAndLayerId=Fi("enable-feature:objectAndLayerId-rendering"),this._componentBufferManager=new zme(e.rctx,2+(this._hasObjectAndLayerId?1:0))}dispose(){Ti(this._objects[Ax.Hidden].length===0&&this._objects[Ax.Visible].length===0,"ObjectCollection should be empty upon disposal"),this._componentBufferManager.destroy()}createObject(e){const t=new f8;return t.toMapSpace=e.toMapSpace,t.transform=e.transform,t.obb=fW(e.obb),t.components=new x_t(this._componentBufferManager,e.geometry.componentOffsets),t.renderable=this._createRenderable(e,t.components),t.intersectionGeometry=new P_t(e.geometry.positionData,t.components),this._objects[t.visible].push(t),t}destroyObject(e){const t=e;this._objects[t.visible].removeUnordered(t),t.dispose(),this._notifyDirty()}setObjectVisibility(e,t){const n=e;t!==n.visible&&(this._objects[n.visible].removeUnordered(n),this._objects[t].push(n),n.visible=t,this._notifyDirty())}preSubmit(e){const t=e.camera.eye;this.visibleObjects.forAll(n=>n.renderable.meta.cameraDepthSquared=Fo(t,n.obb.center))}getMaterial(e){return e.renderable.material}updateMaterial(e,t){const n=e.renderable.material;t(n),n.dirty&&this._notifyDirty()}setAllComponentVisibilities(e,t){const n=e;n.components.visibility.reset(t),n.components.visibilityDirty(),this._notifyDirty()}forEachVisibleComponent(e,t){return e.components.visibility.forEachComponent(t)}getComponentCount(e){const t=e,n=t.components.visibility.componentCount();return{visible:n,invisible:t.components.count-n}}setComponentData(e,t){const n=e,r=n.renderable.material,s=n.components,a=s.materialDataBuffer,o=s.materialDataIndices,l={castShadows:!0,pickable:!0,externalColor:_W(),externalColorMixMode:t$.Multiply,elevationOffset:0,objectAndLayerIdColor:this._hasObjectAndLayerId?_W():null},c=a.textureBuffer,u=new Uint8Array(4),d=new Uint32Array(u.buffer);let h=0,p=0,m=0,g=s.verticalOffsets,_=1/0,b=-1/0,x=!1,w=!1,C=0;for(let S=0;S<s.count;S++){if(t(S,l),h+=+(l.externalColor[3]<1),p+=+(l.externalColorMixMode===t$.Replace&&l.externalColor[3]===1),m+=+l.castShadows,hre(l.externalColor,l.externalColorMixMode,u),u[2]=254&u[2]|+l.castShadows,c.setData(o[S],0,u[0],u[1],u[2],u[3]),x||(x=S>0&&C!==d[0]),C=d[0],w||(w=l.elevationOffset!==0),w&&B(g)&&(g=new Array(S).fill(0)),T(g)&&(g[S]=l.elevationOffset),_=Math.min(_,l.elevationOffset),b=Math.max(b,l.elevationOffset),Nme(l.elevationOffset,u),c.setData(o[S],1,u[0],u[1],u[2],u[3]),this._hasObjectAndLayerId){const E=l.objectAndLayerIdColor;c.setData(o[S],2,E[0],E[1],E[2],E[3])}l.pickable!==Lme(s.pickability,S)&&(s.pickability=T_t(s.pickability,s.count,S,l.pickable))}s.verticalOffsets=w?g:null,n.offsetObb=w?X1e(n.obb,_,b,this._viewingMode,T(n.offsetObb)?n.offsetObb:fW(n.obb)):null,x||w||this._hasObjectAndLayerId?(r.componentParameters=new VS,r.componentParameters.castShadows=G4(m,s.count),r.componentParameters.transparent=G4(h,s.count),r.componentParameters.opaqueOverride=G4(p,s.count),r.componentParameters.texture=c,c.updateTexture()):(r.componentParameters=new VE,r.componentParameters.castShadows=l.castShadows?Gs.All:Gs.None,r.componentParameters.externalColor=l.externalColor,r.componentParameters.externalColorMixMode=l.externalColorMixMode),this._notifyDirty()}getComponentAabb(e,t,n,r=!1){e.intersectionGeometry.getComponentAabb(t,n);const s=e,a=s.components.verticalOffsets;if(r||B(a))return n;const o=a[t];if(this._viewingMode===Ot.Local||o===0)return n[2]+=o,n[5]+=o,n;const l=kt(n1e(o));return l.localOrigin=s.transform.position,l.applyToAabb(n)}getComponentObb(e){return e.obb}getObjectTransform(e){return e.transform}getComponentPositions(e,t,n){return e.intersectionGeometry.getComponentPositions(t,n)}intersect(e,t,n,r,s,a){const o=e;T(s)&&(s.localOrigin=o.transform.position);const l=IC(uee,o.transform.rotationScale);pr(AO,t,o.transform.position),pr(MO,n,o.transform.position),Lp(AO,AO,l),Lp(MO,MO,l);const c=cg(uee,l);return o.intersectionGeometry.intersect(AO,MO,r,c,s,o.components.verticalOffsets,a)}addEdges(e,t,n,r){const s=e,{indices:a,positions:o}=s.intersectionGeometry,l=s.components.offsets;return t.addComponentObject(e,s.transform,{center:s.obb.center,radius:Z1e(s.obb)},o,a,l,n,r)}async extractEdgeInformation(e,t,n){const r=e,s=r.components.visibility;if(s.allInvisible())return{buffer:a1e.createBuffer(0),origin:[0,0,0]};const{indices:a,positions:o}=r.intersectionGeometry,l=r.components.offsets,c=t5.createBuffer(o.count);ore(c.position,o),e$(c.position,c.position,r.transform.rotationScale),this._setComponentIndices(c.componentIndex,a,l);const u=c.count,d=this._computeVisibilityIndices(a,s,l,u);return{origin:Ts(r.transform.position),buffer:await t.extractComponentsEdgeLocations({indices:d,indicesLength:d.length,skipDeduplicate:!0,data:c,writerSettings:{reducedPrecision:!1,variants:0}},n)}}_setComponentIndices(e,t,n){let r=0;for(let s=0;s<n.length-1;s++){const a=n[s],o=n[s+1];for(let l=a;l<o;l++){const c=t?t[l]:l;e.set(c,r)}r++}}_computeVisibilityIndices(e,t,n,r){if(e&&t.allVisible())return e;let s=0;t.forEachComponentRange((l,c)=>(s+=n[c]-n[l],!0));const a=Array.isArray(e)?new Array(s):(e==null?void 0:e.BYTES_PER_ELEMENT)===2||r<=65536?new Uint16Array(s):new Uint32Array(s);let o=0;return t.forEachComponentRange((l,c)=>{const u=n[l],d=n[c];for(let h=u;h<d;h++)a[o++]=e?e[h]:h;return!0}),a}addComponentHighlight(e,t){const n=e.components;B(n.highlightCounts)&&(n.highlightCounts=new Uint32Array(n.count+1)),n.highlightCounts[t]++===0&&(n.highlightsDirty(),this._notifyDirty()),n.highlightCounts[n.count]++}removeComponentHighlight(e,t){const n=e.components;if(B(n.highlightCounts))return void cee.warn("Removing non-existing highlight.");const r=n.highlightCounts[t],s=n.highlightCounts[n.count];if(r!==0){if(r>1)return n.highlightCounts[t]=r-1,void(n.highlightCounts[n.count]=s-1);n.highlightCounts[t]=0,n.highlightsDirty(),this._notifyDirty(),s===1?n.highlightCounts=null:n.highlightCounts[n.count]=s-1}else cee.warn("Removing non-existing highlight.")}clearHighlights(e){const t=e.components;T(t.highlightCounts)&&(t.highlightCounts=null,t.highlightsDirty(),this._notifyDirty())}getObjectGPUMemoryUsage(e){return e.renderable.meta.gpuMemoryEstimate}get visibleObjects(){return this._objects[Ax.Visible]}_createRenderable(e,t){const n=this._renderManager.rctx,r=e.geometry,s=r.vertices.layoutParameters,a=In.createVertex(n,kn.STATIC_DRAW,r.vertices.data),o=Qa(r.indices,g=>In.createIndex(n,kn.STATIC_DRAW,g)),l=Dh(z_t(s)),c=new Uint16Array(r.vertices.count);for(let g=0;g<t.count;g++){const _=t.offsets[g],b=t.offsets[g+1],x=t.materialDataIndices[g];if(T(r.indices))for(let w=_;w<b;w++)c[r.indices[w]]=x;else for(let w=_;w<b;w++)c[w]=x}const u=In.createVertex(n,kn.STATIC_DRAW,c.buffer),d=new sa(e.transform,e.toMapSpace),h=new Ph(n,Vme,{data:l,componentIndices:r0t},{data:a,componentIndices:u},kt(o)),p=new kme(h,Qi.TRIANGLES,s,T(o)),m={cameraDepthSquared:.5,gpuMemoryEstimate:a.byteSize+u.byteSize+(T(o)?o.byteSize:0)};return new I_t(d,p,m)}_notifyDirty(){this._renderManager.notifyDirty()}};const r0t=Dh(Js().u16(j.COMPONENTINDEX));function G4(i,e){return i===e?Gs.All:i===0?Gs.None:Gs.Some}const uee=ny(),AO=q(),MO=q();let Ume=class extends Es{constructor(){super(...arguments),this.opacity=1}};function s0t(i){const e=new Nr;return e.include(dg),e.fragment.uniforms.add(new sn("tex",t=>t.texture)),i.hasOpacityFactor&&e.fragment.uniforms.add(new Hi("opacity",t=>t.opacity)),e.fragment.code.add(ee`
    void main() {
      gl_FragColor = texture2D(tex, uv) ${i.hasOpacityFactor?"* opacity":""};
    }`),e}const a0t=Object.freeze(Object.defineProperty({__proto__:null,CompositingPassParameters:Ume,build:s0t},Symbol.toStringTag,{value:"Module"}));var Ro;(function(i){i[i.None=0]="None",i[i.Alpha=1]="Alpha",i[i.PremultipliedAlpha=2]="PremultipliedAlpha",i[i.COUNT=3]="COUNT"})(Ro||(Ro={}));let g8=class extends ic{constructor(){super(...arguments),this.alphaMode=Ro.None,this.hasOpacityFactor=!1}};f([Pe({count:Ro.COUNT})],g8.prototype,"alphaMode",void 0),f([Pe()],g8.prototype,"hasOpacityFactor",void 0);let yH=class extends _n{initializeProgram(e){return new gn(e.rctx,yH.shader.get().build(this.configuration),Mn)}initializePipeline(){switch(this.configuration.alphaMode){case Ro.None:return yi({colorWrite:$i});case Ro.Alpha:return yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i});case Ro.PremultipliedAlpha:case Ro.COUNT:return yi({blending:vf(vt.ONE,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i})}}};yH.shader=new bn(a0t,()=>Ee(()=>import("./Compositing.glsl-ac03de5f.js"),["./Compositing.glsl-ac03de5f.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let Hme=class extends Es{};function o0t(){const i=new Nr;return i.include(dg),i.fragment.uniforms.add(new sn("tex",e=>e.texture)),i.fragment.code.add(ee`void main() {
gl_FragColor = vec4(1.0 - texture2D(tex, uv).a);
}`),i}const l0t=Object.freeze(Object.defineProperty({__proto__:null,HUDCompositingPassParameters:Hme,build:o0t},Symbol.toStringTag,{value:"Module"}));let _H=class extends _n{initializeProgram(e){return new gn(e.rctx,_H.shader.get().build(),Mn)}initializePipeline(){return yi({colorWrite:{r:!1,g:!0,b:!1,a:!1}})}};_H.shader=new bn(l0t,()=>Ee(()=>import("./HUDCompositing.glsl-b4dd94c5.js"),["./HUDCompositing.glsl-b4dd94c5.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let Gme=class extends Es{};function c0t(){const i=new Nr;return i.include(dg),i.fragment.uniforms.add([new sn("colorTexture",e=>e.colorTexture),new sn("alphaTexture",e=>e.alphaTexture),new sn("frontFaceTexture",e=>e.frontFaceTexture)]),i.fragment.code.add(ee`void main() {
vec4 srcColor = texture2D(colorTexture, uv);
if(srcColor.a <= 1e-5){
discard;
}
float srcAlpha = texture2D(alphaTexture, uv).r;
vec4 frontFace = texture2D(frontFaceTexture, uv);
gl_FragColor = vec4(mix(srcColor.rgb/srcColor.a, frontFace.rgb, frontFace.a), 1.0 - srcAlpha);
}`),i}const u0t=Object.freeze(Object.defineProperty({__proto__:null,OITCompositingPassParameters:Gme,build:c0t},Symbol.toStringTag,{value:"Module"}));let bH=class extends _n{initializeProgram(e){return new gn(e.rctx,bH.shader.get().build(),Mn)}initializePipeline(){return yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i})}};bH.shader=new bn(u0t,()=>Ee(()=>import("./OITCompositing.glsl-7ef24906.js"),["./OITCompositing.glsl-7ef24906.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let Wme=class extends Es{constructor(){super(...arguments),this.overlayIndex=br.INNER,this.opacity=1}};function d0t(){const i=new Nr;return i.include(dg),i.fragment.uniforms.add(new sn("tex",e=>e.texture)),i.fragment.uniforms.add(new BB("overlayIdx",e=>e.overlayIndex)),i.fragment.uniforms.add(new Hi("opacity",e=>e.opacity)),i.fragment.code.add(ee`void main() {
vec2 overlayUV = overlayIdx == 0 ? vec2(uv.x * 0.5, uv.y) : vec2(uv.x * 0.5 + 0.5, uv.y);
gl_FragColor = texture2D(tex, overlayUV) * opacity;
}`),i}const h0t=Object.freeze(Object.defineProperty({__proto__:null,OverlayCompositingPassParameters:Wme,build:d0t},Symbol.toStringTag,{value:"Module"}));let wH=class extends _n{initializeProgram(e){return new gn(e.rctx,wH.shader.get().build(),Mn)}initializePipeline(){return yi({blending:vf(vt.ONE,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i})}};wH.shader=new bn(h0t,()=>Ee(()=>import("./OverlayCompositing.glsl-a89d63ce.js"),["./OverlayCompositing.glsl-a89d63ce.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let p0t=class{constructor(e,t){this._rctx=e,this._techniqueRepository=t,this._configuration=new g8,this._passParameters=new Ume,this._oitParameters=new Gme,this._hudParameters=new Hme,this._overlayParameters=new Wme}dispose(){this._vao=Ht(this._vao)}compositeOIT(e,t,n,r){this._oitParameters.colorTexture=t,this._oitParameters.alphaTexture=n,this._oitParameters.frontFaceTexture=r;const s=this._rctx,a=this._techniqueRepository.acquire(bH);s.bindTechnique(a,this._oitParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(Qi.TRIANGLE_STRIP,0,al(o,"geometry")),a.release()}compositeHUD(e,t){this._hudParameters.texture=t;const n=this._rctx,r=this._techniqueRepository.acquire(_H);n.bindTechnique(r,this._hudParameters,e);const s=this._ensureVAO();n.bindVAO(s),n.drawArrays(Qi.TRIANGLE_STRIP,0,al(s,"geometry")),r.release()}compositeOverlay(e,t,n,r){this._overlayParameters.texture=t,this._overlayParameters.opacity=n,this._overlayParameters.overlayIndex=r;const s=this._rctx,a=this._techniqueRepository.acquire(wH);s.bindTechnique(a,this._overlayParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(Qi.TRIANGLE_STRIP,0,al(o,"geometry")),a.release()}composite(e,t,n=Ro.None,r=1){const s=this._rctx;this._configuration.alphaMode=n,this._configuration.hasOpacityFactor=r!==1,this._passParameters.texture=t,this._passParameters.opacity=r;const a=this._techniqueRepository.acquire(yH,this._configuration);s.bindTechnique(a,this._passParameters,e);const o=this._ensureVAO();s.bindVAO(o),s.drawArrays(Qi.TRIANGLE_STRIP,0,al(o,"geometry")),a.release()}_ensureVAO(){return B(this._vao)&&(this._vao=tc(this._rctx)),this._vao}};const f0t=1e4,v8=100,m0t=500,g0t=500,v0t=.1;function y0t(i,e,t){return mre(e,i)*(t[1]-t[0])+t[0]}function _0t(i,e,t){if(e.size<f0t)return A0t.compute(i,e);const n=bM();return t.forAll(r=>{r.isVisible&&CC(n,b0t(i,r))}),n}function b0t(i,e){if(!e.isVisible)return;const t=bM(),n=e.getSpatialQueryAccelerator();return T(n)?w0t(t,i,n):x0t(t,i,e.objects),t}function w0t(i,e,t){const n=e.eye,r=e.viewForward,s=e.frustum,a=l=>l.isVisible,o=t.objectCount;if(o<m0t)IA(nd,e.near,Math.min(i.near,e.far)),t.forEachInDepthRange(n,r,hh.DepthOrder.FRONT_TO_BACK,nd,(l,c)=>{y8(i,e,l),nd.far=i.near,c.setRange(nd)},s,a),IA(nd,Math.max(i.far,e.near),e.far),t.forEachInDepthRange(n,r,hh.DepthOrder.BACK_TO_FRONT,nd,(l,c)=>{y8(i,e,l),nd.near=i.far,c.setRange(nd)},s,a);else{const l=Math.max(Math.min(o,g0t),Math.ceil(o*v0t)),c=t.findClosest(r,hh.DepthOrder.FRONT_TO_BACK,s,a,l),u=t.findClosest(r,hh.DepthOrder.BACK_TO_FRONT,s,a,l);c&&u&&(dee(i,e,c.boundingVolumeWorldSpace.bounds),dee(i,e,u.boundingVolumeWorldSpace.bounds))}}function x0t(i,e,t){N1.clear(),t.forAll(n=>{n.isVisible&&n.geometryRecords.length!==0&&N1.add(n)}),N1.empty||(N1.sort(e),IA(nd,e.near,Math.min(i.near,e.far)),N1.forEachInDepthRange(nd,hh.DepthOrder.FRONT_TO_BACK,(n,r)=>{r<i.near&&y8(i,e,n)}),IA(nd,Math.max(i.far,e.near),e.far),N1.forEachInDepthRange(nd,hh.DepthOrder.BACK_TO_FRONT,(n,r,s)=>{i.far=Math.max(i.far,s)}))}function y8(i,e,t){if(!t.isVisible||!e3(e.frustum,t.boundingVolumeWorldSpace.bounds))return;const n=t.transformation,r=E0t;t.geometryRecords.forEach(s=>{Vs(r,n,s.getShaderTransformation());const a=J0(r);jme(i,e,s.geometry.boundingInfo,r,a)})}function jme(i,e,t,n,r){if(B(t))return;$t(Ka,t.center,n);const{eye:s,viewForward:a}=e,o=a[0]*(Ka[0]-s[0])+a[1]*(Ka[1]-s[1])+a[2]*(Ka[2]-s[2]);if(Ka[3]=t.radius*r,!(o-Ka[3]>i.near&&o+Ka[3]<i.far)&&e3(e.frustum,Ka))if(t.radius>v8&&t.getChildren()){const l=t.getChildren();for(let c=0;c<8;++c)l[c]&&jme(i,e,l[c],n,r)}else _8.unionDepthRangeWithAABB(i,e.viewProjectionMatrix,n,t.bbMin,t.bbMax)}function dee(i,e,t){const n=e.eye,r=e.viewForward,s=(t[0]-n[0])*r[0]+(t[1]-n[1])*r[1]+(t[2]-n[2])*r[2];i.near=Math.min(i.near,s-t[3]),i.far=Math.max(i.far,s+t[3])}let C0t=class{constructor(){this._items=new pn({allocator:e=>e||{obj:null,distance:0,near:0,far:0},deallocator:e=>(e.obj=null,e.distance=0,e.near=0,e.far=0,e)})}get length(){return this._items.length}get empty(){return this._items.length===0}clear(){this._items.clear()}add(e){this._items.pushNew().obj=e}sort(e){const t=e.eye,n=e.viewForward;this._items.forAll(r=>{const s=r.obj.boundingVolumeWorldSpace.bounds,a=(s[0]-t[0])*n[0]+(s[1]-t[1])*n[1]+(s[2]-t[2])*n[2];r.distance=a,r.near=a-s[3],r.far=a+s[3]}),this._items.sort((r,s)=>r.distance-s.distance)}forEachInDepthRange(e,t,n){if(t===hh.DepthOrder.FRONT_TO_BACK)for(let r=0;r<this._items.length;++r){const s=this._items.data[r];s.far<e.near||s.near>e.far||n(s.obj,s.near,s.far)}else for(let r=this._items.length-1;r>=0;--r){const s=this._items.data[r];s.far<e.near||s.near>e.far||n(s.obj,s.near,s.far)}}},T0t=class{constructor(){this._view=St(),this._viewProj=St(),this._frustum=_2(),this._geometries=[],this._near=[],this._far=[],this._nearCandidates=[],this._farCandidates=[],this._range={near:0,far:0},this._looseRange={near:0,far:0}}compute(e,t){this._reset(),da(this._view,e.viewMatrix),Vs(this._viewProj,e.projectionMatrix,this._view),JI(this._frustum,e.frustum);const n=this._view,r=n[2],s=n[6],a=n[10],o=n[14],l=this._range;let c=0;if(t.forEach(p=>{if(!p.instanceParameters.visible||!p.castShadow)return;let m;p.hasShaderTransformation?(p.computeBoundingSphere(p.getShaderTransformation(),Ka,1),m=Ka):m=p.boundingSphere;const g=r*m[0]+s*m[1]+a*m[2]+o,_=g-m[3],b=g+m[3];this._geometries[c]=p,this._near[c]=-b,this._far[c]=-_,++c}),this._geometries.length===0)return l;for(let p=0;p<this._geometries.length;++p)this._near[p]>l.far&&(l.far=this._near[p]),this._near[p]>2&&this._far[p]<l.near&&(l.near=this._far[p]);const u=this._looseRange;u.near=Math.max(.5*l.near,2),u.far=2*l.far;let d=0,h=0;for(let p=0;p<this._geometries.length;++p)this._near[p]<l.near&&(this._near[p]>=u.near?l.near=this._near[p]:this._nearCandidates[d++]=p),this._far[p]>l.far&&(this._far[p]<=u.far?l.far=this._far[p]:this._farCandidates[h++]=p);if(this._nearCandidates.length===0&&this._farCandidates.length===0)return l;this._nearCandidates.sort((p,m)=>this._near[p]<this._near[m]?-1:this._near[p]>this._near[m]?1:0),this._farCandidates.sort((p,m)=>this._far[p]<this._far[m]?1:this._far[p]>this._far[m]?-1:0);for(let p=0;p<this._nearCandidates.length;++p){const m=this._nearCandidates[p];if(this._near[m]<l.near){const g=this._geometries[m],_=g.boundingInfo;this._includeNearBoundingInfoRec(_,g.getShaderTransformation())}}for(let p=0;p<this._farCandidates.length;++p){const m=this._farCandidates[p];if(this._far[m]>l.far){const g=this._geometries[m],_=g.boundingInfo;this._includeFarBoundingInfoRec(_,g.getShaderTransformation())}}return l}_reset(){this._geometries.length=0,this._near.length=0,this._far.length=0,this._nearCandidates.length=0,this._farCandidates.length=0,this._range.near=Number.MAX_VALUE,this._range.far=-Number.MAX_VALUE}_includeNearBoundingInfoRec(e,t){if(B(e))return;const n=e.getCenter();$t(Ka,n,t);const r=J0(t),s=Ka[0],a=Ka[1],o=Ka[2],l=e.getBSRadius()*r,c=this._frustum;if(c[0][0]*s+c[0][1]*a+c[0][2]*o+c[0][3]>l||c[1][0]*s+c[1][1]*a+c[1][2]*o+c[1][3]>l||c[2][0]*s+c[2][1]*a+c[2][2]*o+c[2][3]>l||c[3][0]*s+c[3][1]*a+c[3][2]*o+c[3][3]>l)return;const u=this._view[2]*s+this._view[6]*a+this._view[10]*o+this._view[14],d=u+l;if(!(-(u-l)<2||-d>=this._range.near))if(-d>this._looseRange.near)this._range.near=-d;else{if(l>v8){const h=e.getChildren();if(h!==void 0){for(let p=0;p<8;++p)h[p]!==void 0&&this._includeNearBoundingInfoRec(h[p],t);return}}_8.unionDepthRangeWithAABB(this._range,this._viewProj,t,e.getBBMin(),e.getBBMax())}}_includeFarBoundingInfoRec(e,t){if(B(e))return;let n=e.getBSRadius();const r=e.getCenter();$t(Ka,r,t);const s=J0(t),a=Ka[0],o=Ka[1],l=Ka[2];n*=s;const c=this._frustum;if(c[0][0]*a+c[0][1]*o+c[0][2]*l+c[0][3]>n||c[1][0]*a+c[1][1]*o+c[1][2]*l+c[1][3]>n||c[2][0]*a+c[2][1]*o+c[2][2]*l+c[2][3]>n||c[3][0]*a+c[3][1]*o+c[3][2]*l+c[3][3]>n)return;const u=this._view[2]*a+this._view[6]*o+this._view[10]*l+this._view[14]-n;if(!(-u<=this._range.far))if(-u<this._looseRange.far)this._range.far=-u;else{if(n>v8){const d=e.getChildren();if(d!==void 0){for(let h=0;h<8;++h)d[h]!==void 0&&this._includeFarBoundingInfoRec(d[h],t);return}}_8.unionDepthRangeWithAABB(this._range,this._viewProj,t,e.getBBMin(),e.getBBMax())}}},S0t=class{constructor(){this._modelViewProj=St(),this._clipPosition=[Dn(),Dn(),Dn(),Dn(),Dn(),Dn(),Dn(),Dn()]}unionDepthRangeWithAABB(e,t,n,r,s){const a=this._modelViewProj;Vs(a,t,n);let o=!1;for(let l=0;l<8;++l){const c=this._clipPosition[l],u=l===0||l===3||l===4||l===7?r[0]:s[0],d=l===0||l===1||l===4||l===5?r[1]:s[1],h=l<4?r[2]:s[2];c[0]=a[0]*u+a[4]*d+a[8]*h+a[12],c[1]=a[1]*u+a[5]*d+a[9]*h+a[13],c[2]=a[2]*u+a[6]*d+a[10]*h+a[14],c[3]=a[3]*u+a[7]*d+a[11]*h+a[15]}for(let l=0;l<12;++l){const c=this._clipPosition[W4[l][0]],u=this._clipPosition[W4[l][1]],d=this._clipPosition[W4[l][2]],h=this._clipTriangle(c,u,d);let p=!0;for(let m=0;m<h.length;++m)if(h[m][3]>=2){p=!1;break}if(!p){o=!0;for(let m=0;m<h.length;++m){const g=h[m][3];Number.isFinite(g)&&(e.near=Math.min(g,e.near),e.far=Math.max(g,e.far))}}}return o}_inside(e,t){return t===0?e[0]>=-e[3]:t===1?e[1]>=-e[3]:t===2?e[0]<=e[3]:t===3?e[1]<=e[3]:void Ti(!1)}_intersect(e,t,n){let r=0;return n===0?r=(-e[3]-e[0])/(t[0]-e[0]+t[3]-e[3]):n===1?r=(-e[3]-e[1])/(t[1]-e[1]+t[3]-e[3]):n===2?r=(e[3]-e[0])/(t[0]-e[0]-t[3]+e[3]):n===3&&(r=(e[3]-e[1])/(t[1]-e[1]-t[3]+e[3])),bne(Dn(),e,t,r)}_clipTriangle(e,t,n){let r=[e,t,n];for(let s=0;s<4;++s){const a=r;r=[];for(let o=0;o<a.length;++o){const l=a[o],c=a[(o+1)%a.length];this._inside(c,s)?(this._inside(l,s)||r.push(this._intersect(l,c,s)),r.push(c)):this._inside(l,s)&&r.push(this._intersect(l,c,s))}}return r}};const W4=[[0,1,3],[2,3,1],[1,5,2],[6,2,5],[5,4,6],[7,6,4],[4,0,7],[3,7,0],[3,2,7],[6,7,2],[4,5,0],[1,0,5]],Ka=gf(),E0t=St(),nd=bM(),N1=new C0t,A0t=new T0t,_8=new S0t;let M0t=class{},P0t=class extends Es{constructor(){super(...arguments),this.textures=new M0t}};function O0t(){const i=new Nr;return i.attributes.add(j.POSITION,"vec2"),i.vertex.uniforms.add(new jp("drawPosition",(e,t)=>R0t(e,t))),i.varyings.add("vUV","vec2"),i.vertex.code.add(ee`void main(void) {
vUV = position;
gl_Position = vec4(drawPosition.xy + vec2(position - 0.5) * drawPosition.zw, 0.0, 1.0);
}`),i.fragment.uniforms.add(new sn("textureInput",e=>e.textures.input)),i.fragment.uniforms.add(new sn("textureMask",e=>e.textures.mask)),i.fragment.uniforms.add(new sn("textureOverlay",e=>e.textures.overlay)),i.fragment.uniforms.add(new f2("maskEnabled",e=>e.magnifier.maskEnabled)),i.fragment.uniforms.add(new f2("overlayEnabled",e=>e.magnifier.overlayEnabled)),i.fragment.code.add(ee`const float barrelFactor = 1.1;
vec2 barrel(vec2 uv) {
vec2 uvn = uv * 2.0 - 1.0;
if (uvn.x == 0.0 && uvn.y == 0.0) {
return vec2(0.5, 0.5);
}
float theta = atan(uvn.y, uvn.x);
float r = pow(length(uvn), barrelFactor);
return r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;
}
void main() {
float mask = maskEnabled ? texture2D(textureMask, vUV).a : 1.0;
vec4 inputColor = texture2D(textureInput, barrel(vUV)) * mask;
vec4 overlayColor = overlayEnabled ? texture2D(textureOverlay, vUV) : vec4(0);
gl_FragColor = overlayColor + (1.0 - overlayColor.a) * inputColor;
}`),i}function R0t(i,e){const t=e.camera.pixelRatio,n=i.magnifier.offset.x*t,r=i.magnifier.offset.y*t;Ep(i.magnifier.position,hee);const s=e.camera.screenToRender(hee,I0t),a=Math.ceil(t*i.magnifier.size),o=e.camera.fullWidth,l=e.camera.fullHeight;return dl($0t,(s[0]+n)/o*2-1,(s[1]-r)/l*2-1,a/o*2,a/l*2)}const hee=Fn(),I0t=wie(),$0t=Dn();async function L0t(i){const e=Ee(()=>import("./mask-svg-82caf882.js"),[],import.meta.url),t=Ee(()=>import("./overlay-svg-615b0a3b.js"),[],import.meta.url),n=tb((await e).default,{signal:i}),r=tb((await t).default,{signal:i}),s={mask:await n,overlay:await r};return Cn(i),s}let yw=class extends et{constructor(){super(...arguments),this._handles=new mi,this._magnifier=null,this._imageSources=null,this._imageLoadTask=null,this._resources=null,this._passParameters=new P0t,this.events=new Pn,this.attributeLocations=new Map([[j.POSITION,0]]),this._tmpScreenPoint=Fn(),this._tmpRenderPoint=wie()}get updating(){return B(this._imageSources)&&T(this._imageLoadTask)&&!this._imageLoadTask.task.finished}get magnifier(){return this._magnifier}set magnifier(e){if(e===this._magnifier)return;this._handles.removeAll(),this._magnifier=e;const t=()=>{this._updateResourceLoading(),this.events.emit("request-render")};T(this._magnifier)&&this._handles.add(ue(()=>Qa(this._magnifier,n=>n.version),t)),t()}get enabled(){return T(this._validMagnifier)}get _validMagnifier(){return T(this._magnifier)&&this._magnifier.visible&&T(this._magnifier.position)&&this._magnifier.size>0?this._magnifier:null}get _factor(){return T(this._magnifier)&&this._magnifier.factor||1}dispose(){this._magnifier=null,this._handles.destroy(),T(this._imageLoadTask)&&(this._imageLoadTask.task.abort(),this._imageLoadTask=null),this._disposeResources()}render(e,t){const n=this._validMagnifier;if(B(n))return;const r=t.camera.pixelRatio,s=Math.ceil(r*n.size);if(this._updateResources(e,s),B(this._resources))return;const a=this._passParameters.textures,o=Math.ceil(1/this._factor*s);a.input.resize(o,o),Ep(n.position,this._tmpScreenPoint);const l=t.camera.screenToRender(this._tmpScreenPoint,this._tmpRenderPoint),c=t.camera.fullWidth,u=t.camera.fullHeight,d=.5*o,h=.5*o;l[0]=lt(l[0],d,c-d-1),l[1]=lt(l[1],h,u-h-1);const p=Math.floor(l[0]-d),m=Math.floor(l[1]-h),g=this._resources.program;g.bindTexture("textureInput",a.input),e.gl.copyTexImage2D(a.input.descriptor.target,0,a.input.descriptor.pixelFormat,p,m,o,o,0),this._passParameters.magnifier=n,e.useProgram(g),g.bindPass(this._passParameters,t),e.bindVAO(this._resources.vao),e.setPipelineState(this._resources.pipelineState),e.drawArrays(Qi.TRIANGLE_STRIP,0,4)}_updateResourceLoading(){const e=this._validMagnifier;if(B(e))return;const t=e.maskUrl,n=e.overlayUrl;!T(this._imageLoadTask)||this._imageLoadTask.maskUrl===t&&this._imageLoadTask.overlayUrl===n||(this._imageLoadTask.task.abort(),this._imageLoadTask=null,this._imageSources=null),T(this._imageSources)||T(this._imageLoadTask)||(this._imageLoadTask={maskUrl:t,overlayUrl:n,task:WA(async r=>{const s=B(t)||B(n)?L0t(r):null,a=T(t)?tb(t,{signal:r}):s.then(l=>l.mask),o=T(n)?tb(n,{signal:r}):s.then(l=>l.overlay);this._imageSources={mask:await a,overlay:await o},this._disposeResources(),this.events.emit("request-render")})},this._imageLoadTask.task.promise.then(()=>this.notifyChange("updating"),()=>this.notifyChange("updating")))}_updateResources(e,t){if(!this.enabled)return void this._disposeResources();if(T(this._resources)){if(this._passParameters.textures.size!==t){const r=this._createTextureResources(e,t);if(B(r))return void this._disposeResources();this._disposeTextureResources(this._passParameters.textures),this._passParameters.textures=r}return}const n=this._createTextureResources(e,t);B(n)||(this._resources={program:this._createProgram(e),vao:tc(e,Rbe,this.attributeLocations,0,1),pipelineState:yi({blending:vf(vt.ONE,vt.ONE_MINUS_SRC_ALPHA),depthTest:null,depthWrite:null,colorWrite:$i})},this._passParameters.textures=n)}_disposeResources(){B(this._resources)||(this._disposeTextureResources(this._passParameters.textures),this._resources.program.dispose(),this._resources.vao.dispose(),this._resources=null)}_disposeTextureResources(e){e.mask.dispose(),e.overlay.dispose(),e.input.dispose()}_createTextureResources(e,t){if(B(this._imageSources))return null;this._imageSources.overlay.width=t,this._imageSources.overlay.height=t,this._imageSources.mask.width=t,this._imageSources.mask.height=t;const n=new Er(e,{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,internalFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR,flipped:!0,preMultiplyAlpha:!lB(this._imageSources.overlay.src)||!e.driverTest.svgAlwaysPremultipliesAlpha},this._imageSources.overlay),r=new Er(e,{target:Wn.TEXTURE_2D,pixelFormat:Ui.ALPHA,internalFormat:Ui.ALPHA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR,flipped:!0},this._imageSources.mask);return{input:new Er(e,{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,internalFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR,flipped:!1}),mask:r,overlay:n,size:t}}_createProgram(e){return new gn(e,O0t(),this.attributeLocations)}};f([y()],yw.prototype,"_imageSources",void 0),f([y()],yw.prototype,"_imageLoadTask",void 0),f([y({readOnly:!0})],yw.prototype,"updating",null),yw=f([ge("esri/views/3d/webgl-engine/lib/MagnifierHelper")],yw);let D0t=class{constructor(){this.declaredClass="esri.views.3d.webgl-engine.lib.ObjectAndLayerIdRenderHelper",this.colorZero=new by(new ArrayBuffer(4)),this._uidToRenderColor=new Map,this._colorToUID=new Map,this._layerUidToGraphicsUidToObjectId=new Map,this._layerUidToId=new Map,this._layerUidToPopupEnabled=new Map}setUidToObjectAndLayerId(e,t,n,r,s,a=null,o=null,l=null){if(!(e&&t&&n&&r)||(this._layerUidToId.set(r,n),this._layerUidToPopupEnabled.set(r,s),!s))return;let c=this._layerUidToGraphicsUidToObjectId.get(r);c||(c=new Map,this._layerUidToGraphicsUidToObjectId.set(r,c)),c.set(t,{objectId:e,attributeNodeId:a,attributeIndex:o,subLayerId:l})}getObjectAndLayerIdColor(e){const t=this.getObjectAndLayerIdColorArray(e);return Xn(t.get(0,1),t.get(0,2),t.get(0,3),255)}getObjectAndLayerIdColorArray(e){if(!e.layerUid||!e.graphicUid)return this.colorZero;const t=this._layerUidToPopupEnabled.get(e.layerUid);if(t===void 0)return tt.getLogger(this.declaredClass).warn("popupEnabled is undefined for layerUid "+e.layerUid),this.colorZero;if(t===!1)return this.colorZero;let n=this._uidToRenderColor.get(e.layerUid);n||(n=new Map,this._uidToRenderColor.set(e.layerUid,n));let r=n.get(e.graphicUid);if(!r){for(;!r;){const a=Math.floor(16777214*Math.random())+1;this._colorToUID.has(a)||(r=a)}if(r>16777215)throw new Error("Object ID Overflow");n.set(e.graphicUid,r),this._colorToUID.set(r,e)}const s=new ArrayBuffer(4);return new DataView(s).setUint32(0,r,!1),new by(s)}getColorToObjectAndLayerIdMapping(){const e=new Map;for(const[t,n]of this._colorToUID.entries()){const r=this._layerUidToGraphicsUidToObjectId.get(n.layerUid);let s=null;r?(s=r.get(n.graphicUid),s||tt.getLogger(this.declaredClass).warn("getColorMapping: no entry found for graphicsId "+n.graphicUid)):tt.getLogger(this.declaredClass).warn("getColorMapping: no entry found for layerUid "+n.layerUid);const a=this._layerUidToId.get(n.layerUid);a||tt.getLogger(this.declaredClass).warn("no layerId found for uid "+n.layerUid),s&&a&&e.set(t,s.attributeNodeId?{type:"object-and-layer-and-i3s-id",oid:s.objectId,lid:a,attrId:s.attributeNodeId,attrIdx:s.attributeIndex,subLayerId:s.subLayerId}:{type:"object-and-layer-id",oid:s.objectId,lid:a})}return e}};const k0t=.5,F0t=30,pee=Wi(1e3/1),N0t=Wi(1e3/F0t);var $A;(function(i){i[i.FrontToBack=0]="FrontToBack",i[i.BackToFront=1]="BackToFront"})($A||($A={}));let Qg=class{constructor(e,t,n=$A.FrontToBack){this._rctx=e,this._techniqueRepository=t,this._sorting=n,this._draws=new pn({initialSize:32,allocator:r=>r||{material:null,geometry:null,geometryRanges:null,bindDrawParams:null,depthSquaredHint:0,indexType:0}}),this._previouslyBoundDraw=new Map}submitDraw(e,t,n,r){const s=this._draws.pushNew();s.geometry=t,s.geometryRanges=n,s.material=e,s.depthSquaredHint=r,s.indexType=t.indexed?kt(t.vao.indexBuffer).indexType:0}dispatch(e,t){const n=this._rctx;this._previouslyBoundDraw.clear();let r=null;const s=this._draws.map(o=>o.material.prepareTechnique(this._techniqueRepository,e,t,o.geometry.parameters)),a=this._draws.length;for(let o=0;o<a;o++){const l=s[o];l===r&&l.configuration.transparencyPassType===ln.NONE||(n.bindTechnique(l,e,t),r=l);const c=this._draws.data[o],u=c.geometry;n.bindVAO(u.vao),this._previouslyBoundDraw.get(l)!==c.material&&(l.program.bindDraw(c.material,t,e),this._previouslyBoundDraw.set(l,c.material));const d=c.geometryRanges,h=d.length;if(c.indexType!==0){const p=_I.get(c.indexType);for(let m=0;m<h;m+=2){const g=d[m],_=d[m+1];n.drawElements(u.primitiveType,_,c.indexType,g*p)}}else for(let p=0;p<h;p+=2){const m=d[p],g=d[p+1];n.drawArrays(u.primitiveType,m,g)}}}prepareSubmit(){this._draws.clear()}finishSubmit(){const e=this._sorting===$A.FrontToBack?1:-1;this._draws.sort((t,n)=>{const r=e*(t.depthSquaredHint-n.depthSquaredHint);return r!==0?r:t.geometry.vao.size-n.geometry.vao.size})}get count(){return this._draws.length}};const _I=new Map;_I.set(sy.UNSIGNED_BYTE,1),_I.set(sy.UNSIGNED_SHORT,2),_I.set(sy.UNSIGNED_INT,4);let V0t=class{constructor(e,t){this.rctx=e,this.shaderTechniqueRepository=t,this.canRender=!0,this._materialPassParameters=new ayt,this._shadowPassParameters=new oyt,this._highlightPassParameters=new lyt,this._systems=new Set,this._passes={materialOpaque:new Qg(e,t),materialTransparent:new Qg(e,t,$A.BackToFront),materialIntegratedMesh:new Qg(e,t),shadowMap:new Qg(e,t),highlight:new Qg(e,t),highlightIntegratedMesh:new Qg(e,t),highlightShadowMap:new Qg(e,t),defaultShadowMap:new Qg(e,t)}}register(e){this._systems.add(e)}prepareRender(e){if(this._systems.size!==0){for(const t of Object.values(this._passes))t.prepareSubmit();this._systems.forEach(t=>t.submit(this._passes,e.bindParameters));for(const t of Object.values(this._passes))t.finishSubmit();this.shaderTechniqueRepository.frameUpdate()}}render(e){if(this._systems.size!==0)switch(this._configure(e),e.bindParameters.slot){case at.OPAQUE_MATERIAL:switch(e.output){case Re.Color:return this._materialPassParameters.subPass=us.Color,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case Re.Depth:return this._materialPassParameters.subPass=us.Depth,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case Re.Normal:return this._materialPassParameters.subPass=us.Normal,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters);case Re.Highlight:return this._passes.highlight.dispatch(this._highlightPassParameters,e.bindParameters);case Re.Shadow:return this._passes.shadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case Re.ShadowHighlight:return this._passes.highlightShadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case Re.ShadowExludeHighlight:return this._passes.defaultShadowMap.dispatch(this._shadowPassParameters,e.bindParameters);case Re.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=us.ObjectAndLayerIdColor,this._passes.materialOpaque.dispatch(this._materialPassParameters,e.bindParameters)}return;case at.TRANSPARENT_MATERIAL:switch(e.output){case Re.Color:return this._materialPassParameters.subPass=us.Color,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case Re.Alpha:return this._materialPassParameters.subPass=us.Alpha,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case Re.Depth:return this._materialPassParameters.subPass=us.Depth,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case Re.Normal:return this._materialPassParameters.subPass=us.Normal,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters);case Re.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=us.ObjectAndLayerIdColor,this._passes.materialTransparent.dispatch(this._materialPassParameters,e.bindParameters)}return;case at.INTEGRATED_MESH:switch(e.output){case Re.Color:return this._materialPassParameters.subPass=us.Color,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case Re.Depth:return this._materialPassParameters.subPass=us.Depth,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case Re.Normal:return this._materialPassParameters.subPass=us.Normal,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters);case Re.Highlight:return this._passes.highlightIntegratedMesh.dispatch(this._highlightPassParameters,e.bindParameters);case Re.ObjectAndLayerIdColor:return this._materialPassParameters.subPass=us.ObjectAndLayerIdColor,this._passes.materialIntegratedMesh.dispatch(this._materialPassParameters,e.bindParameters)}return}}notifyDirty(){this._context.requestRender()}slots(){return[at.OPAQUE_MATERIAL,at.TRANSPARENT_MATERIAL,at.INTEGRATED_MESH]}initializeRenderContext(e){this._context=e}uninitializeRenderContext(){}queryDepthRange(e){const t={near:1/0,far:-1/0};return this._systems.forEach(n=>{const r=n.queryShadowCasterDepthRange(e);T(r)&&CC(t,r,t)}),t}_configure(e){const t=e.output===Re.Shadow||e.output===Re.ShadowHighlight||e.output===Re.ShadowExludeHighlight?this._shadowPassParameters:e.output===Re.Highlight?this._highlightPassParameters:this._materialPassParameters;this._updateParameters(e,t)}_updateParameters(e,t){const n=e.bindParameters.camera,r=n.viewInverseTransposeMatrix;je(j4,r[3],r[7],r[11]),q4.set(j4),Ge(t.transformWorldFromViewTH,q4.high),Ge(t.transformWorldFromViewTL,q4.low),Ge(t.slicePlaneLocalOrigin,j4),Um(t.transformViewFromCameraRelativeRS,n.viewMatrix),da(t.transformProjFromView,n.projectionMatrix),t.identifier===Cu.Material&&(this._materialPassParameters.transparent=e.bindParameters.slot===at.TRANSPARENT_MATERIAL,this._materialPassParameters.integratedMesh=e.bindParameters.slot===at.INTEGRATED_MESH,cg(fee,t.transformViewFromCameraRelativeRS),IC(t.transformNormalViewFromGlobal,fee))}get needsHighlight(){return this._passes.highlight.count>0||this._passes.highlightIntegratedMesh.count>0}get needsTransparentPass(){return this._passes.materialTransparent.count>0}};const j4=q(),fee=Ho(),q4=new OD,B0t=8.6,z0t=.4;function U0t(){const i=new Nr,{vertex:e,fragment:t}=i,n=e.code,r=t.code;return i.attributes.add(j.POSITION,"vec2"),i.varyings.add("uv","vec2"),i.attributes.add(j.UV0,"vec2"),e.uniforms.add(new sn("coverageTex",s=>s.coverageTexture)),n.add(ee`void main() {
vec4 cov = texture2D(coverageTex, uv0);
if (cov.r == 0.0) {
gl_Position = vec4(0.0);
return;
}
gl_Position = vec4(position, 0.0, 1.0);
uv = position.xy * 0.5 + vec2(0.5);
}`),t.uniforms.add(new sn("tex",s=>s.blurColorTexture)),t.uniforms.add(new sn("origin",s=>s.highlightColorTexture)),t.uniforms.add(new jp("uColor",s=>s.color)),t.uniforms.add(new jp("haloColor",s=>s.haloColor)),t.uniforms.add(new jp("opacities",s=>dl(H0t,s.haloOpacity,s.haloOpacityOccluded,s.fillOpacity,s.fillOpacityOccluded))),t.constants.add("outlineSize","float",B0t),t.constants.add("blurSize","float",z0t),r.add(ee`void main() {
vec4 blurredHighlightValue = texture2D(tex, uv);
float highlightIntensity = blurredHighlightValue.a;
if (highlightIntensity == 0.0) {
discard;
}
vec4 origin_color = texture2D(origin, uv);
float outlineIntensity;
float fillIntensity;
if (blurredHighlightValue.g > blurredHighlightValue.b) {
outlineIntensity = haloColor.w * opacities[1];
fillIntensity = uColor.w * opacities[3];
}
else {
outlineIntensity = haloColor.w * opacities[0];
fillIntensity = uColor.w * opacities[2];
}
float inner = 1.0 - outlineSize / 9.0;
float outer = 1.0 - (outlineSize + blurSize) / 9.0;
float outlineFactor = smoothstep(outer, inner, highlightIntensity);
float fillFactor = any(notEqual(origin_color, vec4(0.0, 0.0, 0.0, 0.0))) ? 1.0 : 0.0;
float intensity = outlineIntensity * outlineFactor * (1.0 - fillFactor) + fillIntensity * fillFactor;
gl_FragColor = vec4(mix(haloColor.rgb, uColor.rgb, fillFactor), intensity);
}`),i}const H0t=Dn(),G0t=Object.freeze(Object.defineProperty({__proto__:null,build:U0t},Symbol.toStringTag,{value:"Module"}));let xH=class extends _n{initializeProgram(e){return new gn(e.rctx,xH.shader.get().build(),Mn)}initializePipeline(){return yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i})}};xH.shader=new bn(G0t,()=>Ee(()=>import("./HighlightApply.glsl-9dbff037.js"),["./HighlightApply.glsl-9dbff037.js","./vec4-790471c0.js","./common-c186b691.js","./vec4f64-e407da96.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let qme=class extends Es{constructor(){super(...arguments),this.blurSize=xt()}};function W0t(){const i=new Nr,{vertex:e,fragment:t}=i,n=e.code,r=t.code;return i.attributes.add(j.POSITION,"vec2"),i.attributes.add(j.UV0,"vec2"),i.varyings.add("blurCoordinate","vec3"),e.uniforms.add(new sn("coverageTex",s=>s.coverageTexture)),t.uniforms.add(new gre("blurSize",s=>s.blurSize)),n.add(ee`void main() {
gl_Position = vec4(position, 0.0, 1.0);
vec4 cov = texture2D(coverageTex, uv0);
if (cov.r == 0.0) {
gl_Position = vec4(0.0);
}
blurCoordinate = vec3(gl_Position.xy * 0.5 + vec2(0.5), max(cov.g, cov.b));
}`),t.uniforms.add(new uz("tex",s=>s.blurInputTexture)),r.add(ee`void main() {
vec2 uv = blurCoordinate.xy;
vec4 center = texture2D(tex, uv);
if (blurCoordinate.z == 1.0) {
gl_FragColor = center;
} else {
vec4 sum = vec4(0.0);
sum += center * 0.204164;
sum += texture2D(tex, uv + blurSize * 1.407333) * 0.304005;
sum += texture2D(tex, uv - blurSize * 1.407333) * 0.304005;
sum += texture2D(tex, uv + blurSize * 3.294215) * 0.093913;
sum += texture2D(tex, uv - blurSize * 3.294215) * 0.093913;
gl_FragColor = sum;
}
}`),i}const j0t=Object.freeze(Object.defineProperty({__proto__:null,HighlightBlurDrawParameters:qme,build:W0t},Symbol.toStringTag,{value:"Module"}));let CH=class extends _n{initializeProgram(e){return new gn(e.rctx,CH.shader.get().build(),Mn)}initializePipeline(){return yi({colorWrite:$i})}};CH.shader=new bn(j0t,()=>Ee(()=>import("./HighlightBlur.glsl-2dc34009.js"),["./HighlightBlur.glsl-2dc34009.js","./vec2f64-30dc1443.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2-2cef68de.js","./common-c186b691.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let Kme=class extends Es{constructor(){super(...arguments),this.invFramebufferDim=xt()}};function q0t(){const i=new Nr,{vertex:e,fragment:t}=i,n=e.code,r=t.code;return i.attributes.add(j.POSITION,"vec2"),n.add(ee`void main() {
gl_Position = vec4(vec2(1.0) - position * 2.0, 0.0, 1.0);
}`),t.uniforms.add(new uz("tex",s=>s.inputTexture)),t.uniforms.add(new gre("invFramebufferDim",s=>s.invFramebufferDim)),r.add(ee`void main() {
vec2 coord = gl_FragCoord.xy * invFramebufferDim;
vec4 value = texture2D(tex, coord);
float mx = floor(max(value.g, value.b));
gl_FragColor = vec4(ceil(value.r), mx, mx, 1.0);
}`),i}const K0t=Object.freeze(Object.defineProperty({__proto__:null,HighlightDownsampleDrawParameters:Kme,build:q0t},Symbol.toStringTag,{value:"Module"}));let TH=class extends _n{initializeProgram(e){return new gn(e.rctx,TH.shader.get().build(),Mn)}initializePipeline(){return yi({colorWrite:$i})}};TH.shader=new bn(K0t,()=>Ee(()=>import("./HighlightDownsample.glsl-c6d06b9d.js"),["./HighlightDownsample.glsl-c6d06b9d.js","./vec2f64-30dc1443.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2-2cef68de.js","./common-c186b691.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let mee=class extends Es{constructor(){super(...arguments),this.color=Kx(1,0,1,1),this.haloColor=Kx(1,0,1,1),this.haloOpacity=1,this.haloOpacityOccluded=.25,this.fillOpacity=.2,this.fillOpacityOccluded=.05,this.shadowColor=Xn(1,0,1,1),this.shadowOpacity=.15,this.occludedShadowOpacity=.075}};const Y0t=32;let X0t=class{constructor(e,t){this._techniqueRep=e,this._rctx=t,this._viewportToRestore=Dn(),this._passParameters=new mee,this._downsampleDrawParameters=new Kme,this._blurDrawParameters=new qme,this._grid={coverageMipmap:null,vao:null,verticalCellCount:0,horizontalCellCount:0,cellPixelSize:0,mipmapLevels:0,viewportWidth:0,viewportHeight:0}}_assertResources(){if(this._quadVAO)return;this._quadVAO=tc(this._rctx);const e={colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE,width:0,height:0},t={target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.LINEAR,wrapMode:An.CLAMP_TO_EDGE,width:0,height:0};this._blur0Fbo=new ma(this._rctx,e,t),this._blur1Fbo=new ma(this._rctx,e,t),this._blurTechnique=this._techniqueRep.acquire(CH),this._downsampleTechnique=this._techniqueRep.acquire(TH),this._applyTechnique=this._techniqueRep.acquire(xH)}dispose(){if(this._blurTechnique=Lr(this._blurTechnique),this._downsampleTechnique=Lr(this._downsampleTechnique),this._applyTechnique=Lr(this._applyTechnique),this._grid.coverageMipmap)for(let e=1;e<this._grid.coverageMipmap.length;e++)this._grid.coverageMipmap[e].dispose();this._grid.vao&&this._grid.vao.dispose(!0),this._quadVAO&&(this._quadVAO.dispose(!0),this._quadVAO=null),this._blur0Fbo=Ht(this._blur0Fbo),this._blur1Fbo=Ht(this._blur1Fbo)}setDefaultOptions(e){this._passParameters={...new mee,...e}}render(e,t,n){this._passParameters.highlightColorTexture=t.colorTexture,this._assertResources();const r=e.camera;Em(this._viewportToRestore,r.fullViewport);const s=r.fullWidth,a=r.fullHeight,o=r.pixelRatio,l=Math.ceil(s/o),c=Math.ceil(a/o);this._blur0Fbo.resize(l,c),this._blur1Fbo.resize(l,c);const u=this._rctx;u.bindVAO(this._quadVAO);let d=null;this._gridUpdateResources(t,Y0t),this._gridComputeMipmap(e),this._passParameters.coverageTexture=this._grid.coverageMipmap[this._grid.mipmapLevels].colorTexture,d=this._grid.vao;const h=u.bindTechnique(this._blurTechnique,this._passParameters,e);u.bindVAO(d),u.bindFramebuffer(this._blur0Fbo),u.setViewport(0,0,l,c),u.setClearColor(0,0,0,0),u.clear(hr.COLOR_BUFFER_BIT),this._blurDrawParameters.blurInputTexture=t.colorTexture,Bi(this._blurDrawParameters.blurSize,1/l,0),h.bindDraw(this._blurDrawParameters,e,this._passParameters),u.drawArrays(this._blurTechnique.primitiveType,0,al(d,"geometry")),u.bindFramebuffer(this._blur1Fbo),u.clear(hr.COLOR_BUFFER_BIT),this._blurDrawParameters.blurInputTexture=this._blur0Fbo.colorTexture,Bi(this._blurDrawParameters.blurSize,0,1/c),h.bindDraw(this._blurDrawParameters,e,this._passParameters),u.drawArrays(this._blurTechnique.primitiveType,0,al(d,"geometry")),u.bindFramebuffer(n),u.setViewport(this._viewportToRestore[0],this._viewportToRestore[1],this._viewportToRestore[2],this._viewportToRestore[3]),this._passParameters.blurColorTexture=this._blur1Fbo.colorTexture,u.bindTechnique(this._applyTechnique,this._passParameters,e),u.drawArrays(this._applyTechnique.primitiveType,0,al(d,"geometry")),u.bindVAO(null)}_gridUpdateResources(e,t){const n=this._rctx,r=this._grid;let s=!1;if(r.coverageMipmap===null&&(r.coverageMipmap=[e],s=!0),r.viewportWidth===e.width&&r.viewportHeight===e.height||(s=!0,r.viewportWidth=e.width,r.viewportHeight=e.height),r.coverageMipmap[0]=e,r.cellPixelSize!==t&&(r.cellPixelSize=t,s=!0),s){for(let l=1;l<r.coverageMipmap.length;l++)r.coverageMipmap[l].dispose();r.mipmapLevels=Math.ceil(Math.log(r.cellPixelSize)*Math.LOG2E),r.coverageMipmap.length=r.mipmapLevels+1;for(let l=0;l<r.mipmapLevels;l++){const c=r.coverageMipmap[l],u={target:Wn.TEXTURE_2D,pixelFormat:Ui.RGB,dataType:un.UNSIGNED_SHORT_5_6_5,samplingMode:fn.LINEAR,wrapMode:An.CLAMP_TO_EDGE,width:Math.ceil(c.width/2),height:Math.ceil(c.height/2)},d={colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE,width:Math.ceil(c.width/2),height:Math.ceil(c.height/2)};r.coverageMipmap[l+1]=new ma(n,d,u)}}const a=Math.ceil(e.height/r.cellPixelSize),o=Math.ceil(e.width/r.cellPixelSize);if(!r.vao||r.verticalCellCount!==a||r.horizontalCellCount!==o){r.verticalCellCount=a,r.horizontalCellCount=o;const l=a+1,c=o+1,u=1/a,d=1/o,h=6,p=4,m=new Float32Array(h*p*l*c);let g=0;for(let _=0;_<l;_++)for(let b=0;b<c;b++)m[g+0]=(b-.5)*d*2-1,m[g+1]=(_-.5)*u*2-1,m[g+2]=b*d,m[g+3]=_*u,m[g+4]=(b+.5)*d*2-1,m[g+5]=(_-.5)*u*2-1,m[g+6]=b*d,m[g+7]=_*u,m[g+8]=(b-.5)*d*2-1,m[g+9]=(_+.5)*u*2-1,m[g+10]=b*d,m[g+11]=_*u,m[g+12]=(b-.5)*d*2-1,m[g+13]=(_+.5)*u*2-1,m[g+14]=b*d,m[g+15]=_*u,m[g+16]=(b+.5)*d*2-1,m[g+17]=(_-.5)*u*2-1,m[g+18]=b*d,m[g+19]=_*u,m[g+20]=(b+.5)*d*2-1,m[g+21]=(_+.5)*u*2-1,m[g+22]=b*d,m[g+23]=_*u,g+=h*p;r.vao&&r.vao.dispose(!0),r.vao=new lf(n,Mn,{geometry:KA},{geometry:In.createVertex(n,kn.STATIC_DRAW,m)})}}_gridComputeMipmap(e){const t=this._rctx,n=this._grid,r=t.bindTechnique(this._downsampleTechnique,this._passParameters,e);t.bindVAO(this._quadVAO);for(let s=0;s<n.mipmapLevels;s++){t.bindFramebuffer(n.coverageMipmap[s+1]);const a=n.coverageMipmap[s+1].width,o=n.coverageMipmap[s+1].height;this._downsampleDrawParameters.inputTexture=n.coverageMipmap[s].colorTexture,Bi(this._downsampleDrawParameters.invFramebufferDim,1/a,1/o),r.bindDraw(this._downsampleDrawParameters,e,this._passParameters),t.setViewport(0,0,a,o),t.drawArrays(Qi.TRIANGLE_STRIP,0,al(this._quadVAO,"geometry"))}}get gpuMemoryUsage(){let e=(T(this._blur0Fbo)?this._blur0Fbo.gpuMemoryUsage:0)+(T(this._blur1Fbo)?this._blur1Fbo.gpuMemoryUsage:0);if(this._grid.coverageMipmap)for(const t of this._grid.coverageMipmap)e+=t.gpuMemoryUsage;return e}get test(){return{coverage:this._grid.coverageMipmap,blur:[this._blur0Fbo,this._blur1Fbo]}}};const Z0t={dataType:un.UNSIGNED_BYTE,internalFormat:Ui.RGBA},Q0t={};let J0t=class{constructor(e){this._rctx=e,this._activeTargets=new Set,this._depthTextures=new Map,this._depthBuffers=new Map,this._colorTextures=new Map,this._framebuffers=new Map,this.depthTextureSupported=e.capabilities.depthTexture}dispose(){this._depthBuffers.forEach(e=>e.dispose()),this._depthBuffers.clear(),this._depthTextures.forEach(e=>e.dispose()),this._depthTextures.clear(),this._colorTextures.forEach(e=>e.dispose()),this._colorTextures.clear(),this._framebuffers.forEach(e=>e.dispose()),this._framebuffers.clear(),this._activeTargets.clear()}disposeTargetResource(e){const t=e.id;this._activeTargets.has(t)&&(this._activeTargets.delete(t),this._disposeWithFramebuffers(this._depthTextures,t),this._disposeWithFramebuffers(this._depthBuffers,t),this._disposeWithFramebuffers(this._colorTextures,t))}_disposeWithFramebuffers(e,t){const n=e.get(t);n&&(this._framebuffers.forEach((r,s)=>{r.colorAttachment!==n&&r.depthStencilAttachment!==n||(r.detachAll(),r.dispose(),this._framebuffers.delete(s))}),n.dispose(),e.delete(t))}getDepthTexture(e,t){if(!this.depthTextureSupported)return null;let n=this._depthTextures.get(e.id);return!n||n.descriptor.width===t.width&&n.descriptor.height===t.height||(n.dispose(),n=RN()),n||(n=new Er(this._rctx,{target:Wn.TEXTURE_2D,pixelFormat:Ui.DEPTH_STENCIL,dataType:un.UNSIGNED_INT_24_8,samplingMode:fn.NEAREST,wrapMode:An.CLAMP_TO_EDGE,width:t.width,height:t.height}),this._depthTextures.set(e.id,n),this._activeTargets.add(e.id)),n}getAllocatedDepthTexture(e){return this._depthTextures.get(e.id)}getDepthBuffer(e,t){if(this.depthTextureSupported)return null;let n=this._depthBuffers.get(e.id);return n?n.descriptor.width===t.width&&n.descriptor.height===t.height||n.resize(t.width,t.height):(n=new zbe(this._rctx,{internalFormat:$be.DEPTH_STENCIL,...t}),this._depthBuffers.set(e.id,n),this._activeTargets.add(e.id)),n}getColorTexture(e,t){let n=this._colorTextures.get(e.id);return n&&(n.descriptor.width===t.width&&n.descriptor.height===t.height||(n.dispose(),n=RN())),n||(n=new Er(this._rctx,{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,internalFormat:e.internalFormat,dataType:e.dataType,samplingMode:e.samplingMode!=null?e.samplingMode:fn.LINEAR,wrapMode:An.CLAMP_TO_EDGE,width:t.width,height:t.height}),this._colorTextures.set(e.id,n),this._activeTargets.add(e.id)),n}getAllocatedColorTexture(e){return this._colorTextures.get(e.id)}registerDepthTarget(e={}){return{id:tf(),...Q0t,...e}}registerColorTarget(e={}){return{id:tf(),...Z0t,...e}}getFramebuffer(e,t,n){const r=this._getKey(t,n);let s=this._framebuffers.get(r);const a=this.getColorTexture(t,e);if(this.depthTextureSupported){const l=n?this.getDepthTexture(n,e):void 0;return s?((s.width!==e.width||s.height!==e.height||s.colorTexture!==a||s.depthStencilTexture!==l)&&(s.detachAll(),s.resize(e.width,e.height),s.attachColorTexture(a),s.attachDepthStencilTexture(l)),s):(s=T(n)?new ma(this._rctx,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.DEPTH_STENCIL_TEXTURE},a,l):new ma(this._rctx,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},a),this._framebuffers.set(r,s),s)}const o=n?this.getDepthBuffer(n,e):void 0;return s?((s.width!==e.width||s.height!==e.height||s.colorTexture!==a)&&(s.detachAll(),s.resize(e.width,e.height),s.attachColorTexture(a),s.attachDepthStencilBuffer(o)),s):(s=new ma(this._rctx,{colorTarget:ka.TEXTURE,depthStencilTarget:n?Ja.DEPTH_STENCIL_RENDER_BUFFER:Ja.NONE},a,o),this._framebuffers.set(r,s),s)}_getKey(e,t){return`${e.id}_${t?t.id:"X"}_${e.name}${t?"_"+t.name:""}`}get gpuMemoryUsage(){let e=0;const t=new Set,n=r=>{t.has(r)||(t.add(r),e+=YI(r))};return this._depthTextures.forEach(n),this._colorTextures.forEach(n),this._depthBuffers.forEach(n),e}},ebt=class{constructor(e,t){this._rctx=e,this._compositingHelper=t,this._mainColorTarget=0,this._dimensions={width:4,height:4},this._background={type:"color",color:[0,0,0,1]};const n=e.type===La.WEBGL2;this._renderTargetHelper=new J0t(e);const r=this._renderTargetHelper;this._mainColorTargets=[r.registerColorTarget({name:"mainColorTarget0"}),r.registerColorTarget({name:"mainColorTarget1"})],this.frontFaceTarget=r.registerColorTarget({name:"frontFaceTarget"});const s=a=>r.registerColorTarget({name:a,dataType:un.FLOAT,internalFormat:n?sR.RGBA32F:Ui.RGBA,samplingMode:fn.NEAREST});this.colorFloatTarget=s("colorFloatTarget"),this.alphaFloatTarget=s("alphaFloatTarget"),this.mainDepth=r.registerDepthTarget({name:"mainDepth"}),this.linearDepth=r.registerColorTarget({name:"linearDepth",samplingMode:fn.NEAREST}),this.terrainLinearDepth=r.registerColorTarget({name:"terrainLinearDepth"}),this.geometryLinearDepth=r.registerColorTarget({name:"geometryLinearDepth"}),this.normal=r.registerColorTarget({name:"normal"}),this.highlight=r.registerColorTarget({name:"highlight",internalFormat:n?sR.RGBA4:Ui.RGBA,dataType:un.UNSIGNED_SHORT_4_4_4_4}),this.hudVisibility=r.registerColorTarget({name:"hudVisibility",internalFormat:n?sR.RGBA4:Ui.RGBA,dataType:un.UNSIGNED_SHORT_4_4_4_4}),this.tmpColor=r.registerColorTarget({name:"tmpColor"}),this.tmpDepth=r.registerDepthTarget({name:"tmpDepth"}),this.hudColor=r.registerColorTarget({name:"hudColor"})}dispose(){this._renderTargetHelper.dispose()}get width(){return this._dimensions.width}get height(){return this._dimensions.height}set background(e){this._background=e}get background(){return this._background}get currentColorTarget(){return this._mainColorTargets[this._mainColorTarget]}get previousColorTarget(){return this._mainColorTargets[1-this._mainColorTarget]}get framebuffer(){return this.getFramebuffer(this.currentColorTarget,this.mainDepth)}getFramebuffer(e,t){return this._renderTargetHelper.getFramebuffer(this._dimensions,e,t)}get colorTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.currentColorTarget)}get depthTexture(){return this._renderTargetHelper.getAllocatedDepthTexture(this.mainDepth)}get linearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.linearDepth)}get terrainLinearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.terrainLinearDepth)}get geometryLinearDepthTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.geometryLinearDepth)}get lastFrameColorTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.previousColorTarget)}get normalTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.normal)}get highlightTexture(){return this._renderTargetHelper.getAllocatedColorTexture(this.highlight)}get hudVisibilityTexture(){return this._getColorTexture(this.hudVisibility)}get tmpColorTexture(){return this._getColorTexture(this.tmpColor)}get hudColorTexture(){return this._getColorTexture(this.hudColor)}get mainColorTexture(){return this._getColorTexture(this.currentColorTarget)}setupRenderTarget(e){e||(this._mainColorTarget=0,this.disposeTarget(this._mainColorTargets[1])),this._mainColorTarget=this._mainColorTarget===0&&e?1:0}initializeFrame(e){const t=this._rctx;this._dimensions.width=e.fullWidth,this._dimensions.height=e.fullHeight,this.bindTarget(this.currentColorTarget,this.mainDepth),t.setClearStencil(0);const n=this._background.color;t.setClearColor(n[0]*n[3],n[1]*n[3],n[2]*n[3],n[3]),t.clearSafe(hr.COLOR_BUFFER_BIT|hr.DEPTH_BUFFER_BIT|hr.STENCIL_BUFFER_BIT)}composite(e){T(this.colorTexture)&&this._compositingHelper.composite(e,this.colorTexture,Ro.None)}renderTmpAndCompositeToMain(e,t,n,r=!1){this.renderToTargets(e,this.tmpColor,r?this.tmpDepth:this.mainDepth,tbt),this._compositingHelper.composite(t,this._getColorTexture(this.tmpColor),n)}renderHUDVisibility(e,t=!1){this.renderToTargets(e,this.hudVisibility,t?this.tmpDepth:this.mainDepth,ibt)}compositeTransparentTerrainOntoHUDVisibility(e){this.renderToTargets(()=>this._compositingHelper.compositeHUD(e,this._getColorTexture(this.tmpColor)),this.hudVisibility,this.tmpDepth)}renderOITPass(e,t,n){let r,s;switch(t){case ln.Color:r=this.colorFloatTarget,s=[0,0,0,0];break;case ln.Alpha:r=this.alphaFloatTarget,s=[1,1,1,1];break;case ln.FrontFace:r=this.frontFaceTarget,s=[0,0,0,0]}n?this.renderToTargets(e,r,this.tmpDepth,s,!0,!0):this.renderToTargets(e,r,this.mainDepth,s,!1)}compositeTransparentTerrainOntoMain(e){this.bindFramebuffer(),this._compositingHelper.composite(e,this._getColorTexture(this.tmpColor),Ro.PremultipliedAlpha)}compositeOccludedOntoMain(e,t){this.bindFramebuffer(),this._compositingHelper.composite(e,this._getColorTexture(this.tmpColor),Ro.PremultipliedAlpha,t)}compositeTransparentOntoOpaque(e,t){t?(this.bindTarget(this.hudColor,this.tmpDepth),this._rctx.setClearColor(0,0,0,1e-13),this._rctx.clearSafe(hr.COLOR_BUFFER_BIT)):this.bindFramebuffer(),this._compositingHelper.compositeOIT(e,this._getColorTexture(this.colorFloatTarget),this._getColorTexture(this.alphaFloatTarget),this._getColorTexture(this.frontFaceTarget))}bindFramebuffer(){this._rctx.bindFramebuffer(this.framebuffer)}renderDepthDetached(e){this.bindTarget(this.currentColorTarget),e(),this.bindTarget(this.currentColorTarget,this.mainDepth)}disposeTarget(e){this._renderTargetHelper.disposeTargetResource(e)}renderToFBO(e,t,n=!1,r=!1){const s=this._rctx;let a=0;if(t){const l=Math.max(1e-13,t[3]);s.setClearColor(t[0],t[1],t[2],l),a|=hr.COLOR_BUFFER_BIT}n&&(a|=hr.DEPTH_BUFFER_BIT),r===!1?r=0:(r===!0&&(r=255),a|=hr.STENCIL_BUFFER_BIT),a&&s.clearSafe(a,r),e(),s.gl.flush(),this.bindTarget(this.currentColorTarget,this.mainDepth)}renderToTargets(e,t,n,r,s=!1,a=!1){const o=this.bindTarget(t,n);return this.renderToFBO(e,r,s,a),o}bindTarget(e,t){const n=this._renderTargetHelper.getFramebuffer(this._dimensions,e,t);return this._rctx.bindFramebuffer(n),n}_getColorTexture(e){return this._renderTargetHelper.getColorTexture(e,this._dimensions)}get gpuMemoryUsage(){let e=0;return this._renderTargetHelper&&(e+=this._renderTargetHelper.gpuMemoryUsage),e}};const tbt=[0,0,0,0],ibt=[0,1,0,1];let nbt=class{constructor(e){this._context=e,this._renderPlugins=new pn,this._slots=[];for(let t=0;t<at.MAX_SLOTS;++t)this._slots[t]=[]}add(e,t,n){const r=()=>{if(n!=null&&n.aborted)throw t.uninitializeRenderContext(),js();this._renderPlugins.push(t);for(const a of e)this._slots[a].push(t);this._context.requestRender()},s=t.initializeRenderContext(this._context,n);if(BA(s))return s.then(r);r()}remove(e){if(this._renderPlugins.removeUnordered(e)!=null){for(let t=0;t<this._slots.length;++t)this._slots[t]=this._slots[t].filter(n=>n!==e);e.uninitializeRenderContext(),this._context.requestRender()}}prepareRender(){this._renderPlugins.forAll(e=>{e.prepareRender&&e.prepareRender(this._context.renderContext)})}updateAnimation(e){let t=!1;return this._renderPlugins.forAll(n=>{n.updateAnimation&&(t=n.updateAnimation(e)||t)}),t}render(){const e=this._slots[this._context.renderContext.bindParameters.slot],t=new Array;e.filter(n=>{if(!n.canRender)return!1;if(rbt(n)){const r=n.prepareTechnique(this._context.renderContext);return!!r&&(t.push(r),!0)}return t.push(null),!0}).forEach((n,r)=>n.render(this._context.renderContext,t[r]))}queryDepthRange(e){const t=sbt;return t.near=1/0,t.far=-1/0,this._renderPlugins.forAll(n=>{if(n.queryDepthRange){const r=n.queryDepthRange(e);r&&CC(t,r,t)}}),t}get needsTransparentPass(){return this._renderPlugins.some(e=>e.needsTransparentPass)}get needsHighlight(){return this._renderPlugins.some(e=>e.needsHighlight)}get needsLinearDepth(){return this._renderPlugins.some(e=>e.needsLinearDepth)}get needsLaserlineWithContrastControl(){const e=this._slots[at.LASERLINES_CONTRAST_CONTROL];return!!e&&e.length>0}get renderOccludedFlags(){return this._renderPlugins.reduce((e,t)=>e|t.renderOccludedFlags,0)}};function rbt(i){return"prepareTechnique"in i}const sbt={near:0,far:0};let Yme=class extends Cne{};const RD=255,abt=1/RD;function obt(i){const e=new Nr,t=e.fragment;return t.include(Tb),t.include(eb),e.include(dz),e.include(dg),e.include(xne,i),t.uniforms.add([new sn("depthMap",n=>n.linearDepthTexture),new pl("inverseViewMatrix",(n,r)=>Da(gee,of(gee,r.camera.viewMatrix,r.camera.center))),new hl("nearFar",(n,r)=>r.camera.nearFar)]),t.constants.add("sampleValue","float",abt),t.code.add(ee`void main(void) {
float depth = rgba2float(texture2D(depthMap, uv));
if (depth == 0.0) {
discard;
}
float currentPixelDepth = linearDepthFromFloat(depth, nearFar);
if (-currentPixelDepth > nearFar.y || -currentPixelDepth < nearFar.x) {
discard;
}
vec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);
vec4 worldSpacePos = inverseViewMatrix * currentPixelPos;
mat4 shadowMatrix;
float linearDepth = -currentPixelDepth;
int i = chooseCascade(linearDepth, shadowMatrix);
if (i >= numCascades) {
discard;
}
vec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);
if (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {
discard;
}
vec2 uvShadow = cascadeCoordinates(i, lvpos);
float depthShadow = readShadowMapDepth(uvShadow, shadowMapTex);
bool shadow = depthShadow < lvpos.z;
if (!shadow) {
discard;
}
gl_FragColor = vec4(sampleValue);
}`),e}const gee=St(),lbt=Object.freeze(Object.defineProperty({__proto__:null,ShadowCastAccumulatePassParameters:Yme,shadowCastMaxSamples:RD,build:obt},Symbol.toStringTag,{value:"Module"}));var vb;(function(i){i[i.Gradient=0]="Gradient",i[i.Threshold=1]="Threshold",i[i.COUNT=2]="COUNT"})(vb||(vb={}));let b8=class extends ic{constructor(){super(...arguments),this.visualization=vb.Gradient,this.bandsEnabled=!1}};f([Pe({count:vb.COUNT})],b8.prototype,"visualization",void 0),f([Pe()],b8.prototype,"bandsEnabled",void 0);function cbt(i){const e=new Nr,t=e.fragment;t.include(Tb),t.include(eb),e.include(dz),e.include(dg);const{visualization:n,bandsEnabled:r}=i;t.constants.add("inverseSampleValue","float",RD),t.uniforms.add([new sn("shadowCastMap",o=>o.shadowCastMap),new Hi("sampleScale",o=>o.sampleScale),new Hi("opacityFromElevation",o=>o.opacityFromElevation),new jp("uColor",o=>o.color)]);const s=n===vb.Gradient,a=n===vb.Threshold;return s&&r?t.uniforms.add(new Hi("bandSize",o=>o.bandSize)):a&&t.uniforms.add(new Hi("threshold",o=>o.threshold)),t.code.add(ee`
      void main(void) {
        vec4 record = texture2D(shadowCastMap, uv);
        float pixelSamples = record.r * inverseSampleValue;
        if (pixelSamples < 1.0) {
          discard;
        }

        float strength = pixelSamples * sampleScale;

        ${a?ee`
            if (strength <= threshold) {
              discard;
            }`:""}

        ${s&&r?ee`strength = ceil(strength / bandSize) * bandSize;`:""}

        gl_FragColor = vec4(uColor.xyz, uColor.a * opacityFromElevation ${s?ee`* strength`:""});
      }
    `),e}const ubt=Object.freeze(Object.defineProperty({__proto__:null,build:cbt},Symbol.toStringTag,{value:"Module"}));let SH=class extends _n{constructor(e,t){super(e,t,()=>this.destroy())}initializeProgram(e){return new gn(e.rctx,SH.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:xd,colorWrite:$i,depthTest:null,depthWrite:null})}get primitiveType(){return Qi.TRIANGLE_STRIP}};SH.shader=new bn(ubt,()=>Ee(()=>import("./ShadowCastVisualize.glsl-53af215b.js"),["./ShadowCastVisualize.glsl-53af215b.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./Texture2DPassUniform-6e8ae673.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const dbt=Xn(.01,0,.25,1),hbt=4e4,pbt=5e4,Xme=1/512;let bI=class extends et{constructor(e,t,n,r){super({}),this._techniqueRepository=e,this._rctx=t,this._shadowAccumulator=n,this._requestRender=r,this._passParameters={shadowCastMap:this._shadowCastTexture,sampleScale:0,color:dbt,threshold:.5,bandSize:.1,opacityFromElevation:1,__tagStrict:"NoParameters"},this._techniqueConfig=new b8,this._enabled=!1,this._vao=tc(t),this._techniqueConfig.visualization=vb.Gradient}normalizeCtorArgs(){return{}}dispose(){this._stop(),this._vao=Ht(this._vao),this._techniqueRepository.release(this._technique),this._technique=null,this._shadowAccumulator=null}get _visualizeShadowCastTechnique(){return this._technique=this._techniqueRepository.releaseAndAcquire(SH,this._techniqueConfig,this._technique),this._technique}render(e){if(!this._isRenderingVisualization)return;this._passParameters.sampleScale=1/this._computedSamples;const t=this._visualizeShadowCastTechnique;this._rctx.bindVAO(this._vao),this._rctx.bindTechnique(t,this._passParameters,e),this._rctx.drawArrays(t.primitiveType,0,al(this._vao,"geometry"))}setOptions(e){e.enabled!==void 0&&this._setEnabled(e.enabled),e.color!==void 0&&this._setColor(e.color),e.threshold!==void 0&&(this._threshold=e.threshold),e.visualization!==void 0&&(this._visualization=e.visualization),e.bandSize!==void 0&&(this._bandSize=e.bandSize),e.bandsEnabled!==void 0&&(this._bandsEnabled=e.bandsEnabled)}get opacityFromElevation(){return this._passParameters.opacityFromElevation}set opacityFromElevation(e){this._passParameters.opacityFromElevation!==e&&(this._passParameters.opacityFromElevation=e,this.notifyChange("opacityFromElevation"))}get _isRenderingVisualization(){return this._enabled&&this._computedSamples>0&&this.opacityFromElevation>Xme}get _computedSamples(){return this._shadowAccumulator.computedSamples}get _shadowCastTexture(){return this._shadowAccumulator.shadowCastTexture}get _threshold(){return this._passParameters.threshold}set _threshold(e){this._threshold!==e&&(this._passParameters.threshold=e,this._requestRenderIfRunning())}get _visualization(){return this._techniqueConfig.visualization}set _visualization(e){e!==this._visualization&&(this._techniqueConfig.visualization=e,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}get _bandSize(){return this._passParameters.bandSize}set _bandSize(e){e!==this._bandSize&&(this._passParameters.bandSize=e,this._requestRenderIfRunning())}get _bandsEnabled(){return this._techniqueConfig.bandsEnabled}set _bandsEnabled(e){e!==this._bandsEnabled&&(this._techniqueConfig.bandsEnabled=e,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}_setColor(e){const t=this._passParameters.color;XN(e,t)||(Em(this._passParameters.color,e),this._requestRenderIfRunning())}_setEnabled(e){e!==this._enabled&&(e?this._start():this._stop())}_requestRenderIfRunning(){this._enabled&&this._requestRender()}_start(){this._enabled=!0,this._requestRender()}_stop(){this._enabled=!1,this._requestRender()}};f([y()],bI.prototype,"opacityFromElevation",null),bI=f([ge("esri.views.3d.webgl-engine.lib.ShadowCastRenderer")],bI);let _L=class extends ic{constructor(){super(...arguments),this.receiveShadows=!0,this.hasWebGL2Context=!1}};f([Pe()],_L.prototype,"receiveShadows",void 0),f([Pe()],_L.prototype,"hasWebGL2Context",void 0);let EH=class extends _n{constructor(e){super(e,new _L,()=>this.destroy())}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,EH.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:Na(vt.ONE,vt.ONE,vt.ONE,vt.ONE),colorWrite:$i,depthTest:null,depthWrite:null})}get primitiveType(){return Qi.TRIANGLE_STRIP}};EH.shader=new bn(lbt,()=>Ee(()=>import("./ShadowCastAccumulate.glsl-9c1e9976.js"),["./ShadowCastAccumulate.glsl-9c1e9976.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));var BS;let yo=BS=class extends et{constructor(i,e,t,n,r,s){super({}),this._rctx=i,this._stage=t,this._prepareForShadowMapPass=n,this._renderToShadowMap=r,this._requestRender=s,this._progress=0,this._sampleCount=0,this._passParameters=new Yme,this._enabledInternal=!1,this._cachedLightDirections=[],this._depthRange=m8,this._previewingCached=!1,this._handles=new mi,this._cameraForcedForScreenshot=!1,this._bindParameters=new nD(new R7(i,t.viewingMode),null,null),this._bindParameters.shadowMap.enabled=!0,this._bindParameters.camera=new Nn,this._vao=tc(i);const a={colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE,width:0,height:0},o={target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.LINEAR,wrapMode:An.CLAMP_TO_EDGE,width:0,height:0};this._fbo=new ma(i,a,o),this._accumulationRenderer=new bI(e,i,this,s);const l=this._stage.resourceController.scheduler;this._handles.add(l.registerTask($r.SHADOW_ACCUMULATOR,this)),this._handles.add(ue(()=>t.renderView,c=>{this._handles.remove(BS.renderViewHandleKey),B(c)||this._handles.add(c.events.on("force-camera-for-screenshot",()=>this._cameraForcedForScreenshot=!0),BS.renderViewHandleKey)},hn))}normalizeCtorArgs(){return{}}get computedSamples(){return this._progress}get shadowCastTexture(){return this._fbo.colorTexture}get isAccumulating(){return this._isPreviewing||this._isRefining}get _accumulationTechnique(){if(B(this._accumulationTechniqueCached)){const i={rctx:this._rctx,viewingMode:this._stage.viewingMode};this._accumulationTechniqueCached=new EH(i)}return this._accumulationTechniqueCached}get _isRefining(){return this._isActive&&!this._isDoneAccumulating&&!this._previewingCached}get _isPreviewing(){return this._isActive&&this._previewingCached}get _isActive(){return this._enabledInternal&&this._sampleCount>0}get canAccumulate(){return this._passParameters.linearDepthTexture!==null&&this._depthRange!==m8&&this._opacityFromElevation>Xme}get _isDoneAccumulating(){return this._progress>=this._sampleCount}get _lightDirectionsInternal(){return this._cachedLightDirections}set _lightDirectionsInternal(i){const e=this._cachedLightDirections;if(K0(e,i,af))return;const t=i.length;e.length=t,this._sampleCount=Math.min(RD,t);for(let n=0;n<t;++n){const r=i[n],s=e[n]||q();Ge(s,r),e[n]=s}this._invalidate()}get _opacityFromElevation(){return this._accumulationRenderer.opacityFromElevation}set _opacityFromElevation(i){this._accumulationRenderer.opacityFromElevation=i}get running(){return this._isRefining&&this.canAccumulate&&this._progress>0}runTask(i){for(this._prepareForShadowMapPass(this._bindParameters);!i.done&&!this._isDoneAccumulating;)this._accumulateShadow(),i.madeProgress();this._requestRender()}renderAccumulation(i,e,t,n){if(this._passParameters.linearDepthTexture=i,this._depthRange=e,this._updateCamera(t),this._bindParameters.contentCamera=n,this.notifyChange("canAccumulate"),!this.isAccumulating||!this.canAccumulate)return;(this._previewingCached||this._progress===0||this._cameraForcedForScreenshot)&&this._clear();const r=this._cameraForcedForScreenshot?this._sampleCount:Math.min(BS.previewSamples,this._sampleCount-this._progress);for(let s=0;s<r;++s)this._accumulateShadow();this._cameraForcedForScreenshot=!1}render(i){this._accumulationRenderer.render(i)}dispose(){this._stop(),this._handles.destroy(),this._accumulationRenderer=Ht(this._accumulationRenderer),this._bindParameters.shadowMap.dispose(),this._fbo=Ht(this._fbo),this._vao=Ht(this._vao),this._accumulationTechniqueCached=Lr(this._accumulationTechniqueCached),this._cachedLightDirections.length=0,this._sampleCount=0}setOptions(i){i.enabled!==void 0&&(this._enabled=i.enabled),i.previewing!==void 0&&(this._previewing=i.previewing),i.lightDirections!==void 0&&(this._lightDirections=i.lightDirections),this._accumulationRenderer.setOptions(i)}set _previewing(i){this._previewingCached!==i&&(this._previewingCached=i,this._requestRenderIfEnabled())}set _lightDirections(i){this._lightDirectionsInternal=i}readAccumulatedShadow(i,e){if(!this._isActive||this._progress<1||i<0||i>this._fbo.width||e<0||e>this._fbo.height)return 0;const t=fbt;return this._fbo.readPixels(i,e,1,1,Ui.RGBA,un.UNSIGNED_BYTE,t),t[0]/this._progress}_start(){this._progress=0,this._enabledInternal=!0}_stop(){this._enabledInternal=!1}_invalidate(){this._progress=0,this._requestRenderIfEnabled()}_clear(){this._rctx.bindFramebuffer(this._fbo),this._rctx.setClearColor(0,0,0,0),this._rctx.clearSafe(hr.COLOR_BUFFER_BIT),this._progress=0}_accumulateShadow(){const i=this._lightDirectionsInternal[this._progress];this._renderToShadowMap(this._bindParameters,i,this._depthRange),this._passParameters.origin=this._bindParameters.camera.center,this._rctx.bindFramebuffer(this._fbo);const e=this._accumulationTechnique;this._rctx.bindTechnique(e,this._passParameters,this._bindParameters),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(e.primitiveType,0,al(this._vao,"geometry")),this._progress++}_updateCamera(i){i.equals(this._bindParameters.camera)||(this._bindParameters.camera.copyFrom(i),this._fbo.resize(i.fullWidth,i.fullHeight),this._opacityFromElevation=1-Nx(hbt,pbt,i.relativeElevation))}set _enabled(i){i!==this._enabledInternal&&(i?this._start():this._stop())}_requestRenderIfEnabled(){this._enabledInternal&&this._requestRender()}get test(){const i=this;return{lightDirections:this._lightDirectionsInternal,get isDone(){return i._isDoneAccumulating},get isActive(){return i._isActive}}}};yo.previewSamples=6,yo.renderViewHandleKey="renderView",f([y()],yo.prototype,"_progress",void 0),f([y()],yo.prototype,"_sampleCount",void 0),f([y()],yo.prototype,"_enabledInternal",void 0),f([y()],yo.prototype,"_depthRange",void 0),f([y()],yo.prototype,"_previewingCached",void 0),f([y()],yo.prototype,"_accumulationRenderer",void 0),f([y()],yo.prototype,"_isRefining",null),f([y()],yo.prototype,"_isActive",null),f([y()],yo.prototype,"canAccumulate",null),f([y()],yo.prototype,"_isDoneAccumulating",null),f([y()],yo.prototype,"_opacityFromElevation",null),f([y()],yo.prototype,"running",null),yo=BS=f([ge("esri.views.3d.webgl-engine.lib.ShadowAccumulator")],yo);const fbt=new Uint8Array(4),vee={highlightedThreshold:.99999,selfShadowThreshold:.025};function mbt(i){const e=new Nr;e.include(wne,i);const t=e.fragment;return t.include(Tb),t.include(eb),e.include(dz),e.include(dg),t.uniforms.add([new sn("defaultDepthTex",(n,r)=>r.shadowMap.getSnapshot(bC.Default)),new sn("highlightDepthTex",(n,r)=>r.shadowMap.getSnapshot(bC.Highlight)),new sn("depthMap",(n,r)=>r.linearDepthTexture),new sn("highlightMap",(n,r)=>r.highlightColorTexture),new jp("uColor",n=>n.shadowColor),new hl("nearFar",(n,r)=>r.camera.nearFar),new Hi("opacity",n=>n.shadowOpacity),new Hi("occludedOpacity",n=>n.occludedShadowOpacity),new Hi("terminationFactor",n=>n.opacityElevation*n.dayNightTerminator),new Io("lightingMainDirectionView",(n,r)=>mt(_ee,$t(_ee,r.lighting.mainLight.direction,r.camera.viewInverseTransposeMatrix))),new hl("texelSize",(n,r)=>T(r.linearDepthTexture)?Bi(gbt,1/r.linearDepthTexture.descriptor.width,1/r.linearDepthTexture.descriptor.height):Z0),new pl("inverseViewMatrix",(n,r)=>Da(yee,of(yee,r.camera.viewMatrix,r.camera.center)))]),t.constants.add("unoccludedHighlightFlag","vec4",jwe).add("highlightedThreshold","float",vee.highlightedThreshold).add("selfShadowThreshold","float",vee.selfShadowThreshold),t.code.add(ee`vec3 normalFromDepth(vec3 pixelPos, vec2 fragCoord, vec2 uv, vec2 texelSize, sampler2D depthMap, vec2 nearFar) {
float leftPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(-1.0, 0.0) * texelSize, nearFar);
float rightPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(1.0, 0.0) * texelSize, nearFar);
float bottomPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, -1.0) * texelSize, nearFar);
float topPixelDepth = linearDepthFromTexture(depthMap, uv + vec2(0.0, 1.0) * texelSize, nearFar);
bool pickLeft = abs(pixelPos.z - leftPixelDepth) < abs(pixelPos.z - rightPixelDepth);
bool pickBottom = abs(pixelPos.z - bottomPixelDepth) < abs(pixelPos.z - topPixelDepth);
vec3 fragCoordHorizontal = pickLeft
? vec3(fragCoord + vec2(-1.0, 0.0), leftPixelDepth)
: vec3(fragCoord + vec2(1.0, 0.0), rightPixelDepth);
vec3 fragCoordVertical = pickBottom
? vec3(fragCoord + vec2(0.0, -1.0), bottomPixelDepth)
: vec3(fragCoord + vec2(0.0, 1.0), topPixelDepth);
vec3 verticalPixelPos = reconstructPosition(fragCoordHorizontal.xy, fragCoordHorizontal.z);
vec3 horizontalPixelPos = reconstructPosition(fragCoordVertical.xy, fragCoordVertical.z);
vec3 normal = normalize(cross(verticalPixelPos - pixelPos, horizontalPixelPos - pixelPos));
return pickLeft == pickBottom ? normal : -normal;
}`),t.code.add(ee`void main(void) {
vec4 highlightInfo = texture2D(highlightMap, uv);
float visiblyHighlighted = (1.0 - clamp(distance(unoccludedHighlightFlag, highlightInfo), 0.0, 1.0)) * highlightInfo.a;
if (visiblyHighlighted > highlightedThreshold) {
discard;
}
float depth = rgba2float(texture2D(depthMap, uv));
if (depth == 0.0) {
discard;
}
float currentPixelDepth = linearDepthFromFloat(depth, nearFar);
if (-currentPixelDepth>nearFar.y || -currentPixelDepth<nearFar.x) {
discard;
}
vec4 currentPixelPos = vec4(reconstructPosition(gl_FragCoord.xy, currentPixelDepth), 1.0);
vec4 worldSpacePos = inverseViewMatrix * currentPixelPos;
mat4 shadowMatrix;
float linearDepth = -currentPixelDepth;
int i = chooseCascade(linearDepth, shadowMatrix);
if (i >= numCascades) {
discard;
}
vec3 lvpos = lightSpacePosition(worldSpacePos.xyz, shadowMatrix);
if (lvpos.z >= 1.0 || lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) {
discard;
}
vec2 uvShadow = cascadeCoordinates(i, lvpos);
float depthHighlight = readShadowMapDepth(uvShadow, highlightDepthTex);
bool shadowHighlight = depthHighlight < lvpos.z;
if (!shadowHighlight) {
discard;
}
float depthDefault = readShadowMapDepth(uvShadow, defaultDepthTex);
bool shadowDefault = depthDefault < lvpos.z;
vec3 normal = normalFromDepth(currentPixelPos.xyz, gl_FragCoord.xy, uv, texelSize, depthMap, nearFar);
bool shaded = dot(normal, lightingMainDirectionView) < selfShadowThreshold;
float fragOpacity = (shadowDefault || shaded) ? occludedOpacity : opacity;
gl_FragColor = vec4(uColor.rgb, uColor.a * fragOpacity * terminationFactor);
}`),e}const yee=St(),_ee=q(),gbt=xt(),vbt=Object.freeze(Object.defineProperty({__proto__:null,build:mbt},Symbol.toStringTag,{value:"Module"}));let ybt=class extends Es{constructor(){super(...arguments),this.shadowColor=Xn(1,0,1,1),this.shadowOpacity=.2,this.occludedShadowOpacity=.1,this.opacityElevation=1,this.dayNightTerminator=1}},AH=class extends _n{constructor(e){super(e,new _L,()=>this.destroy())}initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,AH.shader.get().build(this.configuration),Mn)}initializePipeline(){return yi({blending:Na(vt.SRC_ALPHA,vt.ONE,vt.ONE_MINUS_SRC_ALPHA,vt.ONE_MINUS_SRC_ALPHA),colorWrite:$i,depthTest:null,depthWrite:null})}get primitiveType(){return Qi.TRIANGLE_STRIP}};AH.shader=new bn(vbt,()=>Ee(()=>import("./ShadowHighlight.glsl-88c430f7.js"),["./ShadowHighlight.glsl-88c430f7.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f64-1e28eae0.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./vec3-a020a6f6.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./vec4f64-e407da96.js","./Texture2DPassUniform-6e8ae673.js","./vec4-790471c0.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const _bt=.001953125,bbt=4e4,wbt=5e4;let xbt=class{constructor(e,t){this._rctx=e,this._viewingMode=t,this._maxOpacity=1,this._passParameters=new ybt,this._drawParameters=new Cne,this._vao=tc(this._rctx)}get _technique(){return B(this._techniqueCached)&&(this._techniqueCached=new AH({rctx:this._rctx,viewingMode:this._viewingMode})),this._techniqueCached}render(e,t){if(!e.shadowMap.enabled||!e.linearDepthTexture||!this.isVisible)return;const n=this._technique;this._drawParameters.origin=e.camera.center,this._rctx.bindFramebuffer(t),this._rctx.bindTechnique(n,this._passParameters,e).bindDraw(this._drawParameters,e,this._passParameters),this._rctx.bindVAO(this._vao),this._rctx.drawArrays(n.primitiveType,0,al(this._vao,"geometry"))}get gpuMemoryUsage(){var e;return((e=this._vao)==null?void 0:e.size)??0}setDefaultOptions(e){this._passParameters={...this._passParameters,...e},this._updateMaxOpacity()}updateParameters(e,t){this._passParameters.opacityElevation=1-Nx(bbt,wbt,e.relativeElevation);const n=this._viewingMode===Ot.Global?mt(bee,e.center):je(bee,0,0,1),r=dt(n,t);this._passParameters.dayNightTerminator=Nx(0,1,lt(30*r,0,1))}dispose(){this._vao=Ht(this._vao),this._techniqueCached=Lr(this._techniqueCached)}get isVisible(){const{opacityElevation:e,dayNightTerminator:t}=this._passParameters;return this._maxOpacity*e*t>=_bt}_updateMaxOpacity(){const e=Math.max(this._passParameters.shadowOpacity,this._passParameters.occludedShadowOpacity);this._maxOpacity=e*this._passParameters.shadowColor[3]}};const bee=q(),wee=wg();let Cbt=class{constructor(){this._plane=wg()}get isEnabled(){return!che(this.plane,wee)}get plane(){return this._plane}set plane(e){$b(e||wee,this._plane)}},Tbt=class extends Es{};function LA(i){i.uniforms.add(new jp("resolution",e=>dl(Sbt,1/e.colorTexture.descriptor.width,1/e.colorTexture.descriptor.height,e.colorTexture.descriptor.width,e.colorTexture.descriptor.height)))}const Sbt=Dn(),V1={maxSearchSteps:8,maxDistanceAreaTex:16};function Ebt(){const i=new Nr,{attributes:e,varyings:t,vertex:n,fragment:r}=i;return e.add(j.POSITION,"vec2"),t.add("fTexCoord","vec2"),t.add("fOffset[3]","vec4"),t.add("fPixCoord","vec2"),LA(n),n.code.add(ee`
      void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
        fPixCoord = texcoord * resolution.zw;
        fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );
        fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );
        fOffset[2] = vec4( fOffset[0].xz, fOffset[1].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( ${ee.int(V1.maxSearchSteps)} );
      }

      void main() {
        fTexCoord = (position + 1.0 ) * 0.5;
        gl_Position = vec4(position, 0, 1);
        SMAABlendingWeightCalculationVS( fTexCoord );
      }
    `),r.uniforms.add(new sn("tEdges",s=>s.edges.colorTexture)),r.uniforms.add(new sn("tArea",s=>s.areaTexture)),r.uniforms.add(new sn("tSearch",s=>s.searchTexture)),r.uniforms.add(new sn("tColor",s=>s.colorTexture)),LA(r),r.code.add(ee`
      #define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
      #define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )

      vec4 SMAASampleLevelZeroOffset(sampler2D texture, vec2 coord, vec2 offset) {
        return texture2D(texture, coord + offset.x * resolution.xy, 0.0);
      }

      vec2 round( vec2 x ) {
        return sign( x ) * floor( abs( x ) + 0.5 );
      }

      float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
        e.r = bias + e.r * scale;
        return 255.0 * texture2D( searchTex, e, 0.0 ).r;
      }

      float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 0.0, 1.0 );
        for ( int i = 0; i < ${ee.int(V1.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord -= vec2( 2.0, 0.0 ) * resolution.xy;
          if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
        }
        texcoord.x += 0.25 * resolution.x;
        texcoord.x += resolution.x;
        texcoord.x += 2.0 * resolution.x;
        texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);
        return texcoord.x;
      }

      float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 0.0, 1.0 );
        for ( int i = 0; i < ${ee.int(V1.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord += vec2( 2.0, 0.0 ) * resolution.xy;
          if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
        }
        texcoord.x -= 0.25 * resolution.x;
        texcoord.x -= resolution.x;
        texcoord.x -= 2.0 * resolution.x;
        texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );
        return texcoord.x;
      }

      float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 1.0, 0.0 );
        for ( int i = 0; i < ${ee.int(V1.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord += vec2( 0.0, 2.0 ) * resolution.xy;
          if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
        }
        texcoord.y -= 0.25 * resolution.y;
        texcoord.y -= resolution.y;
        texcoord.y -= 2.0 * resolution.y;
        texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );
        return texcoord.y;
      }

      float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
        vec2 e = vec2( 1.0, 0.0 );
        for ( int i = 0; i < ${ee.int(V1.maxSearchSteps)}; i ++ ) {
          e = texture2D( edgesTex, texcoord, 0.0 ).rg;
          texcoord -= vec2( 0.0, 2.0 ) * resolution.xy;
          if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
        }
        texcoord.y += 0.25 * resolution.y;
        texcoord.y += resolution.y;
        texcoord.y += 2.0 * resolution.y;
        texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );
        return texcoord.y;
      }

      vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
        vec2 texcoord = float( ${ee.int(V1.maxDistanceAreaTex)} ) * round( 4.0 * vec2( e1, e2 ) ) + dist;
        texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );
        texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;
        return texture2D( areaTex, texcoord, 0.0 ).rg;
      }

      vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
        vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );
        vec2 e = texture2D( edgesTex, texcoord ).rg;
        if ( e.g > 0.0 ) {
          vec2 d;
          vec2 coords;
          coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
          coords.y = offset[ 1 ].y;
          d.x = coords.x;
          float e1 = texture2D( edgesTex, coords, 0.0 ).r;
          coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
          d.y = coords.x;
          d = d * resolution.z - pixcoord.x;
          vec2 sqrt_d = sqrt( abs( d ) );
          coords.y -= 1.0 * resolution.y;
          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 1.0, 0.0 ) ).r;
          weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
        }

        if ( e.r > 0.0 ) {
          vec2 d;
          vec2 coords;
          coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
          coords.x = offset[ 0 ].x;
          d.x = coords.y;
          float e1 = texture2D( edgesTex, coords, 0.0 ).g;
          coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
          d.y = coords.y;
          d = d * resolution.w - pixcoord.y;
          vec2 sqrt_d = sqrt( abs( d ) );
          coords.y -= 1.0 * resolution.y;
          float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, vec2( 0.0, 1.0 ) ).g;
          weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );

          // for some reason the following lines are necessary to prevent
          // texture lookup precision issues on some Intel integrated graphics chips
          vec4 dbg = (offset[ 0 ]+offset[ 1 ]+offset[ 2 ] + coords.xyyx);
          weights.r += 0.00000001 * dot(vec4(0,1,0,1),dbg);
        }
        return weights;
      }

      void main() {
        gl_FragColor = SMAABlendingWeightCalculationPS( fTexCoord, fPixCoord, fOffset, tEdges, tArea, tSearch, ivec4( 0.0 ) );
      }
    `),i}const Abt=Object.freeze(Object.defineProperty({__proto__:null,build:Ebt},Symbol.toStringTag,{value:"Module"}));let MH=class extends _n{initializeProgram(e){return new gn(e.rctx,MH.shader.get().build(),Mn)}initializePipeline(){return yi({colorWrite:$i})}};MH.shader=new bn(Abt,()=>Ee(()=>import("./BlendWeights.glsl-256caa1a.js"),["./BlendWeights.glsl-256caa1a.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));function Mbt(){const i=new Nr,{attributes:e,varyings:t,vertex:n,fragment:r}=i;return e.add(j.POSITION,"vec2"),t.add("fTexCoord","vec2"),t.add("fOffset[2]","vec4"),LA(n),n.code.add(ee`void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );
fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );
}
void main() {
fTexCoord = (position + 1.0 ) * 0.5;
gl_Position = vec4(position, 0, 1);
SMAANeighborhoodBlendingVS(fTexCoord);
}`),r.uniforms.add(new sn("tBlendWeights",s=>s.blend.colorTexture)),r.uniforms.add(new sn("tColor",s=>s.colorTexture)),LA(r),r.code.add(ee`vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
vec4 a;
a.xz = texture2D( blendTex, texcoord ).xz;
a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
a.w = texture2D( blendTex, offset[ 1 ].xy ).a;
if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
return texture2D( colorTex, texcoord, 0.0 );
} else {
vec2 offset;
offset.x = a.a > a.b ? a.a : -a.b;
offset.y = a.g > a.r ? -a.g : a.r;
if ( abs( offset.x ) > abs( offset.y )) {
offset.y = 0.0;
} else {
offset.x = 0.0;
}
vec4 C = texture2D( colorTex, texcoord, 0.0 );
texcoord += sign( offset ) * resolution.xy;
vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );
vec4 mixed = mix(C, Cop, s);
return mixed;
}
}
void main() {
gl_FragColor = SMAANeighborhoodBlendingPS( fTexCoord, fOffset, tColor, tBlendWeights );
}`),i}const Pbt=Object.freeze(Object.defineProperty({__proto__:null,build:Mbt},Symbol.toStringTag,{value:"Module"}));let PH=class extends _n{initializeProgram(e){return new gn(e.rctx,PH.shader.get().build(),Mn)}initializePipeline(){return yi({colorWrite:$i})}};PH.shader=new bn(Pbt,()=>Ee(()=>import("./Blur.glsl-6467242f.js"),["./Blur.glsl-6467242f.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));const xee={threshold:.05,localConstrastAdaption:2};function Obt(){const i=new Nr,{attributes:e,varyings:t,vertex:n,fragment:r}=i;return e.add(j.POSITION,"vec2"),LA(n),t.add("fTexCoord","vec2"),t.add("fOffset[3]","vec4"),n.code.add(ee`void EdgeDetectEdgeDetectionVS( vec2 texcoord ) {
fOffset[0] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );
fOffset[1] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );
fOffset[2] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );
}
void main() {
fTexCoord = (position + 1.0) * 0.5;
gl_Position = vec4(position, 0, 1);
EdgeDetectEdgeDetectionVS(fTexCoord);
}`),r.uniforms.add(new sn("tColor",s=>s.colorTexture)),r.code.add(ee`
    vec4 EdgeDetectColorEdgeDetectionPS(vec2 texcoord, vec4 offset[3], sampler2D colorTex) {
      vec2 threshold = vec2( ${ee.float(xee.threshold)} );

      // Calculate color deltas:
      vec4 delta;
      vec3 C = texture2D( colorTex, texcoord ).rgb;

      vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
      vec3 t = abs( C - Cleft );
      delta.x = max( max( t.r, t.g ), t.b );

      vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
      t = abs( C - Ctop );
      delta.y = max( max( t.r, t.g ), t.b );

      // We do the usual threshold:
      vec2 edges = step( threshold, delta.xy );

      // Then discard if there is no edge:
      if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
          discard;

      // Calculate right and bottom deltas:
      vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
      t = abs( C - Cright );
      delta.z = max( max( t.r, t.g ), t.b );

      vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
      t = abs( C - Cbottom );
      delta.w = max( max( t.r, t.g ), t.b );

      // Calculate the maximum delta in the direct neighborhood:
      float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );

      // Calculate left-left and top-top deltas:
      vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
      t = abs( C - Cleftleft );
      delta.z = max( max( t.r, t.g ), t.b );

      vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
      t = abs( C - Ctoptop );
      delta.w = max( max( t.r, t.g ), t.b );

      // Calculate the final maximum delta:
      maxDelta = max( max( maxDelta, delta.z ), delta.w );

      // Local contrast adaptation in action:
      edges.xy *= step( maxDelta, float(${ee.float(xee.localConstrastAdaption)}) * delta.xy );

      return vec4( edges, 0.0, 0.0 );
    }

    void main() {
      gl_FragColor = EdgeDetectColorEdgeDetectionPS(fTexCoord, fOffset, tColor);
    }
  `),i}const Rbt=Object.freeze(Object.defineProperty({__proto__:null,build:Obt},Symbol.toStringTag,{value:"Module"}));let OH=class extends _n{initializeProgram(e){return new gn(e.rctx,OH.shader.get().build(),Mn)}initializePipeline(){return yi({colorWrite:$i})}};OH.shader=new bn(Rbt,()=>Ee(()=>import("./EdgeDetect.glsl-d8356157.js"),["./EdgeDetect.glsl-d8356157.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let zS=class extends et{constructor(e,t){super({}),this._rctx=e,this._techniqueRep=t,this._passParameters=new Tbt,this._isEnabled=!1}normalizeCtorArgs(){return{}}dispose(){this._abortController=ll(this._abortController),this.disable()}_loadResources(e){if(T(this._abortController))return!1;if(T(this._passParameters.searchTexture))return!0;this._abortController=new AbortController;const t=this._abortController.signal;return Ee(()=>import("./SmaaRenderPassData-660b7d34.js"),[],import.meta.url).then(n=>this._loadTextures(n,t)).then(()=>e()).finally(()=>this._abortController=null),!1}_loadTextures(e,t){return Cn(t),Promise.all([this._loadTextureFromBase64(e.areaTexture,fn.LINEAR,Ui.RGB),this._loadTextureFromBase64(e.searchTexure,fn.NEAREST,Ui.LUMINANCE)]).then(([n,r])=>{bu(t)?(n.dispose(),r.dispose(),Cn(t)):(this._passParameters.areaTexture=n,this._passParameters.searchTexture=r)})}get updating(){return T(this._abortController)}enable(e){if(this._isEnabled)return!0;if(!this._edgeDetectTechnique||!this._blendWeightsTechnique||!this._blurTechnique){const t=new ic;this._edgeDetectTechnique=this._techniqueRep.releaseAndAcquire(OH,t,this._edgeDetectTechnique),this._blendWeightsTechnique=this._techniqueRep.releaseAndAcquire(MH,t,this._blendWeightsTechnique),this._blurTechnique=this._techniqueRep.releaseAndAcquire(PH,t,this._blurTechnique)}return!!this._loadResources(e)&&(this._vao=Ibe(this._rctx),this._passParameters.edges=new ma(this._rctx,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGB,dataType:un.UNSIGNED_BYTE,samplingMode:fn.LINEAR,wrapMode:An.CLAMP_TO_EDGE,width:4,height:4}),this._passParameters.blend=new ma(this._rctx,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},{target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.LINEAR,wrapMode:An.CLAMP_TO_EDGE,width:4,height:4}),this._isEnabled=!0,!0)}disable(){this._isEnabled&&(this._vao=Ht(this._vao),this._passParameters.areaTexture=Ht(this._passParameters.areaTexture),this._passParameters.searchTexture=Ht(this._passParameters.searchTexture),this._passParameters.blend=Ht(this._passParameters.blend),this._passParameters.edges=Ht(this._passParameters.edges),this._isEnabled=!1)}get _validPassParameters(){return this._isEnabled?this._passParameters:null}render(e){const t=this._validPassParameters;if(B(t))return;t.colorTexture=e;const n=this._rctx,r=n.getBoundFramebufferObject(),s=e.descriptor.width,a=e.descriptor.height;n.bindVAO(this._vao),n.setViewport(0,0,s,a),t.edges.resize(s,a),n.bindFramebuffer(t.edges),n.setClearColor(0,0,0,1),n.clear(hr.COLOR_BUFFER_BIT),n.bindTechnique(this._edgeDetectTechnique,t,null),n.drawArrays(Qi.TRIANGLES,0,3),t.blend.resize(s,a),n.bindFramebuffer(t.blend),n.setClearColor(0,0,1,1),n.clear(hr.COLOR_BUFFER_BIT),n.bindTechnique(this._blendWeightsTechnique,t,null),n.drawArrays(Qi.TRIANGLES,0,3),n.bindFramebuffer(r),n.setClearColor(0,1,0,1),n.clear(hr.COLOR_BUFFER_BIT),n.bindTechnique(this._blurTechnique,t,null),n.drawArrays(Qi.TRIANGLES,0,3)}_loadTextureFromBase64(e,t,n){return tb(e).then(r=>new Er(this._rctx,{pixelFormat:n,dataType:un.UNSIGNED_BYTE,wrapMode:An.CLAMP_TO_EDGE,width:r.width,height:r.height,samplingMode:t},r))}};f([y()],zS.prototype,"_abortController",void 0),f([y({readOnly:!0})],zS.prototype,"updating",null),zS=f([ge("esri.views.3d.webgl-engine.lib.SmaaRenderPass")],zS);function Ibt(i,e){const t=-i[0],n=-i[1],r=-i[2],s=e[3],a=e[7],o=e[11],l=e[15];e[0]+=s*t,e[1]+=s*n,e[2]+=s*r,e[4]+=a*t,e[5]+=a*n,e[6]+=a*r,e[8]+=o*t,e[9]+=o*n,e[10]+=o*r,e[12]+=l*t,e[13]+=l*n,e[14]+=l*r}function $bt(i,e){const t=i[0],n=i[1],r=i[2];e[12]+=t*e[0]+n*e[4]+r*e[8],e[13]+=t*e[1]+n*e[5]+r*e[9],e[14]+=t*e[2]+n*e[6]+r*e[10],e[14]+=t*e[3]+n*e[7]+r*e[11]}let Lbt=class{constructor(e){this._factory=e,this._originData=new Map}acquire(e){return this.register(this._factory.getOrigin(e))}register(e){const t=this._originData.get(e.id)||new Dbt(e);return t.refCount++,this._originData.has(t.origin.id)||this._originData.set(t.origin.id,t),t}release(e){e.refCount--,e.refCount===0&&this._originData.delete(e.origin.id)}updateViewMatrices(e){this._originData.forEach(t=>{da(t.viewMatrix,e),$bt(t.origin.vec3,t.viewMatrix)})}},Dbt=class{constructor(e){this.origin=e,this.refCount=0,this.viewMatrix=St()}},kbt=class extends Vbe{constructor(e,t){super(),this.distanceFalloffFactor=e,this.transparency=t,this.transformNormalViewFromGlobal=Ho()}},Fbt=class extends Bbe{constructor(){super(...arguments),this.transformNormalViewFromGlobal=Ho(),this.slicePlaneLocalOrigin=q(),this.transformNormalGlobalFromModel=Ho()}};function Nbt(i){const e=ee`bool isNaN( float val )
{
return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}`;i.code.add(e)}const Vbt=dn(.5,-4e-4);function Bbt(i,e){const t=i.vertex;t.include(Nbt),t.constants.add("depthBias","vec2",Vbt),t.uniforms.add(new hl("inverseViewport",(n,r)=>r.inverseViewport)),e.legacy?(t.uniforms.add(new pl("proj",(n,r)=>r.camera.projectionMatrix)),t.code.add(ee`vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {
float offsetXY = depthBias.x;
vec4 projNormal = proj * localView * vec4(globalNormal, 0.0);
return offsetXY * projPos.w * 2.0 * inverseViewport * normalize(projNormal.xyz).xy;
}`)):(t.uniforms.add(new Xne("transformNormalViewFromGlobal",n=>n.transformNormalViewFromGlobal)),t.uniforms.add(new pl("transformProjFromView",n=>n.transformProjFromView)),t.code.add(ee`vec2 calculateProjectedBiasXY(vec4 projPos, vec3 globalNormal) {
float offsetXY = depthBias.x;
vec4 projNormal = transformProjFromView * vec4(transformNormalViewFromGlobal * globalNormal, 0.0);
return offsetXY * projPos.w * 2.0 * inverseViewport * normalize(projNormal.xyz).xy;
}`)),t.code.add(ee`float _calculateProjectedBiasZ(vec4 projPos) {
float offsetZ = depthBias.y;
return sqrt(max(projPos.z,0.0)) * offsetZ;
}
vec4 adjustProjectedPosition(vec4 projPos, vec3 worldNormal, float lineWidth) {
vec2 offsetXY = calculateProjectedBiasXY(projPos, worldNormal);
if (!isNaN(offsetXY.x) && !isNaN(offsetXY.y)) {
projPos.xy += offsetXY;
}
projPos.z += _calculateProjectedBiasZ(projPos);
return projPos;
}`)}function zbt(i,e){const t=i.fragment;t.constants.add("coverageTestThreshold","float",.01),e.antialiasing?t.code.add(ee`#define discardByCoverage(radius, coverage) { if (coverage < coverageTestThreshold) discard; }`):t.code.add(ee`#define discardByCoverage(radius, coverage) { float coverageLimit = radius <= 0.5 ? coverageTestThreshold : 0.75; if (coverage < coverageLimit) discard; }`)}function Ubt(i,e){const t=i.vertex;e.silhouette?(t.code.add(ee`bool isSilhouetteEdge(vec3 viewDir, vec3 normalA, vec3 normalB) {
float faceAVisible = dot(viewDir, normalA);
float faceBVisible = dot(viewDir, normalB);
return faceAVisible * faceBVisible < 0.0;
}`),e.legacy?t.code.add(ee`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
vec3 viewNormalA = _modelToViewNormal(normalA);
vec3 viewNormalB = _modelToViewNormal(normalB);
vec3 viewDir = -viewPos;
if (isSilhouetteEdge(viewDir, viewNormalA, viewNormalB)) {
return false;
}
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return true;
}`):t.code.add(ee`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
vec3 worldNormalA = _modelToWorldNormal(normalA);
vec3 worldNormalB = _modelToWorldNormal(normalB);
vec3 viewDir = -worldPos;
if (isSilhouetteEdge(viewDir, worldNormalA, worldNormalB)) {
return false;
}
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return true;
}`)):t.code.add(ee`bool discardNonSilhouetteEdges(vec3 viewPos, vec3 worldPos) {
return false;
}`)}function Hbt(i,e){const t=i.vertex;t.include(Tb),t.uniforms.add(new Hi("distanceFalloffFactor",n=>n.distanceFalloffFactor)),t.code.add(ee`float distanceBasedPerspectiveFactor(float distance) {
return clamp(sqrt(distanceFalloffFactor / distance), 0.0, 1.0);
}`),t.uniforms.add(r3("componentDataTex",n=>n.componentDataTexture,e.hasWebGL2Context?Ou.None:Ou.InvSize)),i.attributes.add(j.COMPONENTINDEX,"float"),t.constants.add("componentColorFieldOffset","float",0),t.constants.add("componentOtherFieldOffset","float",1),t.constants.add("componentVerticalOffsetFieldOffset","float",2),t.constants.add("componentFieldCount","float",3),t.constants.add("lineWidthFractionFactor","float",8),t.constants.add("extensionLengthOffset","float",128),t.constants.add("verticalOffsetScale","float",2*fH),t.code.add(ee`
    vec2 _componentTextureCoords(float componentIndex, float fieldOffset) {
      float fieldIndex = componentFieldCount * componentIndex + fieldOffset;

      vec2 textureSizeInverse = ${qA(e,"componentDataTex",!0)};

      float colIndex = mod(fieldIndex, 1.0 / textureSizeInverse.x);
      float rowIndex = floor(fieldIndex * textureSizeInverse.x);

      vec2 textureCoordinates = vec2(colIndex, rowIndex) + 0.5;

      return textureCoordinates;
    }

    struct ComponentData {
      vec4 color;
      float lineWidth;
      float extensionLength;
      float type;
      float verticalOffset;
    };

    ComponentData readComponentData() {
      vec2 colorIndex = _componentTextureCoords(componentIndex, componentColorFieldOffset);
      vec2 otherIndex = _componentTextureCoords(componentIndex, componentOtherFieldOffset);
      vec2 verticalOffsetIndex = _componentTextureCoords(componentIndex, componentVerticalOffsetFieldOffset);

      vec4 colorValue = ${Eu(e,"componentDataTex","colorIndex")};
      vec4 otherValue = ${Eu(e,"componentDataTex","otherIndex")};
      float verticalOffset = (rgba2float(${Eu(e,"componentDataTex","verticalOffsetIndex")}) - 0.5) * verticalOffsetScale;

      return ComponentData(
        vec4(colorValue.rgb, colorValue.a * otherValue.w), // otherValue.w stores separate opacity
        otherValue.x * (255.0 / lineWidthFractionFactor),
        otherValue.y * 255.0 - extensionLengthOffset,
        -(otherValue.z * 255.0) + 0.5, // SOLID (=0/255) needs to be > 0.0, SKETCHY (=1/255) needs to be <= 0;
        verticalOffset
      );
    }
  `),e.legacy?t.code.add(ee`vec3 _modelToWorldNormal(vec3 normal) {
return (model * vec4(normal, 0.0)).xyz;
}
vec3 _modelToViewNormal(vec3 normal) {
return (localView * model * vec4(normal, 0.0)).xyz;
}`):(t.uniforms.add(new JN("transformNormalGlobalFromModel",n=>n.transformNormalGlobalFromModel)),t.code.add(ee`vec3 _modelToWorldNormal(vec3 normal) {
return transformNormalGlobalFromModel * normal;
}`)),e.silhouette?(i.attributes.add(j.NORMALA,"vec3"),i.attributes.add(j.NORMALB,"vec3"),t.code.add(ee`vec3 worldNormal() {
return _modelToWorldNormal(normalize(normalA + normalB));
}`)):(i.attributes.add(j.NORMAL,"vec3"),t.code.add(ee`vec3 worldNormal() {
return _modelToWorldNormal(normal);
}`)),e.legacy?t.code.add(ee`void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
worldPos = (model * vec4(modelPos, 1.0)).xyz;
viewPos = (localView * vec4(worldPos, 1.0)).xyz;
}`):(t.include(iW,e),t.include(iW,e),t.uniforms.add([new Xne("transformViewFromCameraRelativeRS",n=>n.transformViewFromCameraRelativeRS),new JN("transformWorldFromModelRS",n=>n.transformWorldFromModelRS),new YG("transformWorldFromModelTL",n=>n.transformWorldFromModelTL),new YG("transformWorldFromModelTH",n=>n.transformWorldFromModelTH),new Io("transformWorldFromViewTL",n=>n.transformWorldFromViewTL),new Io("transformWorldFromViewTH",n=>n.transformWorldFromViewTH)]),t.code.add(ee`
      void worldAndViewFromModelPosition(vec3 modelPos, float verticalOffset, out vec3 worldPos, out vec3 viewPos) {
        vec3 rotatedModelPosition = transformWorldFromModelRS * modelPos;

        vec3 transformCameraRelativeFromModel = dpAdd(
          transformWorldFromModelTL,
          transformWorldFromModelTH,
          -transformWorldFromViewTL,
          -transformWorldFromViewTH
        );

        worldPos = transformCameraRelativeFromModel + rotatedModelPosition;

        if (verticalOffset != 0.0) {
          vec3 vUp = ${e.spherical?ee`normalize(transformWorldFromModelTL + rotatedModelPosition);`:ee`vec3(0.0, 0.0, 1.0);`}
          worldPos += verticalOffset * vUp;
        }

        viewPos = transformViewFromCameraRelativeRS * worldPos;
      }
    `)),t.uniforms.add(new pl("transformProjFromView",(n,r)=>r.camera.projectionMatrix)),t.code.add(ee`vec4 projFromViewPosition(vec3 position) {
return transformProjFromView * vec4(position, 1.0);
}`),t.code.add(ee`float calculateExtensionLength(float extensionLength, float lineLength) {
return extensionLength / (log2(max(1.0, 256.0 / lineLength)) * 0.2 + 1.0);
}`)}function Gbt(i){return i.mode===xs.SKETCH||i.mode===xs.MIXED}var xs;(function(i){i[i.SOLID=0]="SOLID",i[i.SKETCH=1]="SKETCH",i[i.MIXED=2]="MIXED",i[i.COUNT=3]="COUNT"})(xs||(xs={}));function Wbt(i,e){const t=i.vertex;switch(e.mode){case xs.SKETCH:t.code.add(ee`#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}`);break;case xs.MIXED:t.code.add(ee`#define discardShortEdges(unpackedAttributes, lineLengthPixels) { if (unpackedAttributes.type <= 0.0 && lineLengthPixels <= 3.0) { gl_Position = vec4(10.0, 10.0, 10.0, 1.0); return; }}`);break;case xs.SOLID:t.code.add(ee`#define discardShortEdges(unpackedAttributes, lineLengthPixels) {}`)}}function RH(i,e){const t=i.vertex;switch(i.attributes.add(j.SIDENESS,"vec2"),e.mode===xs.MIXED?t.code.add(ee`struct UnpackedAttributes {
vec2 sideness;
vec2 sidenessNorm;
float lineWidthPixels;
float extensionLengthPixels;
float type;
};`):t.code.add(ee`struct UnpackedAttributes {
vec2 sideness;
vec2 sidenessNorm;
float lineWidthPixels;
float extensionLengthPixels;
};`),e.mode){case xs.MIXED:t.code.add(ee`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float fType = component.type;
float extensionLengthPixels = component.extensionLength;
float lineWidth = component.lineWidth;
if (fType <= 0.0) {
extensionLengthPixels *= variantExtension * 2.0 - 1.0;
}
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels, fType);
}`);break;case xs.SKETCH:t.code.add(ee`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float extensionLengthPixels = component.extensionLength;
extensionLengthPixels *= variantExtension * 2.0 - 1.0;
float lineWidth = component.lineWidth;
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);
}`);break;case xs.SOLID:t.code.add(ee`UnpackedAttributes unpackAttributes(ComponentData component) {
vec2 sidenessNorm = sideness;
vec2 sideness = sidenessNorm * 2.0 - 1.0;
float extensionLengthPixels = component.extensionLength;
float lineWidth = component.lineWidth;
return UnpackedAttributes(sideness, sidenessNorm, lineWidth, extensionLengthPixels);
}`);break;case xs.COUNT:break;default:Do(e.mode)}}function jbt(i,e){const t=i.vertex;switch(i.include(RH,e),e.mode){case xs.SOLID:t.code.add(ee`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
return 0.0;
}`);break;case xs.SKETCH:t.uniforms.add(new ux("strokesAmplitude",n=>n.strokesTexture.amplitude)),t.code.add(ee`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
return strokesAmplitude;
}`);break;case xs.MIXED:t.uniforms.add(new ux("strokesAmplitude",n=>n.strokesTexture.amplitude)),t.code.add(ee`float calculateLineAmplitude(UnpackedAttributes unpackedAttributes) {
float type = unpackedAttributes.type;
if (type <= 0.0) {
return strokesAmplitude;
}
else {
return 0.0;
}
}`)}}function qbt(i,e){i.include(RH,e);const{vertex:t,fragment:n}=i;switch(Gbt(e)&&(t.uniforms.add(r3("strokesTexture",r=>r.strokesTexture.texture,e.hasWebGL2Context?Ou.None:Ou.InvSize)),t.uniforms.add([new ux("strokesLog2Resolution",r=>Math.log2(r.strokesTexture.resolution)),new ux("strokeVariants",r=>r.strokesTexture.variants)]),i.varyings.add("vStrokeUV","vec2"),n.uniforms.add([new uz("strokesTexture",r=>r.strokesTexture.texture),new ux("strokesNormalizationScale",r=>r.strokesTexture.normalizationScale)]),t.code.add(ee`
      void calculateStyleOutputsSketch(float lineLength, UnpackedAttributes unpackedAttributes) {
        vec2 sidenessNorm = unpackedAttributes.sidenessNorm;

        float lineIndex = clamp(ceil(log2(lineLength)), 0.0, strokesLog2Resolution);

        vec2 textureSizeInverse = ${qA(e,"strokesTexture",!0)};
        vStrokeUV = vec2(exp2(lineIndex) * sidenessNorm.y, lineIndex * strokeVariants + variantStroke + 0.5) * textureSizeInverse;
        vStrokeUV.x += variantOffset;
      }
    `),i.fragment.include(Tb),n.code.add(ee`float calculateLineOffsetSketch() {
float offsetNorm = rgba2float(texture2D(strokesTexture, vStrokeUV));
return (offsetNorm - 0.5) * strokesNormalizationScale;
}
float calculateLinePressureSketch() {
return rgba2float(texture2D(strokesTexture, vStrokeUV + vec2(0.0, 0.5)));
}`)),e.mode){case xs.SOLID:t.code.add(ee`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes) {}`),n.code.add(ee`float calculateLineOffset() {
return 0.0;
}
float calculateLinePressure() {
return 1.0;
}`);break;case xs.SKETCH:t.code.add(ee`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)
{
calculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);
}`),n.code.add(ee`float calculateLineOffset() {
return calculateLineOffsetSketch();
}
float calculateLinePressure() {
return calculateLinePressureSketch();
}`);break;case xs.MIXED:i.varyings.add("vType","float"),t.code.add(ee`void calculateStyleOutputs(UnpackedAttributes unpackedAttributes)
{
vType = unpackedAttributes.type;
if (unpackedAttributes.type <= 0.0) {
calculateStyleOutputsSketch(vLineLengthPixels, unpackedAttributes);
}
}`),n.code.add(ee`float calculateLineOffset() {
if (vType <= 0.0) {
return calculateLineOffsetSketch();
}
else {
return 0.0;
}
}
float calculateLinePressure() {
if (vType <= 0.0) {
return calculateLinePressureSketch();
}
else {
return 1.0;
}
}`)}}function Kbt(i){const e=new Nr,{vertex:t,fragment:n}=e;return i.antialiasing&&(t.code.add(ee`#define ANTIALIASING 1`),n.code.add(ee`#define ANTIALIASING 1`)),i.legacy&&t.uniforms.add([new Cee("model"),new Cee("localView")]),e.include(Bbt,i),e.include(Hbt,i),e.include(jbt,i),e.include(RH,i),e.include(qbt,i),e.include(pre,i),e.include(Ubt,i),e.include(zbt,i),e.include(Wbt,i),e.include(e5,i),e.varyings.add("vColor","vec4"),e.varyings.add("vRadius","float"),e.varyings.add("vPosition","vec3"),e.varyings.add("vWorldPosition","vec3"),e.varyings.add("vViewPos","vec3"),e.varyings.add("vLineLengthPixels","float"),e.varyings.add("vSizeFalloffFactor","float"),t.uniforms.add([new hl("pixelToNDC",(r,s)=>Bi(Ybt,2/s.camera.fullViewport[2],2/s.camera.fullViewport[3])),new jp("viewport",(r,s)=>s.camera.fullViewport),new Hi("pixelRatio",(r,s)=>s.camera.pixelRatio)]),e.attributes.add(j.POSITION0,"vec3"),e.attributes.add(j.POSITION1,"vec3"),e.attributes.add(j.VARIANTOFFSET,"float"),e.attributes.add(j.VARIANTSTROKE,"float"),e.attributes.add(j.VARIANTEXTENSION,"float"),t.code.add(ee`const float opaqueCutoff = 1.0 / 255.0;
void calculateGeometricOutputs(vec3 viewPosV0, vec3 viewPosV1, vec3 worldPosV0, vec3 worldPosV1, vec3 worldNormal, UnpackedAttributes unpackedAttributes) {
vec2 sideness = unpackedAttributes.sideness;
vec2 sidenessNorm = unpackedAttributes.sidenessNorm;
vWorldPosition = mix(worldPosV0, worldPosV1, sidenessNorm.y).xyz;
vec3 viewPos = mix(viewPosV0, viewPosV1, sidenessNorm.y);
vViewPos = viewPos;
vec4 projPosV0 = projFromViewPosition(viewPosV0);
vec4 projPosV1 = projFromViewPosition(viewPosV1);
vec4 projPos = projFromViewPosition(viewPos);
vec3 screenSpaceLineNDC = (projPosV1.xyz / projPosV1.w - projPosV0.xyz / projPosV0.w);
vec2 ndcToPixel = viewport.zw * 0.5;
vec2 screenSpaceLinePixels = screenSpaceLineNDC.xy * ndcToPixel;
float lineLengthPixels = length(screenSpaceLinePixels);
float dzPerPixel = screenSpaceLineNDC.z / lineLengthPixels;
vec2 screenSpaceDirection = screenSpaceLinePixels / lineLengthPixels;
vec2 perpendicularScreenSpaceDirection = vec2(screenSpaceDirection.y, -screenSpaceDirection.x) * sideness.x;
float falloffFactor = distanceBasedPerspectiveFactor(-viewPos.z) * pixelRatio;
float lineWidthPixels = unpackedAttributes.lineWidthPixels * falloffFactor;
float extensionLengthPixels = calculateExtensionLength(unpackedAttributes.extensionLengthPixels, lineLengthPixels) * falloffFactor;
float lineAmplitudePixels = calculateLineAmplitude(unpackedAttributes) * pixelRatio;
vSizeFalloffFactor = falloffFactor;
float lineWidthAndAmplitudePixels = lineWidthPixels + lineAmplitudePixels + lineAmplitudePixels;
float extendedLineLengthPixels = lineLengthPixels + extensionLengthPixels + extensionLengthPixels;
#ifdef ANTIALIASING
const float aaPaddingPixels = 1.0;
float halfAAPaddedLineWidthAndAmplitudePixels = lineWidthAndAmplitudePixels * 0.5 + aaPaddingPixels;
float aaPaddedRoundedCapSizePixels = lineWidthPixels * 0.5 + aaPaddingPixels;
#else
float halfAAPaddedLineWidthAndAmplitudePixels = max(lineWidthAndAmplitudePixels, 1.0) * 0.5;
float aaPaddedRoundedCapSizePixels = max(lineWidthPixels, 1.0) * 0.5;
#endif
vec2 halfAAPaddedLineWidthAndAmplitudeNDC = halfAAPaddedLineWidthAndAmplitudePixels * pixelToNDC;
vec2 aaPaddedRoundedCapSizeNDC = aaPaddedRoundedCapSizePixels * pixelToNDC;
vec2 extensionLengthNDC = extensionLengthPixels * pixelToNDC;
vec2 ndcOffset = (
screenSpaceDirection * sideness.y * (aaPaddedRoundedCapSizeNDC + extensionLengthNDC)
+ perpendicularScreenSpaceDirection * halfAAPaddedLineWidthAndAmplitudeNDC
);
projPos.xy += ndcOffset * projPos.w;
projPos.z += (dzPerPixel * (aaPaddedRoundedCapSizePixels + extensionLengthPixels)) * sideness.y * projPos.w;
projPos = adjustProjectedPosition(projPos, worldNormal, 1.0 + max((lineWidthAndAmplitudePixels - 1.0) * 0.5, 0.0));
float aaPaddedLineWithCapsLengthPixels = extendedLineLengthPixels + aaPaddedRoundedCapSizePixels + aaPaddedRoundedCapSizePixels;
float pixelPositionAlongLine = aaPaddedLineWithCapsLengthPixels * sidenessNorm.y - aaPaddedRoundedCapSizePixels;
vPosition = vec3(
halfAAPaddedLineWidthAndAmplitudePixels * sideness.x,
pixelPositionAlongLine,
pixelPositionAlongLine / extendedLineLengthPixels
);
vRadius = lineWidthPixels * 0.5;
vLineLengthPixels = extendedLineLengthPixels;
discardShortEdges(unpackedAttributes, lineLengthPixels);
gl_Position = projPos;
}
void main() {
ComponentData component = readComponentData();
UnpackedAttributes unpackedAttributes = unpackAttributes(component);
vec3 worldPosV0, worldPosV1, viewPosV0, viewPosV1;
worldAndViewFromModelPosition(position0, component.verticalOffset, worldPosV0, viewPosV0);
worldAndViewFromModelPosition(position1, component.verticalOffset, worldPosV1, viewPosV1);
vColor = component.color;
if (vColor.a < opaqueCutoff) {
gl_Position = vec4(10.0, 10.0, 10.0, 1.0);
return;
}
if (discardNonSilhouetteEdges(viewPosV0, worldPosV0)) {
return;
}
calculateGeometricOutputs(viewPosV0, viewPosV1, worldPosV0, worldPosV1, worldNormal(), unpackedAttributes);
calculateStyleOutputs(unpackedAttributes);
}`),e.fragment.code.add(ee`
    vec2 lineWithCapsDistance(float radius, vec2 position, float lineLength) {
      float lineOffset = calculateLineOffset();
      float positionX = position.x - lineOffset;

      if (radius < 1.0) {
        // Handle this specifically for subpixel sizes:
        // 1. Compute correct coverage (note coverage is computed by
        //    0.5 - dist, so we make sure that that will lead to correct
        //    subpixel coverage
        // 2. Ignore rounded caps
        float coverageX = clamp(min(radius, positionX + 0.5) - max(-radius, positionX - 0.5), 0.0, 1.0);
        float coverageY = clamp(min(lineLength, position.y + 0.5) - max(0.0, position.y - 0.5), 0.0, 1.0);

        float coverage = min(coverageX, coverageY);

        return vec2(0.5 - coverage, 0.0);
      }
      else {
        // Between -radius -> 0 for start cap, 0 for line, 0 -> radius
        float positionOnCap = position.y - clamp(position.y, 0.0, lineLength);

        vec2 lineToPosition = vec2(positionX, positionOnCap);
        return vec2(length(lineToPosition) - radius, positionOnCap / radius);
      }
    }

    void main() {
      ${i.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, vViewPos.z);":""}
      float radius = vRadius * calculateLinePressure();

      vec2 distance = lineWithCapsDistance(radius, vPosition.xy, vLineLengthPixels);
      float coverage = clamp(0.5 - distance.x, 0.0, 1.0);

      discardByCoverage(radius, coverage);
      discardBySlice(vWorldPosition);

      float alpha = vColor.a * coverage;

      gl_FragColor = vec4(vColor.rgb, alpha);

    }
  `),e}const Ybt=xt();let Cee=class extends Cb{constructor(e){super(e,"mat4")}};const Xbt=Object.freeze(Object.defineProperty({__proto__:null,build:Kbt},Symbol.toStringTag,{value:"Module"}));let IH=class extends _n{initializeConfiguration(e,t){t.hasWebGL2Context=e.rctx.type===La.WEBGL2}initializeProgram(e){return new gn(e.rctx,IH.shader.get().build(this.configuration),i5)}initializePipeline(e){return e.blendMinMax?yi({blending:Na(vt.ONE,vt.ONE,vt.ZERO,vt.ONE,m2.ADD,e.blendMinMax.MAX),depthTest:{func:lo.LEQUAL},colorWrite:$i}):yi({depthTest:{func:lo.LEQUAL},depthWrite:Lu,colorWrite:$i})}};IH.shader=new bn(Xbt,()=>Ee(()=>import("./EdgeShader.glsl-c7c9f350.js"),["./EdgeShader.glsl-c7c9f350.js","./vec2-2cef68de.js","./common-c186b691.js","./vec2f64-30dc1443.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./mat4f64-1e28eae0.js","./vec3-a020a6f6.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./Texture2DPassUniform-6e8ae673.js","./VertexAttribute-9c5c630d.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Basemap-a8f7f439.js","./preload-helper-41c905a7.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));let pp=class extends yf{constructor(){super(...arguments),this.mode=xs.SOLID,this.hasSlicePlane=!1,this.silhouette=!1,this.legacy=!1,this.antialiasing=!1,this.doublePrecisionRequiresObfuscation=!1,this.hasMultipassTerrain=!1,this.cullAboveGround=!1,this.spherical=!1}};f([Pe({count:xs.COUNT})],pp.prototype,"mode",void 0),f([Pe()],pp.prototype,"hasSlicePlane",void 0),f([Pe()],pp.prototype,"silhouette",void 0),f([Pe()],pp.prototype,"legacy",void 0),f([Pe()],pp.prototype,"antialiasing",void 0),f([Pe()],pp.prototype,"doublePrecisionRequiresObfuscation",void 0),f([Pe()],pp.prototype,"hasMultipassTerrain",void 0),f([Pe()],pp.prototype,"cullAboveGround",void 0),f([Pe()],pp.prototype,"spherical",void 0);const Zbt=8,K4=128,Qbt={type:"uber",hasSlicePlane:!1,strokesTexture:null,legacy:!0,spherical:!0},Jbt={solid:xs.SOLID,sketch:xs.SKETCH,uber:xs.MIXED};let wI=class{constructor(e,t,n){this._rctx=e,this._shaderTechniqueRepository=t,this._configuration=new pp,this.refCount=0,this._renderables=new Set,this._sortedRenderables={[Vi.TRANSPARENT]:{[Vi.TRANSPARENT]:new pn,[Vi.OPAQUE]:new pn},[Vi.OPAQUE]:{[Vi.TRANSPARENT]:new pn,[Vi.OPAQUE]:new pn}},this._renderablesDirty=!1,this._drawParameters=new Fbt,this._settings={...Qbt,...n},this.key=wI.getKey(this._settings.type,this._settings.hasSlicePlane,this._settings.legacy);const r=this._settings.strokesTexture.variants;this.writerSettings={variants:r,reducedPrecision:cn.TESTS_DISABLE_OPTIMIZATIONS},this._configuration.legacy=this._settings.legacy,this._configuration.mode=Jbt[this._settings.type],this._configuration.silhouette=!1,this._configuration.antialiasing=!!this._rctx.capabilities.blendMinMax,this._configuration.hasSlicePlane=this._settings.hasSlicePlane,this._configuration.doublePrecisionRequiresObfuscation=QL(e),this._configuration.spherical=n.spherical}dispose(){this._technique=Lr(this._technique)}addRenderable(e){this._renderables.add(e),this._renderablesDirty=!0}removeRenderable(e){this._renderables.delete(e),this._renderablesDirty=!0}setRenderablesDirty(){this._renderablesDirty=!0}forEachRenderable(e,t){this._renderablesDirty&&this._sortRenderables(),this._sortedRenderables[t][Vi.TRANSPARENT].forAll(e),this._sortedRenderables[t][Vi.OPAQUE].forAll(e)}updateTechnique(e,t){return this._configuration.hasMultipassTerrain=!!e.multipassTerrain.enabled,this._configuration.cullAboveGround=!!e.multipassTerrain.cullAboveGround,this._configuration.silhouette=t,this._technique=this._shaderTechniqueRepository.releaseAndAcquire(IH,this._configuration,this._technique),this._technique}bindRegularEdges(e,t){return this._lastOriginId=null,this._rctx.bindTechnique(this.updateTechnique(t,!1),e,t)}bindSilhouetteEdges(e,t){return this._lastOriginId=null,this._rctx.bindTechnique(this.updateTechnique(t,!0),e,t)}renderRegularEdges(e,t,n,r,s){this._render(e,t,t.regular.vao,n,r,s)}renderSilhouetteEdges(e,t,n,r,s){this._render(e,t,t.silhouette.vao,n,r,s)}_render(e,t,n,r,s,a){a>0&&(this._bindDraw(e,t,r,s),this._rctx.bindVAO(n),this._rctx.capabilities.instancing.drawArraysInstanced(Qi.TRIANGLE_FAN,0,4,a))}_bindDraw(e,t,n,r){if(this._drawParameters.componentDataTexture=t.components.buffer.textureBuffer.texture,this._drawParameters.strokesTexture=this._settings.strokesTexture,"origin"in t.transform)this._lastOriginId!==t.transform.origin.origin.id&&(e.setUniformMatrix4fv("localView",t.transform.origin.viewMatrix),this._lastOriginId=t.transform.origin.origin.id),e.setUniformMatrix4fv("model",t.transform.modelMatrix),this._drawParameters.slicePlaneLocalOrigin=t.transform.origin.origin.vec3;else{const s=new OD(t.transform.position),a=cg(Tee,IC(Tee,t.transform.rotationScale));this._drawParameters.transformWorldFromModelTL=s.low,this._drawParameters.transformWorldFromModelTH=s.high,this._drawParameters.transformWorldFromModelRS=t.transform.rotationScale,this._drawParameters.transformNormalGlobalFromModel=a;const o=r.camera.viewInverseTransposeMatrix;je(this._drawParameters.slicePlaneLocalOrigin,o[3],o[7],o[11])}e.bindDraw(this._drawParameters,r,n)}_sortRenderables(){this._renderablesDirty=!1,this._sortedRenderables[Vi.TRANSPARENT][Vi.TRANSPARENT].clear(),this._sortedRenderables[Vi.TRANSPARENT][Vi.OPAQUE].clear(),this._sortedRenderables[Vi.OPAQUE][Vi.TRANSPARENT].clear(),this._sortedRenderables[Vi.OPAQUE][Vi.OPAQUE].clear(),this._renderables.forEach(t=>{t.objectTransparency!==Vi.INVISIBLE&&t.edgeTransparency!==Vi.INVISIBLE&&this._sortedRenderables[t.objectTransparency][t.edgeTransparency].push(t)});const e=(t,n)=>"origin"in t.transform?"origin"in n.transform?t.transform.origin.origin.id<n.transform.origin.origin.id?-1:t.transform.origin.origin.id>n.transform.origin.origin.id?1:0:1:0;this._sortedRenderables[Vi.TRANSPARENT][Vi.TRANSPARENT].sort(e),this._sortedRenderables[Vi.TRANSPARENT][Vi.OPAQUE].sort(e),this._sortedRenderables[Vi.OPAQUE][Vi.TRANSPARENT].sort(e),this._sortedRenderables[Vi.OPAQUE][Vi.OPAQUE].sort(e)}static getKey(e,t,n){return`edges-t:${e}:${t}:${n}`}};const Tee=ny();let e1t=class extends Gwe{constructor(e){super("EdgeProcessingWorker","extract",{extract:t=>[t.dataBuffer],extractComponentsEdgeLocations:t=>[t.dataBuffer],extractEdgeLocations:t=>[t.dataBuffer]},e)}async process(e,t,n){if(n)return o1e(e);const r=await this.invoke(new Y4(e),t);return this._unpackOutput(r)}async extractEdgeLocations(e,t){const n=await this.invokeMethod("extractEdgeLocations",new Y4(e),t);return FM(n)}async extractComponentsEdgeLocations(e,t){const n=await this.invokeMethod("extractComponentsEdgeLocations",new Y4(e),t);return FM(n)}_unpackOutput(e){return{regular:{instancesData:FM(e.regular.instancesData),lodInfo:{lengths:new Float32Array(e.regular.lodInfo.lengths)}},silhouette:{instancesData:FM(e.silhouette.instancesData),lodInfo:{lengths:new Float32Array(e.silhouette.lodInfo.lengths)}},averageEdgeLength:e.averageEdgeLength}}},Y4=class{constructor(e){this.dataBuffer=e.data.buffer,this.writerSettings=e.writerSettings,this.skipDeduplicate=e.skipDeduplicate,this.indices=Array.isArray(e.indices)?e.indices:e.indices.buffer,this.indicesType=Array.isArray(e.indices)?"Array":Cye(e.indices)?"Uint32Array":"Uint16Array",this.indicesLength=e.indicesLength}};function t1t(i){const t=tS.resolution,n=t/2,r=new Uint8Array(4*t*t),s=4*t*n,a=tS.amplitude,o=2*a,l=4*t,c=Math.log2(t)+1,u=tS.strokes.length;let d=(c-1)*u*l;for(const{distance:p,pressure:m}of tS.strokes){let g=p,_=m,b=d;for(let x=0;x<c;x++){x!==0&&(g=See(g,DA.DISTANCE),_=See(_,DA.PRESSURE));for(let w=0;w<tS.resolution;w++){const C=.5+(g?g[w%g.length]/o:0),S=_?_[w%_.length]:1;o5(C,r,b),o5(S,r,b+s),b+=4}b-=l*(u+1)}d+=l}const h=new Er(i,{pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,hasMipmap:!1,samplingMode:fn.LINEAR,width:t,height:t,wrapMode:An.REPEAT},r);return new n1t(t,o,a,u,h)}function See(i,e){if(!i)return null;const t=i.length/2,n=i1t*t,r=new Array(t);let s=0;const a=e===DA.PRESSURE;for(let o=0;o<i.length;o+=2){const l=(i[o]+i[o+1])/2;r[s++]=a?Math.min(n,1-(1-l)*Eee):Math.min(n,l*Eee)}return r}var DA;(function(i){i[i.DISTANCE=0]="DISTANCE",i[i.PRESSURE=1]="PRESSURE"})(DA||(DA={}));const i1t=.1,Eee=.5;let n1t=class{constructor(e,t,n,r,s){this.resolution=e,this.normalizationScale=t,this.amplitude=n,this.variants=r,this.texture=s}dispose(){this.texture=Ht(this.texture)}};const tS={amplitude:8,resolution:256,strokes:[{distance:[-1.59027,-1.59426,-1.59674,-1.59766,-1.59702,-1.59479,-1.59095,-1.5855,-1.57843,-1.56973,-1.55942,-1.5475,-1.53398,-1.5189,-1.50226,-1.4841,-1.46446,-1.44337,-1.42088,-1.39703,-1.37188,-1.34547,-1.31786,-1.28912,-1.2593,-1.22847,-1.19668,-1.16402,-1.13053,-1.09629,-1.06137,-1.02582,-.98972,-.95313,-.91611,-.87872,-.84102,-.80306,-.76488,-.72654,-.68807,-.64952,-.61092,-.57232,-.53375,-.49527,-.45692,-.41874,-.38078,-.34309,-.3057,-.26867,-.23204,-.19585,-.16015,-.12497,-.09036,-.05634,-.02296,.00977,.04183,.07321,.10389,.13386,.16313,.19169,.21956,.24672,.27321,.299,.32413,.34858,.37237,.3955,.41798,.43981,.461,.48154,.50145,.52073,.53939,.55744,.57488,.5917,.6079,.62347,.63837,.65259,.66609,.67885,.69083,.70201,.71235,.72183,.73042,.73812,.7449,.75076,.7557,.75973,.76284,.76507,.76642,.76692,.76659,.76545,.76352,.76083,.7574,.75324,.74837,.74279,.73652,.72959,.72199,.71377,.70493,.69553,.68558,.67515,.66426,.65298,.64135,.62944,.6173,.60499,.59257,.58008,.56759,.55513,.54275,.5305,.51842,.50654,.4949,.48353,.47246,.4617,.45128,.44121,.43149,.42213,.41313,.40448,.39617,.38818,.3805,.37309,.36594,.35902,.35229,.34572,.33927,.33292,.32663,.32035,.31407,.30774,.30135,.29486,.28824,.28148,.27454,.26739,.26002,.25241,.24454,.23639,.22796,.21922,.21016,.20076,.19098,.18082,.17023,.1592,.14768,.13566,.1231,.10996,.09624,.08188,.06688,.05121,.03485,.01778,0,-.0185,-.03771,-.05763,-.07824,-.09952,-.12144,-.14396,-.16706,-.19069,-.21481,-.23938,-.26436,-.28971,-.31539,-.34136,-.36759,-.39404,-.42067,-.44746,-.47437,-.50136,-.52839,-.55544,-.58248,-.60948,-.63642,-.66329,-.6901,-.71684,-.74352,-.77015,-.79675,-.82332,-.84988,-.87644,-.90301,-.92958,-.95615,-.98272,-1.00926,-1.03575,-1.06217,-1.08847,-1.11463,-1.1406,-1.16633,-1.19178,-1.2169,-1.24164,-1.26595,-1.28979,-1.31312,-1.3359,-1.35809,-1.37963,-1.4005,-1.42064,-1.44,-1.45853,-1.47616,-1.49285,-1.50853,-1.52313,-1.53659,-1.54886,-1.55986,-1.56955,-1.57788,-1.5848],pressure:[-.01365,-.00206,.01025,.02327,.03696,.05129,.06619,.08163,.09755,.11393,.1307,.14784,.16531,.18308,.20111,.21938,.23786,.25651,.2753,.29419,.31315,.33215,.35115,.37015,.38913,.40806,.42694,.44576,.46449,.48313,.50167,.5201,.53839,.55653,.57448,.59222,.60971,.62692,.6438,.66033,.67648,.69221,.70753,.72242,.73688,.75093,.76456,.77779,.79063,.80309,.81517,.82686,.83817,.84911,.85967,.86987,.87972,.88924,.89845,.90734,.91594,.92425,.93229,.94005,.94754,.95475,.96166,.96826,.97451,.9804,.98588,.99092,.99549,.99957,.99685,.99381,.99131,.98936,.98796,.98711,.98681,.98706,.98787,.98923,.99113,.99357,.99654,1,.99607,.99171,.98695,.98181,.97634,.97057,.96452,.95824,.95175,.94506,.93818,.93113,.92389,.91647,.90887,.90109,.89314,.88501,.87672,.86831,.85978,.85119,.84256,.83393,.82533,.8168,.80836,.80002,.79181,.78374,.77582,.7681,.76059,.75331,.74629,.73955,.73311,.72697,.72116,.71568,.71054,.70572,.70121,.697,.69304,.68931,.68576,.68236,.67905,.67582,.67262,.66941,.66619,.66291,.65957,.65613,.65259,.64892,.6451,.6411,.6369,.63248,.62783,.62295,.61783,.61247,.60688,.60104,.59498,.58868,.58216,.57542,.56845,.56125,.5538,.5461,.53813,.52986,.52129,.51239,.50316,.49359,.4837,.47349,.46299,.45223,.44124,.43005,.41869,.40719,.39557,.38386,.37207,.36023,.34836,.33648,.32464,.31287,.30119,.28963,.27822,.26698,.25594,.2451,.23448,.22409,.21391,.20394,.19415,.18452,.17503,.16565,.15636,.14713,.13794,.1288,.11968,.11058,.10151,.09247,.08346,.07447,.06552,.05659,.0477,.03885,.03007,.02137,.01278,.00433,-.00393,-.012,-.01983,-.02738,-.03463,-.04155,-.0481,-.05429,-.0601,-.06553,-.07057,-.07524,-.07954,-.08347,-.08703,-.09022,-.09303,-.09544,-.09744,-.09898,-.10004,-.10059,-.1006,-.10005,-.09892,-.0972,-.09487,-.09192,-.08833,-.08409,-.07918,-.07357,-.06724,-.06019,-.0524,-.04386,-.03455,-.02448]},{distance:[-3.46259,-3.47131,-3.47668,-3.47863,-3.47712,-3.4721,-3.46352,-3.45138,-3.43566,-3.41635,-3.39347,-3.36704,-3.33709,-3.30368,-3.26684,-3.22667,-3.18322,-3.1366,-3.08689,-3.0342,-2.97865,-2.92036,-2.85946,-2.79607,-2.73034,-2.66241,-2.59242,-2.52052,-2.44686,-2.37159,-2.29485,-2.2168,-2.13757,-2.05731,-1.97616,-1.89426,-1.81174,-1.72875,-1.64543,-1.56191,-1.47833,-1.39483,-1.3115,-1.22847,-1.14581,-1.06361,-.98193,-.90083,-.82036,-.74054,-.66141,-.583,-.50532,-.4284,-.35228,-.277,-.20261,-.12916,-.05672,.01463,.08485,.15384,.22153,.28784,.35269,.41602,.47776,.53787,.59629,.653,.70799,.76123,.81274,.86253,.9106,.95698,1.0017,1.04477,1.0862,1.126,1.16415,1.20065,1.23546,1.26857,1.29994,1.32953,1.35731,1.38321,1.40719,1.42921,1.44922,1.46719,1.48309,1.49691,1.50862,1.51825,1.52581,1.53133,1.53486,1.53644,1.53616,1.53409,1.53031,1.52493,1.51803,1.50972,1.50009,1.48924,1.47725,1.46421,1.45019,1.43527,1.4195,1.40295,1.38568,1.36778,1.34929,1.3303,1.31087,1.29108,1.27099,1.25066,1.23018,1.2096,1.18898,1.16838,1.14785,1.12745,1.10721,1.08719,1.06741,1.04791,1.02871,1.00986,.99136,.97324,.95551,.93819,.92127,.90476,.88866,.87296,.85767,.84277,.82823,.81406,.80022,.7867,.77346,.76049,.74774,.73519,.72278,.71049,.69827,.68606,.67381,.66145,.64893,.63618,.62313,.60973,.5959,.5816,.56675,.5513,.53516,.51826,.50053,.4819,.46231,.44169,.42002,.39725,.37336,.34834,.32219,.2949,.2665,.23698,.20638,.17469,.14193,.10809,.07316,.03714,0,-.03827,-.07772,-.11836,-.16022,-.20332,-.24768,-.29332,-.34024,-.38844,-.43788,-.48854,-.54036,-.59329,-.64724,-.70211,-.75782,-.81425,-.87128,-.92881,-.98674,-1.04498,-1.10346,-1.1621,-1.22086,-1.27969,-1.33854,-1.3974,-1.45625,-1.51511,-1.57396,-1.63283,-1.69173,-1.75067,-1.80968,-1.86875,-1.9279,-1.98712,-2.04639,-2.10568,-2.16495,-2.22416,-2.28322,-2.34208,-2.40063,-2.4588,-2.51647,-2.57354,-2.62989,-2.68543,-2.74002,-2.79357,-2.84597,-2.89711,-2.94689,-2.99521,-3.04195,-3.087,-3.13023,-3.17152,-3.21075,-3.24779,-3.28252,-3.3148,-3.34451,-3.37154,-3.39577,-3.41709,-3.43539,-3.45059],pressure:[.87183,.87151,.87129,.87118,.87117,.87128,.87149,.87182,.87225,.8728,.87347,.87424,.87513,.87613,.87723,.87845,.87978,.88122,.88276,.88441,.88616,.88801,.88996,.892,.89414,.89637,.89868,.90108,.90356,.90611,.90874,.91144,.91421,.91704,.91993,.92287,.92587,.92892,.93201,.93514,.93831,.94151,.94474,.94799,.95126,.95456,.95786,.96118,.9645,.96783,.97116,.97448,.9778,.98111,.98441,.9877,.99096,.99421,.99742,.99938,.99622,.9931,.99001,.98697,.98397,.98101,.97811,.97526,.97246,.96972,.96703,.96441,.96185,.95935,.95691,.95455,.95225,.95002,.94786,.94577,.94376,.94182,.93995,.93817,.93646,.93483,.93328,.93181,.93042,.92911,.92788,.92673,.92566,.92467,.92376,.92293,.92217,.92149,.92088,.92034,.91987,.91947,.91913,.91886,.91864,.91849,.91838,.91833,.91834,.91839,.91849,.91863,.91883,.91907,.91935,.91968,.92005,.92046,.92092,.92142,.92195,.92253,.92314,.9238,.92449,.92521,.92598,.92677,.9276,.92847,.92936,.93029,.93125,.93224,.93325,.9343,.93537,.93646,.93758,.93872,.93988,.94106,.94225,.94346,.94469,.94593,.94718,.94844,.94971,.95098,.95226,.95354,.95482,.9561,.95738,.95867,.95995,.96122,.9625,.96377,.96504,.9663,.96757,.96883,.97009,.97135,.97261,.97387,.97513,.9764,.97767,.97895,.98023,.98153,.98284,.98416,.98549,.98684,.98821,.9896,.99101,.99244,.99389,.99537,.99688,.99842,1,.99839,.99675,.99508,.99336,.99161,.98982,.98799,.98613,.98422,.98228,.98029,.97827,.97622,.97414,.97202,.96987,.9677,.96551,.9633,.96107,.95882,.95656,.9543,.95202,.94975,.94747,.94519,.94292,.94065,.93838,.93613,.93388,.93164,.92941,.9272,.92499,.9228,.92062,.91846,.91631,.91418,.91207,.90998,.90792,.90588,.90387,.90189,.89995,.89804,.89617,.89434,.89256,.89083,.88914,.88752,.88595,.88443,.88299,.88161,.8803,.87907,.87791,.87683,.87584,.87494,.87412,.8734,.87278,.87225]},{distance:[.39335,.43437,.47737,.52234,.56923,.61801,.66864,.72109,.7753,.83123,.88882,.94801,1.00875,1.07097,1.13461,1.1996,1.26586,1.33333,1.40193,1.47158,1.54221,1.61373,1.68607,1.75913,1.83284,1.90711,1.98186,2.05699,2.13243,2.20809,2.28387,2.35971,2.4355,2.51117,2.58663,2.66179,2.73658,2.81092,2.88473,2.95792,3.03043,3.10217,3.17308,3.24309,3.31211,3.3801,3.44697,3.51267,3.57712,3.64028,3.70208,3.76247,3.8214,3.87881,3.93467,3.98892,4.04152,4.09244,4.14164,4.18908,4.23474,4.27859,4.32061,4.36077,4.39905,4.43544,4.46992,4.50249,4.53314,4.56185,4.58864,4.61349,4.63642,4.65745,4.67657,4.69381,4.7092,4.72274,4.73447,4.74441,4.75259,4.75903,4.76376,4.76682,4.76822,4.768,4.76618,4.76279,4.75786,4.75142,4.74348,4.73409,4.72326,4.71102,4.69739,4.68241,4.6661,4.64849,4.6296,4.60948,4.58816,4.56567,4.54204,4.51732,4.49154,4.46473,4.43694,4.4082,4.37854,4.348,4.31662,4.28443,4.25145,4.21773,4.1833,4.14819,4.11243,4.07606,4.03912,4.00162,3.96361,3.92512,3.88618,3.84683,3.80708,3.76697,3.72653,3.68579,3.64478,3.60351,3.56202,3.52033,3.47845,3.43642,3.39425,3.35196,3.30957,3.2671,3.22455,3.18196,3.13933,3.09668,3.05402,3.01136,2.96873,2.92613,2.88357,2.84108,2.79865,2.75631,2.71407,2.67195,2.62994,2.58807,2.54634,2.50477,2.46338,2.42216,2.38114,2.34032,2.29971,2.25933,2.21916,2.17923,2.13954,2.10008,2.06087,2.02189,1.98316,1.94468,1.90644,1.86845,1.83069,1.79316,1.75586,1.71877,1.68189,1.6452,1.60868,1.57232,1.53611,1.50004,1.46407,1.4282,1.39241,1.35668,1.321,1.28535,1.24972,1.2141,1.17849,1.14286,1.10723,1.07158,1.03593,1.00028,.96464,.92902,.89344,.85793,.8225,.78719,.75203,.71705,.68231,.64784,.61369,.57991,.54656,.51368,.48134,.44959,.41849,.3881,.35848,.32967,.30174,.27474,.24872,.22373,.19982,.17702,.15539,.13497,.11579,.09791,.08137,.06621,.05248,.04022,.02948,.02029,.01271,.00677,.00252,0,-76e-5,27e-5,.00314,.00788,.01451,.02307,.03357,.04604,.0605,.07697,.09546,.11599,.13858,.16322,.18992,.21869,.24952,.28241,.31735,.35434],pressure:[.95248,.95236,.95228,.95223,.95222,.95224,.95231,.95241,.95256,.95274,.95296,.95322,.95352,.95385,.95423,.95465,.9551,.9556,.95613,.9567,.95731,.95796,.95864,.95936,.96012,.96091,.96173,.96259,.96348,.9644,.96535,.96633,.96734,.96838,.96944,.97053,.97164,.97277,.97393,.9751,.97629,.9775,.97873,.97997,.98122,.98249,.98376,.98505,.98634,.98763,.98893,.99023,.99154,.99284,.99414,.99544,.99673,.99802,.9993,.99942,.99816,.99691,.99568,.99445,.99324,.99205,.99087,.98972,.98858,.98746,.98636,.98528,.98423,.9832,.98219,.98121,.98025,.97931,.9784,.97752,.97666,.97582,.97501,.97423,.97347,.97274,.97203,.97135,.9707,.97007,.96948,.9689,.96836,.96784,.96735,.96689,.96646,.96605,.96567,.96533,.965,.96471,.96445,.96421,.964,.96382,.96367,.96355,.96346,.96339,.96335,.96334,.96336,.9634,.96348,.96358,.9637,.96385,.96403,.96423,.96446,.96471,.96499,.96529,.96561,.96595,.96631,.96669,.96709,.96751,.96795,.9684,.96887,.96935,.96984,.97035,.97087,.9714,.97194,.97249,.97304,.97361,.97418,.97476,.97534,.97592,.97651,.97711,.9777,.9783,.9789,.9795,.9801,.9807,.9813,.9819,.9825,.98309,.98369,.98428,.98486,.98545,.98603,.98661,.98718,.98775,.98832,.98888,.98944,.99,.99056,.99112,.99167,.99223,.99279,.99335,.99392,.99449,.99507,.99565,.99624,.99684,.99745,.99807,.9987,.99934,1,.99933,.99866,.99797,.99727,.99656,.99583,.9951,.99435,.99359,.99283,.99205,.99126,.99046,.98966,.98885,.98803,.9872,.98637,.98554,.9847,.98387,.98303,.98219,.98134,.9805,.97967,.97883,.978,.97717,.97634,.97552,.97471,.97389,.97309,.97229,.9715,.97071,.96993,.96915,.96838,.96762,.96687,.96612,.96539,.96466,.96395,.96324,.96255,.96187,.9612,.96055,.95991,.95929,.95869,.95811,.95754,.957,.95648,.95599,.95552,.95508,.95467,.95428,.95393,.9536,.95331,.95305,.95283,.95264]},{distance:[2.85606,2.86149,2.86432,2.8645,2.862,2.85686,2.84912,2.83886,2.82618,2.81117,2.79393,2.77456,2.75314,2.72975,2.70447,2.67734,2.64844,2.61784,2.58564,2.55196,2.5169,2.48057,2.44305,2.40438,2.36462,2.32383,2.28208,2.23943,2.19591,2.15153,2.10628,2.06016,2.01321,1.96548,1.91702,1.86793,1.8183,1.76829,1.71803,1.66767,1.61737,1.56726,1.51746,1.46803,1.41902,1.37044,1.32228,1.27452,1.22716,1.18023,1.13376,1.08781,1.04244,.99769,.95357,.91003,.86701,.82447,.78238,.74069,.69938,.65836,.61758,.57699,.53656,.49627,.45611,.41611,.37632,.33683,.29776,.25924,.22141,.18441,.14839,.11346,.07972,.04727,.01619,-.01348,-.0417,-.0684,-.09351,-.11698,-.13875,-.1588,-.17713,-.19381,-.20889,-.22242,-.23444,-.24501,-.25421,-.26216,-.26897,-.27473,-.27951,-.28336,-.28631,-.28836,-.28948,-.28963,-.28873,-.28673,-.28355,-.27916,-.27354,-.26673,-.25878,-.2498,-.23992,-.22929,-.21802,-.20623,-.19398,-.18134,-.16836,-.1551,-.14163,-.12809,-.11461,-.1013,-.08826,-.07557,-.06335,-.0517,-.04077,-.03065,-.02143,-.01321,-.00606,0,.00496,.00888,.01181,.01385,.01511,.0157,.01574,.01533,.01458,.01358,.0124,.01112,.00979,.00851,.00738,.0065,.006,.00596,.00646,.00754,.00924,.01161,.01471,.01858,.02323,.02865,.03481,.04169,.0493,.05765,.06677,.07671,.08754,.09934,.11222,.12628,.14159,.15823,.17624,.19561,.21632,.23828,.26142,.28563,.31083,.33696,.36397,.39185,.42057,.4501,.48036,.51125,.54264,.5744,.60646,.63871,.67105,.70337,.73556,.76751,.79918,.83048,.86139,.8919,.92202,.95184,.98144,1.01094,1.04045,1.0701,1.10002,1.13029,1.16103,1.1923,1.22416,1.25664,1.28979,1.32364,1.35824,1.39363,1.42985,1.4669,1.50475,1.54332,1.58252,1.62227,1.6625,1.70312,1.744,1.78501,1.82598,1.8668,1.90734,1.94754,1.98732,2.02666,2.06555,2.10402,2.1421,2.17985,2.2173,2.25448,2.29139,2.328,2.36424,2.4,2.43515,2.46955,2.50309,2.53565,2.56717,2.59761,2.62692,2.65505,2.68191,2.7074,2.73138,2.75375,2.7744,2.79324,2.81017,2.82504,2.83772,2.8481],pressure:[.22758,.23641,.24578,.25568,.26609,.27699,.28835,.30016,.31237,.32495,.33789,.35113,.36466,.37843,.39241,.40658,.4209,.43535,.44989,.4645,.47916,.49385,.50853,.5232,.53784,.55243,.56696,.58141,.59578,.61004,.62419,.63821,.65209,.6658,.67934,.69268,.70582,.71873,.73139,.7438,.75594,.76779,.77935,.79061,.80156,.81221,.82254,.83258,.84231,.85176,.86091,.86978,.87837,.88669,.89473,.9025,.91,.91725,.92425,.931,.93752,.9438,.94985,.95566,.96124,.96658,.97168,.97652,.98109,.98539,.98939,.99309,.99646,.99949,.99783,.99552,.99361,.99209,.99098,.99029,.99003,.99019,.99079,.99181,.99324,.9951,.99735,1,.99698,.99361,.98992,.98592,.98163,.97709,.97231,.96731,.96212,.95676,.95122,.94554,.93973,.93378,.92773,.92157,.91532,.90899,.90258,.89612,.88961,.88308,.87653,.87,.8635,.85705,.85068,.8444,.83823,.83219,.82628,.82052,.81493,.80952,.8043,.79929,.7945,.78994,.78561,.78151,.77765,.77402,.77062,.76742,.76443,.76161,.75896,.75645,.75406,.75175,.74951,.7473,.74511,.74289,.74064,.73833,.73592,.73341,.73078,.728,.72507,.72197,.71869,.71522,.71156,.70769,.70363,.69936,.69489,.69021,.68533,.68023,.67492,.66939,.66363,.65765,.65145,.64501,.63833,.63143,.62428,.61691,.60931,.60148,.59344,.58521,.57679,.5682,.55948,.55063,.54167,.53264,.52354,.51439,.50522,.49603,.48686,.47773,.46865,.45964,.45072,.44192,.43324,.42469,.41629,.40804,.39994,.392,.3842,.37655,.36903,.36164,.35437,.3472,.34012,.33312,.3262,.31933,.31251,.30574,.299,.2923,.28563,.27899,.27239,.26583,.25933,.25288,.24652,.24025,.2341,.22808,.22221,.21653,.21104,.20576,.20072,.19592,.19138,.18712,.18313,.17943,.17602,.17292,.17013,.16766,.16551,.16369,.16222,.1611,.16036,.16001,.16007,.16055,.16148,.16286,.16471,.16705,.16988,.17321,.17706,.18144,.18636,.19182,.19785,.20443,.21158,.2193]},{distance:[-2.31317,-2.3191,-2.32189,-2.32154,-2.31811,-2.31174,-2.30254,-2.29062,-2.27609,-2.25904,-2.23954,-2.21767,-2.19355,-2.16732,-2.13907,-2.10885,-2.07672,-2.04268,-2.00677,-1.96911,-1.92985,-1.88914,-1.84713,-1.80397,-1.75979,-1.71467,-1.66864,-1.62171,-1.57395,-1.52546,-1.47625,-1.42628,-1.3755,-1.32384,-1.27131,-1.218,-1.16408,-1.10972,-1.05508,-1.00031,-.94551,-.89077,-.83615,-.7817,-.72757,-.6739,-.62076,-.56821,-.51625,-.46484,-.41397,-.36366,-.314,-.26506,-.21689,-.16957,-.12316,-.07766,-.03301,.01085,.05399,.09643,.13827,.17967,.22079,.26176,.30265,.34342,.38397,.42414,.46381,.50285,.54115,.57863,.61524,.65093,.6856,.71914,.75153,.78275,.81283,.84182,.86972,.89651,.92208,.94634,.96919,.99052,1.01025,1.02835,1.04484,1.05976,1.07309,1.08479,1.09492,1.1036,1.11096,1.11714,1.12224,1.12627,1.12916,1.13083,1.13125,1.13036,1.12816,1.12466,1.11992,1.11397,1.10677,1.09827,1.08849,1.07746,1.06527,1.05203,1.03786,1.02283,1.00695,.99025,.97279,.9546,.93573,.9163,.8965,.8765,.85647,.83652,.81687,.79775,.77939,.76199,.74568,.73049,.71635,.70316,.69082,.67925,.66834,.65804,.64831,.63911,.63032,.62184,.61363,.60564,.59788,.59036,.58308,.57597,.5689,.56177,.55447,.5469,.53896,.53062,.5219,.51283,.5034,.49355,.48335,.47287,.46223,.45154,.44085,.43012,.41923,.40805,.39648,.38441,.37176,.35849,.34458,.32999,.31461,.29833,.28109,.26288,.2437,.22361,.20265,.18082,.15807,.13434,.1096,.0838,.0569,.02894,0,-.0298,-.0604,-.09173,-.12364,-.15594,-.18843,-.22092,-.25331,-.28559,-.31781,-.35006,-.38244,-.41502,-.44785,-.48098,-.5144,-.54811,-.58218,-.61666,-.65153,-.68677,-.72232,-.75807,-.79397,-.83002,-.86628,-.90281,-.93968,-.97693,-1.01465,-1.05282,-1.09139,-1.13031,-1.16956,-1.20917,-1.24905,-1.28907,-1.32908,-1.36891,-1.40844,-1.44765,-1.48658,-1.52527,-1.56376,-1.60206,-1.64016,-1.67801,-1.71552,-1.75264,-1.78936,-1.8257,-1.86161,-1.89702,-1.93182,-1.96584,-1.99894,-2.03102,-2.06203,-2.0919,-2.12056,-2.14794,-2.17397,-2.19852,-2.22138,-2.24235,-2.26129,-2.27805,-2.29243,-2.30422],pressure:[.9681,.97424,.98046,.98674,.99309,.9995,.99404,.98754,.981,.97444,.96785,.96124,.95462,.94801,.94139,.93479,.92822,.92167,.91515,.90868,.90225,.89589,.88959,.88336,.87722,.87115,.86519,.85932,.85356,.84792,.84239,.83699,.83173,.8266,.82162,.81679,.81211,.80759,.80324,.79906,.79505,.79121,.78756,.78409,.78081,.77771,.77481,.77211,.76959,.76728,.76516,.76324,.76153,.76001,.75869,.75757,.75665,.75593,.7554,.75507,.75493,.75498,.75523,.75565,.75627,.75706,.75803,.75917,.76049,.76197,.76361,.76541,.76737,.76947,.77172,.77409,.7766,.77923,.78198,.78484,.7878,.79086,.79401,.79724,.80055,.80394,.8074,.81092,.8145,.81813,.82182,.82556,.82934,.83317,.83703,.84093,.84487,.84884,.85284,.85687,.86094,.86503,.86915,.87329,.87746,.88166,.88587,.89011,.89436,.89863,.90291,.9072,.91149,.91579,.92009,.92438,.92867,.93295,.9372,.94144,.94566,.94985,.954,.95812,.96219,.96623,.97021,.97415,.97802,.98184,.9856,.9893,.99293,.9965,1,.99657,.9932,.98991,.98668,.98352,.98042,.97738,.9744,.97148,.9686,.96577,.96298,.96023,.95751,.95482,.95214,.94949,.94684,.9442,.94156,.93892,.93627,.93361,.93094,.92825,.92555,.92284,.9201,.91735,.91458,.91179,.90899,.90616,.90332,.90047,.8976,.89472,.89183,.88893,.88603,.88314,.88024,.87735,.87448,.87162,.86878,.86597,.86319,.86044,.85774,.85508,.85247,.84993,.84744,.84503,.84269,.84042,.83825,.83616,.83417,.83227,.83048,.8288,.82724,.82578,.82445,.82324,.82215,.82119,.82037,.81967,.81911,.81868,.81839,.81824,.81823,.81835,.81862,.81903,.81957,.82026,.82109,.82206,.82317,.82443,.82583,.82737,.82906,.83089,.83287,.83499,.83726,.83968,.84223,.84494,.84778,.85077,.8539,.85717,.86058,.86412,.86781,.87163,.87559,.87968,.88391,.88826,.89275,.89737,.90211,.90698,.91198,.91709,.92233,.92768,.93315,.93873,.94441,.95019,.95607,.96205]},{distance:[4.72925,4.81721,4.9037,4.98859,5.07177,5.15311,5.23249,5.3098,5.38491,5.45772,5.52811,5.59598,5.66122,5.72375,5.78346,5.84028,5.8941,5.94486,5.99248,6.03689,6.07803,6.11584,6.15028,6.18128,6.20882,6.23285,6.25336,6.27031,6.28369,6.29348,6.29969,6.3023,6.30133,6.29678,6.28867,6.27703,6.26187,6.24324,6.22116,6.19567,6.16683,6.13468,6.09928,6.06068,6.01896,5.97417,5.92639,5.87569,5.82217,5.76589,5.70696,5.64545,5.58147,5.5151,5.44644,5.37559,5.30265,5.2277,5.15085,5.0722,4.99184,4.90987,4.82639,4.74151,4.65533,4.56794,4.47945,4.38996,4.29959,4.20843,4.11658,4.02416,3.93125,3.83796,3.74437,3.65057,3.55666,3.46272,3.36884,3.27509,3.18155,3.08831,2.99545,2.90303,2.81114,2.71984,2.62922,2.53933,2.45026,2.36207,2.27484,2.18862,2.10349,2.01951,1.93675,1.85528,1.77515,1.69644,1.61919,1.54348,1.46935,1.39685,1.32605,1.25698,1.18967,1.12417,1.06049,.99863,.93862,.88044,.82408,.76953,.71676,.66574,.61644,.56882,.52282,.47841,.43553,.39413,.35414,.31551,.27817,.24206,.20712,.17328,.14048,.10866,.07776,.04772,.01848,-.00999,-.03776,-.06487,-.09134,-.11721,-.14251,-.16725,-.19144,-.21509,-.2382,-.26076,-.28275,-.30416,-.32496,-.34511,-.36459,-.38334,-.40134,-.41852,-.43485,-.45026,-.46471,-.47815,-.49052,-.50179,-.51189,-.52081,-.52849,-.5349,-.54003,-.54383,-.54627,-.54734,-.54702,-.54528,-.54211,-.53752,-.53149,-.52403,-.51515,-.50487,-.4932,-.48015,-.46575,-.45001,-.43297,-.41463,-.39503,-.37419,-.35213,-.32887,-.30443,-.27885,-.25214,-.22432,-.19541,-.16544,-.13442,-.10235,-.06926,-.03514,0,.03616,.07336,.11159,.15088,.19125,.23272,.27531,.31906,.36401,.41019,.45764,.5064,.55651,.60802,.66096,.71538,.77129,.82874,.88776,.94836,1.01056,1.07438,1.13982,1.20687,1.27554,1.34581,1.41766,1.49107,1.56599,1.64239,1.72025,1.79951,1.88013,1.96209,2.04532,2.12979,2.21546,2.30226,2.39017,2.47911,2.56905,2.65991,2.75164,2.84416,2.93742,3.03133,3.12582,3.2208,3.31619,3.41191,3.50785,3.60393,3.70006,3.79612,3.89202,3.98765,4.08291,4.17767,4.27182,4.36525,4.45783,4.54944,4.63995],pressure:[.30942,.30838,.30765,.30724,.30715,.30738,.30795,.30884,.31007,.31164,.31354,.31578,.31837,.32129,.32455,.32815,.33209,.33636,.34097,.34591,.35117,.35675,.36265,.36887,.37539,.38221,.38933,.39674,.40442,.41238,.4206,.42907,.43779,.44675,.45593,.46533,.47493,.48473,.49471,.50486,.51517,.52563,.53623,.54694,.55777,.5687,.57971,.59079,.60194,.61313,.62435,.6356,.64686,.65811,.66935,.68056,.69174,.70286,.71391,.72489,.73579,.74659,.75728,.76785,.7783,.7886,.79876,.80877,.81861,.82827,.83776,.84706,.85617,.86507,.87378,.88227,.89056,.89863,.90649,.91412,.92153,.92872,.93568,.94241,.94892,.95519,.96122,.96702,.97258,.97791,.98299,.98783,.99242,.99677,.99911,.99525,.99164,.98827,.98515,.98228,.97966,.97728,.97514,.97324,.97159,.97017,.96898,.96801,.96727,.96674,.96641,.96629,.96635,.96661,.96703,.96762,.96838,.96928,.97032,.97149,.97279,.9742,.97572,.97734,.97905,.98085,.98273,.98468,.98669,.98877,.99091,.99311,.99535,.99765,1,.9976,.99516,.99267,.99014,.98755,.98491,.98222,.97947,.97666,.97378,.97083,.96781,.96471,.96153,.95826,.9549,.95144,.94787,.9442,.94042,.93651,.93249,.92834,.92407,.91966,.91512,.91045,.90564,.90069,.8956,.89037,.885,.87949,.87384,.86806,.86214,.85608,.84988,.84356,.83711,.83053,.82383,.81702,.81009,.80306,.79594,.78872,.78141,.77403,.76657,.75905,.75148,.74385,.73619,.72849,.72076,.71302,.70526,.69749,.68972,.68195,.67419,.66644,.65871,.65099,.64329,.63561,.62795,.62032,.61271,.60512,.59755,.59001,.58248,.57497,.56749,.56002,.55256,.54512,.5377,.5303,.52291,.51554,.50819,.50087,.49358,.48632,.4791,.47192,.4648,.45773,.45072,.44378,.43692,.43015,.42346,.41687,.41039,.40403,.39779,.39168,.38571,.37989,.37423,.36873,.36342,.35828,.35335,.34862,.34409,.3398,.33573,.3319,.32831,.32498,.32192,.31912,.3166,.31436,.31242,.31077]}]};function Aee(i){let e=null;for(const t of i){const n=t.type;if(r1t(t)){if(B(e))e=n;else if(e!==n)return"uber"}}return T(e)?e:"uber"}function Mee(i){let e=Vi.INVISIBLE;for(const{material:t}of i)if(Zme(t)){if(t.color[3]*t.opacity<1)return Vi.TRANSPARENT;e=Vi.OPAQUE}return e}function Pee(i){let e=Vi.INVISIBLE;for(const{material:t}of i)if(Zme(t)){switch(t.objectTransparency){case Vi.TRANSPARENT:case Vi.INVISIBLE:return Vi.TRANSPARENT;case Vi.OPAQUE:if(t.opacity<1)return Vi.TRANSPARENT}e=Vi.OPAQUE}return e}function Zme(i){return i.size*i.color[3]*i.opacity>0}function r1t(i){return i.size*i.color[3]>0}function Oee(i,e,t,n){for(let r=0;r<i.length;r++){const s=i[r].index,a=e[r],o=e[r+1];if(n)for(let l=a;l<o;l++){const c=n[l];t.set(c,s)}else for(let l=a;l<o;l++)t.set(l,s)}}let Kd=class extends et{constructor(e){super(e),this._updatingHandles=new wb,this._perObjectData=new Map,this._perObjectDataEvictionCache=new Set,this._renderers=new Map,this._gpuMemoryUsage=0,this._workerAbort=new AbortController,this._tmpModelPosition=q(),this._localOrigins=new Lbt(new O7(e.renderSR))}initialize(){this._worker=new e1t(this.schedule),this._componentColorManager=new zme(this.rctx,3);const e=l1e.createBuffer(4);for(let t=0;t<4;t++)e.sideness.set(t,0,t===0||t===3?0:1),e.sideness.set(t,1,t===0||t===1?0:1);this._verticesBufferObject=In.createVertex(this.rctx,kn.STATIC_DRAW,e.buffer)}destroy(){this.destroyed||(this._perObjectData.forEach(e=>this._discardObjectEntry(e)),this._perObjectData.clear(),this._strokesTexture=Ht(this._strokesTexture),this._componentColorManager=_t(this._componentColorManager),this._workerAbort.abort(),this._worker.destroy(),this._verticesBufferObject=Ht(this._verticesBufferObject),this._renderers.clear(),this._updatingHandles.destroy())}get updating(){return this._updatingHandles.updating}get usedMemory(){return this._gpuMemoryUsage}shouldRender(){return this._renderers.size>0}async addComponentObject(e,t,n,r,s,a,o,l){if(this.hasObject(e))return this.getObjectMemoryUsage(e);let c;const u=new Ree(new Promise(h=>c=h),n.center,n.radius);this._perObjectData.set(e,u);const d=await this._updatingHandles.addPromise(this._addComponentGeometry(t,u,r,s,a,o,l));return this.setNeedsRender(),c(),d}async addOrUpdateObject3D(e,t,n,r){if(this.destroyed)return void tt.getLogger(this.declaredClass).warn("Attempt to add an object to a destroyed instance");const s=this._perObjectData.get(e);let a;(s==null?void 0:s.renderables.length)>0&&this._perObjectDataEvictionCache.add(s);const o=e.boundingVolumeWorldSpace.bounds,l=new Ree(new Promise(u=>a=u),IB(o),cne(o));this._perObjectData.set(e,l);const c=new Array;if(n.mergeGeometries&&e.geometries.length>1&&a1t(e))c.push(this._addObjectMergedGeometries(e,l,t,n,r));else for(let u=0;u<e.geometries.length;u++){const d=e.geometryRecords[u];if(!d.material.supportsEdges)continue;const h=e.geometries[u];c.push(this._addGeometry(e,l,h,d,t[0],n,r))}await this._updatingHandles.addPromise(Promise.all(c)),this._perObjectDataEvictionCache.delete(l),this._discardObjectEntry(s),this.setNeedsRender(),a()}_discardObjectEntry(e){e&&(e.renderables.length&&(e.renderables.forEach(t=>this._removeRenderable(t)),this.setNeedsRender()),e.loaded=null)}hasObject(e){return this._perObjectData.has(e)}async updateAllComponentOpacities(e,t){const n=await this._updatingHandles.addPromise(this._getObjectEntry(e));if(B(n))return;const r=t instanceof Array?s=>t[s]:()=>t;n.renderables.forEach(s=>{const a=s.components.meta.length;for(let o=0;o<a;o++){const l=r(o),c=s.components.meta[o],u=c.index;c.material.opacity=l,s.components.buffer.textureBuffer.setDataElement(u,1,3,255*l)}this._updateTransparency(s)}),this.setNeedsRender()}async getObjectMemoryUsage(e){const t=await this._getObjectEntry(e);return T(t)?t.renderables.reduce((n,r)=>n+r.statistics.gpuMemoryUsage,0):0}async updateAllComponentMaterials(e,t,n,r){const s=e instanceof xg,a=!!n.hasSlicePlane,o=Aee(t),l=wI.getKey(o,a,s),c=await this._updatingHandles.addPromise(this._getObjectEntry(e));B(c)||(c.renderables.forEach(u=>{if(l!==u.rendererKey){const d=this._renderers.get(u.rendererKey),h=this._acquireRenderer(o,a,s);d.removeRenderable(u),--d.refCount,u.rendererKey=l,h.addRenderable(u)}for(let d=0;d<t.length;d++)u.components.meta[d].material=t[d];r&&this._updateComponentBuffer(u.components),this._updateTransparency(u)}),this.setNeedsRender())}async updateAllVerticalOffsets(e,t){const n=await this._updatingHandles.addPromise(this._getObjectEntry(e));B(n)||(n.renderables.forEach(r=>{const s=r.components.meta;for(let a=0;a<s.length;a++)r.components.meta[a].verticalOffset=(t==null?void 0:t[a])??0;this._updateComponentBuffer(r.components)}),this.setNeedsRender())}async updateObjectVisibility(e,t){const n=await this._updatingHandles.addPromise(this._getObjectEntry(e));T(n)&&(n.renderables.forEach(r=>r.visible=t),this.setNeedsRender())}removeObject(e){const t=this._perObjectData.get(e);t&&(this._perObjectData.delete(e),this._discardObjectEntry(t))}async _getObjectEntry(e){const t=this._perObjectData.get(e);if(!t)throw"no object";return await t.loaded,t.loaded==null?null:t}render(e,t){if(B(this._componentColorManager))return;this._localOrigins.updateViewMatrices(e.camera.viewMatrix);const n=e.camera.viewInverseTransposeMatrix,r=q(),s=new OD;let a=0,o=0;if(this._renderers.forEach(c=>{if(c.refCount===0)this._renderers.delete(c.key),c.dispose();else{let u=!0,d=!0;c.forEachRenderable(h=>{h.visible&&(a+=h.statistics.averageEdgeLength,o++,u&&h.regular&&(c.updateTechnique(e,!1),u=!1),d&&h.silhouette&&(c.updateTechnique(e,!0),d=!1))},t)}}),this._componentColorManager.garbageCollect(),this._componentColorManager.updateTextures(),o===0)return;const l=new kbt(40*a/o,t);je(r,n[3],n[7],n[11]),s.set(r),Ge(l.transformWorldFromViewTH,s.high),Ge(l.transformWorldFromViewTL,s.low),Um(l.transformViewFromCameraRelativeRS,e.camera.viewMatrix),cg(kee,l.transformViewFromCameraRelativeRS),IC(l.transformNormalViewFromGlobal,kee),l.transformProjFromView=e.camera.projectionMatrix,this._updateObjectCameraDistances(e),this._renderers.forEach(c=>{this._renderRegularEdges(c,e,l),this._renderSilhouetteEdges(c,e,l)})}_updateTransparency(e){const t=Mee(e.components.meta),n=Pee(e.components.meta);t===e.edgeTransparency&&n===e.objectTransparency||(e.edgeTransparency=t,e.objectTransparency=n,this._renderers.get(e.rendererKey).setRenderablesDirty())}_computeModelTransformWithLocalOrigin(e,t,n){e.getCombinedStaticTransformation(t,n);const r=T(t.origin)?this._localOrigins.register(t.origin):this._localOrigins.acquire(je(this._tmpModelPosition,n[12],n[13],n[14]));return t.origin=r.origin,Ibt(r.origin.vec3,n),r}_updateComponentBuffer(e){const{meta:t,buffer:n}=e,r=new Uint8Array(4);for(let s=0;s<t.length;s++){const a=t[s].material,o=t[s].index,l=lt(Math.round(a.size*Zbt),0,255),c=lt(a.extensionLength,-K4,255-K4)+K4,u=a.type==="solid"?aW.SOLID:aW.SKETCH,d=255*a.opacity,h=a.color,p=255*h[0],m=255*h[1],g=255*h[2],_=255*h[3];n.textureBuffer.setData(o,0,p,m,g,_),n.textureBuffer.setData(o,1,l,c,u,d),Nme(t[s].verticalOffset,r),n.textureBuffer.setData(o,2,r[0],r[1],r[2],r[3])}}_createComponentBuffers(e){if(B(this._componentColorManager))return null;const t=new Array,n=this._componentColorManager.getBuffer(e.length);for(let s=0;s<e.length;s++){const a=e[s],o=n.acquireIndex();t.push({index:o,verticalOffset:0,material:a})}const r=new o1t(n,t);return this._updateComponentBuffer(r),r}_extractEdges(e,t,n,r,s,a=s.length){return this._worker.process({data:t,indices:s,indicesLength:a,writerSettings:e,skipDeduplicate:n},this._workerAbort.signal,r)}_createRenderable(e,t,n,r,s){const a=T(this._verticesBufferObject)&&e.regular.lodInfo.lengths.length>0?new Iee(new lf(this.rctx,i5,{vertices:oW,instances:c1e.glLayout},{vertices:this._verticesBufferObject,instances:In.createVertex(this.rctx,kn.STATIC_DRAW,e.regular.instancesData.buffer)}),e.regular.lodInfo):null,o=T(this._verticesBufferObject)&&e.silhouette.lodInfo.lengths.length>0?new Iee(new lf(this.rctx,i5,{vertices:oW,instances:u1e.glLayout},{vertices:this._verticesBufferObject,instances:In.createVertex(this.rctx,kn.STATIC_DRAW,e.silhouette.instancesData.buffer)}),e.silhouette.lodInfo):null,l=(T(a)?a.vao.size:0)+(T(o)?o.vao.size:0);return new c1t(a,o,{gpuMemoryUsage:l,externalMemoryUsage:s,averageEdgeLength:e.averageEdgeLength},n,Mee(t.meta),Pee(t.meta),t,r)}async _addGeometry(e,t,n,r,s,a,o){const l=n.vertexAttributes.get(j.POSITION),c=n.indices.get(j.POSITION),u=St(),d=this._computeModelTransformWithLocalOrigin(e,r,u),h=new Dee(l,c,u,d);return this._addPositionData(t,h,n.edgeIndicesLength,s,a,o)}async _addPositionData(e,t,n,r,s,a=!1){if(e.loaded==null)return;const o=this._createComponentBuffers([r]);if(B(o)||n<=0)return;const l=this._acquireRenderer(r.type,!!s.hasSlicePlane,!0),{modelTransform:c,origin:u}=t,d=t.indices,h=t.position,p=h.data.length/h.size,m=t5.createBuffer(p);for(let b=0;b<p;b++)m.position.set(b,0,h.data[b*h.size+0]),m.position.set(b,1,h.data[b*h.size+1]),m.position.set(b,2,h.data[b*h.size+2]);Oee(o.meta,[0,m.componentIndex.count],m.componentIndex);const g=await this._updatingHandles.addPromise(this._extractEdges(l.writerSettings,m,!1,a,d,n));if(e.loaded==null)return;const _=this._createRenderable(g,o,new l1t(c,u),l.key,!1);e.renderables.push(_),l.addRenderable(_),this._gpuMemoryUsage+=_.statistics.gpuMemoryUsage}async _addComponentGeometry(e,t,n,r,s,a,o){if(t.loaded==null)return 0;const l=this._createComponentBuffers(a);if(B(l))return 0;const c=Aee(a),u=this._acquireRenderer(c,o.hasSlicePlane||!1,!1),d=t5.createBuffer(n.count);ore(d.position,n),Oee(l.meta,s,d.componentIndex,r);const h=!0,p=u.writerSettings,m=await this._updatingHandles.addPromise(this._extractEdges(p,d,h,!1,r));if(t.loaded==null)return 0;const g=this._createRenderable(m,l,e,u.key,!0);return t.renderables.push(g),u.addRenderable(g),g.statistics.gpuMemoryUsage}async _addObjectMergedGeometries(e,t,n,r,s){const a=new Map;let o=0,l=null,c=0;for(let x=0;x<e.geometries.length;x++){const w=e.geometries[x],C=e.geometryRecords[x];if(!C.material.supportsEdges)continue;!l&&C.origin&&(l=C);const S=w.vertexAttributes.get(j.POSITION);c+=S.data.length/S.size,o+=w.edgeIndicesLength}const u=c>=65536?Uint32Array:Uint16Array,d=o?new u(o):null,h=[];let p=0;for(let x=0;x<e.geometries.length;x++){const w=e.geometries[x];if(!e.geometryRecords[x].material.supportsEdges)continue;const C=w.vertexAttributes.get(j.POSITION),S=w.indices.get(j.POSITION);let E=a.get(C.data);if(E==null){E=h.length/3;for(let A=0;A<C.data.length;A+=C.size)h.push(C.data[A+0]),h.push(C.data[A+1]),h.push(C.data[A+2]);a.set(C.data,E)}if(S)for(let A=0;A<w.edgeIndicesLength;A++)d[p++]=E+S[A]}const m=l||e.geometryRecords[0],g=St(),_=this._computeModelTransformWithLocalOrigin(e,m,g);for(let x=0;x<e.geometryRecords.length;x++)e.geometryRecords[x].origin=_.origin;const b=new Dee({data:h,size:3},d,g,_);await this._updatingHandles.addPromise(this._addPositionData(t,b,d.length,n[0],r,s))}_acquireRenderer(e,t,n){const r=wI.getKey(e,t,n);let s=this._renderers.get(r);return B(this._strokesTexture)&&(this._strokesTexture=t1t(this.rctx)),s||(s=new wI(this.rctx,this.techniqueRepository,{type:e,hasSlicePlane:t,strokesTexture:this._strokesTexture,legacy:n,spherical:this.viewingMode===Ot.Global}),this._renderers.set(r,s)),++s.refCount,s}_removeRenderable(e){s1t(e);const t=this._renderers.get(e.rendererKey);if(t){t.removeRenderable(e),--t.refCount,"origin"in e.transform&&this._localOrigins.release(e.transform.origin),this._gpuMemoryUsage-=e.statistics.externalMemoryUsage?0:e.statistics.gpuMemoryUsage;for(const n of e.components.meta)e.components.buffer.releaseIndex(n.index)}}_updateObjectCameraDistances(e){const t=e.camera.eye,n=e.camera.viewForward,r=q(),s=a=>{pr(r,a.center,t);const o=dt(r,n),l=a.radius,c=o<-l?1/0:o<l?0:o-l;a.renderables.forEach(u=>u.distanceToCamera=c)};this._perObjectData.forEach(s),this._perObjectDataEvictionCache.forEach(s)}_renderRegularEdges(e,t,n){const r=e.bindRegularEdges(n,t),s=n.transparency,a=t.camera.perScreenPixelRatio;e.forEachRenderable(o=>{if(!$ee(o)||!o.visible)return;const l=PO(o.regular.lod.lengths,o.distanceToCamera,a);e.renderRegularEdges(r,o,n,t,l)},s)}_renderSilhouetteEdges(e,t,n){const r=e.bindSilhouetteEdges(n,t),s=n.transparency,a=t.camera.perScreenPixelRatio;e.forEachRenderable(o=>{if(!Lee(o)||!o.visible)return;const l=PO(o.silhouette.lod.lengths,o.distanceToCamera,a);e.renderSilhouetteEdges(r,o,n,t,l)},s)}get test(){return{hasRenderedPrimitives:e=>{let t=!1;const n=e.perScreenPixelRatio,r=(s,a)=>s.forEachRenderable(o=>{o.visible&&!t&&($ee(o)&&(t=PO(o.regular.lod.lengths,o.distanceToCamera,n)>0),!t&&Lee(o)&&(t=PO(o.silhouette.lod.lengths,o.distanceToCamera,n)>0))},a);return this._renderers.forEach(s=>{t||(r(s,Vi.OPAQUE),r(s,Vi.TRANSPARENT))}),t}}}};function s1t(i){T(i.regular)&&(i.regular.vao.vertexBuffers.instances.dispose(),i.regular.vao.dispose(!1),i.regular.vao=null),T(i.silhouette)&&(i.silhouette.vao.vertexBuffers.instances.dispose(),i.silhouette.vao.dispose(!1),i.silhouette.vao=null)}function a1t(i){let e=null,t=null;for(let n=0;n<i.geometries.length;n++){const r=i.geometryRecords[n];if(r.material.supportsEdges){if(e){if(!K0(e,r.transformation))return!1}else e=r.transformation;if(!t&&T(r.origin))t=r;else if(T(t==null?void 0:t.origin)&&T(r.origin)&&t.origin.id!==r.origin.id)return!1}}return!0}f([y({constructOnly:!0})],Kd.prototype,"rctx",void 0),f([y({constructOnly:!0})],Kd.prototype,"renderSR",void 0),f([y({constructOnly:!0})],Kd.prototype,"viewingMode",void 0),f([y({constructOnly:!0})],Kd.prototype,"techniqueRepository",void 0),f([y({constructOnly:!0})],Kd.prototype,"setNeedsRender",void 0),f([y({constructOnly:!0})],Kd.prototype,"schedule",void 0),f([y({readOnly:!0})],Kd.prototype,"_updatingHandles",void 0),f([y({readOnly:!0})],Kd.prototype,"updating",null),Kd=f([ge("esri.views.3d.webgl-engine.lib.edgeRendering.EdgeView")],Kd);let Ree=class{constructor(e,t,n){this.center=t,this.radius=n,this.renderables=new Array,this.loaded=e,this.loaded.then(()=>{this.loaded!=null&&(this.loaded=!0)})}},o1t=class{constructor(e,t){this.buffer=e,this.meta=t}},Iee=class{constructor(e,t){this.vao=e,this.lod=t}},l1t=class{constructor(e,t){this.modelMatrix=e,this.origin=t}},c1t=class{constructor(e,t,n,r,s,a,o,l){this.regular=e,this.silhouette=t,this.statistics=n,this.transform=r,this.edgeTransparency=s,this.objectTransparency=a,this.components=o,this.rendererKey=l,this.distanceToCamera=0,this.visible=!0}};function $ee(i){return T(i.regular)}function Lee(i){return T(i.silhouette)}function PO(i,e,t){const n=e*t,r=Tye(i,n,!0);return r===-1?n<i[0]?i.length:0:i.length-r}let Dee=class{constructor(e,t,n,r){this.position=e,this.indices=t,this.modelTransform=n,this.origin=r}};const kee=Ho();let Fee=class{constructor(e,t,n,r,s,a,o,l,c){this.createQuery=e,this.deleteQuery=t,this.resultAvailable=n,this.getResult=r,this.disjoint=s,this.beginTimeElapsed=a,this.endTimeElapsed=o,this.createTimestamp=l,this.timestampBits=c}},nm=!1;function u1t(i,e){if(e.disjointTimerQuery)return null;let t=i.getExtension("EXT_disjoint_timer_query_webgl2");return t&&zl(i)?new Fee(()=>i.createQuery(),n=>{i.deleteQuery(n),nm=!1},n=>i.getQueryParameter(n,i.QUERY_RESULT_AVAILABLE),n=>i.getQueryParameter(n,i.QUERY_RESULT),()=>i.getParameter(t.GPU_DISJOINT_EXT),n=>{nm||(nm=!0,i.beginQuery(t.TIME_ELAPSED_EXT,n))},()=>{i.endQuery(t.TIME_ELAPSED_EXT),nm=!1},n=>t.queryCounterEXT(n,t.TIMESTAMP_EXT),()=>i.getQuery(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):(t=i.getExtension("EXT_disjoint_timer_query"),t?new Fee(()=>t.createQueryEXT(),n=>{t.deleteQueryEXT(n),nm=!1},n=>t.getQueryObjectEXT(n,t.QUERY_RESULT_AVAILABLE_EXT),n=>t.getQueryObjectEXT(n,t.QUERY_RESULT_EXT),()=>i.getParameter(t.GPU_DISJOINT_EXT),n=>{nm||(nm=!0,t.beginQueryEXT(t.TIME_ELAPSED_EXT,n))},()=>{t.endQueryEXT(t.TIME_ELAPSED_EXT),nm=!1},n=>t.queryCounterEXT(n,t.TIMESTAMP_EXT),()=>t.getQueryEXT(t.TIMESTAMP_EXT,t.QUERY_COUNTER_BITS_EXT)):null)}function d1t(i,e){const t=i.capabilities.disjointTimerQuery;return B(t)?null:new h1t(t,e)}let h1t=class{constructor(e,t){this._timer=e,this._queryPool=new Array,this._queryResults=new Map,this._currentQuery=null,t.forEach(n=>{const r=this._timer.createQuery(),s=this._timer.createQuery();this._queryPool.push(r,s),this._queryResults.set(n,null)})}start(){nm||(this._currentQuery=this._queryPool.pop(),B(this._currentQuery)||(this._timer.disjoint(),this._timer.beginTimeElapsed(this._currentQuery)))}stop(e){if(this._timer.disjoint()||B(this._currentQuery)||!this._queryResults.has(e))return this.abort(),null;this._timer.endTimeElapsed();const t=this._queryResults.get(e);if(B(t))return this._queryResults.set(e,this._currentQuery),this._currentQuery=null,null;if(!this._timer.resultAvailable(t))return this._queryPool.unshift(this._currentQuery),this._currentQuery=null,null;const n=this._timer.getResult(t)/1e6;return this._queryPool.unshift(t),this._queryResults.set(e,this._currentQuery),this._currentQuery=null,n}abort(){T(this._currentQuery)&&(this._timer.deleteQuery(this._currentQuery),this._queryPool.unshift(this._timer.createQuery()),this._currentQuery=null)}dispose(){T(this._currentQuery)&&this._timer.deleteQuery(this._currentQuery),this._queryPool.forEach(e=>{this._timer.deleteQuery(e)}),this._queryResults.forEach(e=>{B(e)||this._timer.deleteQuery(e)})}};var zn;(function(i){i.OVERLAY="overlay",i.PREPARE="prepare",i.SHADOW_MAP="shadow map",i.LINEAR_DEPTH="linear depth",i.ACCUMULATED_SHADOWS="accumulated shadows",i.NORMALS="normals",i.OBJECT_AND_LAYER_ID_COLOR="object/layer id color",i.SSAO="SSAO",i.OPAQUE="opaque",i.OPAQUE_EDGES="opaque edges",i.VOXEL="voxel",i.TRANSPARENT="transparent",i.TRANSPARENT_EDGES="transparent edges",i.HUD_VISIBILITY="HUD visibility",i.TRANSPARENT_TERRAIN="transparent terrain",i.ENVIRONMENT="environment",i.LASER_LINE="laser line",i.OCCLUDED="occluded",i.ANTIALIASING="antialiasing",i.HIGHLIGHTS="highlights",i.HUD_OCCLUDED="HUD occluded",i.HUD_NOT_OCCLUDED="HUD not occluded",i.FINISH="finish"})(zn||(zn={}));const Nee="Total";let p1t=class{constructor(e){this._rctx=e,this._startTimeStampCPU=Wi(0),this._lastTimeStampCPU=Wi(0),this._totalCPUTime=new IM(Nee),this._cpuTimeSamplers=new Map(Object.values(zn).map(t=>[t,new IM(t)])),this._enableGPUTimer=0,this._totalGPUTime=new IM("GPU"),this._gpuTimeSamplers=new Map(Object.values(zn).map(t=>[t,new IM(t)])),this._totalTime=Wi(0),this._totalFrameCount=0}get totalCPUTimeSampler(){return this._totalCPUTime}get cpuTimeSamplers(){return Array.from(this._cpuTimeSamplers.values())}get totalGPUTimeSampler(){return this._totalGPUTime}get gpuTimeSamplers(){return Array.from(this._gpuTimeSamplers.values())}get gpuSamplingEnabled(){return T(this._gpuTimerPool)}get totalTime(){return this._totalTime}get totalFrameCount(){return this._totalFrameCount}get elapsedTime(){return Wi(performance.now()-this._startTimeStampCPU)}enableGPUPerformanceInfo(){if(B(this._gpuTimerPool)){const e=[...Object.values(zn),Nee];this._gpuTimerPool=d1t(this._rctx,e)}return B(this._gpuTimerPool)?{hasGPUTimerSupport:!1,remove:()=>{}}:(++this._enableGPUTimer,{hasGPUTimerSupport:!0,remove:oye(()=>{--this._enableGPUTimer,this._enableGPUTimer===0&&(this._gpuTimerPool=Ht(this._gpuTimerPool))})})}startFrame(){this._startTimeStampCPU=this._lastTimeStampCPU=Wi(performance.now()),T(this._gpuTimerPool)&&this._gpuTimerPool.start()}advance(e){const t=Wi(performance.now());if(this._cpuTimeSamplers.get(e).record(t-this._lastTimeStampCPU),this._lastTimeStampCPU=t,T(this._gpuTimerPool)){const n=this._gpuTimerPool.stop(e);this._gpuTimeSamplers.get(e).record(n),this._gpuTimerPool.start()}}finishFrame(){if(T(this._gpuTimerPool)){const t=this._gpuTimerPool.stop(zn.FINISH);this._gpuTimeSamplers.get(zn.FINISH).record(t)}const e=Wi(performance.now()-this._startTimeStampCPU);this._totalTime=Wi(this._totalTime+e),this._totalCPUTime.record(e),T(this._gpuTimerPool)&&this._totalGPUTime.record(this.gpuTimeSamplers.reduce((t,n)=>t+(n.last||0),0)),++this._totalFrameCount}};const Vee=.9;let rm=class extends et{constructor(e,t,n,r,s,a,o,l,c){super({}),this._materialRepository=e,this._shaderTechniqueRepository=n,this._rctx=r,this._compositingHelper=s,this._magnifierHelper=a,this._requestRender=o,this._stage=c,this._materialRenderers=new Map,this._needsTransparentPass=!1,this._hasHUDElements=!1,this._hasHighlights=!1,this._hasWater=!1,this._hasOverlayWater=!1,this._renderOverlay=u=>{},this._content=new Map,this._isRendering=!1,this._fallbackDepthStencilTexture=null,this._sliceHelper=new Cbt,this._antialiasing=!0,this._oitEnabled=!1,this._multipassTerrain=!0,this._terrainRenderingEnabled=!0,this._terrainTransparency=Ao.Opaque,this._waterReflectionEnabled=!1,this._hasAnimations=!1,this._animationTimestep=pee,this._handles=new mi,this._renderHiddenTransparentEdges=()=>{},this._oitUsed=!1,this._smaaPass=new zS(this._rctx,n),this._oitEnabled=this._hasOITSupport,this._requestRender(),this._offscreenRendering=new ebt(this._rctx,this._compositingHelper),this.performanceInfo=new p1t(this._rctx),this._shadowMap=new R7(this._rctx,c.viewingMode),this._ssaoHelper=new Ane(n,this._rctx,()=>this._requestRender()),this._highlight=new X0t(n,this._rctx),this._shadowHighlight=new xbt(this._rctx,c.viewingMode),this._shadowAccumulator=new yo(this._rctx,n,c,u=>{const d=this.shadowsEnabled;this._shadowMap.enabled=!0,this._prepare(u.camera,u.contentCamera),this._renderPlugins.prepareRender(),this._shadowMap.enabled=d},(u,d,h)=>{u.shadowMap.start(u.camera,d,h),this._renderShadowCascades(Re.Shadow,u.shadowMap),u.camera.setGLViewport(this._rctx),this._prepare(u.camera,u.contentCamera)},()=>this._requestRender()),this._renderContext=new bdt(this._rctx,this._offscreenRendering,this._shadowMap,this._ssaoHelper,this._sliceHelper),this._renderPlugins=new nbt({renderContext:this._renderContext,shaderTechniqueRepository:n,textureRep:t,materialRep:this._materialRepository,requestRender:this._requestRender,schedule:l}),this.renderPassManager=new V0t(this._rctx,this._shaderTechniqueRepository),this._renderPlugins.add(this.renderPassManager.slots(),this.renderPassManager),this._handles.add([ue(()=>this._stage.state.camera,()=>this._requestRender(),hn),ue(()=>cn.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES,u=>{this._renderHiddenTransparentEdges=u?()=>this._renderEdges(Vi.TRANSPARENT):()=>{},this._requestRender()},At)])}get _bindParameters(){return this._renderContext.bindParameters}get hasWater(){return this._hasWater||this._hasOverlayWater}get hasWaterReflection(){return this.hasWater&&this._waterReflectionEnabled}normalizeCtorArgs(){return{}}dispose(){this._handles.destroy(),this._smaaPass.dispose(),this._materialRenderers.forEach(e=>e.dispose()),this._materialRenderers.clear(),this._edgeView=_t(this._edgeView),this._offscreenRendering.dispose(),this._fallbackDepthStencilTexture=Ht(this._fallbackDepthStencilTexture),this._shadowMap.enabled=!1,this._shadowMap.dispose(),this._ssaoHelper.enabled=!1,this._ssaoHelper.dispose(),this._highlight.dispose(),this._shadowHighlight.dispose(),this._shadowAccumulator.dispose(),r1e.prune(),this._content.clear()}disposeOffscreenBuffers(){this._offscreenRendering.dispose(),this._shadowMap.dispose(),this._smaaPass.disable(),this._ssaoHelper.disposeOffscreenBuffers()}get updating(){return this._antialiasing&&this._smaaPass.updating||T(this._edgeView)&&this._edgeView.updating||this._shadowAccumulator.running||!this.isCameraFinal}ensureEdgeView(){return B(this._edgeView)&&(this._edgeView=new Kd({rctx:this._rctx,renderSR:this._stage.renderSR,viewingMode:this._stage.viewingMode,techniqueRepository:this._shaderTechniqueRepository,setNeedsRender:()=>this._requestRender(),schedule:e=>this._stage.resourceController.schedule(e)}),this._handles.add(ue(()=>Qa(this._edgeView,e=>e.updating),()=>this._requestRender(),on)),this._requestRender()),this._edgeView}get edgeView(){return this._edgeView}get isCameraFinal(){return D0e(this._bindParameters.ssr.reprojectionMatrix,Ks)}set _reprojectionMatrix(e){Sye(this._bindParameters.ssr.reprojectionMatrix,e)&&this.notifyChange("isCameraFinal")}get shadowsEnabled(){var e;return!!((e=this._shadowMap)!=null&&e.enabled)}setRenderParameters(e){const{_shadowMap:t,_ssaoHelper:n,_bindParameters:r}=this;if(e.screenSpaceReflectionsEnabled!==void 0&&r.ssr.enabled!==e.screenSpaceReflectionsEnabled&&(r.ssr.enabled=e.screenSpaceReflectionsEnabled,this._requestRender()),e.shadowMap!==void 0&&t.enabled!==e.shadowMap&&(t.enabled=e.shadowMap,this._requestRender()),e.shadowMapMaxCascades!==void 0&&t.maxCascades!==e.shadowMapMaxCascades&&(t.maxCascades=e.shadowMapMaxCascades,this._requestRender()),T(e.environment)){T(e.environment.weather)&&(this._bindParameters.weather=e.environment.weather,this._bindParameters.weatherVisible=e.weatherVisible),e.environment.lighting.ambientOcclusionEnabled!==void 0&&n.enabled!==e.environment.lighting.ambientOcclusionEnabled&&(n.enabled=e.environment.lighting.ambientOcclusionEnabled,this._requestRender()),e.environment.lighting.waterReflectionEnabled!==void 0&&this._waterReflectionEnabled!==e.environment.lighting.waterReflectionEnabled&&(this._waterReflectionEnabled=e.environment.lighting.waterReflectionEnabled,this._requestRender());const s=e.environment.lighting.type!=="virtual";r.enableFillLights!==s&&(r.enableFillLights=s,this._requestRender())}e.background&&this._offscreenRendering.background!==e.background&&(this._offscreenRendering.background=e.background,this._requestRender()),e.antialiasingEnabled!==void 0&&this._antialiasing!==e.antialiasingEnabled&&(this._antialiasing=e.antialiasingEnabled,this._requestRender()),e.highQualityTransparency!==void 0&&this._multipassTerrain!==e.highQualityTransparency&&(this._multipassTerrain=e.highQualityTransparency,this._oitEnabled=e.highQualityTransparency&&this._hasOITSupport,this._requestRender()),e.defaultHighlightOptions!==void 0&&(this._highlight.setDefaultOptions(e.defaultHighlightOptions),this._shadowHighlight.setDefaultOptions(e.defaultHighlightOptions),this._requestRender()),e.overlays!==void 0&&this._bindParameters.overlays!==e.overlays&&(this._bindParameters.overlays=e.overlays,this._requestRender()),e.hasOverlayWater!==void 0&&this._hasOverlayWater!==e.hasOverlayWater&&(this._hasOverlayWater=e.hasOverlayWater,this._requestRender()),e.renderOverlay!==void 0&&this._renderOverlay!==e.renderOverlay&&(this._renderOverlay=e.renderOverlay,this._requestRender()),e.slicePlane!==void 0&&this._sliceHelper.plane!==e.slicePlane&&(this._sliceHelper.plane=kt(e.slicePlane),this._requestRender()),e.terrainRenderingEnabled!==void 0&&this._terrainRenderingEnabled!==e.terrainRenderingEnabled&&(this._terrainRenderingEnabled=e.terrainRenderingEnabled,this._requestRender()),e.terrainTransparency!==void 0&&this._terrainTransparency!==e.terrainTransparency&&(this._terrainTransparency=e.terrainTransparency,this._requestRender()),e.shadowCastOptions!==void 0&&this._shadowAccumulator.setOptions(e.shadowCastOptions)}get hasSlicePlane(){return!!this._sliceHelper.plane}get renderPlugins(){return this._renderPlugins}get _hasOITSupport(){return this._rctx.driverTest.floatBufferBlendWorking}modify(e){this._isRendering&&console.warn("Renderer.modify called while rendering");const{adds:t,removes:n,updates:r}=e;if(t.length===0&&n.length===0&&r.length===0)return;n.forAll(({id:o})=>this._content.delete(o)),t.forAll(o=>this._content.set(o.id,o));const s=yfe(e);let a=!1;s.forEach((o,l)=>{let c=this._materialRenderers.get(l);if(!c){if(!(o.adds.length>0))return;c=new Cfe(this._rctx,this._materialRepository,l),this._materialRenderers.set(l,c)}c.modify(o),c.isEmpty&&(a=!0)}),a&&this._materialRenderers.forEach((o,l)=>{o.isEmpty&&(this._materialRenderers.delete(l),o.dispose())}),this._hasHighlights=ps(this._materialRenderers,o=>o.hasHighlights),this._bindParameters.hasOccludees=ps(this._materialRenderers,o=>o.hasOccludees),this._hasWater=ps(this._materialRenderers,o=>o.hasWater),this._hasHUDElements=ps(this._materialRenderers,o=>o.requiresSlot(at.LINE_CALLOUTS_HUD_DEPTH,Re.Color)||o.requiresSlot(at.HUD_MATERIAL,Re.Color)||o.requiresSlot(at.LABEL_MATERIAL,Re.Color)),this._requestRender()}updateAnimation(e){return this._hasAnimations=!1,this._materialRenderers.forEach(t=>this._hasAnimations=t.updateAnimation(e)||this._hasAnimations),this._hasAnimations=this._renderPlugins.updateAnimation(e)||this._hasAnimations,this._hasAnimations}get animationTimestep(){return this._animationTimestep}render(e,t,n,r,s){this._isRendering=!0;const{camera:a,contentCamera:o}=n;this._renderContext.time=s,this.performanceInfo.startFrame(),this._renderOverlay(s),this.performanceInfo.advance(zn.OVERLAY),this._bindParameters.transparencyPassType=ln.NONE;const l=this._offscreenRendering;l.setupRenderTarget(this.hasWaterReflection);const c=wg(this._sliceHelper.plane);r===y2.OFF&&(this._sliceHelper.plane=null),this._rctx.bindFramebuffer(e),a.setGLViewport(this._rctx),this._prepare(a,o),this._renderPlugins.prepareRender(),this.performanceInfo.advance(zn.PREPARE);const u=this._computeDepthRange(a);this._renderShadowMap(e,a,this._bindParameters.lighting.mainLight.direction,u),this.performanceInfo.advance(zn.SHADOW_MAP),l.initializeFrame(a),this._ensureBindParameters(a,o),this._renderLinearDepth(),this.performanceInfo.advance(zn.LINEAR_DEPTH),this._accumulateShadows(u,a,o),this.performanceInfo.advance(zn.ACCUMULATED_SHADOWS),this._renderNormal(),this.performanceInfo.advance(zn.NORMALS),this._ensureBindParametersSSR(),this._renderSSAO(),this.performanceInfo.advance(zn.SSAO),this._renderContext.output=Re.Color,l.bindFramebuffer(),this._renderOpaqueGeometry(),this.performanceInfo.advance(zn.OPAQUE);const d=this._terrainRenderingEnabled&&this._terrainTransparency!==Ao.Opaque,h=this._multipassTerrain&&d;this._renderTerrainLinearDepth(h),this._setMultipassEnabled(h),this._setTerrainCulling(h),this._renderEdges(Vi.OPAQUE),this.performanceInfo.advance(zn.OPAQUE_EDGES),this._offscreenRendering.bindTarget(this._offscreenRendering.currentColorTarget,this._offscreenRendering.mainDepth),this._renderSlot(at.VOXEL),this.performanceInfo.advance(zn.VOXEL),this._renderHiddenTransparentEdges();const p=this._needsTransparentPass||this._renderPlugins.needsTransparentPass;p&&(this._oitEnabled?this._renderOrderIndependentTransparency(()=>this._renderTransparentGeometry(),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(zn.TRANSPARENT),this._renderGeometryLinearDepth(h);const m=this._renderHUDVisibility(this._multipassTerrain&&d);h||this._renderInternalSlot(at.LINE_CALLOUTS),this.performanceInfo.advance(zn.HUD_VISIBILITY),this._renderObjectAndLayerIdColor(t),this.performanceInfo.advance(zn.OBJECT_AND_LAYER_ID_COLOR),this._renderEdges(Vi.TRANSPARENT,h),this.performanceInfo.advance(zn.TRANSPARENT_EDGES),this._renderTransparentTerrain(),d&&m&&(h?this._renderLineCallouts(Tf.Occluded):l.compositeTransparentTerrainOntoHUDVisibility(this._bindParameters),this._renderHUD(Tf.Occluded,l.framebuffer),this.performanceInfo.advance(zn.HUD_OCCLUDED)),this.performanceInfo.advance(zn.TRANSPARENT_TERRAIN),this._setTerrainCulling(!1),d&&(l.compositeTransparentTerrainOntoMain(this._bindParameters),h&&(this._renderEdges(Vi.OPAQUE),this.performanceInfo.advance(zn.OPAQUE_EDGES),p&&(this._oitEnabled?this._renderOrderIndependentTransparency(()=>this._renderTransparentGeometry(),!1):this._renderTransparentGeometry()),this.performanceInfo.advance(zn.TRANSPARENT),this._renderEdges(Vi.TRANSPARENT),this.performanceInfo.advance(zn.TRANSPARENT_EDGES))),h&&this._renderLineCallouts(Tf.NotOccluded),this._setMultipassEnabled(!1),this._shadowAccumulator.render(this._bindParameters),l.renderToTargets(()=>{this._renderInternalSlot(at.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),this._renderSlot(at.POSTPROCESSING_ENVIRONMENT_TRANSPARENT),this._renderSlot(at.LASERLINES)},l.currentColorTarget,l.mainDepth),this.performanceInfo.advance(zn.ENVIRONMENT),this._renderPlugins.needsLaserlineWithContrastControl&&l.renderTmpAndCompositeToMain(()=>this._renderSlot(at.LASERLINES_CONTRAST_CONTROL),this._bindParameters,Ro.PremultipliedAlpha),this.performanceInfo.advance(zn.LASER_LINE),this._renderOccluded(),this.performanceInfo.advance(zn.OCCLUDED);const g=r===y2.ON&&this._magnifierHelper.enabled,_=g&&B(e)?this._offscreenRendering.getFramebuffer(this._offscreenRendering.tmpColor,this._offscreenRendering.tmpDepth):e;this._rctx.bindFramebuffer(_);const b=this._offscreenRendering.colorTexture;!this._renderAntiAliasing(b)&&T(b)&&this._compositingHelper.composite(this._bindParameters,b,Ro.None),this.performanceInfo.advance(zn.ANTIALIASING),this._renderHUD(Tf.NotOccluded,_),this.performanceInfo.advance(zn.HUD_NOT_OCCLUDED),this._renderHighlights(_,this._bindParameters),this.performanceInfo.advance(zn.HIGHLIGHTS),g&&this._magnifierHelper.render(this._rctx,this._bindParameters),_!==e&&(this._rctx.bindFramebuffer(e),this._compositingHelper.composite(this._bindParameters,this._offscreenRendering.tmpColorTexture,Ro.None)),this._disposeOITBuffers(),this._renderContext.lastFrameCamera.copyFrom(this._bindParameters.camera),this._sliceHelper.plane=c,this._isRendering=!1,this.onPostRender&&this.onPostRender(),this.performanceInfo.finishFrame()}_renderObjectAndLayerIdColor(e){T(e)&&Fi("enable-feature:objectAndLayerId-rendering")&&(this._rctx.bindFramebuffer(e),this._offscreenRendering.renderToFBO(()=>this._renderGeometryAndTransparentTerrainPass(Re.ObjectAndLayerIdColor),[0,0,0,0],!0,!0),this._rctx.bindFramebuffer(e),this._offscreenRendering.renderToFBO(()=>{this._bindParameters.renderTransparentlyOccludedHUD=Tf.NotOccluded,this._renderInternalSlot(at.HUD_MATERIAL)},null,!0,!0))}finish(e){if(this._hasAnimations||(this._animationTimestep=Wi(0)),e===ds.BACKGROUND){let t=0;this.performanceInfo.gpuSamplingEnabled?t=this.performanceInfo.totalGPUTimeSampler.last:this._rctx.gl.getError();const n=this.performanceInfo.elapsedTime,r=Math.max(n,t),s=lt(r/k0t,N0t,pee);this._animationTimestep=Wi(this._animationTimestep*Vee+s*(1-Vee))}}readDepthPixels(e,t,n){const r=this._offscreenRendering.bindTarget(this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth);if(!this._needsLinearDepth){this._ensureBindParameters(e,e),this._bindParameters.camera.setGLViewport(this._rctx),this._rctx.setClearColor(0,0,0,0);const s=hr.COLOR_BUFFER_BIT|hr.DEPTH_BUFFER_BIT|hr.STENCIL_BUFFER_BIT;this._rctx.clearSafe(s),this._renderGeometryAndTransparentTerrainPass(Re.Depth)}r.readPixels(t[0],t[1],t[2],t[3],Ui.RGBA,un.UNSIGNED_BYTE,n)}readHUDVisibility(e,t,n,r,s){this._offscreenRendering.bindTarget(this._offscreenRendering.hudVisibility).readPixels(e,t,n,r,Ui.RGBA,un.UNSIGNED_BYTE,s)}readAccumulatedShadow(e,t){return this._shadowAccumulator.readAccumulatedShadow(e,t)}_setMultipassEnabled(e){this._bindParameters.multipassTerrain.enabled=this._bindParameters.multipassGeometry.enabled=e}_setTerrainCulling(e){this._bindParameters.multipassTerrain.cullAboveGround=e}_renderSlot(e){this._bindParameters.slot=e,this._renderPlugins.render()}_renderEdges(e,t=!1){const n=this._edgeView;T(n)&&n.shouldRender()&&this._offscreenRendering.renderTmpAndCompositeToMain(()=>n.render(this._bindParameters,e),this._bindParameters,Ro.Alpha,t)}_renderShadowMap(e,t,n,r){const s=this._shadowMap;s.enabled&&(s.start(t,n,r),this._shadowHighlight.updateParameters(t,n),this._needsShadowHighlight?(this._renderShadowCascades(Re.ShadowHighlight,this._shadowMap,a=>s.takeCascadeSnapshotTo(a,bC.Highlight)),s.clear(),this._renderShadowCascades(Re.ShadowExludeHighlight,this._shadowMap,a=>{s.takeCascadeSnapshotTo(a,bC.Default),this._renderGeometryAndTransparentTerrainPass(Re.ShadowHighlight)})):this._renderShadowCascades(Re.Shadow),s.finish(e),t.setGLViewport(this._rctx))}_renderShadowCascades(e,t=this._shadowMap,n=r=>{}){for(const r of t.getCascades())r.camera.setGLViewport(this._rctx),this._prepare(r.camera,r.camera),this._renderGeometryAndTransparentTerrainPass(e),n(r)}get _needsLinearDepth(){return this._ssaoHelper.ready||this._renderPlugins.needsLinearDepth||this._hasWater&&this._waterReflectionEnabled||this._needsShadowHighlight||this._needsShadowCast}_renderLinearDepth(){this._needsLinearDepth?this._offscreenRendering.renderToTargets(()=>this._renderGeometryAndTransparentTerrainPass(Re.Depth),this._offscreenRendering.linearDepth,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.linearDepth),this._bindParameters.linearDepthTexture=this._offscreenRendering.linearDepthTexture}_renderTerrainLinearDepth(e){if(e){const t=this._renderContext.output;this._renderContext.output=Re.Depth,this._offscreenRendering.renderToTargets(()=>this._renderTransparentTerrain(),this._offscreenRendering.terrainLinearDepth,this._offscreenRendering.tmpDepth,[-1e10,-1e10,-1e10,1],!0,!0),this._renderContext.output=t}else this._offscreenRendering.disposeTarget(this._offscreenRendering.terrainLinearDepth);this._bindParameters.multipassTerrain.linearDepthTexture=this._offscreenRendering.terrainLinearDepthTexture}_renderGeometryLinearDepth(e){if(e){const t=this._renderContext.output;this._offscreenRendering.renderToTargets(()=>this._renderGeometryPass(Re.Depth),this._offscreenRendering.geometryLinearDepth,this._offscreenRendering.tmpDepth,[1,1,1,1],!0,!0),this._renderContext.output=t}else this._offscreenRendering.disposeTarget(this._offscreenRendering.geometryLinearDepth);this._bindParameters.multipassGeometry.linearDepthTexture=this._offscreenRendering.geometryLinearDepthTexture}get _needsNormal(){return this._ssaoHelper.ready}_renderNormal(){this._needsNormal?this._offscreenRendering.renderToTargets(()=>{this._renderGeometryAndTransparentTerrainPass(Re.Normal)},this._offscreenRendering.normal,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0):this._offscreenRendering.disposeTarget(this._offscreenRendering.normal)}get _needsDepthRange(){return this._shadowMap.enabled||this._needsShadowCast}_computeDepthRange(e){if(!this._needsDepthRange)return m8;const t=_0t(e,this._content,this._stage.layers);return CC(t,this.renderPlugins.queryDepthRange(e)),t.near=Math.max(e.near,t.near),t.far=Math.min(e.far,t.far),t}_renderGeometryAndTransparentTerrainPass(e){this._renderContext.output=e,this._renderGeometryPass(e),this._renderTransparentTerrain()}_renderGeometryPass(e){this._renderContext.output=e,this._renderOpaqueGeometry(),this._renderTransparentGeometry()}_renderSSAO(){this._ssaoHelper.loading?this._requestRender():this._ssaoHelper.computeSSAO(this._bindParameters,this._offscreenRendering.linearDepthTexture,this._offscreenRendering.normalTexture)}_renderOpaqueGeometry(){this._renderSlot(at.INTEGRATED_MESH),this._renderSlot(at.OPAQUE_TERRAIN),this._renderInternalSlot(at.OPAQUE_MATERIAL),this._renderSlot(at.OPAQUE_MATERIAL),this._renderSlot(at.POSTPROCESSING_ENVIRONMENT_OPAQUE)}_renderTransparentGeometry(){this._renderInternalSlot(at.TRANSPARENT_MATERIAL),this._renderSlot(at.TRANSPARENT_MATERIAL)}_renderTransparentTerrain(){this._renderSlot(at.TRANSPARENT_TERRAIN)}_renderHUDVisibility(e){let t=!1;return this._renderContext.offscreenRenderingHelper&&this._renderContext.offscreenRenderingHelper.renderHUDVisibility(()=>{this._bindParameters.hudVisibilityTexture=this._renderContext.offscreenRenderingHelper.hudVisibilityTexture,t=this._renderInternalSlot(at.OCCLUSION_PIXELS)},e),t}_renderLineCallouts(e){this._bindParameters.renderTransparentlyOccludedHUD=e,e===Tf.Occluded?this._offscreenRendering.renderToTargets(()=>this._renderInternalSlot(at.LINE_CALLOUTS),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this._renderInternalSlot(at.LINE_CALLOUTS)}_renderHUD(e,t){this._hasHUDElements&&(this._oitEnabled?(this._renderOrderIndependentTransparency(()=>this._renderHUDElements(e),!0),this._rctx.bindFramebuffer(t),this._compositingHelper.composite(this._bindParameters,this._offscreenRendering.hudColorTexture,Ro.PremultipliedAlpha)):e===Tf.Occluded?this._offscreenRendering.renderToTargets(()=>this._renderHUDElements(Tf.Occluded),this._offscreenRendering.currentColorTarget,this._offscreenRendering.tmpDepth,void 0,!0,!0):this._renderHUDElements(e))}_renderHUDElements(e){this._bindParameters.renderTransparentlyOccludedHUD=e,this._renderInternalSlot(at.LINE_CALLOUTS_HUD_DEPTH),this._renderInternalSlot(at.HUD_MATERIAL),this._renderInternalSlot(at.LABEL_MATERIAL)}get _needsHighlight(){return this._hasHighlights||this._renderPlugins.needsHighlight}get _needsShadowHighlight(){return this._shadowMap.enabled&&this._shadowHighlight.isVisible&&this._needsHighlight}_renderHighlights(e,t){if(!this._needsHighlight)return void this._offscreenRendering.disposeTarget(this._offscreenRendering.highlight);const n=this._highlight,r=this._offscreenRendering.renderToTargets(()=>{this._renderGeometryAndTransparentTerrainPass(Re.Highlight),this._rctx.clearSafe(hr.DEPTH_BUFFER_BIT),this._renderHUDElements(Tf.Both)},this._offscreenRendering.highlight,this._offscreenRendering.tmpDepth,[0,0,0,0],!0,!0);this._bindParameters.highlightColorTexture=r.colorTexture,this._needsShadowHighlight&&this._shadowHighlight.render(t,e),n.render(this._bindParameters,r,e)}get _needsShadowCast(){return this._shadowAccumulator.isAccumulating}_accumulateShadows(e,t,n){this._needsShadowCast&&this._shadowAccumulator.renderAccumulation(this._offscreenRendering.linearDepthTexture,e,t,n)}_renderOrderIndependentTransparency(e,t){const n=s=>{this._bindParameters.transparencyPassType=s,this._offscreenRendering.renderOITPass(()=>e(),s,t)},r=this._renderContext.output;this._renderContext.output=Re.Alpha,n(ln.Alpha),this._renderContext.output=Re.Color,n(ln.Color),n(ln.FrontFace),this._offscreenRendering.compositeTransparentOntoOpaque(this._bindParameters,t),this._bindParameters.transparencyPassType=ln.NONE,this._renderContext.output=r,this._oitUsed=!0}_disposeOITBuffers(){this._oitUsed||(this._offscreenRendering.disposeTarget(this._offscreenRendering.alphaFloatTarget),this._offscreenRendering.disposeTarget(this._offscreenRendering.colorFloatTarget),this._offscreenRendering.disposeTarget(this._offscreenRendering.frontFaceTarget)),this._oitUsed=!1}_renderOccluded(){let e=0;this._materialRenderers.forEach((a,o)=>{o&&o.isVisible()&&o.renderOccluded===Qr.OccludeAndTransparentStencil&&(e|=o.renderOccluded,nS.push(o))});const t=this._offscreenRendering,n=(a,o,l,c,u)=>{e&o&&(t.renderToTargets(l,t.tmpColor,t.mainDepth,[0,0,0,0],c,u),t.compositeOccludedOntoMain(this._bindParameters,a))};nS.length!==0&&(this._renderInternalSlot(at.OCCLUDER_MATERIAL,nS),n(.5,Qr.OccludeAndTransparentStencil,()=>this._renderInternalSlot(at.TRANSPARENT_OCCLUDER_MATERIAL,nS),!1,!1),nS.length=0),this._materialRenderers.forEach((a,o)=>{o&&o.isVisible()&&(o.renderOccluded===Qr.OccludeAndTransparent||o.renderOccluded===Qr.Transparent||o.renderOccluded===Qr.Opaque)&&(e|=o.renderOccluded,iS.push(o))});const r=this._renderPlugins.renderOccludedFlags;if(e|=r,!e)return;const s=a=>{this._renderContext.renderOccludedMask=a,r>Qr.Occlude&&this._renderSlot(at.OCCLUDED_TERRAIN),this._renderInternalSlot(at.OPAQUE_MATERIAL,iS),this._renderInternalSlot(at.TRANSPARENT_MATERIAL,iS),this._renderInternalSlot(at.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,iS),this._renderContext.resetRenderOccludedMask()};this._renderContext.output=Re.Color,n(.5,Qr.OccludeAndTransparent,()=>s(Qr.OccludeAndTransparent),!0,sE.OutlineVisualElementMask),n(.5,Qr.Transparent,()=>s(Qr.Transparent),!0,sE.OutlineVisualElementMask),n(1,Qr.Opaque,()=>s(Qr.Opaque),!0,sE.OutlineVisualElementMask),iS.length=0}_renderAntiAliasing(e){if(this._antialiasing){if(this._smaaPass.enable(()=>this._requestRender())&&T(e))return this._smaaPass.render(e),!0}else this._smaaPass.disable();return!1}_prepare(e,t){this._needsTransparentPass=ps(this._materialRenderers,n=>n.requiresSlot(at.TRANSPARENT_MATERIAL,Re.Color)),this._bindParameters.camera=e,this._bindParameters.contentCamera=t}_ensureBindParameters(e,t){this._bindParameters.camera=e,this._bindParameters.contentCamera=t;const n=this._renderContext.offscreenRenderingHelper;this._bindParameters.hudVisibilityTexture=n.hudVisibilityTexture,this._bindParameters.mainColorTexture=n.mainColorTexture,this._bindParameters.highlightDepthTexture=n.depthTexture??this._getFallbackDepthTexture()}_ensureBindParametersSSR(){this.hasWaterReflection?(this._renderContext.lastFrameCamera.equals(this._bindParameters.camera)?this._reprojectionMatrix=Ks:(Da(zee,this._bindParameters.camera.viewMatrix),Da(Bee,this._bindParameters.camera.projectionMatrix),Vs(B1,zee,Bee),Vs(B1,this._renderContext.lastFrameCamera.viewMatrix,B1),Vs(B1,this._renderContext.lastFrameCamera.projectionMatrix,B1),this._reprojectionMatrix=B1),this._bindParameters.ssr.lastFrameColorTexture=this._offscreenRendering.lastFrameColorTexture):this._bindParameters.ssr.lastFrameColorTexture=null,this._bindParameters.ssr.enabled=this.hasWaterReflection}_renderInternalSlot(e,t){let n=!1;return this._bindParameters.slot=e,T(t)?t.forEach(r=>{if(!r.shouldRender(this._renderContext))return;const s=this._materialRenderers.get(r);T(s)&&(n=s.render(this._renderContext.output,this._bindParameters)||n)}):this._materialRenderers.forEach((r,s)=>{s.shouldRender(this._renderContext)&&r.render(this._renderContext.output,this._bindParameters)&&(n=!0)}),n}_getFallbackDepthTexture(){return this._fallbackDepthStencilTexture||(this._fallbackDepthStencilTexture=Ine(this._rctx)),this._fallbackDepthStencilTexture}get gpuMemoryUsage(){var e,t,n,r,s;return{offscreen:((e=this._offscreenRendering)==null?void 0:e.gpuMemoryUsage)??0,highlights:(((t=this._highlight)==null?void 0:t.gpuMemoryUsage)??0)+(((n=this._shadowHighlight)==null?void 0:n.gpuMemoryUsage)??0),shadows:((r=this._shadowMap)==null?void 0:r.gpuMemoryUsage)??0,ssao:((s=this._ssaoHelper)==null?void 0:s.gpuMemoryUsage)??0}}get test(){const e=this;return{offscreen:this._offscreenRendering,shadowMap:this._shadowMap,ssao:this._ssaoHelper,highlight:this._highlight,lighting:this._bindParameters.lighting,materialRenderers:this._materialRenderers,shadowAccumulator:this._shadowAccumulator,weatherIsFading:this._bindParameters.cloudsFade.isFading,getFramebufferTexture:t=>{switch(t){case Nv.Color:return e._offscreenRendering.colorTexture;case Nv.LinearDepth:return e._offscreenRendering.linearDepthTexture;case Nv.Normals:return e._offscreenRendering.normalTexture;case Nv.ShadowMap:return e._shadowMap.depthTexture;case Nv.HudVisibility:return e._offscreenRendering.hudVisibilityTexture;case Nv.Highlight:return e._offscreenRendering.highlightTexture}}}}};var Nv;f([y()],rm.prototype,"_shadowAccumulator",void 0),f([y()],rm.prototype,"_smaaPass",void 0),f([y()],rm.prototype,"_antialiasing",void 0),f([y()],rm.prototype,"_edgeView",void 0),f([y()],rm.prototype,"updating",null),f([y()],rm.prototype,"isCameraFinal",null),rm=f([ge("esri.views.3d.webgl-engine.lib.Renderer")],rm),function(i){i[i.Color=0]="Color",i[i.LinearDepth=1]="LinearDepth",i[i.Normals=2]="Normals",i[i.ShadowMap=3]="ShadowMap",i[i.HudVisibility=4]="HudVisibility",i[i.Highlight=5]="Highlight"}(Nv||(Nv={}));const iS=[],nS=[],Bee=St(),zee=St(),B1=St();let Uee=class{constructor(){this.blend=!1,this.blendColor={r:0,g:0,b:0,a:0},this.blendFunction={srcRGB:vt.ONE,dstRGB:vt.ZERO,srcAlpha:vt.ONE,dstAlpha:vt.ZERO},this.blendEquation={mode:m2.ADD,modeAlpha:m2.ADD},this.colorMask={r:!0,g:!0,b:!0,a:!0},this.faceCulling=!1,this.cullFace=v0.BACK,this.frontFace=Fne.CCW,this.scissorTest=!1,this.scissorRect={x:0,y:0,width:0,height:0},this.depthTest=!1,this.depthFunction=lo.LESS,this.clearDepth=1,this.depthWrite=!0,this.depthRange={zNear:0,zFar:1},this.viewport=null,this.stencilTest=!1,this.polygonOffsetFill=!1,this.polygonOffset=[0,0],this.stencilFunction={face:v0.FRONT_AND_BACK,func:lo.ALWAYS,ref:0,mask:1},this.clearStencil=0,this.stencilWriteMask=1,this.stencilOperation={face:v0.FRONT_AND_BACK,fail:lx.KEEP,zFail:lx.KEEP,zPass:lx.KEEP},this.clearColor={r:0,g:0,b:0,a:0},this.program=null,this.vertexBuffer=null,this.indexBuffer=null,this.uniformBuffer=null,this.pixelPackBuffer=null,this.pixelUnpackBuffer=null,this.copyReadBuffer=null,this.copyWriteBuffer=null,this.uniformBufferBindingPoints=new Array,this.readFramebuffer=null,this.drawFramebuffer=null,this.renderbuffer=null,this.activeTexture=0,this.textureUnitMap=new Array,this.vertexArrayObject=null}},f1t=class{constructor(e){this._allocations=new Map,e?Error.stackTraceLimit=1/0:(this.add=()=>{},this.remove=()=>{})}add(e){this._allocations.set(e,new Error().stack)}remove(e){this._allocations.delete(e)}print(){if(this._allocations.size>0){console.log(`${this._allocations.size} live object allocations:`);const e=new Map;this._allocations.forEach(t=>{e.set(t,(e.get(t)??0)+1)}),e.forEach((t,n)=>{const r=n.split(`
`);r.shift(),r.shift(),console.log(`${t}: ${r.shift()}`),r.forEach(s=>console.log("   ",s))})}}};const m1t={RECORD_ALLOCATIONS:!1};let g1t=class{constructor(){for(this._current=new Array,this._max=new Array,this._allocations=new f1t(m1t.RECORD_ALLOCATIONS);this._current.length<rE.COUNT;)this._current.push(0),this._max.push(0)}resetMax(){for(this._max.length=0;this._max.length<this._current.length;)this._max.push(0)}increment(e,t){const n=++this._current[e];this._max[e]=Math.max(n,this._max[e]),this._allocations.add(t)}decrement(e,t){--this._current[e],this._allocations.remove(t)}get max(){return this._max}get current(){return this._current}get total(){return this.current.reduce((e,t)=>e+t,0)}printResourceCount(){if(this.total>0){console.log("Live objects:");for(let e=0;e<rE.COUNT;++e){const t=this._current[e];t>0&&console.log(`${rE[e]}: ${t}`)}}this._allocations.print()}},v1t=class{constructor(e){this._rctx=e,this._store=new M7}dispose(){this._store.forEach(e=>e.forEach(t=>t.dispose())),this._store.clear()}acquire(e,t,n,r){const s=this._store.get(e,t);if(T(s))return s.ref(),s;const a=new Vwe(this._rctx,e,t,n,r);return a.ref(),this._store.set(e,t,a),a}get test(){let e=0;return this._store.forEach(t=>t.forEach(n=>e+=n.hasGLName?2:1)),{cachedWebGLObjects:e}}};function Hee(i,e){i.resetState();const t=new ma(i,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},{target:Wn.TEXTURE_2D,wrapMode:An.CLAMP_TO_EDGE,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.NEAREST,width:1,height:1}),n=In.createVertex(i,kn.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),r=new Ph(i,new Map([["position",0]]),{geometry:[new hz("position",2,sy.UNSIGNED_SHORT,0,4)]},{geometry:n}),s=Gt(5633261287538229e-9,2626832878767164e-9,1.4349880495278358e6),a=Gt(563327146742708e-8,2.6268736381334523e6,1434963231608387e-9),o=y1t(i,s,a,e);i.bindFramebuffer(t),i.setViewport(0,0,1,1),i.bindVAO(r),i.drawArrays(Qi.TRIANGLE_STRIP,0,4);const l=new Uint8Array(4);t.readPixels(0,0,1,1,Ui.RGBA,un.UNSIGNED_BYTE,l),o.dispose(),r.dispose(!1),n.dispose(),t.dispose();const c=(s[2]-a[2])/25,u=mre(l);return Math.abs(c-u)}function y1t(i,e,t,n){const r=`

  precision highp float;

  attribute vec2 position;

  uniform vec3 u_highA;
  uniform vec3 u_lowA;
  uniform vec3 u_highB;
  uniform vec3 u_lowB;

  varying vec4 v_color;

  ${n?"#define DOUBLE_PRECISION_REQUIRES_OBFUSCATION":""}

  #ifdef DOUBLE_PRECISION_REQUIRES_OBFUSCATION

  vec3 dpPlusFrc(vec3 a, vec3 b) {
    return mix(a, a + b, vec3(notEqual(b, vec3(0))));
  }

  vec3 dpMinusFrc(vec3 a, vec3 b) {
    return mix(vec3(0), a - b, vec3(notEqual(a, b)));
  }

  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
    vec3 t1 = dpPlusFrc(hiA, hiB);
    vec3 e = dpMinusFrc(t1, hiA);
    vec3 t2 = dpMinusFrc(hiB, e) + dpMinusFrc(hiA, dpMinusFrc(t1, e)) + loA + loB;
    return t1 + t2;
  }

  #else

  vec3 dpAdd(vec3 hiA, vec3 loA, vec3 hiB, vec3 loB) {
    vec3 t1 = hiA + hiB;
    vec3 e = t1 - hiA;
    vec3 t2 = ((hiB - e) + (hiA - (t1 - e))) + loA + loB;
    return t1 + t2;
  }

  #endif

  const float MAX_RGBA_FLOAT =
    255.0 / 256.0 +
    255.0 / 256.0 / 256.0 +
    255.0 / 256.0 / 256.0 / 256.0 +
    255.0 / 256.0 / 256.0 / 256.0 / 256.0;

  const vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);

  vec4 float2rgba(const float value) {
    // Make sure value is in the domain we can represent
    float valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);

    // Decompose value in 32bit fixed point parts represented as
    // uint8 rgba components. Decomposition uses the fractional part after multiplying
    // by a power of 256 (this removes the bits that are represented in the previous
    // component) and then converts the fractional part to 8bits.
    vec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);

    // Convert uint8 values (from 0 to 255) to floating point representation for
    // the shader
    const float toU8AsFloat = 1.0 / 255.0;

    return fixedPointU8 * toU8AsFloat;
  }

  void main() {
    vec3 val = dpAdd(u_highA, u_lowA, -u_highB, -u_lowB);

    v_color = float2rgba(val.z / 25.0);

    gl_Position = vec4(position * 2.0 - 1.0, 0.0, 1.0);
  }
  `,s=`
  precision highp float;

  varying vec4 v_color;

  void main() {
    gl_FragColor = v_color;
  }
  `,a=i.programCache.acquire(r,s,new Map([["position",0]])),o=new Float32Array(6);ZG(e,o,3);const l=new Float32Array(6);return ZG(t,l,3),i.useProgram(a),a.setUniform3f("u_highA",o[0],o[2],o[4]),a.setUniform3f("u_lowA",o[1],o[3],o[5]),a.setUniform3f("u_highB",l[0],l[2],l[4]),a.setUniform3f("u_lowB",l[1],l[3],l[5]),a}var Gee,Wee,jee,Qme={exports:{}};function _1t(i){var m,g,_,b,x;if(!i.gl)return!1;if(i.type===La.WEBGL1)return!(!((m=i.capabilities.textureFloat)!=null&&m.textureFloat)||!((g=i.capabilities.colorBufferFloat)!=null&&g.textureFloat));if(!((_=i.capabilities.textureFloat)!=null&&_.textureFloat&&((b=i.capabilities.colorBufferFloat)!=null&&b.textureFloat)&&((x=i.capabilities.colorBufferFloat)!=null&&x.floatBlend)))return!1;const e=new ma(i,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},{target:Wn.TEXTURE_2D,wrapMode:An.CLAMP_TO_EDGE,pixelFormat:Ui.RGBA,dataType:un.FLOAT,internalFormat:sR.RGBA32F,samplingMode:fn.NEAREST,width:1,height:1}),t=In.createVertex(i,kn.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),n=new Ph(i,new Map([["a_pos",0]]),{geometry:[new hz("a_pos",2,sy.UNSIGNED_SHORT,0,4)]},{geometry:t}),r=`
  precision highp float;
  attribute vec2 a_pos;

  void main() {
    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
  }
  `,s=`
   precision highp float;

   void main() {
    gl_FragColor = vec4(0.5, 0.5, 0.5, 0.5);
   }
  `,a=i.programCache.acquire(r,s,new Map([["a_pos",0]]));i.useProgram(a);const o=i.getBoundFramebufferObject(),{x:l,y:c,width:u,height:d}=i.getViewport();i.bindFramebuffer(e),i.setViewport(0,0,1,1),i.bindVAO(n),i.drawArrays(Qi.TRIANGLE_STRIP,0,4);const h=yi({blending:s1e});i.setPipelineState(h),i.drawArrays(Qi.TRIANGLE_STRIP,0,4),Qme.exports.init(i);const p=i.gl.getError();return i.setViewport(l,c,u,d),i.bindFramebuffer(o),a.dispose(),n.dispose(!1),t.dispose(),e.dispose(),p!==1282||(console.warn("Device claims support for WebGL extension EXT_float_blend but does not support it. Using fall back."),!1)}Gee=Qme,Wee=function(){var i=function(g){window.console&&window.console.log&&window.console.log(g)},e=function(g){window.console&&window.console.error?window.console.error(g):i(g)},t={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0}},bindBuffer:{2:{0:!0}},bufferData:{3:{0:!0,2:!0}},bufferSubData:{3:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},readPixels:{7:{4:!0,5:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}}},n=null,r=null;function s(g){if(n==null)for(var _ in n={},r={},g)typeof g[_]=="number"&&(n[g[_]]=_,r[_]=g[_])}function a(){if(n==null)throw"WebGLDebugUtils.init(ctx) not called"}function o(g){return a(),n[g]!==void 0}function l(g){a();var _=n[g];return _!==void 0?"gl."+_:"/*UNKNOWN WebGL ENUM*/ 0x"+g.toString(16)}function c(g,_,b,x){var w;if((w=t[g])!==void 0&&(w=w[_])!==void 0&&w[b]){if(typeof w[b]=="object"&&w[b].enumBitwiseOr!==void 0){for(var C=w[b].enumBitwiseOr,S=0,E=[],A=0;A<C.length;++A){var P=r[C[A]];x&P&&(S|=P,E.push(l(P)))}return S===x?E.join(" | "):l(x)}return l(x)}return x===null?"null":x===void 0?"undefined":x.toString()}function u(g,_){for(var b="",x=_.length,w=0;w<x;++w)b+=(w==0?"":", ")+c(g,x,w,_[w]);return b}function d(g,_,b){g.__defineGetter__(b,function(){return _[b]}),g.__defineSetter__(b,function(x){_[b]=x})}function h(g,_,b,x){x=x||g,s(g),_=_||function(P,O,M){for(var V="",L=M.length,U=0;U<L;++U)V+=(U==0?"":", ")+c(O,L,U,M[U]);e("WebGL error "+l(P)+" in "+O+"("+V+")")};var w={};function C(P,O){return function(){b&&b(O,arguments);var M=P[O].apply(P,arguments),V=x.getError();return V!=0&&(w[V]=!0,_(V,O,arguments)),M}}var S={};for(var E in g)if(typeof g[E]=="function")if(E!="getExtension")S[E]=C(g,E);else{var A=C(g,E);S[E]=function(){return h(A.apply(g,arguments),_,b,x)}}else d(S,g,E);return S.getError=function(){for(var P in w)if(w.hasOwnProperty(P)&&w[P])return w[P]=!1,P;return g.NO_ERROR},S}function p(g){var _=g.getParameter(g.MAX_VERTEX_ATTRIBS),b=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,b);for(var x=0;x<_;++x)g.disableVertexAttribArray(x),g.vertexAttribPointer(x,4,g.FLOAT,!1,0,0),g.vertexAttrib1f(x,0);g.deleteBuffer(b);var w=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);for(x=0;x<w;++x)g.activeTexture(g.TEXTURE0+x),g.bindTexture(g.TEXTURE_CUBE_MAP,null),g.bindTexture(g.TEXTURE_2D,null);for(g.activeTexture(g.TEXTURE0),g.useProgram(null),g.bindBuffer(g.ARRAY_BUFFER,null),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,null),g.bindFramebuffer(g.FRAMEBUFFER,null),g.bindRenderbuffer(g.RENDERBUFFER,null),g.disable(g.BLEND),g.disable(g.CULL_FACE),g.disable(g.DEPTH_TEST),g.disable(g.DITHER),g.disable(g.SCISSOR_TEST),g.blendColor(0,0,0,0),g.blendEquation(g.FUNC_ADD),g.blendFunc(g.ONE,g.ZERO),g.clearColor(0,0,0,0),g.clearDepth(1),g.clearStencil(-1),g.colorMask(!0,!0,!0,!0),g.cullFace(g.BACK),g.depthFunc(g.LESS),g.depthMask(!0),g.depthRange(0,1),g.frontFace(g.CCW),g.hint(g.GENERATE_MIPMAP_HINT,g.DONT_CARE),g.lineWidth(1),g.pixelStorei(g.PACK_ALIGNMENT,4),g.pixelStorei(g.UNPACK_ALIGNMENT,4),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,!1),g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),g.UNPACK_COLORSPACE_CONVERSION_WEBGL&&g.pixelStorei(g.UNPACK_COLORSPACE_CONVERSION_WEBGL,g.BROWSER_DEFAULT_WEBGL),g.polygonOffset(0,0),g.sampleCoverage(1,!1),g.scissor(0,0,g.canvas.width,g.canvas.height),g.stencilFunc(g.ALWAYS,0,4294967295),g.stencilMask(4294967295),g.stencilOp(g.KEEP,g.KEEP,g.KEEP),g.viewport(0,0,g.canvas.width,g.canvas.height),g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT);g.getError(););}function m(g){var _,b,x=[],w=[],C={},S=1,E=!1,A=[],P=0,O=0,M=!1,V=0,L={};function U(J){return typeof J=="function"?J:function(he){J.handleEvent(he)}}g.getContext=(b=g.getContext,function(){var J=b.apply(g,arguments);if(J instanceof WebGLRenderingContext){if(J!=_){if(_)throw"got different context";C=X(_=J)}return C}return J});var G=function(J){x.push(U(J))},H=function(J){w.push(U(J))};function k(J){var he=J.addEventListener;J.addEventListener=function(ye,Te,ce){switch(ye){case"webglcontextlost":G(Te);break;case"webglcontextrestored":H(Te);break;default:he.apply(J,arguments)}}}function D(){for(var J=Object.keys(L),he=0;he<J.length;++he)delete L[J]}function $(){++O,E||P==O&&g.loseContext()}function F(J,he){var ye=J[he];return function(){if($(),!E)return ye.apply(J,arguments)}}function Y(){for(var J=0;J<A.length;++J){var he=A[J];he instanceof WebGLBuffer?_.deleteBuffer(he):he instanceof WebGLFramebuffer?_.deleteFramebuffer(he):he instanceof WebGLProgram?_.deleteProgram(he):he instanceof WebGLRenderbuffer?_.deleteRenderbuffer(he):he instanceof WebGLShader?_.deleteShader(he):he instanceof WebGLTexture&&_.deleteTexture(he)}}function ne(J){return{statusMessage:J,preventDefault:function(){M=!0}}}return k(g),g.loseContext=function(){if(!E){for(E=!0,P=0,++S;_.getError(););D(),L[_.CONTEXT_LOST_WEBGL]=!0;var J=ne("context lost"),he=x.slice();setTimeout(function(){for(var ye=0;ye<he.length;++ye)he[ye](J);V>=0&&setTimeout(function(){g.restoreContext()},V)},0)}},g.restoreContext=function(){E&&w.length&&setTimeout(function(){if(!M)throw"can not restore. webglcontestlost listener did not call event.preventDefault";Y(),p(_),E=!1,O=0,M=!1;for(var J=w.slice(),he=ne("context restored"),ye=0;ye<J.length;++ye)J[ye](he)},0)},g.loseContextInNCalls=function(J){if(E)throw"You can not ask a lost contet to be lost";P=O+J},g.getNumCalls=function(){return O},g.setRestoreTimeout=function(J){V=J},g;function X(J){for(var he in J)typeof J[he]=="function"?C[he]=F(J,he):d(C,J,he);C.getError=function(){if($(),!E)for(;fe=_.getError();)L[fe]=!0;for(var fe in L)if(L[fe])return delete L[fe],fe;return C.NO_ERROR};for(var ye=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"],Te=0;Te<ye.length;++Te){var ce=ye[Te];C[ce]=function(fe){return function(){if($(),E)return null;var Ue=fe.apply(J,arguments);return Ue.__webglDebugContextLostId__=S,A.push(Ue),Ue}}(J[ce])}var ae=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];for(Te=0;Te<ae.length;++Te)ce=ae[Te],C[ce]=function(fe){return function(){return $(),E?null:fe.apply(J,arguments)}}(C[ce]);var le=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];for(Te=0;Te<le.length;++Te)ce=le[Te],C[ce]=function(fe){return function(){return $(),!E&&fe.apply(J,arguments)}}(C[ce]);return C.checkFramebufferStatus=function(fe){return function(){return $(),E?C.FRAMEBUFFER_UNSUPPORTED:fe.apply(J,arguments)}}(C.checkFramebufferStatus),C.getAttribLocation=function(fe){return function(){return $(),E?-1:fe.apply(J,arguments)}}(C.getAttribLocation),C.getVertexAttribOffset=function(fe){return function(){return $(),E?0:fe.apply(J,arguments)}}(C.getVertexAttribOffset),C.isContextLost=function(){return E},C}}return{init:s,mightBeEnum:o,glEnumToString:l,glFunctionArgToString:c,glFunctionArgsToString:u,makeDebugContext:h,makeLostContextSimulatingCanvas:m,resetToInitialState:p}},(jee=Wee())!==void 0&&(Gee.exports=jee);function b1t(i){const e=new ma(i,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},{target:Wn.TEXTURE_2D,wrapMode:An.CLAMP_TO_EDGE,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.NEAREST,width:1,height:1}),t=`
precision highp float;
attribute vec2 a_pos;
uniform highp sampler2D u_texture;
varying vec4 v_color;

float getBit(in float bitset, in int bitIndex) {
  float offset = pow(2.0, float(bitIndex));
  return mod(floor(bitset / offset), 2.0);
}

void main() {
  vec4 value = texture2D(u_texture, vec2(0.0));
  float bit = getBit(value.x * 255.0, 1);

  v_color = bit * vec4(1.0);
  gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
}
`,n=`
precision highp float;
varying vec4 v_color;

void main() {
  gl_FragColor = v_color;
}
`,r=new Uint8Array(4),s=In.createVertex(i,kn.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),a=new Ph(i,new Map([["a_position",0]]),{geometry:[new hz("a_position",2,sy.SHORT,0,4)]},{geometry:s}),o=i.programCache.acquire(t,n,new Map([["a_pos",0]]));i.useProgram(o);const l=new Er(i,{target:Wn.TEXTURE_2D,wrapMode:An.CLAMP_TO_EDGE,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.NEAREST,width:1,height:1},new Uint8Array([2,255,0,0]));o.setUniform1i("u_texture",0),i.bindTexture(l,0);const c=i.getBoundFramebufferObject();i.bindFramebuffer(e),i.useProgram(o);const{x:u,y:d,width:h,height:p}=i.getViewport();i.setViewport(0,0,1,1),i.bindVAO(a),i.drawArrays(Qi.TRIANGLE_STRIP,0,4),i.setViewport(u,d,h,p),e.readPixels(0,0,1,1,Ui.RGBA,un.UNSIGNED_BYTE,r),o.dispose(),a.dispose(!1),s.dispose(),e.dispose();const m=r[0]!==255||r[1]!==255||r[2]!==255||r[3]!==255;return m&&tt.getLogger("esri.views.webgl.testSamplerPrecision").warn(`A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. [${r[0]}.${r[1]}.${r[2]}.${r[3]}]`),i.bindFramebuffer(c),m}async function w1t(i){const e=new Image;if(e.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",e.width=5,e.height=5,await e.decode(),!i.gl)return!0;const t=new ma(i,{colorTarget:ka.TEXTURE,depthStencilTarget:Ja.NONE},{target:Wn.TEXTURE_2D,wrapMode:An.CLAMP_TO_EDGE,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,samplingMode:fn.NEAREST,width:1,height:1}),n=In.createVertex(i,kn.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),r=new Ph(i,new Map([["a_pos",0]]),Bwe,{geometry:n}),s=`
  precision highp float;

  attribute vec2 a_pos;
  varying vec2 v_uv;

  void main() {
    v_uv = a_pos;
    gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);
  }
  `,a=`
  precision highp float;

  varying vec2 v_uv;
  uniform sampler2D u_texture;

  void main() {
    gl_FragColor = texture2D(u_texture, v_uv);
  }
  `,o=i.programCache.acquire(s,a,new Map([["a_pos",0]]));i.useProgram(o);const l=new Er(i,{dataType:un.UNSIGNED_BYTE,pixelFormat:Ui.RGBA,preMultiplyAlpha:!1,wrapMode:An.CLAMP_TO_EDGE,samplingMode:fn.LINEAR},e);i.bindTexture(l,0),o.setUniform1i("u_texture",0);const c=i.getBoundFramebufferObject(),{x:u,y:d,width:h,height:p}=i.getViewport();i.bindFramebuffer(t),i.setViewport(0,0,1,1),i.setClearColor(0,0,0,0),i.setBlendingEnabled(!1),i.clearSafe(hr.COLOR_BUFFER_BIT),i.bindVAO(r),i.drawArrays(Qi.TRIANGLE_STRIP,0,4);const m=new Uint8Array(4);return t.readPixels(0,0,1,1,Ui.RGBA,un.UNSIGNED_BYTE,m),o.dispose(),r.dispose(!1),n.dispose(),t.dispose(),l.dispose(),i.setViewport(u,d,h,p),i.bindFramebuffer(c),e.src="",m[0]===255}let x1t=class{constructor(e){this.context=e,this._floatBufferBlendWorking=_1t(e),w1t(e).then(t=>this._svgAlwaysPremultipliesAlpha=!t)}get floatBufferBlendWorking(){if(B(this._floatBufferBlendWorking))throw new Error("floatBufferBlendWorking test not yet available");return this._floatBufferBlendWorking}get svgAlwaysPremultipliesAlpha(){if(B(this._svgAlwaysPremultipliesAlpha))throw new Error("svgAlwaysPremultipliesAlpha test not yet available");return this._svgAlwaysPremultipliesAlpha}get doublePrecisionRequiresObfuscation(){if(B(this._doublePrecisionRequiresObfuscation)){const e=Hee(this.context,!1),t=Hee(this.context,!0);this._doublePrecisionRequiresObfuscation=e!==0&&(t===0||e/t>5)}return this._doublePrecisionRequiresObfuscation}get ignoresSamplerPrecision(){return B(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=b1t(this.context)),this._ignoresSamplerPrecision}};function C1t(i,e){if(e.disjointTimerQuery)return null;if(zl(i))return{drawBuffers:i.drawBuffers.bind(i),MAX_DRAW_BUFFERS:i.MAX_DRAW_BUFFERS,MAX_COLOR_ATTACHMENTS:i.MAX_COLOR_ATTACHMENTS};if(e.drawBuffers)return null;const t=i.getExtension("WEBGL_draw_buffers");return t?{drawBuffers:t.drawBuffersWEBGL.bind(t),MAX_DRAW_BUFFERS:t.MAX_DRAW_BUFFERS_WEBGL,MAX_COLOR_ATTACHMENTS:t.MAX_COLOR_ATTACHMENTS_WEBGL}:null}function T1t(i){if(zl(i))return i;const e=i.getExtension("ANGLE_instanced_arrays");return e?{drawArraysInstanced:e.drawArraysInstancedANGLE.bind(e),drawElementsInstanced:e.drawElementsInstancedANGLE.bind(e),vertexAttribDivisor:e.vertexAttribDivisorANGLE.bind(e)}:null}function S1t(i,e){if(e.compressedTextureETC)return null;const t=i.getExtension("WEBGL_compressed_texture_etc");return t?{COMPRESSED_R11_EAC:t.COMPRESSED_R11_EAC,COMPRESSED_SIGNED_R11_EAC:t.COMPRESSED_SIGNED_R11_EAC,COMPRESSED_RG11_EAC:t.COMPRESSED_RG11_EAC,COMPRESSED_SIGNED_RG11_EAC:t.COMPRESSED_SIGNED_RG11_EAC,COMPRESSED_RGB8_ETC2:t.COMPRESSED_RGB8_ETC2,COMPRESSED_SRGB8_ETC2:t.COMPRESSED_SRGB8_ETC2,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,COMPRESSED_RGBA8_ETC2_EAC:t.COMPRESSED_RGBA8_ETC2_EAC,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC}:null}function E1t(i,e){if(e.compressedTextureS3TC)return null;const t=i.getExtension("WEBGL_compressed_texture_s3tc");return t?{COMPRESSED_RGB_S3TC_DXT1:t.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:t.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:t.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:t.COMPRESSED_RGBA_S3TC_DXT5_EXT}:null}function A1t(i,e){if(zl(i))return{MIN:i.MIN,MAX:i.MAX};if(e.blendMinMax)return null;{const t=i.getExtension("EXT_blend_minmax");return t?{MIN:t.MIN_EXT,MAX:t.MAX_EXT}:null}}function M1t(i,e){if(e.textureFilterAnisotropic)return null;const t=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");return t?{MAX_TEXTURE_MAX_ANISOTROPY:t.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:t.TEXTURE_MAX_ANISOTROPY_EXT}:null}function P1t(i,e){if(zl(i))return{textureFloat:!0,textureFloatLinear:!e.textureFloatLinear&&!!i.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!0,HALF_FLOAT:i.HALF_FLOAT,R16F:i.R16F,RG16F:i.RG16F,RGBA16F:i.RGBA16F,R32F:i.R32F,RG32F:i.RG32F,RGBA32F:i.RGBA32F,R11F_G11F_B10F:i.R11F_G11F_B10F,RGB16F:i.RGB16F};if(i instanceof WebGLRenderingContext){const t=!e.textureHalfFloat&&i.getExtension("OES_texture_half_float");return{textureFloat:!e.textureFloat&&!!i.getExtension("OES_texture_float"),textureFloatLinear:!e.textureFloatLinear&&!!i.getExtension("OES_texture_float_linear"),textureHalfFloat:!!t,textureHalfFloatLinear:!e.textureHalfFloatLinear&&!!i.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:t?t.HALF_FLOAT_OES:void 0}}return null}function O1t(i,e){if(zl(i)){const t=!e.colorBufferHalfFloat&&i.getExtension("EXT_color_buffer_half_float")||!e.colorBufferFloat&&i.getExtension("EXT_color_buffer_float"),n=!e.colorBufferFloat&&i.getExtension("EXT_color_buffer_float"),r=!e.floatBlend&&!e.colorBufferFloat&&i.getExtension("EXT_float_blend");return t||n||r?{textureFloat:!!n,textureHalfFloat:!!t,floatBlend:!!r,R16F:i.R16F,RG16F:i.RG16F,RGBA16F:i.RGBA16F,R32F:i.R32F,RG32F:i.RG32F,RGBA32F:i.RGBA32F,R11F_G11F_B10F:i.R11F_G11F_B10F,RGB16F:i.RGB16F}:null}if(i instanceof WebGLRenderingContext){const t=!e.colorBufferHalfFloat&&i.getExtension("EXT_color_buffer_half_float"),n=!e.colorBufferFloat&&i.getExtension("WEBGL_color_buffer_float"),r=!e.floatBlend&&!e.colorBufferFloat&&i.getExtension("EXT_float_blend");return t||n||r?{textureFloat:!!n,textureHalfFloat:!!t,floatBlend:!!r,RGBA16F:t?t.RGBA16F_EXT:void 0,RGB16F:t?t.RGB16F_EXT:void 0,RGBA32F:n?n.RGBA32F_EXT:void 0}:null}return null}function rS(i,e,t,n,r){if(n&&zl(i))return!0;if(e[t])return!1;for(const s of r)if(i.getExtension(s))return!0;return!1}function R1t(i,e){if(!zl(i)||e.textureNorm16)return null;const t=i.getExtension("EXT_texture_norm16");return t?{R16:t.R16_EXT,RG16:t.RG16_EXT,RGB16:t.RGB16_EXT,RGBA16:t.RGBA16_EXT,R16_SNORM:t.R16_SNORM_EXT,RG16_SNORM:t.RG16_SNORM_EXT,RGB16_SNORM:t.RGB16_SNORM_EXT,RGBA16_SNORM:t.RGBA16_SNORM_EXT}:null}function I1t(i,e){const t=e.loseContext&&i.getExtension("WEBGL_lose_context");return t?{loseRenderingContext:()=>t.loseContext()}:null}function $1t(i,e){if(zl(i))return{createVertexArray:i.createVertexArray.bind(i),deleteVertexArray:i.deleteVertexArray.bind(i),bindVertexArray:i.bindVertexArray.bind(i)};if(e.vao)return null;const t=i.getExtension("OES_vertex_array_object")||i.getExtension("MOZ_OES_vertex_array_object")||i.getExtension("WEBKIT_OES_vertex_array_object");return t?{createVertexArray:t.createVertexArrayOES.bind(t),deleteVertexArray:t.deleteVertexArrayOES.bind(t),bindVertexArray:t.bindVertexArrayOES.bind(t)}:null}let L1t=class{constructor(e,t){this._gl=e,this._instancing=null,this._vertexArrayObject=null,this._compressedTextureETC=null,this._compressedTextureS3TC=null,this._textureFilterAnisotropic=null,this._textureFloat=null,this._colorBufferFloat=null,this._minMaxBlending=null,this._loseContext=null,this._drawBuffers=null,this._textureNorm16=null,this._depthTexture=null,this._standardDerivatives=null,this._shaderTextureLOD=null,this._fragDepth=null,this._textureFloatLinear=null,this._disabledExtensions=t.disabledExtensions||{},this._debugWebGLExtensions=t.debugWebGLExtensions||{}}get drawBuffers(){return this._drawBuffers||(this._drawBuffers=C1t(this._gl,this._disabledExtensions)),this._drawBuffers}get instancing(){return this._instancing||(this._instancing=T1t(this._gl)),this._instancing}get vao(){return this._vertexArrayObject||(this._vertexArrayObject=$1t(this._gl,this._disabledExtensions)),this._vertexArrayObject}get compressedTextureETC(){return this._compressedTextureETC||(this._compressedTextureETC=S1t(this._gl,this._disabledExtensions)),this._compressedTextureETC}get compressedTextureS3TC(){return this._compressedTextureS3TC||(this._compressedTextureS3TC=E1t(this._gl,this._disabledExtensions)),this._compressedTextureS3TC}get textureFilterAnisotropic(){return this._textureFilterAnisotropic||(this._textureFilterAnisotropic=M1t(this._gl,this._disabledExtensions)),this._textureFilterAnisotropic}get disjointTimerQuery(){return this._disjointTimerQuery||(this._disjointTimerQuery=u1t(this._gl,this._disabledExtensions)),this._disjointTimerQuery}get textureFloat(){return this._textureFloat||(this._textureFloat=P1t(this._gl,this._disabledExtensions)),this._textureFloat}get colorBufferFloat(){return this._colorBufferFloat||(this._colorBufferFloat=O1t(this._gl,this._disabledExtensions)),this._colorBufferFloat}get blendMinMax(){return this._minMaxBlending||(this._minMaxBlending=A1t(this._gl,this._disabledExtensions)),this._minMaxBlending}get depthTexture(){return this._depthTexture===null&&(this._depthTexture=rS(this._gl,this._disabledExtensions,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"])),this._depthTexture}get standardDerivatives(){return this._standardDerivatives===null&&(this._standardDerivatives=rS(this._gl,this._disabledExtensions,"standardDerivatives",!0,["OES_standard_derivatives"])),this._standardDerivatives}get shaderTextureLOD(){return this._shaderTextureLOD===null&&(this._shaderTextureLOD=rS(this._gl,this._disabledExtensions,"shaderTextureLOD",!0,["EXT_shader_texture_lod"])),this._shaderTextureLOD}get fragDepth(){return this._fragDepth===null&&(this._fragDepth=rS(this._gl,this._disabledExtensions,"fragDepth",!0,["EXT_frag_depth"])),this._fragDepth}get loseContext(){return this._loseContext||(this._loseContext=I1t(this._gl,this._debugWebGLExtensions)),this._loseContext}get textureNorm16(){return this._textureNorm16||(this._textureNorm16=R1t(this._gl,this._disabledExtensions)),this._textureNorm16}get textureFloatLinear(){return this._textureFloatLinear===null&&(this._textureFloatLinear=rS(this._gl,this._disabledExtensions,"textureFloatLinear",!1,["OES_texture_float_linear"])),this._textureFloatLinear}enable(e){return this[e]}},D1t=class{constructor(e,t){this.gl=e,this.instanceCounter=new g1t,this.programCache=new v1t(this),this._state=new Uee,this._numOfDrawCalls=0,this._numOfTriangles=0,this.type=zl(e)?La.WEBGL2:La.WEBGL1,this._loadExtensions(),this.configure(t)}configure(e){this._capabilities=new L1t(this.gl,e),this._parameters=this._loadParameters(e);const t=this.gl.getParameter(this.gl.VIEWPORT);this._state=new Uee,this._state.viewport={x:t[0],y:t[1],width:t[2],height:t[3]},this._stateTracker=new bbe({setBlending:n=>{if(n){this.setBlendingEnabled(!0),this.setBlendEquationSeparate(n.opRgb,n.opAlpha),this.setBlendFunctionSeparate(n.srcRgb,n.dstRgb,n.srcAlpha,n.dstAlpha);const r=n.color;this.setBlendColor(r.r,r.g,r.b,r.a)}else this.setBlendingEnabled(!1)},setCulling:n=>{n?(this.setFaceCullingEnabled(!0),this.setCullFace(n.face),this.setFrontFace(n.mode)):this.setFaceCullingEnabled(!1)},setPolygonOffset:n=>{n?(this.setPolygonOffsetFillEnabled(!0),this.setPolygonOffset(n.factor,n.units)):this.setPolygonOffsetFillEnabled(!1)},setDepthTest:n=>{n?(this.setDepthTestEnabled(!0),this.setDepthFunction(n.func)):this.setDepthTestEnabled(!1)},setStencilTest:n=>{if(n){this.setStencilTestEnabled(!0);const r=n.function;this.setStencilFunction(r.func,r.ref,r.mask);const s=n.operation;this.setStencilOp(s.fail,s.zFail,s.zPass)}else this.setStencilTestEnabled(!1)},setDepthWrite:n=>{n?(this.setDepthWriteEnabled(!0),this.setDepthRange(n.zNear,n.zFar)):this.setDepthWriteEnabled(!1)},setColorWrite:n=>{n?this.setColorMask(n.r,n.g,n.b,n.a):this.setColorMask(!1,!1,!1,!1)},setStencilWrite:n=>{n?this.setStencilWriteMask(n.mask):this.setStencilWriteMask(0)}}),this.enforceState(),this._driverTest=new x1t(this)}get driverTest(){return this._driverTest}get contextAttributes(){return this.gl.getContextAttributes()}get parameters(){return this._parameters}dispose(){this.programCache.dispose(),this.bindVAO(null),this.unbindBuffer(Yi.ARRAY_BUFFER),this.unbindBuffer(Yi.ELEMENT_ARRAY_BUFFER),zl(this.gl)&&(this.unbindBuffer(Yi.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(Yi.PIXEL_PACK_BUFFER),this.unbindBuffer(Yi.PIXEL_UNPACK_BUFFER),this.unbindBuffer(Yi.COPY_READ_BUFFER),this.unbindBuffer(Yi.COPY_WRITE_BUFFER)),this._state.textureUnitMap.length=0,Eg()&&this.instanceCounter.printResourceCount()}setPipelineState(e){this._stateTracker.setPipeline(e)}setBlendingEnabled(e){this._state.blend!==e&&(e===!0?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._state.blend=e,this._stateTracker.invalidateBlending())}externalProgramUpdate(){var e;(e=this._state.program)==null||e.stop(),this._state.program=null}externalTextureUnitUpdate(e,t){for(let n=0;n<e.length;++n)this._state.textureUnitMap[e[n]]=null;t>=0&&(this._state.activeTexture=t)}externalVertexArrayObjectUpdate(){const e=this.capabilities.vao;e&&(e.bindVertexArray(null),this._state.vertexArrayObject=null),this._state.vertexBuffer=null,this._state.indexBuffer=null}externalVertexBufferUpdate(){this._state.vertexBuffer=null}externalIndexBufferUpdate(){this._state.indexBuffer=null}setBlendColor(e,t,n,r){e===this._state.blendColor.r&&t===this._state.blendColor.g&&n===this._state.blendColor.b&&r===this._state.blendColor.a||(this.gl.blendColor(e,t,n,r),this._state.blendColor.r=e,this._state.blendColor.g=t,this._state.blendColor.b=n,this._state.blendColor.a=r,this._stateTracker.invalidateBlending())}setBlendFunction(e,t){e===this._state.blendFunction.srcRGB&&t===this._state.blendFunction.dstRGB||(this.gl.blendFunc(e,t),this._state.blendFunction.srcRGB=e,this._state.blendFunction.srcAlpha=e,this._state.blendFunction.dstRGB=t,this._state.blendFunction.dstAlpha=t,this._stateTracker.invalidateBlending())}setBlendFunctionSeparate(e,t,n,r){this._state.blendFunction.srcRGB===e&&this._state.blendFunction.srcAlpha===n&&this._state.blendFunction.dstRGB===t&&this._state.blendFunction.dstAlpha===r||(this.gl.blendFuncSeparate(e,t,n,r),this._state.blendFunction.srcRGB=e,this._state.blendFunction.srcAlpha=n,this._state.blendFunction.dstRGB=t,this._state.blendFunction.dstAlpha=r,this._stateTracker.invalidateBlending())}setBlendEquation(e){this._state.blendEquation.mode!==e&&(this.gl.blendEquation(e),this._state.blendEquation.mode=e,this._state.blendEquation.modeAlpha=e,this._stateTracker.invalidateBlending())}setBlendEquationSeparate(e,t){this._state.blendEquation.mode===e&&this._state.blendEquation.modeAlpha===t||(this.gl.blendEquationSeparate(e,t),this._state.blendEquation.mode=e,this._state.blendEquation.modeAlpha=t,this._stateTracker.invalidateBlending())}setColorMask(e,t,n,r){this._state.colorMask.r===e&&this._state.colorMask.g===t&&this._state.colorMask.b===n&&this._state.colorMask.a===r||(this.gl.colorMask(e,t,n,r),this._state.colorMask.r=e,this._state.colorMask.g=t,this._state.colorMask.b=n,this._state.colorMask.a=r,this._stateTracker.invalidateColorWrite())}setClearColor(e,t,n,r){this._state.clearColor.r===e&&this._state.clearColor.g===t&&this._state.clearColor.b===n&&this._state.clearColor.a===r||(this.gl.clearColor(e,t,n,r),this._state.clearColor.r=e,this._state.clearColor.g=t,this._state.clearColor.b=n,this._state.clearColor.a=r)}setFaceCullingEnabled(e){this._state.faceCulling!==e&&(e===!0?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._state.faceCulling=e,this._stateTracker.invalidateCulling())}setPolygonOffsetFillEnabled(e){this._state.polygonOffsetFill!==e&&(e===!0?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._state.polygonOffsetFill=e,this._stateTracker.invalidatePolygonOffset())}setPolygonOffset(e,t){this._state.polygonOffset[0]===e&&this._state.polygonOffset[1]===t||(this._state.polygonOffset[0]=e,this._state.polygonOffset[1]=t,this.gl.polygonOffset(e,t),this._stateTracker.invalidatePolygonOffset())}setCullFace(e){this._state.cullFace!==e&&(this.gl.cullFace(e),this._state.cullFace=e,this._stateTracker.invalidateCulling())}setFrontFace(e){this._state.frontFace!==e&&(this.gl.frontFace(e),this._state.frontFace=e,this._stateTracker.invalidateCulling())}setScissorTestEnabled(e){this._state.scissorTest!==e&&(e===!0?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._state.scissorTest=e)}setScissorRect(e,t,n,r){this._state.scissorRect.x===e&&this._state.scissorRect.y===t&&this._state.scissorRect.width===n&&this._state.scissorRect.height===r||(this.gl.scissor(e,t,n,r),this._state.scissorRect.x=e,this._state.scissorRect.y=t,this._state.scissorRect.width=n,this._state.scissorRect.height=r)}setDepthTestEnabled(e){this._state.depthTest!==e&&(e===!0?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._state.depthTest=e,this._stateTracker.invalidateDepthTest())}setClearDepth(e){this._state.clearDepth!==e&&(this.gl.clearDepth(e),this._state.clearDepth=e)}setDepthFunction(e){this._state.depthFunction!==e&&(this.gl.depthFunc(e),this._state.depthFunction=e,this._stateTracker.invalidateDepthTest())}setDepthWriteEnabled(e){this._state.depthWrite!==e&&(this.gl.depthMask(e),this._state.depthWrite=e,this._stateTracker.invalidateDepthWrite())}setDepthRange(e,t){this._state.depthRange.zNear===e&&this._state.depthRange.zFar===t||(this.gl.depthRange(e,t),this._state.depthRange.zNear=e,this._state.depthRange.zFar=t,this._stateTracker.invalidateDepthWrite())}setStencilTestEnabled(e){this._state.stencilTest!==e&&(e===!0?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._state.stencilTest=e,this._stateTracker.invalidateStencilTest())}setClearStencil(e){e!==this._state.clearStencil&&(this.gl.clearStencil(e),this._state.clearStencil=e)}setStencilFunction(e,t,n){this._state.stencilFunction.func===e&&this._state.stencilFunction.ref===t&&this._state.stencilFunction.mask===n||(this.gl.stencilFunc(e,t,n),this._state.stencilFunction.face=v0.FRONT_AND_BACK,this._state.stencilFunction.func=e,this._state.stencilFunction.ref=t,this._state.stencilFunction.mask=n,this._stateTracker.invalidateStencilTest())}setStencilFunctionSeparate(e,t,n,r){this._state.stencilFunction.face===e&&this._state.stencilFunction.func===t&&this._state.stencilFunction.ref===n&&this._state.stencilFunction.mask===r||(this.gl.stencilFuncSeparate(e,t,n,r),this._state.stencilFunction.face=e,this._state.stencilFunction.func=t,this._state.stencilFunction.ref=n,this._state.stencilFunction.mask=r,this._stateTracker.invalidateStencilTest())}setStencilWriteMask(e){this._state.stencilWriteMask!==e&&(this.gl.stencilMask(e),this._state.stencilWriteMask=e,this._stateTracker.invalidateStencilWrite())}setStencilOp(e,t,n){this._state.stencilOperation.face===v0.FRONT_AND_BACK&&this._state.stencilOperation.fail===e&&this._state.stencilOperation.zFail===t&&this._state.stencilOperation.zPass===n||(this.gl.stencilOp(e,t,n),this._state.stencilOperation.face=v0.FRONT_AND_BACK,this._state.stencilOperation.fail=e,this._state.stencilOperation.zFail=t,this._state.stencilOperation.zPass=n,this._stateTracker.invalidateStencilTest())}setStencilOpSeparate(e,t,n,r){this._state.stencilOperation.face===e&&this._state.stencilOperation.fail===t&&this._state.stencilOperation.zFail===n&&this._state.stencilOperation.zPass===r||(this.gl.stencilOpSeparate(e,t,n,r),this._state.stencilOperation.face=e,this._state.stencilOperation.fail=t,this._state.stencilOperation.zFail=n,this._state.stencilOperation.zPass=r,this._stateTracker.invalidateStencilTest())}setActiveTexture(e,t=!1){const n=this._state.activeTexture;return e>=0&&(t||e!==this._state.activeTexture)&&(this.gl.activeTexture(tk+e),this._state.activeTexture=e),n}clear(e){e&&this.gl.clear(e)}clearSafe(e,t=255){e&&(e&hr.COLOR_BUFFER_BIT&&this.setColorMask(!0,!0,!0,!0),e&hr.DEPTH_BUFFER_BIT&&this.setDepthWriteEnabled(!0),e&hr.STENCIL_BUFFER_BIT&&this.setStencilWriteMask(t),this.gl.clear(e))}drawArrays(e,t,n){if(Eg()&&(this._numOfDrawCalls++,this._numOfTriangles+=qee(e,n)),this.gl.drawArrays(e,t,n),Eg()){const r=nW(this);r&&console.error("drawArrays:",r)}}drawElements(e,t,n,r){if(Eg()&&(this._numOfDrawCalls++,this._numOfTriangles+=qee(e,t)),this.gl.drawElements(e,t,n,r),Eg()){const s=nW(this);if(s){const a=this.getBoundVAO(),o=a==null?void 0:a.indexBuffer,l=a==null?void 0:a.vertexBuffers,c={indexBuffer:o,vertexBuffers:l},u={mode:e,count:t,type:n,offset:r},d=Qa(o,m=>m.size)??0,h=r+t,p=d<h?`. Buffer is too small. Attempted to draw index ${h} of ${d}`:"";console.error(`drawElements: ${s}${p}`,{args:u,vao:c})}}}logInfo(){Eg()&&console.log(`DrawCalls: ${this._numOfDrawCalls}, Triangles: ${this._numOfTriangles}`)}resetInfo(){Eg()&&(this._numOfDrawCalls=0,this._numOfTriangles=0)}get capabilities(){return this._capabilities}setViewport(e,t,n,r){n=Math.max(Math.round(n),1),r=Math.max(Math.round(r),1);const s=this._state.viewport;s.x===e&&s.y===t&&s.width===n&&s.height===r||(s.x=e,s.y=t,s.width=n,s.height=r,this.gl.viewport(e,t,n,r))}getViewport(){const e=this._state.viewport;return{x:e.x,y:e.y,width:e.width,height:e.height}}useProgram(e){var t;this._state.program!==e&&((t=this._state.program)==null||t.stop(),this._state.program=e,this.gl.useProgram((e==null?void 0:e.glName)??null))}bindTexture(e,t,n=!1){(t>=this.parameters.maxTextureImageUnits||t<0)&&console.error("Input texture unit is out of range of available units!");const r=this._state.textureUnitMap[t];return B(e)||e.glName==null?(T(r)&&(this.setActiveTexture(t,n),this.gl.bindTexture(r.descriptor.target,null)),this._state.textureUnitMap[t]=null,r):n||r!==e?(this.setActiveTexture(t,n),this.gl.bindTexture(e.descriptor.target,e.glName),e.applyChanges(),this._state.textureUnitMap[t]=e,r):(e.isDirty&&(this.setActiveTexture(t,n),e.applyChanges()),r)}unbindTexture(e){if(!B(e))for(let t=0;t<this.parameters.maxTextureImageUnits;t++)this._state.textureUnitMap[t]===e&&(this.bindTexture(null,t),this._state.textureUnitMap[t]=null)}bindFramebuffer(e,t=!1){if(t||this._state.readFramebuffer!==e||this._state.drawFramebuffer!==e){if(B(e))return this.gl.bindFramebuffer(kd.FRAMEBUFFER,null),this._state.readFramebuffer=null,void(this._state.drawFramebuffer=null);e.initializeAndBind(kd.FRAMEBUFFER),this._state.readFramebuffer=e,this._state.drawFramebuffer=e}}bindFramebufferSeparate(e,t,n=!1){const r=t===kd.READ_FRAMEBUFFER,s=r?this._state.readFramebuffer:this._state.drawFramebuffer;(n||s!==e)&&(B(e)?this.gl.bindFramebuffer(t,null):e.initializeAndBind(t),r?this._state.readFramebuffer=Jt(e,null):this._state.drawFramebuffer=Jt(e,null))}blitFramebuffer(e,t,n=0,r=0,s=e.width,a=e.height,o=0,l=0,c=t.width,u=t.height,d=hr.COLOR_BUFFER_BIT,h=fn.NEAREST){this.bindFramebufferSeparate(e,kd.READ_FRAMEBUFFER),this.bindFramebufferSeparate(t,kd.DRAW_FRAMEBUFFER),this.gl.blitFramebuffer(n,r,s,a,o,l,c,u,d,h)}bindBuffer(e,t){if(e)switch(t??(t=e.bufferType),t){case Yi.ARRAY_BUFFER:this._state.vertexBuffer=uc(this.gl,e,t,this._state.vertexBuffer);break;case Yi.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=uc(this.gl,e,t,this._state.indexBuffer);break;case Yi.UNIFORM_BUFFER:this._state.uniformBuffer=uc(this.gl,e,t,this._state.uniformBuffer);break;case Yi.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=uc(this.gl,e,t,this._state.pixelPackBuffer);break;case Yi.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=uc(this.gl,e,t,this._state.pixelUnpackBuffer);break;case Yi.COPY_READ_BUFFER:this._state.copyReadBuffer=uc(this.gl,e,t,this._state.copyReadBuffer);break;case Yi.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=uc(this.gl,e,t,this._state.copyWriteBuffer)}}bindRenderbuffer(e){const t=this.gl;e||(t.bindRenderbuffer(t.RENDERBUFFER,null),this._state.renderbuffer=null),this._state.renderbuffer!==e&&(t.bindRenderbuffer(t.RENDERBUFFER,e.glName),this._state.renderbuffer=e)}_getBufferBinding(e,t){if(t>=this.parameters.maxUniformBufferBindings||t<0)return console.error("Uniform buffer binding point is out of range!"),null;const n=this._state.uniformBufferBindingPoints;let r=n[t];return B(r)&&(r={buffer:null,offset:0,size:0},n[t]=r),r}bindBufferBase(e,t,n){const r=this._getBufferBinding(e,t);B(r)||r.buffer===n&&r.offset===0&&r.size===0||(this.gl.bindBufferBase(e,t,n?n.glName:null),r.buffer=n,r.offset=0,r.size=0)}bindBufferRange(e,t,n,r,s){const a=this._getBufferBinding(e,t);if(!B(a)&&!(a.buffer===n&&a.offset===r&&a.size===s)){if(r%this._parameters.uniformBufferOffsetAlignment!=0)return void console.error("Uniform buffer binding offset is not a multiple of the context offset alignment");this.gl.bindBufferRange(e,t,n.glName,r,s),a.buffer=n,a.offset=r,a.size=s}}bindUBO(e,t,n,r){B(t)?this.bindBufferBase(Yi.UNIFORM_BUFFER,e,null):(Eg()&&(r??t.byteLength)>this._parameters.maxUniformBlockSize&&console.error("Attempting to bind more data than the maximum uniform block size"),t.initialize(),n!==void 0&&r!==void 0?this.bindBufferRange(Yi.UNIFORM_BUFFER,e,t.buffer,n,r):this.bindBufferBase(Yi.UNIFORM_BUFFER,e,t.buffer))}unbindUBO(e){for(let t=0,n=this._state.uniformBufferBindingPoints.length;t<n;t++){const r=this._state.uniformBufferBindingPoints[t];T(r)&&r.buffer===e.buffer&&this.bindBufferBase(Yi.UNIFORM_BUFFER,t,null)}}unbindBuffer(e){switch(e){case Yi.ARRAY_BUFFER:this._state.vertexBuffer=uc(this.gl,null,e,this._state.vertexBuffer);break;case Yi.ELEMENT_ARRAY_BUFFER:this._state.indexBuffer=uc(this.gl,null,e,this._state.indexBuffer);break;case Yi.UNIFORM_BUFFER:this._state.uniformBuffer=uc(this.gl,null,e,this._state.uniformBuffer);break;case Yi.PIXEL_PACK_BUFFER:this._state.pixelPackBuffer=uc(this.gl,null,e,this._state.pixelPackBuffer);break;case Yi.PIXEL_UNPACK_BUFFER:this._state.pixelUnpackBuffer=uc(this.gl,null,e,this._state.pixelUnpackBuffer);break;case Yi.COPY_READ_BUFFER:this._state.copyReadBuffer=uc(this.gl,null,e,this._state.copyReadBuffer);break;case Yi.COPY_WRITE_BUFFER:this._state.copyWriteBuffer=uc(this.gl,null,e,this._state.copyWriteBuffer)}}bindVAO(e=null){B(e)?this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null):this._state.vertexArrayObject!==e&&(e.bind(),this._state.vertexArrayObject=e)}async clientWaitAsync(e=Wi(10)){const t=this.gl,n=t.fenceSync(Lbe.SYNC_GPU_COMMANDS_COMPLETE,0);if(!n)throw new Error("Client wait failed, could not create sync object");let r;this.instanceCounter.increment(rE.Sync,n),t.flush();do await Fx(e),r=t.clientWaitSync(n,0,0);while(r===QG.TIMEOUT_EXPIRED);if(this.instanceCounter.decrement(rE.Sync,n),t.deleteSync(n),r===QG.WAIT_FAILED)throw new Error("Client wait failed")}getBoundFramebufferObject(e=kd.FRAMEBUFFER){return e===kd.READ_FRAMEBUFFER?this._state.readFramebuffer:this._state.drawFramebuffer}getBoundVAO(){return this._state.vertexArrayObject}resetState(){this.useProgram(null),this.bindVAO(null),this.bindFramebuffer(null,!0),this.unbindBuffer(Yi.ARRAY_BUFFER),this.unbindBuffer(Yi.ELEMENT_ARRAY_BUFFER),zl(this.gl)&&(this.unbindBuffer(Yi.UNIFORM_BUFFER),this._state.uniformBufferBindingPoints.length=0,this.unbindBuffer(Yi.PIXEL_PACK_BUFFER),this.unbindBuffer(Yi.PIXEL_UNPACK_BUFFER),this.unbindBuffer(Yi.COPY_READ_BUFFER),this.unbindBuffer(Yi.COPY_WRITE_BUFFER));for(let e=0;e<this.parameters.maxTextureImageUnits;++e)this.bindTexture(null,e);this.setBlendingEnabled(!1),this.setBlendFunction(vt.ONE,vt.ZERO),this.setBlendEquation(m2.ADD),this.setBlendColor(0,0,0,0),this.setFaceCullingEnabled(!1),this.setCullFace(v0.BACK),this.setFrontFace(Fne.CCW),this.setPolygonOffsetFillEnabled(!1),this.setPolygonOffset(0,0),this.setScissorTestEnabled(!1),this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height),this.setDepthTestEnabled(!1),this.setDepthFunction(lo.LESS),this.setDepthRange(0,1),this.setStencilTestEnabled(!1),this.setStencilFunction(lo.ALWAYS,0,0),this.setStencilOp(lx.KEEP,lx.KEEP,lx.KEEP),this.setClearColor(0,0,0,0),this.setClearDepth(1),this.setClearStencil(0),this.setColorMask(!0,!0,!0,!0),this.setStencilWriteMask(4294967295),this.setDepthWriteEnabled(!0),this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)}enforceState(){var r,s,a;const e=this.gl,t=this.capabilities.vao;t&&t.bindVertexArray(null);for(let o=0;o<this.parameters.maxVertexAttributes;o++)e.disableVertexAttribArray(o);if(this._state.vertexBuffer?e.bindBuffer(this._state.vertexBuffer.bufferType,this._state.vertexBuffer.glName):e.bindBuffer(Yi.ARRAY_BUFFER,null),this._state.indexBuffer?e.bindBuffer(this._state.indexBuffer.bufferType,this._state.indexBuffer.glName):e.bindBuffer(Yi.ELEMENT_ARRAY_BUFFER,null),zl(e)){this._state.uniformBuffer?e.bindBuffer(this._state.uniformBuffer.bufferType,this._state.uniformBuffer.glName):e.bindBuffer(Yi.UNIFORM_BUFFER,null);for(let o=0;o<this._parameters.maxUniformBufferBindings;o++){const l=this._state.uniformBufferBindingPoints[o];if(T(l)){const{buffer:c,offset:u,size:d}=l;c!==null?u===0&&d===0?e.bindBufferBase(Yi.UNIFORM_BUFFER,o,c.glName):e.bindBufferRange(Yi.UNIFORM_BUFFER,o,c.glName,u,d):e.bindBufferBase(Yi.UNIFORM_BUFFER,o,null)}}this._state.pixelPackBuffer?e.bindBuffer(this._state.pixelPackBuffer.bufferType,this._state.pixelPackBuffer.glName):e.bindBuffer(Yi.PIXEL_PACK_BUFFER,null),this._state.pixelUnpackBuffer?e.bindBuffer(this._state.pixelUnpackBuffer.bufferType,this._state.pixelUnpackBuffer.glName):e.bindBuffer(Yi.PIXEL_UNPACK_BUFFER,null),this._state.copyReadBuffer?e.bindBuffer(this._state.copyReadBuffer.bufferType,this._state.copyReadBuffer.glName):e.bindBuffer(Yi.COPY_READ_BUFFER,null),this._state.copyWriteBuffer?e.bindBuffer(this._state.copyWriteBuffer.bufferType,this._state.copyWriteBuffer.glName):e.bindBuffer(Yi.COPY_WRITE_BUFFER,null),e.bindFramebuffer(kd.READ_FRAMEBUFFER,null),e.readBuffer(e.BACK),this._state.readFramebuffer&&(e.bindFramebuffer(kd.READ_FRAMEBUFFER,this._state.readFramebuffer.glName),e.readBuffer(Dbe.COLOR_ATTACHMENT0)),e.bindFramebuffer(kd.DRAW_FRAMEBUFFER,((r=this._state.drawFramebuffer)==null?void 0:r.glName)??null)}else this._state.readFramebuffer=this._state.drawFramebuffer,e.bindFramebuffer(kd.FRAMEBUFFER,((s=this._state.drawFramebuffer)==null?void 0:s.glName)??null);if(t&&this._state.vertexArrayObject){const o=this._state.vertexArrayObject;this._state.vertexArrayObject&&(this._state.vertexArrayObject.unbind(),this._state.vertexArrayObject=null),this.bindVAO(o)}e.useProgram(((a=this._state.program)==null?void 0:a.glName)??null),e.blendColor(this._state.blendColor.r,this._state.blendColor.g,this._state.blendColor.b,this._state.blendColor.a),e.bindRenderbuffer(e.RENDERBUFFER,this._state.renderbuffer?this._state.renderbuffer.glName:null),this._state.blend===!0?e.enable(this.gl.BLEND):e.disable(this.gl.BLEND),e.blendEquationSeparate(this._state.blendEquation.mode,this._state.blendEquation.modeAlpha),e.blendFuncSeparate(this._state.blendFunction.srcRGB,this._state.blendFunction.dstRGB,this._state.blendFunction.srcAlpha,this._state.blendFunction.dstAlpha),e.clearColor(this._state.clearColor.r,this._state.clearColor.g,this._state.clearColor.b,this._state.clearColor.a),e.clearDepth(this._state.clearDepth),e.clearStencil(this._state.clearStencil),e.colorMask(this._state.colorMask.r,this._state.colorMask.g,this._state.colorMask.b,this._state.colorMask.a),e.cullFace(this._state.cullFace),e.depthFunc(this._state.depthFunction),e.depthRange(this._state.depthRange.zNear,this._state.depthRange.zFar),this._state.depthTest===!0?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(this._state.depthWrite),e.frontFace(this._state.frontFace),e.lineWidth(1),this._state.faceCulling===!0?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),e.polygonOffset(this._state.polygonOffset[0],this._state.polygonOffset[1]),this._state.polygonOffsetFill===!0?e.enable(e.POLYGON_OFFSET_FILL):e.disable(e.POLYGON_OFFSET_FILL),e.scissor(this._state.scissorRect.x,this._state.scissorRect.y,this._state.scissorRect.width,this._state.scissorRect.height),this._state.scissorTest===!0?e.enable(e.SCISSOR_TEST):e.disable(e.SCISSOR_TEST),e.stencilFunc(this._state.stencilFunction.func,this._state.stencilFunction.ref,this._state.stencilFunction.mask),e.stencilOpSeparate(this._state.stencilOperation.face,this._state.stencilOperation.fail,this._state.stencilOperation.zFail,this._state.stencilOperation.zPass),this._state.stencilTest===!0?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),e.stencilMask(this._state.stencilWriteMask);for(let o=0;o<this.parameters.maxTextureImageUnits;o++){e.activeTexture(tk+o),e.bindTexture(Wn.TEXTURE_2D,null),e.bindTexture(Wn.TEXTURE_CUBE_MAP,null),zl(e)&&(e.bindTexture(Wn.TEXTURE_3D,null),e.bindTexture(Wn.TEXTURE_2D_ARRAY,null));const l=this._state.textureUnitMap[o];T(l)&&e.bindTexture(l.descriptor.target,l.glName)}e.activeTexture(tk+this._state.activeTexture);const n=this._state.viewport;e.viewport(n.x,n.y,n.width,n.height),this.resetInfo()}_loadExtensions(){this.type===La.WEBGL1&&this.gl.getExtension("OES_element_index_uint"),this.gl.getExtension("KHR_parallel_shader_compile")}_loadParameters(e){const t=this.capabilities.textureFilterAnisotropic,n=e.maxAnisotropy??1/0,r=zl(this.gl),s=this.gl,a={versionString:this.gl.getParameter(this.gl.VERSION),maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:t?Math.min(this.gl.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY),n):1,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),maxTextureSize:this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE),maxUniformBufferBindings:r?s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS):0,maxVertexUniformBlocks:r?s.getParameter(s.MAX_VERTEX_UNIFORM_BLOCKS):0,maxFragmentUniformBlocks:r?s.getParameter(s.MAX_FRAGMENT_UNIFORM_BLOCKS):0,maxUniformBlockSize:r?s.getParameter(s.MAX_UNIFORM_BLOCK_SIZE):0,uniformBufferOffsetAlignment:r?s.getParameter(s.UNIFORM_BUFFER_OFFSET_ALIGNMENT):1,maxArrayTextureLayers:r?s.getParameter(s.MAX_ARRAY_TEXTURE_LAYERS):1,maxSamples:r?s.getParameter(s.MAX_SAMPLES):1};return Er.TEXTURE_UNIT_FOR_UPDATES=a.maxTextureImageUnits-1,a}};function uc(i,e,t,n){return e?n!==e&&i.bindBuffer(t,e.glName):i.bindBuffer(t,null),e}function qee(i,e){switch(i){case Qi.POINTS:return 2*e;case Qi.TRIANGLES:return e/3;case Qi.TRIANGLE_STRIP:case Qi.TRIANGLE_FAN:return e-2;default:return 0}}let k1t=class extends D1t{constructor(e,t,n){super(e,t),this.newCache=n,this._refCount=1}dispose(){--this._refCount>0||super.dispose()}ref(){++this._refCount}bindTechnique(e,t,n,r){return this.useProgram(e.program),e.bindPipelineState(this,n==null?void 0:n.slot,r),e.program.bindPass(t,n),e.program}get test(){return this.programCache.test}},_w=class extends et{constructor(e,t,n){super({}),this._stage=e,this._techniqueRepository=t,this._rctx=n,this._textures=new Map,this._loadingCount=0,this._frameUpdates=new Map,this.events=new Pn,this._frameTask=e.resourceController.scheduler.registerTask($r.TEXTURE_UNLOAD)}normalizeCtorArgs(){return{}}dispose(){this._frameTask.remove(),this._stage.forEachOfType(LC.Texture,e=>e.unload())}get updating(){return this._loadingCount>0||this._frameTask.updating}get textureTechnique(){return B(this._textureTechnique)&&(this._textureTechnique=this._techniqueRepository.acquire(bD,new $7)),this._textureTechnique}acquire(e){const t=this._textures.get(e);return t?(t.ref(),Jt(t.loadingPromise,t)):this._createNewRef(e)}update(){let e=!1;this._frameUpdates.forEach(t=>{const n=t.texture.frameUpdate(this._rctx,this.textureTechnique,t.previousToken);n>=0&&n!==t.previousToken&&(t.previousToken=n,e=!0)}),e&&this.events.emit("changed",ds.BACKGROUND)}_createNewRef(e){const t=this._stage.getObject(e);if(B(t))return Ti(t!==void 0),null;const n=t.events.on("unloaded",()=>{n.remove(),this._onTextureUnloaded(e)}),r=new F1t(e,()=>{this._frameTask.schedule(()=>{r.isUnreferenced&&t.unload()})});return this._textures.set(e,r),r.ref(),T(t.glTexture)?(this._updateGLTexture(r,t.glTexture),t.requiresFrameUpdates&&this._frameUpdates.set(e,{texture:t,previousToken:-1}),r):(this._loadingCount++,r.loadingPromise=this._stage.schedule(()=>{const s=t.load(this._rctx,()=>this.textureTechnique),a=l=>(this._loadingCount--,r.loadingPromise=null,this._updateGLTexture(r,l),t.requiresFrameUpdates&&this._frameUpdates.set(e,{texture:t,previousToken:-1}),r),o=l=>(this._loadingCount--,r.loadingPromise=null,zo(l)||tt.getLogger(this.declaredClass).error(l),null);return BA(s)?s.then(a,o):a(s)}),r.loadingPromise)}_updateGLTexture(e,t){e.glTexture=t,this.events.emit("changed",ds.UPDATE)}_onTextureUnloaded(e){this._textures.delete(e),this._frameUpdates.delete(e)}};f([y()],_w.prototype,"_loadingCount",void 0),f([y()],_w.prototype,"_frameTask",void 0),f([y()],_w.prototype,"updating",null),_w=f([ge("esri.views.3d.webgl-engine.lib.TextureRepository")],_w);let F1t=class{constructor(e,t){this.id=e,this._release=t,this._refCount=0}get isUnreferenced(){return this._refCount===0}ref(){++this._refCount}release(){--this._refCount,this._refCount>0||(this._refCount!==0?(tt.getLogger("esri.views.3d.webgl-engine.lib.TextureRepository.RefCountedTextureImpl").error("Cannot dereference texture that has no references!"),this._refCount=0):this._release())}};const N1t="esri.views.3d.webgl-engine.materials.internal.WaterTextureRepository";let US=class extends et{constructor(){super(...arguments),this._passParameters=new V1t,this._loading=0}get passParameters(){return this._passParameters}dispose(){this._passParameters.waveNormal=Ht(this._passParameters.waveNormal),this._passParameters.wavePertubation=Ht(this._passParameters.wavePertubation)}get updating(){return this._loading>0}ensureResources(e){if(this._loading>0)return oR.LOADING;if(T(this._passParameters.waveNormal)&&T(this._passParameters.wavePertubation))return oR.LOADED;const t={target:Wn.TEXTURE_2D,pixelFormat:Ui.RGBA,dataType:un.UNSIGNED_BYTE,wrapMode:An.REPEAT,samplingMode:fn.LINEAR_MIPMAP_LINEAR,hasMipmap:!0,maxAnisotropy:8};return++this._loading,tb(zx("esri/images/materials/water/normals.jpg")).then(n=>this._passParameters.waveNormal=new Er(e,{...t,width:n.width,height:n.height},n)).catch(n=>tt.getLogger(this.declaredClass).error("Failed to load water material normal texture.",n)).finally(()=>--this._loading),++this._loading,tb(zx("esri/images/materials/water/perturbation.jpg")).then(n=>this._passParameters.wavePertubation=new Er(e,{...t,width:n.width,height:n.height},n)).catch(n=>tt.getLogger(this.declaredClass).error("Failed to load water material pertubation texture.",n)).finally(()=>--this._loading),oR.LOADING}};f([y()],US.prototype,"_loading",void 0),f([y({type:Boolean,readOnly:!0})],US.prototype,"updating",null),US=f([ge(N1t)],US);let V1t=class extends Es{},B1t=class{constructor(e,t){this.viewCamera=e,this.frameHasDecorations=t}},z1t=class extends yD{constructor(e,t,n,r){super(),this._rctx=e,this._renderFunctions=t,this._forceCameraHook=n,this._disposeOffscreenBuffers=r,this.supersample=!0,this._screenshotQueue=new Array}dispose(){this._rctx=null}async takeScreenshot(e){await this._renderFunctions.prepareOverlay(),this._renderFunctions.requestRenderScene(ds.BACKGROUND);const t=_b();return this._screenshotQueue.push({settings:e,resolver:t}),t.promise}update(e,t){for(const n of this._screenshotQueue){if(this.isDisposed){n.resolver.reject();continue}const r={...n.settings,pixelRatio:n.settings.pixelRatio*e.viewCamera.pixelRatio},s=this._renderScreenshot(e,r,t);n.resolver(s)}this._screenshotQueue.length=0}_renderScreenshotOverlay(e,t,n){e.width=t.width,e.height=t.height;const r=e.getContext("2d"),s=n.pixelRatio;return r.save(),r.translate(0,t.height),r.scale(1,-1),n.region&&r.translate(-n.region.x,-n.region.y),r.scale(s,s),t=this._renderFunctions.renderOverlay(e,t),r.restore(),t}_readbackScreenshot(e,t){return e.resample?this._readbackScreenshotResampled(e,t):this._readbackScreenshotImmediate(e,t)}_readbackScreenshotResampled(e,t){const{framebufferWidth:n,framebufferHeight:r,region:s,resample:a}=e,o=this._ensureScreenshotEncodeCanvas();let l=ik(n,r,o);this._rctx.gl.readPixels(0,0,n,r,Ui.RGBA,sy.UNSIGNED_BYTE,new Uint8Array(l.data.buffer)),t(),l=this._renderScreenshotOverlay(o,l,{...e,region:null});const c=ik(s.width,s.height,o);return Pit(l,c,!0,a.region.x,r-(a.region.y+a.region.height),a.region.width,a.region.height)}_readbackScreenshotImmediate(e,t){const{framebufferHeight:n,region:r}=e,s=this._ensureScreenshotEncodeCanvas(),a=ik(r.width,r.height,s);return this._rctx.gl.readPixels(r.x,n-(r.y+r.height),r.width,r.height,Ui.RGBA,sy.UNSIGNED_BYTE,new Uint8Array(a.data.buffer)),t(),this._renderScreenshotOverlay(s,a,e)}_renderScreenshot(e,t,n){let r=null,s=null;const a=e.viewCamera,{framebufferWidth:o,framebufferHeight:l}=t;let c=!1;const u=t.disableDecorations&&e.frameHasDecorations,d=o!==a.fullWidth||l!==a.fullHeight,h=t.ignorePadding&&a.pixelRatio!==t.pixelRatio,p=d||u||h||t.objectAndLayerIdColor;if(t.objectAndLayerIdColor&&(s=new ma(this._rctx,{width:o,height:l,colorTarget:ka.TEXTURE,depthStencilTarget:Ja.DEPTH_STENCIL_RENDER_BUFFER})),p){const b=a.clone();if(t.ignorePadding){const C=NB(b.padding);for(let S=0;S<4;S++)C[S]=Math.round(C[S]/b.pixelRatio*t.pixelRatio);b.padding=C}b.fullWidth=o,b.fullHeight=l,b.pixelRatio=t.pixelRatio;const x=a.fovX-b.fovX,w=a.fovY-b.fovY;x<0&&x<w?b.fovX=a.fovX:w<0&&w<x&&(b.fovY=a.fovY),this._forceCameraHook(b),c=!0,r=new ma(this._rctx,{width:b.fullWidth,height:b.fullHeight,colorTarget:ka.TEXTURE,depthStencilTarget:Ja.DEPTH_STENCIL_RENDER_BUFFER}),this._renderFunctions.renderScene(r,s,b,t.disableDecorations?y2.OFF:y2.ON,n),this._disposeOffscreenBuffers()}const m=()=>{this._rctx.bindFramebuffer(null),Ht(r)},g=this._readbackScreenshot(t,m);m();let _=null;if(t.objectAndLayerIdColor){const b=()=>{this._rctx.bindFramebuffer(null),Ht(s)};this._rctx.bindFramebuffer(s),_=this._readbackScreenshot(t,b),this._rctx.bindFramebuffer(null),b()}if(p&&!this._rctx.contextAttributes.alpha)for(let b=3;b<g.data.length;b+=4)g.data[b]=255;if(_&&!this._rctx.contextAttributes.alpha)for(let b=3;b<_.data.length;b+=4)_.data[b]=255;return c&&this._forceCameraHook(a),[g,_]}_ensureScreenshotEncodeCanvas(){return this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas")),this._screenshotEncodeCanvas}},Ea=class extends vD(et){constructor(e){super({}),this.events=new Pn,this.waterTextureRepository=new US,this._magnifierHelper=new yw,this._objectAndLayerIdRenderHelper=Fi("enable-feature:objectAndLayerId-rendering")?new D0t:null,this._needsUpdate=!0,this._needsRender=!0,this._idleSuspend=!0,this._needsWaterReflectionUpdate=!1,this._lastAnimationUpdate=0,this._container=e.container,this._viewingMode=e.viewingMode,this._initializeContext(e),ue(()=>{var n;return(n=this.waterTextureRepository)==null?void 0:n.updating},()=>this.requestRender(),At),this._magnifierHelper.events.on("request-render",()=>this.requestRender()),this._stippleTextureRepository=new dre(this._rctx),this._shaderTechniqueRepository=new dfe({rctx:this._rctx,viewingMode:e.viewingMode,stippleTextureRepository:this._stippleTextureRepository,waterTextureRepository:this.waterTextureRepository}),this._textureRepository=new _w(e,this._shaderTechniqueRepository,this._rctx),this._textureRepository.events.on("changed",n=>this.requestRender(n)),this._materialRepository=new hfe(this._textureRepository,this._shaderTechniqueRepository,()=>this.requestRender(),()=>this.requestRender()),this._compositingHelper=new p0t(this._rctx,this._shaderTechniqueRepository),this._renderer=new rm(this._materialRepository,this._textureRepository,this._shaderTechniqueRepository,this._rctx,this._compositingHelper,this._magnifierHelper,n=>this.requestRender(n),(n,r)=>e.schedule(n,r),e);const t={renderScene:(n,r,s,a,o)=>this._renderer.render(n,r,{camera:s,contentCamera:s,mode:Ap.IDLE},a,o),requestRenderScene:n=>this.requestRender(n),prepareOverlay:()=>e.options.screenshot.prepareOverlay(),renderOverlay:(n,r)=>e.options.screenshot.renderOverlay(n,r)};this._screenshotManager=new z1t(this._rctx,t,n=>this.events.emit("force-camera-for-screenshot",n),()=>this._renderer.disposeOffscreenBuffers()),this._registerFrameTask(e)}normalizeCtorArgs(){return{}}dispose(){this._container.contains(this._canvas)&&this._container.removeChild(this._canvas),this._frameTask=Gr(this._frameTask),this._shaderTechniqueRepository=Ht(this._shaderTechniqueRepository),super.dispose(),this._tmpDepthBuffer=null,this._rctx=null}get performanceInfo(){const e=this._rctx.gl;return{renderer:this._renderer.performanceInfo,textureMemory:e.getUsedTextureMemory!==void 0?e.getUsedTextureMemory():void 0,renderbufferMemory:e.getUsedRenderbufferMemory!==void 0?e.getUsedRenderbufferMemory():void 0,VBOMemory:e.getUsedVBOMemory!==void 0?e.getUsedVBOMemory():void 0}}requestRender(e=ds.UPDATE){this._needsRender=!0,e===ds.UPDATE&&(this._needsUpdate=!0)}get updating(){return this._needsUpdate||this._needsWaterReflectionUpdate||this._renderer.updating||this._textureRepository.updating||this.waterTextureRepository.updating||this._magnifierHelper.updating}ensureEdgeView(){return this._renderer.ensureEdgeView()}get edgeView(){return this._renderer.edgeView}get textureRepository(){return this._textureRepository}get compositingHelper(){return this._compositingHelper}set magnifier(e){this._magnifierHelper.magnifier=e}setRenderParameters(e){e.idleSuspend!==void 0&&this._idleSuspend!==!!e.idleSuspend&&(this._idleSuspend=!!e.idleSuspend,this.requestRender()),this._renderer.setRenderParameters(e)}get renderingContext(){return this._rctx}get capabilities(){return this._rctx.capabilities}modify(e){this._renderer.modify(e),e.clear()}get canvas(){return this._canvas}takeScreenshot(e){return this._screenshotManager.takeScreenshot(e).then(t=>t[0])}takeScreenshotWithOID(e){return e.objectAndLayerIdColor=!0,this._screenshotManager.takeScreenshot(e)}getAlpha(){return this._rctx.contextAttributes.alpha}get shadowsEnabled(){return this._renderer.shadowsEnabled}readAccumulatedShadow(e){return this._renderer.readAccumulatedShadow(e[0],e[1])}readHUDVisibility(e,t,n,r,s){this._renderer.readHUDVisibility(e,t,n,r,s)}getMinimalDepthForArea(e,t,n,r,s,a=s){const o=r.constrainWindowSize(t,n,s*r.pixelRatio,a*r.pixelRatio),l=this._ensureDepthBuffer(o);this._renderer.readDepthPixels(r,o,l);let c=Number.MAX_VALUE;for(let u=0;u<o[2]*o[3];u++){const d=y0t(4*u,l,r.nearFar);c>d&&d!==r.nearFar[0]&&d!==r.nearFar[1]&&(c=d)}if(T(e)){const u=e.pickDepth(t*r.pixelRatio,n*r.pixelRatio,r);T(u)&&c>u&&u!==r.nearFar[0]&&u!==r.nearFar[1]&&(c=u)}return c===Number.MAX_VALUE?void 0:c}_ensureDepthBuffer(e){const t=4*e[2]*e[3];return(B(this._tmpDepthBuffer)||this._tmpDepthBuffer.byteLength<t)&&(this._tmpDepthBuffer=new Uint8Array(t)),this._tmpDepthBuffer}get renderPlugins(){return this._renderer.renderPlugins}get test(){return{renderer:this._renderer}}get gpuMemoryUsage(){return this._renderer.gpuMemoryUsage}async reloadShaders(){nme(),await this._shaderTechniqueRepository.reloadAll(),this.requestRender()}get animationTimestep(){return this._renderer.animationTimestep}_registerFrameTask(e){const t=e.state;let n=!1,r=ds.BACKGROUND,s=!1;const a={preRender:({time:o})=>{n=this.updating,r=this._needsUpdate?ds.UPDATE:ds.BACKGROUND,e.processSyncLayers(),(o-this._lastAnimationUpdate>this.animationTimestep||T(t.forcedAnimationTime)||n||this._needsRender)&&(o=Jt(t.forcedAnimationTime,o),this._renderer.updateAnimation({camera:t.camera,time:o})&&this.requestRender(ds.BACKGROUND),this._lastAnimationUpdate=o)},render:({time:o})=>{if((this._needsRender||!this._idleSuspend||!this._renderer.isCameraFinal||this._needsWaterReflectionUpdate)&&t.camera.fullWidth>0&&t.camera.fullHeight>0){const l=this._needsUpdate&&this._idleSuspend&&this._renderer.isCameraFinal;this._needsRender=!1,this._needsUpdate=!1,this._needsWaterReflectionUpdate=!1,this._renderer.render(null,null,t,y2.ON,o),s=!0,l&&this._renderer.hasWaterReflection&&(this.requestRender(ds.BACKGROUND),this._needsWaterReflectionUpdate=!0)}},update:({time:o})=>{const l=new B1t(t.camera,this._renderer.hasSlicePlane||this._magnifierHelper.enabled);this._textureRepository.update(),this._screenshotManager.update(l,o)},finish:()=>{s&&(this._renderer.finish(t.mode===Ap.IDLE?r:ds.UPDATE),s=!1)}};this._frameTask=Vm(a)}_initializeContext(e){const t=e.options;this._canvas=t.canvas,this._canvas||(this._canvas=document.createElement("canvas")),this._canvas.setAttribute("style","width: 100%; height:100%; display:block;");const n={alpha:t.alpha||!1,premultipliedAlpha:!0,antialias:!1,depth:!0,stencil:t.stencil==null||t.stencil,powerPreference:"high-performance",preserveDrawingBuffer:t.preserveDrawingBuffer??!1},r=p0e("3d",this._canvas,n);if(B(r)){const s=Fi("esri-force-webgl");tt.getLogger(this.declaredClass).error(s)}else this._rctx=this._newRenderingContext(r,e),this._loadShaderOnlyExtensions(),!t.alpha&&this._rctx.contextAttributes.alpha&&tt.getLogger(this.declaredClass).error("WebGL context has alpha channel even though no alpha channel was requested"),!this._rctx.contextAttributes.alpha&&Fi("safari")>=11&&(this._container.style.backgroundColor="black"),this._container.appendChild(this._canvas)}_newRenderingContext(e,t){const n={disabledExtensions:t.options.deactivatedWebGLExtensions||{},debugWebGLExtensions:t.options.debugWebGLExtensions||{},maxAnisotropy:8},r=(s,a)=>t.resourceController.memoryController.newCache(s,a);return new k1t(e,n,r)}_loadShaderOnlyExtensions(){this._rctx.capabilities.enable("standardDerivatives"),this._rctx.capabilities.enable("shaderTextureLOD"),this._rctx.capabilities.enable("textureFloat")}_getObjectAndLayerIdColor(e){return this._objectAndLayerIdRenderHelper?this._objectAndLayerIdRenderHelper.getObjectAndLayerIdColor(e):null}get componentObjectCollection(){return B(this._componentObjectCollection)&&(this._componentObjectCollection=new n0t(this._renderer.renderPassManager,this._viewingMode)),this._componentObjectCollection}set componentObjectCollection(e){this._componentObjectCollection=e}};f([y({type:Boolean,readOnly:!0})],Ea.prototype,"updating",null),f([qa()],Ea.prototype,"_rctx",void 0),f([qa()],Ea.prototype,"_container",void 0),f([qa()],Ea.prototype,"_canvas",void 0),f([qa()],Ea.prototype,"_stippleTextureRepository",void 0),f([qa(),y()],Ea.prototype,"waterTextureRepository",void 0),f([qa(),y()],Ea.prototype,"_magnifierHelper",void 0),f([y()],Ea.prototype,"_objectAndLayerIdRenderHelper",void 0),f([qa(),y()],Ea.prototype,"_textureRepository",void 0),f([qa()],Ea.prototype,"_compositingHelper",void 0),f([qa()],Ea.prototype,"_renderer",void 0),f([qa()],Ea.prototype,"_screenshotManager",void 0),f([qa()],Ea.prototype,"componentObjectCollection",null),f([qa()],Ea.prototype,"_componentObjectCollection",void 0),f([y()],Ea.prototype,"_needsUpdate",void 0),f([y()],Ea.prototype,"_needsWaterReflectionUpdate",void 0),Ea=f([ge("esri.views.3d.webgl-engine.parts.RenderView")],Ea);var xI;let Rl=xI=class extends vD(et){constructor(i){super(i),this._handles=new mi,this._model=new vI,this._layers=new pn,this._changeSet=new vfe,this._layerSyncSet=new Set}initialize(){this._set("renderView",new Ea(this)),this._frameTask=this.resourceController.scheduler.registerTask($r.STAGE,this),this._handles.add(this._frameTask)}destroy(){pb.pool.prune(0),this._handles.destroy(),this.dispose()}get viewingMode(){return this.state.viewingMode}get updating(){return this._model.dirtySet.dirty||this.renderView.updating||this._frameTask.updating}add(i){this._model.add(i),nL(i)&&(i.attachStage(this),this._addLayer(i)),this.renderView.requestRender()}remove(i){B(i)||(this.renderView.requestRender(),this._model.remove(i),nL(i)&&(this._removeLayer(i),i.detachStage()))}addMany(i){T(i)&&(this._model.addMany(i),this.renderView.requestRender())}removeMany(i){T(i)&&(this._model.removeMany(i),this.renderView.requestRender())}async load(i){B(i)||(Array.isArray(i)||(i=[i]),await Promise.all(i.filter(e=>B(e.glTexture)).map(e=>this.schedule(()=>this._model.has(e)?e.load(this.renderView.renderingContext,()=>this.renderView.textureRepository.textureTechnique):null))))}loadImmediate(i){return i.load(this.renderView.renderingContext,()=>this.renderView.textureRepository.textureTechnique)}forEachOfType(i,e){this._model.forEachOfType(i,e)}handleEvent(i,e){this.destroyed||(this._model.dirtySet[i](e),this.renderView.requestRender())}get running(){return this._model.dirtySet.dirty}runTask(i){this._frameTask.processQueue(i),i.done||this._commit()}_commit(){const i=this._model.dirtySet;xI.DebugSettings.logDirtySet&&console.log("Dirty set: "+i.formatDebugInfo()),i.commit(this._changeSet),xI.DebugSettings.logDirtySet&&(console.log("RGs add: "+this._changeSet.adds.map(e=>e.id)),console.log("RGs remove: "+this._changeSet.removes.map(e=>e.id))),this._layerSyncSet.clear(),this.renderView.modify(this._changeSet),this.renderView.requestRender()}schedule(i,e){return this._frameTask.schedule(i,e)}syncLayer(i){this._layerSyncSet.add(i),this.renderView.requestRender()}processSyncLayers(){const i=this._model.dirtySet;this._layers.forAll(e=>{(this._layerSyncSet.has(e.id)||e.updatePolicy===QI.SYNC)&&(i.commitLayer(e.id,this._changeSet),this._layerSyncSet.delete(e.id))});for(const e of this._layerSyncSet)i.commitLayer(e,this._changeSet);this._layerSyncSet.clear(),this.renderView.modify(this._changeSet)}getObject(i){return this._model.getObject(i)}get layers(){return this._layers}_addLayer(i){this._layers.includes(i)||this._layers.push(i)}_removeLayer(i){this._commit(),this._layers.removeUnordered(i)!=null&&(this._model.dirtySet.getResidentRenderGeometries(i.id,this._changeSet.removes),this.renderView.modify(this._changeSet))}addRenderPlugin(i,e,t){const n=this.renderView.renderPlugins.add(i,e,t),r=()=>{_J(e)&&this.sceneIntersectionHelper.addIntersectionHandler(e)};if(BA(n))return n.then(r);r()}removeRenderPlugin(i){_J(i)&&this.sceneIntersectionHelper.removeIntersectionHandler(i),this.renderView.renderPlugins.remove(i)}get performanceInfo(){return{renderView:this.renderView.performanceInfo,model:this._model.getStats()}}get test(){const i=this;return{getCount:e=>i._model.test.content.filter(t=>t.type===e).length,model:i._model}}};Rl.DebugSettings={endFrameContentValidation:!1,logDirtySet:!1},f([y({constructOnly:!0})],Rl.prototype,"resourceController",void 0),f([y({constructOnly:!0})],Rl.prototype,"options",void 0),f([y({constructOnly:!0})],Rl.prototype,"state",void 0),f([y({constructOnly:!0})],Rl.prototype,"sceneIntersectionHelper",void 0),f([y({readOnly:!0})],Rl.prototype,"viewingMode",null),f([y({constructOnly:!0})],Rl.prototype,"container",void 0),f([y({constructOnly:!0})],Rl.prototype,"renderSR",void 0),f([y({constructOnly:!0})],Rl.prototype,"_handles",void 0),f([y({readOnly:!0})],Rl.prototype,"updating",null),f([y({constructOnly:!0})],Rl.prototype,"_model",void 0),f([qa(),y()],Rl.prototype,"renderView",void 0),Rl=xI=f([ge("esri.views.3d.webgl-engine.Stage")],Rl);function Jme(i){return bf(i)&&i.intersector===Sr.PCL&&!!i.target}function ID(i){return bf(i)&&i.intersector===Sr.I3S&&!!i.target}function U1t(i){return bf(i)&&i.intersector===Sr.TERRAIN&&!!i.target}function ege(i){return bf(i)&&i.intersector===Sr.OVERLAY&&!!i.target}function $H(i){return bf(i)&&i.intersector===Sr.LOD&&!!i.target}function Kee(i,e){var t;return rD(i)||sD(i)?kA(i.target.object.metadata,e):U1t(i)?(t=e.map)==null?void 0:t.ground:Jme(i)||ID(i)||ege(i)?kA(i.target,e):null}function p6t(i,e){const t=w8(i,e);return T(t)&&t.type==="graphic"?t.graphic:null}function w8(i,e){if(B(i))return null;if(rD(i)||sD(i))return Yee(i.target.object.metadata,e);if(Jme(i)){const t=i.target.createGraphic();return{type:"graphic",graphic:t,layer:t.layer}}return ege(i)||$H(i)?Yee(i.target,e):ID(i)?H1t(i.target,e):null}function Yee(i,e){if(B(i)||B(i.graphicUid))return null;const t=kA(i,e);if(B(t))return null;if(t===e.graphics)return B(e.graphicsView)||typeof i.graphicUid!="number"?null:e.graphicsView.getHit(i.graphicUid);const n=e.allLayerViews.find(r=>r.layer===t);return!n||n.suspended||B(i.graphicUid)?null:"getHit"in n?n.getHit(i.graphicUid):null}function H1t(i,e){const t=kA(i,e);if(B(t))return null;const n=e.allLayerViews.find(r=>r.layer===t);return n&&!n.suspended&&"getGraphicFromIntersectorTarget"in n?W1t(n.getGraphicFromIntersectorTarget(i)):null}function G1t(i,e){const t=kA(i,e);if(B(t))return null;const n=e.allLayerViews.find(r=>r.layer===t);return n&&!n.suspended&&"getAABBFromIntersectorTarget"in n?n.getAABBFromIntersectorTarget(i):null}function W1t(i){return T(i)?{type:"graphic",graphic:i,layer:i.layer}:null}function kA(i,e){return B(i.layerUid)?null:T(e.graphicsView)&&i.layerUid===e.graphicsView.processor.layer.id?e.graphics:e.map.findLayerByUid(i.layerUid)}function f6t(i,e){if(rD(i)||sD(i))return cne(i.target.object.boundingVolumeWorldSpace.bounds);if($H(i)){k0e(OO,i.transformation);const t=Math.max(OO[0],OO[1],OO[2]);return i.target.baseBoundingSphere.radius*t}return ID(i)?Qa(G1t(i.target,e),t=>.5*ire(t)):null}function m6t(i){return!rD(i)&&!sD(i)&&($H(i)?i.target.numLodLevels>1:!!ID(i))}const OO=q();async function tge(i,e){if(i.type==="2d")return i.hitTest(e);const t=await i.hitTest(e);if(t.results.length===0)return t;const n=t.results[0],r=T(n.distance)?n.distance*(1+j1t):n.distance,s=t.results.findIndex(a=>a.distance>r);return s!==-1&&(t.results=t.results.slice(0,s)),t}const j1t=.05;function ige(i){return T(i)&&i.type==="graphic"}function q1t(i){return i.find(ige)??null}function nge(i){return i.filter(ige)}let CI=class extends Kde{constructor(e){super(e),this.components=["attribution","zoom","navigation-toggle","compass"]}};f([y()],CI.prototype,"components",void 0),CI=f([ge("esri.views.ui.3d.DefaultUI3D")],CI);const rge=CI;let Ut=class extends hue(Jue(ede(fde))){constructor(i){super(i),this._userClippingArea=null,this._clippingArea=null,this._initialDefaultSpatialReference=null,this._defaults={},this._externallySet={environment:!1},this._createGraphicsViewController=null,this._resolveWhenReady=[],this._propertiesPool=new Zm({slicePlane:ihe},this),this._resourceController=pgt(this),this._defaultToMapOptions={include:new Set},this._defaultHitTestOptions={exclude:new Set},this.deconflictor=new W6({view:this}),this.labeler=new B_({view:this,deconflictor:this.deconflictor.labels}),this.sharedSymbolResources=null,this.analyses=new mC,this.basemapTerrain=null,this.elevationProvider=null,this.canvas=null,this.constraints=new u0,this.environmentManager=new Wd,this.floors=new _i,this.fullOpacity=1,this.graphicsView=null,this.analysisViewManager=new Fnt({view:this}),this.groundView=null,this.map=null,this.screenSizePerspectiveEnabled=!0,this.state=new Umt,this.spatialReference=null,this.alphaCompositingEnabled=!1,this.preserveDrawingBufferEnabled=!1,this.supersampleScreenshotsEnabled=!0,this.type="3d",this.ui=new rge,this._numUpdating=0,this._lastUpdateTime=0,this.updatingProgress=.5,this.highlightOptions=new i8,this.voxelWasm=null,this.voxelWasmPromise=null,xie(),i&&i.environment||(this._defaults.environment=new fw,this.environment=this._defaults.environment);const e=(t=null)=>{T(t)&&t.type===xG.MOVE||(this._updatingChanged(),this.map&&this.map.allLayers.forEach(async n=>{try{await n.when()}catch{}this._updatingChanged()}))};this.handles.add([Sn(()=>{var t;return(t=this.map)==null?void 0:t.allLayers},"after-changes",t=>e(t),{onListenerAdd:()=>e(),onListenerRemove:()=>e(),sync:!0}),this.allLayerViews.on("after-changes",t=>this._updateUpdatingMonitors(t)),ue(()=>this.map,t=>{t&&"load"in t&&t.load&&t.load().catch(()=>{})})]),this.inputManager=new mct({view:this}),this.stateManager=new Us({view:this})}initialize(){this.groundView=new Dnt({view:this}),this._updateUpdatingMonitors();const i=()=>this._updateDefaultToMapOptions();this.handles.add(Sn(()=>{var e;return(e=this.map)==null?void 0:e.allLayers},"after-changes",i,{onListenerAdd:i,onListenerRemove:i})),this.updatingHandles.add(()=>this.qualitySettings.memoryLimit,e=>{this.resourceController&&(this.resourceController.memoryController.maxMemory=e)},At),this.updatingHandles.add(()=>this.qualitySettings.additionalCacheMemory,e=>{this.resourceController&&(this.resourceController.memoryController.additionalCacheMemory=e)},At),this.updatingHandles.add(()=>this.qualitySettings.frameRate,e=>lye(e>0?1e3/Math.ceil(e):0),At),this.updatingHandles.add(()=>{var e;return(e=this.map)==null?void 0:e.ground},i,hn),this.updatingHandles.add(()=>{var e,t;return(t=(e=this.map)==null?void 0:e.ground)==null?void 0:t.opacity},()=>this._updateDefaultHitTestOptions(),hn),this.handles.add(ue(()=>this.spatialReference,()=>this.notifyChange("clippingArea"),on))}destroy(){this.destroyed||(this.invalidate(),this.activeTool=null,this.layerViewManager.clear(),this._exitSurface(),this._disposeGraphicsView(),this.sharedSymbolResources=_t(this.sharedSymbolResources),this._set("labeler",_t(this.labeler)),this._set("deconflictor",_t(this.deconflictor)),this._resourceController=_t(this._resourceController),this._set("stateManager",_t(this.stateManager)),this._set("inputManager",_t(this.inputManager)),this.state.destroy(),this._propertiesPool.destroy(),this.handles.remove("updatingMonitors"),this._set("environmentManager",_t(this.environmentManager)),this.groundView=_t(this.groundView))}get renderSpatialReference(){return this.renderCoordsHelper&&this.renderCoordsHelper.spatialReference}get basemapSpatialReference(){var i;return(i=this.basemapTerrain)==null?void 0:i.spatialReference}get animation(){var i;return(i=this.state)==null?void 0:i.animation}get camera(){var i;return(i=this.stateManager)==null?void 0:i.camera}set camera(i){this.stateManager&&(this.stateManager.camera=i)}get contentCamera(){var i;return(i=this.stateManager)==null?void 0:i.contentCamera}set contentCamera(i){this.stateManager&&(this.stateManager.contentCamera=i)}installContentCameraReset(i={sticky:!1}){return this.stateManager.installContentCameraReset(i)}get center(){var i;return(i=this.stateManager)==null?void 0:i.center}set center(i){this.stateManager&&(this.stateManager.center=i)}get clippingArea(){if(this.viewingMode==="global")return null;let i=this._userClippingArea||this.get("map.clippingArea");return!(this._userClippingArea||this.get("map.clippingEnabled"))||B(i)?(this._clippingArea=null,null):i instanceof fs?this.spatialReference&&(i=RO(i,this.spatialReference),B(i))?(tt.getLogger(this.declaredClass).error("#clippingArea","setting clippingArea with incompatible SpatialReference"),this._clippingArea):(i=i.clone(),B(i.intersection(this._groundAndLayersExtent))&&(i.xmin=i.xmax,i.ymin=i.ymax),i.zmin=void 0,i.zmax=void 0,i.equals(this._clippingArea)||(this._clippingArea=i),this._clippingArea):(tt.getLogger(this.declaredClass).error("#clippingArea","only clippingArea geometries of type Extent are supported"),this._clippingArea)}set clippingArea(i){this.ready&&this.viewingMode==="global"&&T(i)?tt.getLogger(this.declaredClass).error("#clippingArea=","Clipping area is only supported in local viewingMode"):this._userClippingArea=i}get renderDataExtent(){if(this.state.viewingMode===Ot.Global)return null;const i=this.renderSpatialReference,e=this.dataExtent;return B(e)||B(i)||e.spatialReference.equals(i)?e:RO(e,i)}get dataExtent(){let i=this._groundAndLayersExtent;const e=this.spatialReference||$n.WGS84,t=RO(this.clippingArea,e);T(t)&&(i=T(i)?i.intersection(t):t);const n=this._get("dataExtent");return T(i)&&i.equals(n)?n:i}get _groundAndLayersExtent(){const i=this.spatialReference||$n.WGS84;let e;const t=s=>{const a=RO(s,i);B(a)||(T(e)?e.union(a):e=a.clone())},n=this.basemapTerrain;if(n!=null&&n.spatialReference){const s=n.groundExtent;t(new fs({xmin:s[0],ymin:s[1],zmin:0,xmax:s[2],ymax:s[3],zmax:0,spatialReference:n.spatialReference}))}if(this.map){const s=a=>{!T(a.fullExtent)||a.type==="graphics"&&a.internal||t(a.fullExtent)};this.map.allLayers.forEach(a=>s(a))}if(B(e))return null;e.hasZ?(e.zmin=Math.min(0,e.zmin),e.zmax=Math.max(0,e.zmax)):(e.zmin=0,e.zmax=0);const r=this._get("_groundAndLayersExtent");return e.equals(r)?r:e}set environment(i){i!==this._defaults.environment&&(this._externallySet.environment=!0),this._set("environment",i)}castEnvironment(i){return i?i instanceof fw?i:i instanceof Che?this.environment!=null?this.environment.cloneWithWebsceneEnvironment(i):fw.fromWebsceneEnvironment(i):kL(fw,i):new fw}get extent(){var i;return(i=this.stateManager)==null?void 0:i.extent}set extent(i){this.stateManager&&(this.stateManager.extent=i)}get screenCenter(){var i;return(i=this.stateManager)==null?void 0:i.screenCenter}get frustum(){var i;return(i=this.stateManager)==null?void 0:i.frustum}get initialExtentRequired(){return this.stateManager&&!this.stateManager.hasInitialView}get _defaultsFromMapSettings(){return{required:{tileInfo:!1,heightModelInfo:!0,extent:!1}}}get interacting(){return this.navigating||T(this.activeTool)}get stationary(){return!this.animation&&!this.resizing&&(B(this.state)||this.state.stationary)}get navigating(){var i;return((i=this.state)==null?void 0:i.navigating)??!1}get padding(){var i;return(i=this.stateManager)==null?void 0:i.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}set qualityProfile(i){uI.isValidProfile(i)&&(uI.apply(i,this.qualitySettings),this._set("qualityProfile",i))}get qualityProfile(){return this._get("qualityProfile")||uI.getDefaultProfile()}set slicePlane(i){if(T(this._stage)&&this._stage.renderView.setRenderParameters({slicePlane:i}),B(i))return void this._set("slicePlane",null);const e=this._propertiesPool.get("slicePlane");$b(i,e),this._set("slicePlane",e)}get typeSpecificPreconditionsReady(){return!!this.viewingMode}get resolution(){return this.spatialReference!=null?q0e(this.scale,this.spatialReference):0}get scale(){var i;return(i=this.stateManager)==null?void 0:i.scale}set scale(i){this.stateManager&&(this.stateManager.scale=i)}get heightModelInfo(){const i=this.getDefaultHeightModelInfo();return i!=null?jA.deriveUnitFromSR(i,this.spatialReference):null}get updating(){var n,r,s;if(this.destroyed)return!1;let i=0,e=this.layerViewManager.updating,t=e?this.layerViewManager.updatingRemaining:0;this.allLayerViews.forEach(a=>{if(a.isFulfilled()){if(a.updating){if(e=!0,a.suspended||AA(a))return;++t,i+=a.updatingProgress}}else++t});for(const a of[this.graphicsView,this.basemapView,this._resourceController,this._stage,this.featureTiles,this.pointsOfInterest,this.environmentManager,this.overlay,this._featureTreeDebugger,this.toolViewManager,this.analysisViewManager])T(a)&&a.updating&&(t+=.1,i+=.5*.1);for(const a of[this.deconflictor,this.labeler,this.basemapTerrain])T(a)&&a.updating&&(++t,i+=a.updatingProgress);if(e=!!(e||t>0||this.updatingHandles.updating||!this.ready||!this.stationary||this._createGraphicsViewController||(n=this.inputManager)!=null&&n.hasPendingInputs||(s=(r=this.map)==null?void 0:r.allLayers)!=null&&s.some(a=>!a.isFulfilled())),e?(this._numUpdating=Math.max(t,this._numUpdating),i+=this._numUpdating-t):this._numUpdating=0,this._numUpdating>0?i/=this._numUpdating:i=e?0:1,this._get("updatingProgress")!==i){const a=performance.now();if(i<1){const o=Math.min((a-this._lastUpdateTime)/2e3,1);i=this.updatingProgress*(1-o)+i*o}this._set("updatingProgress",i),this._lastUpdateTime=e&&i<1?a:0}return e}get viewingMode(){var t;const i=this._predeterminedViewingMode;if(T(i))return iE(i);const e=this.spatialReference;return e?T((t=this.defaultsFromMap)==null?void 0:t.viewingMode)&&e.equals(this.defaultsFromMap.spatialReference)?iE(this.defaultsFromMap.viewingMode):vA(e,Ot.Global)?"global":"local":"global"}set viewingMode(i){this.ready?tt.getLogger(this.declaredClass).error("#viewingMode","viewingMode cannot be set once view is ready"):this._overrideIfSome("viewingMode",i)}get viewpoint(){var i;return(i=this.stateManager)==null?void 0:i.viewpoint}set viewpoint(i){this.stateManager&&(this.stateManager.viewpoint=i)}get zoom(){var i;return(i=this.stateManager)==null?void 0:i.zoom}set zoom(i){this.stateManager&&(this.stateManager.zoom=i)}get resourceController(){return this._resourceController}get performanceInfo(){return new Vgt(this)}on(i,e,t,n){return this.viewEvents.on(i,e,t,n)||super.on(i,e)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}toMap(i,e){if(!this.ready)return tt.getLogger(this.declaredClass).error("#toMap()","Scene view cannot be used before it is ready"),null;const t=e?this.externalToInternalIntersectOptions(e):this._defaultToMapOptions,n=T(t.graphics)&&(T(t.graphics.include)||T(t.graphics.exclude)),r=I$(i)?R$(this,i):i,s=Ep(r);t.enableDraped=t.include&&!t.include.has(lh)||t.exclude&&t.exclude.has(lh);const a=this.sceneIntersectionHelper,o=Od(this.state.viewingMode);if(o.options.selectionMode=!0,o.options.store=n?Fa.ALL:Fa.MIN,a.intersectIntersectorScreen(s,o,t),n){for(const l of o.results.all){const c=w8(l,this);if(B(c))return this._intersectResultToMapPoint(l);if(c.type!=="graphic"||this._testGraphicUidFilter(t.graphics,c.graphic))return this._intersectResultToMapPoint(l)}return null}return this._intersectResultToMapPoint(o.results.min)}toScreen(i){if(!this.ready)return tt.getLogger(this.declaredClass).error("#toScreen()","Scene view cannot be used before it is ready"),null;const e=Jt(i.z==null&&Vp(this.elevationProvider,i),0);return ya(i,z1,this.renderSpatialReference,e),this.state.camera.projectToScreen(z1,X4),Cs(X4[0],X4[1])}pixelSizeAt(i){return this.ready?i?(ya(i,z1,this.renderSpatialReference),this.state.camera.computeScreenPixelSizeAt(z1)):0:(tt.getLogger(this.declaredClass).error("#pixelSizeAt()","Scene view cannot be used before it is ready"),null)}overlayPixelSizeInMapUnits(i){const e=this.basemapTerrain.overlayManager;return e?e.overlayPixelSizeInMapUnits(i):1}hitTest(i,e){if(!this.ready)return tt.getLogger(this.declaredClass).error("#hitTest()","Scene view cannot be used before it is ready"),null;const t=I$(i)?R$(this,i):i,n=Fn(t.x,t.y),r=e?this.externalToInternalIntersectOptions(e):this._defaultHitTestOptions;r.requiresGroundFeedback=!0,r.enableDraped=!0;const s=Od(this.state.viewingMode);s.options.selectionMode=!0,s.options.store=Fa.ALL,this.sceneIntersectionHelper.intersectIntersectorScreen(n,s,r);const a=this._intersectResultsToHits(s.results.all,r.graphics),o=s.results.ground,l=Kee(o,this),c=T(l)&&"type"in l&&l.type==="integrated-mesh"?l:null,u={screenPoint:t,results:a,ground:{mapPoint:this._intersectResultToMapPoint(o),distance:bf(o)?o.distanceInRenderSpace:0,layer:c}};return cn.SCENEVIEW_HITTEST_RETURN_INTERSECTOR&&(u.intersector=s),Promise.resolve(u)}async popupHitTest(i){const{results:e,ground:t}=await tge(this,i);let n=null;return!(e.length===0||Math.abs(Jt(e[0].distance,0)-t.distance)<1e-5)||t.layer&&t.layer.type==="integrated-mesh"||(n=t.mapPoint),{results:e,screenPoint:i,mapPoint:n}}goTo(i,e){return this.updatingHandles.addPromise(this.stateManager.goTo(i,e))}async whenAnalysisView(i){if(B(i.parent))throw new Ze("view:no-analysisview-for-analysis","The analysis has not been added to view.analyses",{analysis:i});switch(i.parent.type){case"line-of-sight":case"dimension":return(await this.whenLayerView(i.parent)).whenAnalysisView();default:return this.analysisViewManager.whenAnalysisView(i)}}whenLayerView(i){return super.whenLayerView(i)}async takeScreenshot(i){const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshot(e);return KR(t,e,this._pixelFormat())}async _takeScreenshot(i){const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshot(e);return Dde(t,this._pixelFormat())}_completeSettings(i){const e=Tit(i,this);return e.pixelRatio/=this.state.pixelRatio,Oit(e,this.supersampleScreenshotsEnabled,this.padding)}_pixelFormat(){return{flipY:!0,premultipliedAlpha:this._stage.renderView.getAlpha()}}get test(){return{takeScreenshot:i=>this._takeScreenshot(i)}}async takeScreenshotWithObjectAndLayerId(i){if(!Fi("enable-feature:objectAndLayerId-rendering"))throw new Error("has enable-feature:objectAndLayerId-rendering must be true");const e=this._completeSettings(i);await this.whenReady();const t=await this._stage.renderView.takeScreenshotWithOID(e),n=KR(t[0],e,this._pixelFormat()),r=this._completeSettings(i);return r.format="png",[n,KR(t[1],r,this._pixelFormat())]}getColorToObjectAndLayerIdMapping(){if(!Fi("enable-feature:objectAndLayerId-rendering"))throw new Error("has enable-feature:objectAndLayerId-rendering must be true");return this._stage.renderView._objectAndLayerIdRenderHelper.getColorToObjectAndLayerIdMapping()}addUpdatingPromise(i){return this.updatingHandles.addPromise(i)}importLayerView(i){return pX.importLayerView(i)}hasLayerViewModule(i){return pX.hasLayerViewModule(i)}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var i,e,t,n;return this.map&&"initialViewProperties"in this.map&&((e=(i=this.map)==null?void 0:i.initialViewProperties)==null?void 0:e.spatialReference)||((t=this.defaultsFromMap)==null?void 0:t.spatialReference)||((n=this.defaultsFromMap)==null?void 0:n.ready)&&this._initialDefaultSpatialReference||null}async validate(){let i=Bde(this.type);if(Fi("safari")&&Fi("safari")<9&&(i=new Ze("sceneview:browser-not-supported","This browser is not supported by SceneView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Fi("safari")})),T(i))throw tt.getLogger(this.declaredClass).warn("#validate()",i.message),i}get _predeterminedViewingMode(){var e;const i=this._isOverridden("viewingMode")?this._get("viewingMode"):(this.map&&"initialViewProperties"in this.map?(e=this.map.initialViewProperties)==null?void 0:e.viewingMode:null)??null;return T(i)?kG(i):null}getSpatialReferenceSupport({spatialReference:i,layer:e}){const t=this._predeterminedViewingMode;if(T(t))return this._validateSpatialReferenceForViewingMode(i,e,t)?{constraints:this._makeSpatialReferenceConstraints(i,e,t)}:null;const n=this._validateSpatialReferenceForViewingMode(i,e,Ot.Local),r=this._validateSpatialReferenceForViewingMode(i,e,Ot.Global);return n||r?n&&r?{constraints:this._makeSpatialReferenceConstraints(i,e,null)}:n?{constraints:this._makeSpatialReferenceConstraints(i,e,Ot.Local)}:{constraints:this._makeSpatialReferenceConstraints(i,e,Ot.Global)}:null}_validateSpatialReferenceForViewingMode(i,e,t){return!!vA(i,t)&&(!!B(e)||!!GG(e)||(!ax(e)||!B(SD(e,i,t)))&&(!WG(e)||t!==Ot.Global))}_makeSpatialReferenceConstraints(i,e,t){if(B(e))return[{spatialReference:i,viewingMode:t}];const n=i.isWebMercator,r=i.isWGS84;return GG(e)&&(n||r)?!r||t===Ot.Local||MA(e.tileInfo,e.fullExtent,i,Ot.Global)===null?[{spatialReference:i,viewingMode:t},{spatialReference:$n.WebMercator,viewingMode:t}]:[{spatialReference:n?$n.WGS84:$n.WebMercator,viewingMode:t}]:ax(e)||WG(e)||!n&&!r?ax(e)&&n&&t!==Ot.Global?[{spatialReference:i,viewingMode:t},{spatialReference:$n.WGS84,viewingMode:Ot.Local}]:[{spatialReference:i,viewingMode:t}]:[{spatialReference:i,viewingMode:t},{spatialReference:n?$n.WGS84:$n.WebMercator,viewingMode:t}]}_validateSpatialReference(i){const e=T(this.getSpatialReferenceSupport({spatialReference:i})),t=this._predeterminedViewingMode;return e||(T(t)?tt.getLogger(this.declaredClass).warnOnce(`Spatial reference defined on view not supported in ${iE(t)} viewing mode.`):i.isGeographic&&tt.getLogger(this.declaredClass).warnOnce("Spatial reference is geographic but not supported.")),e}whenReady(){return new Promise(i=>{this.ready?i(this):this._resolveWhenReady.push(i)})}computeMapPointFromVec3d(i,e){let t=this.spatialReference||$n.WGS84;return no(i,this.renderSpatialReference,i,t)||(t=$n.WGS84,no(i,this.renderSpatialReference,i,t)),e?(e.x=i[0],e.y=i[1],e.z=i[2],e.spatialReference=t):e=new Wt(i,t),e}trackGraphicState(i){if(!i.graphic)return tt.getLogger(this.declaredClass).error("trackGraphicState","GraphicState.graphic must not be null or undefined to start tracking"),null;const e=this.getViewForGraphic(i.graphic);let t=null,n=!1;const r=s=>{var a;!n&&T(s)&&"processor"in s&&((a=s.processor)==null?void 0:a.type)==="graphics-3d"&&s.processor.graphicsCore&&(t=s.processor.graphicsCore.trackGraphicState(i))};return T(e)?r(e):this.whenViewForGraphic(i.graphic,{waitForLayer:!0}).then(s=>r(s),()=>{}).catch(()=>{}),{remove:()=>{n=!0,T(t)&&(t.remove(),t=null)}}}highlight(i){if(Array.isArray(i))return JE(i.map(t=>this.highlight(t)));if(_i.isCollection(i))return JE(i.toArray().map(t=>this.highlight(t)));const e=this.getViewForGraphic(i);return e&&"highlight"in e?e.highlight(i):bh()}maskOccludee(i){if(!i)return tt.getLogger(this.declaredClass).error("maskOccludee","GraphicState.graphic must not be null or undefined to mask an occludee"),null;const e=this.getViewForGraphic(i);let t=null,n=!1;const r=s=>{!n&&T(s)&&ket(s)&&(t=s.maskOccludee(i))};return T(e)?r(e):this.whenViewForGraphic(i,{waitForLayer:!0}).then(s=>r(s),()=>{}).catch(()=>{}),{remove:()=>{n=!0,T(t)&&(t.remove(),t=null)}}}getViewForGraphic(i){return i.layer===this.graphics?this.graphicsView:i.layer?this.allLayerViews.find(e=>e.layer===i.layer):null}graphicChanged(i){T(this.graphicsView)&&this.graphicsView.graphicChanged(i)}async whenViewForGraphic(i,e){if(i.layer===this)return await $u(()=>this.graphicsView),this.graphicsView;if(!i.layer||!this.map)throw new Ze("no-view-for-graphic");return e&&e.waitForLayer&&!this.map.allLayers.includes(i.layer)?new Promise((t,n)=>{const r=this.map.allLayers.on("change",s=>{s.added.includes(i.layer)&&(r.remove(),this.whenLayerView(i.layer).then(t,n))})}):this.whenLayerView(i.layer)}externalToInternalIntersectOptions(i){const e=this._externalToInternalRenderItems(i.include,BE.INCLUDE),t=this._externalToInternalRenderItems(i.exclude,BE.EXCLUDE);return{include:e.layerUids,exclude:t.layerUids,graphics:{include:e.graphicUids,exclude:t.graphicUids}}}_intersectResultToMapPoint(i,e){return i.getIntersectionPoint(z1)?(e=this.computeMapPointFromVec3d(z1,e),i.intersector===Sr.TERRAIN&&this.basemapTerrain&&(e.z=Jt(Vp(this.basemapTerrain,e),0)),e):null}_intersectResultsToHits(i,e){const t=new Array;let n=null;for(let r=0;r<i.length;r++){const s=i[r],a=Kee(s,this);if(T(a)&&(a===this.map.ground||"type"in a&&a.type==="integrated-mesh"))break;const o=w8(s,this);if(B(o))continue;if(o.type==="graphic"){if(B(n)&&r!==i.length-1&&(n=new Set),T(n)){const u=this._getGraphicFilterUid(o.graphic);if(n.has(u))continue;n.add(u)}if(!this._testGraphicUidFilter(e,o.graphic))continue}const l=this._intersectResultToMapPoint(s),c=s.distanceInRenderSpace;t.push({...o,mapPoint:l,distance:c})}return t}_getGraphicFilterUid(i){const e=i.sourceLayer,t=i.layer,n=e&&"objectIdField"in e?e:t&&"objectIdField"in t?t:e;if(n){const r=n.objectIdField??Hue,s=i.attributes[r];if(s)return`o-${n.id}-${s}`}return`u-${i.uid}`}_testGraphicUidFilter(i,e){const t=this._getGraphicFilterUid(e);return B(i)||(B(i.include)||i.include.has(t))&&(B(i.exclude)||!i.exclude.has(t))}_externalToInternalRenderItems(i,e,t={layerUids:null,graphicUids:null}){if(!i)return t;if(i instanceof ao)K1t(t,this._getGraphicFilterUid(i)),e===BE.INCLUDE&&(T(this.graphicsView)&&i.layer===this?sS(t,this.graphicsView.processor.layer.id):i.layer&&sS(t,i.layer.uid));else if(MN(i))for(const n of i)n===this.graphics&&T(this.graphicsView)?sS(t,this.graphicsView.processor.layer.id):n===this.map.ground?sS(t,lh):this._externalToInternalRenderItems(n,e,t);else"uid"in i&&sS(t,i.uid);return t}_initBasemapTerrain(){this._set("basemapTerrain",new f_t({view:this})),this._set("elevationProvider",new kS({view:this})),this.elevationProvider.register("ground",this.basemapTerrain)}_exitBasemapTerrain(){this.basemapTerrain&&(this.elevationProvider.unregister(this.basemapTerrain),this.elevationProvider.destroy(),this._set("elevationProvider",null),this.basemapTerrain.destroy(),this._set("basemapTerrain",null))}_initGlobe(){this._initCoordinateSystem(),this.state.createInitialCamera(),this._initBasemapTerrain(),this._set("pointsOfInterest",new wo({view:this})),this._set("featureTiles",new Aa({renderCoordsHelper:this.renderCoordsHelper,cameraOnSurface:this.pointsOfInterest.contentCameraOnSurface,focus:this.pointsOfInterest.focus,tilingSchemeOwner:this.basemapTerrain,viewState:this.state,scheduler:this._resourceController.scheduler,terrain:this.basemapTerrain}));const i=()=>{var t;const e=(t=this.basemapTerrain)==null?void 0:t.extent;if(this.clippingArea||e)if(e&&this.basemapTerrain.spatialReference){const n=T(this.basemapTerrain.extent)&&T(this.basemapTerrain.spatialReference)?Bc(nne(this.basemapTerrain.extent,this.basemapTerrain.spatialReference),this.spatialReference):null;T(this.clippingArea)?this.featureTiles.filterExtent=this.clippingArea.intersection(n):this.featureTiles.filterExtent=n}else this.featureTiles.filterExtent=this.clippingArea;else this.featureTiles.filterExtent=null};this.handles.add([this.updatingHandles.add(()=>cn.FEATURE_TILE_TREE_SHOW_TILES,e=>{e&&this.featureTiles&&!this._featureTreeDebugger?this.updatingHandles.addPromise(Ee(()=>import("./FeatureTileTree3DDebugger-9ad13e24.js"),["./FeatureTileTree3DDebugger-9ad13e24.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./reactiveUtils-f41a4e00.js","./HandleOwner-e1406413.js","./TileTreeDebugger-5ce82b98.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js"],import.meta.url)).then(({FeatureTileTree3DDebugger:t})=>{!this._featureTreeDebugger&&cn.FEATURE_TILE_TREE_SHOW_TILES&&(this._featureTreeDebugger=new t({view:this}))}):e||!this._featureTreeDebugger||cn.FEATURE_TILE_TREE_SHOW_TILES||(this._featureTreeDebugger.destroy(),this._featureTreeDebugger=null)},hn),this.updatingHandles.add(()=>this.clippingArea,i,hn),this.updatingHandles.add(()=>this.basemapTerrain.extent,i,hn)],"feature-tiles"),this.stateManager.init()}_exitGlobe(){this.state&&(this.stateManager.exit(),this.handles.remove("render-coords-helper"),this.handles.remove("feature-tiles"),this.featureTiles.destroy(),this._set("featureTiles",null),this.pointsOfInterest.destroy(),this._set("pointsOfInterest",null),this._exitBasemapTerrain(),this.state.exit(),this._exitCoordinateSystem())}_initCoordinateSystem(){if(this.spatialReference){const i=this.spatialReference;this.mapCoordsHelper&&this.mapCoordsHelper.spatialReference.equals(i)||this._set("mapCoordsHelper",new Xmt(this.map,i));const e=this.state.isGlobal,t=ghe(e,i);t!==this.renderSpatialReference&&(this._set("renderCoordsHelper",n8.create(this.state.viewingMode,t)),e||this.handles.add(ue(()=>{var n;return(n=this.basemapTerrain)==null?void 0:n.extent},n=>{const r=this.renderCoordsHelper.spatialReference;n&&(n[0]!==0||n[1]!==0||n[2]!==0||n[3]!==0)&&zL(n,this.basemapTerrain.spatialReference,Xee,r)&&(this.renderCoordsHelper.extent=Xee)},on),"render-coords-helper"),this.sceneIntersectionHelper&&this.sceneIntersectionHelper.setTolerance(gC/this.renderCoordsHelper.unitInMeters))}else this._set("mapCoordsHelper",null),this._set("renderCoordsHelper",null)}_exitCoordinateSystem(){this.mapCoordsHelper&&(this.handles.remove("render-coords-helper"),this._set("renderCoordsHelper",null),this._set("mapCoordsHelper",null))}_updatingChanged(){this.notifyChange("updating")}_updateUpdatingMonitors(i=null){T(i)&&i.type===xG.MOVE||(this.handles.remove("updatingMonitors"),this.allLayerViews.forEach(e=>{e.destroyed||(this.handles.add(ue(()=>[e.updating,e.updatingProgress],()=>this._updatingChanged(),on),"updatingMonitors"),e.when(()=>this._updatingChanged(),()=>this._updatingChanged()))}),this._updatingChanged())}async _prepareScreenshotOverlay(){this.overlay&&await this.overlay.prepare()}_renderScreenshotOverlay(i,e){if(!this.overlay||!this.overlay.hasVisibleItems)return e;const t=i.getContext("2d");return t.putImageData(e,0,0),this.overlay.renderCanvas(i),t.getImageData(0,0,e.width,e.height)}_initStage(){const i={deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions,alpha:this.alphaCompositingEnabled,preserveDrawingBuffer:this.preserveDrawingBufferEnabled,canvas:this.renderCanvas,screenshot:{prepareOverlay:()=>this._prepareScreenshotOverlay(),renderOverlay:(o,l)=>this._renderScreenshotOverlay(o,l)}},e=new Hmt(this.state.viewingMode,o=>this._stage.layers.forAll(o),this);this._set("sceneIntersectionHelper",e);const t=uB(this.surface),{resourceController:n,state:r,renderSpatialReference:s}=this;this._stage=new Rl({options:i,container:t,resourceController:n,state:r,sceneIntersectionHelper:e,renderSR:s}),this._stage.renderView.setRenderParameters({slicePlane:this.slicePlane}),this._lostWebGLContextHandle=mye(this._stage.renderView.canvas,"webglcontextlost",()=>this.fatalError=new Ze("webgl-context-lost")),this.handles.add([this.updatingHandles.add(()=>this.qualitySettings.antialiasingEnabled,()=>this._stage.renderView.setRenderParameters({antialiasingEnabled:this.qualitySettings.antialiasingEnabled}),At),this.updatingHandles.add(()=>this.qualitySettings.highQualityTransparency,()=>this._stage.renderView.setRenderParameters({highQualityTransparency:this.qualitySettings.highQualityTransparency}),At),ue(()=>this.magnifier,o=>this._stage.renderView.magnifier=o,hn)],"stage");const a=()=>{this._stage.renderView.setRenderParameters({defaultHighlightOptions:i8.toEngineOptions(this.highlightOptions)})};this.handles.add(this.updatingHandles.add(()=>[this.highlightOptions.color,this.highlightOptions.haloColor,this.highlightOptions.haloOpacity,this.highlightOptions.fillOpacity,this.highlightOptions.shadowOpacity,this.highlightOptions.shadowColor,this.highlightOptions.shadowDifference],a),"stage"),a(),this.renderCoordsHelper&&this.sceneIntersectionHelper.setTolerance(gC/this.renderCoordsHelper.unitInMeters),this._set("canvas",this._stage.renderView.canvas)}_exitStage(){this._set("sceneIntersectionHelper",null),this._stage.destroy(),this._stage=null,this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null,this.handles.remove("stage"),this._set("canvas",null)}_initSurface(i){this._exitSurface(),this.state.init(i,this.spatialReference),this._initStage(),this._initGlobe(),this.sharedSymbolResources=new Ugt({view:this,viewingMode:i,resourceController:this._resourceController,pointsOfInterest:this.pointsOfInterest,viewState:this.state})}_exitSurface(){this.sharedSymbolResources&&(this.sharedSymbolResources.objectResourceCache.destroy(),this.sharedSymbolResources.destroy(),this.sharedSymbolResources=null,this._exitGlobe(),this._exitStage())}_createGraphicsViewIfNeeded(){if(this.graphicsView||this._createGraphicsViewController||this.graphics.length===0)return;this.handles.remove("graphics-view"),this._createGraphicsViewController=new AbortController;const i=()=>{this._createGraphicsViewController=null,this._updatingChanged()};this._createGraphicsViewAsync(this._createGraphicsViewController.signal).then(i,i),this._updatingChanged()}async _createGraphicsViewAsync(i){const e=(await Ee(()=>import("./GraphicsView3D-3422fad8.js"),["./GraphicsView3D-3422fad8.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Identifiable-aa6d459d.js","./GraphicsProcessor-8dba02d6.js","./Graphic-b46e2684.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./HandleOwner-e1406413.js","./reactiveUtils-f41a4e00.js","./diffUtils-1ac65748.js","./Layer-f0696768.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Graphics3DObjectStates-2cd67a8a.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./quantizationUtils-33aba427.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./asyncUtils-62e8a185.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./ElevationInfo-ce9cacc2.js","./basicInterfaces-19ed850e.js","./Scheduler-8433672d.js","./GraphicsView-935faaa9.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url)).default;Cn(i),await $u(()=>{var t;return(t=this.basemapTerrain)==null?void 0:t.ready},i),this._set("graphicsView",new e({view:this}))}_disposeGraphicsView(){this._createGraphicsViewController&&(this._createGraphicsViewController.abort(),this._createGraphicsViewController=null),this.handles.remove("graphics-view"),T(this.graphicsView)&&(this.handles.remove(this.graphicsView.processor.layer.id),this.graphicsView.destroy(),this._set("graphicsView",null))}_startup(){const i=kG(this.viewingMode);if(i===Ot.Global&&(this._clippingArea=null),this._initSurface(i),this._set("ready",!0),this.handles.add(Sn(()=>this.graphics,"after-changes",()=>this._createGraphicsViewIfNeeded()),"graphics-view"),this._createGraphicsViewIfNeeded(),!this._externallySet.environment){const t=this.get("map.initialViewProperties.environment");t&&(this.environment=t)}this.labeler.setup(),this.environmentManager.connectView(this),this.inputManager.connect();const e=this._resolveWhenReady;this._resolveWhenReady=[],e.forEach(t=>t(this))}_teardown(){this._initialDefaultSpatialReference=null,this.inputManager.disconnect(),this.environmentManager.disconnectView(),this.labeler.dispose(),this._disposeGraphicsView(),this.handles.remove("graphics-view"),this._exitSurface(),this._set("ready",!1)}_updateDefaultToMapOptions(){if(this._defaultToMapOptions.include.clear(),this.map){this.map.ground&&this._defaultToMapOptions.include.add(lh);for(const i of this.map.allLayers.items)i.type==="integrated-mesh"&&this._defaultToMapOptions.include.add(i.uid)}}_updateDefaultHitTestOptions(){if(this._defaultHitTestOptions.exclude.clear(),this.map){this.map.ground&&this.map.ground.opacity<1&&this._defaultHitTestOptions.exclude.add(lh);for(const i of this.map.allLayers.items)i.type==="integrated-mesh"&&i.opacity<1&&this._defaultToMapOptions.exclude.add(i.uid)}}addVoxelLayerViewToWasm(i){return B(this.voxelWasm)?(B(this.voxelWasmPromise)&&(this.voxelWasmPromise=Ee(()=>import("./VoxelWasmPerSceneView-62f4f399.js"),["./VoxelWasmPerSceneView-62f4f399.js","./request-d3e98716.js","./preload-helper-41c905a7.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./Octree-1a841545.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./sphere-4f5e644f.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./mat4-44a0988f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./plane-45609588.js","./Util-a48361c6.js","./assets-0b172f07.js","./ViewingMode-5d7d590b.js","./Matrix3PassUniform-da8eddae.js","./ShaderBuilder-93e8045e.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./asyncUtils-62e8a185.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./basicInterfaces-19ed850e.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./Evented-515b9d9c.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./mat4f32-77b3d8ac.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./jsonMap-c1f958cf.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url).then(e=>(this.voxelWasm=new e.default(this),this.voxelWasm))),this.voxelWasmPromise.then(e=>e.addVoxelLayer(i))):this.voxelWasm.addVoxelLayer(i)}removeVoxelLayerViewFromWasm(i){T(this.voxelWasm)&&this.voxelWasm.removeVoxelLayer(i)<1&&(this.voxelWasm=null,this.voxelWasmPromise=null)}};function sS(i,e){i.layerUids||(i.layerUids=new Set),i.layerUids.add(e)}function K1t(i,e){i.graphicUids||(i.graphicUids=new Set),i.graphicUids.add(e)}function RO(i,e){return T(i)&&$y(i.spatialReference,e)?Bc(i,e):null}var BE;Ut.type="3d",f([y()],Ut.prototype,"_userClippingArea",void 0),f([y()],Ut.prototype,"_resourceController",void 0),f([y()],Ut.prototype,"_stage",void 0),f([y({readOnly:!0})],Ut.prototype,"deconflictor",void 0),f([y({readOnly:!0})],Ut.prototype,"labeler",void 0),f([y(BN(mC,"analyses"))],Ut.prototype,"analyses",void 0),f([y({type:Qm,readOnly:!0})],Ut.prototype,"animation",null),f([y({readOnly:!0})],Ut.prototype,"basemapTerrain",void 0),f([y({readOnly:!0})],Ut.prototype,"elevationProvider",void 0),f([y()],Ut.prototype,"camera",null),f([y({type:ku})],Ut.prototype,"contentCamera",null),f([y({readOnly:!0})],Ut.prototype,"canvas",void 0),f([y({type:Wt})],Ut.prototype,"center",null),f([y({type:fs})],Ut.prototype,"clippingArea",null),f([y({type:u0})],Ut.prototype,"constraints",void 0),f([y({type:fs,readOnly:!0})],Ut.prototype,"renderDataExtent",null),f([y({type:fs,readOnly:!0})],Ut.prototype,"dataExtent",null),f([y({type:fs,readOnly:!0})],Ut.prototype,"_groundAndLayersExtent",null),f([y({value:null,type:fw})],Ut.prototype,"environment",null),f([Mr("environment")],Ut.prototype,"castEnvironment",null),f([y({readOnly:!0})],Ut.prototype,"environmentManager",void 0),f([y({type:fs})],Ut.prototype,"extent",null),f([y()],Ut.prototype,"floors",void 0),f([y()],Ut.prototype,"screenCenter",null),f([y()],Ut.prototype,"frustum",null),f([y({type:Number,readOnly:!0})],Ut.prototype,"fullOpacity",void 0),f([y({readOnly:!0})],Ut.prototype,"graphicsView",void 0),f([y({readOnly:!0})],Ut.prototype,"analysisViewManager",void 0),f([y()],Ut.prototype,"groundView",void 0),f([y({type:Boolean})],Ut.prototype,"initialExtentRequired",null),f([y()],Ut.prototype,"_defaultsFromMapSettings",null),f([y()],Ut.prototype,"interacting",null),f([y()],Ut.prototype,"stationary",null),f([y()],Ut.prototype,"navigating",null),f([y()],Ut.prototype,"map",void 0),f([y({readOnly:!0})],Ut.prototype,"mapCoordsHelper",void 0),f([y()],Ut.prototype,"padding",null),f([y({type:wo,readOnly:!0})],Ut.prototype,"pointsOfInterest",void 0),f([y({type:Aa,readOnly:!0})],Ut.prototype,"featureTiles",void 0),f([y()],Ut.prototype,"_featureTreeDebugger",void 0),f([y({type:Boolean})],Ut.prototype,"screenSizePerspectiveEnabled",void 0),f([y({constructOnly:!0})],Ut.prototype,"deactivatedWebGLExtensions",void 0),f([y({constructOnly:!0})],Ut.prototype,"debugWebGLExtensions",void 0),f([y({constructOnly:!0})],Ut.prototype,"renderCanvas",void 0),f([y({constructOnly:!0})],Ut.prototype,"state",void 0),f([y({readOnly:!0})],Ut.prototype,"inputManager",void 0),f([y({readOnly:!0})],Ut.prototype,"stateManager",void 0),f([y({type:["low","medium","high"]})],Ut.prototype,"qualityProfile",null),f([y({type:wJ,get(){let i=this._get("qualitySettings");return i||(i=new wJ,uI.apply(this.qualityProfile,i)),i}})],Ut.prototype,"qualitySettings",void 0),f([y()],Ut.prototype,"slicePlane",null),f([y({readOnly:!0})],Ut.prototype,"typeSpecificPreconditionsReady",null),f([y({readOnly:!0})],Ut.prototype,"renderCoordsHelper",void 0),f([y({readOnly:!0})],Ut.prototype,"sceneIntersectionHelper",void 0),f([y({type:Number,dependsOn:["scale","spatialReference"],readOnly:!0})],Ut.prototype,"resolution",null),f([y({type:Number})],Ut.prototype,"scale",null),f([y()],Ut.prototype,"heightModelInfo",null),f([y()],Ut.prototype,"spatialReference",void 0),f([y({type:Boolean,constructOnly:!0})],Ut.prototype,"alphaCompositingEnabled",void 0),f([y({constructOnly:!0})],Ut.prototype,"preserveDrawingBufferEnabled",void 0),f([y({type:Boolean})],Ut.prototype,"supersampleScreenshotsEnabled",void 0),f([y({readOnly:!0})],Ut.prototype,"type",void 0),f([y({type:rge})],Ut.prototype,"ui",void 0),f([y({type:Boolean,readOnly:!0,dependsOn:["graphicsView.updating","basemapView.updating","basemapTerrain.updating","layerViewManager.updating","layerViewManager.updatingRemaining","_resourceController.updating","_stage.updating","featureTiles.updating","pointsOfInterest.updating","environmentManager.updating","overlay.updating","updatingHandles.updating","featureTreeDebugger.updating","labeler.updating","deconflictor.updating","ready","stationary","inputManager.hasPendingInputs","toolViewManager.updating","analysisViewManager.updating"]})],Ut.prototype,"updating",null),f([y({type:Number,readOnly:!0,dependsOn:["updating"]})],Ut.prototype,"updatingProgress",void 0),f([y({type:["global","local"]})],Ut.prototype,"viewingMode",null),f([y({type:ga})],Ut.prototype,"viewpoint",null),f([y({type:Number})],Ut.prototype,"zoom",null),f([y({type:i8})],Ut.prototype,"highlightOptions",void 0),Ut=f([ge("esri.views.SceneView")],Ut),function(i){i[i.INCLUDE=0]="INCLUDE",i[i.EXCLUDE=1]="EXCLUDE"}(BE||(BE={}));const z1=q(),X4=Fn(),Xee=qi(),Y1t=Ut;let H_=class extends et{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.codedValue=null}};f([y()],H_.prototype,"objectType",void 0),f([y()],H_.prototype,"maxValue",void 0),f([y()],H_.prototype,"minValue",void 0),f([y()],H_.prototype,"codedValue",void 0),H_=f([ge("esri.layers.support.ContingentValue")],H_);const Wa=H_;let G_=class extends et{constructor(e){super(e),this.isRetired=!1}};f([y()],G_.prototype,"id",void 0),f([y()],G_.prototype,"isRetired",void 0),f([y()],G_.prototype,"subtype",void 0),f([y()],G_.prototype,"values",void 0),G_=f([ge("esri.layers.support.Contingency")],G_);const Zee=G_;let HS=class extends et{constructor(e){super(e)}};f([y()],HS.prototype,"fieldGroup",void 0),f([y()],HS.prototype,"type",void 0),HS=f([ge("esri.layers.support.ContingencyConstraintViolation")],HS);const Qee=HS;let GS=class extends et{constructor(e){super(e)}};f([y()],GS.prototype,"contingentValuesAllGroups",void 0),f([y()],GS.prototype,"contingentValuesByFieldGroup",void 0),GS=f([ge("esri.layers.support.ContingentValuesResult")],GS);const X1t=GS;let W_=class extends et{constructor(e){super(e),this.fields=null,this.isEditingRestrictive=!1}};f([y()],W_.prototype,"name",void 0),f([y()],W_.prototype,"fields",void 0),f([y()],W_.prototype,"isEditingRestrictive",void 0),f([y()],W_.prototype,"contingencies",void 0),W_=f([ge("esri.layers.support.FieldGroup")],W_);const x8=W_;var bv;let j_=bv=class extends rie(q0){constructor(i){super(i),this.request=Mc,this.fieldGroups=null,this.fieldGroupDefinitions=null}initialize(){}static async createLoadedLayerContingentValuesCache(i){await i.load();const e=i.sourceJSON;if(i.layerId===void 0)return null;const t=e.hasContingentValuesDefinition;if(t)return new bv({layer:i}).load();if(t===void 0){const n=tR(i.url);if(B(n))return null;const r=n.url.path;if((await bv._staticFetchEnterpriseFeatureRoot(r)).supportsQueryDataElements){const s=i.layerId.toString(),a=await bv._staticFetchEnterpriseFieldGroup(r,s);if(a){const o=a.map(l=>({name:l.name,isEditingRestrictive:l.isEditingRestrictive,fields:l.fieldNames.names}));return new bv({layer:i,fieldGroupDefinitions:o}).load()}}}return null}async load(i){const e=this.layer.load(i).then(()=>this._initializeContingentValues(this.fieldGroupDefinitions,i));return this.addResolvingPromise(e),this}validateContingencyConstraints(i,e){const t=this.layer.typeIdField,n=Object.keys(i),r=[],s=[];for(const a of this.fieldGroups){const o=a.isEditingRestrictive?"error":"warning";if(e&&!a.fields.some(d=>e.includes(d)))continue;if(!a.fields.every(d=>n.includes(d))){s.push(new Qee({fieldGroup:a,type:o}));continue}let l=!1;const c=i[t],u=a.contingencies.filter(d=>!(!d.isRetired&&d.subtype)||d.subtype.code===c);for(const d of u){let h=!0;for(const p in d.values){const m=d.values[p];if(m.objectType!=="any"){if(m.objectType==="null"){if(i[p]!=null){h=!1;break}}else if(m.objectType==="code"){if(i[p]!==m.codedValue.code){h=!1;break}}else if(m.objectType==="range"){const g=i[p];if(g<m.minValue||g>m.maxValue){h=!1;break}}}}if(h){l=!0;break}}l||r.push(new Qee({fieldGroup:a,type:o}))}return{invalid:r,incomplete:s}}getContingentValues(i,e,t=!1){const n=i[this.layer.typeIdField],r=n!=null,s={};let a=[];const o=this.fieldGroups.filter(l=>l.fields.includes(e));a.push(new Wa({objectType:"any"}));for(const l of o){let c=[];const u=l.contingencies.filter(p=>!(p.isRetired||p.subtype&&r&&p.subtype.code!==n));let d=!1;const h={};for(const p of u){let m,g=!0;for(const _ in p.values){const b=p.values[_];if(e!==_){if(i[_]!==void 0&&b.objectType!=="any"){if(b.objectType==="null")i[_]!==null&&(g=!1);else if(b.objectType==="code")i[_]!==b.codedValue.code&&(g=!1);else if(b.objectType==="range"){const x=i[_];(x<b.minValue||x>b.maxValue)&&(g=!1)}}}else m=b,d=d||b.objectType==="range"}if(m&&g){if(m.objectType==="any"){c.length=0,c.push(m);break}const _=this._generateKey(m);h[_]||c.push(m),h[_]=!0}}d&&(c=this._joinRange(c)),s[l.name]=c,a=t?this._filterIntersection(a,c):null}return o.length===1&&t&&(a=[]),new X1t({contingentValuesAllGroups:a,contingentValuesByFieldGroup:s})}_generateKey(i){switch(i.objectType){case"any":return"@any@";case"null":return"@null@";case"code":return i.codedValue.name+i.codedValue.code.toString();case"range":return i.minValue.toString()+"-"+i.maxValue.toString()}}_joinRange(i){let e,t;i.sort((r,s)=>r.objectType==="null"?-1:s.objectType==="null"?1:r.minValue-s.minValue);const n=[];for(const r of i)r.objectType!=="null"?e!==void 0?t<r.minValue?(n.push(new Wa({objectType:"range",minValue:e,maxValue:t})),e=r.minValue,t=r.maxValue):t<r.maxValue&&(t=r.maxValue):(e=r.minValue,t=r.maxValue):n.push(r);return n.push(new Wa({objectType:"range",minValue:e,maxValue:t})),n}_filterIntersection(i,e){var r,s;if(i.length===0||e.length===0)return[];if(i[0].objectType==="any")return e;if(e[0].objectType==="any")return i;const t=i[0].objectType==="range"||((r=i[1])==null?void 0:r.objectType)==="range",n=e[0].objectType==="range"||((s=e[1])==null?void 0:s.objectType)==="range";return t||n?this._intersectRanges(i,e):this._intersectValues(i,e)}_intersectRanges(i,e){const t=[];let n,r=0;for(const s of i)for(;r<e.length;r++){const a=e[r];if(s.objectType==="null"&&a.objectType==="null")t.push(new Wa({objectType:"null"}));else{if(s.objectType==="null")break;if(a.objectType==="null")continue}if(s.maxValue<a.minValue)break;if(s.maxValue===a.minValue){t.push(new Wa({objectType:"range",minValue:s.maxValue,maxValue:a.minValue}));break}if(!(s.minValue>a.maxValue))if(s.minValue!==a.maxValue){if(n=s.minValue>a.minValue?s.minValue:a.minValue,s.maxValue<a.maxValue){t.push(new Wa({objectType:"range",minValue:n,maxValue:s.maxValue}));break}t.push(new Wa({objectType:"range",minValue:n,maxValue:a.maxValue}))}else t.push(new Wa({objectType:"range",minValue:s.minValue,maxValue:a.maxValue}))}return t}_intersectValues(i,e){const t=[];for(const n of i)e.some(r=>{if(n.objectType===r.objectType)switch(n.objectType){case"any":case"null":return!0;case"code":return n.codedValue.code===r.codedValue.code&&n.codedValue.name===r.codedValue.name}return!1})&&t.push(n);return t}static async _staticFetchEnterpriseFeatureRoot(i,e){return Mc(i,{responseType:"json",query:{f:"json"},...e}).then(t=>t.data)}static async _staticFetchEnterpriseFieldGroup(i,e,t){return Mc(`${i}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...t}).then(n=>{var r;return(r=n.data.layerDataElements)==null?void 0:r[0].dataElement.fieldGroups})}async _initializeContingentValues(i,e){const t=i||await this._fetchFieldGroupDefs(e);if(t.length===0)return void(this.fieldGroups=[]);const n=await this._fetchContingentValues(t,e);this.fieldGroups=n}async _fetchFieldGroupDefs(i){if(this.layer.layerId===void 0)return[];const e=this.layer.sourceJSON,t=this.layer.layerId.toString(),n=kt(tR(this.layer.url)).url.path;return e.hasContingentValuesDefinition?(await this._fetchAGOLFieldGroup(n,t,i)).map(r=>({name:r.name,isEditingRestrictive:r.restrictive,fields:r.fields.map(s=>this.layer.fieldsIndex.normalizeFieldName(s))})):e.hasContingentValuesDefinition!==void 0?[]:this._fetchEnterpriseFeatureRoot(n,i).then(async r=>r.supportsQueryDataElements?(await this._fetchEnterpriseFieldGroup(n,t,i)).map(s=>({name:s.name,isEditingRestrictive:s.isEditingRestrictive,fields:s.fieldNames.names.map(a=>this.layer.fieldsIndex.normalizeFieldName(a))})):[])}async _fetchAGOLFieldGroup(i,e,t){return Mc(`${i}/${e}/fieldgroups`,{responseType:"json",query:{f:"json"},...t}).then(n=>n.data.fieldGroups)}async _fetchEnterpriseFieldGroup(i,e,t){return bv._staticFetchEnterpriseFieldGroup(i,e,t)}async _fetchEnterpriseFeatureRoot(i,e){return bv._staticFetchEnterpriseFeatureRoot(i,e)}async _fetchContingentValues(i,e){if(this.layer.layerId===void 0)return[];const t=this.layer.sourceJSON,n=this.layer.layerId.toString(),r=kt(tR(this.layer.url)).url.path;if(t.hasContingentValuesDefinition){const a=await this._fetchAGOLContingentValues(r,n,e);return this._constructFieldGroupsAGOL(i,a)}const s=await this._fetchEnterpriseContingentValues(r,n,e);return this._constructFieldGroupsEnterprise(i,s)}_constructFieldGroupsAGOL(i,e){return i.map(t=>{const n=e.contingentValuesDefinition.fieldGroups.find(r=>r.name===t.name);if(n){let r=[];return r=e.contingentValuesDefinition.hasSubType?this._parseAGOLFieldGroupSubtype(t,e,n.subTypes):this._parseAGOLFieldGroup(t,e,n.contingentValues),new x8({name:t.name,isEditingRestrictive:t.isEditingRestrictive,fields:t.fields,contingencies:r})}return null}).filter(t=>t!==null)}_parseAGOLFieldGroupSubtype(i,e,t){let n=[];return t.forEach(r=>{const s=this._getSubtypeAGOL(r.name);n=n.concat(this._parseAGOLFieldGroup(i,e,r.contingentValues,s))}),n}_parseAGOLFieldGroup(i,e,t,n=null){const r=[];for(const s of t){const a=this._parseAGOLContingency(s,i,e,n);r.push(a)}return r}_parseAGOLContingency(i,e,t,n){const r=i.id,s=!!i.retired&&i.retired===1,a={};for(let o=0,l=0;o<e.fields.length;o++){const c=e.fields[o],u=t.typeCodes[i.types[o]];if(u==="Code"){let d=i.values[l];l++;const h=this._getDomain(n,c);if(this.layer.getField(c).type==="string"){const g=t.stringDicts.find(_=>_.domain===h.name);g&&(d=g.entries[d])}const p=h.codedValues.find(g=>g.code===d),m=new Wa({codedValue:p,objectType:"code"});a[c]=m}else if(u==="Range"){const d=i.values[l];l++;const h=d.range[0],p=d.range[1],m=new Wa({minValue:h,maxValue:p,objectType:"range"});a[c]=m}else if(u==="Any"){const d=new Wa({objectType:"any"});a[c]=d}else{const d=new Wa({objectType:"null"});a[c]=d}}return new Zee({id:r,isRetired:s,subtype:n,values:a})}_constructFieldGroupsEnterprise(i,e){const t=e.fieldGroups;return i.map(n=>{const r=t.find(s=>s.name===n.name);if(r){const s=r.contingencies.map(a=>{const o=a.id,l=a.isRetired||!1,c=this._getSubtypeEnterprise(a.subtypeCode),u={};for(let d=0;d<n.fields.length;d++){const h=n.fields[d];let p=a.values[d];if(typeof p=="number"||typeof p=="string"){const m=this._getDomain(c,h),g=this.layer.getField(h);g.type==="string"?p=e.stringDictionary[p]:g.type==="date"&&(p=new Date(`${p}+00:00`).getTime());const _=m.codedValues.find(x=>x.code===p),b=new Wa({codedValue:_,objectType:"code"});u[h]=b}else if(typeof p=="object"){const m=p.minValue,g=p.maxValue,_=new Wa({minValue:m,maxValue:g,objectType:"range"});u[h]=_}else if(p){const m=new Wa({objectType:"any"});u[h]=m}else{const m=new Wa({objectType:"null"});u[h]=m}}return new Zee({id:o,isRetired:l,subtype:c,values:u})});return new x8({name:n.name,isEditingRestrictive:n.isEditingRestrictive,fields:n.fields,contingencies:s})}return null}).filter(n=>n!==null)}async _fetchEnterpriseContingentValues(i,e,t){return Mc(`${i}/queryContingentValues`,{responseType:"json",query:{layers:JSON.stringify([e]),f:"json"},...t}).then(n=>{var r;return(r=n.data.contingentValueSets)==null?void 0:r[0]})}async _fetchAGOLContingentValues(i,e,t){return Mc(`${i}/${e}/contingentValues`,{responseType:"json",query:{f:"json"},...t}).then(n=>n.data)}_getSubtypeEnterprise(i){const e=this.layer.sourceJSON;let t;if(e.subtypes){const n=e.subtypes.find(r=>r.code===i);t=wW.fromJSON(n)}return t||null}_getSubtypeAGOL(i){const e=this.layer.sourceJSON;let t;if(e.subtypes){const n=e.subtypes.find(r=>r.name===i);t=wW.fromJSON(n)}return t||null}_getDomain(i,e){const t=i?i.domains[e]:this.layer.getFieldDomain(e);return t.type==="inherited"?this.layer.getFieldDomain(e):t}};f([y({constructOnly:!0})],j_.prototype,"layer",void 0),f([y({constructOnly:!0})],j_.prototype,"request",void 0),f([y({type:[x8]})],j_.prototype,"fieldGroups",void 0),f([y({constructOnly:!0})],j_.prototype,"fieldGroupDefinitions",void 0),j_=bv=f([ge("esri.layers.support.LayerContingentValuesCache")],j_);const Z1t=j_;let zE=null;function Q1t(i,e,t,n={}){const r=e.elementType,s="value",a=r.type==="array"?[{name:s,type:r.type,elementType:r.elementType}]:r.type==="dictionary"?[{name:s,type:r.type,properties:r.properties}]:[{name:s,type:r.type}];return new Qwe(i.map(o=>{const l={};return LH(l,a,{[s]:o},t,n),l[s]}))}function J1t(i,e,t={}){const n=i instanceof G_e?new gp({source:i.features,geometryType:i.geometryType,fields:i.fields,spatialReference:i.spatialReference}):i;return e.constructFeatureSet(n,t.spatialReference,null,!0,t.lruCache,t.interceptor)}function ewt(i,e,t={}){const{spatialReference:n,interceptor:r,lruCache:s}=t;return typeof i=="string"?e.createFeatureSetCollectionFromService(i,n,s,r):e.createFeatureSetCollectionFromMap(i,n,s,r)}function twt(i,e,t,n={}){const r={};return LH(r,e.properties,i,t,n),new zE.Dictionary(r)}function LH(i,e,t,n,r={}){const s={};for(const a of Object.keys(t))s[a.toLowerCase()]=t[a];for(const a of e){const o=a.name.toLowerCase();if(r.variablesPreProcessed)i[o]=s[o];else switch(a.type){case"array":{const l=s[o];i[o]=Q1t(l,a,n,r);break}case"feature":{const l=s[o];i[o]=l==null?null:zE.Feature.createFromGraphic(l);break}case"featureSet":{const l=s[o];i[o]=n?J1t(l,n,r):null;break}case"featureSetCollection":{const l=s[o];i[o]=n?ewt(l,n,r):null;break}case"dictionary":{const l=s[o];i[o]=twt(l,a,n,r);break}case"geometry":case"boolean":case"date":case"text":case"number":i[o]=s[o]}}}function sge(i,e){for(const t of i)e.push(t),t.type==="dictionary"&&sge(t.properties,e);return e}function Jee(i,e,t,n,r){const{spatialReference:s,interceptor:a,lruCache:o,services:l,console:c,abortSignal:u}=t,d={vars:{},spatialReference:s,interceptor:a,lrucache:o,useAsync:r,services:l,console:c,abortSignal:u};return e&&LH(d.vars,i.variables,e,n,t),d}function bL(i,e){switch(e.getArcadeType(i)){case"number":case"text":case"boolean":case"point":case"polygon":case"polyline":case"multipoint":case"extent":return i;case"date":return new Date(i.getTime());case"feature":{const t=(i.type,i),n="geometry"in t?t.geometry():null,r="readAttributes"in t?t.readAttributes():t.attributes;return new ao({geometry:n,attributes:r})}case"dictionary":{const t=i,n=t.attributes,r={};for(const s of Object.keys(n))r[s]=bL(t.field(s),e);return r}case"array":return("toArray"in i?i.toArray():i).map(t=>bL(t,e))}return i}const ete={variables:[{name:"$feature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"}]},tte={variables:[{name:"$feature",type:"feature"},{name:"$aggregatedFeatures",type:"featureSet"}]},ite=new Map([["constraint",{variables:[{name:"$feature",type:"feature"}]}],["feature-z",{variables:[{name:"$feature",type:"feature"}]}],["field-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$datastore",type:"featureSetCollection"}]}],["form-calculation",{variables:[{name:"$feature",type:"feature"},{name:"$originalFeature",type:"feature"},{name:"$layer",type:"featureSet"},{name:"$featureSet",type:"featureSet"},{name:"$datastore",type:"featureSetCollection"},{name:"$map",type:"featureSetCollection"},{name:"$editContext",type:"dictionary",properties:[{name:"editType",type:"text"}]}]}],["labeling",{variables:[{name:"$feature",type:"feature"}]}],["popup",ete],["popup-element",ete],["feature-reduction-popup",tte],["feature-reduction-popup-element",tte],["visualization",{variables:[{name:"$feature",type:"feature"},{name:"$view",type:"dictionary",properties:[{name:"scale",type:"number"}]}]}]]);function iwt(i){const e=ite.get(i);if(!e){const t=Array.from(ite.keys()).map(n=>`'${n}'`).join(", ");throw new Ze("createArcadeProfile:invalid-profile-name",`Invalid profile name '${i}'. You must specify one of the following values: ${t}`)}return ko(e)}async function nwt(i,e,t={}){zE||(zE=await UL());const{arcade:n,arcadeUtils:r}=zE,{loadScriptDependencies:s,referencesMember:a,scriptIsAsync:o}=n,l=sge(e.variables,[]),c=l.filter(w=>w.type==="featureSet"||w.type==="featureSetCollection").map(w=>w.name.toLowerCase()),u=n.parseScript(i,c);if(!u)throw new Ze("arcade:invalid-script","Unable to create SyntaxTree");const d=r.extractFieldNames(u),h=n.scriptTouchesGeometry(u),p=l.map(w=>w.name.toLowerCase()).filter(w=>a(u,w)),m=o(u,c);await s(u,m,c);const g={vars:{},spatialReference:null,useAsync:m};for(const w of p)g.vars[w]="any";const{lruCache:_}=t,b=n.compileScript(u,g),x=n.featureSetUtils();return{execute:(w,C={})=>{if(m)throw new Ze("arcade:invalid-execution-mode","Cannot execute the script in synchronous mode");const S=b(Jee(e,w,{lruCache:_,...C},x,m));return C.rawOutput?S:bL(S,r)},executeAsync:async(w,C={})=>{const S=await b(Jee(e,w,{lruCache:_,...C},x,m));return C.rawOutput?S:bL(S,r)},isAsync:m,variablesUsed:p,fieldsUsed:d,geometryUsed:h,syntaxTree:u}}var age;const rwt=Symbol("FormExpressionArcadeExecutor");let Il=class extends et{constructor(e){super(e),this[age]=!0,this._lastEvaluatedValue=null,this._abortController=new AbortController,this._stale=!1,this._updatingTracking=new wb,this._executeAsyncDebounced=DL(async(t,n,r)=>{const s=await this.executor.executeAsync(t,{...n,abortSignal:r});return r.aborted?this._lastEvaluatedValue:(this._lastEvaluatedValue=s,this._stale=!1,s)})}get isAsync(){return this.executor.isAsync}get fieldsUsed(){return this.executor.fieldsUsed}get syntaxTree(){return this.executor.syntaxTree}get updating(){return this._updatingTracking.updating}get stale(){return this._stale}get geometryUsed(){return this.executor.geometryUsed}get variablesUsed(){return this.executor.variablesUsed}get lastEvaluatedValue(){return this._lastEvaluatedValue}abort(){this._abortController.abort()}execute(e,t){this._abortController=new AbortController;const n=this.executor.execute(e,{...t,abortSignal:this._abortController.signal});return this._lastEvaluatedValue=n,n}async executeAsync(e,t){return this._abortController=new AbortController,this._updatingTracking.addPromise(this._executeAsyncDebounced(e,t??{},this._abortController.signal))}markStale(){this._stale=!0}reset(){this.abort(),this._lastEvaluatedValue=null,this._stale=!1}};age=rwt,f([y()],Il.prototype,"_lastEvaluatedValue",void 0),f([y()],Il.prototype,"_stale",void 0),f([y()],Il.prototype,"_updatingTracking",void 0),f([y({constructOnly:!0})],Il.prototype,"executor",void 0),f([y()],Il.prototype,"isAsync",null),f([y()],Il.prototype,"fieldsUsed",null),f([y()],Il.prototype,"syntaxTree",null),f([y()],Il.prototype,"updating",null),f([y()],Il.prototype,"stale",null),f([y()],Il.prototype,"geometryUsed",null),f([y()],Il.prototype,"variablesUsed",null),f([y()],Il.prototype,"lastEvaluatedValue",null),Il=f([ge("esri.widgets.FeatureForm.FormExpressionArcadeExecutor")],Il);const swt=async(i,e)=>{const t=iwt("form-calculation"),n=await nwt(i,t,{});return e!=null&&e.fieldsIndex&&(n.fieldsUsed=o_e(e.fieldsIndex,n.fieldsUsed)),new Il({executor:n})},Z4="#JSAPI_FORM_EXPRESSIONS_MANAGER_GEOMETRY",awt="esri.widgets.FeatureForm.FormExpressionsManager";let wv=class extends et{constructor(e){super(e),this._fieldReferencesLookup=new Map,this._fieldsAffectedLookup=new Map,this._latestFieldValues={...e.feature.attributes}}initialize(){this._dependencyGraph=this._buildDependencyGraph()}get _baseContext(){const{editType:e,layer:t,map:n,originalFeature:r,spatialReference:s}=this.arcadeContextInfo,a=(t==null?void 0:t.type)==="feature"?t:(t==null?void 0:t.type)==="scene"&&T(t.associatedLayer)?t.associatedLayer:void 0;return[{$originalfeature:r,$editcontext:{editType:e},$layer:a,$featureset:a,$datastore:t==null?void 0:t.url,$map:n},{spatialReference:s}]}set feature(e){this._latestFieldValues={...e==null?void 0:e.attributes},this._set("feature",e)}evaluateAll(){return this._evaluate(this.executors)}evaluateExpressions(e){return this._evaluate(e)}evaluateInvalidated(e){const{_fieldReferencesLookup:t,_latestFieldValues:n,feature:r}=this,s=new Set;for(const a of e)if(n[a]=r.getAttribute(a),t.has(a))for(const o of t.get(a))s.add(o);return this._evaluate([...s])}async evaluateInvalidatedByGeometry(){if(this._fieldReferencesLookup.has(Z4))return this._evaluate([...this._fieldReferencesLookup.get(Z4)])}resetExecutors(){for(const e of this.executors)e.reset()}_buildDependencyGraph(){const{_fieldReferencesLookup:e,_fieldsAffectedLookup:t,executors:n}=this,r=new Map(this.inputFields.map(a=>[a.name,a])),s=new Map(n.map(a=>[a,new Array]));for(const a of n){for(const o of a.fieldsUsed){uS(e,o,()=>new Set).add(a);const l=r.get(o),{valueExpressionExecutor:c,editableExpressionExecutor:u}=l;T(c)&&(s.get(c).push(a),uS(t,c,()=>new Set).add(l)),T(u)&&(s.get(u).push(a),uS(t,u,()=>new Set).add(l))}a.geometryUsed&&uS(e,Z4,()=>new Set).add(a)}return s}async _evaluate(e){const t=new Map,{_dependencyGraph:n,_fieldsAffectedLookup:r,_latestFieldValues:s}=this;for(const o of e)oge(o,t,n);for(const[o,{resolver:l,dependencyPromises:c}]of t)Promise.all(c).then(async()=>{const[u,d]=this._makeContext(s);return o.executeAsync(u,d)}).then(()=>{if(r.has(o))for(const u of r.get(o))this._latestFieldValues[u.name]=u.value;l.resolve()},u=>{!u||zo(u)||nte(u)||o.markStale(),l.reject(u)});const a=(await Promise.allSettled(Array.from(t.values(),({resolver:o})=>o.promise))).filter(o=>o.status==="rejected"&&!(zo(o.reason)||nte(o.reason)));if(a.length>0)throw new AggregateError(a,"One or more expression executions failed")}_makeContext(e){const[t,n]=this._baseContext,r=this.feature.clone();return r.attributes=e,[{...t,$feature:r},n]}};f([y()],wv.prototype,"_baseContext",null),f([y()],wv.prototype,"feature",null),f([y()],wv.prototype,"executors",void 0),f([y()],wv.prototype,"inputFields",void 0),f([y()],wv.prototype,"arcadeContextInfo",void 0),wv=f([ge(awt)],wv);const oge=(i,e,t)=>{if(e.has(i))return;const n=_b();e.set(i,{resolver:n,dependencyPromises:[]}),i.abort();const r=t.get(i);for(const s of r)oge(s,e,t),e.get(s).dependencyPromises.push(n.promise)},nte=i=>i&&typeof i=="object"&&"message"in i&&i.message==="Cancelled";var dm,wL;(function(i){i.Text="text",i.Number="number",i.Date="date",i.Unsupported="unsupported"})(dm||(dm={})),function(i){i.TOO_SHORT="length-validation-error::too-short"}(wL||(wL={}));const rte={type:"number"},ste={type:"number",intlOptions:{notation:"scientific"}},ate={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};function ote(i){return i>=1e7||i<=-1e7}let nn=class extends Ba(et){constructor(e){super(e),this._storedValue=null,this.editableExpressionExecutor=null,this.id=tf().toString(),this.requiredExpressionExecutor=null,this.valueExpressionExecutor=null,this.visibilityExpressionExecutor=null,this.feature=null,this.field=null,this.fieldElement=null,this.layer=null,this.error=null,this.group=null,this.messages=null}get _configAllowsEdits(){var r,s,a;const{fieldElement:e,layer:t,name:n}=this;return T(e)?e.editableExpression?this.evaluatedEditableExpression:e.editable!==!1:((a=(t==null?void 0:t.type)!=="subtype-group"?(s=(r=t==null?void 0:t.popupTemplate)==null?void 0:r.fieldInfos)==null?void 0:s.find(({fieldName:o})=>o===n):null)==null?void 0:a.isEditable)??!0}get _layerFieldAllowsEdits(){const{field:e,layer:t}=this;return(t==null?void 0:t.capabilities.operations.supportsEditing)&&(e==null?void 0:e.editable)}get isUsingValueExpression(){return this._shouldUseValueExpression()}get evaluatedEditableExpression(){const{editableExpressionExecutor:e}=this;return T(e)?!!e.lastEvaluatedValue:null}get evaluatedRequiredExpression(){const{requiredExpressionExecutor:e}=this;return T(e)?!!e.lastEvaluatedValue:null}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return T(e)?!!e.lastEvaluatedValue:null}get evaluatedValueExpression(){const{valueExpressionExecutor:e}=this;return T(e)?e.lastEvaluatedValue:null}set initialFeature(e){this._set("initialFeature",e),this.notifyChange("valid")}get description(){var e;return(e=kt(this.fieldElement))==null?void 0:e.description}get domain(){var l;const{layer:e}=this,t="typeIdField"in e?e.typeIdField:null,n=t===this.name,r=(l=this.field)==null?void 0:l.domain;if(n&&!r){const c=e.type==="subtype-group"?e.sublayers.map(({subtypeCode:u,title:d})=>({id:u,name:d})):e.types.map(({id:u,name:d})=>({code:u,name:d}));return new Jwe({name:"__internal-type-based-coded-value-domain__",codedValues:c})}const{feature:s}=this,a=t&&this.layer.getFieldDomain(this.name,{feature:s})||r,o=ms(this.fieldElement,"domain");return T(o)&&this._isDomainCompatible(o)?o:a}get editable(){return!!this._layerFieldAllowsEdits&&(this.evaluatedEditableExpression??this._configAllowsEdits)}get inputType(){var e,t;return(t=(e=kt(this.fieldElement))==null?void 0:e.input)==null?void 0:t.type}get errorMessage(){return this._toErrorMessage()}get hint(){var e;return(e=kt(this.fieldElement))==null?void 0:e.hint}get includeTime(){var n;const{fieldElement:e}=this,t=T(e)&&((n=e.input)==null?void 0:n.type)==="datetime-picker"?e.input.includeTime:void 0;return t===void 0||t}get label(){return T(this.fieldElement)&&this.fieldElement.label||this.field.alias||this.field.name}get maxLength(){if(this.type===dm.Date)return-1;const{field:t,fieldElement:n}=this,r=t==null?void 0:t.length,s=T(n)&&lte(n.input)?n.input.maxLength:NaN;return!isNaN(s)&&s>=-1&&(r===-1||s<=r)?s:r}get minLength(){if(this.type===dm.Date)return-1;const{field:t,fieldElement:n}=this,r=t==null?void 0:t.length,s=T(n)&&lte(n.input)?n.input.minLength:NaN;return!isNaN(s)&&s>=-1&&(r===-1||s<=r)?s:-1}get name(){var e;return(e=this.field)==null?void 0:e.name}get required(){const{editable:e,evaluatedRequiredExpression:t,field:n,visible:r}=this;return!!e&&((n==null?void 0:n.nullable)===!1||!(!r||!T(t))&&t)}set required(e){this._overrideIfSome("required",e)}get submittable(){const{field:e,required:t,valid:n,value:r}=this;return(!t||!B(r))&&(!!n||this.initialFeature.getAttribute(e.name)===r)}get type(){const{field:e}=this;return JO(e)?dm.Number:OG(e)?dm.Text:kN(e)?dm.Date:dm.Unsupported}get updating(){const{editableExpressionExecutor:e,valueExpressionExecutor:t}=this;return T(t)&&t.updating||T(e)&&e.updating}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),e===null}get value(){if(this._shouldUseValueExpression()){const e=this.evaluatedValueExpression;if(this.type===dm.Date){if(e instanceof Date)return e.getTime();if(typeof e!="number")return parseInt(e,10)}return T(e)&&typeof e=="object"?e.toString():e}return this.get("_storedValue")}set value(e){this.notifyChange("evaluatedVisibilityExpression"),this.set("_storedValue",e)}get visible(){return!this._isEditorField()&&(T(this.evaluatedVisibilityExpression)?this.evaluatedVisibilityExpression:!!T(this.fieldElement)||this._isVisibleByDefault())}_isDomainCompatible(e){const{field:t}=this;if((e==null?void 0:e.type)==="coded-value"){const n=typeof e.codedValues[0].code;if(n==="string"&&OG(t)||n==="number"&&JO(t))return!0}return!!((e==null?void 0:e.type)==="range"&&JO(t)||kN(t))}_validate(){const{domain:e,field:t,initialFeature:n,minLength:r,required:s,type:a,valid:o,value:l}=this,c=s&&l===null,u=o!==void 0;return!c&&n.getAttribute(t.name)===l&&u?null:c?RG.INVALID_TYPE:a==="text"&&r>-1&&typeof l=="string"&&l.length<r?wL.TOO_SHORT:e?l!==null||s?l_e(e,l):null:c_e(t,l)}_isVisibleByDefault(){var t;const e=(t=this.field)==null?void 0:t.type;return e!=="oid"&&e!=="global-id"&&!this._isGeometryField()}_isEditorField(){return u_e(this.layer).includes(this.name)}_isGeometryField(){return d_e(this.layer).includes(this.name)}_shouldUseValueExpression(){return this._layerFieldAllowsEdits&&!this._configAllowsEdits&&T(this.valueExpressionExecutor)}_toErrorMessage(){const{domain:e,field:t,messages:n,minLength:r,value:s,required:a,type:o}=this,l=this.error;if(a&&s===null)return n.validationErrors.cannotBeNull;if(l===IG.VALUE_OUT_OF_RANGE||l===h_e.OUT_OF_RANGE){const c=$ie(e)||Lie(t);return ua(n.validationErrors.outsideRange,c,{format:{max:o==="date"?ate:ote(c.max)?ste:rte,min:o==="date"?ate:ote(c.min)?ste:rte}})}return l===IG.INVALID_CODED_VALUE?n.validationErrors.invalidCodedValue:l===RG.INVALID_TYPE?n.validationErrors.invalidType:l===wL.TOO_SHORT?ua(n.validationErrors.tooShort,{min:r}):null}};function lte(i){return!!i&&"maxLength"in i}f([y()],nn.prototype,"_storedValue",void 0),f([y()],nn.prototype,"_configAllowsEdits",null),f([y()],nn.prototype,"_layerFieldAllowsEdits",null),f([y()],nn.prototype,"editableExpressionExecutor",void 0),f([y()],nn.prototype,"requiredExpressionExecutor",void 0),f([y()],nn.prototype,"valueExpressionExecutor",void 0),f([y()],nn.prototype,"isUsingValueExpression",null),f([y()],nn.prototype,"visibilityExpressionExecutor",void 0),f([y()],nn.prototype,"evaluatedEditableExpression",null),f([y()],nn.prototype,"evaluatedRequiredExpression",null),f([y()],nn.prototype,"evaluatedVisibilityExpression",null),f([y()],nn.prototype,"evaluatedValueExpression",null),f([y()],nn.prototype,"feature",void 0),f([y()],nn.prototype,"field",void 0),f([y({constructOnly:!0})],nn.prototype,"fieldElement",void 0),f([y()],nn.prototype,"initialFeature",null),f([y()],nn.prototype,"layer",void 0),f([y({readOnly:!0})],nn.prototype,"description",null),f([y()],nn.prototype,"domain",null),f([y()],nn.prototype,"editable",null),f([y({readOnly:!0})],nn.prototype,"inputType",null),f([y({readOnly:!0})],nn.prototype,"error",void 0),f([y({dependsOn:["error","messages","value"]})],nn.prototype,"errorMessage",null),f([y()],nn.prototype,"group",void 0),f([y({readOnly:!0})],nn.prototype,"hint",null),f([y()],nn.prototype,"includeTime",null),f([y()],nn.prototype,"label",null),f([y()],nn.prototype,"maxLength",null),f([y()],nn.prototype,"minLength",null),f([y()],nn.prototype,"messages",void 0),f([y({readOnly:!0})],nn.prototype,"name",null),f([y()],nn.prototype,"required",null),f([y()],nn.prototype,"submittable",null),f([y()],nn.prototype,"type",null),f([y()],nn.prototype,"updating",null),f([y()],nn.prototype,"valid",null),f([y({value:null})],nn.prototype,"value",null),f([y()],nn.prototype,"visible",null),nn=f([ge("esri.widgets.FeatureForm.InputField")],nn);const cte=nn;let _c=class extends Ba(et){constructor(e){super(e),this._expressionTrackingHandles=new Map,this.visibilityExpressionExecutor=null,this.feature=null,this.groupElement=null}initialize(){this.addHandles([ue(()=>[this.visible,this.inputFields],([e])=>{const{inputFields:t}=this,n=!!e&&void 0;for(const r of t)r.required=n},{initial:!0,equals:(e,t)=>t[0]===e[0]&&t[1]===e[1]})])}destroy(){for(const e of this._expressionTrackingHandles.values())e.remove()}get visibilityExpression(){var e;return(e=kt(this.groupElement))==null?void 0:e.visibilityExpression}set visibilityExpression(e){Qa(this.groupElement,t=>{t.visibilityExpression=e})}get evaluatedVisibilityExpression(){const{visibilityExpressionExecutor:e}=this;return T(e)?!!e.lastEvaluatedValue:null}get description(){var e;return(e=kt(this.groupElement))==null?void 0:e.description}set description(e){Qa(this.groupElement,t=>{t.description=e})}get inputFields(){return this._get("inputFields")}set inputFields(e){this.handles.removeAll(),e&&this.handles.add(e.map(t=>ue(()=>t.visible,()=>this._dirtyEvaluatedVisibilityExpression()))),this._set("inputFields",e)}get label(){var e;return(e=kt(this.groupElement))==null?void 0:e.label}set label(e){Qa(this.groupElement,t=>{t.label=e})}get state(){return T(this.groupElement)&&this.groupElement.initialState||"expanded"}set state(e){this._overrideIfSome("state",e)}get visible(){return this.evaluatedVisibilityExpression!==!1&&this.inputFields&&this.inputFields.some(e=>e.visible)}_dirtyEvaluatedVisibilityExpression(){const{groupElement:e}=this;T(e)&&e.visibilityExpression&&this.notifyChange("evaluatedVisibilityExpression")}};f([y()],_c.prototype,"visibilityExpression",null),f([y()],_c.prototype,"visibilityExpressionExecutor",void 0),f([y()],_c.prototype,"evaluatedVisibilityExpression",null),f([y()],_c.prototype,"description",null),f([y()],_c.prototype,"feature",void 0),f([y()],_c.prototype,"groupElement",void 0),f([y()],_c.prototype,"initialFeature",void 0),f([y()],_c.prototype,"inputFields",null),f([y()],_c.prototype,"label",null),f([y()],_c.prototype,"state",null),f([y()],_c.prototype,"visible",null),_c=f([ge("esri.widgets.FeatureForm.InputFieldGroup")],_c);const owt=_c,Q4=new ao({attributes:{}}),lwt=["editableExpression","requiredExpression","valueExpression","visibilityExpression"],cwt=["visibilityExpression"],uwt="#JSAPI_CONTINGENT_VALUE_EMPTY_HASH",U1="#JSAPI_CONTINGENT_VALUE_ANY_HASH",dwt="#JSAPI_CONTINGENT_VALUE_NULL_HASH";let as=class extends Ba(bB(Pn.EventedAccessor)){constructor(e){super(e),this._expressionExecutorLookup=new Map,this._expressionLookup=new Map,this._expressionsManager=null,this._contingentValuesCache=null,this._featureClone=Q4.clone(),this._initialFeature=Q4.clone(),this.arcadeEditType="NA",this.contingencyConstraintViolations=new Map,this.inputFields=[],this.messages=null,this.strict=!1}initialize(){const e=async()=>{const r=await exe("esri/widgets/FeatureForm/t9n/FeatureForm");this.messages=r;for(const s of this.allInputFields)s.messages=r};e();const t=ue(()=>{var r;return[this.layer,(r=this.layer)==null?void 0:r.loaded,this.formTemplate]},()=>{T(this.layer)&&this.layer.loaded&&this._updateInputFields()},{equals:([r,s,a],[o,l,c])=>r===o&&s===l&&a===c,initial:!0}),n=ue(()=>this.layer,r=>{(r==null?void 0:r.type)==="feature"&&this.addResolvingPromise(Z1t.createLoadedLayerContingentValuesCache(r).then(s=>{this._contingentValuesCache=s,this.notifyChange("fieldsWithContingentValues")}))},{initial:!0});this.handles.add([Wie(e),t,n])}destroy(){this.feature=null,this.layer=null,this._contingentValuesCache=_t(this._contingentValuesCache)}get _arcadeContextInfo(){const{_initialFeature:e,arcadeEditType:t,layer:n,spatialReference:r,view:s}=this;return{layer:cue(n)?n:null,originalFeature:e,editType:t,spatialReference:r,map:s==null?void 0:s.map}}get updating(){return this.updatingHandles.updating}get allInputFields(){return ute(this.inputFields)}get _layerFieldsByName(){return new Map(this.layer.fields.map(e=>[e.name,e]))}get feature(){return this._get("feature")}set feature(e){this._featureClone=e?e.clone():Q4.clone(),this._initialFeature=this._featureClone.clone(),this._resetInputFieldValues(this._featureClone),this.contingencyConstraintViolations.clear(),T(this._expressionsManager)&&(this._expressionsManager.resetExecutors(),this._expressionsManager.feature=this._featureClone,this.updatingHandles.addPromise(this._expressionsManager.evaluateAll().finally(()=>this._afterExpressionsEvaluated()))),this._set("feature",e)}get fieldsWithContingentValues(){if(B(this._contingentValuesCache))return new Set;const e=this._contingentValuesCache.fieldGroups.flatMap(t=>t.fields);return new Set(e)}get formTemplate(){return this.layer&&"formTemplate"in this.layer?this.layer.formTemplate:null}set formTemplate(e){this._override("formTemplate",e)}get joinedContingentValues(){return this._joinContingentValues()}get layer(){var e;return(e=this.feature)!=null&&e.sourceLayer&&"applyEdits"in this.feature.sourceLayer?this.feature.sourceLayer:null}set layer(e){this._override("layer",e)}get spatialReference(){var e;return((e=this.layer)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){return this.messages&&this.get("layer.loaded")?"ready":"disabled"}get submittable(){return!!this.valid||this.allInputFields.filter(e=>!e.valid).every(({submittable:e})=>e)}get valid(){const e=this.allInputFields;return e.length>0&&e.every(({valid:t})=>t)}findField(e){return this.allInputFields.find(t=>t.name===e)}getValue(e){const{_featureClone:t,layer:n}=this,r=!!(n!=null&&n.getField(e));return t.getAttribute(e)??(r?null:void 0)}setValue(e,t){const{_featureClone:n,strict:r}=this,s=this.findField(e);t=t===""?null:t,s&&n.getAttribute(e)!==t&&(s.value=t,r&&!s.valid||(this._afterValueChange(s),T(this._expressionsManager)&&this.updatingHandles.addPromise(this._expressionsManager.evaluateInvalidated([s.name]).finally(()=>this._afterExpressionsEvaluated()))))}getValues(){return{...this._featureClone.attributes}}submit(){const e=this.allInputFields,t=new Set(e.filter(s=>s.valid).map(({name:s})=>s)),n=e.filter(s=>!s.valid).map(({name:s})=>s),r=this.getValues();if(this.validateContingencyConstraints(r,{includeIncompleteViolations:!0}).length>0)for(const[s,a]of this.contingencyConstraintViolations.entries())a.type==="error"&&(t.delete(s),n.push(s));this.emit("submit",{valid:[...t],invalid:n,values:r})}validateContingencyConstraints(e,t){const{_contingentValuesCache:n}=this,r=new Map;if(this.contingencyConstraintViolations=r,B(n))return[];const{invalid:s,incomplete:a}=n.validateContingencyConstraints(e),o=[...s,...t!=null&&t.includeIncompleteViolations?a:[]];for(const l of o)for(const c of l.fieldGroup.fields)r.set(c,l);return o}notifyFeatureGeometryChanged(){const{_expressionsManager:e,feature:t,_featureClone:n}=this;n.geometry=t.geometry,T(e)&&this.updatingHandles.addPromise(e.evaluateInvalidatedByGeometry().finally(()=>this._afterExpressionsEvaluated()))}_emitChangeEvent({name:e,valid:t,value:n}){this.emit("value-change",{layer:this.layer,feature:this.feature,fieldName:e,value:n,valid:t})}_updateInputFields(){const{_featureClone:e,_initialFeature:t,formTemplate:n,inputFields:r,messages:s,layer:a}=this,o={feature:e,initialFeature:t,layer:a,messages:s},l=r.slice(),c=T(n)&&n.elements.length>0?this._updateInputFieldsFromElements(l,n.elements,o):this._updateInputFieldsFromLayerFields(l,a==null?void 0:a.fields,o);this.inputFields=c}_updateInputFieldsFromElements(e,t,n){const r=new Map;for(const o of e)if(TI(o)){eN(r,o.groupElement,o);for(const l of o.inputFields)eN(r,l.fieldElement,l)}else eN(r,o.fieldElement,o);const s=new Map,a=this._updateInputFieldsRecursive({existingInputFieldsByElement:r,updatedElements:t.filter(this._isSupportedElement),sharedInitializationProperties:n,group:null,newExpressionExecutorPromises:s});this.updatingHandles.addPromise(Promise.all(Array.from(s.values())).then(()=>{const o=Array.from(this._expressionExecutorLookup.values()),l=ute(a);return this._createExpressionsManager(o,l),kt(this._expressionsManager).evaluateAll().finally(()=>this._afterExpressionsEvaluated())}));for(const[o,l]of r.entries())r.delete(o),l.destroy();return a}_updateInputFieldsRecursive(e){const{existingInputFieldsByElement:t,updatedElements:n,sharedInitializationProperties:r,group:s,newExpressionExecutorPromises:a}=e,o=[];for(const l of n){const c=t.has(l),u=c?t.get(l):J4(l)?this._makeInputFieldGroupFromGroupElement(l,r):this._makeInputFieldFromFieldElement(l,r,s);if(o.push(u),c)if(t.delete(l),TI(u)){const{feature:d}=r;u.set({feature:d})}else u.set(r);else this._assignExpressionExecutors(u,l,a);if(J4(l)){const d=l.elements.filter(h=>this._isSupportedElement(h));u.inputFields=this._updateInputFieldsRecursive({existingInputFieldsByElement:t,updatedElements:d,sharedInitializationProperties:r,group:u,newExpressionExecutorPromises:a})}}return o}_updateInputFieldsFromLayerFields(e,t,n){if(!Array.isArray(t))return tt.getLogger(this.declaredClass).warn(this.declaredClass,"No attribute fields found."),[];const r=new Map;for(const u of e)if(TI(u)){for(const d of u.inputFields)d.destroy();u.inputFields.length=0,u.destroy()}else T(u.fieldElement)?u.destroy():r.set(u.field,u);const s=[],{feature:a,initialFeature:o,layer:l,messages:c}=n;for(const u of t){const d=r.get(u)??new cte({field:u,feature:a,initialFeature:o,layer:l,messages:c,value:a.getAttribute(u.name)??null});s.push(d),r.delete(u)}for(const[u,d]of r.entries())r.delete(u),d.destroy();return s}_resetInputFieldValues(e){for(const t of this.allInputFields)t.value=e.getAttribute(t.name)}_makeInputFieldFromFieldElement(e,t,n=null){const{feature:r,initialFeature:s,layer:a,messages:o}=t;return new cte({fieldElement:e,field:this._layerFieldsByName.get(e.fieldName),value:r.getAttribute(e.fieldName)??null,feature:r,initialFeature:s,layer:a,group:n,messages:o})}_makeInputFieldGroupFromGroupElement(e,t){const{feature:n,initialFeature:r}=t;return new owt({groupElement:e,inputFields:[],feature:n,initialFeature:r})}_assignExpressionExecutors(e,t,n){const r=J4(t)?cwt:lwt,s=[];for(const a of r){const o=t[a],{_expressionExecutorLookup:l}=this;if(T(o)&&o!==""){const c=`${a}Executor`,u=this._expressionLookup.get(o)??this._addToExpressionLookup(o);if(l.has(u))e[c]=l.get(u);else if(n.has(u)){const d=n.get(u).then(h=>(e[c]=h,h));n.set(u,d)}else{const d=swt(u,this.layer).then(h=>(e[c]=h,l.set(u,h),h));n.set(u,d)}}}return s}_createExpressionsManager(e,t){const{_arcadeContextInfo:n,_featureClone:r}=this;this._expressionsManager=new wv({executors:e,feature:r,arcadeContextInfo:n,inputFields:t})}_afterValueChange(e){const{name:t,value:n}=e;if(this.get("layer.typeIdField")===t&&"types"in this.layer){const r=new Set;this.layer.types.forEach(s=>Object.keys(s.domains).forEach(a=>r.add(a))),r.forEach(s=>{const a=this.findField(s);a&&a.notifyChange("domain")})}this._featureClone.setAttribute(t,n),this._emitChangeEvent(e)}_afterExpressionsEvaluated(){const{_featureClone:e}=this;for(const t of this.allInputFields)t.value!==e.getAttribute(t.name)&&this._afterValueChange(t)}_addToExpressionLookup(e){var s;const{_expressionLookup:t,formTemplate:n}=this,r=((s=T(n)&&T(n.expressionInfos)?Object.values(n.expressionInfos).find(a=>a.name===e):null)==null?void 0:s.expression)??e;return t.set(e,r),e!==r&&t.set(r,r),r}_isSupportedElement(e){return e.type==="field"||e.type==="group"||(tt.getLogger(this.declaredClass).warn("form-info::unsupported-element-type","Only element types 'field' and 'group' are supported",`Element ${e.label} has unsupported type '${e.type}'`),!1)}_joinContingentValues(){const e=this._contingentValuesCache;if(B(e))return[];const t="typeIdField"in this.layer?this.layer.typeIdField:null,n=t?this.getValue(t):null,r=[];for(const o of e.fieldGroups){const{contingencies:l,fields:c,name:u}=o,d=[];for(const h of l)h.isRetired||T(h.subtype)&&h.subtype.code!==n||d.push({values:h.values});d.length>0&&r.push({name:u,fields:c,contingencies:d})}const[s,a]=this._generateJoinPlan(r);return[...s.flatMap(o=>this._joinFieldGroupContingencies(o)),...a.flatMap(o=>o.contingencies)]}_generateJoinPlan(e){const t=new Map,n=[],r=new Set;for(const c of e)for(const u of c.fields)if(t.has(u)){const d=t.get(u),h=c,p=[d.name,h.name].sort().join("|");if(r.has(p))continue;n.push([d,h]),r.add(p),t.set(u,h)}else t.set(u,c);const s=new Set(n.flat()),a=new Set(e);for(const c of s)a.delete(c);const o=new Map,l=new Map;for(const c of new Set(n.flat())){const u=Symbol(c.name);o.set(u,new Set([c])),l.set(c,u)}for(const[c,u]of n){const d=l.get(c),h=l.get(u);if(d===h)continue;const p=o.get(d),m=o.get(h);for(const g of m)p.add(g),l.set(g,d);o.delete(h)}return[[...o.values()].map(c=>[...c]),[...a]]}_joinFieldGroupContingencies(e){const t=e.slice(),n=t.shift();let r=t.shift(),s=this._generateJoinKey(n.fields,r.fields),a=new Set([...n.fields,...r.fields]),o=new Map;for(const c of n.contingencies){const[u]=this._hashContingency(c,s.codedValueFields,!0);o.has(u)?o.get(u).push(c):o.set(u,[c])}for(;t.length>0;){const c=new Map,u=t.shift(),d=this._generateJoinKey(a,u.fields);for(const h of r.contingencies){const[p,m]=this._hashContingency(h,s.codedValueFields),g=m?this._findMatchingContingenciesWithAnyHashMask(o,p):o.get(p);if(o.has(U1)&&g.push(...this._findMatchingContingenciesContainingAny(h,o.get(U1),s.codedValueFields)),!B(g))for(const _ of g){const b=s.rangeFields.length>0?this._joinContingenciesWithRangeDomains(_,h,s.rangeFields):this._joinContingencies(_,h);if(B(b))break;const[x]=this._hashContingency(b,d.codedValueFields,!0);c.has(x)?c.get(x).push(b):c.set(x,[b])}}o=c,r=u,s=d,a=new Set([...a,...r.fields])}const l=[];for(const c of r.contingencies){const[u,d]=this._hashContingency(c,s.codedValueFields),h=d?this._findMatchingContingenciesWithAnyHashMask(o,u):o.get(u);if(o.has(U1)&&h.push(...this._findMatchingContingenciesContainingAny(c,o.get(U1),s.codedValueFields)),!B(h))for(const p of h){const m=s.rangeFields.length>0?this._joinContingenciesWithRangeDomains(p,c,s.rangeFields):this._joinContingencies(p,c);T(m)&&l.push(m)}}return l}_joinContingencies(e,t){const n={values:{...e.values,...t.values}};for(const[r,s]of Object.entries(n.values))s.objectType==="any"&&T(e.values[r])&&(n.values[r]=e.values[r]);return n}_joinContingenciesWithRangeDomains(e,t,n){const r=this._joinContingencies(e,t);for(const s of n){const a=e.values[s],o=t.values[s],{leftIsNull:l,rightIsNull:c,bothAreNull:u,leftIsAny:d,rightIsAny:h,bothAreAny:p,leftIsRange:m,rightIsRange:g}=this._compareObjectTypes(a.objectType,o.objectType);if(u||p)continue;if(l&&h||c&&d){r.values[s]=new Wa({objectType:"null"});continue}if(l&&g||c&&m)return null;d?(a.minValue=-1/0,a.maxValue=1/0):h&&(o.minValue=-1/0,o.maxValue=1/0);const _=Math.max(a.minValue,o.minValue),b=Math.min(a.maxValue,o.maxValue);if(_>b)return null;r.values[s]=new Wa({objectType:"range",minValue:_,maxValue:b})}return r}_findMatchingContingenciesContainingAny(e,t,n){return t.filter(r=>n.every(s=>{var l,c;const a=r.values[s],o=e.values[s];return a.objectType==="any"||o.objectType==="any"||((l=a.codedValue)==null?void 0:l.code)===((c=o.codedValue)==null?void 0:c.code)}))}_findMatchingContingenciesWithAnyHashMask(e,t){const n=RegExp(`${t}$`),r=[];for(const[s,a]of e){if(s===U1)break;n.test(s)&&r.push(...a)}return r}_generateJoinKey(e,t){const n=Array.isArray(e)?new Set(e):e,r=Array.isArray(t)?new Set(t):t,s=n.size<r.size?n:r,a=s===n?r:n,o=new Set,l=new Set;for(const c of s)if(a.has(c)){const u=this.layer.getFieldDomain(c,{feature:this.feature});if(B(u))continue;switch(u.type){case"coded-value":o.add(c);break;case"range":l.add(c)}}return{codedValueFields:[...o],rangeFields:[...l]}}_hashContingency(e,t,n=!1){var a;if(t.length<1)return[uwt,!1];const r=[];let s=!1;for(const o of t){const l=e.values[o];if(l.objectType==="any"){if(n)return[U1,!0];s=!0,r.push(`${o}:.*`)}else l.objectType==="null"?r.push(`${o}:${dwt}`):r.push(`${o}:${(a=l.codedValue)==null?void 0:a.code}`)}return[r.sort().join("&"),s]}_compareObjectTypes(e,t){return{leftIsNull:e==="null",rightIsNull:t==="null",bothAreNull:e==="null"&&t==="null",leftIsAny:e==="any",rightIsAny:t==="any",bothAreAny:e==="any"&&t==="any",leftIsRange:e==="range",rightIsRange:t==="range"}}};f([y()],as.prototype,"_arcadeContextInfo",null),f([y()],as.prototype,"updating",null),f([y({readOnly:!0})],as.prototype,"allInputFields",null),f([y()],as.prototype,"_layerFieldsByName",null),f([y()],as.prototype,"arcadeEditType",void 0),f([y()],as.prototype,"contingencyConstraintViolations",void 0),f([y()],as.prototype,"feature",null),f([y()],as.prototype,"fieldsWithContingentValues",null),f([y({type:Zwe})],as.prototype,"formTemplate",null),f([y()],as.prototype,"inputFields",void 0),f([y()],as.prototype,"joinedContingentValues",null),f([y()],as.prototype,"layer",null),f([y()],as.prototype,"messages",void 0),f([y()],as.prototype,"spatialReference",null),f([y()],as.prototype,"state",null),f([y()],as.prototype,"strict",void 0),f([y()],as.prototype,"submittable",null),f([y()],as.prototype,"valid",null),f([y()],as.prototype,"view",void 0),f([y()],as.prototype,"getValues",null),f([y()],as.prototype,"submit",null),as=f([ge("esri.widgets.FeatureForm.FeatureFormViewModel")],as);const TI=i=>!!i.inputFields,J4=i=>i.type==="group",ute=i=>i.reduce((e,t)=>TI(t)?[...e,...t.inputFields]:[...e,t],[]),eN=(i,e,t)=>{T(e)&&i.set(e,t)},lge=as,ji={base:"esri-feature-form",form:"esri-feature-form__form",formHeader:"esri-feature-form__form-header",label:"esri-feature-form__label",inputFieldWrapper:"esri-feature-form__input-wrapper",inputFieldLoader:"esri-feature-form__input-loader",inputField:"esri-feature-form__input",inputDate:"esri-feature-form__input--date",inputTime:"esri-feature-form__input--time",inputRadioGroup:"esri-feature-form__input--radio-group",inputRadio:"esri-feature-form__input--radio",inputRadioLabel:"esri-feature-form__input--radio-label",inputDisabled:"esri-feature-form__input--disabled",inputSwitch:"esri-feature-form__input--switch",inputInvalid:"esri-feature-form__input--invalid",inputIconInvalid:"esri-feature-form__input-icon--invalid",errorMessage:"esri-feature-form__field-error-message",description:"esri-feature-form__description-text",dateInputPart:"esri-feature-form__date-input-part",loneDateInputPart:"esri-feature-form__date-input-part--lone",dateInputContainer:"esri-feature-form__date-input-container",dateFormatHint:"esri-feature-form__date-format-hint",group:"esri-feature-form__group",groupLabel:"esri-feature-form__group-label",groupHeader:"esri-feature-form__group-header",groupHeading:"esri-feature-form__group-header",groupTitle:"esri-feature-form__group-title",groupDescription:"esri-feature-form__group-description",groupToggleIcon:"esri-feature-form__group-toggle-icon",groupCollapsed:"esri-feature-form__group--collapsed",groupSequential:"esri-feature-form__group--sequential",groupActive:"esri-feature-form__group--active",collapseIcon:"esri-icon-up",errorIcon:"esri-icon-notice-triangle",expandIcon:"esri-icon-down",widget:"esri-widget",panel:"esri-widget--panel",input:"esri-input",select:"esri-select"},dte={datePattern:"D",timePattern:"tt"};function IO(i){return i&&i.inputFields}const aS="data-field-name";let tl=class extends gr{constructor(e,t){super(e,t),this._activeDateFieldEdit=null,this._activeInputName=null,this._activeNumberFieldEdit=null,this._fieldFocusNeeded=!1,this._fieldToInitialIncompatibleDomainValue=new Map,this._switchFieldsWithInitialIncompatibleValue=new Set,this._userUpdatedInputFieldNames=new Set,this.disabled=!1,this.groupDisplay="all",this.headingLevel=2,this.messages=null,this.messagesTemplates=null,this.viewModel=new lge,this._handleRadioInputChange=n=>{this._commitInputValue(n.target)},this._handleInputInput=n=>{this._commitInputValue(n.currentTarget,!0)},this._handleFormKeyDown=this._handleFormKeyDown.bind(this),this._handleInputBlur=this._handleInputBlur.bind(this),this._handleInputFocus=this._handleInputFocus.bind(this),this._handleNumberInputMouseDown=this._handleNumberInputMouseDown.bind(this),this._handleInputKeyDown=this._handleInputKeyDown.bind(this),this._handleOptionChange=this._handleOptionChange.bind(this),this._handleGroupClick=this._handleGroupClick.bind(this),this._handleSubmit=this._handleSubmit.bind(this),this._afterInputCreateOrUpdate=this._afterInputCreateOrUpdate.bind(this)}initialize(){this.addHandles([ue(()=>this.feature,()=>{const e=this._getFocusableInput("forward");this._activeInputName=e&&e.name,this._userUpdatedInputFieldNames.clear(),this._fieldToInitialIncompatibleDomainValue.clear(),this._switchFieldsWithInitialIncompatibleValue.clear(),this._fieldFocusNeeded=!0}),this.on("submit",e=>{if(e.invalid.length>0){const[t]=e.invalid;e.invalid.forEach(n=>this._userUpdatedInputFieldNames.add(n)),this._activeInputName=t,this._fieldFocusNeeded=!0,this.scheduleRender()}})])}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-combobox-40cafeed.js"),["./calcite-combobox-40cafeed.js","./dom-5b7af1bf.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js","./guid-e49c4e43.js","./utils2-202b6d37.js","./label2-0103af15.js","./form-9bc9e261.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./openCloseComponent-587e936b.js","./conditionalSlot-e2a39862.js","./icon-1a289254.js"],import.meta.url),Ee(()=>import("./calcite-combobox-item-558b8e1f.js"),["./calcite-combobox-item-558b8e1f.js","./dom-5b7af1bf.js","./guid-e49c4e43.js","./utils2-202b6d37.js","./conditionalSlot-e2a39862.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js"],import.meta.url),Ee(()=>import("./calcite-combobox-item-group-6fcfa576.js"),["./calcite-combobox-item-group-6fcfa576.js","./dom-5b7af1bf.js","./utils2-202b6d37.js","./guid-e49c4e43.js"],import.meta.url),Ee(()=>import("./calcite-input-message-8a4f3713.js"),["./calcite-input-message-8a4f3713.js","./dom-5b7af1bf.js","./icon-1a289254.js","./observers-c77bfda3.js"],import.meta.url),Ee(()=>import("./calcite-progress-061376c7.js"),["./calcite-progress-061376c7.js","./progress-ae83f8fa.js","./dom-5b7af1bf.js"],import.meta.url),Ee(()=>import("./calcite-switch-7a55799a.js"),["./calcite-switch-7a55799a.js","./dom-5b7af1bf.js","./label2-0103af15.js","./form-9bc9e261.js","./interactive-52dcf836.js","./key-1fec8108.js"],import.meta.url)])}destroy(){this._userUpdatedInputFieldNames.clear(),this._userUpdatedInputFieldNames=null}get feature(){return this.viewModel.feature}set feature(e){this.viewModel.feature=e}get formTemplate(){return this.viewModel.formTemplate}set formTemplate(e){this.viewModel.formTemplate=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(e){this.viewModel.spatialReference=e}get strict(){return this.viewModel.strict}set strict(e){this.viewModel.strict=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}getValues(){return this.viewModel.getValues()}submit(){return this.viewModel.submit()}render(){const{state:e}=this.viewModel;return z("div",{class:this.classes(ji.base,ji.widget,ji.panel)},e==="ready"?this.renderForm():null)}renderForm(){const{formTemplate:e}=this,t=T(e)&&e.title&&z(Ul,{key:"title",level:this.headingLevel},e.title),n=T(e)&&e.description&&z("p",{class:ji.description,key:"description"},e.description),r=t||n?z("div",{class:ji.formHeader},t,n):null;return z("form",{class:ji.form,novalidate:!0,onsubmit:this._handleSubmit,onkeydown:this._handleFormKeyDown},r,this.renderFields())}renderFields(){const{viewModel:{inputFields:e}}=this;return e.filter(t=>t.visible).map((t,n)=>IO(t)?this.renderGroup(t,n):this.renderLabeledField(t))}renderGroup(e,t){const{formTemplate:n,disabled:r}=this,{description:s,inputFields:a,label:o,state:l}=e,c=a.filter(w=>w.visible),u=this.viewModel.findField(this._activeInputName),d=!(!u||u.group!==e),h=`${this.id}_group_${t}`,p=`${this.id}_group-label_${t}`,m=`${this.id}_group-description_${t}`,g=s?z("p",{class:this.classes(ji.groupDescription,ji.description),id:m},s):null,_=this.groupDisplay==="sequential",b=_?d:l==="expanded",x=b?ji.collapseIcon:ji.expandIcon;return z("fieldset",{"aria-expanded":b.toString(),"aria-labelledby":p,"aria-describedby":s?m:"",class:this.classes(ji.group,_?ji.groupSequential:null,b?null:ji.groupCollapsed,d?ji.groupActive:null,r?ji.inputDisabled:null),disabled:r,"data-group":e,id:h,key:t,onclick:this._handleGroupClick},z("button",{role:_?"presentation":void 0,class:ji.groupHeader,type:"button",tabIndex:_?-1:0},z("div",{class:ji.groupTitle},z(Ul,{class:ji.groupLabel,id:p,level:T(n)&&n.title?s0(this.headingLevel):this.headingLevel},o),g),_?null:z("span",{class:this.classes(x,ji.groupToggleIcon)})),c.map(w=>this.renderLabeledField(w)))}_getFocusableInput(e,t){const n=this.viewModel.allInputFields,r=e==="forward"?n:n.slice().reverse();let s;if(t)if(IO(t))s=r.indexOf(t.inputFields[0]);else{let a;if(this._isInputFieldInGroup(t)&&t.group.state==="collapsed"){const{inputFields:o}=t.group;a=e==="forward"?o[o.length-1]:o[0]}else a=t;s=r.indexOf(a)+1}else s=0;for(let a=s;a<r.length;a++){const o=r[a];if(o.visible)return o}return null}renderLabeledField(e){const{feature:t,label:n,layer:r,type:s}=e;return z("label",{key:`${r.id}-${t.uid}-${e.name}`,class:ji.label},[n,s!=="unsupported"?this.renderInputField(e):this.renderUnsupportedField(e),this.renderAuxiliaryText(e)])}renderInputField(e){const{domain:t,name:n,type:r,updating:s,value:a}=e,o=this.getCommonInputProps(e);if((t==null?void 0:t.type)==="coded-value"){if(this._inputFieldHasInputType(e,"switch")){const{fieldElement:c}=e;if(!(this._switchFieldsWithInitialIncompatibleValue.has(n)||a==null||c.input.onValue!==a&&c.input.offValue!==a))return this.renderSwitchInputField(e,o);this._switchFieldsWithInitialIncompatibleValue.add(n)}return e.inputType==="radio-buttons"?this.renderRadioButtonsInputField(e,t.codedValues.map(({code:c,name:u})=>({value:c,name:u})),o):this.renderSelectInputField(e,this._getFieldValueOptions(n,t),o)}if(e.inputType==="datetime-picker"||r==="date")return this.renderDateInputField(e,o);const l=r==="number"?z("input",{type:"number",...o,value:T(this._activeNumberFieldEdit)&&this._activeNumberFieldEdit.fieldName===e.name?this._activeNumberFieldEdit.value:`${o.value}`}):e.inputType==="text-area"?z("textarea",{...o}):z("input",{type:"text",...o});return s?z("div",{class:ji.inputFieldWrapper},l,z("div",{class:ji.inputFieldLoader},z("calcite-progress",{type:"indeterminate"}))):l}_parseDateTime(e,t,n){if(n){let s=Sf.fromJSDate(this._parseDate(e,n));const a=Sf.fromMillis(t.value??Date.now());return s=n==="date"?s.set({hour:a.hour,minute:a.minute,second:a.second}):s.set({day:a.day,month:a.month,year:a.year}),s.isValid?s.toMillis():null}const r=Sf.fromJSDate(this._parseDate(e));return r.isValid?r.toMillis():null}renderDateInputField(e,t){var p,m;const{value:n,includeTime:r}=e,{date:s,time:a}=this._formatDate(0),o=`${this.id}-${t.key}`,l=`${o}-date`,c=`${o}-time`,{_activeDateFieldEdit:u}=this;let{date:d,time:h}=this._formatDate(n);return(u==null?void 0:u.fieldName)===e.name&&(d=((p=u.date.input)==null?void 0:p.value)??d,h=((m=u.time.input)==null?void 0:m.value)??h),z("div",{key:`${t.key}-date`,class:ji.dateInputContainer},z("div",{class:this.classes(ji.dateInputPart,r?null:ji.loneDateInputPart)},z("input",{"aria-label":e.label,"aria-describedby":l,type:"text",...t,"data-date-part":"date",class:this.classes(t.class,ji.inputDate),value:d}),z("div",{class:ji.dateFormatHint,id:l},s)),r?z("div",{class:ji.dateInputPart,key:"time-input"},z("input",{"aria-describedby":c,"aria-label":e.label,type:"text",...t,"data-date-part":"time",class:this.classes(t.class,ji.inputTime),value:h}),z("div",{class:ji.dateFormatHint,id:c},a)):null)}renderUnsupportedField(e){const t=this.getCommonInputProps(e);return z("input",{afterCreate:t.afterCreate,afterUpdate:t.afterUpdate,disabled:t.disabled,class:this.classes(ji.input,ji.inputField,ji.inputDisabled),onfocus:t.onfocus,readOnly:!0,tabIndex:t.tabIndex,type:"text",value:t.value,[aS]:t[aS]})}renderSelectInputField(e,t,n){const{value:r}=e,{messages:s,messagesTemplates:a}=this,o=t.map(h=>h.map(p=>z("calcite-combobox-item",{value:`${p.value}`,"text-label":p.name,key:`#${p.value}`,selected:r===p.value}))),[l,c]=o;this._registerIncompatibleValue(r,t.flat(),e,h=>{c.unshift(z("calcite-combobox-item",{value:`${h}`,"text-label":`${h}`,key:"incompatible-option",readOnly:!0}))});const u=c.length>0?[z("calcite-combobox-item-group",{key:"recommended",label:s.recommended},l),z("calcite-combobox-item-group",{key:"other",label:a.other},c)]:l,d=B(e.fieldElement)||this._inputFieldHasInputType(e,"combo-box")&&e.fieldElement.input.showNoValueOption;if(!e.required&&d){const h="",p=this._inputFieldHasInputType(e,"combo-box")&&e.fieldElement.input.noValueOptionLabel||this.messages.empty;u.unshift(z("calcite-combobox-item",{value:h,"text-label":this.messages.empty,key:"empty-option"},p))}return z("calcite-combobox",{...n,"selection-mode":"single","overlay-positioning":"fixed",disabled:n.disabled||n.readOnly,allowCustomValues:!1,onCalciteComboboxChange:h=>this._handleOptionChange(h.target)},u)}_registerIncompatibleValue(e,t,n,r){const s=this._fieldToInitialIncompatibleDomainValue,a=s.has(n.name);(a||e!=null&&e!==""&&!t.some(o=>o.value===e)||a)&&(a||s.set(n.name,e),r==null||r(s.get(n.name)))}renderRadioButtonsInputField(e,t,n){const{value:r}=e,s=t.map(o=>this.renderRadioButton({key:o.name,label:o.name,name:e.name,value:o.value,selected:o.value===r,props:n}));this._registerIncompatibleValue(r,t,e);const a=B(e.fieldElement)||this._inputFieldHasInputType(e,"radio-buttons")&&e.fieldElement.input.showNoValueOption;if(!e.required&&a){const o="",l=this._inputFieldHasInputType(e,"radio-buttons")&&e.fieldElement.input.noValueOptionLabel||this.messages.empty,c=r===o||r===null;s.unshift(this.renderRadioButton({key:"empty-option",label:l,name:e.name,value:o,selected:c,props:n}))}return z("div",{key:`${n.key}-radio`,class:ji.inputRadioGroup},s)}renderSwitchInputField(e,t){const{value:n}=e,r=!!this._inputFieldHasInputType(e,"switch")&&n===e.fieldElement.input.onValue;return z("calcite-switch",{...t,class:ji.inputSwitch,onCalciteSwitchChange:s=>{this._parseValue(s.currentTarget)},checked:r,disabled:t.disabled||t.readOnly})}renderRadioButton({key:e,name:t,value:n,selected:r,label:s,props:a}){return z("label",{key:e,class:ji.inputRadioLabel},z("input",{...a,class:ji.inputRadio,name:t,type:"radio",value:n,checked:r,onchange:this._handleRadioInputChange}),s)}renderAuxiliaryText(e){const t=this._userUpdatedInputFieldNames.has(e.name)&&!e.valid?e.errorMessage:T(this.viewModel.contingencyConstraintViolations.get(e.name))?this.messages.validationErrors.valuesIncompatible:T(e.valueExpressionExecutor)&&e.valueExpressionExecutor.stale?this.messages.valueExpressionError:null;return T(t)?z("calcite-input-message",{status:"invalid",icon:!0,active:!0},t):e.description?z("div",{key:"description",class:ji.description},e.description):void 0}getCommonInputProps(e){const{disabled:t,groupDisplay:n}=this,{editable:r,group:s,hint:a,maxLength:o,minLength:l,name:c,required:u,type:d,valid:h,value:p}=e,m=this._userUpdatedInputFieldNames.has(c),g=!r,_=n==="all"&&T(s)&&s.state==="collapsed";return{afterCreate:this._afterInputCreateOrUpdate,afterUpdate:this._afterInputCreateOrUpdate,"aria-invalid":h?"false":"true",class:this.classes(ji.input,ji.inputField,t||g?ji.inputDisabled:null,m&&!h?ji.inputInvalid:null),key:c,label:c,minlength:l>-1?`${l}`:"",maxlength:o>-1?`${o}`:"",...this._getNumberFieldConstraints(e),disabled:t,readOnly:g,value:p==null?"":`${p}`,[aS]:c,onfocus:this._handleInputFocus,oninput:this._handleInputInput,onblur:this._handleInputBlur,onkeydown:this._handleInputKeyDown,onmousedown:d==="number"?this._handleNumberInputMouseDown:null,placeholder:d==="number"||d==="text"?a:"",required:u,tabIndex:_?-1:0}}_isInputFieldInGroup(e){return!IO(e)&&T(e.group)}_handleNumberInputMouseDown({target:e}){e.focus(),this.scheduleRender()}_getFieldValueOptions(e,t){const n=t.codedValues.map(({code:s,name:a})=>({value:s,name:a})),r=this.viewModel.fieldsWithContingentValues.has(e)?this._getContingentValueOptions(e):[];if(r.length>0){const s=new Set(r.map(a=>a.value));return[r,n.filter(a=>!s.has(a.value))]}return[n,[]]}_getContingentValueOptions(e){const t={};for(const s of this.viewModel.allInputFields){const{name:a,value:o}=s;!B(o)&&a!==e&&this.viewModel.fieldsWithContingentValues.has(a)&&(t[a]=o)}const n=this.viewModel.joinedContingentValues.slice(),r=new Map;for(const s of n){const a=s.values[e];if(B(a)||a.objectType!=="code"&&a.objectType!=="null")continue;const{code:o,name:l}=a.objectType==="null"?{code:"",name:this.messages.empty}:a.codedValue;r.has(o)||Object.entries(t).every(([c,u])=>!s.values.hasOwnProperty(c)||this._valueIsValidContingentValue(u,s.values[c]))&&r.set(o,{name:l,value:o})}return[...r.values()]}_getInputFieldFromInput(e){return this.viewModel.findField(e.getAttribute(aS))}_getNumberFieldConstraints(e){const t=$ie(e.domain)||Lie(e.field);return t&&t.max!==Number.MAX_VALUE&&t.min!==Number.MIN_VALUE?t:{min:null,max:null}}_afterInputCreateOrUpdate(e){const{viewModel:t}=this,n=this._getInputFieldFromInput(e),r=t.findField(this._activeInputName),s=this._fieldToInitialIncompatibleDomainValue.get(n.name)===n.value;this._fieldFocusNeeded&&r===n&&(n.inputType!=="radio-buttons"||s||e.checked)&&(this._fieldFocusNeeded=!1,this._isInputFieldInGroup(n)&&(n.group.state="expanded"),e.focus())}_handleInputFocus(e){const t=e.target,n=this._getInputFieldFromInput(t);this._activeInputName=n.name,n.type==="date"?this._syncDateFieldEdits(t):this._isNumberInputField(n)&&this._setUpNumberFieldEdit(t)}_isNumberInputField({domain:e,inputType:t="text-box",type:n}){return n==="number"&&t==="text-box"&&(!e||e.type!=="coded-value")}_handleInputBlur(e){const t=e.target,n=this._getInputFieldFromInput(t);if(n.type==="date"){const r=e.relatedTarget,s=r&&this._getInputFieldFromInput(r);if(s&&n.type==="date"&&s.type==="date"&&n.field===s.field){if(t.value!==""&&r.value===""){const a=r.getAttribute("data-date-part");r.value=this._formatDate(n.value??Date.now())[a],this._parseDate(t.value,t.getAttribute("data-date-part"))&&this._commitInputValue(e.target,!0,!1)}return}}n.type==="number"&&T(this._activeNumberFieldEdit)&&(this._activeNumberFieldEdit.input.value=`${n.value}`,this._activeNumberFieldEdit=null),this._commitInputValue(t),this.scheduleRender()}_commitInputValue(e,t=!1,n=!0){var s,a,o;const r=this._getInputFieldFromInput(e);if(this._activeDateFieldEdit){const{date:l,time:c}=this._activeDateFieldEdit,u=this._parseDateTime(e.value,r,l.active?"date":"time"),d=this.viewModel.getValue(r.name)!==null,h=l.input&&(c.input||!r.includeTime),p=u===null;if(t){if(p)return;(h||!n||d)&&this._updateDateFieldValue(r,u)}else{if(((s=l.input)==null?void 0:s.value)===""||((a=c.input)==null?void 0:a.value)==="")this._updateDateFieldValue(r,null);else if(h){const m=`${l.input.value} ${((o=c.input)==null?void 0:o.value)??""}`,g=this._parseDateTime(m,r);g===null&&d||this._updateDateFieldValue(r,g)}this._activeDateFieldEdit=null}}else T(this._activeNumberFieldEdit)&&this._isNumberInputField(r)&&(this._activeNumberFieldEdit.value=e.value),this._updateFieldValue(e)}_handleInputKeyDown(e){const{key:t,altKey:n,ctrlKey:r,metaKey:s}=e,a=this._getInputFieldFromInput(e.target);if(t==="Enter")this._isInputFieldInGroup(a)&&a.group.state==="collapsed"&&(a.group.state="expanded");else{const{type:o}=a.field,l=o==="single"||o==="double";if((o==="integer"||o==="small-integer"||l)&&(!n&&!r&&!s)&&t.length===1){const u=Number(t),d=["-","+"],h=["e","."],p=l?[...d,...h]:d;isNaN(u)&&!p.includes(t)&&e.preventDefault()}}}_setUpNumberFieldEdit(e){const t=this._getInputFieldFromInput(e);this._activeNumberFieldEdit={fieldName:t.name,input:e,value:e.value}}_syncDateFieldEdits(e){var a,o;const t=this._getInputFieldFromInput(e);if(t.type!=="date")return;const n=e.getAttribute("data-date-part"),r=n==="date"?{value:e.value,input:e,active:!0}:{...(a=this._activeDateFieldEdit)==null?void 0:a.date,active:!1},s=n==="time"?{value:e.value,input:e,active:!0}:{...(o=this._activeDateFieldEdit)==null?void 0:o.time,active:!1};this._activeDateFieldEdit={fieldName:t.name,date:r,time:s}}_updateFieldValue(e){const t=e.getAttribute(aS);if(this.viewModel.setValue(t,this._parseValue(e)),this._userUpdatedInputFieldNames.add(t),this.viewModel.fieldsWithContingentValues.has(t)){const n=Object.fromEntries(Object.entries(this.getValues()).filter(([r,s])=>T(s)));this.viewModel.validateContingencyConstraints(n)}}_updateDateFieldValue(e,t){this.viewModel.setValue(e.name,t),this._userUpdatedInputFieldNames.add(e.name)}_parseValue(e){const t=this._getInputFieldFromInput(e),n=e.value;if(this._inputFieldHasInputType(t,"switch")&&e.tagName!=="CALCITE-COMBOBOX")return e.checked?t.fieldElement.input.onValue:t.fieldElement.input.offValue;if(t.inputType==="radio-buttons"&&e.type==="radio"&&!e.checked)return t.value;const{type:r}=t;if(r==="number")return n?parseFloat(n):null;if(r==="date"){if(!n)return null;const s=Number(n);if(!isNaN(s))return s;const a=e.getAttribute("data-date-part"),o=this._parseDate(n,a);if(!o)return null;let l=Sf.fromJSDate(o);const c=t.domain,u=Sf.now();let d=u;if(c&&c.type==="range"){const m=Sf.fromMillis(c.maxValue);u<m&&(d=m)}const h=this.viewModel.getValue(t.name),p=h!=null?Sf.fromMillis(h):d;return l=a==="date"?l.set({hour:p.hour,minute:p.minute,second:p.second}):l.set({day:p.day,month:p.month,year:p.year}),l.toMillis()}return n}_handleOptionChange(e){this._commitInputValue(e),this.scheduleRender()}_handleGroupClick(e){var a;const t=e.currentTarget["data-group"],n=t.state==="expanded",r=this.groupDisplay==="sequential",s=`.${ji.groupHeader}`;if(!(n&&!e.target.closest(s))){if(this._activeInputName=(a=this._getFocusableInput("forward",t))==null?void 0:a.name,r){const o=e.target.closest(s);if(n&&!o)return;this.viewModel.inputFields.forEach(l=>{IO(l)&&l!==t&&(l.state="collapsed")})}t.state=n?"collapsed":"expanded",this._fieldFocusNeeded=r,this.scheduleRender()}}_handleSubmit(e){e.preventDefault()}_handleFormKeyDown(e){e.key==="Enter"&&this.viewModel.submit()}_formatDate(e){if(e==null)return{date:"",time:""};const t=Sf.fromMillis(e,{locale:NN(),numberingSystem:"latn"});return{date:t.toLocaleString({year:"numeric",month:"2-digit",day:"2-digit"}),time:t.toFormat(dte.timePattern)}}_parseDate(e,t){if(e==null||e==="")return null;const{timePattern:n,datePattern:r}=dte,s=t?t==="date"?r:n:`${r} ${n}`,a=Sf.fromFormat(e,s,{locale:NN(),numberingSystem:"latn"});return a.isValid?a.toJSDate():null}_inputFieldHasInputType(e,t){var n;return T(e.fieldElement)&&((n=e.fieldElement.input)==null?void 0:n.type)===t}_valueIsValidContingentValue(e,t){var n;switch(t.objectType){case"any":return!0;case"null":return e==null;case"code":return e===((n=t.codedValue)==null?void 0:n.code);case"range":return e>=t.minValue&&e<=t.maxValue;default:return Do(t.objectType),!1}}};f([y()],tl.prototype,"disabled",void 0),f([y()],tl.prototype,"feature",null),f([y()],tl.prototype,"formTemplate",null),f([y()],tl.prototype,"groupDisplay",void 0),f([y()],tl.prototype,"headingLevel",void 0),f([y()],tl.prototype,"label",null),f([y()],tl.prototype,"layer",null),f([y(),En("esri/widgets/FeatureForm/t9n/FeatureForm")],tl.prototype,"messages",void 0),f([y(),En("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],tl.prototype,"messagesTemplates",void 0),f([y()],tl.prototype,"spatialReference",null),f([y()],tl.prototype,"strict",null),f([y()],tl.prototype,"view",null),f([y(),WC(["value-change","submit"])],tl.prototype,"viewModel",void 0),tl=f([ge("esri.widgets.FeatureForm")],tl);const hwt=tl;var C8;const cge="esri.widgets.FeatureTemplates.TemplateItem";let xv=C8=class extends Ba(et){constructor(i){super(i),this._activeFetchInfo={id:null,request:null},this.layer=null,this.template=null,this.thumbnail=null}initialize(){this.handles.add(ue(()=>{const{layer:i}=this;return[i&&"renderer"in i?i.renderer:null,this.template]},()=>{this._activeFetchInfo.id=null,this._activeFetchInfo.request=null,this._set("thumbnail",null)},At))}get description(){var i;return(i=this.template)==null?void 0:i.description}set description(i){this.template&&(this.template.description=i)}get label(){var i;return(i=this.template)==null?void 0:i.name}set label(i){this.template&&(this.template.name=i)}clone(){const i=T(this.thumbnail)?this.thumbnail.cloneNode(!0):null,e=new C8({layer:this.layer,template:this.template});return e._set("thumbnail",i),e}static async fetchThumbnail(i,e){var r;if(mwt(i))return tt.getLogger(cge).warn("Thumbnails for sublayers of a SubtypeGroupLayer are not yet supported."),null;const t=await pwt(i,e);if(B(t))return null;const n={maxSize:36};return((r=i.renderer)==null?void 0:r.type)==="dictionary"&&(n.fieldMap=i.renderer.fieldMap,n.feature={attributes:e.prototype.attributes}),await bU(t,n)}};async function pwt(i,e){const{renderer:t}=i;if(t){const n=new ao({attributes:e.prototype.attributes}),r=await t.getSymbolAsync(n);if(r)return r}return fwt(i)}async function fwt(i){const{geometryType:e}=i,t=e==="point"||e==="multipoint"?await Ee(()=>import("./symbols-fa594797.js").then(n=>n.I),["./symbols-fa594797.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./CIMSymbol-1379245a.js","./enumeration-3c281341.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./Clonable-ba795b08.js"],import.meta.url):e==="polyline"?await Ee(()=>import("./symbols-fa594797.js").then(n=>n.G),["./symbols-fa594797.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./CIMSymbol-1379245a.js","./enumeration-3c281341.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./Clonable-ba795b08.js"],import.meta.url):e==="polygon"||e==="mesh"||e==="multipatch"?await Ee(()=>import("./symbols-fa594797.js").then(n=>n.H),["./symbols-fa594797.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./CIMSymbol-1379245a.js","./enumeration-3c281341.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./Clonable-ba795b08.js"],import.meta.url):null;return t?new t.default:null}function mwt(i){return i.type==="subtype-group"}f([y()],xv.prototype,"description",null),f([y()],xv.prototype,"label",null),f([y()],xv.prototype,"layer",void 0),f([y()],xv.prototype,"template",void 0),f([y({readOnly:!0})],xv.prototype,"thumbnail",void 0),xv=C8=f([ge(cge)],xv);const T8=xv;let WS=class extends RC(et){constructor(e){super(e),this.items=null,this.label=null}};f([y()],WS.prototype,"items",void 0),f([y()],WS.prototype,"label",void 0),WS=f([ge("esri.widgets.FeatureTemplates.TemplateItemGroup")],WS);const gwt=WS;var jS;const vwt=({layer:i})=>({key:i,label:i.title}),ywt=({layer:i})=>({key:i.geometryType,label:i.geometryType});let il=jS=class extends Ba(Pn.EventedAccessor){constructor(i){super(i),this._itemPool=new Ic(T8),this._groupPool=new Ic(gwt),this.filterFunction=null,this.selectedItem=null}initialize(){this._get("groupBy")||(this.groupBy="layer")}destroy(){this._templateToLayer.clear()}get _templateToLayer(){const i=new Map;for(const[e,t]of this._featureTemplatesByLayer)for(const n of t)i.set(n,e);return i}set groupBy(i){if(this._set("groupBy",i),typeof i!="function")switch(i){case"none":this._groupByFunction=null;break;case"layer":this._groupByFunction=vwt;break;case"geometry":this._groupByFunction=ywt}else this._groupByFunction=e=>this._ensureGroupByObject(i(e))}set layers(i){const e="layers";if(this.handles.remove(e),i){const t=()=>this.notifyChange("state");this.handles.add(i.map(n=>rs(()=>n.loadStatus,t)),"layers")}this._set("layers",i)}get layers(){return this._get("layers")}get state(){const{layers:i}=this;return i&&i.length!==0?i.some(e=>e.loadStatus==="loading"||e.loadStatus==="not-loaded")?"loading":"ready":"disabled"}get _featureTemplatesByLayer(){if(!this.layers)return new Map;const i=[];for(const e of this.layers){const t="templates"in e&&e.templates?e.templates:[],n="types"in e&&e.types?_wt(e.types):[];i.push([e,[...t,...n]])}return new Map(i)}get numberOfFeatureTemplates(){return Array.from(this._featureTemplatesByLayer.values()).reduce((i,e)=>i+e.length,0)}get items(){if(this.numberOfFeatureTemplates===0)return this._releasePreviousItems(),[];const i=this._featureTemplatesByLayer,e=[],t=T(this.filterFunction)?this.filterFunction:jS._nullFilterFunction;for(const[s,a]of i)if(s.loaded){const{capabilities:{operations:{supportsEditing:o,supportsAdd:l}}}=s;if(o&&l)for(const c of a)e.push({layer:s,template:c,matchesFilter:t({label:c.name})})}if(B(this._groupByFunction)){const s=e.filter(({matchesFilter:a})=>a).map(({template:a,layer:o})=>this._createItem(a,o));return this._releasePreviousItems(),s}const n=new Map;for(const s of e){const{template:a,layer:o}=s,l=this._groupByFunction({template:a,layer:o}),{key:c,label:u}=T(l.key)?l:jS.nullGroupBy;n.has(c)||n.set(c,{label:u,templateItemInfos:[]}),n.get(c).templateItemInfos.push(s)}const r=[];for(const s of n.values()){const{label:a,templateItemInfos:o}=s,l=o.filter(({matchesFilter:u})=>u),c=t({label:a})?o:o.length>0?l:[];if(c.length>0){const u=c.map(({template:d,layer:h})=>this._createItem(d,h));r.push(this._createGroup(a,u))}}return r.length===1&&r[0].label===jS.nullGroupBy.label?(this._releasePreviousItems(),r[0].items):(this._releasePreviousItems(),r)}refresh(){this.notifyChange("items")}select(i){const e=(i==null?void 0:i.clone())||null;this._set("selectedItem",e),this.emit("select",{item:e,template:(e==null?void 0:e.template)||null})}_createItem(i,e){const t=this._itemPool.acquire();return t.set({template:i,layer:e}),t}_createGroup(i,e){const t=this._groupPool.acquire();return t.set("label",i),t.items=e,t}_releasePreviousItems(){this._destroyItems(this._get("items"))}_destroyItems(i){i&&(i[0]instanceof T8?i.forEach(e=>this._destroyItem(e)):i.forEach(e=>this._destroyGroup(e)))}_destroyGroup(i){i.items.forEach(e=>this._destroyItem(e)),i.items.length=0,this._groupPool.release(i)}_destroyItem(i){i.layer=null,i.template=null,this._itemPool.release(i)}_ensureGroupByObject(i){return typeof i=="string"?{key:i,label:i}:i}};function _wt(i){return i.reduce((e,t)=>[...e,...t.templates],[])}il.nullGroupBy={key:Symbol(),label:"Other"},il._nullFilterFunction=i=>!0,f([y()],il.prototype,"_groupByFunction",void 0),f([y({readOnly:!0})],il.prototype,"_templateToLayer",null),f([y()],il.prototype,"filterFunction",void 0),f([y()],il.prototype,"groupBy",null),f([y()],il.prototype,"layers",null),f([y()],il.prototype,"state",null),f([y({readOnly:!0})],il.prototype,"_featureTemplatesByLayer",null),f([y({readOnly:!0})],il.prototype,"numberOfFeatureTemplates",null),f([y({readOnly:!0})],il.prototype,"items",null),f([y({readOnly:!0})],il.prototype,"selectedItem",void 0),f([y()],il.prototype,"select",null),il=jS=f([ge("esri.widgets.FeatureTemplates.FeatureTemplatesViewModel")],il);const S8=il,hy={base:"esri-item-list",list:"esri-item-list__list",group:"esri-item-list__group",scroller:"esri-item-list__scroller",groupHeader:"esri-item-list__group__header",item:"esri-item-list__list-item",itemSelected:"esri-item-list__list-item--selected",itemContainer:"esri-item-list__list-item-container",itemLabel:"esri-item-list__list-item-label",itemIcon:"esri-item-list__list-item-icon",noMatchesMessage:"esri-item-list__no-matches-message",noItemsMessage:"esri-item-list__no-items-message",filterContainer:"esri-item-list__filter-container",filterContainerSticky:"esri-item-list__filter-container--sticky",filterPlaceholder:"esri-item-list__filter-placeholder",filterInput:"esri-item-list__filter-input",filterPlaceholderText:"esri-item-list__filter-placeholder-text",searchIcon:"esri-icon-search",widget:"esri-widget",input:"esri-input"};function uge(i){const{id:e,identify:t,filterEnabled:n=!0,headingLevel:r=4,items:s,selectedItem:a,messages:o,filterText:l="",onFilterChange:c,renderIcon:u,onItemMouseLeave:d,onItemMouseEnter:h,onItemSelect:p}=i,m=i.enableListScroll??!0;return z("div",{key:e},n?xwt({filterText:l,messages:o,onFilterChange:c,id:e}):null,wwt({enableListScroll:m,identify:t,items:s,selectedItem:a,messages:o,filterText:l,headingLevel:r,renderIcon:u,onItemMouseLeave:d,onItemMouseEnter:h,onItemSelect:p}))}function bwt(i){return!!i.items}function wwt(i){const{headingLevel:e,identify:t,items:n,renderIcon:r,filterText:s,onItemMouseLeave:a,onItemMouseEnter:o,onItemSelect:l,selectedItem:c}=i,u=i.enableListScroll?hy.scroller:null;return n.length===0?z("div",{class:hy.noMatchesMessage,key:"no-matches"},i.messages.noMatches):z("div",{class:u,key:"item-container"},n.map(d=>bwt(d)?Cwt({group:d,filterText:s,headingLevel:e,identify:t,onItemMouseLeave:a,onItemMouseEnter:o,onItemSelect:l,renderIcon:r,selectedItem:c}):dge({item:d,identify:t,grouped:!0,onItemMouseLeave:a,onItemMouseEnter:o,onItemSelect:l,renderIcon:r,filterText:s,selectedItem:c})))}function xwt(i){const{messages:e,filterText:t,enableListScroll:n}=i;return z("div",{key:"filter",class:n?null:hy.filterContainerSticky},z("calcite-input",{onCalciteInputInput:r=>{const s=r.currentTarget;i.onFilterChange&&i.onFilterChange(s.value)},placeholder:e.filterPlaceholder,value:t,type:"search"}))}function dge(i){const{identify:e,item:t,selectedItem:n,grouped:r,onItemSelect:s,onItemMouseEnter:a,onItemMouseLeave:o,renderIcon:l}=i,c=`${(e==null?void 0:e(t))||t.id}__${t.label}`,u=n?`${(e==null?void 0:e(n))||n.id}__${n.label}`:"";return z("calcite-list-item",{"aria-level":r?"2":"","data-item":t,key:c,class:Ow(hy.item,c===u?hy.itemSelected:""),label:t.label,onclick:d=>{const h=d.currentTarget["data-item"];s&&s(h)},onmouseenter:d=>{const h=d.currentTarget["data-item"];a&&a(h)},onkeydown:d=>{if(!Sie(d.key))return;const h=d.currentTarget["data-item"];s&&s(h)},onmouseleave:d=>{const h=d.currentTarget["data-item"];o&&o(h)},tabIndex:0},z("div",{class:hy.itemIcon,slot:"content-start"},l&&l({item:t})))}function Cwt(i){const{group:e,identify:t,onItemMouseLeave:n,onItemMouseEnter:r,onItemSelect:s,filterText:a,renderIcon:o,selectedItem:l,headingLevel:c}=i;return z("div",{class:hy.group,key:e.label},z(Ul,{level:c,class:hy.groupHeader},e.label),e.items.map(u=>dge({item:u,identify:t,grouped:!0,onItemMouseLeave:n,onItemMouseEnter:r,onItemSelect:s,renderIcon:o,filterText:a,selectedItem:l})))}const tN={base:"esri-feature-templates",loader:"esri-feature-templates__loader",widget:"esri-widget"};function hge(i){return"items"in i}function Twt(i){return i.length>0&&hge(i[0])}function Swt(i){const{label:e}=i;return hge(i)?e:`${e}${i.layer.id}`}const hte={filter:!0};let $l=class extends Ba(gr){constructor(e,t){super(e,t),this._iconIntersectionObserver=new IntersectionObserver((n,r)=>{n.forEach(async s=>{if(s.isIntersecting){const a=s.target;if(a["data-has-icon"])return void r.unobserve(a);const o=a["data-item"],{layer:l,template:c}=o;a["data-has-icon"]=!0;const u=await T8.fetchThumbnail(l,c).catch(()=>(a["data-has-icon"]=!1,null));if(B(u))return;a.appendChild(u)}})}),this.enableListScroll=!0,this.filterText="",this.headingLevel=4,this.messages=null,this.viewModel=new S8,this.visibleElements={...hte},this.renderItemIcon=this.renderItemIcon.bind(this),this._afterItemCreateOrUpdate=this._afterItemCreateOrUpdate.bind(this),this._afterItemRemoved=this._afterItemRemoved.bind(this)}initialize(){const e=({label:t})=>!this.filterText||t.toLowerCase().includes(this.filterText.toLowerCase());this.addHandles(ue(()=>this.viewModel,(t,n)=>{t&&!t.filterFunction&&(this.filterFunction=e),n&&n!==t&&n.filterFunction===e&&(n.filterFunction=null)},At))}destroy(){this._iconIntersectionObserver&&(this._iconIntersectionObserver.disconnect(),this._iconIntersectionObserver=null)}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-input-3a2d6757.js"),["./calcite-input-3a2d6757.js","./dom-5b7af1bf.js","./label2-0103af15.js","./form-9bc9e261.js","./key-1fec8108.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./progress-ae83f8fa.js"],import.meta.url),Ee(()=>import("./calcite-list-item-2b0d81b3.js"),["./calcite-list-item-2b0d81b3.js","./dom-5b7af1bf.js","./conditionalSlot-e2a39862.js","./observers-c77bfda3.js","./interactive-52dcf836.js"],import.meta.url)])}get filterFunction(){return this.viewModel.filterFunction}set filterFunction(e){this.viewModel.filterFunction=e}get groupBy(){return this.viewModel.groupBy}set groupBy(e){this.viewModel.groupBy=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layers(){return this.viewModel.layers}set layers(e){this.viewModel.layers=e}get selectedItem(){return this.viewModel.selectedItem}castVisibleElements(e){return{...hte,...e}}select(e){return this.viewModel.select(e)}render(){const{enableListScroll:e,filterText:t,headingLevel:n,messages:r,viewModel:{items:s,numberOfFeatureTemplates:a,selectedItem:o,state:l}}=this,c=this.visibleElements.filter&&a>1;if(Twt(s)){const u=s.find(d=>d.label===S8.nullGroupBy.label);u&&(u.label=r.other)}return z("div",{class:this.classes(tN.base,tN.widget),"aria-label":r.widgetLabel},l==="loading"?this.renderLoader():l==="ready"?z(uge,{id:this.id,identify:Swt,filterText:t,items:s,headingLevel:n,messages:{filterPlaceholder:r.filterPlaceholder,noItems:r.noItems,noMatches:r.noMatches},filterEnabled:c,onItemSelect:u=>{this.viewModel.select(u)},onFilterChange:u=>{this.filterText=u,this.viewModel.refresh()},renderIcon:this.renderItemIcon,selectedItem:o,enableListScroll:e}):null)}renderItemIcon({item:e}){return z("span",{key:"icon",afterCreate:this._afterItemCreateOrUpdate,afterUpdate:this._afterItemCreateOrUpdate,afterRemoved:this._afterItemRemoved,"data-item":e,"data-has-icon":!1})}renderLoader(){return z("div",{class:tN.loader,key:"loader"})}_afterItemCreateOrUpdate(e){var t;(t=this._iconIntersectionObserver)==null||t.observe(e)}_afterItemRemoved(e){var t;(t=this._iconIntersectionObserver)==null||t.unobserve(e)}};f([y()],$l.prototype,"enableListScroll",void 0),f([y()],$l.prototype,"filterFunction",null),f([y()],$l.prototype,"filterText",void 0),f([y()],$l.prototype,"groupBy",null),f([y()],$l.prototype,"headingLevel",void 0),f([y()],$l.prototype,"label",null),f([y()],$l.prototype,"layers",null),f([y(),En("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],$l.prototype,"messages",void 0),f([y({readOnly:!0})],$l.prototype,"selectedItem",null),f([y(),WC("select")],$l.prototype,"viewModel",void 0),f([y()],$l.prototype,"visibleElements",void 0),f([Mr("visibleElements")],$l.prototype,"castVisibleElements",null),$l=f([ge("esri.widgets.FeatureTemplates")],$l);const Ewt=$l;function Mx(i,e,t){txe(i,"`"+e+"` is deprecated, because it instantiates the deprecated class 'esri.widgets.Editor.CreateWorkflow'",{replacement:t,version:"4.23",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-widgets-Editor-CreateFeaturesWorkflow.html"})}let q_=class extends et{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1}};f([y({constructOnly:!0})],q_.prototype,"layer",void 0),f([y()],q_.prototype,"enabled",void 0),f([y()],q_.prototype,"updating",void 0),f([y()],q_.prototype,"availability",void 0),q_=f([ge("esri.views.interactive.snapping.FeatureSnappingLayerSource")],q_);const DH=q_;let qS=class extends et{constructor(e){super(e),this.creationInfo=null,this.viewModel=null}};f([y()],qS.prototype,"creationInfo",void 0),f([y()],qS.prototype,"viewModel",void 0),qS=f([ge("esri.widgets.Editor.CreateFeaturesWorkflowData")],qS);let Ku=class extends Ba(Pn.EventedAccessor){constructor(e){super(e),this._indexHistory=[],this._lastStepIndex=-1,this._stepIndex=-1,this._handleKeys={afterCommit:"after-commit",beforeCommit:"before-commit"},this.data=void 0,this.started=!1,this.steps=[],this.type=null}get hasNextStep(){const{steps:e}=this;return!!(e&&this._stepIndex<e.filter(t=>!t.parent).length-1)}get hasPreviousStep(){return this._stepIndex>0}get stepId(){const{steps:e}=this,t=e&&e[this._stepIndex];return t&&t.id}async cancel(e={force:!0}){return e.force!==!1?this._cancel():new Promise((t,n)=>{this.emit("cancel-request",{controller:{allow:()=>{this._cancel().then(t)},deny:()=>n(new Ze("workflow:cancel-denied","Request to cancel workflow was denied."))}})})}async commit(){this.handles.remove(this._handleKeys.beforeCommit),await this.onCommit(this.data),this.handles.remove(this._handleKeys.afterCommit),this.emit("commit"),this.started&&await this.reset()}async go(e){const{steps:t}=this,n=t.findIndex(r=>r.id===e);this._indexHistory.push(this._stepIndex),await this._go(n)}async next(){this._indexHistory.push(this._stepIndex),await this._go(this._stepIndex+1)}async previous(e={cancelCurrentStep:!1}){await this._go(this._indexHistory.pop(),e.cancelCurrentStep)}async reset(){await this._cancel(!1),await this.start()}async start(){this._set("started",!0);const e=this._stepIndex===-1?0:this._stepIndex;await this._go(e)}async _cancel(e=!0){this.started&&(this._set("started",!1),await this.steps[this._stepIndex].tearDown({cancelled:!0}),this.data&&this.data.viewModel.sketchViewModel.layer.removeAll()),this.handles.remove([this._handleKeys.afterCommit,this._handleKeys.beforeCommit]),this._resetIndexing(e),e&&this.emit("cancel")}async _go(e=-1,t=!1){if(!(e<=-1||e>=this.steps.length)){if(!this.started)return this._stepIndex=e,void this._notifyStepProps();this._lastStepIndex>-1&&await this.steps[this._lastStepIndex].tearDown({cancelled:t}),await this.steps[e].setUp(),this._lastStepIndex=e,this._stepIndex=e,this._notifyStepProps()}}_resetIndexing(e=!0){this._stepIndex=-1,this._lastStepIndex=-1,this._indexHistory.length=0,e&&this._notifyStepProps()}_notifyStepProps(){this.notifyChange("stepId"),this.notifyChange("hasPreviousStep"),this.notifyChange("hasNextStep")}};f([y()],Ku.prototype,"data",void 0),f([y()],Ku.prototype,"hasNextStep",null),f([y()],Ku.prototype,"hasPreviousStep",null),f([y()],Ku.prototype,"onCommit",void 0),f([y()],Ku.prototype,"started",void 0),f([y({readOnly:!0})],Ku.prototype,"stepId",null),f([y()],Ku.prototype,"steps",void 0),f([y({readOnly:!0})],Ku.prototype,"type",void 0),f([y()],Ku.prototype,"commit",null),Ku=f([ge("esri.widgets.Editor.Workflow")],Ku);const kH=Ku;function iN(i,e){return e?"xoffset"in e&&e.xoffset?Math.max(i,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(i,Math.abs(e.yoffset||0)):i:i}function Awt(i){let e=0,t=0;for(let n=0;n<i.length;n++){const r=i[n].size;typeof r=="number"&&(e+=r,t++)}return e/t}function pte(i,e){return typeof i=="number"?i:i&&i.stops&&i.stops.length?Awt(i.stops):e}function Mwt(i,e){if(!e)return i;const t=e.filter(a=>a.type==="size").map(a=>{const{maxSize:o,minSize:l}=a;return(pte(o,i)+pte(l,i))/2});let n=0;const r=t.length;if(r===0)return i;for(let a=0;a<r;a++)n+=t[a];const s=Math.floor(n/r);return Math.max(s,i)}function pge(i){var r;const e=i&&i.renderer,t=(i&&i.event&&i.event.pointerType)==="touch"?9:6;if(!e)return t;const n="visualVariables"in e?Mwt(t,e.visualVariables):t;if(e.type==="simple")return iN(n,e.symbol);if(e.type==="unique-value"){let s=n;return(r=e.uniqueValueInfos)==null||r.forEach(a=>{s=iN(s,a.symbol)}),s}if(e.type==="class-breaks"){let s=n;return e.classBreakInfos.forEach(a=>{s=iN(s,a.symbol)}),s}return e.type==="dot-density"||e.type,n}let K_=class extends Pn.EventedAccessor{constructor(e){super(e),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};f([y({constructOnly:!0})],K_.prototype,"graphic",void 0),f([y()],K_.prototype,"tracking",void 0),f([y()],K_.prototype,"displaying",void 0),f([y()],K_.prototype,"isDraped",void 0),K_=f([ge("esri.views.3d.layers.graphics.GraphicState")],K_);function fge(i,e,t,n=new fs){let r;if(t.type==="2d")r=e*t.resolution;else if(t.type==="3d"){const u=t.overlayPixelSizeInMapUnits(i),d=t.basemapSpatialReference;r=T(d)&&!d.equals(t.spatialReference)?rf(d)/rf(t.spatialReference):e*u}const s=i.x-r,a=i.y-r,o=i.x+r,l=i.y+r,{spatialReference:c}=t;return n.xmin=Math.min(s,o),n.ymin=Math.min(a,l),n.xmax=Math.max(s,o),n.ymax=Math.max(a,l),n.spatialReference=c,n}function L6t(i,e,t){const n=t.toMap(i);return B(n)?!1:fge(n,pge(),t,Pwt).intersects(e)}const Pwt=new fs;function $D(i){const e=i.sourceLayer;if(e.type!=="feature"||!Lwt(e.renderer))return{rotation:null,size:null};let t=null,n=null;const r=e.renderer.getVisualVariablesForType("rotation").filter(a=>(!a.axis||a.axis==="heading")&&a.field&&!a.valueExpression&&T(ewe(a,i)));r.length===1&&(t=Owt(r[0],e));const s=e.renderer.getVisualVariablesForType("size").filter(a=>a.field&&!a.useSymbolValue&&!a.valueExpression&&nxe(a)===rxe.RealWorldSize&&T(twe(a,i)));return s.length===1&&(n=$wt(s[0],e)),{rotation:t,size:n}}function Owt(i,e){const t=(i.axis||"heading")==="heading"&&i.rotationType==="arithmetic"?-1:1,n=i.field,r=e.fields&&e.fields.filter(o=>o.name===n),s=r&&r.length===1?r[0].type:"double",a={initial:0,current:0};return{field:n,fieldType:s,getDefault:()=>Promise.resolve(0),getValue:o=>(a.current=a.initial-t*o,E8((a.current+360)%360,s)),initValue:o=>{a.initial=o??a.current,a.current=0},isUpdatingInteractively:!1,rotationType:i.rotationType??"geographic"}}function Rwt(i,e){switch(e){case"width":return i[0];case"depth":return i[1];case"height":return i[2];default:return i[2]||i[1]||i[0]}}async function Iwt(i,e,t){if(B(e))return 0;const{symbol:n}=Yx(e);if(B(n)||n.type==="web-style"||n.type==="cim")return 0;const r=n.symbolLayers.getItemAt(0);if(!r)return 0;switch(r.type){case"icon":{const{computeIconLayerResourceSize:s}=await Ee(()=>import("./symbolLayerUtils-1bc2c213.js"),["./symbolLayerUtils-1bc2c213.js","./preload-helper-41c905a7.js","./request-d3e98716.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./promiseUtils-6684e352.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./symbolLayerUtils3D-1f8d4478.js"],import.meta.url);return r.size||Math.min(Jg.icon,(await s(r,Jg.icon))[0])||Jg.icon}case"text":return r.size||Jg.text;case"line":return r.size||Jg.line;case"object":{const{computeObjectLayerResourceSize:s}=await Ee(()=>import("./symbolLayerUtils-1bc2c213.js"),["./symbolLayerUtils-1bc2c213.js","./preload-helper-41c905a7.js","./request-d3e98716.js","./Error-653283ae.js","./string-cdf077e6.js","./typedArrayUtil-a8b5b3e9.js","./promiseUtils-6684e352.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cast-7928d7aa.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./aaBoundingBox-fc742a4e.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./symbolLayerUtils3D-1f8d4478.js"],import.meta.url);return Rwt(await s(r,i.scale/Jg.viewScaleSizeFactor),t)}case"path":return(r.width!=null?r.width:r.height)||i.scale/Jg.viewScaleSizeFactor;case"extrude":return r.size||i.scale/Jg.viewScaleSizeFactor;default:return 0}}function $wt(i,e){const t=i.field,n=i.axis,r=e.fields&&e.fields.filter(c=>c.name===t),s=r&&r.length===1?r[0].type:"double",a={updating:!1,initial:0,current:0},o=s5[i.valueUnit]??1;let l;return l=i.valueRepresentation==="area"?c=>(c*o/2)**2*Math.PI:i.valueRepresentation==="radius"||i.valueRepresentation==="distance"?c=>c*o/2:c=>c*o,{field:t,fieldType:s,getDefault:async(c,u)=>E8(l(await Iwt(u,c,n)),s),getValue:(c,u)=>(a.initial||(a.initial=u.pixelSizeAt(u.center)),a.current=a.initial*c,E8(a.current,s)),initValue:c=>{a.initial=c??a.current,a.current=0},isUpdatingInteractively:!1,displayUnit:jwt(i.valueUnit),axis:i.axis}}function E8(i,e){switch(e){case"small-integer":case"integer":case"long":return Math.round(i);case"double":case"single":return i;default:return 0}}function Lwt(i){switch(i.type){case"class-breaks":case"simple":case"unique-value":case"dot-density":case"dictionary":case"pie-chart":return!0;default:return!1}}async function yb(i,e){const t=await P$(i,{useSourceLayer:!0,ignoreGraphicSymbol:!0,webStyleCache:e}),n=ixe(i.symbol,t);T(n)&&(i.symbol=t)}function Dwt(i){if(i==="mesh"||i==="multipatch")throw new Error("Mesh and Multipatch not supported");return i}async function kwt(i,e,t,n){await A8(i,e,n);const r=i.on("create",async s=>{if(s.state==="cancel")return A8(i,e,n);if(s.state==="complete"){const a=s.graphic;a.sourceLayer||(a.sourceLayer=e.layer),a.attributes||(a.attributes={...e.template.prototype.attributes}),await yb(a,n),t(a)}});return{remove:()=>{r.remove(),i.cancel()}}}async function A8(i,e,t){const n=e.layer,r={...e.template.prototype.attributes};await Fwt(i,n,r,t);const s={graphicProperties:{attributes:r,sourceLayer:n},hasZ:n.capabilities.data.supportsZ};return i.layer.elevationInfo=n.elevationInfo,i.create(Dwt(n.geometryType),s)}async function Fwt(i,e,t,n){const r=new ao({sourceLayer:e,attributes:t}),{rotation:s,size:a}=$D(r);let o=await P$(r,{useSourceLayer:!0,webStyleCache:n}),l=!1;for(const c of[a,s])B(c)||t[c.field]==null&&(t[c.field]=await c.getDefault(o,i.view),l=!0);switch(l&&(o=await P$(r,{useSourceLayer:!0,webStyleCache:n})),o==null?void 0:o.type){case"simple-fill":case"polygon-3d":i.polygonSymbol=o;break;case"simple-line":case"line-3d":i.polylineSymbol=o;break;case"simple-marker":case"picture-marker":case"point-3d":case"cim":i.pointSymbol=o}mge(i.tooltipOptions,a,s)}function mge(i,e,t){T(e)||T(t)?i.visualVariables={size:T(e)?{unit:e.displayUnit,axis:e.axis,valueType:e.fieldType}:null,rotation:T(t)?{valueType:t.fieldType,rotationType:t.rotationType??"geographic"}:null}:i.visualVariables=null}function FH(i,e){return i&&i.find(t=>t.layer===e)}async function Nwt(i,e,t,n){if(i.length===0)return[];const{updatable:r,graphicsByLayer:s}=await t.async(async()=>{const{results:a}=await e2(tge(e,t),n),o=new Map,l=({layer:u})=>{const d=o.get(u);if(!d){const h=new Array;return o.set(u,h),h}return d};nge(a).forEach(({graphic:u})=>l(u).push(u));const c=i.filter(({supports:u,layer:d})=>u.includes("update")&&o.has(d));return c.length!==0&&t.stopPropagation(),{updatable:c,graphicsByLayer:o}});return e2(Ra(r.map(async({layer:a})=>{const{objectIdField:o}=a,l="displayField"in a?a.displayField:null,c=[o];a.fieldsIndex.has(l)&&c.push(l);const u=s.get(a);if(u.some(d=>c.some(h=>!(h in d.attributes)))){const d=a.createQuery();return d.outFields=c,d.returnGeometry=!1,d.objectIds=u.map(h=>h.getObjectId()),a.queryFeatures(d,{signal:n}).then(({features:h})=>h)}return u})),n)}async function Vwt(i,e,t,n){if(i.length===0)return[];let r=null;const s=await t.async(async()=>{const{results:a}=await e2(e.hitTest(t),n);if(a.length===0)return[];const o=new Set;r=nge(a),r.forEach(({graphic:c})=>c&&o.add(c.layer));const l=i.items.filter(({layer:c,supports:u})=>u.includes("update")&&o.has(c));return l.length>0&&t.stopPropagation(),l});return e2(Ra(s.map(({layer:a})=>{const{objectIdField:o}=a,l="displayField"in a?a.displayField:null,c=[o];a.fieldsIndex.has(l)&&c.push(l);const u=a.createQuery();u.outFields=c,u.returnGeometry=!1;const d="renderer"in a?pge({renderer:a.renderer,event:t}):0;return u.geometry=fge(t.mapPoint,d,e),u.outSpatialReference=e.spatialReference,a.queryFeatures(u,{signal:n}).then(({features:h})=>(r.forEach(({graphic:p})=>{p.layer===a&&(h.find(m=>m.attributes[o]===p.attributes[a.objectIdField])||h.push(p))}),h))})),n)}async function Bwt(i,e,t,n){switch(e.type){case"3d":return Nwt(i,e,t,n);case"2d":return Vwt(i,e,t,n)}}async function zwt(i,e,t){const n=i.layer,r=n.createQuery();return r.objectIds=[i.getAttribute(n.objectIdField)],r.outFields=["*"],r.outSpatialReference=e.spatialReference,r.returnM=n.capabilities.data.supportsM,r.returnZ=n.capabilities.data.supportsZ,(await n.queryFeatures(r,{signal:t})).features[0]}async function FA(i,e,t,n,r){let s=!1;const{rotation:a,size:o}=n;[a,o].forEach(async c=>{if(B(c))return;const u=e.attributes[c.field];if(T(u))c.initValue(u);else{const d=await c.getDefault(e.symbol,i.view);c.initValue(d),e.setAttribute(c.field,d),s=!0}}),s&&await yb(e,r);const l={multipleSelectionEnabled:!1};return t.geometryType==="point"&&(l.enableRotation=T(a),l.enableScaling=T(o)),mge(i.tooltipOptions,o,a),i.layer.elevationInfo=t.elevationInfo,i.update(e,l)}function Uwt(i){return!T(i)||i.type!=="rotate-start"&&i.type!=="rotate"&&i.type!=="rotate-stop"?null:i}function Hwt(i){return!T(i)||i.type!=="scale-start"&&i.type!=="scale"&&i.type!=="scale-stop"?null:i}async function NH(i,e,t,n,r){var c;if(!T(e.geometry)||((c=e.geometry)==null?void 0:c.type)!=="point")return;const s=n.rotation,a=Uwt(t.toolEventInfo);if(T(s)&&T(a))if(a.type==="rotate-stop")s.isUpdatingInteractively=!1,s.initValue();else{s.isUpdatingInteractively=!0;const{field:u,getValue:d}=s;e.attributes[u]=d(a.angle,i)}const o=n.size,l=Hwt(t.toolEventInfo);if(T(o)&&T(l))if(l.type==="scale-stop")o.isUpdatingInteractively=!1,o.initValue();else{o.isUpdatingInteractively=!0;const{field:u,getValue:d}=o;e.attributes[u]=d(l.xScale,i)}await yb(e,r)}async function Gwt(i,e,t,n,r,s){const a=i.clone();await yb(a,s),n.map.add(t.layer),t.layer.add(a);const o=i.sourceLayer,l=n.whenLayerView(o),c=()=>{const w=i.layer,C=i.attributes[w.objectIdField];return l.then(S=>S.setVisibility(C,!1),()=>{}),{remove(){l.then(S=>S.setVisibility(C,!0),()=>{})}}};let u=null,d=null;if(n.type==="3d"){const w=new K_({graphic:a});u=JE([n.trackGraphicState(w),ue(()=>w.displaying,C=>{d=C?c():Gr(d)},At)])}else d=c();await FA(t,a,o,e,s);let h=null;l.then(w=>h=w,()=>{});const p=e.size,m=e.rotation,g=ue(()=>i.attributes,async w=>{let C=!1;for(const S in w){const E=w[S];E!==a.attributes[S]&&(a.setAttribute(S,E),T(p)&&!p.isUpdatingInteractively&&p.field===S&&p.initValue(E),T(m)&&!m.isUpdatingInteractively&&m.field===S&&m.initValue(E),(B(h)||h.requiredFields.includes(S))&&(C=!0))}C&&await yb(a,s)}),_=t.on("update",async w=>{const C=w.graphics[0];if(w.state==="complete")return FA(t,C,o,e,s);await NH(n,C,w,e,s),r(C.clone(),w)}),b=t.on(["undo","redo"],async w=>{r(w.graphics[0].clone(),w)}),x=()=>{};return{interactive:{remove(){b.remove(),_.remove(),t.cancel(),g&&g.remove(),this.remove=x}},visual:{remove(){Gr(d),n.whenLayerView(o).then(w=>$u(()=>!w.updating)).then(()=>{Gr(u),t.layer.remove(a),this.remove=x})}}}}const Jg={icon:Gp(24),text:Gp(12),line:Gp(1),viewScaleSizeFactor:100};function VH(i,e,t){let n=!1;return i.filter(r=>!!n||(n=r===e,n)).map(r=>t[r]())}function Wwt(i){if(i.length!==1)return null;const e=i[0];if("items"in e){const t=e;return t.items.length===1?t.items[0]:null}return e}function gge(i,e){if(i.viewModel.refreshCreationTemplates(),e[0].id==="awaiting-feature-creation-info"){const t=Wwt(i.viewModel.featureTemplatesViewModel.items);T(t)&&(i.creationInfo={layer:t.layer,template:t.template},e.shift())}return e}function jwt(i){switch(i){case"unknown":case"decimal-degrees":return null;default:return i}}const vge=i=>/-stop/.test(i)||/vertex-/.test(i);var M8;const nN=Symbol();let P8=M8=class extends kH{constructor(i){super(i),this.type="create-features",this.createFeatureState="create-new",this._featureFormHandle=null,this._visualVariableAttributes={rotation:null,size:null},this._attachmentFileInfos=new Map,this._highlightHandles=new Map,this._preventDefaultActionOnCancel=!1}get numPendingFeatures(){return this.data.viewModel.sketchViewModel.layer.graphics.length}get pendingFeatures(){return this.data.viewModel.sketchViewModel.layer.graphics}async updatePendingFeature(i,e){return this._preventDefaultActionOnCancel=!0,this.data.viewModel.sketchViewModel.cancel(),BI(this._lastActiveGraphics,i),this._startUpdating(i,e)}static create(i,e,t,n,r){const s=new M8({data:new qS({creationInfo:kt(e),viewModel:i}),onCommit:async a=>{const o=a.viewModel.sketchViewModel.layer.graphics.toArray(),l=a.creationInfo.layer,c=l.capabilities.editing.supportsGlobalId&&"globalIdField"in l,u=s._attachmentFileInfos;if(u.size===0)return void await n(l,{addFeatures:o});if(c){const p=s._getAttachmentEditsWithGlobalIds(o,l,u),m="addAttachments"in p?{globalIdUsed:!0}:void 0;return void await n(l,p,m)}const{addFeatureResults:d}=await n(l,{addFeatures:o}),h=s._getAddAttachmentsData(o,d,l,u);await r(l,h)}});return s._set("steps",this._createWorkflowSteps(s,t)),s}_fadeExistingFeatures(i){if("effect"in i){const t=i.effect;return i.effect="saturate(0.6) opacity(0.8)",bh(()=>i.effect=t)}const e=i.opacity;return i.opacity=.7,bh(()=>i.opacity=e)}_highlight(i){const e=this.data.viewModel.view;e.type==="3d"&&this._highlightHandles.set(i,e.highlight(i))}_removeHighlight(i){Gr(this._highlightHandles.get(i)),this._highlightHandles.delete(i)}async _startCreating(i){return this.createFeatureState="create-new",A8(this.data.viewModel.sketchViewModel,this.data.creationInfo,i)}async _startUpdating(i,e){var c;const{featureFormViewModel:t,layerInfos:n,sketchViewModel:r,view:s}=this.data.viewModel,a=this.data.creationInfo.layer,o=(c=FH(n,a))==null?void 0:c.formTemplate,l=s.spatialReference;return t.set({arcadeEditType:"INSERT",feature:i,formTemplate:o,spatialReference:l,view:s}),Gr(this._featureFormHandle),this._featureFormHandle=JE([t.on("value-change",async()=>{i.attributes=t.getValues(),await yb(i,e)}),r.on(["update","undo","redo"],u=>{(u.type==="undo"||u.type==="redo"||u.type==="update"&&T(u.toolEventInfo)&&vge(u.toolEventInfo.type))&&t.notifyFeatureGeometryChanged()})]),this._removeHighlight(i),this.createFeatureState="update-pending",this._visualVariableAttributes=$D(i),FA(r,i,a,this._visualVariableAttributes,e)}static _createWorkflowSteps(i,e="awaiting-feature-creation-info"){const{data:t,handles:n}=i;let r=null,s=!0;const a=new Map,o=VH(["awaiting-feature-creation-info","creating-features","adding-attachment","editing-attachment"],e,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){t.creationInfo=null,n.add(t.viewModel.featureTemplatesViewModel.on("select",({item:l})=>{t.creationInfo={layer:l.layer,template:l.template},t.viewModel.activeWorkflow.next()}),this.id)},async tearDown(){n.remove(this.id)}}),"creating-features":()=>({id:"creating-features",async setUp(){if(n.has(this.id))return;const l=t.viewModel.view,c=t.viewModel.sketchViewModel;s=c.updateOnGraphicClick,c.updateOnGraphicClick=!1,i._lastActiveGraphics=[],i._featureFormHandle=Gr(i._featureFormHandle),i._visualVariableAttributes={rotation:null,size:null};const u=l.type==="2d"?i._fadeExistingFeatures(t.creationInfo.layer):null,d=c.on("create",async w=>{if(w.state==="cancel"){if(i._preventDefaultActionOnCancel)return void(i._preventDefaultActionOnCancel=!1);if(i._lastActiveGraphics.length<1)return i._startCreating(a);const C=i._lastActiveGraphics.pop();return i._startUpdating(C,a)}if(w.state==="complete")return i._startUpdating(w.graphic,a)}),h=c.on("update",async w=>{const C=w.graphics[0];if(w.state==="complete"){if(C!==r&&(i._lastActiveGraphics.push(C),i._highlight(C)),r=null,t.viewModel.attachmentsViewModel.mode!=="add"&&t.viewModel.attachmentsViewModel.mode!=="edit"||t.viewModel.activeWorkflow.previous(),w.aborted&&i._preventDefaultActionOnCancel)return void(i._preventDefaultActionOnCancel=!1);const E=l.cursor;return l.cursor="progress",n.add([bh(()=>l.cursor=E),l.on("click",A=>A.preventDefault())],nN),$u(()=>!t.viewModel.featureFormViewModel.updating).then(()=>{n.remove(nN),i._startCreating(a)})}if(w.state==="start"){i._removeHighlight(C);const E=t.viewModel.attachmentsViewModel;E.mode!=="add"&&E.mode!=="edit"||t.viewModel.activeWorkflow.previous(),E.fileInfos.removeAll(),E.graphic=C,E.mode="view",(i._attachmentFileInfos.get(C)||[]).forEach(({file:A,form:P})=>E.addFile(A,P))}await NH(l,C,w,i._visualVariableAttributes,a);const S=C.attributes;if(T(i._visualVariableAttributes.rotation)){const{field:E}=i._visualVariableAttributes.rotation;t.viewModel.featureFormViewModel.setValue(E,S[E])}if(T(i._visualVariableAttributes.size)){const{field:E}=i._visualVariableAttributes.size;t.viewModel.featureFormViewModel.setValue(E,S[E])}}),p=c.on("delete",async w=>{const C=w.graphics[0];BI(i._lastActiveGraphics,C),r=C});let m=null;const g=ue(()=>{const w=c.snappingOptions.featureSources.find(C=>C.layer===t.creationInfo.layer);return{hasFeatureLayerSource:!!w,enabled:(w==null?void 0:w.enabled)??!1}},({hasFeatureLayerSource:w,enabled:C})=>{const S=c.snappingOptions.featureSources;w?(B(m)&&(m=new DH({layer:c.layer,enabled:C}),S.add(m)),m.enabled=C):(T(m)&&S.remove(m),m=_t(m))},hn),_=l.on("immediate-click",async w=>{const{results:C}=await l.hitTest(w,{include:c.layer}),S=C.find(E=>E.type==="graphic");if(S){const E=S.graphic;if(c.activeTool==="transform"||c.activeTool==="reshape"){if(c.updateGraphics.getItemAt(0)===E)return;await i.updatePendingFeature(E,a)}}}),b=ue(()=>t.viewModel.attachmentsViewModel.mode,w=>{w==="add"&&t.viewModel.activeWorkflow.go("adding-attachment"),w==="edit"&&t.viewModel.activeWorkflow.go("editing-attachment")});await i._startCreating(a);const x={remove:()=>{Gr(i._featureFormHandle),d.remove(),h.remove(),p.remove(),g.remove(),T(m)&&c.snappingOptions.featureSources.remove(m),m=_t(m),c.cancel(),_.remove(),b.remove(),Gr(u)}};n.add(x,this.id)},async tearDown(l){l.cancelled&&(t.viewModel.sketchViewModel.layer.removeAll(),n.remove([this.id,nN]),t.viewModel.attachmentsViewModel.fileInfos.removeAll(),i._attachmentFileInfos.clear(),t.viewModel.sketchViewModel.updateOnGraphicClick=s)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{graphic:l,fileInfos:c}=t.viewModel.attachmentsViewModel;i._attachmentFileInfos.set(l,c.toArray()),t.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"creating-features",async setUp(){},async tearDown(){const{graphic:l,fileInfos:c}=t.viewModel.attachmentsViewModel;i._attachmentFileInfos.set(l,c.toArray()),t.viewModel.attachmentsViewModel.mode="view"}})});return gge(t,o)}_getAddAttachmentsData(i,e,t,n){const r=[];return e.forEach((s,a)=>{if(!s.error){const o=i[a],l=n.get(o)||[];o.attributes[t.objectIdField]=s.objectId,l.forEach(({form:c})=>r.push({feature:o,attachment:c}))}}),r}_getAttachmentEditsWithGlobalIds(i,e,t){const n=[];return i.forEach((r,s)=>{const a=t.get(r)||[];let o=r.attributes[e.globalIdField];B(o)&&(o=xW(),i[s].attributes[e.globalIdField]=o),a.forEach(({file:l})=>n.push({feature:r,attachment:{globalId:xW(),data:l}}))}),n.length?{addFeatures:i,addAttachments:n}:{addFeatures:i}}};P8=M8=f([ge("esri.widgets.Editor.CreateFeaturesWorkflow")],P8);const qwt=P8;let bw=class extends et{constructor(e){super(e),this.creationInfo=null,this.edits=null,this.viewModel=null}};f([y()],bw.prototype,"creationInfo",void 0),f([y()],bw.prototype,"edits",void 0),f([y()],bw.prototype,"viewModel",void 0),bw=f([ge("esri.widgets.Editor.CreateWorkflowData")],bw);const Kwt=bw;function $O(i){return B(i)?null:JSON.stringify(i)}let Vv=class extends Ba(et){constructor(e){super(e),this._baselineAttributesJSON=null,this._baselineGeometryJSON=null,this.feature=null}get attributesModified(){const{_baselineAttributesJSON:e,feature:t}=this;return!(!t||e===$O(t.attributes))}get geometryModified(){const{_baselineGeometryJSON:e,feature:t}=this;return!(!t||e===$O(t.geometry))}get modified(){return this.attributesModified||this.geometryModified}trackChanges(){this.feature&&(this._baselineAttributesJSON=$O(this.feature.attributes),this._baselineGeometryJSON=$O(this.feature.geometry),this.notifyChange("attributesModified"),this.notifyChange("geometryModified"))}updateAttributes(e){this.feature.attributes=e,this.notifyChange("attributesModified")}updateGeometry(e){this.feature.geometry=e,this.notifyChange("geometryModified")}};f([y()],Vv.prototype,"attributesModified",null),f([y()],Vv.prototype,"feature",void 0),f([y()],Vv.prototype,"geometryModified",null),f([y()],Vv.prototype,"modified",null),Vv=f([ge("esri.widgets.Editor.Edits")],Vv);var O8;let R8=O8=class extends kH{constructor(i){super(i),this.type="create"}static create(i,e,t){const n=new O8({data:new Kwt({edits:new Vv,viewModel:i}),onCommit:async r=>{await t(r.creationInfo.layer,{addFeatures:[r.edits.feature]})}});return n._set("steps",this._createWorkflowSteps(n,e)),n}static _createWorkflowSteps(i,e="awaiting-feature-creation-info"){const{data:t,handles:n}=i,r=new Map,s=VH(["awaiting-feature-creation-info","awaiting-feature-to-create","editing-new-feature","adding-attachment","editing-attachment"],e,{"awaiting-feature-creation-info":()=>({id:"awaiting-feature-creation-info",async setUp(){t.creationInfo=null,t.edits.feature=null,t.viewModel.featureTemplatesViewModel.select(null),n.add(t.viewModel.featureTemplatesViewModel.on("select",({item:a})=>{t.creationInfo={layer:a.layer,template:a.template},t.viewModel.activeWorkflow.next()}),this.id)},async tearDown(){n.remove(this.id)}}),"awaiting-feature-to-create":()=>({id:"awaiting-feature-to-create",async setUp(){n.add(await kwt(t.viewModel.sketchViewModel,t.creationInfo,a=>{t.edits.feature=a,t.viewModel.activeWorkflow.next()},r),this.id)},async tearDown(){n.remove(this.id)}}),"editing-new-feature":()=>({id:"editing-new-feature",async setUp(){var m;const a=t.edits.feature,o=a.sourceLayer,l=t.viewModel,c=l.sketchViewModel,u=(m=FH(l.layerInfos,o))==null?void 0:m.formTemplate,{spatialReference:d}=l.view;l.featureFormViewModel.set({arcadeEditType:"INSERT",feature:a,formTemplate:u,spatialReference:d}),c.allowDeleteKey=!1;const h=$D(a);await FA(c,a,o,h,r);const p=c.on("update",async g=>{const _=g.graphics[0];if(g.state==="complete")return FA(c,_,o,h,r);await NH(c.view,_,g,h,r);const b=_.attributes;if(T(h.rotation)){const{field:x}=h.rotation;l.featureFormViewModel.setValue(x,b[x])}if(T(h.size)){const{field:x}=h.size;l.featureFormViewModel.setValue(x,b[x])}});n.add([t.viewModel.featureFormViewModel.on("value-change",async()=>{t.edits.updateAttributes(t.viewModel.featureFormViewModel.getValues()),a.attributes=t.edits.feature.attributes,c.view.type==="3d"&&await yb(a,r)}),p,ue(()=>t.viewModel.attachmentsViewModel.mode,g=>{g==="add"&&t.viewModel.activeWorkflow.go("adding-attachment"),g==="edit"&&t.viewModel.activeWorkflow.go("editing-attachment")})],this.id)},async tearDown(a){a.cancelled&&t.viewModel.sketchViewModel.layer.removeAll(),n.remove(this.id)}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){t.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-new-feature",async setUp(){},async tearDown(){t.viewModel.attachmentsViewModel.mode="view"}})});return gge(t,s)}};R8=O8=f([ge("esri.widgets.Editor.CreateWorkflow")],R8);const Ywt=R8;let Y_=class extends et{constructor(e){super(e),this.candidates=null,this.editableItem=null,this.edits=null,this.viewModel=null}};f([y()],Y_.prototype,"candidates",void 0),f([y()],Y_.prototype,"editableItem",void 0),f([y()],Y_.prototype,"edits",void 0),f([y()],Y_.prototype,"viewModel",void 0),Y_=f([ge("esri.widgets.Editor.UpdateWorkflowData")],Y_);const Xwt=Y_;var I8;const fte="candidate-highlight";let $8=I8=class extends kH{constructor(i){super(i),this.type="update"}static create(i,e,t){const n=new I8({data:new Xwt({edits:new Vv,viewModel:i}),onCommit:async r=>{const s=r.edits.feature,a=s.sourceLayer,o=s.clone();if(!r.edits.attributesModified){const{objectIdField:l}=a;o.attributes={[l]:s.getAttribute(l)}}r.edits.geometryModified||(o.geometry=null),await t(a,{updateFeatures:[o]})}});return n._set("steps",this._createWorkflowSteps(n,e)),n}highlight(i){const{data:{viewModel:{view:e}}}=this,t=i&&e.allLayerViews.items.find(({layer:n})=>n===i.layer);qV(t)&&this.handles.add(t.highlight(i),fte)}unhighlight(){this.handles.remove(fte)}static _createWorkflowSteps(i,e="awaiting-feature-to-update"){const{data:t,handles:n}=i,r=new Map;return VH(["awaiting-feature-to-update","awaiting-update-feature-candidate","editing-existing-feature","adding-attachment","editing-attachment"],e,{"awaiting-feature-to-update":()=>({id:"awaiting-feature-to-update",async setUp(){const{spinnerViewModel:s,view:a}=t.viewModel;let o=null;n.add({remove(){o&&(o.abort(),o=null)}},this.id),t.edits.feature=null;const l=a.on("immediate-click",c=>{s.location=c.mapPoint,s.visible=!0,o&&o.abort();const{editableItems:u}=t.viewModel;o=new AbortController,new Promise((d,h)=>{Bm(o.signal,()=>h(js())),d(Bwt(u,a,c,o.signal))}).then(d=>{if(Cn(o),t.candidates=d.reduce((h,p)=>p.error?h:[...h,...p.value],[]),t.viewModel.spinnerViewModel.visible=t.candidates.length===1,t.candidates.length!==0)if(t.candidates.length===1){const h=t.candidates[0];t.edits.feature=h,t.viewModel.activeWorkflow.go("editing-existing-feature").catch(()=>{}).then(()=>t.viewModel.spinnerViewModel.visible=!1)}else t.viewModel.activeWorkflow.next()})});a.focus(),n.add(l,this.id)},async tearDown(){n.remove(this.id)}}),"awaiting-update-feature-candidate":()=>({id:"awaiting-update-feature-candidate",async setUp(){const{edits:s}=t;s.feature=null,n.add(ue(()=>s.feature,a=>{i.unhighlight(),i.highlight(a)}),this.id)},async tearDown(){i.unhighlight(),n.remove(this.id)}}),"editing-existing-feature":()=>({id:"editing-existing-feature",async setUp(){var E;if(n.has("editing-existing-feature"))return;const s=t.edits.feature,{attachmentsViewModel:a,editableItems:o,featureFormViewModel:l,layerInfos:c,sketchViewModel:u,view:d}=t.viewModel;t.editableItem=o.find(A=>A.layer===s.layer);const h=new AbortController;n.add({remove:()=>h.abort()},this.id);const p=d.whenLayerView(s.layer),m=zwt(s,d,h.signal),g=await p,_=await m;if(bu(h))return;t.edits.updateGeometry(_.geometry),t.edits.updateAttributes(_.attributes),t.edits.trackChanges(),a.set({graphic:_,mode:"view"});const b=_.sourceLayer,x=(E=FH(c,b))==null?void 0:E.formTemplate,w=d.spatialReference;l.set({arcadeEditType:"UPDATE",feature:_,formTemplate:x,spatialReference:w,view:d});const C="createInteractiveEditSession"in g?g.createInteractiveEditSession(s):null,S=[l.on("value-change",A=>{t.edits.updateAttributes(l.getValues()),_.attributes=t.edits.feature.attributes,C&&C.setAttribute(A.fieldName,A.value)}),ue(()=>a.mode,A=>{A==="add"&&t.viewModel.activeWorkflow.go("adding-attachment"),A==="edit"&&t.viewModel.activeWorkflow.go("editing-attachment")})];if(C&&(S.push(bh(()=>C.rollback())),n.add(bh(()=>C.commit()),i._handleKeys.afterCommit)),t.editableItem.geometryUpdatesEnabled){u.allowDeleteKey=!1;const A=$D(_),{interactive:P,visual:O}=await Gwt(_,A,u,d,({geometry:M,attributes:V},L)=>{if(T(A.rotation)){const{field:U}=A.rotation;l.setValue(U,V[U])}if(T(A.size)){const{field:U}=A.size;l.setValue(U,V[U])}t.edits.updateAttributes(V),t.edits.updateGeometry(M),l.feature.geometry=M,(L.type==="undo"||L.type==="redo"||L.type==="update"&&T(L.toolEventInfo)&&vge(L.toolEventInfo.type))&&l.notifyFeatureGeometryChanged()},r);S.push(P,O),n.add(P,i._handleKeys.beforeCommit),n.add(O,i._handleKeys.afterCommit)}else i.highlight(_);n.add(S,this.id)},async tearDown({cancelled:s}){s&&(i.unhighlight(),n.remove(this.id))}}),"adding-attachment":()=>({id:"adding-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){t.viewModel.attachmentsViewModel.mode="view"}}),"editing-attachment":()=>({id:"editing-attachment",parent:"editing-existing-feature",async setUp(){},async tearDown(){t.viewModel.attachmentsViewModel.mode="view"}})})}};$8=I8=f([ge("esri.widgets.Editor.UpdateWorkflow")],$8);const Zwt=$8;function rN(i){switch(i){case Kn.SUPPORTED:break;case Kn.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case Kn.GEOMETRY_MISSING:return"no geometry";case Kn.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case Kn.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case Kn.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var Kn;(function(i){i[i.SUPPORTED=0]="SUPPORTED",i[i.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",i[i.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",i[i.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",i[i.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",i[i.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(Kn||(Kn={}));function Qwt(i){var e;if(((e=i.layer)==null?void 0:e.type)!=="graphics")return Kn.GRAPHICS_LAYER_MISSING;if(B(i.geometry))return Kn.GEOMETRY_MISSING;switch(i.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return Kn.GEOMETRY_TYPE_UNSUPPORTED}return pz(i)!=="on-the-ground"&&fz(i)?Kn.ELEVATION_MODE_UNSUPPORTED:Kn.SUPPORTED}function yge(i){if(!i)return null;if(bye(i)&&i.wkid){const e=jye[i.wkid];if(e)return e}if(i.wkt){const e=Jwt(i.wkt);if(e)return e}return null}function Jwt(i){const e=qye.exec(i);if(!e||e.length!==2)return null;const t=e[1].split(",");if(!t||t.length<3)return null;const n=parseFloat(t[1]),r=parseFloat(t[2]);return isNaN(n)||isNaN(r)?null:{a:n,f:r===0?0:1/r}}function LD(i){const e=yge(i??$n.WGS84);if(ext(e))return e;const t=e.a*(1-e.f);return Object.assign(e,{b:t,eSq:1-(t/e.a)**2,radius:(2*e.a+t)/3,densificationRatio:1e4/((2*e.a+t)/3)})}function ext(i){return i!=null&&"b"in i&&"eSq"in i&&"radius"in i}function LO(i,e,t){const{a:n,eSq:r}=LD(t),s=Math.sqrt(r),a=Math.sin(e[1]*Ac),o=n*e[0]*Ac;let l;return r>0?l=n*((1-r)*(a/(1-r*(a*a))-1/(2*s)*Math.log((1-s*a)/(1+s*a))))*.5:l=n*a,i[0]=o,i[1]=l,i}function DD(i){return yge(i)!==null}function N6t(i,e="square-meters"){if(i.some(a=>!DD(a.spatialReference)))throw new Ze("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const t=[];for(let a=0;a<i.length;a++){const o=i[a],l=o.spatialReference,{radius:c,densificationRatio:u}=LD(l),d=c*u;t.push(ixt(o,d))}const n=[],r=[0,0],s=[0,0];for(let a=0;a<t.length;a++){const{rings:o,spatialReference:l}=t[a];let c=0;for(let u=0;u<o.length;u++){const d=o[u];LO(r,d[0],l),LO(s,d[d.length-1],l);let h=s[0]*r[1]-r[0]*s[1];for(let p=0;p<d.length-1;p++)LO(r,d[p+1],l),LO(s,d[p],l),h+=s[0]*r[1]-r[0]*s[1];c+=h}c=ec(c,"square-meters",e),n.push(c/-2)}return n}function txt(i,e="meters"){if(!i)throw new Ze("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(i.some(n=>!DD(n.spatialReference)))throw new Ze("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const t=[];for(let n=0;n<i.length;n++){const r=i[n],{spatialReference:s}=r,a=r.type==="polyline"?r.paths:r.rings;let o=0;for(let l=0;l<a.length;l++){const c=a[l];let u=0;for(let d=1;d<c.length;d++){const h=c[d-1][0],p=c[d][0],m=c[d-1][1],g=c[d][1];if(m!==g||h!==p){const _=new _ge;bge(_,[h,m],[p,g],s),u+=_.distance}}o+=u}o=ec(o,"meters",e),t.push(o)}return t}function ixt(i,e){if(i.type!=="polyline"&&i.type!=="polygon")throw new Ze("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:t}=i;if(!DD(t))throw new Ze("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const n=i.type==="polyline"?i.paths:i.rings,r=[],s=[0,0],a=new _ge;for(const o of n){const l=[];r.push(l),l.push([o[0][0],o[0][1]]);let c,u,d=o[0][0],h=o[0][1];for(let p=0;p<o.length-1;p++){if(c=o[p+1][0],u=o[p+1][1],d===c&&h===u)continue;const m=[d,h];bge(a,[d,h],[c,u],t);const{azimuth:g,distance:_}=a,b=_/e;if(b>1){for(let x=1;x<=b-1;x++)SI(s,m,g,x*e,t),l.push(s.slice(0));SI(s,m,g,(_+Math.floor(b-1)*e)/2,t),l.push(s.slice(0))}SI(s,m,g,_,t),l.push(s.slice(0)),d=s[0],h=s[1]}}return i.type==="polyline"?new sx({paths:r,spatialReference:t}):new Om({rings:r,spatialReference:t})}let _ge=class{constructor(e=0,t,n){this.distance=e,this.azimuth=t,this.reverseAzimuth=n}};function SI(i,e,t,n,r){const s=e[0],a=e[1],o=s*Ac,l=a*Ac,c=(t??0)*Ac,{a:u,b:d,f:h}=LD(r),p=Math.sin(c),m=Math.cos(c),g=(1-h)*Math.tan(l),_=1/Math.sqrt(1+g*g),b=g*_,x=Math.atan2(g,m),w=_*p,C=w*w,S=1-C,E=S*(u*u-d*d)/(d*d),A=1+E/16384*(4096+E*(E*(320-175*E)-768)),P=E/1024*(256+E*(E*(74-47*E)-128));let O,M,V,L,U=n/(d*A),G=2*Math.PI;for(;Math.abs(U-G)>1e-12;)V=Math.cos(2*x+U),O=Math.sin(U),M=Math.cos(U),L=P*O*(V+P/4*(M*(2*V*V-1)-P/6*V*(4*O*O-3)*(4*V*V-3))),G=U,U=n/(d*A)+L;const H=b*O-_*M*m,k=Math.atan2(b*M+_*O*m,(1-h)*Math.sqrt(C+H*H)),D=Math.atan2(O*p,_*M-b*O*m),$=h/16*S*(4+h*(4-3*S)),F=k/Ac,Y=(o+(D-(1-$)*h*w*(U+$*O*(V+$*M*(2*V*V-1)))))/Ac;return i[0]=Y,i[1]=F,i}function bge(i,e,t,n){const r=e[0]*Ac,s=e[1]*Ac,a=t[0]*Ac,o=t[1]*Ac,{a:l,b:c,f:u,radius:d}=LD(n),h=a-r,p=Math.atan((1-u)*Math.tan(s)),m=Math.atan((1-u)*Math.tan(o)),g=Math.sin(p),_=Math.cos(p),b=Math.sin(m),x=Math.cos(m);let w,C,S,E,A,P,O,M,V,L,U=1e3,G=h;do{if(O=Math.sin(G),M=Math.cos(G),S=Math.sqrt(x*O*(x*O)+(_*b-g*x*M)*(_*b-g*x*M)),S===0)return i.distance=0,i.azimuth=void 0,i.reverseAzimuth=void 0,i;A=g*b+_*x*M,P=Math.atan2(S,A),V=_*x*O/S,C=1-V*V,E=A-2*g*b/C,isNaN(E)&&(E=0),L=u/16*C*(4+u*(4-3*C)),w=G,G=h+(1-L)*u*V*(P+L*S*(E+L*A*(2*E*E-1)))}while(Math.abs(G-w)>1e-12&&--U>0);if(U===0){const Y=d,ne=Math.acos(Math.sin(s)*Math.sin(o)+Math.cos(s)*Math.cos(o)*Math.cos(a-r))*Y,X=a-r,J=Math.sin(X)*Math.cos(o),he=Math.cos(s)*Math.sin(o)-Math.sin(s)*Math.cos(o)*Math.cos(X),ye=Math.atan2(J,he);return i.azimuth=ye/Ac,i.distance=ne,i.reverseAzimuth=void 0,i}const H=C*(l*l-c*c)/(c*c),k=H/1024*(256+H*(H*(74-47*H)-128)),D=c*(1+H/16384*(4096+H*(H*(320-175*H)-768)))*(P-k*S*(E+k/4*(A*(2*E*E-1)-k/6*E*(4*S*S-3)*(4*E*E-3)))),$=Math.atan2(x*Math.sin(G),_*b-g*x*Math.cos(G)),F=Math.atan2(_*Math.sin(G),_*b*Math.cos(G)-g*x);return i.azimuth=$/Ac,i.distance=D,i.reverseAzimuth=F/Ac,i}var L8;let Cv=L8=class extends Om{constructor(...i){super(...i),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(i,e){let t;if(i&&i.center)t=i;else{if(i&&i.rings)return super.normalizeCtorArgs(i,e);t={center:i}}return{...super.normalizeCtorArgs(),...t,...e}}initialize(){const i=this.center,e=this.numberOfPoints;if(this.hasZ=(i==null?void 0:i.hasZ)??!1,this.rings.length!==0||!i)return;const t=ec(this.radius,this.radiusUnit,"meters"),n=i.spatialReference;let r,s="geographic";if(n.isWebMercator?s="webMercator":((n.wkid&&Xv[n.wkid])!=null||n.wkt&&n.wkt.indexOf("PROJCS")===0)&&(s="projected"),this.geodesic){let a;switch(s){case"webMercator":a=fie(i);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":a=i}r=this._createGeodesicCircle(a,t,e),s==="webMercator"&&(r=FL(r))}else{let a;s==="webMercator"||s==="projected"?a=t/this._convert2Meters(1,i.spatialReference):s==="geographic"&&(a=i_e(t,"meters",rn(i.spatialReference).radius)),r=this._createPlanarCircle(i,a,e)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:i,numberOfPoints:e,radius:t,radiusUnit:n,geodesic:r}=this;return new L8({center:i==null?void 0:i.clone(),numberOfPoints:e,radius:t,radiusUnit:n,geodesic:r})}_createGeodesicCircle(i,e,t){let n=0;const r=[];for(;n<360;){const s=[0,0],a=[i.x,i.y];SI(s,a,n,e),this.hasZ&&s.push(i.z),r.push(s),n+=360/t}return r.push(r[0]),new Om(r)}_createPlanarCircle(i,e,t){const n=[],r=2*Math.PI/t;for(let s=0;s<t;++s){const a=r*s,o=[i.x+Math.cos(-a)*e,i.y+Math.sin(-a)*e];this.hasZ&&o.push(i.z),n.push(o)}return n.push(n[0]),new Om({spatialReference:i.spatialReference,rings:[n]})}_convert2Meters(i,e){let t;if(e.wkid&&Xv[e.wkid]!=null)t=Xv.values[Xv[e.wkid]];else{const n=e.wkt,r=n.lastIndexOf(",")+1,s=n.lastIndexOf("]]");t=parseFloat(n.substring(r,s))}return i*t}};f([y({type:Wt})],Cv.prototype,"center",void 0),f([y()],Cv.prototype,"geodesic",void 0),f([y()],Cv.prototype,"numberOfPoints",void 0),f([y()],Cv.prototype,"radius",void 0),f([y()],Cv.prototype,"radiusUnit",void 0),Cv=L8=f([ge("esri.geometry.Circle")],Cv);const nxt=Cv;function DO(i){return wge(i).result}function B6t(i){return wge(i).geometry}function wge(i){var e;return((e=i.layer)==null?void 0:e.type)!=="graphics"?{result:Kn.GRAPHICS_LAYER_MISSING,geometry:null}:B(i.geometry)?{result:Kn.GEOMETRY_MISSING,geometry:null}:pz(i)!=="on-the-ground"&&fz(i)?{result:Kn.ELEVATION_MODE_UNSUPPORTED,geometry:null}:i.geometry.type!=="point"&&i.geometry.type!=="polyline"&&(i.geometry.type!=="polygon"||i.geometry instanceof nxt)?{result:Kn.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:Kn.SUPPORTED,geometry:i.geometry}}function rxt(i){var t;if(((t=i.layer)==null?void 0:t.type)!=="graphics")return Kn.GRAPHICS_LAYER_MISSING;if(B(i.geometry))return Kn.GEOMETRY_MISSING;switch(i.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return Kn.SUPPORTED;default:return Kn.GEOMETRY_TYPE_UNSUPPORTED}const e=T(i.symbol)&&i.symbol.type==="point-3d"&&i.symbol.symbolLayers;return e&&e.length>0&&e.some(n=>n.type==="object")?pz(i)!=="on-the-ground"&&fz(i)?Kn.ELEVATION_MODE_UNSUPPORTED:Kn.SUPPORTED:Kn.SYMBOL_TYPE_UNSUPPORTED}function mte(i,e,t){if(!e||!i||!i.map)return;const{map:n}=i,r=n.layers.find(s=>s===e);r||n.add(e,t),t!=null&&n.layers.reorder(r,t)}function z6t(i,e){return i.allLayerViews.find(t=>{const n=t.layer;return n===e||"sublayers"in n&&T(n.sublayers)&&n.sublayers.includes(e)})}const fi={redo:"r",undo:"z",center:"Alt",constraint:"Shift",snappingToggle:"Control",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};let EI=class extends et{constructor(e){super(e),this.enabled=!1}};f([y({type:Boolean,nonNullable:!0})],EI.prototype,"enabled",void 0),EI=f([ge("esri.views.interactive.sketch.SketchLabelOptions")],EI);const kD=EI;let UE=class extends et{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};f([y({type:String,nonNullable:!0})],UE.prototype,"mode",void 0),UE=f([ge("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],UE);let du=class extends et{constructor(){super(...arguments),this.distance=!0,this.elevation=!0,this.size=!0,this.scale=!0,this.rotation=!0,this.orientation=!0,this.totalLength=!0,this.area=!0,this.radius=!0}toJSON(){return{distance:this.distance,size:this.size,scale:this.scale,rotation:this.rotation,orientation:this.orientation,totalLength:this.totalLength,area:this.area,radius:this.radius}}};f([y({type:Boolean,nonNullable:!0})],du.prototype,"distance",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"elevation",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"size",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"scale",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"rotation",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"orientation",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"totalLength",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"area",void 0),f([y({type:Boolean,nonNullable:!0})],du.prototype,"radius",void 0),du=f([ge("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],du);let X_=class extends et{constructor(e){super(e),this.enabled=!1,this.elevation=new UE,this.visibleElements=new du,this.visualVariables=null}toJSON(){return{enabled:this.enabled,elevation:this.elevation,visibleElements:this.visibleElements}}};f([y({type:Boolean,nonNullable:!0})],X_.prototype,"enabled",void 0),f([y({type:UE,nonNullable:!0})],X_.prototype,"elevation",void 0),f([y({type:du,nonNullable:!0})],X_.prototype,"visibleElements",void 0),f([y()],X_.prototype,"visualVariables",void 0),X_=f([ge("esri.widgets.Sketch.SketchTooltipOptions")],X_);const FD=X_;var io;(function(i){i[i.FEATURE=1]="FEATURE",i[i.SELF=2]="SELF",i[i.ALL=3]="ALL"})(io||(io={}));let _h=class extends Wo{constructor(){super(...arguments),this.enabled=!0}};f([y({type:Boolean})],_h.prototype,"enabled",void 0),_h=f([ge("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],_h);let _s=class extends Wo{constructor(e){super(e),this.lineSnapper=new _h,this.parallelLineSnapper=new _h,this.rightAngleSnapper=new _h,this.rightAngleTriangleSnapper=new _h,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new Xt([255,127,0]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5}};f([y({type:_h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_s.prototype,"lineSnapper",void 0),f([y({type:_h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_s.prototype,"parallelLineSnapper",void 0),f([y({type:_h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_s.prototype,"rightAngleSnapper",void 0),f([y({type:_h,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_s.prototype,"rightAngleTriangleSnapper",void 0),f([y({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],_s.prototype,"shortLineThreshold",void 0),f([y({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],_s.prototype,"distance",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_s.prototype,"pointThreshold",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_s.prototype,"intersectionParallelLineThreshold",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_s.prototype,"parallelLineThreshold",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_s.prototype,"touchSensitivityMultiplier",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_s.prototype,"pointOnLineThreshold",void 0),f([y({type:Xt,nonNullable:!0})],_s.prototype,"orange",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_s.prototype,"lineHintWidthReference",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_s.prototype,"lineHintWidthTarget",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],_s.prototype,"lineHintFadedExtensions",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_s.prototype,"parallelLineHintWidth",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],_s.prototype,"parallelLineHintLength",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],_s.prototype,"parallelLineHintOffset",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],_s.prototype,"rightAngleHintSize",void 0),f([y({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],_s.prototype,"rightAngleHintOutlineSize",void 0),_s=f([ge("esri.views.interactive.snapping.Settings.Defaults")],_s);const Fu=new _s;function ul(i,e){const t=i.length===e.length&&i[0]===e[0]&&i[1]===e[1];switch(i.length){case 2:return t;case 3:return t&&i[2]===e[2];case 4:return t&&i[2]===e[2]&&i[3]===e[3]}return!1}function Db(i,e){const t=i.x-e.x,n=i.y-e.y;return t*t+n*n}function sxt(i,e){return Math.sqrt(Db(i,e))}function BH(i,e,t){const n=t.toXYZ(i,axt);e.sort((r,s)=>{const a=t.toXYZ(r.targetPoint,gte),o=Fo(a,n),l=t.toXYZ(s.targetPoint,gte);return o-Fo(l,n)})}const axt=q(),gte=q();var $h;function K6t(i,e){return{point:i.coordinateHelper.vectorToPoint(i.point).toJSON(),distance:i.distance,types:i.types,query:T(e)?e.toJSON():{where:"1=1"}}}function ks(i,e,t,n){const{coordinateHelper:r,elevationInfo:s}=t;if(!r.hasZ()||B(e)||e.type!=="3d"||B(i)||axe(s,n))return i;const a=Xx(e,i,r.spatialReference,s,n),o=r.clone(i);return o[2]=a,o}function Sp(i,e,t,n=ns){return{left:ks(i.leftVertex.pos,e,t,n),right:ks(i.rightVertex.pos,e,t,n)}}function Y6t(i){return i.createQuery()}(function(i){i[i.TARGET=0]="TARGET",i[i.REFERENCE=1]="REFERENCE",i[i.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})($h||($h={}));function sN(i,e){return i[0]*e[1]-i[1]*e[0]}function oxt(i,e,t){const n=cr(t,e)/Hx(t);return Po(i,t,n)}function aN(i,e,t,n,r=t){return Yn(Px,n,t),Yn(D8,e,r),oxt(xL,D8,Px),sd(i,r,xL)}function lxt(i,e,t,n){Yn(Px,e,t);const r=n/GI(Px);return Wp(i,t,Px,r)}function cxt(i,e){const t=i.start,n=i.end,r=e.start,s=e.end,a=Yn(Px,n,t),o=Yn(dxt,s,r),l=sN(a,o);if(Math.abs(l)<=uxt)return[];const c=Yn(D8,t,r),u=sN(o,c)/l,d=sN(a,c)/l;if(u>=0){if(d>=0||e.type===gs.LINE)return[Wp(xL,t,a,u)]}else if(i.type===gs.LINE&&(d>=0||e.type===gs.LINE))return[Wp(xL,t,a,u)];return[]}var gs;(function(i){i[i.RAY=0]="RAY",i[i.LINE=1]="LINE"})(gs||(gs={}));const uxt=1e-6,Px=xt(),dxt=xt(),D8=xt(),xL=xt();function k8({start:i,end:e,type:t},n,r){const s=[],a=n,o=Yn(ig,e,i),l=Yn(ng,i,a),c=Hx(o),u=2*cr(o,l),d=u*u-4*c*(Hx(l)-r*r);if(d===0){const h=-u/(2*c);(t===Sh.PLANE||h>=0)&&s.push(Wp(Gt(0,0,n[2]),i,o,h))}else if(d>0){const h=Math.sqrt(d),p=(-u+h)/(2*c);(t===Sh.PLANE||p>=0)&&s.push(Wp(Gt(0,0,n[2]),i,o,p));const m=(-u-h)/(2*c);(t===Sh.PLANE||m>=0)&&s.push(Wp(Gt(0,0,n[2]),i,o,m))}return s}function F8(i,e){const t=i.start,n=i.end,r=Yn(ig,n,t),s=je(ng,-r[1],r[0],0),a=e.start,o=e.end,l=pr(wM,o,a),c=dt(l,s),u=je(Ege,t[0],t[1],0),d=pr(Age,u,a),h=dt(d,s);if(Math.abs(c)<Lo)return[];const p=gy(Mge,a,l,h/c);if(e.type===gs.RAY){const m=pr(CL,p,a);if(dt(m,l)<-Lo)return[]}if(i.type===Sh.HALF_PLANE){const m=TB(CL,p,t);if(cr(m,r)<-Lo)return[]}return[Ts(p)]}function N8(i,e){return V8(NA(ND,e[2],i),e)}function xge(i,e){const n=Sge(NA(ND,0,i),NA(mxt,0,e)),r=[];for(const s of n)r.push(dS(s));return r}function Cge(i,e){return zH(i,NA(ND,i[2],e))}function hxt(i,e){return Tge(NA(ND,i[2],e),i)}function pxt(i,e,t){const n=je(ig,i[0],i[1],e[2]),r=nt(ng,n,e),s=t/Et(r);return gy(q(),e,r,s)}function zH(i,{start:e,end:t,type:n}){const r=pr(ig,i,e),s=pr(ng,t,e),a=dt(r,s)/dt(s,s);return gy(q(),e,s,n===gs.RAY?Math.max(a,0):a)}function Tge({start:i,end:e,type:t},n){const r=pr(ig,n,i),s=pr(ng,e,i);if(t===gs.RAY&&dt(s,r)<-Lo)return Gn(i,n);const a=vi(wM,s,r);return vp(a)/vp(s)}function vte({start:i,end:e,type:t},n,r){const s=[];if(Hp(i[2],n[2],Lo)&&Hp(e[2],n[2],Lo)){const a=i,o=n,l=Yn(ig,e,a),c=Yn(ng,a,o),u=Hx(l),d=2*cr(l,c),h=d*d-4*u*(Hx(c)-r*r);if(h===0){const p=-d/(2*u);(t===gs.LINE||p>=0)&&s.push(Wp(Gt(0,0,n[2]),a,l,p))}else if(h>0){const p=Math.sqrt(h),m=(-d+p)/(2*u);(t===gs.LINE||m>=0)&&s.push(Wp(Gt(0,0,n[2]),a,l,m));const g=(-d-p)/(2*u);(t===gs.LINE||g>=0)&&s.push(Wp(Gt(0,0,n[2]),a,l,g))}}else{const a=pr(ig,e,i);if(Hp(a[2],0,Lo))return s;const o=(n[2]-i[2])/a[2],l=gy(ng,i,a,o);if(t===gs.RAY){const c=pr(wM,l,i);if(dt(a,c)<-Lo)return s}for(const c of B8(n,r,l))s.push(c)}return s}function Sge(i,e){const t=i.start,n=i.end,r=e.start,s=e.end,a=pr(ig,n,t),o=pr(ng,s,r),l=pr(wM,r,t),c=vi(Ege,a,o),u=dt(l,c);if(!Hp(u,0,Lo))return[];const d=c2(c);if(Hp(d,0,Lo))return[];const h=vi(Age,l,o),p=dt(h,c)/d,m=gy(Mge,t,a,p);if(i.type===gs.RAY){const g=pr(CL,m,t);if(dt(a,g)<-Lo)return[]}if(e.type===gs.RAY){const g=pr(CL,m,r);if(dt(o,g)<-Lo)return[]}return[Ts(m)]}function V8({start:i,end:e,type:t},n){const r=pr(ig,n,i),s=pr(ng,e,i),a=vi(wM,s,r);if(c2(a)/c2(s)<Lo)switch(t){case gs.LINE:return[Ts(n)];case gs.RAY:return dt(s,r)<-Lo?[]:[Ts(n)]}return[]}function B8(i,e,t){return Hp(i[2],t[2],Lo)&&Hp(Fo(t,i),e*e,Lo)?[Ts(t)]:[]}function NA(i,e,{start:t,end:n,type:r}){return je(i.start,t[0],t[1],e),je(i.end,n[0],n[1],e),i.type=fxt[r],i}var Sh;(function(i){i[i.PLANE=0]="PLANE",i[i.HALF_PLANE=1]="HALF_PLANE"})(Sh||(Sh={}));const fxt={[Sh.PLANE]:gs.LINE,[Sh.HALF_PLANE]:gs.RAY},Lo=1e-6,ig=q(),ng=q(),wM=q(),Ege=q(),Age=q(),Mge=q(),CL=q(),ND={start:q(),end:q(),type:gs.LINE},mxt={start:q(),end:q(),type:gs.LINE};let kb=class{constructor(e){this.coordinateHelper=e}intersect(e){return _xt(this,e)}},gxt=class extends kb{constructor(e,t){super(e),this.point=t,this.pointXYZ=e.toXYZ(t)}equals(e){return Jw(e)&&ul(this.point,e.point)}check(e){const t=this.coordinateHelper.toXYZ(e,rg);return Fo(t,this.pointXYZ)<Fu.pointThreshold}closestTo(){return this.coordinateHelper.clone(this.point)}},Pge=class extends kb{constructor(e,t,n,r){super(e),this.start=t,this.end=n,this.type=r,this.startXYZ=e.toXYZ(t),this.endXYZ=e.toXYZ(n),this.lineLike={start:this.startXYZ,end:this.endXYZ,type:this.type}}equals(e){return h0(e)&&this.type===e.type&&ul(this.start,e.start)&&ul(this.end,e.end)}check(e){const t=this.coordinateHelper.toXYZ(e,rg);return Tge(this.lineLike,t)<Fu.pointOnLineThreshold}closestTo(e){const t=this.coordinateHelper,n=t.toXYZ(e,rg),r=zH(n,this.lineLike);return t.fromXYZ(r)}},vxt=class extends Pge{constructor(e,t,n){super(e,t,n,gs.LINE)}},UH=class extends kb{constructor(e,t,n,r){super(e),this.intersection=t,this.first=n,this.second=r}equals(e){return e instanceof UH&&this.first.equals(e.first)&&this.second.equals(e.second)}check(){return!1}closestTo(){return this.coordinateHelper.clone(this.intersection)}},Oge=class extends kb{constructor(e,t,n,r){super(e),this.basePoint=t,this.first=n,this.second=r}equals(e){return e instanceof Oge&&this.first.equals(e.first)&&this.second.equals(e.second)}check(){return!1}closestTo(e){const t=this.basePoint,n=this.coordinateHelper,r=n.toXYZ(e,rg),s=je(wxt,t[0],t[1],r[2]);return n.fromXYZ(s)}},Rge=class extends kb{constructor(e,t,n){super(e),this.center=t,this.radius=n,this.centerXYZ=e.toXYZ(t)}equals(e){return ex(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}check(){return!1}closestTo(e){const t=this.coordinateHelper,n=t.toXYZ(e,rg),r=pxt(n,this.centerXYZ,this.radius);return r[2]=t.getZ(e,this.centerXYZ[2]),t.fromXYZ(r)}},HH=class extends kb{constructor(e,t,n,r){super(e),this.start=t,this.end=n,this.type=r,this.planeLike={start:t,end:n,type:r}}equals(e){return p0(e)&&this.type===e.type&&ul(this.start,e.start)&&ul(this.end,e.end)}check(e){const t=this.coordinateHelper.toXYZ(e,rg);return hxt(t,this.planeLike)<Fu.pointOnLineThreshold}closestTo(e){const t=this.coordinateHelper,n=t.toXYZ(e,rg),r=Cge(n,this.planeLike);return t.fromXYZ(r)}closestEndTo(e){const{start:t,end:n}=this;return Math.sign(cr(Yn(xxt,n,t),Yn(Cxt,e,t)))>0?n:t}},Ige=class extends HH{constructor(e,t,n){super(e,t,n,Sh.HALF_PLANE)}},$ge=class extends HH{constructor(e,t,n){super(e,t,n,Sh.PLANE)}},yxt=class extends kb{constructor(e,t,n,r){super(e),this.start=t,this.end=n,this.getZ=r,this.planeLike={start:t,end:n,type:Sh.HALF_PLANE}}equals(e){return f0(e)&&ul(this.start,e.start)&&ul(this.end,e.end)&&this.getZ===e.getZ}check(e){const t=this.coordinateHelper.toXYZ(e,rg),n=yte(this,t);return Fo(t,n)<Fu.pointThreshold}closestTo(e){const t=this.coordinateHelper,n=yte(this,t.toXYZ(e,rg));return t.fromXYZ(n)}addIfOnTheGround(e,t){for(const n of t){const r=this.getZ(n[0],n[1],n[2]);T(r)&&Math.abs(n[2]-r)<Lo&&(n[2]=r,e.push(n))}}};function yte(i,e){const t=Cge(e,i.planeLike),n=i.getZ(e[0],e[1],e[2]);return T(n)&&(t[2]=n),t}function _xt(i,e){let t=[];if(Jw(i)){const{pointXYZ:n}=i;h0(e)?t=V8(e.lineLike,n):ex(e)?t=B8(e.centerXYZ,e.radius,n):p0(e)?t=N8(e.planeLike,n):f0(e)&&(t=oS(e,i))}else if(h0(i)){const{lineLike:n}=i;Jw(e)?t=V8(n,e.pointXYZ):h0(e)?t=Sge(n,e.lineLike):ex(e)?t=vte(n,e.centerXYZ,e.radius):p0(e)?t=F8(e.planeLike,n):f0(e)&&(t=oS(e,i))}else if(ex(i)){const{centerXYZ:n,radius:r}=i;h0(e)?t=vte(e.lineLike,n,r):Jw(e)?t=B8(n,r,e.pointXYZ):p0(e)?t=k8(e.planeLike,n,r):f0(e)&&(t=oS(e,i))}else if(p0(i)){const{planeLike:n,coordinateHelper:r}=i;if(p0(e))return xge(n,e.planeLike).map(s=>new Oge(r,r.fromXYZ(s),i,e));Jw(e)?t=N8(n,e.pointXYZ):h0(e)?t=F8(n,e.lineLike):ex(e)?t=k8(n,e.centerXYZ,e.radius):f0(e)&&(t=oS(e,i))}else f0(i)&&(t=oS(i,e));return bxt(t,i,e)}function oS(i,e){const{planeLike:t,getZ:n}=i,r=[];if(Jw(e))i.addIfOnTheGround(r,N8(t,e.pointXYZ));else if(h0(e))i.addIfOnTheGround(r,F8(t,e.lineLike));else if(ex(e))i.addIfOnTheGround(r,k8(t,e.centerXYZ,e.radius));else if(p0(e)||f0(e))for(const[s,a]of xge(t,e.planeLike)){const o=n(s,a,0);T(o)&&r.push(Gt(s,a,o))}return r}function bxt(i,e,t){const n=e.coordinateHelper;return i.map(r=>new UH(n,n.fromXYZ(r),e,t))}function Jw(i){return i instanceof gxt}function h0(i){return i instanceof Pge}function ex(i){return i instanceof Rge}function p0(i){return i instanceof HH}function f0(i){return i instanceof yxt}const rg=q(),wxt=q(),xxt=xt(),Cxt=xt();let ZC=class{constructor(e,t,n,r,s){this.coordinateHelper=e,this.targetPoint=t,this.constraint=n,this.elevationInfo=r,this.domain=s}},Lge=class extends ZC{constructor({coordinateHelper:e,targetPoint:t,objectId:n,constraint:r,elevationInfo:s}){super(e,t,r,s,io.FEATURE),this.objectId=n}},xM=class{constructor(e,t){this.elevationInfo=e,this.domain=t}},Lh=class extends xM{constructor(e,t,n,r,s=io.ALL,a=!0,o=!0){super(r,s),this.type=e,this.lineStart=t,this.lineEnd=n,this.fadeLeft=a,this.fadeRight=o}equals(e){return e instanceof Lh&&this.type===e.type&&ul(this.lineStart,e.lineStart)&&ul(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}},Txt=class extends Lge{constructor(e){super({...e,constraint:new vxt(e.coordinateHelper,e.edgeStart,e.edgeEnd)})}get hints(){return[new Lh($h.REFERENCE,this.constraint.start,this.constraint.end,this.elevationInfo,this.domain)]}},VD=class extends xM{constructor(e,t,n,r,s=io.ALL){super(r,s),this.previousVertex=e,this.centerVertex=t,this.nextVertex=n}equals(e){return e instanceof VD&&ul(this.previousVertex,e.previousVertex)&&ul(this.centerVertex,e.centerVertex)&&ul(this.nextVertex,e.nextVertex)}},Dge=class extends ZC{constructor({coordinateHelper:e,targetPoint:t,constraint:n,previousVertex:r,otherVertex:s,otherVertexType:a,objectId:o,elevationInfo:l}){super(e,t,n,l,io.SELF),this.previousVertex=r,this.otherVertex=s,this.otherVertexType=a,this.objectId=o}get hints(){const e=this.previousVertex,t=this.otherVertexType===TC.CENTER?this.otherVertex:this.targetPoint,n=this.otherVertexType===TC.CENTER?this.targetPoint:this.otherVertex,r=this.elevationInfo;return[new Lh($h.TARGET,t,n,r,this.domain),new Lh($h.REFERENCE,e,t,r,this.domain),new VD(this.previousVertex,t,n,r,this.domain)]}};var TC;(function(i){i[i.NEXT=0]="NEXT",i[i.CENTER=1]="CENTER"})(TC||(TC={}));function f8t(i,e,t,n){t.projectToRenderScreen(i,bte),t.projectToRenderScreen(e,wte),Yn(n,wte,bte),my(n,n)}function _te(i,e,t,n,r=q()){const s=e.toXYZ(i);return s[2]=Xx(n,s,e.spatialReference,t)||0,n.renderCoordsHelper.toRenderCoords(s,e.spatialReference,r),r}function Sxt(i,e,t,n,r=q()){const s=Ge(z8,i);return s[2]=Xx(n,s,e,t)||0,n.renderCoordsHelper.toRenderCoords(s,e,r),r}function Nc(i,e,t,n){return GH(e.toXYZ(i),e.spatialReference,t,n)}function GH(i,e,t,n){return n.type==="2d"?(kO.x=i[0],kO.y=i[1],kO.spatialReference=e,n.toScreen(kO)):(Sxt(i,e,t,n,z8),n.state.camera.projectToScreen(z8,oN),Cs(oN[0],oN[1]))}function m8t(i,e,t,n,r,s,a){if(n.mode==="absolute-height")return _te(i,t,n,r,s),void _te(e,t,n,r,a);const o=t.toXYZ(i),l=t.toXYZ(e),c=Xx(r,o,t.spatialReference,n),u=Xx(r,l,t.spatialReference,n),d=(c==null?u:u==null?c:Math.min(c,u))||0;o[2]=d,l[2]=d,r.renderCoordsHelper.toRenderCoords(o,t.spatialReference,s),r.renderCoordsHelper.toRenderCoords(l,t.spatialReference,a)}const kO=new Wt,z8=q(),bte=pa(),wte=pa(),oN=Fn();let Tv=class extends PC{constructor(e){super(e),this.options=null,this._domain=io.FEATURE,this._sourceModules={featureService:{module:null,loader:null},featureCollection:{module:null,loader:null},graphics:{module:null,loader:null},notes:{module:null,loader:null},scene:{module:null,loader:null}}}get updating(){return ps(this.snappingSources,({snappingSource:e})=>e.updating)||this.updatingHandles.updating}get snappingSources(){const e=this._get("snappingSources")||new Map,t=new Map;if(T(this.options)&&T(this.options.featureSources))for(const n of this.options.featureSources.items){const r=n.layer.uid,s=e.get(r);if(s){e.delete(r),t.set(r,s);continue}if(!n.layer.loaded){this.updatingHandles.addPromise(n.layer.load());continue}const a=this._createSourceInfo(n);T(a)&&t.set(r,a)}for(const[,n]of e)n.destroy();return t}initialize(){this.updatingHandles.add(()=>this.snappingSources,()=>this.notifyChange("updating"),on),T(this.view)&&this.handles.add([this.view.on("layerview-create",e=>this._updateLayerView(e.layer,e.layerView)),this.view.on("layerview-destroy",e=>this._updateLayerView(e.layer,null))])}_updateLayerView(e,t){for(const[,n]of this.snappingSources)n.snappingSource.layerSource.layer===e&&(n.layerView=t)}destroy(){this._set("options",null);for(const[,e]of this.snappingSources)e.destroy()}async fetchCandidates(e,t,n,r){if(!(t&this._domain)||B(this.options)||!this.options.effectiveFeatureEnabled)return[];const s=[],a=this._computeScreeenSizeDistanceParameters(e,n),o={distance:a,point:e,coordinateHelper:n.coordinateHelper,types:this._types};for(const[,{snappingSource:c,layerView:u}]of this.snappingSources)!c.layerSource.enabled||T(u)&&u.suspended||s.push(c.fetchCandidates(o,r).then(d=>d.filter(h=>!this._candidateIsExcluded(c,h,n.excludeFeature))));const l=(await lie(s)).flat();return this._addRightAngleCandidates(l,e,a,n),Cn(r),BH(e,l,n.coordinateHelper),l}_addRightAngleCandidates(e,t,n,r){var d,h,p,m,g,_,b,x;const s=T(r.vertexHandle)?(h=(d=r.vertexHandle.rightEdge)==null?void 0:d.rightVertex)==null?void 0:h.pos:T(r.editGeometryOperations)&&r.editGeometryOperations.data.type==="polygon"?(m=kt((p=r.editGeometryOperations.data.components[0])==null?void 0:p.getFirstVertex()))==null?void 0:m.pos:null,a=T(r.vertexHandle)?(_=(g=r.vertexHandle.leftEdge)==null?void 0:g.leftVertex)==null?void 0:_.pos:T(r.editGeometryOperations)?(x=kt((b=r.editGeometryOperations.data.components[0])==null?void 0:b.getLastVertex()))==null?void 0:x.pos:null,{view:o}=this,l=ks(s,o,r),c=ks(a,o,r),u=e.length;for(let w=0;w<u;w++)this._addRightAngleCandidate(e[w],c,t,n,r,e),this._addRightAngleCandidate(e[w],l,t,n,r,e)}_addRightAngleCandidate(e,t,n,r,s,a){const o=e instanceof Txt,l=o&&SB(e.constraint.start,e.constraint.end);if(B(t)||!o||l)return;const c=e.constraint.closestTo(t),u=(c[0]-n[0])/r.x,d=(c[1]-n[1])/r.y;if(u*u+d*d<=1){const h=s.coordinateHelper,p=new Dge({coordinateHelper:h,targetPoint:c,otherVertex:t,otherVertexType:TC.NEXT,previousVertex:e.constraint.start,constraint:new Ige(h,t,c),objectId:e.objectId,elevationInfo:e.elevationInfo});a.push(p)}}_computeScreeenSizeDistanceParameters(e,t){let n=T(this.options)?this.options.distance*(t.pointer==="touch"?this.options.touchSensitivityMultiplier:1):0;return B(this.view)?{x:n,y:n,z:n,distance:n}:this.view.type==="2d"?(n*=this.view.resolution,{x:n,y:n,z:n,distance:n}):this._computeScreenSizeDistanceParameters3D(e,n,this.view,t)}_computeScreenSizeDistanceParameters3D(e,t,n,r){const{coordinateHelper:s,elevationInfo:a}=r,{spatialReference:o}=s,l=s.hasZ()?ns:a,c=s.toXYZ(e,Axt);c[2]=Xx(n,c,o,l,ns),n.renderCoordsHelper.toRenderCoords(c,o,xte);const u=n.state.camera.computeScreenPixelSizeAt(xte),d=u*n.renderCoordsHelper.unitInMeters/n.mapCoordsHelper.unitInMeters,h=t*d,p=GH(c,o,ns,n),m=lN(p,c,d,0,0,n,r),g=lN(p,c,0,d,0,n,r),_=lN(p,c,0,0,d,n,r);return{x:m===0?0:h/m,y:g===0?0:h/g,z:_===0?0:h/_,distance:u*t}}get _types(){return gW.EDGE|gW.VERTEX}_candidateIsExcluded(e,t,n){if(B(n))return!1;const r=this._getCandidateObjectId(t);if(B(r))return!1;const s=e.layerSource.layer;return s.type==="graphics"?n.uid===r:n.sourceLayer===s&&!(!n.attributes||!("objectIdField"in s))&&n.attributes[s.objectIdField]===r}_getCandidateObjectId(e){return e instanceof Lge?e.objectId:null}_createSourceInfo(e){const t=this._createFeatureSnappingSourceType(e);if(B(t))return null;if("loading"in t)return this.updatingHandles.addPromise(t.loading.then(()=>{this.destroyed||this.notifyChange("snappingSources")})),null;const n=T(this.view)?this.view.allLayerViews.find(r=>r.layer===e.layer):null;return new Ext(t.source,n)}_createFeatureSnappingSourceType(e){switch(e.layer.type){case"feature":case"geojson":case"csv":case"oriented-imagery":case"subtype-group":case"wfs":return this._createFeatureSnappingSourceFeatureLayer(e);case"graphics":return this._createFeatureSnappingSourceGraphicsLayer(e);case"map-notes":return this._createFeatureSnappingSourceMapNotesLayer(e);case"scene":case"building-scene":return this._createFeatureSnappingSourceSceneLayer(e)}return null}_createFeatureSnappingSourceSceneLayer(e){const{view:t}=this;if(B(t)||t.type!=="3d")return null;const n=this._getSourceModule("scene");return T(n.module)?{source:new n.module.SceneLayerSnappingSource({layerSource:e,view:t})}:{loading:n.loader}}_createFeatureSnappingSourceFeatureLayer(e){switch(e.layer.source.type){case"feature-layer":case"oriented-imagery":{const t=this._getSourceModule("featureService");return T(t.module)?{source:new t.module.FeatureServiceSnappingSource({spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}case"memory":case"csv":case"geojson":case"wfs":{if(e.layer.geometryType==="mesh")return null;const t=this._getSourceModule("featureCollection");return T(t.module)?{source:new t.module.FeatureCollectionSnappingSource({layerSource:e,view:this.view})}:{loading:t.loader}}}return null}_createFeatureSnappingSourceGraphicsLayer(e){const t=this._getSourceModule("graphics");return T(t.module)?{source:new t.module.GraphicsSnappingSource({getGraphicsLayers:()=>[e.layer],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_createFeatureSnappingSourceMapNotesLayer(e){const t=this._getSourceModule("notes");return T(t.module)?{source:new t.module.GraphicsSnappingSource({getGraphicsLayers:()=>T(e.layer.sublayers)?e.layer.sublayers.toArray():[],spatialReference:this.spatialReference,view:this.view,layerSource:e})}:{loading:t.loader}}_getSourceModule(e){const t=this._sourceModules[e];if(B(t.loader)){const n=this._loadSourceModule(e).then(r=>{t.module=r});return t.loader=n,{module:t.module,loader:n}}return{module:t.module,loader:t.loader}}_loadSourceModule(e){const t=this.updatingHandles;switch(e){case"featureService":return t.addPromise(Ee(()=>import("./FeatureServiceSnappingSource-df2de09f.js"),["./FeatureServiceSnappingSource-df2de09f.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./HandleOwner-e1406413.js","./reactiveUtils-f41a4e00.js","./Scheduler-8433672d.js","./SimpleObservable-7dcdef1d.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./TileInfo-34f80a8e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./vec4f64-e407da96.js","./queryEngineUtils-db3552dc.js","./VertexSnappingCandidate-6fb04b2b.js","./TileTreeDebugger-5ce82b98.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./assets-0b172f07.js","./intl-f1e98361.js","./messages-be07754e.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Cyclical-b66238c6.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));case"featureCollection":return t.addPromise(Ee(()=>import("./FeatureCollectionSnappingSource-0f984337.js"),["./FeatureCollectionSnappingSource-0f984337.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./queryEngineUtils-db3552dc.js","./VertexSnappingCandidate-6fb04b2b.js","./symbologySnappingCandidates-3493a4d4.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./request-d3e98716.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./assets-0b172f07.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));case"graphics":case"notes":return t.addPromise(Ee(()=>import("./GraphicsSnappingSource-eca83a0e.js"),["./GraphicsSnappingSource-eca83a0e.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./asyncUtils-62e8a185.js","./HandleOwner-e1406413.js","./reactiveUtils-f41a4e00.js","./Polyline-bf268e7b.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./projection-d7b57a6c.js","./preload-helper-41c905a7.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./unitUtils-47abac71.js","./jsonMap-c1f958cf.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./assets-0b172f07.js","./request-d3e98716.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./normalizeUtilsSync-9c84b89e.js","./jsonUtils-03c4af61.js","./normalizeUtils-ee4bf39f.js","./geometry-5a216427.js","./typeUtils-eb9416d0.js","./featureConversionUtils-01cdde8a.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-b1ba4c29.js","./Evented-515b9d9c.js","./aaBoundingBox-fc742a4e.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./QueryEngine-a5c074c3.js","./MemCache-4b976a8b.js","./QueryEngineResult-665bf7fb.js","./quantizationUtils-33aba427.js","./ItemCache-ee28c7ba.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./colorRamps-3a8ac20b.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./enumeration-3c281341.js","./Symbol-fc4312a4.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./QueryEngineCapabilities-42e44ded.js","./timeSupport-b43dc94c.js","./FieldsIndex-aa6dd3fa.js","./Scheduler-8433672d.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./utils-725f8b4e.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./Clonable-ba795b08.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./queryEngineUtils-db3552dc.js","./VertexSnappingCandidate-6fb04b2b.js","./symbologySnappingCandidates-3493a4d4.js","./LRUCache-14115d91.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));case"scene":return t.addPromise(Ee(()=>import("./SceneLayerSnappingSource-5a72c74f.js"),["./SceneLayerSnappingSource-5a72c74f.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./HandleOwner-e1406413.js","./reactiveUtils-f41a4e00.js","./vec3f64-2f9cef06.js","./LercDecoder-73115fd2.js","./workers-898a7c4c.js","./preload-helper-41c905a7.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./request-d3e98716.js","./assets-0b172f07.js","./intl-f1e98361.js","./number-347a3a44.js","./jsonMap-c1f958cf.js","./locale-30120714.js","./messages-be07754e.js","./sphere-4f5e644f.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./common-c186b691.js","./vec4-790471c0.js","./mat4-44a0988f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./VertexSnappingCandidate-6fb04b2b.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./Cyclical-b66238c6.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url))}return null}};f([y({constructOnly:!0})],Tv.prototype,"spatialReference",void 0),f([y({constructOnly:!0})],Tv.prototype,"view",void 0),f([y()],Tv.prototype,"options",void 0),f([y({readOnly:!0})],Tv.prototype,"updating",null),f([y({readOnly:!0})],Tv.prototype,"snappingSources",null),Tv=f([ge("esri.views.interactive.snapping.FeatureSnappingEngine")],Tv);let Ext=class{constructor(e,t){this.snappingSource=e,this.layerView=t,this.handles=new mi;const n=this.snappingSource.layerSource.layer;if("refresh"in n){const r=n;this.handles.add(r.on("refresh",()=>e.refresh()))}this.handles.add([ue(()=>e.updating,r=>e.layerSource.updating=r,hn),ue(()=>e.availability,r=>e.layerSource.availability=r,hn)])}destroy(){this.snappingSource.destroy(),this.handles.destroy()}};function lN(i,e,t,n,r,s,{coordinateHelper:a}){const o=Ge(Mxt,e);o[0]+=t,o[1]+=n,o[2]+=r;const l=GH(o,a.spatialReference,ns,s);return sxt(l,i)}const Axt=q(),xte=q(),Mxt=q();let BD=class{constructor(e,t){this.view=e,this.options=t,this.squaredShortLineThreshold=Fu.shortLineThreshold*Fu.shortLineThreshold}snap(e,t){return T(t.vertexHandle)?t.vertexHandle.type!=="vertex"?[]:this.snapExistingVertex(e,t):this.snapNewVertex(e,t)}edgeExceedsShortLineThreshold(e,t){return this.exceedsShortLineThreshold(e.leftVertex.pos,e.rightVertex.pos,t)}exceedsShortLineThreshold(e,t,{elevationInfo:n,editGeometryOperations:r}){const s=r.data.coordinateHelper;return this.squaredShortLineThreshold===0||Db(Nc(t,s,n,this.view),Nc(e,s,n,this.view))>this.squaredShortLineThreshold}squaredProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,n=e*t;return n*n}},Pxt=class extends ZC{constructor({coordinateHelper:e,lineStart:t,lineEnd:n,targetPoint:r,elevationInfo:s}){super(e,r,new $ge(e,t,n),s,io.SELF),this._referenceLineHint=new Lh($h.REFERENCE_EXTENSION,t,n,s,this.domain)}get hints(){return[this._referenceLineHint,new Lh($h.TARGET,this._lineEndClosestToTarget(),this.targetPoint,this.elevationInfo,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},Oxt=class extends BD{snapNewVertex(e,t){const n=t.editGeometryOperations.data.components[0],r=n.edges.length,s=[];if(r<1)return s;const a=t.coordinateHelper,o=Nc(e,a,ns,this.view),{view:l}=this,c=n.edges[r-1];let u=c;do{if(this.edgeExceedsShortLineThreshold(u,t)){const d=Sp(u,l,t);this._processCandidateProposal(d.left,d.right,e,o,t,s)}u=u.leftVertex.leftEdge}while(u&&u!==c);return s}snapExistingVertex(e,t){const n=[],r=kt(t.vertexHandle),s=r.component;if(s.edges.length<2)return n;const{view:a}=this,{coordinateHelper:o}=t,l=Nc(e,o,ns,a),c=r.leftEdge,u=r.rightEdge;c&&u&&this.edgeExceedsShortLineThreshold(c,t)&&this.edgeExceedsShortLineThreshold(u,t)&&this._processCandidateProposal(ks(c.leftVertex.pos,a,t),ks(u.rightVertex.pos,a,t),e,l,t,n);const d=s.edges[0];let h=d;do{if(h!==r.leftEdge&&h!==r.rightEdge&&this.edgeExceedsShortLineThreshold(h,t)){const p=Sp(h,a,t);this._processCandidateProposal(p.left,p.right,e,l,t,n)}h=h.rightVertex.rightEdge}while(h&&h!==d);return n}_processCandidateProposal(e,t,n,r,s,a){const{coordinateHelper:o,pointer:l}=s;o.toXYZ(e,kge),o.toXYZ(t,Fge);const c=o.toXYZ(n,Ixt),u=zH(c,Rxt),d=o.fromXYZ(u);Db(r,Nc(d,o,ns,this.view))<this.squaredProximityThreshold(l)&&a.push(new Pxt({coordinateHelper:o,lineStart:e,lineEnd:t,targetPoint:d,elevationInfo:o.hasZ()?ns:null}))}};const kge=q(),Fge=q(),Rxt={start:kge,end:Fge,type:gs.LINE},Ixt=q();let WH=class extends xM{constructor(e,t,n,r=io.ALL){super(n,r),this.lineStart=e,this.lineEnd=t}equals(e){return e instanceof WH&&ul(this.lineStart,e.lineStart)&&ul(this.lineEnd,e.lineEnd)}},$xt=class extends ZC{constructor({coordinateHelper:e,referenceLine:t,lineStart:n,targetPoint:r,elevationInfo:s}){const a=e.toXYZ(n,Lxt),o=e.toXYZ(t.left,Dxt),l=e.toXYZ(t.right,kxt);nt(a,rt(a,a,l),o),super(e,r,new $ge(e,n,e.fromXYZ(a)),s,io.SELF),this._referenceLines=[{edge:t,fadeLeft:!0,fadeRight:!0}]}get hints(){const e=this.elevationInfo;return[new Lh($h.TARGET,this.constraint.start,this.targetPoint,e,this.domain),new WH(this.constraint.start,this.targetPoint,e,this.domain),...this._referenceLines.map(t=>new Lh($h.REFERENCE,t.edge.left,t.edge.right,e,this.domain,t.fadeLeft,t.fadeRight))]}addReferenceLine(e){const t={edge:e,fadeLeft:!0,fadeRight:!0},{coordinateHelper:n}=this;this._referenceLines.forEach(r=>{n.equals(e.right,r.edge.left)&&(r.fadeLeft=!1,t.fadeRight=!1),n.equals(e.right,r.edge.right)&&(r.fadeRight=!1,t.fadeRight=!1),n.equals(e.left,r.edge.right)&&(r.fadeRight=!1,t.fadeLeft=!1),n.equals(e.left,r.edge.left)&&(r.fadeLeft=!1,t.fadeLeft=!1)}),this._referenceLines.push(t)}};const Lxt=q(),Dxt=q(),kxt=q();let Fxt=class extends BD{snapNewVertex(e,t){const n=t.editGeometryOperations.data.components[0],r=n.edges.length,s=n.vertices.length,a=[];if(r<2)return a;const{view:o}=this,l=Nc(e,t.coordinateHelper,ns,o),c=ks(n.vertices[s-1].pos,o,t),u=ks(n.vertices[0].pos,o,t),d=n.edges[r-1];let h=d;do{if(this.edgeExceedsShortLineThreshold(h,t)){const p=Sp(h,o,t);this._checkEdgeForParalleLines(p,c,e,l,t,a),this._checkEdgeForParalleLines(p,u,e,l,t,a)}h=h.leftVertex.leftEdge}while(h&&h!==d);return a}snapExistingVertex(e,t){const n=[],r=kt(t.vertexHandle),s=r.component;if(s.edges.length<3)return n;const{view:a}=this,o=Nc(e,t.coordinateHelper,ns,a),l=r.leftEdge,c=r.rightEdge,u=s.vertices[0],d=ks(u.pos,a,t),h=s.vertices.length,p=s.vertices[h-1],m=ks(p.pos,a,t),g=s.edges[0];let _=g;do{if(_!==l&&_!==c&&this.edgeExceedsShortLineThreshold(_,t)){const b=Sp(_,a,t);l&&this._checkEdgeForParalleLines(b,ks(l.leftVertex.pos,a,t),e,o,t,n),c&&this._checkEdgeForParalleLines(b,ks(c.rightVertex.pos,a,t),e,o,t,n),r===u?this._checkEdgeForParalleLines(b,m,e,o,t,n):r===p&&this._checkEdgeForParalleLines(b,d,e,o,t,n)}_=_.rightVertex.rightEdge}while(_&&_!==g);return n}_checkEdgeForParalleLines(e,t,n,r,s,a){const o=e.left,l=e.right;if(aN(H1,t,o,l),WI(H1,t)<Fu.parallelLineThreshold)return;aN(H1,n,o,l,t);const{coordinateHelper:c,pointer:u}=s,d=c.fromXYZ(H1,c.getZ(n,0));if(Db(r,Nc(d,c,ns,this.view))<this.squaredProximityThreshold(u)){if(this._parallelToPreviousCandidate(e,a))return;a.push(new $xt({coordinateHelper:c,referenceLine:e,lineStart:t,targetPoint:d,elevationInfo:c.hasZ()?ns:null}))}}_parallelToPreviousCandidate(e,t){const n=e.left,r=e.right;for(const s of t)if(aN(H1,r,s.constraint.start,s.constraint.end,n),WI(H1,r)<Fu.parallelLineThreshold)return s.addReferenceLine(e),!0;return!1}};const H1=xt();let Nxt=class extends BD{snapNewVertex(e,t){const n=t.editGeometryOperations.data.components[0],r=n.vertices.length,s=[];if(r<2)return s;const{view:a}=this,o=Nc(e,t.coordinateHelper,ns,a),l=n.vertices[r-1];if(this.edgeExceedsShortLineThreshold(l.leftEdge,t)){const u=ks(l.pos,a,t),d=Sp(l.leftEdge,a,t);this._checkForSnappingCandidate(s,d,u,e,d.left,u,t,e,o)}const c=n.vertices[0];if(this.edgeExceedsShortLineThreshold(c.rightEdge,t)){const u=ks(c.pos,a,t),d=Sp(c.rightEdge,a,t);this._checkForSnappingCandidate(s,d,u,e,d.right,u,t,e,o)}return s}snapExistingVertex(e,t){const n=[],r=kt(t.vertexHandle),s=r.component,a=s.vertices.length;if(a<3)return n;const{view:o}=this,l=Nc(e,t.coordinateHelper,ns,o),c=r.leftEdge,u=r.rightEdge,d=s.vertices[0],h=s.vertices[a-1];if(!c){const p=d.rightEdge.rightVertex.rightEdge;if(this.edgeExceedsShortLineThreshold(p,t)){const m=Sp(p,o,t),g=ks(d.rightEdge.rightVertex.pos,o,t);this._checkForSnappingCandidate(n,m,g,e,m.right,g,t,e,l)}return n}if(!u){const p=h.leftEdge.leftVertex.leftEdge;if(this.edgeExceedsShortLineThreshold(p,t)){const m=Sp(p,o,t),g=ks(h.leftEdge.leftVertex.pos,o,t);this._checkForSnappingCandidate(n,m,g,e,m.left,g,t,e,l)}return n}if(c&&c.leftVertex.leftEdge){const p=c.leftVertex.leftEdge;if(this.edgeExceedsShortLineThreshold(p,t)){const m=Sp(p,o,t),g=ks(c.leftVertex.pos,o,t);this._checkForSnappingCandidate(n,m,g,e,m.left,g,t,e,l)}}if(u&&u.rightVertex.rightEdge){const p=u.rightVertex.rightEdge;if(this.edgeExceedsShortLineThreshold(p,t)){const m=Sp(p,o,t),g=ks(u.rightVertex.pos,o,t);this._checkForSnappingCandidate(n,m,g,e,m.right,g,t,e,l)}}return n}_checkForSnappingCandidate(e,t,n,r,s,a,o,l,c){const{coordinateHelper:u,pointer:d}=o;Yn(lS,t.right,t.left);const h=je(zxt,lS[1],-lS[0],0),p=cr(h,Yn(lS,r,n))/Hx(h),m=u.fromXYZ(Wp(lS,a,h,p),u.getZ(l,0));if(Db(c,Nc(m,u,ns,this.view))<this.squaredProximityThreshold(d)){const g=u.toXYZ(a,Vxt),_=gy(Bxt,g,h,Math.sign(p)),b=u.fromXYZ(_);e.push(new Dge({coordinateHelper:u,targetPoint:m,constraint:new Ige(u,a,b),previousVertex:s,otherVertex:a,otherVertexType:TC.CENTER,elevationInfo:u.hasZ()?ns:null}))}}};const lS=xt(),Vxt=q(),Bxt=q(),zxt=q();let Uxt=class extends ZC{constructor({coordinateHelper:e,targetPoint:t,point1:n,point2:r,elevationInfo:s}){super(e,t,new Rge(e,e.arrayToVector(Hv(Hxt,n,r,.5)),.5*sf(n,r)),s,io.SELF),this._p1=n,this._p2=r}get hints(){const e=this.elevationInfo;return[new Lh($h.REFERENCE,this.targetPoint,this._p1,e,this.domain),new Lh($h.REFERENCE,this.targetPoint,this._p2,e,this.domain),new VD(this._p1,this.targetPoint,this._p2,e,this.domain)]}};const Hxt=xt();let Gxt=class extends BD{snapNewVertex(e,t){const n=t.editGeometryOperations.data.components[0],r=[],s=n.vertices.length;if(t.editGeometryOperations.data.type!=="polygon"||s<2)return r;const{view:a}=this,o=n.vertices[0],l=n.vertices[s-1],c=ks(o.pos,a,t),u=ks(l.pos,a,t);return this._processCandidateProposal(c,u,e,t,r),r}snapExistingVertex(e,t){const n=[],r=kt(t.vertexHandle),s=r.component;if(s.edges.length<2||t.editGeometryOperations.data.type==="polyline"&&(r.index===0||r.index===s.vertices.length-1))return n;const{view:a}=this,o=ks(r.leftEdge.leftVertex.pos,a,t),l=ks(r.rightEdge.rightVertex.pos,a,t);return this._processCandidateProposal(o,l,e,t,n),n}_processCandidateProposal(e,t,n,r,s){if(!this.exceedsShortLineThreshold(e,t,r))return;const a=Hv(Wxt,e,t,.5),o=.5*sf(e,t),l=lxt(jxt,n,a,o),{coordinateHelper:c,pointer:u}=r,d=c.fromXYZ(l,c.getZ(n,0)),h=Nc(n,c,ns,this.view);Db(h,Nc(d,c,ns,this.view))<this.squaredProximityThreshold(u)&&s.push(new Uxt({coordinateHelper:c,targetPoint:d,point1:e,point2:t,elevationInfo:c.hasZ()?ns:null}))}};const Wxt=xt(),jxt=xt();let ww=class extends et{constructor(e){super(e),this.updating=!1,this._snappers=new _i,this._domain=io.SELF}initialize(){this._snappers.push(new Fxt(this.view,this.options),new Oxt(this.view,this.options),new Nxt(this.view,this.options),new Gxt(this.view,this.options))}set options(e){this._set("options",e);for(const t of this._snappers)t.options=e}async fetchCandidates(e,t,n){if(!(t&this._domain&&this.options.effectiveSelfEnabled))return[];const r=[];for(const s of this._snappers.items)for(const a of s.snap(e,n))r.push(a);return BH(e,r,n.coordinateHelper),r}};f([y({readOnly:!0})],ww.prototype,"updating",void 0),f([y({constructOnly:!0})],ww.prototype,"view",void 0),f([y()],ww.prototype,"options",null),ww=f([ge("esri.views.interactive.snapping.SelfSnappingEngine")],ww);function qxt(i,e){return[new ww({view:i,options:e}),new Tv({view:i,options:e,spatialReference:i.spatialReference})]}let su=class extends et{constructor(e){super(e),this.enabled=!1,this.enabledToggled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.featureSources=new _i,this.distance=Fu.distance,this.touchSensitivityMultiplier=Fu.touchSensitivityMultiplier}get effectiveEnabled(){return this.enabledToggled?!this.enabled:this.enabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}};f([y()],su.prototype,"enabled",void 0),f([y()],su.prototype,"enabledToggled",void 0),f([y()],su.prototype,"selfEnabled",void 0),f([y()],su.prototype,"featureEnabled",void 0),f([y({type:_i.ofType(DH)})],su.prototype,"featureSources",void 0),f([y()],su.prototype,"distance",void 0),f([y()],su.prototype,"touchSensitivityMultiplier",void 0),f([y({readOnly:!0})],su.prototype,"effectiveEnabled",null),f([y({readOnly:!0})],su.prototype,"effectiveSelfEnabled",null),f([y({readOnly:!0})],su.prototype,"effectiveFeatureEnabled",null),su=f([ge("esri.views.interactive.snapping.SnappingOptions")],su);const jH=su;let qH=class extends xM{constructor(e,t,n=io.ALL){super(t,n),this.intersectionPoint=e}equals(e){return e instanceof qH&&ul(this.intersectionPoint,e.intersectionPoint)}},FO=class extends ZC{constructor(e,t,n,r,s){super(e,t,new UH(e,t,n.constraint,r.constraint),s,io.ALL),this.first=n,this.second=r}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new qH(this.targetPoint,this.elevationInfo,this.domain)]}},fp=class extends Pn.EventedMixin(PC){constructor(e){super(e),this.options=new jH,this.snappingEnginesFactory=qxt,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=hm.MAIN}initialize(){this.handles.add([ue(()=>{const{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:n,distance:r}=this.options;return{effectiveFeatureEnabled:e,effectiveSelfEnabled:t,touchSensitivityMultiplier:n,distance:r}},()=>{this.doneSnapping(),this.emit("changed")},on),ue(()=>this.options,e=>{for(const t of this._engines)t.options=e},on),ue(()=>({viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,snappingEnginesFactory:this.snappingEnginesFactory}),({viewReady:e,snappingEnginesFactory:t})=>this._recreateEngines(e,t),hn)])}destroy(){this._destroyEngines()}get updating(){return this._engines.some(e=>e.updating)}_recreateEngines(e,t){if(this._destroyEngines(),!e)return;const{view:n,options:r}=this;this._engines=t(n,r)}_destroyEngines(){for(const e of this._engines)e.destroy();this._engines=[]}get _squaredMouseProximityTreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:e,touchSensitivityMultiplier:t}=this.options,n=e*t;return n*n}async snap(e){return Kxt(e)?this._snapMultiPoint(e):this._snapSinglePoint(e)}update(e){const{point:t,context:n}=e;this._removeVisualization();const r=this._currentMainCandidate;if(B(r))return t;const s=this._selectUpdateInput(e);if(B(s))return t;const{coordinateHelper:{spatialReference:a}}=n,o=Bc(this._convertPointElevation(s,n),a);if(B(o))return t;const{view:l}=this,{coordinateHelper:c,elevationInfo:u,visualizer:d}=n,h=[],p=c.pointToVector(o),m=r.constraint.closestTo(p);if(!this._arePointsWithinScreenThreshold(p,m,n))return this._resetSnappingState(),t;r.targetPoint=m,h.push(...r.hints);for(const _ of this._currentOtherActiveCandidates)_.targetPoint=m,h.push(..._.hints);T(d)&&this.handles.add(d.draw(h,{coordinateHelper:c,elevationInfo:Cte(n),view:l,selfSnappingZ:n.selfSnappingZ}),NO);const g=c.vectorToDehydratedPoint(m);return this._convertPointElevation(g,n,ns,u)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:e,scenePoint:t}){switch(this._currentSnappedType){case hm.MAIN:return e;case hm.SCENE:return t}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=hm.MAIN}_removeVisualization(){this.handles.remove(NO)}async _snapSinglePoint({point:e,context:t,signal:n}){const{coordinateHelper:r}=t,{view:s}=this,a=this._convertPointElevation(e,t),o=r.pointToVector(a),l=await this._fetchCandidates(o,io.ALL,t,n);return this._createSnapResult(o,hm.MAIN,l,s,t,n)}async _snapMultiPoint({point:e,scenePoint:t,context:n,signal:r}){const{view:s}=this,{coordinateHelper:a}=n,{spatialReference:o}=a;await Kye(t.spatialReference,o);const l=Bc(this._convertPointElevation(t,n),o),c=a.pointToVector(l),u=await this._fetchCandidates(c,io.FEATURE,n,r);if(u.length>0){const m=await this._fetchCandidates(c,io.SELF,n,r);return this._createSnapResult(c,hm.SCENE,[...u,...m],s,n,r)}const d=this._convertPointElevation(e,n),h=a.pointToVector(d),p=await this._fetchCandidates(h,io.SELF,n,r);return this._createSnapResult(h,hm.MAIN,p,s,n,r)}async _fetchCandidates(e,t,n,r){return(await Promise.all(this._engines.map(s=>s.fetchCandidates(e,t,n,r)))).flat()}_createSnapResult(e,t,n,r,s,a){return{get valid(){return!bu(a)},apply:()=>{const{elevationInfo:o,coordinateHelper:l}=s,{snappedPoint:c,hints:u}=this._processCandidates(e,t,n,s);return this._removeVisualization(),T(s.visualizer)&&this.handles.add(s.visualizer.draw(u,{coordinateHelper:l,elevationInfo:Cte(s),view:r,selfSnappingZ:s.selfSnappingZ}),NO),this._convertPointElevation(c,s,ns,o)}}}_processCandidates(e,t,n,r){const{coordinateHelper:s}=r;if(n.length<1)return this.doneSnapping(),{snappedPoint:s.vectorToDehydratedPoint(e),hints:[]};this._currentSnappedType!==t&&this._resetSnappingState(),BH(e,n,s);const a=this._currentMainCandidate;if(T(a)){const o=this._findOldConstraintInNewCandidates(a,n);if(o>=0){if(!(n[o]instanceof FO))return this._intersectWithOtherCandidates(o,n,e,t,r);if(this._arePointsWithinScreenThreshold(e,a.targetPoint,r))return this._updateSnappingCandidate(a,t,n,r)}}return this._intersectWithOtherCandidates(0,n,e,t,r)}_findOldConstraintInNewCandidates(e,t){return e instanceof FO?this._findOldCandidateIndex(t,e.first)>=0&&this._findOldCandidateIndex(t,e.second)>=0?0:-1:this._findOldCandidateIndex(t,e)}_intersectWithOtherCandidates(e,t,n,r,s){const{coordinateHelper:a}=s,o=t[e],l=[];for(let c=0;c<t.length;++c){if(c===e)continue;const u=t[c];for(const d of o.constraint.intersect(u.constraint)){const h=a.fromXYZ(d.closestTo(o.targetPoint),o.targetPoint[2]);l.push([new FO(a,h,o,u,u.elevationInfo),this._squaredScreenDistance(n,h,a)])}}return l.length>0&&(l.sort((c,u)=>c[1]-u[1]),l[0][1]<this._squaredPointProximityThreshold(s.pointer))?this._updateSnappingCandidate(l[0][0],r,t,s):this._updateSnappingCandidate(o,r,t,s)}_updateSnappingCandidate(e,t,n,r){this.doneSnapping(),this._currentMainCandidate=e,this._currentSnappedType=t;const s=this._currentMainCandidate.targetPoint,a=[];a.push(...e.hints);for(const o of n){if(e instanceof FO){if(o.constraint.equals(e.first.constraint)||o.constraint.equals(e.second.constraint))continue}else if(o.constraint.equals(e.constraint))continue;o.constraint.check(s)&&(o.targetPoint=s,this._currentOtherActiveCandidates.push(o),a.push(...o.hints))}return{snappedPoint:r.coordinateHelper.vectorToDehydratedPoint(s),hints:a}}_squaredPointProximityThreshold(e){return e==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityTreshold}_arePointsWithinScreenThreshold(e,t,n){return this._squaredScreenDistance(e,t,n.coordinateHelper)<this._squaredPointProximityThreshold(n.pointer)}_squaredScreenDistance(e,t,n){return Db(this._toScreen(e,n),this._toScreen(t,n))}_toScreen(e,t){return Nc(e,t,ns,this.view)}_findOldCandidateIndex(e,t){let n=-1;for(let r=0;r<e.length;++r)if(t.constraint.equals(e[r].constraint)){n=r;break}return n}_convertPointElevation(e,t,n=t.elevationInfo,r=ns){const{view:s}=this;if(!(T(e)&&t.coordinateHelper.hasZ()&&T(s)&&s.type==="3d"))return e;const a=ko(e);return a.z=mz(s,a,n,r),a}get test(){return{visualizationsActive:this.handles.has(NO),engines:this._engines}}};var hm;f([y({constructOnly:!0})],fp.prototype,"view",void 0),f([y()],fp.prototype,"options",void 0),f([y({readOnly:!0})],fp.prototype,"updating",null),f([y()],fp.prototype,"snappingEnginesFactory",void 0),f([y()],fp.prototype,"_engines",void 0),f([y()],fp.prototype,"_squaredMouseProximityTreshold",null),f([y()],fp.prototype,"_squaredTouchProximityThreshold",null),fp=f([ge("esri.views.interactive.snapping.SnappingManager")],fp),function(i){i[i.MAIN=0]="MAIN",i[i.SCENE=1]="SCENE"}(hm||(hm={}));const NO="visualization-handle";function Kxt(i){return T(i.scenePoint)}function Cte({coordinateHelper:i,elevationInfo:e}){return i.hasZ()?ns:e}let xo=class extends Pn.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:Do(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){this.activeComponent.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};f([y()],xo.prototype,"activeComponent",void 0),f([y()],xo.prototype,"cancelled",void 0),f([y()],xo.prototype,"history",void 0),f([y()],xo.prototype,"tool",null),f([y()],xo.prototype,"type",void 0),f([y()],xo.prototype,"canUndo",null),f([y()],xo.prototype,"canRedo",null),f([y()],xo.prototype,"onEnd",void 0),f([y()],xo.prototype,"undo",null),f([y()],xo.prototype,"redo",null),f([y()],xo.prototype,"toggleTool",void 0),f([y()],xo.prototype,"addToSelection",void 0),f([y()],xo.prototype,"removeFromSelection",void 0),xo=f([ge("esri.widgets.Sketch.support.OperationHandle")],xo);let AI=class extends xo{};f([y()],AI.prototype,"activeComponent",void 0),AI=f([ge("esri.widgets.Sketch.support.CreateOperationHandle")],AI);let wm=class extends xo{};f([y()],wm.prototype,"activeComponent",void 0),wm=f([ge("esri.widgets.Sketch.support.UpdateOperationHandle")],wm);const Tte={defaultZ:0},VO={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,tool:"transform"};let or=class extends Pn.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._handles=new mi,this._internalGraphicsLayer=new wB({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandles=new mi,this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.labelOptions=new kD,this.layer=null,this.pointSymbol=new wh({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new a2({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new s2({color:[130,130,130,1],width:2}),this._snappingManager=null,this.tooltipOptions=new FD,this.updateGraphics=new _i,this.updateOnGraphicClick=!0,this.updatePointSymbol=new wh({size:10,color:[0,200,255,.5],outline:{color:"black",width:1}}),this.updatePolygonSymbol=new a2({color:[12,207,255,.2],outline:{join:"round",color:[12,207,255],width:2}}),this.updatePolylineSymbol=new s2({color:[12,207,255],width:2}),this.vertexSymbol=new wh({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalAutoOpenEnabled=null,this.defaultCreateOptions=Tte,this.defaultUpdateOptions=VO,this.snappingOptions=new jH}initialize(){this._handles.add([Sn(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),Sn(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(T(this._operationHandle))for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())}),ue(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},hn),ue(()=>this.view,e=>{_t(this._snappingManager),e&&(this._snappingManager=new fp({view:e,options:this.snappingOptions}),e.type==="2d"?Ee(()=>import("./editingTools-27c0aaae.js"),["./editingTools-27c0aaae.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./DrawGraphicTool-5e0248da.js","./HandleOwner-e1406413.js","./reactiveUtils-f41a4e00.js","./quantityFormatUtils-ba1f6cd1.js","./unitUtils-47abac71.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ScaleRangeLayer-271178b7.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./elevationInfoUtils-427916a5.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./automaticLengthMeasurementUtils-24c52b73.js","./intl-f1e98361.js","./messages-be07754e.js","./assets-0b172f07.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./plane-45609588.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./asyncUtils-62e8a185.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url):e.type==="3d"&&(Ee(()=>import("./editingTools-cfa62ab1.js"),["./editingTools-cfa62ab1.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./screenUtils-410d12c0.js","./asyncUtils-62e8a185.js","./quantityFormatUtils-ba1f6cd1.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./messages-be07754e.js","./locale-30120714.js","./TextOverlayItem-a6091360.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./widget-f7489a3f.js","./intl-f1e98361.js","./number-347a3a44.js","./request-d3e98716.js","./assets-0b172f07.js","./Evented-515b9d9c.js","./Promise-dfdee8ba.js","./uuid-73213768.js","./dom-5b7af1bf.js","./automaticLengthMeasurementUtils-24c52b73.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./VerticesVisualElement-dd38c964.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./LineVisualElement-69b2e868.js","./mat4f64-1e28eae0.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./PointVisualElement-685382db.js","./lineSegment-e6f72ff2.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./quatf64-7fd38d64.js","./Octree-1a841545.js","./plane-45609588.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./InterleavedLayout-5e9cf734.js","./BufferView-646ba1de.js","./types-e1c0a5bf.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./RightAngleQuadVisualElement-d5a5e64b.js","./colorUtils-82440b70.js","./manipulatorUtils-302eea16.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./Identifiable-aa6d459d.js","./DrawGraphicTool-5e0248da.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./ScaleRangeLayer-271178b7.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./manipulatorUtils-0cd1c493.js","./Factory-d9ba6160.js","./GraphicManipulator-7826bc29.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./TranslateTooltipInfos-4fb7abcc.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./Cyclical-b66238c6.js","./projection-aa2a8986.js","./sliceToolUtils-d711e2da.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./ExtentTooltipInfos-4b5e4bb7.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url),Ee(()=>import("./GraphicsLayerView3D-c4638a97.js"),["./GraphicsLayerView3D-c4638a97.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./LayerView3D-9d740636.js","./queryForSymbologySnapping-f3902574.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./dehydratedFeatures-4eeb381a.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./GraphicsProcessor-8dba02d6.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./diffUtils-1ac65748.js","./Layer-f0696768.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./Graphics3DObjectStates-2cd67a8a.js","./UniqueValueRenderer-103ec66d.js","./LegendOptions-e65e7a9c.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./compilerUtils-034cacb8.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./jsonUtils-c56f8821.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./MemCache-4b976a8b.js","./deprecate-b9088bd3.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./projection-d7b57a6c.js","./mat4-44a0988f.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OptimizedFeature-3de538c1.js","./optimizedFeatureQueryEngineAdapter-4b9881eb.js","./centroid-13995b22.js","./asyncUtils-62e8a185.js","./PooledRBush-26ba8fba.js","./quickselect-322ec8e1.js","./basicInterfaces-19ed850e.js","./Scheduler-8433672d.js","./projectExtentUtils-9adea3ba.js","./LayerView-b83ced89.js","./Basemap-a8f7f439.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./RelationshipQuery-db5fcd0c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./ItemCache-ee28c7ba.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url)))},hn),ue(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})])}destroy(){this.cancel(),this._handles=_t(this._handles),this._viewHandles=_t(this._viewHandles),this._removeDefaultLayer(),this._snappingManager=_t(this._snappingManager),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){return this.view.type==="3d"?"move":"transform"}get updating(){return this._numUpdating>0}get activeTool(){return this._operationHandle&&this._operationHandle.tool?this._operationHandle.tool:null}get activeComponent(){return this._operationHandle?this._operationHandle.activeComponent:null}get createGraphic(){return!T(this.activeComponent)||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):kt(this.activeComponent.graphic)}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...Tte,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...VO,...e,reshapeOptions:{...VO.reshapeOptions,...e==null?void 0:e.reshapeOptions}})}set snappingOptions(e){T(this._snappingManager)&&(this._snappingManager.options=e),this._set("snappingOptions",e)}get state(){var n;const e=!(!((n=this.view)!=null&&n.ready)||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:r,map:s}=t;r&&(t.cursor=null),s&&s.remove(this._internalGraphicsLayer),this._viewHandles.removeAll(),this.cancel()}const n="view-ready";this._handles.remove(n),e&&this._handles.add(rs(()=>e.ready,r=>{this._viewHandles.removeAll(),r&&this._viewHandles.add(this._generateViewHandles(e))},hn),n),this._set("view",e)}cancel(){this._moduleLoaderAbortController=ll(this._moduleLoaderAbortController),this._viewReadyAbortController=ll(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){const{activeTool:n,layer:r}=this,s=t.toArray();r.removeMany(s),this.cancel(),this._emitDeleteEvent({graphics:s,tool:n})}}async create(e,t){if(this.cancel(),await this._waitViewReady(),this.state==="disabled")throw this.layer||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),this.view||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),js();if(T(this.view.activeTool)&&(this.view.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");mte(this.view,this._internalGraphicsLayer);const n=await this._setupCreateOperation(e,t);if(B(n)||this.destroyed)return void this.view.map.remove(this._internalGraphicsLayer);const r=()=>{if(n===this._operationHandle){const s=this.createGraphic,a=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),n.cancelled||s==null||this.layer.add(s),this.emit("create",{graphic:s,state:a?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};n.on("complete",r),this._operationHandle=n,this.view.ready&&this.view.focus()}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:n,view:r,state:s}=this;if(s==="disabled")throw r||this._logError("sketch:missing-property","Property 'view' is missing on SketchViewModel."),n||this._logError("sketch:missing-property","Property 'layer' is missing on SketchViewModel."),js();T(this.view.activeTool)&&(this.view.activeTool=null);const a=Array.isArray(e)?e:[e];if(e==null||!a||!a.length)return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(a.some(l=>l.layer!==n?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):!!B(l.geometry)&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const o=await this._setupUpdateOperation(a,t);this.destroyed||B(o)||ta(o)||(mte(this.view,this._internalGraphicsLayer),this._setUpdateOperationHandle(o,t),this.emit("update",{graphics:a,state:"start",aborted:!1,tool:o.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const t of e)T(t.geometry)&&t.geometry.type!=="mesh"&&!Vc(t.geometry.spatialReference,this.view.spatialReference)&&($y(t.geometry.spatialReference,this.view.spatialReference)||Y0()||await MC(),t.geometry=Bc(t.geometry,this.view.spatialReference));this._endAsyncOperation()}undo(){this.canUndo()&&this._operationHandle.undo()}redo(){this.canRedo()&&this._operationHandle.redo()}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(e){const t=this.view;if(t.type==="2d"){const s=[];this.view.map.allLayers.forEach(o=>{o.type!=="vector-tile"&&o.type!=="imagery"||s.push(o)});const a=await this.view.hitTest(e,{exclude:s});return q1t(a.results)}const n=[this.view.map.ground];t.map.allLayers.forEach(s=>{s.type==="integrated-mesh"&&n.push(s)});const r=await t.hitTest(e,{exclude:n});if(r.results.length>0){const s=r.results[0];if(T(s)&&s.type==="graphic"&&s.graphic&&(!r.ground.mapPoint||t.map.ground.opacity<1||r.ground.distance-Jt(s.distance,0)>-Math.min(3*r.ground.distance,t.viewingMode==="global"?rn(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return s}return null}_generateViewHandles(e){return[e.on("immediate-click",async t=>{const n=this.state==="active"&&this._operationHandle.type==="create";if(this.state==="disabled"||n||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const r=await t.async(()=>this._getFirstHit(Cr(t)));let s=null;if(T(r)){const a=r.graphic;this.updateGraphics.includes(a)||a.layer===this.layer?(t.stopPropagation(),s=a):e.type!=="2d"||this._isComponentGraphic(a)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();T(s)&&!this.updateGraphics.includes(s)&&await this.update([s],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},Pt.WIDGET)]}async _setupCreateOperation(e,t){const n={hasZ:this.view.type==="3d",...this.defaultCreateOptions,...t},r=await this._setupDrawGraphicTool(e,this.view,n);return B(r)?null:(this.view.tools.add(r),this.view.activeTool=r,this._setupCreateOperationHandle(r))}async _setupDrawGraphicTool(e,t,n){if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;const r=e!=="rectangle",s=e!=="rectangle";this.snappingOptions.enabledToggled=!1;const a={view:t,mode:e==="rectangle"||e==="circle"?"hybrid":"click",...n,snapToScene:!1,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),snappingManager:this._snappingManager,forceUniformSize:s,centered:r};return this.view.type==="2d"?this._makeDrawGraphicTool2D(a):this._makeDrawGraphicTool3D(a)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(Ee(()=>import("./editingTools-27c0aaae.js"),["./editingTools-27c0aaae.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./DrawGraphicTool-5e0248da.js","./HandleOwner-e1406413.js","./reactiveUtils-f41a4e00.js","./quantityFormatUtils-ba1f6cd1.js","./unitUtils-47abac71.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ScaleRangeLayer-271178b7.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./elevationInfoUtils-427916a5.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./automaticLengthMeasurementUtils-24c52b73.js","./intl-f1e98361.js","./messages-be07754e.js","./assets-0b172f07.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./plane-45609588.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec2-2cef68de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./asyncUtils-62e8a185.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));return ta(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:Yxt(e.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(Ee(()=>import("./editingTools-cfa62ab1.js"),["./editingTools-cfa62ab1.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./screenUtils-410d12c0.js","./asyncUtils-62e8a185.js","./quantityFormatUtils-ba1f6cd1.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./messages-be07754e.js","./locale-30120714.js","./TextOverlayItem-a6091360.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./widget-f7489a3f.js","./intl-f1e98361.js","./number-347a3a44.js","./request-d3e98716.js","./assets-0b172f07.js","./Evented-515b9d9c.js","./Promise-dfdee8ba.js","./uuid-73213768.js","./dom-5b7af1bf.js","./automaticLengthMeasurementUtils-24c52b73.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./VerticesVisualElement-dd38c964.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./LineVisualElement-69b2e868.js","./mat4f64-1e28eae0.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./PointVisualElement-685382db.js","./lineSegment-e6f72ff2.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./quatf64-7fd38d64.js","./Octree-1a841545.js","./plane-45609588.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./InterleavedLayout-5e9cf734.js","./BufferView-646ba1de.js","./types-e1c0a5bf.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./RightAngleQuadVisualElement-d5a5e64b.js","./colorUtils-82440b70.js","./manipulatorUtils-302eea16.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./Identifiable-aa6d459d.js","./DrawGraphicTool-5e0248da.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./ScaleRangeLayer-271178b7.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./manipulatorUtils-0cd1c493.js","./Factory-d9ba6160.js","./GraphicManipulator-7826bc29.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./TranslateTooltipInfos-4fb7abcc.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./Cyclical-b66238c6.js","./projection-aa2a8986.js","./sliceToolUtils-d711e2da.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./ExtentTooltipInfos-4b5e4bb7.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));if(ta(t)||this.destroyed)return null;const{elevationInfo:n}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:n,snapToScene:!T(n)||n.mode==="absolute-height",labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(e){let t=null;const n=e.forceUniformSize,r=e.centered,s=[this.view.on("key-down",o=>{if(o.key===fi.pan)o.stopPropagation(),o.repeat||(e.enabled=!1);else if(o.key===fi.complete)o.stopPropagation(),e.completeCreateOperation();else if(o.key!==fi.vertexAdd||o.repeat)o.key===fi.undo?(o.stopPropagation(),a.undo()):o.key===fi.redo?(o.stopPropagation(),a.redo()):o.key!==fi.snappingToggle||e.geometryType==="rectangle"||e.geometryType==="circle"||o.repeat?o.key!==fi.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||o.repeat?o.key===fi.center&&(o.repeat||(e.centered=!r,o.stopPropagation())):(e.forceUniformSize=!n,o.stopPropagation()):(this.snappingOptions.enabledToggled=!0,o.stopPropagation());else{const l=e.drawOperation.geometryType;l!=="polyline"&&l!=="polygon"&&l!=="multipoint"||(o.stopPropagation(),e.drawOperation.commitStagedVertex())}},Pt.WIDGET),this.view.on("key-up",o=>{o.key===fi.pan?e.enabled=!0:o.key===fi.snappingToggle&&e.geometryType!=="rectangle"&&e.geometryType!=="circle"?(this.snappingOptions.enabledToggled=!1,o.stopPropagation()):o.key!==fi.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?o.key===fi.center&&(e.centered=r,o.stopPropagation()):(e.forceUniformSize=n,o.stopPropagation())},Pt.WIDGET),e.on("vertex-add",o=>{switch(t=B(t)?"start":"active",o.operation){case"apply":this.emit("create",{graphic:kt(e.graphic),state:t,tool:this.activeTool,toolEventInfo:o,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[kt(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[kt(e.graphic)],tool:e.geometryType})}}),e.on("cursor-update",o=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:kt(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:{coordinates:o.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",o=>{switch(o.operation){case"apply":this.emit("create",{graphic:kt(e.graphic),state:"active",tool:this.activeTool,toolEventInfo:o,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[kt(e.graphic)],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[kt(e.graphic)],tool:e.geometryType})}}),e.on("complete",o=>{this._set("createGraphic",kt(o.graphic)),t="complete",o.aborted?a&&a.cancel():a&&a.complete()}),ue(()=>this._getGraphicSymbolFromTool(e.geometryType),o=>{e.graphicSymbol=o})],a=new AI({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var o;s.forEach(l=>l.remove()),s.length=0,(o=this.view.tools)==null||o.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return a}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;default:return null}}async _setupUpdateOperation(e,t){const{layer:n,view:r}=this,s={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t==null?void 0:t.reshapeOptions}};let a=s.tool;for(const o of e)n.remove(o),n.add(o);if(r.type==="3d"){if(e.length===0)return null;switch(a){case"move":return this._setupMove3DOperation(e,s,r,a);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const o=DO(e[0]);return o===Kn.SUPPORTED?this._setupReshape3DOperation(e[0],s,r):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${rN(o)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(e,s,r)}}switch(a){case"move":return this._setupMove2DOperation(e,s,r);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const o=DO(e[0]);return o===Kn.SUPPORTED?this._setupTransformOrReshape2DOperation(e,a,s,r):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${rN(o)}).`),null)}case"transform":if(e.length===1){const o=ms(e[0].geometry,"type");o!=="point"&&o!=="multipoint"||(a="reshape")}return this._setupTransformOrReshape2DOperation(e,a,s,r)}}async _setupMove3DOperation(e,t,n,r,s=!1){for(const u of e){const d=Qwt(u);if(d!==Kn.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${rN(d)}).`),null}const a=await this._requireModule(Ee(()=>import("./editingTools-cfa62ab1.js"),["./editingTools-cfa62ab1.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./screenUtils-410d12c0.js","./asyncUtils-62e8a185.js","./quantityFormatUtils-ba1f6cd1.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./messages-be07754e.js","./locale-30120714.js","./TextOverlayItem-a6091360.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./widget-f7489a3f.js","./intl-f1e98361.js","./number-347a3a44.js","./request-d3e98716.js","./assets-0b172f07.js","./Evented-515b9d9c.js","./Promise-dfdee8ba.js","./uuid-73213768.js","./dom-5b7af1bf.js","./automaticLengthMeasurementUtils-24c52b73.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./VerticesVisualElement-dd38c964.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./LineVisualElement-69b2e868.js","./mat4f64-1e28eae0.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./PointVisualElement-685382db.js","./lineSegment-e6f72ff2.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./quatf64-7fd38d64.js","./Octree-1a841545.js","./plane-45609588.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./InterleavedLayout-5e9cf734.js","./BufferView-646ba1de.js","./types-e1c0a5bf.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./RightAngleQuadVisualElement-d5a5e64b.js","./colorUtils-82440b70.js","./manipulatorUtils-302eea16.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./Identifiable-aa6d459d.js","./DrawGraphicTool-5e0248da.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./ScaleRangeLayer-271178b7.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./manipulatorUtils-0cd1c493.js","./Factory-d9ba6160.js","./GraphicManipulator-7826bc29.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./TranslateTooltipInfos-4fb7abcc.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./Cyclical-b66238c6.js","./projection-aa2a8986.js","./sliceToolUtils-d711e2da.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./ExtentTooltipInfos-4b5e4bb7.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));if(ta(a))return a;const o=new a.module.GraphicMoveTool({view:n,enableZ:t.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(o),o.graphics.addMany(e),s||this.updateGraphics.addMany(e);const l=[],c=new wm({activeComponent:o,tool:r,type:"update",onEnd:()=>{var u;l.forEach(d=>d.remove()),l.length=0,(u=this.view.tools)==null||u.remove(o),o.destroyed||o.destroy()},undo:()=>{BO(c,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{zO(c,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:u=>{this.updateGraphics.push(u),o.graphics.push(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const d=this.updateGraphics.indexOf(u);c.history.undo.forEach(h=>h.updates.splice(d,1)),c.history.redo.forEach(h=>h.updates.splice(d,1)),this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?o.graphics.remove(u):c.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||r!=="transform")return;const u=this.updateGraphics.getItemAt(0);if(DO(u)!==Kn.SUPPORTED)return;const d=await this._setupReshape3DOperation(u,t,n,!0);ta(d)||(c.onEnd(),c.destroy(),this._setUpdateOperationHandle(d,t))}});return l.push(...this._getHandlesForComponent(c,t),this.view.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(c,u,t),Pt.WIDGET),n.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(c,u),u.key===fi.snappingToggle&&(this.snappingOptions.enabledToggled=!0,u.stopPropagation())},Pt.WIDGET),n.on("key-up",u=>{u.key===fi.snappingToggle&&(this.snappingOptions.enabledToggled=!1,u.stopPropagation())},Pt.WIDGET)),c}_setupGraphicTransform3DOperation(e,t,n,r=!1){if(e.length===1&&rxt(e[0])===Kn.SUPPORTED){const s=e[0],a=s.geometry;if(T(a)&&(a.type==="point"||a.type==="mesh"))return this._setupPointTransform3DOperation(s,t,n);if(T(a)&&(a.type==="polygon"||a.type==="polyline"))return this._setupPolyTransform3DOperation(s,t,n,r)}return this._setupMove3DOperation(e,t,n,"transform",r)}async _setupPointTransform3DOperation(e,t,n){const r="transform",{enableRotation:s,enableScaling:a,enableZ:o}=t,l=await this._requireModule(Ee(()=>import("./editingTools-cfa62ab1.js"),["./editingTools-cfa62ab1.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./screenUtils-410d12c0.js","./asyncUtils-62e8a185.js","./quantityFormatUtils-ba1f6cd1.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./messages-be07754e.js","./locale-30120714.js","./TextOverlayItem-a6091360.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./widget-f7489a3f.js","./intl-f1e98361.js","./number-347a3a44.js","./request-d3e98716.js","./assets-0b172f07.js","./Evented-515b9d9c.js","./Promise-dfdee8ba.js","./uuid-73213768.js","./dom-5b7af1bf.js","./automaticLengthMeasurementUtils-24c52b73.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./VerticesVisualElement-dd38c964.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./LineVisualElement-69b2e868.js","./mat4f64-1e28eae0.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./PointVisualElement-685382db.js","./lineSegment-e6f72ff2.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./quatf64-7fd38d64.js","./Octree-1a841545.js","./plane-45609588.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./InterleavedLayout-5e9cf734.js","./BufferView-646ba1de.js","./types-e1c0a5bf.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./RightAngleQuadVisualElement-d5a5e64b.js","./colorUtils-82440b70.js","./manipulatorUtils-302eea16.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./Identifiable-aa6d459d.js","./DrawGraphicTool-5e0248da.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./ScaleRangeLayer-271178b7.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./manipulatorUtils-0cd1c493.js","./Factory-d9ba6160.js","./GraphicManipulator-7826bc29.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./TranslateTooltipInfos-4fb7abcc.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./Cyclical-b66238c6.js","./projection-aa2a8986.js","./sliceToolUtils-d711e2da.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./ExtentTooltipInfos-4b5e4bb7.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));if(ta(l))return l;const c=new l.module.GraphicTransformTool({graphic:e,view:n,enableRotation:s,enableScaling:a,enableZ:o,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});this.view.tools.add(c),this.updateGraphics.add(e);const u=[],d=new wm({activeComponent:c,tool:r,type:"update",onEnd:()=>{var h;u.forEach(p=>p.remove()),u.length=0,(h=this.view.tools)==null||h.remove(c),c.destroyed||c.destroy()},undo:()=>{BO(d,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},redo:()=>{zO(d,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async h=>{this.updateGraphics.add(h),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[h],removed:[],type:"selection-change"},type:"update"});const p=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);ta(p)||(d.onEnd(),d.destroy(),this._setUpdateOperationHandle(p,t))},removeFromSelection:h=>{this.updateGraphics.remove(h),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[h],type:"selection-change"},type:"update"}),d.complete()},toggleTool:()=>{}});return u.push(...this._getHandlesForComponent(d,t),this.view.on("immediate-click",h=>this._getCommonUpdateOperationClickHandlers(d,h,t),Pt.WIDGET),n.on("key-down",h=>{this._getCommonUpdateOperationKeyDownHandlers(d,h),h.key===fi.snappingToggle&&(this.snappingOptions.enabledToggled=!0,h.stopPropagation())},Pt.WIDGET),n.on("key-up",h=>{h.key===fi.snappingToggle&&(this.snappingOptions.enabledToggled=!1,h.stopPropagation())},Pt.WIDGET)),d}async _setupPolyTransform3DOperation(e,t,n,r=!1){const s="transform",{enableRotation:a,enableScaling:o,enableZ:l,preserveAspectRatio:c}=t,u=await this._requireModule(Ee(()=>import("./editingTools-cfa62ab1.js"),["./editingTools-cfa62ab1.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./screenUtils-410d12c0.js","./asyncUtils-62e8a185.js","./quantityFormatUtils-ba1f6cd1.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./messages-be07754e.js","./locale-30120714.js","./TextOverlayItem-a6091360.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./widget-f7489a3f.js","./intl-f1e98361.js","./number-347a3a44.js","./request-d3e98716.js","./assets-0b172f07.js","./Evented-515b9d9c.js","./Promise-dfdee8ba.js","./uuid-73213768.js","./dom-5b7af1bf.js","./automaticLengthMeasurementUtils-24c52b73.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./VerticesVisualElement-dd38c964.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./LineVisualElement-69b2e868.js","./mat4f64-1e28eae0.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./PointVisualElement-685382db.js","./lineSegment-e6f72ff2.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./quatf64-7fd38d64.js","./Octree-1a841545.js","./plane-45609588.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./InterleavedLayout-5e9cf734.js","./BufferView-646ba1de.js","./types-e1c0a5bf.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./RightAngleQuadVisualElement-d5a5e64b.js","./colorUtils-82440b70.js","./manipulatorUtils-302eea16.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./Identifiable-aa6d459d.js","./DrawGraphicTool-5e0248da.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./ScaleRangeLayer-271178b7.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./manipulatorUtils-0cd1c493.js","./Factory-d9ba6160.js","./GraphicManipulator-7826bc29.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./TranslateTooltipInfos-4fb7abcc.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./Cyclical-b66238c6.js","./projection-aa2a8986.js","./sliceToolUtils-d711e2da.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./ExtentTooltipInfos-4b5e4bb7.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));if(ta(u))return u;const d=new u.module.ExtentTransformTool({graphic:e,view:n,enableRotation:a,enableScaling:o,enableZ:l,preserveAspectRatio:c,tooltipOptions:this.tooltipOptions});this.view.tools.add(d),r||this.updateGraphics.add(e);const h=[],p=new wm({activeComponent:d,tool:s,type:"update",onEnd:()=>{var m;h.forEach(g=>g.remove()),h.length=0,(m=this.view.tools)==null||m.remove(d),d.destroyed||d.destroy()},canUndo:()=>d.canUndo,undo:()=>{d.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},canRedo:()=>d.canRedo,redo:()=>{d.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:async m=>{this.updateGraphics.add(m),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[m],removed:[],type:"selection-change"},type:"update"});const g=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);ta(g)||(p.onEnd(),p.destroy(),this._setUpdateOperationHandle(g,t))},removeFromSelection:m=>{this.updateGraphics.remove(m),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[m],type:"selection-change"},type:"update"}),p.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;const m=this.updateGraphics.getItemAt(0);if(DO(m)!==Kn.SUPPORTED)return;const g=await this._setupReshape3DOperation(m,t,n,!0);ta(g)||(p.onEnd(),p.destroy(),this._setUpdateOperationHandle(g,t))}});return h.push(...this._getHandlesForComponent(p,t),this.view.on("immediate-click",m=>this._getCommonUpdateOperationClickHandlers(p,m,t),Pt.WIDGET),this.view.on("key-down",m=>this._getCommonUpdateOperationKeyDownHandlers(p,m),Pt.WIDGET),this.view.on("key-down",m=>{m.key!==fi.constraint||m.repeat||(d.preserveAspectRatio=!d.preserveAspectRatio,m.stopPropagation())},Pt.WIDGET),this.view.on("key-up",m=>{m.key===fi.constraint&&(d.preserveAspectRatio=!d.preserveAspectRatio,m.stopPropagation())},Pt.WIDGET)),p}async _setupMove2DOperation(e,t,n){const r="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=await this._getGraphicMover(e,t,n);if(ta(s))return s;const a=new wm({activeComponent:s,tool:r,type:"update",onEnd:()=>{var u;this._displayDefaultCursor(),c.forEach(d=>d.remove()),l.forEach(d=>d.remove()),c=[],l=[],s.destroy(),(u=this._internalGraphicsLayer)==null||u.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const u=this.updateGraphics.toArray();BO(a,u),a.refreshComponent(),this._emitUndoEvent({graphics:u,tool:r})},redo:()=>{const u=this.updateGraphics.toArray();zO(a,u),a.refreshComponent(),this._emitRedoEvent({graphics:u,tool:r})},addToSelection:async u=>{await this._updateSpatialReference(u),this.updateGraphics.push(u),s.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:u=>{const d=this.updateGraphics.indexOf(u);a.history.undo.forEach(p=>p.updates.splice(d,1)),a.history.redo.forEach(p=>p.updates.splice(d,1)),this.updateGraphics.remove(u);const h=this.updateGraphics.toArray();this.emit("update",{graphics:h,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?s.graphics=h:a.complete()}});let o=!1,l=[n.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(a,u,t),Pt.WIDGET),n.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(a,u),u.key!==fi.constraint||u.repeat||(o=!0,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},Pt.WIDGET),n.on("key-up",u=>{u.key===fi.constraint&&o&&(o=!1,s.enableMoveAllGraphics=!s.enableMoveAllGraphics)},Pt.WIDGET)],c=this._getHandlesForComponent(a,t);return a}async _setupReshape3DOperation(e,t,n,r=!1){const s="reshape",a=await this._requireModule(Ee(()=>import("./editingTools-cfa62ab1.js"),["./editingTools-cfa62ab1.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./reactiveUtils-f41a4e00.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./elevationInfoUtils-427916a5.js","./ElevationInfo-ce9cacc2.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./screenUtils-410d12c0.js","./asyncUtils-62e8a185.js","./quantityFormatUtils-ba1f6cd1.js","./vec2-2cef68de.js","./vec2f64-30dc1443.js","./messages-be07754e.js","./locale-30120714.js","./TextOverlayItem-a6091360.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./widget-f7489a3f.js","./intl-f1e98361.js","./number-347a3a44.js","./request-d3e98716.js","./assets-0b172f07.js","./Evented-515b9d9c.js","./Promise-dfdee8ba.js","./uuid-73213768.js","./dom-5b7af1bf.js","./automaticLengthMeasurementUtils-24c52b73.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./projection-d7b57a6c.js","./SimpleObservable-7dcdef1d.js","./mat4-44a0988f.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./VerticesVisualElement-dd38c964.js","./EffectView-d3bf37ed.js","./mat3-3fc68e72.js","./TileKey-0750ad58.js","./context-util-1e3c8cfc.js","./enums-64ab819c.js","./Texture-e79b14e7.js","./VertexElementDescriptor-2925c6af.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./LineVisualElement-69b2e868.js","./mat4f64-1e28eae0.js","./basicInterfaces-19ed850e.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./FramebufferObject-50e1b68f.js","./ShaderBuilder-93e8045e.js","./mat3f64-c6305894.js","./aaBoundingBox-fc742a4e.js","./ViewingMode-5d7d590b.js","./Util-a48361c6.js","./vec4f64-e407da96.js","./PointVisualElement-685382db.js","./lineSegment-e6f72ff2.js","./sphere-4f5e644f.js","./byteSizeEstimations-f0cab514.js","./quatf64-7fd38d64.js","./Octree-1a841545.js","./plane-45609588.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./InterleavedLayout-5e9cf734.js","./BufferView-646ba1de.js","./types-e1c0a5bf.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./compilerUtils-034cacb8.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./Version-9baeb7ac.js","./quat-5b263584.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./RightAngleQuadVisualElement-d5a5e64b.js","./colorUtils-82440b70.js","./manipulatorUtils-302eea16.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./jsonUtils-03c4af61.js","./Field-f5fc9f6b.js","./enumeration-3c281341.js","./fieldType-b1002185.js","./Identifiable-aa6d459d.js","./DrawGraphicTool-5e0248da.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./HandleOwner-e1406413.js","./GraphicsLayer-10573c27.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./ScaleRangeLayer-271178b7.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./manipulatorUtils-0cd1c493.js","./Factory-d9ba6160.js","./GraphicManipulator-7826bc29.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./TranslateTooltipInfos-4fb7abcc.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./Cyclical-b66238c6.js","./projection-aa2a8986.js","./sliceToolUtils-d711e2da.js","./persistable-19c823da.js","./multiOriginJSONSupportUtils-c978f4c3.js","./ExtentTooltipInfos-4b5e4bb7.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./HUDMaterial.glsl-4bf3c7df.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));if(ta(a))return a;this.snappingOptions.enabledToggled=!1;const o=new a.module.GraphicReshapeTool({view:n,graphic:e,enableZVertex:t.enableZ&&t.reshapeOptions.vertexOperation==="move",enableZShape:t.enableZ&&t.reshapeOptions.shapeOperation==="move",enableMoveGraphic:t.reshapeOptions.shapeOperation==="move"||t.reshapeOptions.shapeOperation==="move-xy",enableMidpoints:t.reshapeOptions.edgeOperation==="split",enableEdgeOffset:t.reshapeOptions.edgeOperation==="offset",snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});n.tools.add(o),r||this.updateGraphics.add(e);const l=[],c=new wm({activeComponent:o,tool:s,type:"update",onEnd:()=>{var u;l.forEach(d=>d.remove()),l.length=0,(u=this.view.tools)==null||u.remove(o),o.destroyed||o.destroy()},canUndo:()=>o.canUndo,undo:()=>{o.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:s})},canRedo:()=>o.canRedo,redo:()=>{o.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:s})},addToSelection:async u=>{this.updateGraphics.add(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[u],removed:[],type:"selection-change"},type:"update"});const d=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,n,"transform",!0);ta(d)||(c.onEnd(),c.destroy(),this._setUpdateOperationHandle(d,t))},removeFromSelection:u=>{this.updateGraphics.remove(u),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[u],type:"selection-change"},type:"update"}),c.complete()},toggleTool:async()=>{if(t.toggleToolOnClick===!1)return;const u=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,n,!0);ta(u)||(c.onEnd(),c.destroy(),this._setUpdateOperationHandle(u,t))}});return l.push(...this._getHandlesForComponent(c,t),n.on("immediate-click",u=>this._getCommonUpdateOperationClickHandlers(c,u,t),Pt.WIDGET),n.on("key-down",u=>{this._getCommonUpdateOperationKeyDownHandlers(c,u),u.key===fi.snappingToggle&&(this.snappingOptions.enabledToggled=!0,u.stopPropagation())},Pt.WIDGET),n.on("key-up",u=>{u.key===fi.snappingToggle&&(this.snappingOptions.enabledToggled=!1,u.stopPropagation())},Pt.WIDGET)),c}async _setupTransformOrReshape2DOperation(e,t,n,r){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const s=t==="transform"?await this._getBox(e,n,r):await this._getReshape(e,n,r);if(ta(s))return s;const a=new wm({activeComponent:s,type:"update",onEnd:()=>{l.forEach(c=>c.remove()),o.forEach(c=>c.remove()),l=[],o=[],a.activeComponent&&!a.activeComponent.destroyed&&a.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{BO(a,this.updateGraphics.toArray()),a.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:a.tool})},redo:()=>{zO(a,this.updateGraphics.toArray()),a.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:a.tool})},addToSelection:async c=>{let u=a.activeComponent;if(u.type==="reshape"){const d=[...this.updateGraphics,c];this.updateGraphics.removeAll();const h=await this._setupMove2DOperation(d,n,r);if(ta(h))return;a.onEnd(),a.destroy(),this._setUpdateOperationHandle(h,n)}else this.updateGraphics.add(c),u.graphics=this.updateGraphics.toArray(),u.refresh(),a.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[c],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async c=>{const u=this.updateGraphics.indexOf(c);a.history.undo.forEach(h=>h.updates.splice(u,1)),a.history.redo.forEach(h=>h.updates.splice(u,1)),this.updateGraphics.remove(c);const d=this.updateGraphics.toArray();if(d.length===0)a.complete();else{const h=d[0].geometry;d.length!==1||!T(h)||h.type!=="point"&&h.type!=="multipoint"?a.activeComponent.graphics=d:a.toggleTool()}this.emit("update",{graphics:d,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[c],type:"selection-change"},type:"update"})},toggleTool:async()=>{if(this.updateGraphics.length>1)return;const c=this.updateGraphics.getItemAt(0),u=c.geometry;if(T(u)&&(a.tool==="reshape"&&(u.type==="point"||u.type==="multipoint")||a.tool==="transform"&&u.type==="extent"))return;let d=null;a.tool==="transform"?d=await this._getReshape([c],n,r):a.tool==="reshape"&&(d=await this._getBox([c],n,r)),ta(d)||(a.activeComponent.destroy(),a.activeComponent=d,a.activeComponent&&(l.forEach(h=>h.remove()),l=this._getHandlesForComponent(a,n)))}});let o=[r.on("immediate-click",c=>this._getCommonUpdateOperationClickHandlers(a,c,n),Pt.WIDGET),r.on("key-down",c=>{if(this._getCommonUpdateOperationKeyDownHandlers(a,c),c.key!==fi.snappingToggle||c.repeat||(this.snappingOptions.enabledToggled=!0,c.stopPropagation()),c.key===fi.constraint&&!c.repeat&&a){const u=a.activeComponent;u&&u.type==="box"&&(u.preserveAspectRatio=!u.preserveAspectRatio)}},Pt.WIDGET),r.on("key-up",c=>{var u;if(c.key===fi.snappingToggle&&((u=a==null?void 0:a.activeComponent)==null?void 0:u.type)==="reshape"&&(this.snappingOptions.enabledToggled=!1,c.stopPropagation()),c.key===fi.constraint&&a){const d=a.activeComponent;d&&d.type==="box"&&(d.preserveAspectRatio=!d.preserveAspectRatio)}},Pt.WIDGET)],l=this._getHandlesForComponent(a,n);return a}async _getGraphicMover(e,t,n){const{enableMoveAllGraphics:r}=t,s=await this._requireModule(Ee(()=>import("./GraphicMover-5e891e04.js").then(a=>a.G),["./GraphicMover-5e891e04.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./enumeration-3c281341.js","./jsonMap-c1f958cf.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./geometry-5a216427.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./Clonable-ba795b08.js","./reactiveUtils-f41a4e00.js","./GraphicsLayer-10573c27.js","./HandleOwner-e1406413.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ScaleRangeLayer-271178b7.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./number-347a3a44.js","./jsonUtils-03c4af61.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./GraphicManipulator-7826bc29.js","./vec2-2cef68de.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./elevationInfoUtils-427916a5.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js"],import.meta.url));return ta(s)?s:new s.module.default({enableMoveAllGraphics:r,highlightsEnabled:!0,indicatorsEnabled:!1,graphics:e,view:n,callbacks:{onGraphicMoveStart:({dx:a,dy:o,graphic:l})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:o,mover:l,type:"move-start"},type:"update"})},onGraphicMove:({dx:a,dy:o,graphic:l})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:o,mover:l,type:"move"},type:"update"}),onGraphicMoveStop:({dx:a,dy:o,graphic:l})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:a,dy:o,mover:l,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,n){const{enableRotation:r,enableScaling:s,preserveAspectRatio:a}=t,o=await this._requireModule(Ee(()=>import("./Box-fce7fdd1.js"),["./Box-fce7fdd1.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./quantityFormatUtils-ba1f6cd1.js","./unitUtils-47abac71.js","./reactiveUtils-f41a4e00.js","./GraphicMover-5e891e04.js","./GraphicsLayer-10573c27.js","./HandleOwner-e1406413.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ScaleRangeLayer-271178b7.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./GraphicManipulator-7826bc29.js","./vec2-2cef68de.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./elevationInfoUtils-427916a5.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./ExtentTooltipInfos-4b5e4bb7.js","./automaticLengthMeasurementUtils-24c52b73.js","./intl-f1e98361.js","./messages-be07754e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./TranslateTooltipInfos-4fb7abcc.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./compilerUtils-034cacb8.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./byteSizeEstimations-f0cab514.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./vec4f64-e407da96.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2f64-30dc1443.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./sphere-4f5e644f.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./View.glsl-8b12b8c2.js","./ShaderBuilder-93e8045e.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./VertexAttribute-9c5c630d.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./quat-5b263584.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));return ta(o)?o:new o.module.default({graphics:e,enableRotation:r,enableScaling:s,preserveAspectRatio:a,layer:this._internalGraphicsLayer,view:n,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMove:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMoveStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScale:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotate:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"})}})}async _getReshape(e,t,n){var o,l;const r=((o=t.reshapeOptions)==null?void 0:o.edgeOperation)==="split",s=((l=t.reshapeOptions)==null?void 0:l.shapeOperation)==="move",a=await this._requireModule(Ee(()=>import("./Reshape-ab8f3ab2.js"),["./Reshape-ab8f3ab2.js","./cast-7928d7aa.js","./typedArrayUtil-a8b5b3e9.js","./string-cdf077e6.js","./Error-653283ae.js","./ensureType-cf29afa9.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./asyncUtils-62e8a185.js","./quantityFormatUtils-ba1f6cd1.js","./unitUtils-47abac71.js","./reactiveUtils-f41a4e00.js","./GraphicsLayer-10573c27.js","./HandleOwner-e1406413.js","./Layer-f0696768.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./mat4f32-77b3d8ac.js","./mat4-44a0988f.js","./ScaleRangeLayer-271178b7.js","./ElevationInfo-ce9cacc2.js","./lengthUtils-d2d33f94.js","./ViewingMode-5d7d590b.js","./GraphicMover-5e891e04.js","./GraphicManipulator-7826bc29.js","./vec2-2cef68de.js","./projection-d7b57a6c.js","./assets-0b172f07.js","./zscale-1e1fc911.js","./elevationInfoUtils-427916a5.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./jsonUtils-d7db3dc7.js","./automaticLengthMeasurementUtils-24c52b73.js","./intl-f1e98361.js","./messages-be07754e.js","./widget-f7489a3f.js","./uuid-73213768.js","./dom-5b7af1bf.js","./euclideanLengthMeasurementUtils-3ebdcf15.js","./measurementUtils-c86e49dc.js","./geometryEngine-62e3ccf4.js","./geometryEngineBase-3dd302e0.js","./hydrated-be86c8b3.js","./TranslateTooltipInfos-4fb7abcc.js","./automaticAreaMeasurementUtils-d516ac98.js","./euclideanAreaMeasurementUtils-0db711c3.js","./earcut-58237617.js","./plane-45609588.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./mat3f64-c6305894.js","./mat4f64-1e28eae0.js","./quatf64-7fd38d64.js","./vec2f64-30dc1443.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./mat3-3fc68e72.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./enums-64ab819c.js","./Version-9baeb7ac.js","./quat-5b263584.js","./compilerUtils-034cacb8.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./VisualVariablePassParameters-5807c7dc.js","./VertexAttribute-9c5c630d.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./context-util-1e3c8cfc.js","./ShaderBuilder-93e8045e.js","./basicInterfaces-19ed850e.js","./Util-a48361c6.js","./lineSegment-e6f72ff2.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./ScreenSpacePass-00f8c8a4.js","./Float4PassUniform-3a47b7b3.js","./Texture2DPassUniform-6e8ae673.js","./InterleavedLayout-5e9cf734.js","./Matrix3PassUniform-da8eddae.js","./MixExternalColor.glsl-25f0049c.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./vec3f32-c9aa289f.js","./View.glsl-8b12b8c2.js","./ShaderTechniqueConfiguration-9f5b4555.js","./symbolColorUtils-604c5345.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DDrawUniform-22924c6f.js","./PiUtils.glsl-0c0898f0.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./OutputHighlight.glsl-7364b03b.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./Normals.glsl-90e28525.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./SSAOBlur.glsl-c6f142fc.js","./ReadLinearDepth.glsl-7ff30f7d.js","./SSAO.glsl-6f3b4065.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./VerticalOffset.glsl-86460edb.js","./MultipassTerrainTest.glsl-e79d40de.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./Basemap-a8f7f439.js","./deprecate-b9088bd3.js","./loadAll-7fd968fe.js","./PortalItem-aa42c739.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Cyclical-b66238c6.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./TileInfo-34f80a8e.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./enums-0fc02184.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./WaterSurface.glsl-fc8a5726.js","./NormalUtils.glsl-a59958d7.js","./HUD.glsl-80cf9a21.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js"],import.meta.url));return ta(a)?a:new a.module.default({enableMidpoints:r,enableMovement:s,graphic:e[0],layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:n,callbacks:{onReshapeStart:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onReshape:c=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...c},type:"update"}),onReshapeStop:({mover:c,type:u})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:c,type:u},type:"update"}),onMoveStart:({dx:c,dy:u,mover:d,type:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:u,mover:d,type:h},type:"update"}),onMove:({dx:c,dy:u,mover:d,type:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:u,mover:d,type:h},type:"update"}),onMoveStop:({dx:c,dy:u,mover:d,type:h})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:c,dy:u,mover:d,type:h},type:"update"}),onVertexAdd:({added:c,type:u,vertices:d})=>{const h=c.map(p=>Ux(p.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:h,vertices:d,type:u},type:"update"})},onVertexRemove:({removed:c,type:u,vertices:d})=>{const h=c.map(p=>Ux(p.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:h,vertices:d,type:u},type:"update"})}}})}_getHandlesForComponent(e,t){const n=e.activeComponent;switch(n.type){case"graphic-mover":return[n.on("graphic-click",({graphic:r,viewEvent:s})=>{var a;(a=s.native)!=null&&a.shiftKey&&(s.stopPropagation(),e.removeFromSelection(r))}),n.on("graphic-move-start",r=>e.addToHistory(Uf(r.allGraphics)))];case"box":return[n.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,t,r)),n.on("move-start",r=>e.addToHistory(Uf(r.graphics))),n.on("rotate-start",r=>e.addToHistory(Uf(r.graphics))),n.on("scale-start",r=>e.addToHistory(Uf(r.graphics)))];case"reshape":return[n.on("graphic-click",r=>this._onTransformOrReshape2DGraphicClick(e,t,r)),n.on("move-start",r=>e.addToHistory(Uf([r.mover]))),n.on("reshape-start",r=>e.addToHistory(Uf([r.graphic]))),n.on("vertex-add",r=>e.addToHistory(Uf([r.oldGraphic]))),n.on("vertex-remove",r=>e.addToHistory(Uf([r.oldGraphic])))];case"move-3d":return[n.on("graphic-move-start",r=>{e.addToHistory(Uf(r.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move-start"},type:"update"})}),n.on("graphic-move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:r.dx,dy:r.dy,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move"},type:"update"})}),n.on("graphic-move-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:r.allGraphics.length>0?r.allGraphics[0]:null,type:"move-stop"},type:"update"})}),n.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,t):e.toggleTool()})];case"transform-3d":return[n.on("record-undo",({record:r})=>{e.addToHistory({updates:[r]})}),n.on("graphic-translate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-start"},type:"update"})}),n.on("graphic-translate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move-stop"},type:"update"})}),n.on("graphic-rotate-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate-start"},type:"update"})}),n.on("graphic-rotate-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate-stop"},type:"update"})}),n.on("graphic-scale-start",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-start"},type:"update"})}),n.on("graphic-scale-stop",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale-stop"},type:"update"})}),n.on("graphic-translate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,dx:r.dxScreen,dy:r.dyScreen,type:"move"},type:"update"})}),n.on("graphic-rotate",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,angle:r.angle,type:"rotate"},type:"update"})}),n.on("graphic-scale",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:r.graphic,xScale:r.xScale,yScale:r.yScale,type:"scale"},type:"update"})}),n.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[n.on("reshape",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("move",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("vertex-add",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("vertex-remove",r=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:r,type:"update"})}),n.on("immediate-click",r=>{r.shiftKey?this._toggleSelection([r.graphic],e,t):e.toggleTool()})];default:return}}_onTransformOrReshape2DGraphicClick(e,t,n){var a;const{graphic:r,viewEvent:s}=n;return(a=s.native)!=null&&a.shiftKey&&r.layer===this.layer?(s.stopPropagation(),e.removeFromSelection(r)):t.toggleToolOnClick?(s.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){this._operationHandle=e;const n=this.view.map;this._disablePopup(t);const r=()=>{if(e===this._operationHandle){const s=this.updateGraphics.toArray(),a=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),n&&n.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:s,state:"complete",aborted:e.cancelled,tool:a,toolEventInfo:null,type:"update"})}};e.on("complete",r)}async _getCommonUpdateOperationClickHandlers(e,t,n){const r=Cr(t),s=await t.async(()=>this._getFirstHit(r));if(B(s))return void e.complete();if(t.native.shiftKey&&this._toggleSelection([s.graphic],e,n))return void t.stopPropagation();this.updateGraphics.includes(s.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,n){const r=!!n.multipleSelectionEnabled;return e.some(s=>s!=null&&!(!r||s.layer!==this.layer)&&(this.updateGraphics.includes(s)?t.removeFromSelection(s):t.addToSelection(s),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const n=t.key;n===fi.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):n===fi.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):n===fi.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&fi.delete.includes(n)&&this._onDeleteKey(t)}_onDeleteKey(e){if(!this._operationHandle||this._operationHandle.type!=="update")return;const t=this.activeComponent,n=this.updateGraphics.toArray();B(t)||t.type==="reshape-3d"||(t.type!=="reshape"||n.length===1&&ms(n[0].geometry,"type")==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){this._internalGraphicsLayer&&(this.view&&this.view.map&&this.view.map.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=_t(this._internalGraphicsLayer))}_isComponentGraphic(e){const{activeComponent:t}=this;return!(!e||B(t))&&(e.attributes&&e.attributes.esriSketchTool||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_displayPointerCursor(){this.view&&this.view.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){this.view&&this.view.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){this.view&&this.view.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,t,n){tt.getLogger(this.declaredClass).error(new Ze(e,t,n))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const n=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:n}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){return{operationHandle:this._operationHandle,defaultUpdateOptions:VO}}wait(){return $u(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){var t;return((t=this.view)==null?void 0:t.type)!=="3d"||this.updateOnGraphicClick||T(e)&&e.toggleToolOnClick}_disablePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view.popup;t&&B(this._originalAutoOpenEnabled)&&(this._originalAutoOpenEnabled=t.autoOpenEnabled,t.autoOpenEnabled=!1)}_restorePopup(e){if(!this._disablePopupEnabled(e))return;const t=this.view.popup;t&&T(this._originalAutoOpenEnabled)&&(t.autoOpenEnabled=this._originalAutoOpenEnabled,this._originalAutoOpenEnabled=null)}async _waitViewReady(){const e=this.view;e&&(ll(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await e2($u(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal))}};function Yxt(i){return i==="polygon"||i==="rectangle"||i==="circle"}function BO(i,e){Nge("undo",i.history.undo,i.history.redo,e)}function zO(i,e){Nge("redo",i.history.redo,i.history.undo,e)}function Nge(i,e,t,n){const r=e.pop().updates,s=[];n.forEach((a,o)=>{const l=r[o];l!=null&&("geometry"in l&&T(l.geometry)&&(s.push({geometry:a.geometry}),a.geometry=l.geometry),"symbol"in l&&T(l.symbol)&&(s.push({symbol:a.symbol}),a.symbol=l.symbol),"undo"in l&&(s.push(l),l[i](a)))}),t.push({updates:s})}function Uf(i){return{updates:i.map(e=>({geometry:e.geometry}))}}function ta(i){return"requireError"in i&&i.requireError==="aborted"}f([y()],or.prototype,"updating",null),f([y()],or.prototype,"_operationHandle",void 0),f([y({readOnly:!0})],or.prototype,"activeTool",null),f([y()],or.prototype,"activeFillSymbol",void 0),f([y()],or.prototype,"activeLineSymbol",void 0),f([y()],or.prototype,"activeVertexSymbol",void 0),f([y()],or.prototype,"allowDeleteKey",void 0),f([y({readOnly:!0})],or.prototype,"createGraphic",null),f([y()],or.prototype,"defaultCreateOptions",null),f([y()],or.prototype,"defaultUpdateOptions",null),f([y({type:kD,nonNullable:!0})],or.prototype,"labelOptions",void 0),f([y()],or.prototype,"layer",void 0),f([y({types:jy})],or.prototype,"pointSymbol",void 0),f([y({types:jy})],or.prototype,"polygonSymbol",void 0),f([y({types:jy})],or.prototype,"polylineSymbol",void 0),f([y({type:jH,nonNullable:!0})],or.prototype,"snappingOptions",null),f([y()],or.prototype,"_snappingManager",void 0),f([y({readOnly:!0})],or.prototype,"state",null),f([y({type:FD,nonNullable:!0})],or.prototype,"tooltipOptions",void 0),f([y({readOnly:!0})],or.prototype,"updateGraphics",void 0),f([y()],or.prototype,"updateOnGraphicClick",void 0),f([y({types:jy})],or.prototype,"updatePointSymbol",void 0),f([y({types:jy})],or.prototype,"updatePolygonSymbol",void 0),f([y({types:jy})],or.prototype,"updatePolylineSymbol",void 0),f([y({types:jy})],or.prototype,"vertexSymbol",void 0),f([y({value:null})],or.prototype,"view",null),or=f([ge("esri.widgets.Sketch.SketchViewModel")],or);const Xxt=or,Vge="esri.widgets.Editor.EditorViewModel",MI=tt.getLogger(Vge),Bge=["create","create-features","update"];function Hf(i,e,t){MI.error(new Ze(i,e,t))}function Zxt(i,e){return i&&i.find(t=>t.layer===e)}let Ps=class extends Ba(Pn.EventedAccessor){constructor(e){super(e),this._sketchGraphicsLayer=new wB({listMode:"hide",internal:!0}),this.activeWorkflow=null,this._activityQueue=[],this.failures=[],this.attachmentsViewModel=new j3({abilities:{editing:!0}}),this.featureFormViewModel=new lge,this.featureTemplatesViewModel=new S8,this.layerInfos=null,this.sketchViewModel=new Xxt({layer:this._sketchGraphicsLayer}),this.spinnerViewModel=new gU}initialize(){this.handles.add([Sn(()=>this.activeWorkflow,"cancel",()=>this.emit("workflow-cancel")),Sn(()=>this.activeWorkflow,"commit",()=>this.emit("workflow-commit")),rs(()=>{var e;return(e=this.view)==null?void 0:e.map},e=>{e.add(this._sketchGraphicsLayer)},At),ue(()=>this.editableItems.toArray(),()=>{const{activeWorkflow:e}=this;if(this.refreshCreationTemplates(),!e)return;const{stepId:t}=e;e.type!=="create"?e.type==="update"&&(t==="awaiting-feature-to-update"&&!this.canUpdate||t==="awaiting-update-feature-candidate"&&!e.data.candidates.some(n=>{const r=this.editableItems.find(s=>s.layer===n.layer);return r&&r.supports.includes("update")}))&&this._cancelWorkflow():t!=="awaiting-feature-creation-info"||this.canCreate||this._cancelWorkflow()})])}destroy(){this._cancelWorkflow().then(()=>{var e;(e=this.view)!=null&&e.map&&this.view.map.remove(this._sketchGraphicsLayer),this.view=null})}get allowedWorkflows(){return this._get("allowedWorkflows")}set allowedWorkflows(e){e&&e.length!==0||(e=[...Bge]),this._set("allowedWorkflows",e)}get canCreate(){return this.editableItems.some(e=>e.supports.includes("create"))}get canUpdate(){return this.editableItems.some(e=>e.supports.includes("update"))}get editableItems(){var a,o,l;const e=(a=this.view)==null?void 0:a.allLayerViews;if(!e)return new _i;const t=(l=(o=this.view)==null?void 0:o.map)==null?void 0:l.editableLayers,n=new Set(t),r=t==null?void 0:t.filter(c=>c.visible&&c.capabilities.operations.supportsAdd&&!c.capabilities.operations.supportsQuery),s=e.filter(c=>n.has(c.layer)).map(({layer:c,suspended:u})=>this._getEditableItemFromLayer(c,u)).reverse();return r==null||r.forEach(c=>s.push(this._getEditableItemFromLayer(c,!1))),s}get labelOptions(){return this.sketchViewModel.labelOptions}set labelOptions(e){this.sketchViewModel.labelOptions=e}get snappingOptions(){return this.sketchViewModel.snappingOptions}set snappingOptions(e){this.sketchViewModel.snappingOptions=e}get state(){if(!this.get("view.ready")||this.editableItems.length===0)return"disabled";const e=this.attachmentsViewModel.mode;if(e==="add")return"adding-attachment";if(e==="edit")return"editing-attachment";const{activeWorkflow:t}=this;return t?t.stepId:"ready"}get syncing(){return this._activityQueue.length>0}get tooltipOptions(){return this.sketchViewModel.tooltipOptions}set tooltipOptions(e){this.sketchViewModel.tooltipOptions=e}set view(e){this.sketchViewModel.view=e,this.spinnerViewModel.view=e,this._set("view",e)}async startCreateWorkflowAtFeatureTypeSelection(){if(Mx(MI,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection"),!this.canCreate)return void Hf("editing:unsupported-workflow","Create workflow is unsupported or disabled.");await this._cancelWorkflow();const e=this._createCreateWorkflow();await e.start(),this._set("activeWorkflow",e)}async startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.startCreateFeaturesWorkflow()}async startCreateWorkflowAtFeatureCreation(e){if(Mx(MI,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation"),!this.canCreate)return void Hf("editing:unsupported-workflow","Create workflow is unsupported or disabled.");await this._cancelWorkflow();const t=this._createCreateWorkflow("awaiting-feature-to-create");t.data.creationInfo=e,await t.start(),this._set("activeWorkflow",t)}async startCreateFeaturesWorkflowAtFeatureCreation(e){return this.startCreateFeaturesWorkflow(e,"creating-features")}async startCreateFeaturesWorkflow(e,t="awaiting-feature-creation-info"){if(!this.canCreate)throw new Ze("editing:unsupported-workflow","Creating features is unsupported or disabled.");await this._cancelWorkflow();const n=this._createCreateFeaturesWorkflow(e,t);await n.start(),this._set("activeWorkflow",n)}async startCreateWorkflowAtFeatureEdit(e){if(Mx(MI,"startCreateWorkflowAtFeatureEdit"),!this.canCreate)return void Hf("editing:unsupported-workflow","Create workflow is unsupported or disabled.");await this._cancelWorkflow();const t=this._createCreateWorkflow("editing-new-feature");t.data.edits.feature=e,await t.start(),this._set("activeWorkflow",t)}async startUpdateWorkflowAtFeatureSelection(){if(!this.canUpdate)return void Hf("editing:unsupported-workflow","Update workflow is unsupported or disabled.");await this._cancelWorkflow();const e=this._createUpdateWorkflow();await e.start(),this._set("activeWorkflow",e)}async startUpdateWorkflowAtMultipleFeatureSelection(e){if(!this.canUpdate)return void Hf("editing:unsupported-workflow","Update workflow is unsupported or disabled.");await this._cancelWorkflow();const t=this._createUpdateWorkflow("awaiting-update-feature-candidate");t.data.candidates=e,await t.start(),this._set("activeWorkflow",t)}async startUpdateWorkflowAtFeatureEdit(e){if(!this.canUpdate)return void Hf("editing:unsupported-workflow","Update workflow is unsupported or disabled.");await this._cancelWorkflow();const t=this._createUpdateWorkflow("editing-existing-feature");t.data.edits.feature=e,await t.start(),this._set("activeWorkflow",t)}async deleteFeatureFromWorkflow(){const{activeWorkflow:e}=this;e&&e.type==="update"?(await this._delete(e.data.edits.feature),await e.reset()):Hf("editing:unsupported-workflow","Deleting requires an active update workflow.")}async cancelWorkflow(e){return this._cancelWorkflow({warn:!0,...e})}refreshCreationTemplates(){const e=[];for(const{layer:t,supports:n}of this.editableItems)t.loaded&&n.includes("create")&&e.push(t);this.featureTemplatesViewModel.layers=e}async _cancelWorkflow(e){const t=this.activeWorkflow;if(!t)return void(e&&e.warn&&Hf("editing:no-active-workflow","There is no active workflow to cancel."));if(!e||e.force!==!1)return this.emit("workflow-cancel"),this._set("activeWorkflow",null),void await t.cancel(e);await t.cancel(e),this._set("activeWorkflow",null)}_createCreateFeaturesWorkflow(e,t){return qwt.create(this,e,t,(n,r,s)=>this._applyEdits(n,r,s),(n,r)=>this._addAttachments(n,r))}_createCreateWorkflow(e){return Ywt.create(this,e,(t,n,r)=>this._applyEdits(t,n,r))}_createUpdateWorkflow(e){return Zwt.create(this,e,(t,n)=>this._applyEdits(t,n))}async _delete(e){const t=e.sourceLayer;"applyEdits"in t&&await this._applyEdits(t,{deleteFeatures:[e]})}_addAttachments(e,t){const n=[];return t==null||t.forEach(r=>n.push(this._addAttachment(e,r.feature,r.attachment))),Promise.all(n)}async _addAttachment(e,t,n){let r=null;return await this._queueOperation(async()=>(r=await e.addAttachment(t,n).catch(s=>{throw(s==null?void 0:s.error)||s}),r)),r}async _applyEdits(e,t,n){let r=null;return await this._queueOperation(async()=>{if(e.capabilities.operations.supportsQuery){const s=await this.view.whenLayerView(e);return r=await e.applyEdits(t,n),await $u(()=>!s.updating),r}return r=await e.applyEdits(t,n),r}),r}_queueOperation(e){this._activityQueue.push(e),this.notifyChange("syncing");const t=(n,r)=>{const s=r.indexOf(n);s>-1&&r.splice(s,1)};return e().then(n=>{if("error"in n&&n.error)throw n.error;if("addFeatureResults"in n){const{addFeatureResults:r,deleteFeatureResults:s,updateFeatureResults:a}=n,o=r.find(l=>!!l.error)||a.find(l=>!!l.error)||s.find(l=>!!l.error);if(o)throw o.error}return n}).catch(n=>{Hf("editing:operation-error","An error occurred.",{error:n});const r={error:n,retry:()=>(t(r,this.failures),this._queueOperation(e)),cancel:()=>{t(r,this.failures)}};this._set("failures",[...this.failures,r])}).then(()=>{t(e,this._activityQueue),this.notifyChange("syncing")})}_getEditableItemFromLayer(e,t=!0){const{data:n,editing:r,operations:s}=e.capabilities,a=Zxt(this.layerInfos,e),o=!(!n.supportsAttachment||a&&a.allowAttachments===!1),l=r.supportsGeometryUpdate&&(!a||a.geometryUpdatesEnabled!==!1),c=!a||a.attributeUpdatesEnabled!==!1;if(t)return{hasAttachments:o,layer:e,supports:[],geometryUpdatesEnabled:l,attributeUpdatesEnabled:c};const u=[];return s.supportsAdd&&(this.allowedWorkflows.includes("create")||this.allowedWorkflows.includes("create-features"))&&(!a||a.enabled!==!1&&a.addEnabled!==!1)&&u.push("create"),s.supportsUpdate&&this.allowedWorkflows.includes("update")&&(!a||a.enabled!==!1&&a.updateEnabled!==!1)&&u.push("update"),(a&&a.deleteEnabled)!==!1&&s.supportsDelete&&u.push("delete"),{hasAttachments:o,layer:e,supports:u,geometryUpdatesEnabled:l,attributeUpdatesEnabled:c}}};f([y({readOnly:!0})],Ps.prototype,"activeWorkflow",void 0),f([y({readOnly:!0})],Ps.prototype,"_activityQueue",void 0),f([y({value:[...Bge]})],Ps.prototype,"allowedWorkflows",null),f([y({readOnly:!0})],Ps.prototype,"canCreate",null),f([y({readOnly:!0})],Ps.prototype,"canUpdate",null),f([y({readOnly:!0})],Ps.prototype,"editableItems",null),f([y({readOnly:!0})],Ps.prototype,"failures",void 0),f([y()],Ps.prototype,"attachmentsViewModel",void 0),f([y()],Ps.prototype,"featureFormViewModel",void 0),f([y()],Ps.prototype,"featureTemplatesViewModel",void 0),f([y()],Ps.prototype,"labelOptions",null),f([y()],Ps.prototype,"layerInfos",void 0),f([y()],Ps.prototype,"sketchViewModel",void 0),f([y()],Ps.prototype,"snappingOptions",null),f([y()],Ps.prototype,"spinnerViewModel",void 0),f([y()],Ps.prototype,"state",null),f([y({readOnly:!0})],Ps.prototype,"syncing",null),f([y()],Ps.prototype,"tooltipOptions",null),f([y()],Ps.prototype,"view",null),Ps=f([ge(Vge)],Ps);const Qxt=Ps,zge={hide:"hide",hideChildren:"hide-children"};function TL(i){if(i)return i.listMode!=null?i.listMode:void 0}function Jxt(i){if(i)return i.minScale!=null?i.minScale:void 0}function eCt(i){if(i)return i.maxScale!=null?i.maxScale:void 0}function tCt(i){if(!i)return"inherited";const e=i.get("layer.capabilities.exportMap.supportsSublayerVisibility");if(typeof e=="boolean")return e?"independent":"inherited";const t=i.get("capabilities.exportMap.supportsSublayerVisibility");return typeof t=="boolean"?t?"independent":"inherited":i.visibilityMode!=null?i.visibilityMode:"independent"}function KH(i){if(i){if(!("type"in i))return"sublayers";if(!(i.listMode===zge.hideChildren||i.type==="wmts"))return i.type==="group"?"layers":"sublayers"}}function iCt(i){const e=i&&(i.get("layer.layer")||i.layer);if(!e)return!1;const t=e.get("capabilities.exportMap.supportsDynamicLayers");return typeof t!="boolean"||t}function YH(i){return TL(i)!==zge.hide}function nCt(i,e){if(!i||isNaN(e))return!1;const t=Jxt(i),n=eCt(i),r=!isNaN(t)&&t>0&&e>t,s=!isNaN(n)&&n>0&&e<n;return r||s}function Uge(i,e){i&&i.sort((t,n)=>{const r=e.indexOf(t.uid),s=e.indexOf(n.uid);return r>s?-1:r<s?1:0})}function rCt(i,e){const t=i==null?void 0:i.layer;if(!t)return;const n=KH(t);n&&Uge(t.get(n),e)}function Ste(i){const e=i==null?void 0:i.layer;return e&&e.type==="group"?e.layers:null}function cN(i,e){var n;const t=(n=i.layer)==null?void 0:n.uid;return t&&e.find(r=>{var s;return((s=r.layer)==null?void 0:s.uid)===t})}function sCt(i){const e=aCt(i)?i:null,t=i==null?void 0:i.parent,n=(t==null?void 0:t.type)==="map-image"&&e.source,r="";return n&&t?{layer:t,title:r,sublayerIds:[n.mapLayerId]}:{layer:i,title:r}}function aCt(i){return!!(i!=null&&i.layer)}var U8;let Sv=U8=class extends dB{constructor(i){super(i),this.displayValueEnabled=!1,this.max=1,this.min=0,this.step=.1,this.type="slider",this.value=null}clone(){return new U8({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,displayValueEnabled:this.displayValueEnabled,max:this.max,min:this.min,step:this.step,value:this.value})}};f([y()],Sv.prototype,"displayValueEnabled",void 0),f([y()],Sv.prototype,"max",void 0),f([y()],Sv.prototype,"min",void 0),f([y()],Sv.prototype,"step",void 0),f([y()],Sv.prototype,"value",void 0),Sv=U8=f([ge("esri.support.Action.ActionSlider")],Sv);const oCt=Sv,Gf={base:"esri-layer-list-panel",content:"esri-layer-list-panel__content",contentLegend:"esri-layer-list-panel__content--legend",contentString:"esri-layer-list-panel__content--string",contentElement:"esri-layer-list-panel__content--html-element",contentWidget:"esri-layer-list-panel__content--widget"},lCt="legends";let Yu=class extends RC(gr){constructor(e,t){super(e,t),this._legend=null,this._handles=new mi,this.content=null,this.image=null,this.listItem=null,this.open=!1,this.visible=!0}initialize(){this.addHandles(ue(()=>this.content,e=>this._createLegend(e),At))}destroy(){const{_legend:e}=this;e&&e.destroy(),this._legend=null}get className(){const{image:e}=this,t=this._getFirstWidget();return this._get("className")||!e&&t?t.iconClass:""}set className(e){this._override("className",e)}get disabled(){var r;const{listItem:e,_legend:t,content:n}=this;return!e||!(Array.isArray(n)&&n.length>1)&&!!t&&(!((r=t.activeLayerInfos)!=null&&r.length)||!e.visibleAtCurrentScale)}set disabled(e){this._overrideIfSome("disabled",e)}get title(){const e=this._getFirstWidget();return this._get("title")||e?e.label:""}set title(e){this._override("title",e)}render(){return z("div",{class:Gf.base},this._renderContents())}_renderContent(e){const{_legend:t,disabled:n}=this;return!e||n?null:e==="legend"&&t?z("div",{class:this.classes(Gf.content,Gf.contentLegend),key:t},t.render()):typeof e=="string"?z("div",{class:this.classes(Gf.content,Gf.contentString),key:e,innerHTML:e}):Bx(e)?z("div",{class:this.classes(Gf.content,Gf.contentWidget),key:e},e.render()):e instanceof HTMLElement?z("div",{class:this.classes(Gf.content,Gf.contentElement),key:e,bind:e,afterCreate:this._attachToNode}):null}_renderContents(){const{content:e}=this;return Array.isArray(e)?e.map(t=>this._renderContent(t)):this._renderContent(e)}_getLegendOptions(){const{listItem:e}=this;if(!e)return{};const{layer:t,view:n}=e;return t&&n?{view:n,layerInfos:[sCt(t)]}:{}}_createLegend(e){this._hasLegend(e)&&!this._legend&&Ee(()=>Promise.resolve().then(()=>YTt),void 0,import.meta.url).then(({default:t})=>{const{_handles:n,listItem:r}=this,s=new t(this._getLegendOptions());this._legend=s,this.notifyChange("className"),this.notifyChange("title");const a=ue(()=>{var o,l;return[r==null?void 0:r.view,r==null?void 0:r.layer,(o=r==null?void 0:r.layer)==null?void 0:o.source,(l=r==null?void 0:r.layer)==null?void 0:l.parent]},()=>this._updateLegend(s),At);n.add(a,lCt),this.scheduleRender()})}_hasLegend(e){const t="legend";return e===t||!!Array.isArray(e)&&e.includes(t)}_attachToNode(e){e.appendChild(this)}_updateLegend(e){e.set(this._getLegendOptions()),this.scheduleRender()}_getWidget(e){return e==="legend"?this._legend:Bx(e)?e:null}_getFirstWidget(){const{content:e}=this;if(Array.isArray(e)){let t=null;return e.some(n=>{const r=this._getWidget(n);return r&&(t=r),!!r}),t}return this._getWidget(e)}};f([y()],Yu.prototype,"_legend",void 0),f([y()],Yu.prototype,"className",null),f([y()],Yu.prototype,"content",void 0),f([y()],Yu.prototype,"disabled",null),f([y()],Yu.prototype,"image",void 0),f([y()],Yu.prototype,"listItem",void 0),f([y()],Yu.prototype,"title",null),f([y()],Yu.prototype,"open",void 0),f([y()],Yu.prototype,"visible",void 0),Yu=f([ge("esri.widgets.LayerList.ListItemPanel")],Yu);const Hge=Yu;var KS;const cCt=_i.ofType({key:"type",defaultKeyValue:"button",base:dB,typeMap:{button:OC,toggle:Fie,slider:oCt}}),Gge=_i.ofType(cCt),UO="layer",uN="child-list-mode",uCt="hide",dCt="esri.widgets.LayerList.ListItem";let Rr=KS=class extends RC(Ba(et)){constructor(i){super(i),this.actionsSections=new Gge,this.actionsOpen=!1,this.checkPublishStatusEnabled=!1,this.children=new(_i.ofType(KS)),this.childrenSortable=!0,this.hidden=!1,this.layer=null,this.layerView=null,this.listItemCreatedFunction=null,this.open=!1,this.panel=null,this.parent=null,this.sortable=!0,this.view=null}initialize(){if(this.handles.add([ue(()=>this.layer,i=>this._watchLayerProperties(i),At),ue(()=>this.checkPublishStatusEnabled,i=>this._updateChildrenPublishing(i),At),ue(()=>this.view,i=>this._updateChildrenView(i),At),ue(()=>this.panel,i=>this._setListItemOnPanel(i),At),ue(()=>[this.layer,this.view],()=>this._getLayerView(),At)]),typeof this.listItemCreatedFunction=="function"){const i={item:this};this.listItemCreatedFunction.call(null,i)}}destroy(){this.view=null}get connectionStatus(){const{layerView:i,publishing:e}=this;if(!e&&i&&"connectionStatus"in i)return i.connectionStatus}get error(){var i;return(i=this.layer)==null?void 0:i.loadError}get incompatible(){const{layerView:i}=this;return!(!i||!("spatialReferenceSupported"in i))&&!i.spatialReferenceSupported}castPanel(i){return this.get("panel.open")&&!i.hasOwnProperty("open")&&(i.open=!0),i?new Hge(i):null}get title(){const i=this.get("layer.layer");return(!i||i&&this.get("layer.layer.loaded"))&&this.get("layer.title")||this.get("layer.attributes.title")||""}set title(i){this._override("title",i)}get publishing(){const{layer:i,checkPublishStatusEnabled:e}=this;return e&&i&&"publishingInfo"in i&&i.publishingInfo.status==="publishing"}get updating(){const{layerView:i,connectionStatus:e,layer:t,publishing:n}=this;return!n&&!e&&(i?i.updating:(t==null?void 0:t.loadStatus)==="loading"||!1)}get visible(){var i;return(i=this.layer)==null?void 0:i.visible}set visible(i){const e=this.layer;e&&(e.visible=i)}get visibleAtCurrentScale(){return!nCt(this.layer,this.get("view.scale"))}get visibilityMode(){return tCt(this.layer)}clone(){return new KS({actionsSections:this.actionsSections.clone(),actionsOpen:this.actionsOpen,checkPublishStatusEnabled:this.checkPublishStatusEnabled,children:this.children.clone(),layer:this.layer,listItemCreatedFunction:this.listItemCreatedFunction,open:this.open,panel:this.panel,title:this.title,view:this.view,visible:this.visible})}_setListItemOnPanel(i){i&&(i.listItem=this)}_updateChildrenPublishing(i){const e=this.children;e&&e.forEach(t=>t.checkPublishStatusEnabled=i)}_updateChildrenView(i){const e=this.children;e&&e.forEach(t=>t.view=i)}_addChildren(i){if(this.handles.remove(uN),this.children.removeAll(),!i)return;i.forEach(t=>{this.handles.add(ue(()=>t.listMode,()=>this._addChildren(i)),uN)});const e=i.filter(t=>TL(t)!==uCt);this.children.addMany(this._makeChildren(e))}_watchSublayerChanges(i){i&&this.handles.add(i.on("change",()=>{this._addChildren(i)}),UO)}_initializeChildLayers(i){this._addChildren(i),this._watchSublayerChanges(i)}_makeChildren(i){return i.map(e=>YH(e)?new KS({layer:e,checkPublishStatusEnabled:this.checkPublishStatusEnabled,listItemCreatedFunction:this.listItemCreatedFunction,parent:this,view:this.view}):null).reverse()}_watchLayerProperties(i){if(!this.handles||(this.handles.remove(UO),this.handles.remove(uN),!i))return;if(this.handles.add(ue(()=>i.listMode,()=>this._watchLayerProperties(i)),UO),TL(i)==="hide-children")return void this.children.removeAll();const e=KH(i);e&&this.handles.add(ue(()=>i[e],()=>{i.hasOwnProperty(e)&&this._initializeChildLayers(i[e])},At),UO)}async _getLayerView(){const{layer:i,view:e}=this;if(i&&e)try{const t=await e.whenLayerView(i);if(t.layer!==this.layer)return;this._set("layerView",t)}catch{}}};f([y({type:Gge})],Rr.prototype,"actionsSections",void 0),f([y()],Rr.prototype,"actionsOpen",void 0),f([y()],Rr.prototype,"checkPublishStatusEnabled",void 0),f([y({type:_i})],Rr.prototype,"children",void 0),f([y()],Rr.prototype,"childrenSortable",void 0),f([y({readOnly:!0})],Rr.prototype,"connectionStatus",null),f([y({readOnly:!0})],Rr.prototype,"error",null),f([y()],Rr.prototype,"hidden",void 0),f([y({readOnly:!0})],Rr.prototype,"incompatible",null),f([y()],Rr.prototype,"layer",void 0),f([y({readOnly:!0})],Rr.prototype,"layerView",void 0),f([y()],Rr.prototype,"listItemCreatedFunction",void 0),f([y()],Rr.prototype,"open",void 0),f([y({type:Hge})],Rr.prototype,"panel",void 0),f([Mr("panel")],Rr.prototype,"castPanel",null),f([y()],Rr.prototype,"parent",void 0),f([y()],Rr.prototype,"sortable",void 0),f([y()],Rr.prototype,"title",null),f([y({readOnly:!0})],Rr.prototype,"publishing",null),f([y({readOnly:!0})],Rr.prototype,"updating",null),f([y()],Rr.prototype,"view",void 0),f([y()],Rr.prototype,"visible",null),f([y({readOnly:!0})],Rr.prototype,"visibleAtCurrentScale",null),f([y({readOnly:!0})],Rr.prototype,"visibilityMode",null),Rr=KS=f([ge(dCt)],Rr);const zD=Rr,Zc={view:"view",viewLayers:"view-layers",mapLayers:"map-layers",layerViews:"layer-views",layerListMode:"layer-list-mode",children:"children"},hCt="hide",Wge=_i.ofType(zD);let Ev=class extends Pn.EventedAccessor{constructor(e){super(e),this._handles=new mi,this.checkPublishStatusEnabled=!1,this.listItemCreatedFunction=null,this.operationalItems=new Wge,this.view=null}initialize(){this._handles.add([ue(()=>{var e;return[this.view,(e=this.view)==null?void 0:e.ready]},()=>this._viewHandles(),At),ue(()=>[this.listItemCreatedFunction,this.checkPublishStatusEnabled],()=>this._recompileList())],Zc.view)}destroy(){this._handles.destroy(),this._handles=null,this.view=null,this.operationalItems.removeAll()}get state(){const e=this.get("view");return this.get("view.ready")?"ready":e?"loading":"disabled"}triggerAction(e,t){e&&!e.disabled&&this.emit("trigger-action",{action:e,item:t})}moveListItem(e,t,n,r){var p,m;const s=e==null?void 0:e.layer;if(!s)return;const a=(m=(p=this.view)==null?void 0:p.map)==null?void 0:m.layers,o=t?Ste(t):a,l=n?Ste(n):a;if(!o||!l)return;const{operationalItems:c}=this,u=(t==null?void 0:t.children)||c,d=(n==null?void 0:n.children)||c,h=l.length-r;e.parent=n||null,u.includes(e)&&u.remove(e),o.includes(s)&&o.remove(s),d.includes(e)||d.add(e,h),l.includes(s)||l.add(s,h)}_createLayerViewHandles(e){const{_handles:t}=this;t.remove(Zc.layerViews),this._compileList(),e&&t.add(e.on("change",()=>this._compileList()),Zc.layerViews)}_createMapLayerHandles(e){const{_handles:t}=this;t.remove(Zc.mapLayers),this._compileList(),e&&t.add(e.on("change",()=>this._compileList()),Zc.mapLayers)}_createListItem(e){const{view:t,listItemCreatedFunction:n,checkPublishStatusEnabled:r}=this;return new zD({checkPublishStatusEnabled:r,layer:e,listItemCreatedFunction:n,view:t})}_removeAllItems(){const{_handles:e,operationalItems:t}=this;t.forEach(n=>{e.remove(`${Zc.children}-${n.uid}`)}),t.removeAll()}_getViewableLayers(e){if(e)return e.filter(t=>TL(t)!==hCt)}_watchLayersListMode(e){const{_handles:t}=this;t.remove(Zc.layerListMode),e&&e.forEach(n=>{"listMode"in n&&t.add(ue(()=>n.listMode,()=>this._compileList()),Zc.layerListMode)})}_compileList(){const e=this.get("view.map.layers");this._watchLayersListMode(e);const t=this._getViewableLayers(e);t&&t.length?(this._createNewItems(t),this._removeItems(t),this._sortItems(t)):this._removeAllItems()}_createNewItems(e){const{operationalItems:t}=this;e.forEach(n=>{t.find(r=>r.layer===n)||t.add(this._createListItem(n))})}_removeItems(e){const{_handles:t,operationalItems:n}=this,r=[];n.forEach(s=>{s&&e&&e.includes(s.layer)||(t.remove(`${Zc.children}-${s.uid}`),r.push(s))}),n.removeMany(r)}_sortItems(e){const{operationalItems:t}=this;t.sort((n,r)=>{const s=e.indexOf(n.layer),a=e.indexOf(r.layer);return s>a?-1:s<a?1:0})}_recompileList(){this._removeAllItems(),this._compileList()}_viewHandles(){const{_handles:e,view:t}=this;e.remove([Zc.mapLayers,Zc.layerViews,Zc.viewLayers]),this._compileList(),t&&t.ready&&e.add([ue(()=>{var n,r;return(r=(n=this.view)==null?void 0:n.map)==null?void 0:r.allLayers},n=>this._createMapLayerHandles(n),At),ue(()=>{var n;return(n=this.view)==null?void 0:n.allLayerViews},n=>this._createLayerViewHandles(n),At)],Zc.viewLayers)}};f([y()],Ev.prototype,"checkPublishStatusEnabled",void 0),f([y()],Ev.prototype,"listItemCreatedFunction",void 0),f([y({type:Wge})],Ev.prototype,"operationalItems",void 0),f([y({readOnly:!0})],Ev.prototype,"state",null),f([y()],Ev.prototype,"view",void 0),Ev=f([ge("esri.widgets.LayerList.LayerListViewModel")],Ev);const XH=Ev,ZH=i=>pCt(i)||fCt(i),pCt=i=>{if(!("type"in i))return!1;switch(i.type){case"feature":case"geojson":case"csv":case"graphics":case"wfs":case"map-notes":case"oriented-imagery":case"scene":case"building-scene":return!0;default:return!1}},fCt=i=>{const e=KH(i);if(i.hasOwnProperty(e)&&T(i[e])){for(const t of i[e])if(ZH(t))return!0}return!1};var H8;let Av=H8=class extends zD{constructor(i){super(i),this.children=new _i}get enabled(){return!!T(this.featureSource)&&this.featureSource.enabled}get featureSource(){const{layer:i,getFeatureSnappingSources:e}=this;return e().find(t=>t.layer===i)}_initializeChildLayers(i){if(!i)return;const e=i.filter(ZH);super._initializeChildLayers(e)}_makeChildren(i){return i.map(e=>YH(e)?new H8({layer:e,parent:this,view:this.view,getFeatureSnappingSources:this.getFeatureSnappingSources}):null).reverse()}};f([y()],Av.prototype,"children",void 0),f([y()],Av.prototype,"enabled",null),f([y({constructOnly:!0})],Av.prototype,"getFeatureSnappingSources",void 0),f([y()],Av.prototype,"featureSource",null),f([y()],Av.prototype,"parent",void 0),Av=H8=f([ge("esri.widgets.support.SnappingControls.SnappingListItem")],Av);let YS=class extends XH{constructor(){super(...arguments),this.featureSnappingSources=new _i}get operationalItemsFlat(){return this.operationalItems.flatten(e=>e.children)}_compileList(){const e=this.get("view.map.layers");if(!e)return;const t=e.filter(ZH);this._watchLayersListMode(t);const n=this._getViewableLayers(t);n&&n.length?(this._createNewItems(n),this._removeItems(n),this._sortItems(n)):this._removeAllItems()}_createListItem(e){return new Av({layer:e,view:this.view,getFeatureSnappingSources:()=>this.featureSnappingSources})}};f([y()],YS.prototype,"featureSnappingSources",void 0),f([y()],YS.prototype,"operationalItems",void 0),YS=f([ge("esri.widgets.support.SnappingControls.SnappingLayerListViewModel")],YS);const mCt="esri.widgets.support.SnappingControls.SnappingControlsViewModel";let Z_=class extends Ba(et){constructor(e){super(e),this.layerListViewModel=new YS,this.snappingOptions=null,this.view=null}initialize(){this.handles.add([ue(()=>({viewModel:this.layerListViewModel,view:this.view}),({viewModel:e,view:t})=>{e.view=t},At),ue(()=>{var e;return{viewModel:this.layerListViewModel,sources:(e=this.snappingOptions)==null?void 0:e.featureSources}},({viewModel:e,sources:t})=>{e.featureSnappingSources=t},At)])}get state(){return this.get("snappingOptions")?"ready":"disabled"}enableSnappingForLayer(e){(this._findSnappingSourceForLayer(e)??this._makeSnappingSourceForLayer(e)).enabled=!0}disableSnappingForLayer(e){const t=this._findSnappingSourceForLayer(e);t&&(t.enabled=!1)}updateEnabledFeatureSources(e){for(const t of this.snappingOptions.featureSources)YH(t.layer)&&(t.enabled=e.includes(t.layer.id))}_findSnappingSourceForLayer(e){return this.snappingOptions.featureSources.find(t=>t.layer.id===e)}_makeSnappingSourceForLayer(e){const{layer:t}=this.layerListViewModel.operationalItemsFlat.find(r=>r.layer.id===e);if(!t)throw new Ze("snapping-controls:layer-not-found",`cannot enable snapping for layer with id ${e} because no such layer was found in the view`);const n=new DH({layer:t});return this.snappingOptions.featureSources.add(n),n}};f([y({constructOnly:!0})],Z_.prototype,"layerListViewModel",void 0),f([y({constructOnly:!0})],Z_.prototype,"snappingOptions",void 0),f([y()],Z_.prototype,"state",null),f([y({constructOnly:!0})],Z_.prototype,"view",void 0),Z_=f([ge(mCt)],Z_);const gCt=Z_,Ete={header:!0,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0},Hu={base:"esri-snapping-controls",container:"esri-snapping-controls__container",panel:"esri-snapping-controls__panel",item:"esri-snapping-controls__item",toggleBlock:"esri-snapping-controls__toggle-block",layerListBlock:"esri-snapping-controls__layer-list-block",layerList:"esri-snapping-controls__layer-list",layerListFilter:"esri-snapping-controls__layer-list__filter",layerListItem:"esri-snapping-controls__layer-list__item",layerListItemCheckbox:"esri-snapping-controls__layer-list__item__checkbox",layerListItemLabel:"esri-snapping-controls__layer-list__item__label",nestedContainer:"esri-snapping-controls__nested-container",disabled:"esri-disabled",esriWidget:"esri-widget",widgetIcon:"esri-icon-vertex-gps"};let Xu=class extends gr{constructor(e,t){super((()=>{const{view:n,viewModel:r,snappingOptions:s,...a}=e;return a})(),t),this._layerListFilter=null,this.messages=null,this.messagesCommon=null,this.visibleElements={...Ete},this._defaultViewModel=null,e!=null&&e.viewModel?this.viewModel=e.viewModel:(this._defaultViewModel=new gCt({snappingOptions:e.snappingOptions,view:e.view}),this.viewModel=this._defaultViewModel)}destroy(){this._defaultViewModel=_t(this._defaultViewModel)}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-accordion-bc845b43.js"),["./calcite-accordion-bc845b43.js","./dom-5b7af1bf.js"],import.meta.url),Ee(()=>import("./calcite-accordion-item-b6330f44.js"),["./calcite-accordion-item-b6330f44.js","./dom-5b7af1bf.js","./conditionalSlot-e2a39862.js","./observers-c77bfda3.js","./icon-1a289254.js"],import.meta.url),Ee(()=>import("./calcite-block-07b2d551.js"),["./calcite-block-07b2d551.js","./dom-5b7af1bf.js","./popover-dcfb3586.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js","./guid-e49c4e43.js","./openCloseComponent-587e936b.js","./key-1fec8108.js","./action-ae390733.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./loader-632408c9.js","./conditionalSlot-e2a39862.js","./action-menu-d50c4d74.js","./scrim-41440f97.js"],import.meta.url),Ee(()=>import("./calcite-checkbox-f1ac6128.js"),["./calcite-checkbox-f1ac6128.js","./dom-5b7af1bf.js","./guid-e49c4e43.js","./form-9bc9e261.js","./label2-0103af15.js","./interactive-52dcf836.js","./key-1fec8108.js"],import.meta.url),Ee(()=>import("./calcite-input-3a2d6757.js"),["./calcite-input-3a2d6757.js","./dom-5b7af1bf.js","./label2-0103af15.js","./form-9bc9e261.js","./key-1fec8108.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./progress-ae83f8fa.js"],import.meta.url),Ee(()=>import("./calcite-label-321be7cc.js"),["./calcite-label-321be7cc.js","./dom-5b7af1bf.js","./label2-0103af15.js"],import.meta.url),Ee(()=>import("./calcite-list-637f1ba8.js"),["./calcite-list-637f1ba8.js","./dom-5b7af1bf.js","./interactive-52dcf836.js"],import.meta.url),Ee(()=>import("./calcite-list-item-2b0d81b3.js"),["./calcite-list-item-2b0d81b3.js","./dom-5b7af1bf.js","./conditionalSlot-e2a39862.js","./observers-c77bfda3.js","./interactive-52dcf836.js"],import.meta.url),Ee(()=>import("./calcite-panel-8cbe33fc.js"),["./calcite-panel-8cbe33fc.js","./panel-ae4dd30c.js","./dom-5b7af1bf.js","./popover-dcfb3586.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js","./guid-e49c4e43.js","./openCloseComponent-587e936b.js","./key-1fec8108.js","./action-ae390733.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./loader-632408c9.js","./action-menu-d50c4d74.js","./scrim-41440f97.js"],import.meta.url),Ee(()=>import("./calcite-switch-7a55799a.js"),["./calcite-switch-7a55799a.js","./dom-5b7af1bf.js","./label2-0103af15.js","./form-9bc9e261.js","./interactive-52dcf836.js","./key-1fec8108.js"],import.meta.url)])}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){e!==this._get("viewModel")&&((B(this._defaultViewModel)||this._defaultViewModel!==e)&&(this._defaultViewModel=_t(this._defaultViewModel)),this._set("viewModel",e))}castVisibleElements(e){return{...Ete,...e}}render(){const{label:e,visibleElements:{header:t}}=this;return z("div",{"aria-label":e,class:this.classes(Hu.base,Hu.esriWidget)},z("div",{class:Hu.container},t?this.renderHeaderView():this.renderContent()))}renderHeaderView(){return z("calcite-panel",{heading:this.label,class:Hu.panel},this.renderContent())}renderContent(){return[this.renderToggles(),this.renderLayerList()]}renderToggles(){const{visibleElements:{enabledToggle:e,selfEnabledToggle:t,featureEnabledToggle:n}}=this;if(e||t||n)return z("calcite-block",{class:Hu.toggleBlock,key:"toggle-block",heading:"",open:!0},this.renderEnabledToggle(),z("div",{class:Hu.nestedContainer},this.renderSelfEnabledToggle(),this.renderFeatureEnabledToggle()))}renderEnabledToggle(){if(!this.visibleElements.enabledToggle)return;const{messages:{enableSnapping:e},viewModel:{snappingOptions:{enabled:t,enabledToggled:n}}}=this;return z("calcite-label",{layout:"inline-space-between"},e,z("calcite-switch",{checked:t,disabled:n,bind:this,onCalciteSwitchChange:this._enableSnappingSwitchChange}))}renderSelfEnabledToggle(){if(!this.visibleElements.selfEnabledToggle)return;const{messages:{geometryGuides:e},viewModel:{snappingOptions:{enabled:t,selfEnabled:n,enabledToggled:r}}}=this;return z("calcite-label",{layout:"inline-space-between",key:"self-enabled-toggle"},e,z("calcite-switch",{checked:n,disabled:r||!t,bind:this,onCalciteSwitchChange:this._selfEnabledSwitchChange}))}renderFeatureEnabledToggle(){if(!this.visibleElements.featureEnabledToggle)return;const{messages:{featureToFeature:e},viewModel:{snappingOptions:{enabled:t,featureEnabled:n,enabledToggled:r}}}=this;return z("calcite-label",{layout:"inline-space-between",key:"feature-enabled-toggle"},e,z("calcite-switch",{checked:n,disabled:r||!t,bind:this,onCalciteSwitchChange:this._featureEnabledSwitchChange}))}renderLayerList(){if(!this.visibleElements.layerList)return;const{messages:e,messagesCommon:t}=this,n=({target:{value:s}})=>this._layerListFilter=s===""?null:new RegExp(s,"i"),r=this.viewModel.layerListViewModel.operationalItems.length>9?z("calcite-input",{class:Hu.layerListFilter,clearable:!0,placeholder:e==null?void 0:e.searchLayers,onCalciteInputInput:n}):null;return z("calcite-block",{key:"list-block","intl-collapse":t==null?void 0:t.collapse,"intl-expand":t==null?void 0:t.expand,heading:e.snappingLayers,class:Hu.layerListBlock,open:!0,collapsible:!0},r,z("calcite-list",{class:Hu.layerList},this.renderLayerListItemCollection(this.viewModel.layerListViewModel.operationalItems,kt(this._layerListFilter))))}renderLayerListItemCollection(e,t){return e.map(n=>{if(!t||this._itemTitleMatchesFilter(n,t))return n.children.length>0?this.renderLayerListItemGroup(n):this.renderLayerListItem(n);const r=n.children.filter(s=>this._itemTitleMatchesFilter(s,t));return r.length>0?this.renderLayerListItemGroup(n,r):null}).toArray()}renderLayerListItem(e){const{messages:{untitledLayer:t}}=this,n=e.title||t,r=e.enabled,s=z("calcite-checkbox",{value:e.layer.id,checked:r,bind:this,onCalciteCheckboxChange:o=>this._handleLayerListItemChange(o.target)}),a=()=>{const o=!s.properties.checked;this._handleLayerListItemChange({checked:o,value:s.properties.value})};return z("calcite-list-item",{key:`${this.id}-list-item-${e.uid}`,onclick:a},z("calcite-label",{class:Hu.layerListItem,slot:"content-start",tabIndex:-1,layout:"inline","disable-spacing":"true"},z("div",{class:Hu.layerListItemCheckbox},s),z("div",{class:Hu.layerListItemLabel},n)))}renderLayerListItemGroup(e,t){const n=e.title||this.messages.untitledLayer,r=e.title&&e.title!==""?e.title:tf(),s=!!t,a=t??e.children;return z("calcite-list-item",{key:r},z("calcite-accordion",{"icon-position":"start",appearance:"transparent",afterCreate:o=>{o.append(...Array.from(o.children).map(l=>(l.remove(),l)))}},z("calcite-accordion-item",{active:s,"item-title":n,key:e.uid},z("calcite-list",null,[...this.renderLayerListItemCollection(a)]))))}_enableSnappingSwitchChange(e){this.snappingOptions.enabled=e.target.checked}_featureEnabledSwitchChange(e){this.snappingOptions.featureEnabled=e.target.checked}_itemTitleMatchesFilter(e,t){return t.test(e.title)}_selfEnabledSwitchChange(e){this.snappingOptions.selfEnabled=e.target.checked}async _handleLayerListItemChange(e){e.checked?this.viewModel.enableSnappingForLayer(e.value):this.viewModel.disableSnappingForLayer(e.value)}};f([y()],Xu.prototype,"_layerListFilter",void 0),f([y()],Xu.prototype,"label",null),f([y(),En("esri/widgets/support/SnappingControls/t9n/SnappingControls")],Xu.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],Xu.prototype,"messagesCommon",void 0),f([y()],Xu.prototype,"snappingOptions",null),f([y()],Xu.prototype,"view",null),f([y()],Xu.prototype,"viewModel",null),f([y()],Xu.prototype,"visibleElements",void 0),f([Mr("visibleElements")],Xu.prototype,"castVisibleElements",null),Xu=f([ge("esri.widgets.support.SnappingControls")],Xu);const vCt=Xu,On={base:"esri-editor esri-widget esri-widget--panel",message:"esri-editor__message",controls:"esri-editor__controls",controlButton:"esri-editor__control-button",progressBar:"esri-editor__progress-bar",panelToolbar:"esri-editor__panel-toolbar",panelToolbarSnappingButton:"esri-editor__panel-toolbar__snapping-button",panelContent:"esri-editor__panel-content",panelContentMessage:"esri-editor__panel-content__message",panelContentSection:"esri-editor__panel-content__section",panelContentSectionGroup:"esri-editor__panel-content__section__group",snappingControlsPopover:"esri-editor__snapping-controls-popover",updateFeaturesActionButtons:"esri-editor__update-features-action-buttons",updateFeaturesActionButtonsButton:"esri-editor__update-features-action-buttons--button",featureTemplatesContainer:"esri-editor__feature-templates-container",promptContainer:"esri-editor__prompt",promptHeader:"esri-editor__prompt__header",promptHeading:"esri-editor__prompt__header__heading",promptMessage:"esri-editor__prompt__message",promptDivider:"esri-editor__prompt__divider",promptActions:"esri-editor__prompt__actions",warningIcon:"esri-icon-notice-triangle",widgetIcon:"esri-icon-edit",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonSecondary:"esri-button--secondary",buttonTertiary:"esri-button--tertiary"},dN={undoRedoButtons:!1,snappingControls:!0,snappingControlsElements:{header:!1,enabledToggle:!0,selfEnabledToggle:!0,featureEnabledToggle:!0,layerList:!0}};function yCt(i){i.focus()}const jge="esri.widgets.Editor",hN=tt.getLogger(jge);let lr=class extends Ba(gr){constructor(e,t){super(e,t),this._candidateCommitted=!1,this._featureForm=new hwt,this._stateStack=[],this._attachments=new Sue({visibleElements:{addSubmitButton:!1,cancelAddButton:!1,cancelUpdateButton:!1,deleteButton:!1,errorMessage:!1,progressBar:!1,updateButton:!1}}),this._featureTemplates=new Ewt({enableListScroll:!1}),this._filterText="",this._prompt=null,this._spinner=new Uue,this._snappingButton=null,this._snappingPopover=null,this.useDeprecatedCreateWorkflow=!1,this.headingLevel=4,this.iconClass=On.widgetIcon,this.messages=null,this.messagesCommon=null,this.messagesTemplates=null,this.supportingWidgetDefaults=null,this.viewModel=new Qxt,this.visibleElements={...dN},this._setCandidateFeature=(n,r=!1)=>{if(this._candidateCommitted)return;const s=this._assertActiveUpdateWorkflow();s.data.edits.feature=n,r&&(s.next(),this._candidateCommitted=!0)},this._handleSave=this._handleSave.bind(this),this._handleBack=this._handleBack.bind(this),this._handleDone=this._handleDone.bind(this),this._handleDelete=this._handleDelete.bind(this),this._handleAdd=this._handleAdd.bind(this),this._handleEdit=this._handleEdit.bind(this),this._handleAttachmentAdd=this._handleAttachmentAdd.bind(this),this._handleAttachmentUpdate=this._handleAttachmentUpdate.bind(this),this._handleAttachmentDelete=this._handleAttachmentDelete.bind(this),this.EditorPanel=this.EditorPanel.bind(this)}initialize(){const{view:e,snappingOptions:t}=this;this._snappingControls=new vCt({snappingOptions:t,view:e,visibleElements:this.visibleElements.snappingControlsElements}),this.addHandles([ue(()=>this.headingLevel,n=>{this._featureForm.headingLevel=s0(n),this._featureTemplates.headingLevel=s0(n)},At),this.viewModel.featureTemplatesViewModel.on("select",({item:n})=>this.useDeprecatedCreateWorkflow?this.startCreateWorkflowAtFeatureCreation(n):this.startCreateFeaturesWorkflowAtFeatureCreation(n)),ue(()=>this.viewModel.state,(n,r)=>{const s=this._stateStack.indexOf(n);s===-1?this._stateStack.push(r):this._stateStack.splice(s)}),ue(()=>this.viewModel,n=>{this._featureForm.viewModel=n?n.featureFormViewModel:null,this._attachments.viewModel=n?n.attachmentsViewModel:null,this._featureTemplates.viewModel=n?n.featureTemplatesViewModel:null,this._spinner.viewModel=n?n.spinnerViewModel:null},At),ue(()=>this.view,(n,r)=>{const s=`editor-${this.id}-spinner`;r&&r.ui.remove(this._spinner,s),n&&n.ui.add(this._spinner,{key:s,position:"manual"})},At),Sn(()=>{var n;return(n=this.viewModel)==null?void 0:n.sketchViewModel},"create",()=>{this.scheduleRender()}),Sn(()=>{var n;return(n=this.viewModel)==null?void 0:n.activeWorkflow},"cancel-request",({controller:n})=>{const{messages:r,messagesCommon:s}=this;this._prompt={title:r.cancelRequestTitle,message:r.cancelRequestWarningMessage,context:"danger",actions:{primary:{label:s.form.yes,action:()=>{n.allow(),this._prompt=null}},secondary:{label:s.form.no,action:()=>(n.deny(),this._prompt=null)}}},this.scheduleRender()}),ue(()=>this.supportingWidgetDefaults,n=>{n&&(this._featureForm.set(n.featureForm),this._attachments.set(n.attachments),this._featureTemplates.set(n.featureTemplates),this.viewModel.sketchViewModel.set(n.sketch))},At),ue(()=>{var n;return(n=this._attachments)==null?void 0:n.error},n=>{if(!n)return;const{messages:r,messagesCommon:s}=this;this._prompt={title:r.errorWarningTitle,message:n.message,context:"warning",actions:{primary:{label:s.form.ok,action:()=>{this._prompt=null}}}}}),ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.failures},n=>{if(!n)return;const{messages:r}=this,[{error:s,retry:a,cancel:o}]=n;this._prompt={title:r.errorWarningTitle,message:ua(r.errorWarningMessageTemplate,{errorMessage:s.message}),context:"warning",actions:{primary:{label:r.retry,action:()=>{a(),this._prompt=null}},secondary:{label:r.ignore,action:()=>(o(),this._prompt=null)}}}}),ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.state},n=>{if(n==="awaiting-feature-to-update"&&(this._filterText=""),n==="awaiting-update-feature-candidate"&&(this._candidateCommitted=!1),n==="editing-existing-feature"){const{activeWorkflow:r}=this.viewModel;this._featureForm.disabled=(r==null?void 0:r.type)==="update"&&(r==null?void 0:r.data.editableItem.attributeUpdatesEnabled)===!1}}),ue(()=>{var n,r;return[(n=this._attachments)==null?void 0:n.selectedFile,(r=this._attachments)==null?void 0:r.submitting]},()=>this.scheduleRender()),ue(()=>{var n;return(n=this.viewModel)==null?void 0:n.activeWorkflow},()=>this._featureForm.disabled=!1),rs(()=>{var n;return!((n=this.viewModel)!=null&&n.activeWorkflow)},()=>this._featureTemplates.filterText=""),Sn(()=>this.view,"key-down",n=>{var r;n.key==="Escape"&&((r=this.viewModel)!=null&&r.activeWorkflow)&&this._handleBack()})])}destroy(){this._attachments.destroy(),this._featureForm.destroy(),this._featureTemplates.destroy(),this._snappingControls.destroy()}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-action-9d25f314.js"),["./calcite-action-9d25f314.js","./action-ae390733.js","./dom-5b7af1bf.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./loader-632408c9.js","./guid-e49c4e43.js"],import.meta.url),Ee(()=>import("./calcite-button-4c16684d.js"),["./calcite-button-4c16684d.js","./dom-5b7af1bf.js","./label2-0103af15.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./form-9bc9e261.js","./icon-1a289254.js","./loader-632408c9.js","./guid-e49c4e43.js"],import.meta.url),Ee(()=>import("./calcite-flow-67c8e2bc.js"),["./calcite-flow-67c8e2bc.js","./dom-5b7af1bf.js","./observers-c77bfda3.js"],import.meta.url),Ee(()=>import("./calcite-icon-5dd27db1.js"),["./calcite-icon-5dd27db1.js","./icon-1a289254.js","./dom-5b7af1bf.js","./observers-c77bfda3.js"],import.meta.url),Ee(()=>import("./calcite-flow-item-8eba8c39.js"),["./calcite-flow-item-8eba8c39.js","./dom-5b7af1bf.js","./panel-ae4dd30c.js","./popover-dcfb3586.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js","./guid-e49c4e43.js","./openCloseComponent-587e936b.js","./key-1fec8108.js","./action-ae390733.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./loader-632408c9.js","./action-menu-d50c4d74.js","./scrim-41440f97.js","./tooltip-87951009.js"],import.meta.url),Ee(()=>import("./calcite-popover-44683d52.js"),["./calcite-popover-44683d52.js","./popover-dcfb3586.js","./dom-5b7af1bf.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js","./guid-e49c4e43.js","./openCloseComponent-587e936b.js","./key-1fec8108.js","./action-ae390733.js","./observers-c77bfda3.js","./interactive-52dcf836.js","./icon-1a289254.js","./loader-632408c9.js"],import.meta.url),Ee(()=>import("./calcite-scrim-99bf204f.js"),["./calcite-scrim-99bf204f.js","./scrim-41440f97.js","./dom-5b7af1bf.js","./loader-632408c9.js","./guid-e49c4e43.js"],import.meta.url)])}get activeWorkflow(){return this.viewModel.activeWorkflow}get allowedWorkflows(){return this.viewModel.allowedWorkflows}set allowedWorkflows(e){this.viewModel.allowedWorkflows=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){const t={...dN,...e,snappingControlsElements:{...dN.snappingControlsElements,...e==null?void 0:e.snappingControlsElements}};return T(this._snappingControls)&&(this._snappingControls.visibleElements=t.snappingControlsElements),t}startCreateWorkflowAtFeatureTypeSelection(){return Mx(hN,"startCreateWorkflowAtFeatureTypeSelection","startCreateFeaturesWorkflowAtFeatureTypeSelection"),this.viewModel.startCreateWorkflowAtFeatureTypeSelection()}startCreateFeaturesWorkflowAtFeatureTypeSelection(){return this.viewModel.startCreateFeaturesWorkflowAtFeatureTypeSelection()}startCreateWorkflowAtFeatureCreation(e){return Mx(hN,"startCreateWorkflowAtFeatureCreation","startCreateFeaturesWorkflowAtFeatureCreation"),this.viewModel.startCreateWorkflowAtFeatureCreation(e)}startCreateFeaturesWorkflowAtFeatureCreation(e){return this.viewModel.startCreateFeaturesWorkflowAtFeatureCreation(e)}startCreateWorkflowAtFeatureEdit(e){return Mx(hN,"startCreateWorkflowAtFeatureEdit"),this.viewModel.startCreateWorkflowAtFeatureEdit(e)}startUpdateWorkflowAtFeatureSelection(){return this.viewModel.startUpdateWorkflowAtFeatureSelection()}startUpdateWorkflowAtMultipleFeatureSelection(e){return this.viewModel.startUpdateWorkflowAtMultipleFeatureSelection(e)}startUpdateWorkflowAtFeatureEdit(e){return this.viewModel.startUpdateWorkflowAtFeatureEdit(e)}deleteFeatureFromWorkflow(){return this.viewModel.deleteFeatureFromWorkflow()}cancelWorkflow(e){return this.viewModel.cancelWorkflow(e)}render(){const{_attachments:e,_prompt:t,viewModel:n}=this;if(!n)return z("div",{class:On.base});const{state:r}=n,s=T(t)?z("calcite-scrim",null,this.renderPrompt(t)):null;return z("div",{class:On.base},n.syncing||e.submitting?this.renderProgressBar():null,z("calcite-flow",null,this._stateStack.map(a=>this.renderState(a)),this.renderState(r)),s)}renderState(e){switch(e){case"disabled":break;case"ready":return this.renderLanding(e);case"awaiting-feature-creation-info":return this.renderTemplates(e);case"creating-features":case"editing-new-feature":case"editing-existing-feature":return this.renderAttributeEditing(e);case"awaiting-feature-to-update":return this.renderFeatureUpdating(e);case"awaiting-update-feature-candidate":return this.renderFeatureList(e);case"awaiting-feature-to-create":return this.renderFeatureCreation(e);case"adding-attachment":return this.renderAttachmentAdding(e);case"editing-attachment":return this.renderAttachmentEditing(e)}return z("div",null)}isPanelActive(e){return this.viewModel.state===e}renderTemplates(e){const{EditorPanel:t,headingLevel:n,messages:r,messagesCommon:s,_handleBack:a,_snappingControls:o,viewModel:{sketchViewModel:l}}=this;return z(t,{active:this.isPanelActive(e),key:"templates-panel",handleBack:a,heading:r.selectTemplate,headingLevel:n,messages:r,messagesCommon:s,sketchViewModel:l,snappingControls:o},z("div",{class:On.panelContent},this._featureTemplates.render()))}renderAttributeEditing(e){const{activeWorkflow:t,EditorPanel:n,messages:r,messagesCommon:s,headingLevel:a,_handleBack:o,_snappingControls:l,viewModel:c}=this,{sketchViewModel:u}=c,d=c.featureFormViewModel;if(t.type==="create-features"&&t.pendingFeatures.length<1)return this.renderFeatureCreation(e);const h=t.type==="update"&&!t.data.edits.modified||c.syncing||d.updating,p=t.type==="update"?r.editFeature:r.createFeatures,m=t.type==="update"?s.update:s.create,g=t.type==="create-features"&&t.createFeatureState==="create-new",_=t.type==="update"&&t.data.editableItem.supports.includes("delete"),b=this._shouldShowAttachmentsForWorkflow(t),x=[{label:t.type==="create-features"&&t.numPendingFeatures>1?ua(r.createFeaturesTemplate,{numFeatures:t.numPendingFeatures}):m,type:"primary",disabled:h,clickHandler:this._handleSave,width:_?"half":"full"}];_&&x.push({label:s.delete,type:"tertiary",clickHandler:this._handleDelete,disabled:c.syncing,appearance:"outline",width:"half"});const w=d.inputFields.every(C=>!C.visible)&&!b?this.renderMessage(ua(r.clickToFinishTemplate,{button:m})):z("div",{class:On.panelContentSection},z("div",{class:On.panelContentSectionGroup},this._featureForm.render(),b?z("div",{key:"attachments"},z(Ul,{level:s0(a)},r.attachments),this._attachments.render()):null));return z(n,{active:this.isPanelActive(e),key:"attribute-editing-panel",heading:p,headingLevel:a,handleBack:o,messages:r,messagesCommon:s,sketchViewModel:u,snappingControls:l},z("div",{class:On.panelContent},w,g?z("calcite-scrim",null):null),this.renderFooterActions(x))}renderAttachmentAdding(e){const{_attachments:t,EditorPanel:n,_handleBack:r,headingLevel:s,messages:a,messagesCommon:o,_snappingControls:l,viewModel:{sketchViewModel:c}}=this,u=[{label:t.submitting?o.cancel:o.add,disabled:t.submitting||!t.selectedFile,type:"primary",clickHandler:this._handleAttachmentAdd,width:"full"}];return z(n,{active:this.isPanelActive(e),key:"attachment-adding-panel",heading:a.addAttachment,headingLevel:s,handleBack:r,messages:a,messagesCommon:o,sketchViewModel:c,snappingControls:l},z("div",{class:On.panelContent},t.render()),this.renderFooterActions(u))}renderAttachmentEditing(e){const{_attachments:t,EditorPanel:n,_handleBack:r,headingLevel:s,messages:a,messagesCommon:o,_snappingControls:l,viewModel:{sketchViewModel:c}}=this,u=[{label:o.update,disabled:t.submitting||!t.selectedFile,type:"primary",clickHandler:this._handleAttachmentUpdate,width:"half"},{label:o.delete,disabled:t.submitting,type:"tertiary",clickHandler:this._handleAttachmentDelete,width:"half",appearance:"outline"}];return z(n,{active:this.isPanelActive(e),key:"attachment-editing-panel",heading:a.editAttachment,headingLevel:s,handleBack:r,messages:a,messagesCommon:o,sketchViewModel:c,snappingControls:l},z("div",{class:On.panelContent},t.render()),this.renderFooterActions(u))}renderFeatureUpdating(e){const{EditorPanel:t,_handleBack:n,headingLevel:r,messages:s,messagesCommon:a,_snappingControls:o,viewModel:{sketchViewModel:l}}=this;return z(t,{active:this.isPanelActive(e),key:"feature-updating-panel",heading:s.selectFeature,headingLevel:r,handleBack:n,messages:s,messagesCommon:a,sketchViewModel:l,snappingControls:o},z("div",{class:On.panelContent},this.renderMessage(s.selectFeatureToEdit)))}renderMessage(e){return z("div",{class:On.panelContentMessage},e)}renderFeatureCreation(e){const{EditorPanel:t,_handleBack:n,headingLevel:r,messages:s,messagesCommon:a,_snappingControls:o,viewModel:l}=this,{sketchViewModel:c}=l,u=l.sketchViewModel,d=this._assertActiveCreateWorkflow().data.creationInfo.layer,h=u.canUndo()&&u.createGraphic?u.createGraphic:null,p=this._getSketchingTip(d.geometryType,h);return z(t,{active:this.isPanelActive(e),key:"feature-creation-panel",heading:s.placeFeature,headingLevel:r,handleBack:n,messages:s,messagesCommon:a,sketchViewModel:c,snappingControls:o},z("div",{class:On.panelContent},this.renderMessage(p)))}renderFooterActions(e){return e.map(({type:t,disabled:n,class:r,...s},a)=>this.renderButton({class:this.classes(On.controlButton,t==="secondary"?On.buttonSecondary:t==="tertiary"?On.buttonTertiary:null,n?On.buttonDisabled:null,r),disabled:n??!1,key:a,slot:"footer-actions",...s}))}renderPrompt({title:e,message:t,context:n,actions:r}){const s=!!r.secondary,a=z("calcite-button",{appearance:"solid",color:n==="danger"?"red":"blue",width:s?"half":"full",onclick:r.primary.action,key:"prompt-primary-button",afterCreate:yCt},r.primary.label),o=s?z("calcite-button",{appearance:"clear",color:n==="danger"?"red":"blue",width:"half",onclick:r.secondary.action,key:"prompt-secondary-button"},r.secondary.label):null;return z("div",{class:`${On.promptContainer}--${n}`},z("div",{class:On.promptHeader},z("calcite-icon",{icon:"exclamation-mark-triangle"}),z(Ul,{class:On.promptHeading,level:this.headingLevel},e)),z("div",{class:On.promptMessage},t),z("div",{class:On.promptDivider}),z("div",{class:On.promptActions},o,a))}renderProgressBar(){return z("div",{class:this.classes(On.progressBar),key:"progress-bar"})}renderButton(e){const{disabled:t,class:n,key:r,clickHandler:s,label:a,...o}=e;return z("calcite-button",{class:n,disabled:t,key:r,onclick:s,type:"button",...o},a)}renderLanding(e){const{EditorPanel:t,headingLevel:n,messages:r,messagesCommon:s,_snappingControls:a,_featureTemplates:{viewModel:{numberOfFeatureTemplates:o}},viewModel:{canUpdate:l,sketchViewModel:c}}=this,u=!l&&o===0;return z(t,{active:this.isPanelActive(e),key:"landing-panel",heading:r.widgetLabel,headingLevel:n,showBackButton:!1,messages:r,messagesCommon:s,sketchViewModel:c,snappingControls:a},z("div",{class:On.panelContent},l?z("div",{key:"edit-actions",class:On.panelContentSection},this.renderUpdateActions()):void 0,o>0?z("div",{key:"create-actions",class:On.panelContentSection},this.renderCreateActions()):void 0,u?z("div",{key:"no-content",class:On.panelContentSection},r.noEditableLayers):void 0))}renderUpdateActions(){const{messages:e,messagesCommon:t}=this;return z("div",null,z(Ul,{level:s0(this.headingLevel)},e.editFeatures),z("div",{class:On.updateFeaturesActionButtons},z("calcite-action",{text:t.select,textEnabled:!0,icon:"cursor",alignment:"start",class:On.updateFeaturesActionButtonsButton,onclick:this._handleEdit})))}renderCreateActions(){const{_featureTemplates:e,headingLevel:t,messages:n}=this;return z("div",null,z(Ul,{level:s0(t)},n.createFeatures),z("div",{key:"templates",class:On.featureTemplatesContainer},e.render()))}renderFeatureList(e){const{EditorPanel:t,_handleBack:n,headingLevel:r,messages:s,messagesCommon:a,messagesTemplates:o,_snappingControls:l,viewModel:{editableItems:c,sketchViewModel:u}}=this,d=this._assertActiveUpdateWorkflow().data.candidates,h=ua(s.multipleFeaturesTemplate,{total:d.length}),p=new Map;let m=0;d.map(b=>({label:this._getLabel(b),id:b.attributes[b.layer.objectIdField],data:b})).filter(b=>{const{label:x,data:w}=b,C=this._filterText.toLowerCase(),{title:S}=w.layer;return this.viewModel.editableItems.find(A=>A.layer===w.layer).supports.includes("update")&&(!C||x.toLowerCase().includes(C)||S.toLowerCase().includes(C))}).forEach(b=>{m++;const x=b.data.layer;p.has(x)?p.get(x).items.push(b):p.set(x,{id:`${x.id}`,label:x.title,items:[b]})});const g=c.filter(({layer:b})=>p.has(b)).map(({layer:b})=>p.get(b)).toArray(),_=m>10||this._filterText.length>0;return z(t,{active:this.isPanelActive(e),key:"feature-list",heading:h,headingLevel:r,handleBack:n,messages:s,messagesCommon:a,sketchViewModel:u,snappingControls:l},z("div",{class:On.panelContent},z("div",{class:On.panelContentSection},uge({id:this.id,enableListScroll:!1,filterEnabled:_,filterText:this._filterText,items:g,messages:{filterPlaceholder:o.filterPlaceholder,noItems:o.noItems,noMatches:o.noMatches},onItemMouseEnter:({data:b})=>this._setCandidateFeature(b),onItemMouseLeave:()=>this._setCandidateFeature(null),onItemSelect:({data:b})=>this._setCandidateFeature(b,!0),onFilterChange:b=>this._filterText=b}))))}EditorPanel(e,...t){const{active:n,handleBack:r,heading:s,headingLevel:a,key:o,messages:l,messagesCommon:c,showBackButton:u,sketchViewModel:d,snappingControls:h}=e,{snappingControls:p,undoRedoButtons:m}=this.visibleElements;return z("calcite-flow-item",{bind:this,key:o,heading:s,headingLevel:a,showBackButton:u??!0,"intl-back":c.back,closable:!1,onCalciteFlowItemScroll:this._closeSnappingPopover,onCalciteFlowItemBackClick:r??null},z("div",{class:On.panelToolbar},p?[z("calcite-popover",{autoClose:n,afterCreate:this._setSnappingPopover,afterUpdate:this._setSnappingPopover,bind:this,label:l.snappingSettings,heading:l.snappingSettings,referenceElement:this._snappingButton||null,"overlay-positioning":"fixed",placement:"bottom"},z("div",{class:On.snappingControlsPopover},h.render())),z("calcite-button",{id:`${o}__snappingButton`,afterCreate:this._setSnappingButton,afterUpdate:this._setSnappingButton,bind:this,text:l.snapping,appearance:"transparent",color:"neutral",alignment:"icon-end-space-between","icon-start":"vertex-gps","icon-end":"caret-down",width:"full",class:On.panelToolbarSnappingButton,onkeydown:g=>{g.key==="Escape"&&this._closeSnappingPopover()}},l.snapping)]:null,m?[z("calcite-button",{key:"undo-button",text:c.undo,appearance:"transparent",color:"neutral",alignment:"center","icon-start":"undo",scale:"l",disabled:!d.canUndo(),onclick:d.undo.bind(d)}),z("calcite-button",{key:"redo-button",text:c.redo,appearance:"transparent",color:"neutral",alignment:"center","icon-start":"redo",scale:"l",disabled:!d.canRedo(),onclick:d.redo.bind(d)})]:null),t)}_closeSnappingPopover(){var e;(e=this._snappingPopover)!=null&&e.open&&this._snappingPopover.toggle()}_setSnappingPopover(e){this._snappingPopover=e}_setSnappingButton(e){this._snappingButton=e,this.scheduleRender()}_getSketchingTip(e,t){const{messages:n}=this;if(e==="point")return n.tips.clickToAddPoint;if(e==="polygon"||e==="polyline"){if(!t)return n.tips.clickToStart;const r=t.geometry,s=e==="polygon"?"rings":"paths",[a]=r[s];return e==="polygon"&&a<4?n.tips.clickToContinue:n.tips.clickToContinueThenDoubleClickToEnd}return n.tips.clickToAddFeature}_getLabel(e){const t=e.layer;if(!t)return null;const{objectIdField:n}=t,{attributes:r}=e,s=p_e(t);return s&&r[s]&&`${r[s]}`||ua(this.messages.untitledFeatureTemplate,{id:r[n]})}_handleDelete(){const{messages:e,messagesCommon:t}=this;this._prompt={title:e.deleteWarningTitle,message:e.deleteWarningMessage,context:"danger",actions:{primary:{label:t.delete,action:()=>{this.viewModel.deleteFeatureFromWorkflow(),this._prompt=null}},secondary:{label:e.keepFeature,action:()=>this._prompt=null}}}}_handleSave(){const{featureFormViewModel:e}=this.viewModel;e.submit(),!e.submittable||e.validateContingencyConstraints(e.getValues(),{includeIncompleteViolations:!0}).length>0||this.viewModel.activeWorkflow.commit()}_handleAttachmentAdd(){const{_attachments:e}=this,{activeWorkflow:t}=this.viewModel;t.type==="create-features"?(e.addFile(),t.previous()):e.addAttachment().then(()=>t.previous())}_handleAttachmentUpdate(){const{_attachments:e}=this,{activeWorkflow:t}=this.viewModel;t.type==="create-features"?(e.updateFile(),t.previous()):e.updateAttachment().then(()=>t.previous())}_handleAttachmentDelete(){const{messages:e,messagesCommon:t}=this;this._prompt={title:e.deleteAttachmentWarningTitle,message:e.deleteAttachmentWarningMessage,context:"danger",actions:{primary:{label:t.delete,action:()=>{const{_attachments:n}=this,{activeWorkflow:r}=this.viewModel;r.type==="create-features"?(n.deleteFile(),r.previous(),this._prompt=null):n.deleteAttachment(n.viewModel.activeAttachmentInfo).then(()=>{r.previous(),this._prompt=null})}},secondary:{label:e.keepAttachment,action:()=>this._prompt=null}}}}_handleAdd(){this.viewModel.canCreate}_handleEdit(){this.viewModel.canUpdate&&this.viewModel.startUpdateWorkflowAtFeatureSelection()}_handleDone(){this.viewModel.cancelWorkflow({force:!0})}async _handleBack(e){if(!this.activeWorkflow)return;const t=this.activeWorkflow;if(e==null||e.stopPropagation(),this.viewModel.syncing)return;const n=()=>{t.hasPreviousStep?t.previous({cancelCurrentStep:!0}):this.viewModel.cancelWorkflow({force:!0})};if(t.type==="create"||t.type==="create-features"&&t.numPendingFeatures>0||t.stepId==="editing-existing-feature"&&t.data.edits.modified){const{messages:r}=this,{type:s}=t,a=s==="create"?r.cancelAddWarningMessage:r.cancelEditWarningMessage,o=s==="create"?r.cancelAddTitle:r.cancelEditTitle,l=s==="create"?r.continueAdding:r.continueEditing,c=s==="create"?r.discardFeature:r.discardEdits;return this._prompt={title:o,message:a,context:"danger",actions:{primary:{label:c,action:()=>{this._prompt=null,n()}},secondary:{label:l,action:()=>this._prompt=null}}},void this.scheduleRender()}n()}_assertActiveCreateWorkflow(){const{type:e}=this.viewModel.activeWorkflow;if(e==="create"||e==="create-features")return this.viewModel.activeWorkflow;throw new Error("Expected activeWorkflow to be instance of CreateWorkflow or CreateFeaturesWorkflow")}_assertActiveUpdateWorkflow(){if(this.viewModel.activeWorkflow.type==="update")return this.viewModel.activeWorkflow;throw new Error("Expected activeWorkflow to be an UpdateWorkflow")}_shouldShowAttachmentsForWorkflow(e){const t=e.type==="create-features"&&e.data.creationInfo;let n=!1;if(t){const{layerInfos:r}=this,{layer:s}=t,{data:a}=s.capabilities,o=r&&r.find(l=>l.layer===s);n="supportsAttachment"in a&&a.supportsAttachment&&(!o||o.allowAttachments!==!1)}return n||e.type==="update"&&e.data.editableItem.hasAttachments}};f([y()],lr.prototype,"_attachments",void 0),f([y({readOnly:!0})],lr.prototype,"activeWorkflow",null),f([y()],lr.prototype,"allowedWorkflows",null),f([y()],lr.prototype,"useDeprecatedCreateWorkflow",void 0),f([y()],lr.prototype,"headingLevel",void 0),f([y()],lr.prototype,"iconClass",void 0),f([y()],lr.prototype,"label",null),f([y()],lr.prototype,"labelOptions",null),f([y()],lr.prototype,"layerInfos",null),f([y(),En("esri/widgets/Editor/t9n/Editor")],lr.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],lr.prototype,"messagesCommon",void 0),f([y(),En("esri/widgets/FeatureTemplates/t9n/FeatureTemplates")],lr.prototype,"messagesTemplates",void 0),f([y()],lr.prototype,"snappingOptions",null),f([y()],lr.prototype,"tooltipOptions",null),f([y()],lr.prototype,"supportingWidgetDefaults",void 0),f([y()],lr.prototype,"view",null),f([y(),WC(["workflow-cancel","workflow-commit"])],lr.prototype,"viewModel",void 0),f([y()],lr.prototype,"visibleElements",void 0),f([Mr("visibleElements")],lr.prototype,"castVisibleElements",null),f([dr()],lr.prototype,"_handleDelete",null),f([dr()],lr.prototype,"_handleAttachmentAdd",null),f([dr()],lr.prototype,"_handleAttachmentUpdate",null),f([dr()],lr.prototype,"_handleAttachmentDelete",null),f([dr()],lr.prototype,"_handleAdd",null),f([dr()],lr.prototype,"_handleEdit",null),f([dr()],lr.prototype,"_handleDone",null),lr=f([ge(jge)],lr);const Ate=lr;let Mv=class extends et{constructor(e){super(e),this._viewpointHandle=null,this._handles=new mi,this.group=null}initialize(){this._handles.add(Sn(()=>{var e;return(e=this.view)==null?void 0:e.ui},"expand",e=>{const{target:t}=e;t&&t!==this&&t.expanded&&t.group&&t.group===this.group&&this._collapse()}))}destroy(){this._viewpointHandle=null,this.view=null,this._handles.destroy(),this._handles=null}set autoCollapse(e){this._set("autoCollapse",e),this._watchViewpoint()}set expanded(e){const t=!!e;this._set("expanded",t);const n=this.get("view.ui");n&&n.emit("expand",{target:this}),this._viewpointHandleChange(t)}get state(){return this.get("view.ready")?"ready":"disabled"}set view(e){this._get("view")!==e&&(this._set("view",e),e&&rs(()=>e.ready,()=>{this.view===e&&this._watchViewpoint()},{once:!0,initial:!0}))}_viewpointHandleChange(e){this._viewpointHandle&&(e?rs(()=>this.view.stationary,()=>this._viewpointHandle.resume(),{once:!0,initial:!0}):this._viewpointHandle.pause())}_watchViewpoint(){const e="viewpoint";this._handles.remove(e),this._viewpointHandle=null;const{autoCollapse:t,view:n}=this;if(n&&t){const r=Uye(()=>n.type==="3d"?n.camera:n.viewpoint,()=>this._collapse());this._handles.add(r,e),this._viewpointHandle=r}}_collapse(){this.expanded=!1}};f([y({value:!1})],Mv.prototype,"autoCollapse",null),f([y({value:!1})],Mv.prototype,"expanded",null),f([y()],Mv.prototype,"group",void 0),f([y({readOnly:!0})],Mv.prototype,"state",null),f([y({value:null})],Mv.prototype,"view",null),Mv=f([ge("esri.widgets.Expand.ExpandViewModel")],Mv);const qge=Mv,ia={base:"esri-expand esri-widget",modeAuto:"esri-expand--auto",modeDrawer:"esri-expand--drawer",modeFloating:"esri-expand--floating",container:"esri-expand__container",containerExpanded:"esri-expand__container--expanded",panel:"esri-expand__panel",button:"esri-widget--button",text:"esri-icon-font-fallback-text",icon:"esri-collapse__icon",iconExpanded:"esri-expand__icon--expanded",iconNumber:"esri-expand__icon-number",iconNumberExpanded:"esri-expand__icon-number--expanded",expandIcon:"esri-icon-expand",collapseIcon:"esri-icon-collapse",content:"esri-expand__content",contentExpanded:"esri-expand__content--expanded",expandMask:"esri-expand__mask",expandMaskExpanded:"esri-expand__mask--expanded"};let Os=class extends gr{constructor(e,t){super(e,t),this.closeOnEsc=!0,this.collapseTooltip="",this.content="",this.expandTooltip="",this.iconNumber=0,this.messages=null,this.messagesCommon=null,this.mode="auto",this.viewModel=new qge,this._handleKeyDown=n=>{const{closeOnEsc:r,_toggleButtonEl:s,expanded:a}=this;!a||!r||n.target===s||n.key!=="Escape"||(typeof r=="function"?r(n):r)&&(this.expanded=!1,s==null||s.focus())}}get contentId(){return`${this.id}_controls_content`}get expandTitle(){const{expanded:e,messagesCommon:t,collapseTooltip:n,expandTooltip:r}=this;return e?n||t.collapse:r||t.expand}get autoCollapse(){return this.viewModel.autoCollapse}set autoCollapse(e){this.viewModel.autoCollapse=e}get collapseIconClass(){return ia.collapseIcon}set collapseIconClass(e){this._overrideIfSome("collapseIconClass",e)}get expanded(){return this.viewModel.expanded}set expanded(e){this.viewModel.expanded=e}get expandIconClass(){return Bx(this.content)?this.content.iconClass:ia.expandIcon}set expandIconClass(e){this._overrideIfSome("expandIconClass",e)}get group(){return this.viewModel.group}set group(e){this.viewModel.group=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}expand(){this.viewModel.expanded=!0}collapse(){this.viewModel.expanded=!1}toggle(){this.viewModel.expanded=!this.viewModel.expanded}render(){const{mode:e}=this,t={[ia.modeAuto]:e==="auto",[ia.modeDrawer]:e==="drawer",[ia.modeFloating]:e==="floating"};return z("div",{class:this.classes(ia.base,t),onkeydown:this._handleKeyDown},this.renderMask(),this.renderContainer())}renderContainer(){const{expanded:e}=this,t={[ia.containerExpanded]:e};return z("div",{class:this.classes(ia.container,t)},this.renderPanel(),this.renderContent())}renderMask(){const{expanded:e}=this,t={[ia.expandMaskExpanded]:e};return z("div",{bind:this,onclick:this._toggle,class:this.classes(ia.expandMask,t)})}renderBadgeNumber(){const{expanded:e,iconNumber:t}=this;return t&&!e?z("span",{key:"expand__icon-number",class:ia.iconNumber},t):null}renderPanelNumber(){const{iconNumber:e,expanded:t}=this;return e&&t?z("span",{key:"expand__expand-icon-number",class:this.classes(ia.iconNumber,ia.iconNumberExpanded)},e):null}renderIcon(){const{collapseIconClass:e,expandIconClass:t,expanded:n}=this,r={[ia.iconExpanded]:n,[e]:n,[t]:!n};return e===t&&(r[e]=!0),z("span",{"aria-hidden":"true",class:this.classes(ia.icon,r)})}renderTitle(){return z("span",{class:ia.text},this.expandTitle)}renderExpandButton(){const{expanded:e,expandTitle:t,contentId:n}=this;return z("div",{afterCreate:this._storeToggleButtonEl,"aria-controls":n,"aria-expanded":e?"true":"false",bind:this,class:ia.button,onclick:this._toggle,onkeydown:this._toggle,role:"button",tabindex:"0",title:t},this.renderBadgeNumber(),this.renderIcon(),this.renderTitle())}renderPanel(){return z("div",{class:ia.panel},this.renderExpandButton(),this.renderPanelNumber())}renderContent(){const{expanded:e,contentId:t,content:n}=this,r={[ia.contentExpanded]:e},s={id:t,role:"region",class:this.classes(ia.content,r)};return typeof n=="string"?z("div",{key:"content__string",innerHTML:n,...s}):Bx(n)?z("div",{key:"content__widget",...s},n.render()):n instanceof HTMLElement?z("div",{key:"content__html-element",bind:n,afterCreate:this._attachToNode,...s}):Eie(n)?z("div",{key:"content__node",bind:n.domNode,afterCreate:this._attachToNode,...s}):null}_toggle(){this.toggle()}_attachToNode(e){const t=this;e.appendChild(t)}_storeToggleButtonEl(e){this._toggleButtonEl=e}};f([y({readOnly:!0})],Os.prototype,"contentId",null),f([y({readOnly:!0})],Os.prototype,"expandTitle",null),f([y()],Os.prototype,"autoCollapse",null),f([y()],Os.prototype,"closeOnEsc",void 0),f([y()],Os.prototype,"collapseIconClass",null),f([y()],Os.prototype,"collapseTooltip",void 0),f([y()],Os.prototype,"content",void 0),f([y()],Os.prototype,"expanded",null),f([y()],Os.prototype,"expandIconClass",null),f([y()],Os.prototype,"expandTooltip",void 0),f([y()],Os.prototype,"group",null),f([y()],Os.prototype,"iconNumber",void 0),f([y()],Os.prototype,"label",null),f([y(),En("esri/widgets/Expand/t9n/Expand")],Os.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],Os.prototype,"messagesCommon",void 0),f([y()],Os.prototype,"mode",void 0),f([y()],Os.prototype,"view",null),f([y({type:qge})],Os.prototype,"viewModel",void 0),f([dr()],Os.prototype,"_toggle",null),Os=f([ge("esri.widgets.Expand")],Os);const _Ct=Os;async function bCt(i,e={}){await xCt(i,e),Cn(e)}async function wCt(i,e={}){const{basemap:t,view:n}=i;if(Cn(e),"spatialReferenceLocked"in n&&!n.spatialReferenceLocked||(await t.load(e),Cn(e),t.baseLayers.length===0))return;const r=t.baseLayers.getItemAt(0);if(!ax(r))return;if(t.spatialReference){if(n.spatialReference.equals(t.spatialReference))return;Mte()}await r.load(e),Cn(e);const s=(("supportedSpatialReferences"in r?r.supportedSpatialReferences:null)||["tileInfo"in r?r.tileInfo.spatialReference:null]).filter(Boolean);s.length!==0&&s.every(a=>!n.spatialReference.equals(a))&&Mte()}function Mte(){throw new Ze("basemap-compatibility:incompatible-spatial-reference","Basemap spatial reference is not compatible with the view")}async function xCt(i,e){const{basemap:t,view:n}=i;if(await t.load(e),t.baseLayers.length===0)return;const r=t.baseLayers.concat(t.referenceLayers).toArray().filter(a=>!jG(a)).map(a=>new Ze("basemap-compatibility:unsupported-basemap-layer-type","Unsupported basemap layer type ${operationalLayerType}",{layer:a,operationalLayerType:a.operationalLayerType||"unknown"}));if(r.length)throw r[0];const s=t.baseLayers.getItemAt(0);if(jG(s)){try{await s.load(e)}catch(a){const o="basemap-compatibility:unknown-error",l="Unknown basemap compatibility error",{name:c=o,message:u=l,details:d}=a;throw new Ze(c,u,d)}CCt(s,n)}}function CCt(i,e){const t=e.state.viewingMode;if(!t)return;let n,r;if((i==null?void 0:i.type)==="wmts"){const l=eme(i,e.spatialReference,t);if(B(l.tileInfo))throw new Ze("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view");n=l.tileInfo,r=l.fullExtent}else n=i.tileInfo,r=i.fullExtent;if(B(n))return;if(!vA(n.spatialReference,t))throw new Ze(`basemapgalleryitem:spatial-reference-unsupported-${iE(t)}`,`Basemap spatial reference is unsupported in ${iE(t)} mode`);const s=n.spatialReference.isGeographic,a=(i==null?void 0:i.type)==="vector-tile"?n.getOrCreateCompatible(256,s?1:2):null;if(t===Ot.Global){let l=MA(n,r,null,t);if(l&&(i==null?void 0:i.type)==="vector-tile"&&T(r)&&a&&!MA(a,r,null,t)&&(l=null),l){const c=n.spatialReference.isWebMercator?"web-mercator":"wgs84";throw new Ze(`basemapgalleryitem:tiling-scheme-unsupported-${c}-global`,"Basemap tiling scheme is unsupported in global mode",{error:l})}}else if(ur.checkUnsupported(n))throw new Ze("basemapgalleryitem:tiling-scheme-unsupported-local","Basemap tiling scheme is unsupported in local mode");const o=e.get("basemapTerrain.tilingScheme");if(o&&!o.compatibleWith(n)&&((i==null?void 0:i.type)!=="vector-tile"||!a||!o.compatibleWith(a)))throw new Ze("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view")}let mp=class extends RC(Ba(et)){constructor(e){super(e),this.compatibilityFunction=null,this.error=null,this.state="loading",this.view=null}initialize(){const e=()=>this.refresh();this.handles.add([ue(()=>{var t;return(t=this.basemap)==null?void 0:t.loadStatus},e),ue(()=>this.compatibilityFunction,e),ue(()=>{var t;return this.view&&"basemapTerrain"in this.view&&((t=this.view.basemapTerrain)==null?void 0:t.tilingScheme)},e),ue(()=>{var t;return(t=this.view)==null?void 0:t.ready},e),ue(()=>{var t;return(t=this.view)==null?void 0:t.spatialReference},e)]),this.refresh()}destroy(){this._cancelRefresh(),this.basemap=null,this.compatibilityFunction=null,this.view=null}get _spatialReferenceTask(){return KZe(this.view,this.basemap)}set basemap(e){const t=this._get("basemap");t&&t.cancelLoad(),e&&e.load().catch(()=>{}),this._set("basemap",e)}get spatialReference(){return this._spatialReferenceTask.spatialReference}refresh(){var r;this._cancelRefresh(),this._set("state","loading");const e=(r=this.basemap)==null?void 0:r.loadStatus;if(e!=="loaded"&&e!=="failed")return;if(!this.compatibilityFunction)return void(e==="loaded"?(this._set("state","ready"),this._set("error",null)):(this._set("state","error"),this._set("error",this.basemap.loadError)));const t=new AbortController,{signal:n}=t;this.compatibilityFunction(this,{signal:n}).then(()=>$u(()=>!this._spatialReferenceTask.updating,n)).then(()=>{this._set("state","ready"),this._set("error",null)}).catch(s=>{zo(s)||(this._set("state","error"),this._set("error",s))}),this._refreshController=t}_cancelRefresh(){this._refreshController&&(this._refreshController.abort(),this._refreshController=null)}};f([y({readOnly:!0})],mp.prototype,"_spatialReferenceTask",null),f([y()],mp.prototype,"basemap",null),f([y()],mp.prototype,"compatibilityFunction",void 0),f([y({readOnly:!0})],mp.prototype,"error",void 0),f([y({readOnly:!0})],mp.prototype,"spatialReference",null),f([y({readOnly:!0})],mp.prototype,"state",void 0),f([y()],mp.prototype,"view",void 0),mp=f([ge("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],mp);const Kge=mp,Yge=_i.ofType(Dx);let XS=class extends et{constructor(e){super(e),this.basemaps=new Yge}get state(){return"ready"}refresh(){}};f([y({type:Yge})],XS.prototype,"basemaps",void 0),f([y({readOnly:!0})],XS.prototype,"state",null),XS=f([ge("esri.widgets.BasemapGallery.support.LocalBasemapsSource")],XS);const Xge=XS,Zge=_i.ofType(Dx);let sm=class extends q0.LoadableMixin(bB(Xge)){constructor(e){super(e),this._handles=new mi,this.basemaps=new Zge,this.filterFunction=null,this.portal=cz.getDefault(),this.query=null,this.updateBasemapsCallback=null}initialize(){this._handles.add([ue(()=>{var e,t;return[this.filterFunction,this.loadStatus,(e=this.portal)==null?void 0:e.basemapGalleryGroupQuery,(t=this.portal)==null?void 0:t.user,this.query,this.updateBasemapsCallback]},()=>this.refresh(),At)])}destroy(){this._handles.destroy(),this._handles=null,this.filterFunction=null,this.portal=null}get state(){return this.loadStatus==="not-loaded"?"not-loaded":this.loadStatus==="loading"||this._lastPortalBasemapFetchController?"loading":"ready"}load(e){return this.addResolvingPromise(this.portal.load(e)),this.notifyChange("state"),Promise.resolve(this)}async refresh(){if(this.state!=="ready")return;this._lastPortalBasemapFetchController&&(this._lastPortalBasemapFetchController.abort(),this._lastPortalBasemapFetchController=null);const e=this.portal,t=new AbortController;this._lastPortalBasemapFetchController=t,this.notifyChange("state");try{const n=await e.fetchBasemaps(this._toQueryString(this.query),t);this._updateBasemaps(n)}catch(n){if(zo(n))throw n;tt.getLogger(this.declaredClass).warn(new Ze("basemap-source:fetch-basemaps-error","Could not fetch basemaps from portal.",{error:n})),this._updateBasemaps()}this._lastPortalBasemapFetchController=null,this.notifyChange("state")}_toQueryString(e){return e&&typeof e!="string"?Object.keys(e).map(t=>`${t}:${e[t]}`).join(" AND "):e}_updateBasemaps(e=[]){let t=this.filterFunction?e.filter(this.filterFunction):e;t=this.updateBasemapsCallback?this.updateBasemapsCallback(t):t,this.basemaps.removeAll(),this.basemaps.addMany(t)}};f([y({readOnly:!0,type:Zge})],sm.prototype,"basemaps",void 0),f([y()],sm.prototype,"filterFunction",void 0),f([y({type:cz})],sm.prototype,"portal",void 0),f([y()],sm.prototype,"query",void 0),f([y({readOnly:!0})],sm.prototype,"state",null),f([y()],sm.prototype,"updateBasemapsCallback",void 0),sm=f([ge("esri.widgets.BasemapGallery.support.PortalBasemapsSource")],sm);const PI=sm,Qge=_i.ofType(Kge);function TCt(i){return i&&i.declaredClass==="esri.portal.Portal"}function SCt(i){return i&&!(i instanceof PI)&&(!!i.portal||!!i.query)}function ECt(i){return i&&"basemaps"in i&&"state"in i&&"refresh"in i}let Zu=class extends Ba(q0){constructor(e){super(e),this._loadingProjectionEngine=!1,this.items=new Qge,this.source=new PI,this.view=null}initialize(){const e=()=>this._recreateItems();this.handles.add([ue(()=>this.state==="ready"?this.compatibilityFunction:null,()=>this._updateItems()),Sn(()=>{var t;return(t=this.source)==null?void 0:t.basemaps},"change",e,{onListenerAdd:e})])}get activeBasemap(){var e,t;return((t=(e=this.view)==null?void 0:e.map)==null?void 0:t.basemap)??null}set activeBasemap(e){var r,s;if(!this.view.map)return;const t=typeof e=="string"?Dx.fromId(e):e;if(!t||!this.view.ready)return this.view.map.basemap=t,void this._clearOverride("activeBasemap");const n=t.spatialReference||((s=(r=this.items)==null?void 0:r.find(a=>this.basemapEquals(t,a.basemap)))==null?void 0:s.spatialReference);if(n&&"spatialReferenceLocked"in this.view&&!this.view.spatialReferenceLocked){const a=this.view.spatialReference;if(T(n)&&!Vc(a,n)&&!$y(this.view.spatialReference,n)&&!Y0())return this._override("activeBasemap",t),this._loadingProjectionEngine=!0,void MC().then(()=>{this._get("activeBasemap")===e&&(this.view.map.basemap=e,this.view.spatialReference=n,this._clearOverride("activeBasemap"))},()=>{}).then(()=>{this._loadingProjectionEngine=!1});this.view.map.basemap=t,this._clearOverride("activeBasemap"),T(n)&&!Vc(this.view.spatialReference,n)&&(this.view.spatialReference=n)}else this.view.map.basemap=t,this._clearOverride("activeBasemap")}get activeBasemapIndex(){const{state:e,items:t,activeBasemap:n}=this;if(e!=="ready")return-1;const r=t.findIndex(s=>s.basemap===n);return r===-1?t.findIndex(s=>this.basemapEquals(s.basemap,n)):r}get compatibilityFunction(){var e;return((e=this.view)==null?void 0:e.type)==="3d"?bCt:wCt}set compatibilityFunction(e){this._overrideIfSome("compatibilityFunction",e)}castSource(e){return Array.isArray(e)||_i.isCollection(e)?new Xge({basemaps:e}):TCt(e)?new PI({portal:e}):SCt(e)?new PI(e):ECt(e)?e:null}get state(){var e;return(e=this.view)!=null&&e.ready&&this.source?this._loadingProjectionEngine?"loading":"ready":"disabled"}basemapEquals(e,t){return qZe(e,t)}refresh(){this._recreateItems()}load(e){return this.addResolvingPromise(q0.isLoadable(this.source)?this.source.load(e):null),Promise.resolve(this)}_recreateItems(){var r;const e=(r=this.source)==null?void 0:r.basemaps,{view:t,compatibilityFunction:n}=this;this.items.removeAll().forEach(s=>s.destroy()),e&&this.items.addMany(e.map(s=>new Kge({basemap:s,compatibilityFunction:n,view:t})))}_updateItems(){for(const e of this.items)e.compatibilityFunction=this.compatibilityFunction,e.view=this.view}};f([y()],Zu.prototype,"_loadingProjectionEngine",void 0),f([y()],Zu.prototype,"activeBasemap",null),f([y({readOnly:!0})],Zu.prototype,"activeBasemapIndex",null),f([y()],Zu.prototype,"compatibilityFunction",null),f([y({readOnly:!0,type:Qge})],Zu.prototype,"items",void 0),f([y()],Zu.prototype,"source",void 0),f([Mr("source")],Zu.prototype,"castSource",null),f([y({readOnly:!0})],Zu.prototype,"state",null),f([y()],Zu.prototype,"view",void 0),Zu=f([ge("esri.widgets.BasemapGallery.BasemapGalleryViewModel")],Zu);const ACt=Zu,Qc={base:"esri-basemap-gallery esri-widget esri-widget--panel-height-only",sourceLoading:"esri-basemap-gallery--source-loading",loader:"esri-basemap-gallery__loader",item:"esri-basemap-gallery__item",itemContainer:"esri-basemap-gallery__item-container",itemTitle:"esri-basemap-gallery__item-title",itemThumbnail:"esri-basemap-gallery__item-thumbnail",selectedItem:"esri-basemap-gallery__item--selected",itemError:"esri-basemap-gallery__item--error",emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled",loaderAnimation:"esri-widget__loader-animation"};let au=class extends gr{constructor(e,t){super(e,t),this._handles=new mi,this._focusBasemapItemEnabled=!1,this.disabled=!1,this.headingLevel=2,this.iconClass=Qc.widgetIcon,this.messages=null,this.viewModel=new ACt}initialize(){const e=this._handles;this.addHandles([Sn(()=>this.viewModel.items,"change",t=>{const n="basemap-gallery-item-changes",{added:r,moved:s}=t;e.remove(n),e.add([...r,...s].map(a=>ue(()=>a.state,()=>this.scheduleRender())),n),this.scheduleRender()}),rs(()=>this.source,()=>this.viewModel.load(),{initial:!0,once:!0})])}destroy(){this._handles.destroy()}loadDependencies(){return Ee(()=>import("./calcite-scrim-99bf204f.js"),["./calcite-scrim-99bf204f.js","./scrim-41440f97.js","./dom-5b7af1bf.js","./loader-632408c9.js","./guid-e49c4e43.js"],import.meta.url)}get activeBasemap(){return this.viewModel.activeBasemap}set activeBasemap(e){this.viewModel.activeBasemap=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get source(){return this.viewModel.source}set source(e){this.viewModel.source=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e=this.source.state==="loading",t=this.disabled||this.viewModel.state==="disabled",n=this.viewModel.items.map((o,l)=>this._renderBasemapGalleryItem(o,l)).toArray(),r={[Qc.sourceLoading]:e,[Qc.disabled]:t},s=e?z("div",{class:Qc.loader,key:"esri-basemap-gallery__loader"}):null,a=e?null:n.length>0?z("ul",{bind:this,"aria-disabled":this.disabled,"aria-label":this.label,class:Qc.itemContainer,key:"esri-basemap-gallery__item-container",onkeydown:this._handleKeyDown,role:"radiogroup"},n):z("div",{class:Qc.emptyMessage,key:"esri-basemap-gallery__empty-message"},z(Ul,{level:this.headingLevel},this.messages.noBasemaps));return z("div",{class:this.classes(Qc.base,r)},s,a)}_getRoundRobinIndex(e,t){return(e+t)%t}_handleKeyDown(e){const{key:t}=e;if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t))return;e.preventDefault();const{items:n,activeBasemapIndex:r}=this.viewModel,s=t==="ArrowUp"||t==="ArrowLeft"?this._getRoundRobinIndex(Math.max(r-1,-1),n.length):this._getRoundRobinIndex(r+1,n.length),a=n.getItemAt(s);(a==null?void 0:a.state)==="ready"&&(this.viewModel.activeBasemap=a.basemap),this._focusBasemapItemEnabled=!0}_focusBasemapItem(e){this._focusBasemapItemEnabled&&e.tabIndex===0&&(e.focus(),this._focusBasemapItemEnabled=!1)}_handleClick(e){const t=e.currentTarget["data-item"];t.state==="ready"&&(this.viewModel.activeBasemap=t.basemap)}_renderBasemapGalleryItem(e,t){var g,_;const n=e.basemap.thumbnailUrl||zx("esri/themes/base/images/basemap-toggle-64.svg"),r=e.basemap.title,s=(g=e.basemap.portalItem)==null?void 0:g.snippet,a=((_=e.error)==null?void 0:_.message)||s||r,{viewModel:{state:o,activeBasemapIndex:l}}=this,c=this.disabled||o==="disabled",u=l===t,d=u||l===-1&&t===0?0:-1,h=o==="loading",p={[Qc.selectedItem]:u,[Qc.itemError]:e.state==="error"},m=`basemapgallery-item-${e.uid}`;return z("li",{"aria-checked":u.toString(),"aria-disabled":c.toString(),"aria-labelledby":m,bind:this,class:this.classes(Qc.item,p),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"radio",tabIndex:d,afterUpdate:this._focusBasemapItem,title:a},z("img",{alt:"",class:Qc.itemThumbnail,src:n}),z("div",{id:m,class:Qc.itemTitle},r),e.state==="loading"||u&&h?z("calcite-scrim",null,z("span",{"aria-hidden":"true",role:"presentation",class:Qc.loaderAnimation})):null)}};f([y()],au.prototype,"activeBasemap",null),f([y()],au.prototype,"disabled",void 0),f([y()],au.prototype,"headingLevel",void 0),f([y()],au.prototype,"iconClass",void 0),f([y()],au.prototype,"label",null),f([y(),En("esri/widgets/BasemapGallery/t9n/BasemapGallery")],au.prototype,"messages",void 0),f([y()],au.prototype,"source",null),f([y()],au.prototype,"view",null),f([y()],au.prototype,"viewModel",void 0),f([dr()],au.prototype,"_handleClick",null),au=f([ge("esri.widgets.BasemapGallery")],au);const MCt=au;let am=class extends wU(Pn.EventedAccessor){constructor(e){super(e),this._initialViewpoint=null,this._goingHomeController=null,this.go=this.go.bind(this)}destroy(){this._cancelGo(),this.view=null}get state(){return this.get("view.ready")?this._goingHomeController?"going-home":"ready":"disabled"}set view(e){this._initialViewpoint=null,this._set("view",e),e&&e.when().then(()=>{this.view===e&&(this._initialViewpoint=e.viewpoint.clone(),this.notifyChange("viewpoint"))})}get viewpoint(){return this._get("viewpoint")||this._initialViewpoint}set viewpoint(e){this._set("viewpoint",e)}async go(){if(!this.get("view.ready"))throw new Ze("home:disabled-state","Cannot go when disabled.");this._cancelGo(),this.emit("go");const e=new AbortController;this._goingHomeController=e;try{await this.view.when(),await this.callGoTo({target:this.viewpoint,options:{signal:e.signal}})}catch{}this._goingHomeController=null}cancelGo(){this._cancelGo()}_cancelGo(){const{_goingHomeController:e}=this;e&&e.abort(),this._goingHomeController=null}};f([y()],am.prototype,"_goingHomeController",void 0),f([y({readOnly:!0})],am.prototype,"state",null),f([y()],am.prototype,"view",null),f([y({type:ga})],am.prototype,"viewpoint",null),f([y()],am.prototype,"go",null),f([y()],am.prototype,"cancelGo",null),am=f([ge("esri.widgets.Home.HomeViewModel")],am);const Jge=am,G1={base:"esri-home esri-widget--button esri-widget",esriIcon:"esri-icon",loadingIcon:"esri-icon-loading-indicator",rotatingIcon:"esri-rotating",widgetIcon:"esri-icon-home",disabled:"esri-disabled"};let ou=class extends gr{constructor(e,t){super(e,t),this.iconClass=G1.widgetIcon,this.messages=null,this.messagesCommon=null,this.viewModel=new Jge}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get viewpoint(){return this.viewModel.viewpoint}set viewpoint(e){this.viewModel.viewpoint=e}cancelGo(){this.viewModel.cancelGo()}go(){return this.viewModel.go()}render(){var s;const e=(s=this.viewModel)==null?void 0:s.state,{messagesCommon:t,messages:n}=this,r={[G1.disabled]:e==="disabled"};return z("div",{bind:this,class:this.classes(G1.base,r),role:"button",tabIndex:0,onclick:this._go,onkeydown:this._go,"aria-label":n.widgetLabel,title:e==="going-home"?t.cancel:n.title},this.renderIcon())}renderIcon(){var n;const e=(n=this.viewModel)==null?void 0:n.state,t={[G1.esriIcon]:!0,[this.iconClass]:e!=="going-home",[G1.loadingIcon]:e==="going-home",[G1.rotatingIcon]:e==="going-home"};return z("span",{"aria-hidden":"true",class:this.classes(t)})}_go(){const{viewModel:e}=this;e.state==="going-home"?e.cancelGo():e.go()}};f([y()],ou.prototype,"goToOverride",null),f([y()],ou.prototype,"iconClass",void 0),f([y()],ou.prototype,"label",null),f([y(),En("esri/widgets/Home/t9n/Home")],ou.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],ou.prototype,"messagesCommon",void 0),f([y()],ou.prototype,"uiStrings",void 0),f([y()],ou.prototype,"view",null),f([y({type:Jge}),WC("go")],ou.prototype,"viewModel",void 0),f([y()],ou.prototype,"viewpoint",null),f([dr()],ou.prototype,"_go",null),ou=f([ge("esri.widgets.Home")],ou);const PCt=ou;function eve(i){return B(i)||i.type==="simple"||i.type==="unique-value"||i.type==="class-breaks"||i.type==="dictionary"||i.type==="heatmap"}function Q8t(i,e){if(B(i))return null;if(!eve(i))return new Ze("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${i.type||i.declaredClass}'`,{renderer:i});switch(i.type){case"simple":return OCt(i);case"unique-value":return RCt(i,e);case"class-breaks":return ICt(i);case"dictionary":case"heatmap":return null}return null}function QH(i,e){if(!e)return null;let t;if(t=Array.isArray(e)?e:[e],t.length>0){const n=t.map(s=>s.details.symbol.type||s.details.symbol.declaredClass).filter(s=>!!s);n.sort();const r=[];return n.forEach((s,a)=>{a!==0&&s===n[a-1]||r.push(s)}),new Ze("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${r.join(", ")}) which are not supported in 3D`,{renderer:i,symbolErrors:t})}return null}function OCt(i){return QH(i,Yx(i.symbol).error)}function RCt(i,e){var s;const t={...sxe,...e},n=(s=i.uniqueValueInfos)==null?void 0:s.map(a=>Yx(a.symbol,t).error).filter(T),r=Yx(i.defaultSymbol,t);return r.error&&(n==null||n.unshift(r.error)),QH(i,n)}function ICt(i){const e=i.classBreakInfos.map(n=>Yx(n.symbol).error).filter(T),t=Yx(i.defaultSymbol);return t.error&&e.unshift(t.error),QH(i,e)}const $Ct=(i,e)=>{const t=i.featuresTilingScheme.getClosestInfoForScale(i.scale).level;return e!=null&&e.levels?e.levels[t]:null};function LCt(i,e){if(!i||!("visualVariables"in i)||!i.visualVariables)return null;const t=i.visualVariables.find(r=>r.type==="size"),n=$Ct(e,t);return n?new uxe({field:t.field,minSize:n[2].size,minDataValue:n[2].value,maxSize:n[3].size,maxDataValue:n[3].value}):null}const m0=wa.size,OI=wa.maxSize,JH=wa.maxOutlineSize,Pte=wa.lineWidth,G8=wa.tallSymbolWidth;function tx(i){const e=i.outline,t=T(i.material)?i.material.color:null,n=T(t)?t.toHex():null;if(B(e)||"pattern"in e&&T(e.pattern)&&e.pattern.type==="style"&&e.pattern.style==="none")return i.type==="fill"&&n==="#ffffff"?{color:"#bdc3c7",width:.75}:null;const r=Hn(e.size)||0;return{color:"rgba("+(T(e.color)?e.color.toRgba():"255,255,255,1")+")",width:Math.min(r,JH),style:"pattern"in e&&T(e.pattern)&&e.pattern.type==="style"?Vie(e.pattern.style):null,join:"butt",cap:"patternCap"in e?e.patternCap:"butt"}}function DCt(i,e){const t=e&&e.resource,n=t&&t.href;if(i.thumbnail&&i.thumbnail.url)return Promise.resolve(i.thumbnail.url);if(n&&e.type!=="object")return Promise.resolve(Nie(i,e));const r=zx("esri/images/Legend/legend3dsymboldefault.png");return i.styleOrigin&&(i.styleOrigin.styleName||i.styleOrigin.styleUrl)?hxe(i.styleOrigin,{portal:i.styleOrigin.portal},"webRef").catch(s=>s).then(s=>{var a;return((a=s==null?void 0:s.thumbnail)==null?void 0:a.url)||r}):Promise.resolve(r)}function pN(i,e=1){const t=i.a,n=mB(i),r=n.h,s=n.s/e,a=100-(100-n.v)/e,{r:o,g:l,b:c}=jie({h:r,s,v:a});return[o,l,c,t]}function SL(i){return i.type==="water"?B(i.color)?null:i.color:B(i.material)||B(i.material.color)?null:i.material.color}function Qn(i,e=0){const t=SL(i);if(!t){if(i.type==="fill")return null;const r=S_e.r,s=cy(r,e);return[s,s,s,100]}const n=t.toRgba();for(let r=0;r<3;r++)n[r]=cy(n[r],e);return n}async function tve(i,e){const t=i.style;return t==="none"?null:{type:"pattern",x:0,y:0,src:await E_e(zx(`esri/symbols/patterns/${t}.png`),e.toCss(!0)),width:5,height:5}}function Ote(i){return i.outline?tx(i):{color:"rgba(0, 0, 0, 1)",width:1.5}}function ive(i,e){const t=SL(i);if(!t)return null;let n="rgba(";return n+=cy(t.r,e)+",",n+=cy(t.g,e)+",",n+=cy(t.b,e)+",",n+t.a+");"}function W8(i,e){const t=ive(i,e);return t?"pattern"in i&&T(i.pattern)&&i.pattern.type==="style"&&i.pattern.style==="none"?null:{color:t,width:Math.min(i.size?Hn(i.size):.75,JH),style:"pattern"in i&&T(i.pattern)&&i.pattern.type==="style"?Vie(i.pattern.style):null,cap:"cap"in i?i.cap:null,join:"join"in i?i.join==="miter"?Hn(2):i.join:null}:{}}function HO(i,e,t){const n=t!=null?.75*t:0;return{type:"linear",x1:n?.25*n:0,y1:n?.5*n:0,x2:n||4,y2:n?.5*n:4,colors:[{color:i,offset:0},{color:e,offset:1}]}}function kCt(i){const e=i.depth,t=i.height,n=i.width;return n!==0&&e!==0&&t!==0&&n===e&&n!=null&&t!=null&&n<t}function FCt(i,e,t){const n=[];if(!i)return n;switch(i.type){case"icon":{const a=e,o=e;switch(i.resource&&i.resource.primitive||zie){case"circle":n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:Qn(i,0),stroke:tx(i)});break;case"square":n.push({shape:{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[0,0]},{command:"L",values:[a,0]},{command:"L",values:[a,o]},{command:"Z",values:[]}]},fill:Qn(i,0),stroke:tx(i)});break;case"triangle":n.push({shape:{type:"path",path:[{command:"M",values:[0,o]},{command:"L",values:[.5*a,0]},{command:"L",values:[a,o]},{command:"Z",values:[]}]},fill:Qn(i,0),stroke:tx(i)});break;case"cross":n.push({shape:{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[.5*a,o]},{command:"M",values:[0,.5*o]},{command:"L",values:[a,.5*o]}]},stroke:Ote(i)});break;case"x":n.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,o]},{command:"M",values:[a,0]},{command:"L",values:[0,o]}]},stroke:Ote(i)});break;case"kite":n.push({shape:{type:"path",path:[{command:"M",values:[0,.5*o]},{command:"L",values:[.5*a,0]},{command:"L",values:[a,.5*o]},{command:"L",values:[.5*a,o]},{command:"Z",values:[]}]},fill:Qn(i,0),stroke:tx(i)})}break}case"object":switch(i.resource&&i.resource.primitive||hB){case"cone":{const r=HO(Qn(i,0),Qn(i,-.6),t?G8:e),s=JJe(e,t);n.push({shape:s[0],fill:r}),n.push({shape:s[1],fill:r});break}case"inverted-cone":{const r=Qn(i,0),s=HO(r,Qn(i,-.6),e),a=eet(e);n.push({shape:a[0],fill:s}),n.push({shape:a[1],fill:r});break}case"cube":{const r=ZJe(e,t);n.push({shape:r[0],fill:Qn(i,0)}),n.push({shape:r[1],fill:Qn(i,-.3)}),n.push({shape:r[2],fill:Qn(i,-.5)});break}case"cylinder":{const r=HO(Qn(i,0),Qn(i,-.6),t?G8:e),s=QJe(e,t);n.push({shape:s[0],fill:r}),n.push({shape:s[1],fill:r}),n.push({shape:s[2],fill:Qn(i,0)});break}case"diamond":{const r=tet(e);n.push({shape:r[0],fill:Qn(i,-.3)}),n.push({shape:r[1],fill:Qn(i,0)}),n.push({shape:r[2],fill:Qn(i,-.3)}),n.push({shape:r[3],fill:Qn(i,-.7)});break}case"sphere":{const r=HO(Qn(i,0),Qn(i,-.6));r.x1=0,r.y1=0,r.x2=.25*e,r.y2=.25*e,n.push({shape:{type:"circle",cx:0,cy:0,r:.5*e},fill:r});break}case"tetrahedron":{const r=iet(e);n.push({shape:r[0],fill:Qn(i,-.3)}),n.push({shape:r[1],fill:Qn(i,0)}),n.push({shape:r[2],fill:Qn(i,-.6)});break}}break}return n}function UD(i){const e=typeof(i==null?void 0:i.size)=="number"?i==null?void 0:i.size:null;return e?Hn(e):null}function NCt(i){return i.type==="icon"?"multiply":"tint"}function VCt(i,e){const t=UD(e),n=e!=null&&e.maxSize?Hn(e.maxSize):null,r=(e==null?void 0:e.disableUpsampling)??!1,s=i.symbolLayers,a=[];let o=0,l=0;const c=s.getItemAt(s.length-1);let u;return c&&c.type==="icon"&&(u=c.size&&Hn(c.size)),s.forEach(d=>{var m;if(d.type!=="icon"&&d.type!=="object")return;const h=d.type==="icon"?d.size&&Hn(d.size):0,p=t||h?Math.ceil(Math.min(t||h,n||OI)):m0;if(d&&d.resource&&d.resource.href){const g=DCt(i,d).then(_=>{const b=d.get("material.color"),x=NCt(d);return wet(_,p,b,x,r)}).then(_=>{const b=_.width,x=_.height;return o=Math.max(o,b),l=Math.max(l,x),[{shape:{type:"image",x:0,y:0,width:b,height:x,src:_.url},fill:null,stroke:null}]});a.push(g)}else{let g=p;d.type==="icon"&&u&&t&&(g=p*(h/u));const _=(e==null?void 0:e.symbolConfig)==="tall"||((m=e==null?void 0:e.symbolConfig)==null?void 0:m.isTall)||d.type==="object"&&kCt(d);o=Math.max(o,_?G8:g),l=Math.max(l,g),a.push(Promise.resolve(FCt(d,g,_)))}}),Ra(a).then(d=>{const h=[];return d.forEach(p=>{p.value?h.push(p.value):p.error&&tt.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",p.error)}),fM(h,[o,l],{node:e&&e.node,scale:!1,opacity:e&&e.opacity})})}function BCt(i,e){const t=i.symbolLayers,n=[],r=HL(i),s=UD(e),a=(e&&e.maxSize?Hn(e.maxSize):null)||JH;let o,l=0,c=0;return t.forEach((u,d)=>{if(!u||u.type!=="line"&&u.type!=="path")return;const h=[];switch(u.type){case"line":{const p=W8(u,0);if(B(p))break;const m=p&&p.width||0;d===0&&(o=m);const g=Math.min(s||m,a),_=d===0?g:s?g*(m/o):g,b=_>Pte/2?2*_:Pte;c=Math.max(c,_),l=Math.max(l,b),p.width=_,h.push({shape:{type:"path",path:[{command:"M",values:[0,.5*c]},{command:"L",values:[l,.5*c]}]},stroke:p});break}case"path":{const p=Math.min(s||m0,a),m=Qn(u,0),g=Qn(u,-.2),_=ive(u,-.4),b=_?{color:_,width:1}:{};if(u.profile==="quad"){const x=u.width,w=u.height,C=KJe(x&&w?x/w:1,w===0,x===0),S={...b,join:"bevel"};h.push({shape:C[0],fill:g,stroke:S}),h.push({shape:C[1],fill:g,stroke:S}),h.push({shape:C[2],fill:m,stroke:S})}else h.push({shape:WV.pathSymbol3DLayer[0],fill:g,stroke:b}),h.push({shape:WV.pathSymbol3DLayer[1],fill:m,stroke:b});c=Math.max(c,p),l=c}}n.push(h)}),Promise.resolve(fM(n,[l,c],{node:e&&e.node,scale:r,opacity:e&&e.opacity}))}async function zCt(i,e){const t=i.type==="mesh-3d",n=i.symbolLayers,r=UD(e),s=e&&e.maxSize?Hn(e.maxSize):null,a=r||m0,o=[];let l=0,c=0,u=!1;for(let d=0;d<n.length;d++){const h=n.getItemAt(d),p=[];if(t&&h.type!=="fill")continue;const m=WV.fill[0];switch(h.type){case"fill":{const g=tx(h),_=Math.min(a,s||OI);l=Math.max(l,_),c=Math.max(c,_),u=!0;let b=Qn(h,0);const x="pattern"in h?h.pattern:null,w=SL(h);!t&&T(x)&&x.type==="style"&&x.style!=="solid"&&w&&(b=await tve(x,w)),p.push({shape:m,fill:b,stroke:g});break}case"line":{const g=W8(h,0);if(B(g))break;const _={stroke:g,shape:m};l=Math.max(l,m0),c=Math.max(c,m0),p.push(_);break}case"extrude":{const g={join:"round",width:1,...W8(h,-.4)},_=Qn(h,0),b=Qn(h,-.2),x=Math.min(a,s||OI),w=YJe(x);g.width=1,p.push({shape:w[0],fill:b,stroke:g}),p.push({shape:w[1],fill:b,stroke:g}),p.push({shape:w[2],fill:_,stroke:g});const C=m0,S=.7*m0+.5*x;l=Math.max(l,C),c=Math.max(c,S);break}case"water":{const g=NL(SL(h)),_=pN(g),b=pN(g,2),x=pN(g,3),w=XJe();u=!0,p.push({shape:w[0],fill:_}),p.push({shape:w[1],fill:b}),p.push({shape:w[2],fill:x});const C=Math.min(a,s||OI);l=Math.max(l,C),c=Math.max(c,C);break}}o.push(p)}return fM(o,[l,c],{node:e&&e.node,scale:u,opacity:e&&e.opacity})}function UCt(i,e){if(i.symbolLayers.length===0)return Promise.reject(new Ze("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(i.type){case"point-3d":return VCt(i,e);case"line-3d":return BCt(i,e);case"polygon-3d":case"mesh-3d":return zCt(i,e)}return Promise.reject(new Ze("symbolPreview: swatchInfo3D","symbol not supported."))}const HCt=Object.freeze(Object.defineProperty({__proto__:null,getPatternDescriptor:tve,getSizeFromOptions:UD,getSymbolLayerFill:Qn,previewSymbol3D:UCt},Symbol.toStringTag,{value:"Module"})),Rte={HH:315,HL:45,LL:135,LH:225},GCt={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};function WCt(i){if(!i)return;const{type:e}=i;if(e.includes("3d"))return Qn(i.symbolLayers.getItemAt(0));if(e==="simple-line"){const t=FN(i);return t&&t.color}if(i.type==="simple-marker"&&(i.style==="x"||i.style==="cross")){const t=FN(i);return t&&t.color}return A_e(i)}function jCt(i,e){const t=e.HH.label,n=e.LL.label,r=e.HL.label,s=e.LH.label;switch(i){case"HH":default:return{top:t,bottom:n,left:r,right:s};case"HL":return{top:r,bottom:s,left:n,right:t};case"LL":return{top:n,bottom:t,left:s,right:r};case"LH":return{top:s,bottom:r,left:t,right:n}}}function qCt(i){const{focus:e,infos:t,numClasses:n}=i,r=GCt[n],s={};t.forEach(o=>{s[o.value]={label:o.label,fill:WCt(o.symbol)}});const a=[];for(let o=0;o<n;o++){const l=[];for(let c=0;c<n;c++){const u=s[r[o][c]];l.push(u.fill)}a.push(l)}return{type:"relationship-ramp",numClasses:n,focus:e,colors:a,labels:jCt(e,s),rotation:nve(e)}}function nve(i){let e=Rte[i];return i&&e==null&&(e=Rte.HH),e||0}const j8=30,q8=12,rve=[255,255,255],sve=[200,200,200],ix=[128,128,128],KCt=20,YCt=5;function XCt(i){return i.declaredClass==="esri.symbols.SimpleMarkerSymbol"}function ZCt(i){return i.declaredClass==="esri.symbols.PictureMarkerSymbol"}function QCt(i){return i.declaredClass==="esri.symbols.SimpleLineSymbol"}function JCt(i){return i.declaredClass==="esri.symbols.TextSymbol"}function eTt(i,e){const t=i.length-1;return i.map((n,r)=>Rue(n,r,t,e))}async function tTt(i,e,t,n,r,s,a){const o=e.legendOptions,l=o&&o.customValues,c=a||await rTt(i,t),u=!!c,d=!!l,h=e.minSize!=null&&e.maxSize!=null,p=e.stops&&e.stops.length>1,m=!!e.target;if(!u||!d&&!(h||p&&!m))return;const g=HL(c);let _=null,b=null,x=null;b=g&&!p?M$([e.minDataValue,e.maxDataValue]):l||await aTt(e,c,n,r);const w=i==null?void 0:i.authoringInfo,C=(w==null?void 0:w.type)==="univariate-color-size",S=C&&(w==null?void 0:w.univariateTheme)==="above-and-below";if(!b&&p&&(b=e.stops.map(O=>O.value),_=e.stops.some(O=>!!O.label),i.type==="flow"&&(b=M$(b)),_&&(x=e.stops.map(O=>O.label))),g&&(b==null?void 0:b.length)>2&&!S&&(b=[b[0],b[b.length-1]]),!b)return null;C&&(b==null?void 0:b.length)!==5&&(b=lve({minSize:b[0],maxSize:b[b.length-1]}));const E=g?iTt(i,b):null,A=M_e(c),P=_?null:eTt(b,s);return(await Promise.all(b.map(async(O,M)=>{const V=g?E[M]:await xw(e,c,O,n,r);return{value:O,symbol:cTt(S&&i.type==="class-breaks"?nTt(i,M):c,V),label:_?x[M]:P[M],size:V,outlineSize:A}}))).reverse()}function iTt(i,e){const t=i==null?void 0:i.authoringInfo,n=(t==null?void 0:t.type)==="univariate-color-size";let r=[q8,j8];if(n){const s=e[0],a=e[e.length-1],o=q8,l=j8;r=e.map(c=>o+(c-s)/(a-s)*(l-o))}return n&&(t==null?void 0:t.univariateTheme)==="below"&&r.reverse(),r}function nTt(i,e){const t=i.classBreakInfos,n=t.length,r=n<2||!(e>=2)?t[0].symbol.clone():t[n-1].symbol.clone();return i.visualVariables.some(s=>s.type==="color")&&(r.type.includes("3d")?ave(r):ove(r)),r}async function rTt(i,e){var r;if(i.type==="flow")return Iue(i,e);if(i.type==="pie-chart")return new wh({color:null,outline:(r=i.outline)!=null&&r.width?i.outline:new s2});let t=null,n=null;if(i.type==="simple")t=i.symbol;else if(i.type==="class-breaks"){const s=i.classBreakInfos;t=s&&s[0]&&s[0].symbol,n=s.length>1}else if(i.type==="unique-value"){const s=i.uniqueValueInfos;t=s&&s[0]&&s[0].symbol,n=s.length>1}return!t||sTt(t)?null:(t=t.clone(),(e||n)&&(t.type.includes("3d")?ave(t):ove(t)),t)}function sTt(i){return i?Uie(i)?!!i.symbolLayers&&i.symbolLayers.some(e=>e&&e.type==="fill"):i.type.includes("fill"):!1}function ave(i){i.type==="line-3d"?i.symbolLayers.forEach(e=>{e.material={color:ix}}):i.symbolLayers.forEach(e=>{e.type!=="icon"||e.resource&&e.resource.href?e.material={color:sve}:(e.material={color:rve},e.outline={color:ix,size:1.5})})}function ove(i){var t,n;const e=oA();i.type==="cim"?_re(i,new Xt(sve)):i.type.includes("line")?i.color=ix:(i.color=e?ix:rve,i.type==="simple-marker"&&(i.outline?((n=(t=i.outline)==null?void 0:t.color)==null?void 0:n.toHex())==="#ffffff"&&(i.outline.color=ix):i.outline={color:ix,width:1.5}))}async function aTt(i,e,t,n){const r=(await Ee(()=>import("./visualVariableUtils-c59ab38d.js"),["./visualVariableUtils-c59ab38d.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./Graphic-b46e2684.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url)).getSizeRangeAtScale(i,t,n),s=r&&lve(r);if(!r&&!s)return;let a=s.map(o=>oTt(o,i,r));a=M$(a);for(let o=1;o<a.length-1;o++){const l=await lTt(i,e,a[o],a[o-1],t,n);l&&(a[o]=l[0],s[o]=l[1])}return a}function lve(i){const e=i.minSize,t=i.maxSize,n=YCt,r=(t-e)/(n-1),s=[];for(let a=0;a<n;a++)s.push(e+r*a);return s}function oTt(i,e,t){const n=t.minSize,r=t.maxSize,s=e.minDataValue,a=e.maxDataValue;let o=null;return i<=n?o=s:i>=r?o=a:o=(i-n)/(r-n)*(a-s)+s,o}async function lTt(i,e,t,n,r,s){const a=await xw(i,e,t,r,s),o=await xw(i,e,n,r,s),l=A$(t),c=l.fractional,u=KCt;let d=l.integer,h=null,p=null;t>0&&t<1&&(h=10**c,d=A$(t*=h).integer);for(let m=d-1;m>=0;m--){const g=10**m;let _=Math.floor(t/g)*g,b=Math.ceil(t/g)*g;h!=null&&(_/=h,b/=h);let x=(_+b)/2;[,x]=M$([_,x,b],{indexes:[1]});const w=await xw(i,e,_,r,s),C=await xw(i,e,b,r,s),S=await xw(i,e,x,r,s),E=BR(a,w,o,null),A=BR(a,C,o,null),P=BR(a,S,o,null);let O=E.previous<=u,M=A.previous<=u;if(O&&M&&(E.previous<=A.previous?(O=!0,M=!1):(M=!0,O=!1)),O?p=[_,w]:M?p=[b,C]:P.previous<=u&&(p=[x,S]),p)break}return p}async function xw(i,e,t,n,r){const{getSize:s}=await Ee(()=>import("./visualVariableUtils-c59ab38d.js"),["./visualVariableUtils-c59ab38d.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./Graphic-b46e2684.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url);return s(i,t,{scale:n,view:r,shape:e.type==="simple-marker"?e.style:null})}function cTt(i,e){const t=i.clone();if(Uie(t))HL(t)||t.symbolLayers.forEach(n=>{n.type!=="fill"&&(n.size=e)});else if(XCt(t))t.size=e;else if(ZCt(t)){const n=t.width,r=t.height;t.height=e,t.width=e*(n/r)}else QCt(t)?t.width=e:JCt(t)&&t.font&&(t.font.size=e);return t}function uTt(i){const t=Math.floor(Math.log10(Math.abs(i)))+1,n=t<4||t>6?4:t,r=1e6,s=Math.abs(i)>=r?"compact":"standard";return lg(i,{notation:s,minimumSignificantDigits:2,maximumSignificantDigits:n})}const dTt="https://utility.arcgis.com/sharing/tools/legend",hTt="esri.layers.ImageryLayer",pTt="esri.layers.ImageryTileLayer",fTt="esri.layers.WCSLayer",GO=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,mTt=new oxe({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ite={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34e38,34e38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE]},WO=new wh({size:6,outline:{color:[128,128,128,.5],width:.5}}),gTt=new a2({style:"solid"});function K8(i){return i.type==="flow"}function cve(i){return i.type==="vector-field"}function uve(i){return i.type==="raster-colormap"}function dve(i){return i.type==="raster-stretch"}function hve(i){return i.type==="raster-shaded-relief"}function Cw(i){return i.declaredClass==="esri.renderers.SimpleRenderer"}function Tw(i){return i.declaredClass==="esri.renderers.ClassBreaksRenderer"}function RI(i){return i.declaredClass==="esri.renderers.UniqueValueRenderer"}function pve(i){return i.declaredClass==="esri.renderers.HeatmapRenderer"}function vTt(i){return eG(i)||tG(i)||iG(i)||yTt(i)}function yTt(i){return i.declaredClass==="esri.renderers.PointCloudRGBRenderer"}function eG(i){return i.declaredClass==="esri.renderers.PointCloudClassBreaksRenderer"}function tG(i){return i.declaredClass==="esri.renderers.PointCloudStretchRenderer"}function iG(i){return i.declaredClass==="esri.renderers.PointCloudUniqueValueRenderer"}function fve(i){return i.declaredClass==="esri.renderers.DotDensityRenderer"}function mve(i){return i.declaredClass==="esri.renderers.PieChartRenderer"}function _Tt(i,e){return Cw(i)||Tw(i)||RI(i)||pve(i)||fve(i)||mve(i)?e.type==="2d"||eve(i):dve(i)||uve(i)||hve(i)||eG(i)||tG(i)||iG(i)||cve(i)||K8(i)}function bTt(i){return i.declaredClass==="esri.layers.BuildingSceneLayer"}function $te(i){return i.declaredClass==="esri.layers.SubtypeGroupLayer"}function wTt(i){return i.declaredClass==="esri.layers.VoxelLayer"}function xTt(i){return i.declaredClass==="esri.layers.WMSLayer"}function CTt(i){return i.declaredClass==="esri.layers.WMTSLayer"}function Lte(i){return i.declaredClass==="esri.layers.MapImageLayer"}function TTt(i){return i.declaredClass==="esri.layers.TileLayer"}function STt(i){return i.declaredClass==="esri.layers.FeatureLayer"}function W1(i){return i.declaredClass===hTt}function jO(i){return i.declaredClass===pTt}function ETt(i){return i.declaredClass===fTt}function ATt(i){return i.type==="stretch-ramp"}function MTt(i){var e;return((e="authoringInfo"in i&&(i==null?void 0:i.authoringInfo))==null?void 0:e.type)==="univariate-color-size"}function PTt(i){const e="authoringInfo"in i&&(i==null?void 0:i.authoringInfo);return(e==null?void 0:e.type)==="univariate-color-size"&&(e==null?void 0:e.univariateTheme)==="above-and-below"}const OTt=new wh({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let j1={},aa=class extends et{constructor(i){super(i),this._handles=new mi,this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._webStyleSymbolCache=new Map,this._dotDensityUrlCache=new Map,this._scaleDrivenSizeVariable=null,this._hasClusterSizeVariable=!1,this.children=new _i,this.layerView=null,this.layer=null,this.legendElements=[],this.parent=null,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.sublayerIds=[],this.title=null,this.view=null}initialize(){const i=()=>this.notifyChange("ready");this._handles.add([Sn(()=>this.children,"change",e=>{const{added:t,removed:n}=e,r=this._handles;t.forEach(s=>{const a=`activeLayerInfo-ready-watcher-${s.layer.uid}`;r.add(ue(()=>s.ready,i,At),a)}),n.forEach(s=>r.remove(s.layer.uid)),i()})]),this.keepCacheOnDestroy||(j1={})}destroy(){this._handles.destroy(),this._handles=null,this._webStyleSymbolCache=null,this._dotDensityUrlCache=null,this._scaleDrivenSizeVariable=null,this.keepCacheOnDestroy||(j1=null)}get effectList(){const i=this.layer;let e=null;return"effect"in i&&i.effect&&(e=new zwe,e.effect=i.effect,e.endTransitions(),e.scale=this.scale),e}get opacity(){var r;const i=this.layer.opacity,e=(r=this.parent)==null?void 0:r.opacity,t=this.layer.parent,n=t&&"uid"in t?this._getParentLayerOpacity(t):null;return e!=null?e*i:n!=null?n*i:i}get ready(){return this.layer===null||(this.children.length>0?this._isGroupActive():this.legendElements.length>0)}get scale(){return this.view&&this.view.scale}get isScaleDriven(){const i=this.layer;if(i===null)return!1;if("effect"in i&&i.effect&&Array.isArray(i.effect))return!0;if("featureReduction"in i&&i.featureReduction){if(i.featureReduction.type==="cluster")return!0;if(i.featureReduction.type==="binning"&&"renderer"in i.featureReduction&&i.featureReduction.renderer)return this._isRendererScaleDriven(i.featureReduction.renderer)}return"renderer"in i&&i.renderer?this._isRendererScaleDriven(i.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(i){if(!(!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView()))return this.legendElements=[],void this.notifyChange("ready");const e=Array.from(i,t=>{if(STt(t))return this._getRendererLegendElements(t.renderer,{title:t.title});if(t.featureSet&&t.featureSet.features.length){const n=t.layerDefinition,r=n&&n.drawingInfo,s=r&&L_e(r.renderer),a=mTt.read(n.geometryType);return s?this._getRendererLegendElements(s,{title:t.name,geometryType:a}):(tt.getLogger(this.declaredClass).warn("drawingInfo not available!"),null)}return null});try{const t=[];await Ra(e).then(n=>{n.forEach(({value:r})=>r&&t.push(...r))}),this.legendElements=t,this.notifyChange("ready")}catch(t){tt.getLogger(this.declaredClass).warn("error while building legend for layer!",t)}}async buildLegendElementsForRenderer(i){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getRendererLegendElements(i):[],this.notifyChange("ready")}catch(e){tt.getLogger(this.declaredClass).warn("error while building legend for layer!",e)}}async buildLegendElementsForFeatureReduction(i){try{const e=!this.hideLayersNotInCurrentView||await this._isLayerInCurrentView();this.legendElements=e?await this._getLegendElementsForFeatureReduction(i):[],this.notifyChange("ready")}catch(e){tt.getLogger(this.declaredClass).warn("error while building legend for layer!",e)}}async buildLegendElementsForTools(){var e,t;const i=this.layer;if(wTt(i))this._constructLegendElementsForVoxellayer();else if(CTt(i))this._constructLegendElementsForWMTSlayer();else if(xTt(i))await this._constructLegendElementsForWMSSublayers();else if(bTt(i))await this._constructLegendElementsForBuildingSceneLayer();else if(Lte(i)||TTt(i)||$te(i))await this._constructLegendElementsForSublayers();else{this._handles.remove("imageryLayers-watcher");let n="default";W1(i)&&(n=(((e=i==null?void 0:i.renderingRule)==null?void 0:e.functionName)||"default")+"_"+((t=i.bandIds)!=null&&t.length?i.bandIds.join(""):"###")),await this._getLegendLayers(`${i.uid}-${n}`).then(async r=>{this.legendElements=[],this.notifyChange("ready");const s=r.map(async a=>{if(W1(i)||jO(i)){const l=ue(()=>["renderingRule"in i&&i.renderingRule,i.bandIds],()=>DL(async()=>{j1.default=null,i.renderer?await this.buildLegendElementsForRenderer(i.renderer):await this.buildLegendElementsForTools()})());this._handles.add(l,"imageryLayers-watcher")}const o=this._generateSymbolTableElementForLegendLayer(a);o&&o.infos.length&&(W1(i)&&(o.title=i.title),this.legendElements.push(o)),this.notifyChange("ready")});await Ra(s)}).catch(r=>{tt.getLogger(this.declaredClass).warn("Request to server for legend has failed!",r)})}}async _isLayerInCurrentView(){const i=this.layer,e=this.layerView,t=e&&"createQuery"in e&&"queryFeatureCount"in e;if(!t&&!(e&&"createQuery"in i&&"queryFeatureCount"in i))return!0;await $u(()=>!e.updating);const n=t?"createQuery"in e&&e.createQuery():"createQuery"in i&&i.createQuery();return n.geometry=this.view.extent,(t?"queryFeatureCount"in e&&await e.queryFeatureCount(n):"queryFeatureCount"in i&&await i.queryFeatureCount(n))!==0}_getParentLayerOpacity(i){let e=1;const t=i.parent;return t&&"uid"in t&&(e=this._getParentLayerOpacity(t)),i.opacity*e}_isGroupActive(){const i=this.children;return!!i.length&&i.some(e=>e.ready)}_isRendererScaleDriven(i){if(i.type==="dot-density")return!0;const e="valueExpression"in i&&i.valueExpression;if(GO.test(e))return!0;const t="visualVariables"in i&&i.visualVariables;return!!t&&t.some(n=>this._isScaleDrivenSizeVariable(n))}_isScaleDrivenSizeVariable(i){if(i&&i.type!=="size")return!1;const e=i,t=e.minSize,n=e.maxSize;return typeof t=="object"&&t?this._isScaleDrivenSizeVariable(t):typeof n=="object"&&n?this._isScaleDrivenSizeVariable(n):!!e.expression||GO.test(e.valueExpression)}_isLayerScaleDriven(i){if("minScale"in i&&i.minScale>0||"maxScale"in i&&i.maxScale>0)return!0;if("sublayers"in i&&i.sublayers)return i.sublayers.some(t=>this._isLayerScaleDriven(t));const e=i.parent;if(i.loaded===!1&&e&&Lte(e)&&"source"in i&&i.source&&i.source.type==="map-layer"){for(const t of e.sourceJSON.layers)if(t.id===i.source.mapLayerId&&(t.minScale>0||t.maxScale>0))return!0}return!1}async _constructLegendElementsForVoxellayer(){var s;this.legendElements=[],this._handles.remove("voxel-style-watcher"),this._handles.remove("voxel-current-variable");const i=this.layer;this._handles.add(ue(()=>i.currentVariableId,()=>this._constructLegendElementsForVoxellayer()),"voxel-current-variable"),this._handles.add(ue(()=>i.getVariableStyles(),()=>this._constructLegendElementsForVoxellayer()),"voxel-style-watcher");const e=kt(i.getVariableStyle(null)),t=[];if(e){if((s=e.uniqueValues)!=null&&s.length){const a=[];e.uniqueValues.forEach(o=>{o.enabled&&a.push({label:o.label||`${o.value}`,value:o.value,symbol:new a2({color:o.color,outline:null})})}),a.length&&t.push({type:"symbol-table",title:e.label,infos:a})}else if(e.transferFunction){const{colorStops:a,stretchRange:o}=e.transferFunction,l=a.toArray().reverse(),c=o.map((d,h)=>`${h===0?Pue:Oue} ${uTt(d)}`).reverse(),u=l.map(d=>({color:d.color,value:null,label:null}));u[0].label=c[0],u[u.length-1].label=c[1],t.push({type:"color-ramp",title:e.label,infos:u,preview:O_(l.map(d=>d.color))})}}const n=i.opacity,r=t.reduce((a,o)=>a.concat(this._getAllInfos(o)),[]).filter(a=>!!(a!=null&&a.symbol)).map(a=>this._getSymbolPreview(a,n));await Ra(r),this.legendElements=t,this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[],this._handles.remove("wmts-activeLayer-watcher");const i=this.layer.activeLayer;if(this._handles.add(ue(()=>{const{layer:e}=this;return e&&"activeLayer"in e&&e.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher"),i.styleId&&i.styles){let e=null;i.styles.some(t=>i.styleId===t.id&&(e=t.legendUrl,!0)),e&&(this.legendElements=[{type:"symbol-table",title:i.title,infos:[{src:e,opacity:this.opacity}]}])}this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[],this._handles.remove("wms-sublayers-watcher");const i=this.layer;let e=null;(i.customParameters||i.customLayerParameters)&&(e={...i.customParameters,...i.customLayerParameters}),this._handles.add(ue(()=>{const{layer:t}=this;return t&&"sublayers"in t&&t.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher"),this.legendElements=await this._generateLegendElementsForWMSSublayers(i.sublayers,e),this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(i,e){const t=[];this._handles.add(i.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const n=i.toArray();for(const r of n){const s=ue(()=>[r.title,r.visible,r.legendEnabled],()=>this._constructLegendElementsForWMSSublayers());if(this._handles.add(s,"wms-sublayers-watcher"),!this.respectLayerVisibility||r.visible&&r.legendEnabled){const a=await this._generateSymbolTableElementForWMSSublayer(r,e);a&&a.infos.length&&t.unshift(a)}}return t}async _generateSymbolTableElementForWMSSublayer(i,e){if(!i.legendUrl&&i.sublayers){const t=(await this._generateLegendElementsForWMSSublayers(i.sublayers,e)).filter(n=>n);return{type:"symbol-table",title:i.title,infos:t}}return this._generateSymbolTableElementForLegendUrl(i,e)}async _generateSymbolTableElementForLegendUrl(i,e){var a;let t=i.legendUrl;if(!t)return;const n={type:"symbol-table",title:i.title||i.name||i.id&&i.id+"",infos:[]};e&&(t=Iye(t,e));let r=null;const s=(a=i.layer)==null?void 0:a.opacity;try{r=(await Mc(t,{responseType:"image"})).data,r&&(r.style.opacity=s)}catch{}return n.infos.push({src:t,preview:r,opacity:s}),n}_getLegendLayers(i,e){const t=j1&&j1[i];return t?Promise.resolve(t):this._legendRequest(e).then(n=>{const r=n.layers;return j1[i]=r,r})}_legendRequest(i){const e=this.layer;let t={f:"json",dynamicLayers:i};if(W1(e)){const r=e.exportImageServiceParameters.renderingRule;if(r&&(t.renderingRule=JSON.stringify(r.rasterFunctionDefinition||r.toJSON())),e.bandIds&&(t.bandIds=e.bandIds.join()),e.raster||e.viewId||e.customParameters){const{raster:s,viewId:a,customParameters:o}=e;t={raster:s,viewId:a,...t,...o}}}let n=e.url.replace(/(\/)+$/,"");if("version"in e&&e.version>=10.01){const r=n.indexOf("?");r>-1?n=n.substring(0,r)+"/legend"+n.substring(r):n+="/legend"}else{const r=n.toLowerCase().indexOf("/rest/"),s=n.substring(0,r)+n.substring(r+5,n.length);n=dTt+"?soapUrl="+encodeURI(s)+"&returnbytes=true"}return Mc(n,{query:t}).then(r=>r.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[],this._handles.remove("sublayers-watcher");const i=this.layer;this._handles.add(ue(()=>i.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(i.sublayers,this.opacity),this.notifyChange("ready")}catch(e){tt.getLogger(this.declaredClass).warn("Request to server for legend has failed!",e)}}async _generateLegendElementsForBuildingSublayers(i,e){let t=[];this._handles.add(i.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");const n=i.toArray();for(const r of n){const s=ue(()=>["renderer"in r&&r.renderer,r.opacity,r.title,r.visible],()=>this._constructLegendElementsForBuildingSceneLayer());if(this._handles.add(s,"sublayers-watcher"),!this.respectLayerVisibility||r.visible){const a=r&&r.opacity!=null?r.opacity:null,o=a!=null?a*e:e;if(r.type==="building-group"){const l={type:"symbol-table",title:r.title,infos:[]},c=await this._generateLegendElementsForBuildingSublayers(r.sublayers,o);l.infos.push(...c),t=[l,...t]}else r.renderer&&(t=[...await this._getRendererLegendElements(r.renderer,{title:r.title,opacity:o,sublayer:r}),...t])}}return t.filter(r=>!!r&&(!("infos"in r)||r.infos.length>0))}async _constructLegendElementsForSublayers(){this.legendElements=[],this._handles.remove("sublayers-watcher");const i=this.layer;this._handles.add(ue(()=>i.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(i.sublayers,this.opacity),this.notifyChange("ready")}catch(e){tt.getLogger(this.declaredClass).warn("Request to server for legend has failed!",e)}}async _generateLegendElementsForSublayers(i,e,t){const n=this.layer;let r=[];this._handles.add(i.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");let s=i.toArray();!t&&this.sublayerIds&&this.sublayerIds.length&&(s=this.sublayerIds.map(a=>n.findSublayerById(a)).filter(Boolean));for(const a of s){const o=ue(()=>[a.renderer,a.opacity,a.title,a.visible,a.legendEnabled],()=>this._constructLegendElementsForSublayers());if(this._handles.add(o,"sublayers-watcher"),!this.respectLayerVisibility||a.visible&&a.legendEnabled&&this._isSublayerInScale(a)){const l=a&&a.opacity!=null?a.opacity:null,c=l!=null?l*e:e,u=!!$te(n)||a.originIdOf("renderer")>aT.SERVICE;if(a.renderer&&!a.sublayers&&u)await a.load(),r=[...await this._getRendererLegendElements(a.renderer,{title:a.title,opacity:c,sublayer:a}),...r];else{const d=await this._generateSymbolTableElementForSublayer(a,c,t);d&&r.unshift(d)}}}return r.filter(a=>!!a&&(!("infos"in a)||a.infos.length>0))}async _generateSymbolTableElementForSublayer(i,e,t){if(!t){t=new Map;const r=this.layer,s=i.source;let a=null;if(!(!s||s.type==="map-layer"&&s.mapLayerId===i.id&&(!s.gdbVersion||s.gdbVersion===("gdbVersion"in r&&r.gdbVersion)))||i.originIdOf("renderer")>aT.SERVICE||i.originIdOf("labelingInfo")>aT.SERVICE||i.originIdOf("labelsVisible")>aT.SERVICE){const l=new cxe({layer:this.layer});a=l.hasDynamicLayers?l.dynamicLayers:null,l.destroy()}const o=a||`${r.uid}-default`;(await this._getLegendLayers(o,a)).forEach(l=>t.set(l.layerId,l))}const n=t.get(i.id);if((!n||n!=null&&n.subLayerIds&&n.defaultVisibility)&&i.sublayers){const r=await this._generateLegendElementsForSublayers(i.sublayers,e,t);return{type:"symbol-table",title:i.title,infos:r}}return this._generateSymbolTableElementForLegendLayer(n,i,e)}_generateSymbolTableElementForLegendLayer(i,e,t){var o;if(!i||!i.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(i,e))return null;const n=e==null?void 0:e.renderer;let r=(e==null?void 0:e.title)||i.layerName;if(n&&(!e||(e==null?void 0:e.originIdOf("renderer"))>aT.SERVICE)){const l=(e==null?void 0:e.title)||this._getRendererTitle(n,e);l&&(r&&typeof l!="string"&&"title"in l&&(l.title=r),r=l)}const s={type:"symbol-table",title:r,legendType:i.legendType?i.legendType:null,infos:[]},a=e?this._sanitizeLegendForSublayer(i.legend.slice(),e):i.legend;return((o=i.legendGroups)==null?void 0:o.length)>0?i.legendGroups.forEach(l=>{var u;const c={type:"symbol-table",title:l.heading,legendType:i.legendType?i.legendType:null,infos:this._generateSymbolTableElementInfosForLegendLayer(a.filter(d=>d.groupId===l.id),i.layerId,t)};((u=c.infos)==null?void 0:u.length)>0&&s.infos.push(c)}):s.infos=this._generateSymbolTableElementInfosForLegendLayer(a,i.layerId,t),s.infos.length>0?s:null}_generateSymbolTableElementInfosForLegendLayer(i,e,t){return i.map(n=>{let r=n.url;if(n.imageData&&n.imageData.length>0)r=`data:image/png;base64,${n.imageData}`;else{if(r.indexOf("http")===0)return null;r=$ye(`${this.layer.url}/${e}/images/${r}`)}return{label:n.label,src:r,opacity:t??this.opacity,width:n.width,height:n.height}}).filter(n=>!!n)}_isSublayerInScale(i){const e=i.minScale||0,t=i.maxScale||0;return!(e>0&&e<this.scale||t>this.scale)}_isLegendLayerInScale(i,e){const t=e||this.layer;let n=null,r=null,s=!0;return!t.minScale&&t.minScale!==0||!t.maxScale&&t.maxScale!==0?(i.minScale===0&&t.tileInfo&&(n=t.tileInfo.lods[0].scale),i.maxScale===0&&t.tileInfo&&(r=t.tileInfo.lods[t.tileInfo.lods.length-1].scale)):(n=Math.min(t.minScale,i.minScale)||t.minScale||i.minScale,r=Math.max(t.maxScale,i.maxScale)),(n>0&&n<this.scale||r>this.scale)&&(s=!1),s}_sanitizeLegendForSublayer(i,e){if("version"in this.layer&&this.layer.version<10.1||i.length===0)return i;const t=e.renderer,n=i.some(a=>a.values);let r=null,s=null;return n&&i.some((a,o)=>(a.values||(r=o,s=a,s.label||(s.label="others")),s!=null)),t?t.type==="unique-value"?s&&(i.splice(r,1),i.push(s)):t.type==="class-breaks"&&(s&&i.splice(r,1),i.reverse(),s&&i.push(s)):s&&(i.splice(r,1),i.push(s)),i}async _getRendererLegendElements(i,e={}){if(!_Tt(i,this.view))return tt.getLogger(this.declaredClass).warn(`Renderer of type '${i.type}' not supported!`),[];if(vTt(i))return this._constructPointCloudRendererLegendElements(i,e);if(fve(i))return this._constructDotDensityRendererLegendElements(i);const t=await this._loadRenderer(i);return mve(t)?this._constructPieChartRendererLegendElements(t):this._constructRendererLegendElements(t,e)}async _getLegendElementsForFeatureReduction(i){let e=null;return i.type==="binning"?e=i.renderer:i.type==="cluster"&&(e=this._getClusterRenderer(i)),e?this._getRendererLegendElements(e):[]}_getPointCloudRendererTitle(i){return i.legendOptions&&i.legendOptions.title||i.field}_constructPointCloudRendererLegendElements(i,e={}){const t=e.title,n=[];let r=null,s=null;if(eG(i))r={type:"symbol-table",title:t||this._getPointCloudRendererTitle(i),infos:[]},i.colorClassBreakInfos.forEach(o=>{r.infos.unshift({label:o.label||o.minValue+" - "+o.maxValue,value:[o.minValue,o.maxValue],symbol:this._getAppliedCloneSymbol(WO,o.color)})});else if(tG(i)){const o=i.stops;let l=null;if(o.length&&(o.length===1&&(l=o[0].color),!l)){const u=o[0].value,d=o[o.length-1].value;u!=null&&d!=null&&(l=Lue(u+(d-u)/2,o))}r={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(WO,l||WO.color)}]};const c=lJe(i.stops);s={type:"color-ramp",title:t||this._getPointCloudRendererTitle(i),infos:c,preview:O_(c.map(u=>u.color))}}else iG(i)&&(r={type:"symbol-table",title:t||this._getPointCloudRendererTitle(i),infos:[]},i.colorUniqueValueInfos.forEach(o=>{r.infos.push({label:o.label||o.values.join(", "),value:o.values.join(", "),symbol:this._getAppliedCloneSymbol(WO,o.color)})}));r&&r.infos.length&&n.push(r),s&&s.infos.length&&n.push(s);const a=n.reduce((o,l)=>o.concat(l.infos),[]).filter(o=>!!o.symbol).map(o=>this._getSymbolPreview(o,this.opacity,{symbolConfig:{applyColorModulation:!!i.colorModulation}}));return Ra(a).then(()=>n)}_getElementInfoForDotDensity(i,e){var h;const{backgroundColor:t,outline:n,dotSize:r}=i,s=(h=this.effectList)==null?void 0:h.effects.map(p=>p.toJSON()),a=lxe(s),o=r+"-"+e+"-"+t+"-"+(n&&JSON.stringify(n.toJSON()))+"-"+a,l=this._dotDensityUrlCache,c=l.has(o)?l.get(o):xet(i,e);l.set(o,c);const u={shape:{type:"image",x:0,y:0,width:c.width,height:c.height,src:c.src},fill:null,stroke:null,offset:[0,0]},d=fM([[u]],[c.width,c.height],{effectView:this.effectList});return{opacity:1,src:c.src,preview:d,width:c.width,height:c.height}}_constructDotDensityRendererLegendElements(i){const e=i.calculateDotValue(this.view.scale),t=i.legendOptions&&i.legendOptions.unit,n={type:"symbol-table",title:{value:e&&Math.round(e),unit:t||""},infos:[]};return i.attributes.forEach(r=>{const s=this._getElementInfoForDotDensity(i,r.color);s.label=r.label||r.valueExpressionTitle||r.field,n.infos.push(s)}),Promise.resolve([n])}async _constructPieChartRendererLegendElements(i){var l,c,u,d;const e=this.layer.opacity,t=[],n="Others",r=i.outline;i.attributes.forEach(h=>{const p=new wh({color:h.color,outline:r}),m=h.label||h.valueExpressionTitle||h.field;t.push({label:m,symbol:p})});const s=t.length?[...t]:[];if((l=i.othersCategory)!=null&&l.color&&((c=i.othersCategory)==null?void 0:c.threshold)!==0){const h=new wh({color:i.othersCategory.color,outline:r});t.push({label:i.othersCategory.label||n,symbol:h})}if((u=i.defaultColor)!=null&&u.a){const h=new wh({color:i.defaultColor,outline:r});t.push({label:i.defaultLabel,symbol:h})}const a=await this._getVisualVariableLegendElements(i,this.layer)||[];if(t.length){a.unshift({type:"symbol-table",title:null,infos:t});const h=s.filter(m=>m.label!==n).map(m=>m.symbol.color).filter(Boolean),p=Cet(h,{holePercentage:i.holePercentage,backgroundColor:(d=i.backgroundFillSymbol)==null?void 0:d.color,effectList:this.effectList,outline:r});a.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(i,this.layer),infos:t,preview:p})}const o=a.reduce((h,p)=>h.concat(this._getAllInfos(p)),[]).filter(h=>!!(h!=null&&h.symbol)&&!(h!=null&&h.preview)).map(h=>this._getSymbolPreview(h,e,{effectList:this.effectList}));return await Ra(o),a}async _constructRendererLegendElements(i,e={}){const{title:t,sublayer:n}=e,r=n||this.layer;this._hasColorRamp=!1,this._hasOpacityRamp=!1,this._hasSizeRamp=!1,this._scaleDrivenSizeVariable=null;const s=await this._getVisualVariableLegendElements(i,r)||[],a={type:"symbol-table",title:t||this._getRendererTitle(i,r),infos:[]};let o=null,l=!1;const c=new Set;if(K8(i)&&!this._hasSizeRamp){const g=await Iue(i);a.infos.push({label:null,symbol:g})}else if(MTt(i)){let g=t;const _=PTt(i)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",b=s.findIndex(E=>E.type==="color-ramp"),x=b!==-1?s.splice(b,1)[0]:null,w=s.findIndex(E=>E.type==="size-ramp"),C=w!==-1?s.splice(w,1)[0]:null,S=[];x&&(g=x.title,S.push(x)),C&&(g=C.title,S.push(C)),S.length>0&&s.push({type:_,title:g,infos:S})}else if(pve(i)){const g=Due(i);s.push({type:"heatmap-ramp",title:t||this._getRendererTitle(i,r),infos:g,preview:O_(g.map(_=>_.color),{effectList:this.effectList})})}else if(RI(i)){const g=i&&i.authoringInfo;if(g&&g.type==="relationship"){const{focus:_,numClasses:b,field1:x,field2:w}=g;if(b&&x&&w){const C=[x,w];let S=nve(_)||0;for(const A of C){const{field:P,normalizationField:O,label:M}=A,V=M||{field:this._getFieldAlias(P,r),normField:O&&this._getFieldAlias(O,r)},L=OTt.clone();L.angle=S,a.infos.push({label:V,symbol:L}),c.add(L),S+=90}const E=qCt({focus:_,numClasses:b,infos:i.uniqueValueInfos});s.unshift(E)}}else if(W1(this.layer)||jO(this.layer))i.uniqueValueInfos.forEach(_=>{_.symbol&&a.infos.push({label:_.label||_.value,value:_.value,symbol:_.symbol})});else{const{field:_,field2:b,field3:x,fieldDelimiter:w,valueExpression:C}=i,S=!(!_&&!C||!b&&!x),E=[];if(i.uniqueValueGroups.forEach(A=>{const P={type:"symbol-table",title:A.heading,infos:[]};A.classes.forEach(O=>{const{symbol:M,values:V}=O;if(M){const L=[],U=[];for(const k of V){const{value:D,value2:$,value3:F}=k,Y=[],ne=[];(_||C)&&(Y.push(D),ne.push(this._getDomainName(_,D,r))),b&&(Y.push($),ne.push(this._getDomainName(b,$,r))),x&&(Y.push(F),ne.push(this._getDomainName(x,F,r))),L.push(S?Y.join(w||""):Y[0]),U.push(ne.join(" - "))}const G=L.join(", ");let H=O.label;if(!H){const k=U.filter(Boolean);H=k.length?k.join(", "):G}P.infos.push({label:H,value:G,symbol:M})}}),P.infos.length&&E.push(P)}),E.length){const A=E[0];E.length===1&&"title"in A&&!A.title?a.infos.push(...A.infos):a.infos.push(...E)}}i.defaultSymbol&&(a.infos.push({label:i.defaultLabel||"others",symbol:i.defaultSymbol}),l=!0)}else if(Tw(i))o=this._isUnclassedRenderer(i),(!o||!this._hasSizeRamp)&&(i.classBreakInfos.forEach(g=>{g.symbol&&a.infos.unshift({label:g.label||(o?null:g.minValue+" - "+g.maxValue),value:[g.minValue,g.maxValue],symbol:g.symbol})}),o&&(a.title=null),this._updateInfosforClassedSizeRenderer(i,a.infos)),i.defaultSymbol&&!o&&(a.infos.push({label:i.defaultLabel||"others",symbol:i.defaultSymbol}),l=!0);else if(dve(i))if(jO(this.layer)||ETt(this.layer)){const g=this._constructTileImageryStretchRendererElements(i);ATt(g)?s.push(g):a.infos=g}else{const g=this.layer;let _,b;i.statistics&&i.statistics.length&&(_=i.statistics[0].min!=null?i.statistics[0].min:i.statistics[0][0],b=i.statistics[0].max!=null?i.statistics[0].max:i.statistics[0][1]);let x=[];const w=kt(g.renderingRule?await g.generateRasterInfo(g.renderingRule):g.serviceRasterInfo),C=w.keyProperties.BandProperties,S=Ite[g.rasterInfo.pixelType.toLowerCase()];w.bandCount===1||g.bandIds&&g.bandIds.length===1?(_=_??(w.statistics?w.statistics[g.bandIds[0]].min:S[0]),b=b??(w.statistics?w.statistics[g.bandIds[0]].max:S[1]),_||b?s.push(this._getStretchLegendElements(i,{min:_,max:b})):this._getServerSideLegend()):w.bandCount>=3?C&&C.length>=w.bandCount?g.bandIds&&g.bandIds.length===3?(x=g.bandIds.map(E=>C[E].BandName),a.infos=this._createSymbolTableElementMultiBand(x)):g.format==="lerc"?(x=[0,1,2].map(E=>C[E].BandName),a.infos=this._createSymbolTableElementMultiBand(x)):this._getServerSideLegend():g.format==="lerc"?(x=["band1","band2","band3"],a.infos=this._createSymbolTableElementMultiBand(x)):this._getServerSideLegend():this._getServerSideLegend()}else if(uve(i))i.colormapInfos.forEach(g=>{a.infos.push({label:g.label,value:g.value,symbol:this._getAppliedCloneSymbol(gTt,g.color)})});else if(Cw(i)){let g=i.symbol;switch(e.geometryType){case"point":g="pointSymbol"in r&&r.pointSymbol;break;case"polyline":g="lineSymbol"in r&&r.lineSymbol;break;case"polygon":g="polygonSymbol"in r&&r.polygonSymbol}const _=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;i.symbol&&_&&a.infos.push({label:i.label,symbol:g})}else if(cve(i)){i.outputUnit&&(this.title="("+i.toJSON().outputUnit+")"),a.title=i.attributeField;const g=i.getClassBreakInfos();g!=null&&g.length?g.forEach(_=>{a.infos.push({label:_.minValue+" - "+_.maxValue,symbol:_.symbol})}):a.infos.push({label:i.attributeField,symbol:i.getDefaultSymbol()})}else hve(i)&&s.push(this._getStretchLegendElements(i,{min:0,max:255}));const u=i.defaultSymbol;!u||l||Cw(i)||o&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||s.push({type:"symbol-table",infos:[{label:i.defaultLabel||"others",symbol:u}]}),a.infos.length&&s.unshift(a);const d=e.opacity==null?this.opacity:e.opacity,h=this._isTallSymbol("visualVariables"in i&&i.visualVariables),p=W1(this.layer)||jO(this.layer),m=s.reduce((g,_)=>g.concat(this._getAllInfos(_)),[]).filter(g=>!!(g!=null&&g.symbol)).map(g=>this._getSymbolPreview(g,d,{isDefault:g.symbol===u,applyScaleDrivenSize:!c.has(g.symbol),symbolConfig:{isTall:h,isSquareFill:p},effectList:c.has(g.symbol)?null:this.effectList}));return i=null,await Ra(m),s}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(i){const e=i==null?void 0:i.infos;return e?e.reduce((t,n)=>t.concat(this._getAllInfos(n)),[]):[i]}_constructTileImageryStretchRendererElements(i){var u,d;const e=this.layer,t=e.rasterInfo,n=t.bandCount||i.statistics.length;let r,s,a=[];const o=t.keyProperties&&t.keyProperties.BandProperties,l=(u=i==null?void 0:i.statistics)!=null&&u.length?i.statistics:t==null?void 0:t.statistics;if(l)r=l[0].min!==void 0?l[0].min:l[0][0],s=l[0].max||l[0][1];else{const h=Ite[e.rasterInfo.pixelType.toLowerCase()];r=h[0],s=h[1]}if(e.hasStandardTime()&&(r=e.getStandardTimeValue(r),s=e.getStandardTimeValue(s)),t.bandCount===1||((d=e.bandIds)==null?void 0:d.length)===1)return this._getStretchLegendElements(i,{min:r,max:s});function c(h){var m;const p=((m=e==null?void 0:e.bandIds)!=null&&m.length?e.bandIds:Array.from(Array(Math.min(t.bandCount,3)).keys())).map(g=>h&&h[g]&&h[g].BandName||"band"+(g+1));return p.length<3?p.push(p[1]):p.length>3&&p.splice(3),p}return a=o&&o.length>=n?c(o):c(),this._createSymbolTableElementMultiBand(a)}_getStretchLegendElements(i,e){const t=i.colorRamp,n=uJe(t,e);return{type:"stretch-ramp",title:"",infos:n,preview:O_(n.map(r=>r.color))}}_getClusterSymbol(){var n;const i=this.layer,e="featureReduction"in i&&i.featureReduction,t=e&&"symbol"in e&&e.renderer;return t&&((n=t==null?void 0:t.authoringInfo)==null?void 0:n.isAutoGenerated)!==!0?null:e&&"symbol"in e&&e.symbol}async _getSizeLegendElement(i,e,t,n){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(e):i,infos:await tTt(t,e,await zV(t),this.scale,this.view.type,n,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(i){const e=[],t=["red","green","blue"];return i.forEach((n,r)=>{e.push({label:{colorName:t[r],bandName:n},src:sJe[r],opacity:this.opacity??1})}),e}_updateInfosforClassedSizeRenderer(i,e){const t=i.authoringInfo&&i.authoringInfo.type==="class-breaks-size",n=i.classBreakInfos.some(r=>HL(r.symbol));if(t&&n){const r=j8,s=q8,a=i.classBreakInfos.length,o=(r-s)/(a>1?a-1:a);e.forEach((l,c)=>{l.size=r-o*c})}}_isTallSymbol(i){let e=!1,t=!1;if(i)for(let n=0;n<i.length&&(!e||!t);n++){const r=i[n];r.type==="size"&&(r.axis==="height"&&(e=!0),r.axis==="width-and-depth"&&(t=!0))}return e&&t}async _getSymbolPreview(i,e,t){let n=!(t!=null&&t.isDefault)&&i.size==null&&this._hasSizeRamp?Gp(wa.size):i.size;if(this._scaleDrivenSizeVariable&&(t!=null&&t.applyScaleDrivenSize)){const{getSize:r}=await Ee(()=>import("./visualVariableUtils-c59ab38d.js"),["./visualVariableUtils-c59ab38d.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./mathUtils-2519596a.js","./vec3-a020a6f6.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./vec4-790471c0.js","./typedArrayUtil-a8b5b3e9.js","./ensureType-cf29afa9.js","./string-cdf077e6.js","./Error-653283ae.js","./Graphic-b46e2684.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./geometry-5a216427.js","./Extent-69509002.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./PopupTemplate-6eb885db.js","./Clonable-ba795b08.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./SimpleObservable-7dcdef1d.js","./fieldUtils-31bfecd2.js","./preload-helper-41c905a7.js","./arcadeOnDemand-c6d1b9f2.js","./enumeration-3c281341.js","./number-347a3a44.js","./locale-30120714.js","./Identifiable-aa6d459d.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./screenUtils-410d12c0.js","./opacityUtils-243aae26.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./aaBoundingRect-4a760199.js","./request-d3e98716.js","./persistableUrlUtils-a16d0f55.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./collectionUtils-3831b7c4.js","./Portal-8b65c9c4.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./jsonUtils-03c4af61.js","./compilerUtils-034cacb8.js","./lengthUtils-d2d33f94.js","./unitUtils-47abac71.js","./sizeVariableUtils-d4870b0d.js"],import.meta.url);n=r(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:i.symbol.type==="simple-marker"?i.symbol.style:null})}return bU(i.symbol,{size:n,opacity:e,scale:!1,symbolConfig:t==null?void 0:t.symbolConfig,effectView:t==null?void 0:t.effectList}).then(r=>(i.preview=r,i)).catch(()=>(i.preview=null,i))}_getClusterRenderer(i){var r,s;this._hasClusterSizeVariable=!1;const e="renderer"in this.layer&&this.layer.renderer,t=((r=i.renderer)==null?void 0:r.clone())||(e==null?void 0:e.clone()),n=kt(LCt(this.layerView._effectiveRenderer,this.view));if(n&&"visualVariables"in t&&!((s=t.visualVariables)==null?void 0:s.some(o=>o.type==="size"&&o.target!=="outline"&&!GO.test(o.valueExpression)))){if("clusterMinSize"in i&&"clusterMaxSize"in i){const{clusterMinSize:l,clusterMaxSize:c}=i;n.legendOptions=new dxe({showLegend:l!==c})}const o=t.visualVariables||[];t.visualVariables=o.concat([n]),this._hasClusterSizeVariable=!0}return t}async _loadRenderer(i){const e=[],t=i.clone(),n=await zV(t);if(Tw(t)||RI(t)){const r=(t.classBreakInfos||t.uniqueValueInfos).map(s=>this._fetchSymbol(s.symbol,n).then(a=>{s.symbol=a}).catch(()=>{s.symbol=null}));Array.prototype.push.apply(e,r)}return e.push(this._fetchSymbol(t.symbol||t.defaultSymbol,t.defaultSymbol?null:n).then(r=>{this._applySymbolToRenderer(t,r,Cw(t))}).catch(()=>{this._applySymbolToRenderer(t,null,Cw(t))})),Ra(e).then(()=>t)}_applySymbolToRenderer(i,e,t){t?i.symbol=e:i.defaultSymbol=e}async _fetchSymbol(i,e){if(!i)throw new Error;if(i.type==="web-style"){const t=this._webStyleSymbolCache;try{const n=await(this.view.type==="2d"?i.fetchCIMSymbol({cache:t}):i.fetchSymbol({cache:t}));return this._getAppliedCloneSymbol(n,e)}catch{throw tt.getLogger(this.declaredClass).warn("Fetching web-style failed!"),new Error}}return this._getAppliedCloneSymbol(i,e)}_getAppliedCloneSymbol(i,e){if(!i||!e)return i;const t=i.clone(),n=e&&e.toRgba();return t.type.includes("3d")?this._applyColorTo3dSymbol(t,n):t.type==="cim"?_re(t,e):t.color&&(t.color=new Xt(n||t.color)),t}_applyColorTo3dSymbol(i,e){e&&i.symbolLayers.forEach(t=>{t&&(t.material||(t.material={}),t.material.color=new Xt(e))})}async _getVisualVariableLegendElements(i,e){if(!("visualVariables"in i)||!i.visualVariables||i.type==="vector-field")return null;const t=i.visualVariables,n=[],r=[],s=[];for(const u of t)u.type==="color"?n.push(u):u.type==="size"?r.push(u):u.type==="opacity"&&s.push(u);const a=[...n,...r,...s];let o,l;if(n.length===0&&Tw(i)&&i.classBreakInfos&&i.classBreakInfos.length===1){const u=i.classBreakInfos[0];o=u&&u.symbol}if(n.length===0&&Cw(i)&&(o=i.symbol),o)if(o.type.includes("3d")){const u=o.symbolLayers.getItemAt(0);u.type==="water"?T(u.color)&&(l=u.color):T(u.material)&&T(u.material.color)&&(l=u.material.color)}else o.url||(l=o.color);const c=this.effectList;return(await Promise.all(a.map(async u=>{if(!u.legendOptions||u.legendOptions.showLegend!==!1){const d=K8(i)?u.field:this._getRampTitle(u,e);let h=null;const p="getField"in e&&e.getField&&e.getField(u.field),m=p&&kN(p);if(u.type==="color"){const g=await UV(u,null,m);h={type:"color-ramp",title:d,infos:g,preview:O_(g.map(_=>_.color),{effectList:c})},this._hasColorRamp||(this._hasColorRamp=!(h.infos==null||!h.infos.length))}else if(u.type==="size"&&u.target!=="outline")GO.test(u.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=u):(h=await this._getSizeLegendElement(d,u,i,m),this._hasSizeRamp||(this._hasSizeRamp=!(h.infos==null||!h.infos.length)));else if(u.type==="opacity"){const g=await UV(u,l,m);h={type:"opacity-ramp",title:d,infos:g,preview:O_(g.map(_=>_.color),{effectList:c})},this._hasOpacityRamp||(this._hasOpacityRamp=!(h.infos==null||!h.infos.length))}return h&&h.infos?h:null}}))).filter(u=>!!u)}_getDomainName(i,e,t){if(i&&typeof i!="function"){const n="getField"in t&&t.getField&&t.getField(i),r=n&&"getFieldDomain"in t&&t.getFieldDomain?t.getFieldDomain(n.name):null;return r&&r.type==="coded-value"?r.getName(e):null}return null}_getClusterTitle(i){const e=this.layer,t=i.field;if("featureReduction"in e&&e.featureReduction&&e.featureReduction.type==="cluster"){const n=e.featureReduction,r="popupTemplate"in n&&n.popupTemplate,s=r&&r.fieldInfos;if(s){for(const a of s)if(a.fieldName===t)return t==="cluster_count"?a.label||{showCount:!0}:a.label}}return{showCount:!0}}_getRampTitle(i,e){let t=i.field,n=i.normalizationField,r=!1,s=!1,a=!1,o=null;t=typeof t=="function"?null:t,n=typeof n=="function"?null:n;const l=i.legendOptions&&i.legendOptions.title;if(l!=null)o=l;else if(i.valueExpressionTitle)o=i.valueExpressionTitle;else{if("renderer"in e&&e.renderer&&"authoringInfo"in e.renderer&&e.renderer.authoringInfo&&e.renderer.authoringInfo.visualVariables){const c=e.renderer.authoringInfo.visualVariables;for(let u=0;u<c.length;u++){const d=c[u];if(d.type==="color"){if(d.style==="ratio"){r=!0;break}if(d.style==="percent"){s=!0;break}if(d.style==="percent-of-total"){a=!0;break}}}}o={field:t&&this._getFieldAlias(t,e),normField:n&&this._getFieldAlias(n,e),ratio:r,ratioPercent:s,ratioPercentTotal:a}}return o}_getRendererTitle(i,e){const t=i;if(t.legendOptions&&t.legendOptions.title)return t.legendOptions.title;if(t.valueExpressionTitle)return t.valueExpressionTitle;let n=t.field,r=null,s=null;if(Tw(t)&&(r=t.normalizationField,s=t.normalizationType==="percent-of-total"),n=typeof n=="function"?null:n,r=typeof r=="function"?null:r,RI(t)){const{field2:o,field3:l,fieldDelimiter:c}=t;let u=n&&this._getFieldAlias(n,e);return o&&(u=`<${u}>${c}<${this._getFieldAlias(o,e)}>`,l&&(u=`${u}${c}<${this._getFieldAlias(l,e)}>`)),u}let a=null;return(n||r)&&(a={field:n&&this._getFieldAlias(n,e),normField:r&&this._getFieldAlias(r,e),normByPct:s}),a}_getFieldAlias(i,e){const t="popupTemplate"in e&&e.popupTemplate,n=t&&t.fieldInfos;let r=null;n&&n.some(u=>i===u.fieldName&&(r=u,!0));let s=null;"getField"in e&&e.getField?s=e.getField(i):"fieldsIndex"in e&&e.fieldsIndex&&(s=e.fieldsIndex.get(i));let a=null;const o="featureReduction"in e&&e.featureReduction;o&&(!r&&"popupTemplate"in o&&o.popupTemplate&&o.popupTemplate.fieldInfos&&o.popupTemplate.fieldInfos.some(u=>{var d;return(i==null?void 0:i.toLowerCase())===((d=u.fieldName)==null?void 0:d.toLowerCase())&&(r=u,!0)}),"fields"in o&&o.fields&&(a=o.fields.find(u=>{var d;return((d=u.name)==null?void 0:d.toLowerCase())===(i==null?void 0:i.toLowerCase())})));const l=r||s||a;let c=null;return l&&(c=(r==null?void 0:r.label)||(s==null?void 0:s.alias)||(a==null?void 0:a.alias)||"name"in l&&l.name||"fieldName"in l&&l.fieldName),c}_isUnclassedRenderer(i){const e=i.visualVariables;let t=!1;return Tw(i)&&i.classBreakInfos&&i.classBreakInfos.length===1&&e&&(t=i.field?e.some(n=>!(!n||i.field!==n.field||(i.normalizationField||n.normalizationField)&&i.normalizationField!==n.normalizationField)):!!e.length),t}};f([y()],aa.prototype,"children",void 0),f([y({readOnly:!0})],aa.prototype,"effectList",null),f([y()],aa.prototype,"layerView",void 0),f([y()],aa.prototype,"layer",void 0),f([y()],aa.prototype,"legendElements",void 0),f([y({readOnly:!0})],aa.prototype,"opacity",null),f([y()],aa.prototype,"parent",void 0),f([y({readOnly:!0,dependsOn:[]})],aa.prototype,"ready",null),f([y()],aa.prototype,"hideLayersNotInCurrentView",void 0),f([y()],aa.prototype,"keepCacheOnDestroy",void 0),f([y()],aa.prototype,"respectLayerVisibility",void 0),f([y({readOnly:!0})],aa.prototype,"scale",null),f([y()],aa.prototype,"sublayerIds",void 0),f([y({readOnly:!0})],aa.prototype,"isScaleDriven",null),f([y()],aa.prototype,"title",void 0),f([y({readOnly:!0,dependsOn:["ready"],value:0})],aa.prototype,"version",null),f([y()],aa.prototype,"view",void 0),aa=f([ge("esri.widgets.Legend.support.ActiveLayerInfo")],aa);const gve=aa,C_={state:"state",view:"view",allLayerViews:"all-layer-views",legendProperties:"legend-properties"},vve=_i.ofType(gve),RTt=["esri.layers.BuildingSceneLayer","esri.layers.CSVLayer","esri.layers.FeatureLayer","esri.layers.GeoJSONLayer","esri.layers.GeoRSSLayer","esri.layers.GroupLayer","esri.layers.HeatmapLayer","esri.layers.ImageryLayer","esri.layers.ImageryTileLayer","esri.layers.MapImageLayer","esri.layers.OGCFeatureLayer","esri.layers.PointCloudLayer","esri.layers.StreamLayer","esri.layers.SceneLayer","esri.layers.SubtypeGroupLayer","esri.layers.TileLayer","esri.layers.VoxelLayer","esri.layers.WFSLayer","esri.layers.WMSLayer","esri.layers.WMTSLayer","esri.layers.WCSLayer"],yve="view.basemapView.baseLayerViews",_ve="view.groundView.layerViews",bve="view.basemapView.referenceLayerViews",ITt=[yve,_ve,"view.layerViews",bve];let Qu=class extends et{constructor(e){super(e),this._handles=new mi,this._layerViewByLayerId={},this._layerInfosByLayerViewId={},this._activeLayerInfosByLayerViewId={},this._activeLayerInfosWithNoParent=new _i,this.activeLayerInfos=new vve,this.basemapLegendVisible=!1,this.groundLegendVisible=!1,this.hideLayersNotInCurrentView=!1,this.keepCacheOnDestroy=!1,this.respectLayerVisibility=!0,this.layerInfos=[],this.view=null}initialize(){this._handles.add(ue(()=>this.view,()=>this._viewHandles(),At),C_.view),this._handles.add(Wie(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos(),this._handles.destroy(),this._handles=null,this.view=null}get state(){return this.get("view.ready")?"ready":"disabled"}_viewHandles(){this._handles.remove(C_.state),this.view&&this._handles.add(ue(()=>this.state,()=>this._stateHandles(),At),C_.state)}_stateHandles(){this._resetAll(),this.state==="ready"&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this._handles.remove([C_.allLayerViews,C_.legendProperties]),this._destroyViewActiveLayerInfos(),this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(e){this._handles.remove(e);const t=this._activeLayerInfosByLayerViewId[e];delete this._activeLayerInfosByLayerViewId[e],t&&t.parent&&t.parent.children.remove(t)}_watchPropertiesAndAllLayerViews(){const{allLayerViews:e}=this.view;e.length&&this._refresh(),this._handles.add(e.on("change",t=>this._allLayerViewsChangeHandle(t)),C_.allLayerViews),this._handles.add(ue(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),C_.legendProperties)}_allLayerViewsChangeHandle(e){e.removed.forEach(t=>this._destroyViewActiveLayerInfo(t.uid)),this._refresh()}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos(),this._refresh()}_refresh(){this._layerInfosByLayerViewId={},this.activeLayerInfos.removeAll(),this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this),this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(e){if(e.length<2)return;const t=[];e.forEach(r=>{if(!r.parent){const s=r.layer.parent,a=s&&"uid"in s&&this._layerViewByLayerId[s.uid],o=a&&this._activeLayerInfosByLayerViewId[a.uid];o&&e.includes(o)&&(t.push(r),r.parent=o,o.children.add(r),this._sortActiveLayerInfos(o.children))}}),e.removeMany(t);const n={};this.view.allLayerViews.forEach((r,s)=>n[r.layer.uid]=s),e.sort((r,s)=>{const a=n[r.layer.uid]||0;return(n[s.layer.uid]||0)-a})}_generateLayerViews(){const e=[];return ITt.filter(this._filterLayerViews,this).map(this.get,this).filter(t=>t!=null).forEach(this._collectLayerViews("layerViews",e)),e}_filterLayerViews(e){const t=!this.basemapLegendVisible&&(e===yve||e===bve),n=!this.groundLegendVisible&&e===_ve;return!t&&!n}_collectLayerViews(e,t){const n=r=>(r&&r.forEach(s=>{t.push(s),n(s[e])}),t);return n}_filterLayerViewsByLayerInfos(e){const t=this.layerInfos;return!t||!t.length||t.some(n=>this._hasLayerInfo(n,e))}_hasLayerInfo(e,t){const n=this._isLayerUIDMatching(e.layer,t.layer.uid);return n&&(this._layerInfosByLayerViewId[t.uid]=e),n}_isLayerUIDMatching(e,t){return e&&(e.uid===t||this._hasLayerUID(e.layers,t))}_hasLayerUID(e,t){return e&&e.some(n=>this._isLayerUIDMatching(n,t))}_isLayerViewSupported(e){return!!RTt.includes(e.layer.declaredClass)&&(this._layerViewByLayerId[e.layer.uid]=e,!0)}_generateActiveLayerInfo(e){this._isLayerActive(e)?this._buildActiveLayerInfo(e):(this._handles.remove(e.uid),this._handles.add(ue(()=>{var t;return[e.legendEnabled,(t=e.layer)==null?void 0:t.legendEnabled]},()=>this._layerActiveHandle(e)),e.uid))}_layerActiveHandle(e){this._isLayerActive(e)&&(this._handles.remove(e.uid),this._buildActiveLayerInfo(e))}_isLayerActive(e){return!this.respectLayerVisibility||e.legendEnabled&&e.get("layer.legendEnabled")}_buildActiveLayerInfo(e){var o;const t=e.layer,n=e.uid,r=this._layerInfosByLayerViewId[n];let s=this._activeLayerInfosByLayerViewId[n];if(!s){const l=r&&r.title!==void 0&&r.layer.uid===t.uid;s=new gve({layer:t,layerView:e,title:l?r.title:t.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:r&&r.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[n]=s}const a=t.parent&&"uid"in t.parent&&this._layerViewByLayerId[(o=t.parent)==null?void 0:o.uid];if(s.parent=this._activeLayerInfosByLayerViewId[a==null?void 0:a.uid],!this._handles.has(n)){const l=[ue(()=>t.title,c=>this._titleHandle(c,s)),ue(()=>[t.opacity,"renderer"in t&&t.renderer,"pointSymbol"in t&&t.pointSymbol,"lineSymbol"in t&&t.lineSymbol,"polygonSymbol"in t&&t.polygonSymbol],()=>this._constructLegendElements(s)),rs(()=>{var c;return((c=this.view)==null?void 0:c.stationary)===!0},()=>this._scaleHandle(s),At),ue(()=>e._effectiveRenderer,()=>this._constructLegendElements(s)),ue(()=>"effect"in t&&t.effect,()=>this._constructLegendElements(s))];if(this.respectLayerVisibility){const c=ue(()=>e.legendEnabled,d=>this._legendEnabledHandle(d,s)),u=ue(()=>t.legendEnabled,d=>this._legendEnabledHandle(d,s));l.push(c,u)}this._handles.add(l,n)}s.isScaleDriven||this._constructLegendElements(s),this._addActiveLayerInfo(s)}_titleHandle(e,t){t.title=e,this._constructLegendElements(t)}_legendEnabledHandle(e,t){e?this._addActiveLayerInfo(t):this._removeActiveLayerInfo(t)}_scaleHandle(e){(e.isScaleDriven||e.hideLayersNotInCurrentView)&&this._constructLegendElements(e)}_addActiveLayerInfo(e){var r;const{layerView:t,layer:n}=e;if(this._isLayerActive(t)&&!this.activeLayerInfos.includes(e)){const s=e.parent;if(s)s.children.includes(e)||s.children.push(e),this._sortActiveLayerInfos(s.children);else{const a=(r=this.layerInfos)==null?void 0:r.some(o=>o.layer.uid===n.uid);n.parent&&"uid"in n.parent&&!a?this._activeLayerInfosWithNoParent.add(e):(this.activeLayerInfos.add(e),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const a=[];this._activeLayerInfosWithNoParent.forEach(o=>{const l=o.layer.parent,c=l&&"uid"in l&&this._layerViewByLayerId[l==null?void 0:l.uid],u=this._activeLayerInfosByLayerViewId[c==null?void 0:c.uid];u&&(a.push(o),o.parent=u)}),a.length&&(this._activeLayerInfosWithNoParent.removeMany(a),a.forEach(o=>this._addActiveLayerInfo(o)))}}}_removeActiveLayerInfo(e){const t=e.parent;t?t.children.remove(e):this.activeLayerInfos.remove(e)}_constructLegendElements(e){const t=e.layer;"featureCollections"in t&&t.featureCollections?e.buildLegendElementsForFeatureCollections(t.featureCollections):"featureReduction"in t&&t.featureReduction&&"renderer"in t.featureReduction&&(t.featureReduction.type==="binning"||t.featureReduction.type==="cluster")?e.buildLegendElementsForFeatureReduction(t.featureReduction):"renderer"in t&&t.renderer&&!("sublayers"in t)?e.buildLegendElementsForRenderer(t.renderer):"url"in t&&t.url?e.buildLegendElementsForTools():e.children.forEach(n=>this._constructLegendElements(n))}};f([y({type:vve})],Qu.prototype,"activeLayerInfos",void 0),f([y()],Qu.prototype,"basemapLegendVisible",void 0),f([y()],Qu.prototype,"groundLegendVisible",void 0),f([y()],Qu.prototype,"hideLayersNotInCurrentView",void 0),f([y()],Qu.prototype,"keepCacheOnDestroy",void 0),f([y()],Qu.prototype,"respectLayerVisibility",void 0),f([y()],Qu.prototype,"layerInfos",void 0),f([y({readOnly:!0})],Qu.prototype,"state",null),f([y()],Qu.prototype,"view",void 0),Qu=f([ge("esri.widgets.Legend.LegendViewModel")],Qu);const $Tt=Qu,LTt="http://www.w3.org/2000/svg",yr={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};function wve(i,e,t,n){const{focus:r,labels:s}=i,a=!!r,o=DTt(i,e,t,n),l={justifyContent:"center"},c=Su();return a?z("div",{class:yr.diamondContainer,styles:l},z("div",{class:yr.diamondLeftCol},c?s.right:s.left),z("div",{class:yr.diamondMidCol},z("div",{class:yr.diamondMidColLabel},s.top),o,z("div",{class:yr.diamondMidColLabel},s.bottom)),z("div",{class:yr.diamondRightCol},c?s.left:s.right)):z("div",{class:yr.squareTable},z("div",{class:yr.squareTableRow},z("div",{class:Ow(yr.squareTableCell,yr.squareTableLabel,yr.squareTableLabelRightBottom)},c?s.top:s.left),z("div",{class:yr.squareTableCell}),z("div",{class:Ow(yr.squareTableCell,yr.squareTableLabel,yr.squareTableLabelLeftBottom)},c?s.left:s.top)),z("div",{class:yr.squareTableRow},z("div",{class:yr.squareTableCell}),o,z("div",{class:yr.squareTableCell})),z("div",{class:yr.squareTableRow},z("div",{class:Ow(yr.squareTableCell,yr.squareTableLabel,yr.squareTableLabelRightTop)},c?s.right:s.bottom),z("div",{class:yr.squareTableCell}),z("div",{class:Ow(yr.squareTableCell,yr.squareTableLabel,yr.squareTableLabelLeftTop)},c?s.bottom:s.right)))}function Dte(i,e,t){const n=`${t}_arrowStart`,r=`${t}_arrowEnd`,s=i==="left",a={markerStart:null,markerEnd:null};switch(e){case"HL":s?a.markerStart=`url(#${r})`:a.markerEnd=`url(#${n})`;break;case"LL":a.markerStart=`url(#${r})`;break;case"LH":s?a.markerEnd=`url(#${n})`:a.markerStart=`url(#${r})`;break;default:a.markerEnd=`url(#${n})`}return a}function DTt(i,e,t,n,r=60){const{focus:s,numClasses:a,colors:o,rotation:l}=i,c=!!s,u=Math.sqrt(r**2+r**2)+(c?0:5),d=[],h=[],p=[],m=(r||75)/a;for(let M=0;M<a;M++){const V=M*m;for(let L=0;L<a;L++){const U=L*m,G=yU(o[M][L]),H=_U(null),k={type:"rect",x:U,y:V,width:m,height:m};d.push(jue(G)),h.push(vU(k,G.fill,H,null)),p.push(que(k))}}const g=10,_=15,b=15,x=10;let w=null;c||(w="margin: -15px -15px -18px -15px");const C=Dte("left",s,e),S=Dte("right",s,e),E=Kue(p),A=jV(E,u,u,0,!1,l,!1),P=jV(E,u,u,0,!1,c?-45:null,!1),O={filter:r2(n),opacity:t==null?null:`${t}`};return z("div",{styles:O,class:c?yr.diamondMidColRamp:yr.squareTableCell},z("svg",{xmlns:LTt,width:u,height:u,style:w},z("defs",null,z("marker",{id:`${e}_arrowStart`,markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},z("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),z("marker",{id:`${e}_arrowEnd`,markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},z("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),d),z("g",{transform:A},h),z("g",{transform:P},z("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":C.markerStart,"marker-end":C.markerEnd,x1:-g,y1:r-_,x2:-g,y2:_}),z("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":S.markerStart,"marker-end":S.markerEnd,x1:b,y1:r+x,x2:r-b,y2:r+x}))))}const kTt=zI(),xve=10,nG=20,HD=10,rG=20,sG={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};function FTt(i="vertical"){const e="stroke:rgb(200, 200, 200);stroke-width:1";return i==="vertical"?z("svg",{height:"4",width:"10"},z("line",{x1:"0",y1:"2",x2:"10",y2:"2",style:e})):z("svg",{height:"10",width:"10"},z("line",{x1:"5",y1:"0",x2:"5",y2:"10",style:e}))}function NTt(i,e="vertical"){const t=document.createElement("div");return t.style.height=`${nG}px`,t.className=sG.univariateAboveAndBelowSymbol,i!=null&&(t.style.opacity=i.toString()),kTt.append(t,FTt.bind(null,e)),t}function Cve(i,e,t="vertical",n){i.infos.forEach((r,s)=>{if(n&&s===2)r.preview=NTt(e,t);else{const a=Hn(r.size)+(t==="horizontal"?rG:HD),o=r.preview.tagName.toLowerCase()==="div",l=o?r.preview:document.createElement("div");l.className=sG.univariateAboveAndBelowSymbol,t==="horizontal"?l.style.width=`${a}px`:l.style.height=`${a}px`,o||l.appendChild(r.preview),r.preview=l}})}function EL(i,e="classic"){const t=i.infos;return e==="classic"?(Hn(t[0].size)+HD)/2:(Hn(t[0].size)-Hn(t[t.length-1].size))/2}function Ox(i,e){if(!i)return null;const t=i.infos.map(r=>r.color),n=O_(e.type==="full"?t:e.type==="above"?t.slice(0,3):t.slice(2,5),{width:e.width,height:e.height,align:e.rampAlignment,effectList:e.effectList});return n.className=sG.colorRamp,e.opacity!=null&&(n.style.opacity=e.opacity.toString()),n}function Y8(i,e,t,n="vertical"){let r=0;const s=i.infos,a=Math.floor(s.length/2),o=e==="full"||e==="above"?0:a,l=e==="full"||e==="below"?s.length-1:a;for(let c=o;c<=l;c++)t&&c===a?r+=n==="horizontal"?xve:nG:r+=Hn(s[c].size)+(n==="horizontal"?rG:HD);return Math.round(r)}function Rx(i,e,t,n="vertical"){const r=Y8(i,e,t,n),s=i.infos,a=Math.floor(s.length/2),o=e==="full"||e==="above"?0:a,l=e==="full"||e==="below"?s.length-1:a,c=e==="full"?s[o].size+s[l].size:e==="above"?s[o].size:s[l].size,u=t?n==="vertical"?nG:xve:0,d=n==="vertical"?HD*(e==="full"?2:1):rG*(e==="full"?2:1);return Math.round(r-(Hn(c)/2+u/2+d/2))}function Tve(i,e,t="vertical"){const n=i.infos;let r=n.find(({type:a})=>a==="size-ramp"),s=n.find(({type:a})=>a==="color-ramp");return r&&(r={...r},r.infos=[...r.infos],Cve(r,e,t,!0)),s&&(s={...s},s.infos=[...s.infos]),t==="horizontal"&&(r==null||r.infos.reverse(),s==null||s.infos.reverse()),{sizeRampElement:r,colorRampElement:s}}function Sve(i,e="vertical"){const t=i.infos;let n=t.find(({type:s})=>s==="size-ramp"),r=t.find(({type:s})=>s==="color-ramp");return n&&(n={...n},n.infos=[...n.infos],Cve(n,null,e,!1)),r&&(r={...r},r.infos=[...r.infos]),e==="horizontal"&&(n==null||n.infos.reverse(),r==null||r.infos.reverse()),{sizeRampElement:n,colorRampElement:r}}function VTt(i,e){return e}function Pa(i){const e=this;i.appendChild(e)}function Ix(i,e,t){if(!e)return;if(typeof e=="string"||typeof e=="number")return e;if("value"in e||"unit"in e)return ua(i.dotValue,e);if("colorName"in e||"bandName"in e)return i[e.colorName]+": "+(i[e.bandName]||e.bandName);if("showCount"in e)return e.showCount?i.clusterCountTitle:null;let n=null;return VTt(e,t)?n=e.ratioPercentTotal?"showRatioPercentTotal":e.ratioPercent?"showRatioPercent":e.ratio?"showRatio":e.normField?"showNormField":e.field?"showField":null:Eve(e,t)&&(n=e.normField?"showNormField":e.normByPct?"showNormPct":e.field?"showField":null),n?ua(n==="showField"?"{field}":i[n],{field:e.field,normField:e.normField}):null}function Eve(i,e){return!e}function Ave(i,e){return!!(e&&e==="Stretched"&&i.version>=10.3&&i.declaredClass==="esri.layers.ImageryLayer")}const ni={activated:"esri-legend--card__carousel-indicator--activated",base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card",hidden:"esri-hidden"},BTt=25,zTt=25,UTt=768,HTt=100;var HE;(function(i){i.Auto="auto",i.Stack="stack",i.SideBySide="side-by-side"})(HE||(HE={}));const GTt="#ddd",q1=window.devicePixelRatio;function WTt(i){if(i){if(i.type.includes("3d")){const e=i.symbolLayers&&i.symbolLayers.length;if(!e)return;const t=i.symbolLayers.getItemAt(e-1),n=t.resource&&t.resource.primitive;return n==="circle"||n==="cross"||n==="kite"||n==="sphere"||n==="cube"||n==="diamond"}{const e=i.style;return e==="circle"||e==="diamond"||e==="cross"}}}function jTt(i){if(i){if(i.type.includes("3d")){const e=i.symbolLayers&&i.symbolLayers.length;if(!e)return;const t=i.symbolLayers.getItemAt(e-1).get("resource.primitive");return t==="triangle"||t==="cone"||t==="tetrahedron"}return i.style==="triangle"}}let Yd=class extends gr{constructor(e,t){super(e,t),this._handles=new mi,this._hasIndicators=!1,this._selectedSectionName=null,this._sectionNames=[],this._sectionMap=new Map,this.activeLayerInfos=null,this.headingLevel=3,this.layout=HE.Stack,this.messages=null,this.messagesCommon=null,this.type="card",this.view=null}initialize(){this.addHandles(ue(()=>this.activeLayerInfos,e=>{this._handles.removeAll(),this._watchForSectionChanges(e)}))}destroy(){this._handles.destroy(),this._handles=null}render(){this._hasIndicators=this.layout===HE.Auto&&this.view.container.clientWidth<=UTt||this.layout===HE.Stack;const e=this.activeLayerInfos,t=e&&e.toArray().map(l=>this._renderLegendForLayer(l)).filter(l=>!!l);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const n=this._sectionNames.length,r=this._sectionNames.map((l,c)=>{const u=ua(this.messagesCommon.pagination.pageText,{index:c+1,total:n});return z("div",{key:l,role:"tab",id:l,"aria-label":u,"aria-controls":`${l}-panel`,"aria-selected":(this._selectedSectionName===l).toString(),tabIndex:this._selectedSectionName===l?0:-1,title:u,onclick:this._selectSection,onkeydown:this._focusSection,bind:this,class:this.classes(ni.indicator,{[ni.activated]:this._selectedSectionName===l}),"data-section-name":l})}),s=this._hasIndicators&&n>1?z("div",{class:ni.indicatorContainer,key:"carousel-navigation",role:"tablist"},r):null,a=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):t&&t.length?t:null,o={[ni.stacked]:this._hasIndicators};return z("div",{class:this.classes(ni.base,o)},a||z("div",{class:ni.message},this.messages.noLegend),s)}_selectSection(e){const t=e.target.getAttribute("data-section-name");t&&(this._selectedSectionName=t)}_focusSection(e){switch(e.key){case"ArrowLeft":case"ArrowRight":this._switchSectionOnArrowPress(e);break;case"Enter":case" ":this._selectSection(e)}}_switchSectionOnArrowPress(e){const t=e.key,n=t==="ArrowLeft"?-1:1,r=e.target.getAttribute("data-section-name"),s=this._sectionNames.indexOf(r),a=this._sectionNames;let o=null;s!==-1&&(a[s+n]?o=document.getElementById(a[s+n]):t==="ArrowLeft"?o=document.getElementById(a[a.length-1]):t==="ArrowRight"&&(o=document.getElementById(a[0])),o&&o.focus())}_watchForSectionChanges(e){if(this._generateSectionNames(),e){e.forEach(n=>{const r=`activeLayerInfo-${n.layer.uid}-version-change`;this._handles.remove(r),this._watchForSectionChanges(n.children),this._handles.add(ue(()=>n.version,()=>this._generateSectionNames()),r)});const t="activeLayerInfos-collection-change";this._handles.remove(t),this._handles.add(e.on("change",()=>this._watchForSectionChanges(e)),t)}}_generateSectionNames(){this._sectionNames.length=0,this._selectedSectionName=null,this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(e,t,n){return`${this.id}${e.uid}-type-${t.type}-${n}`}_generateSectionNamesForActiveLayerInfo(e){e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this),e.legendElements&&e.legendElements.forEach((t,n)=>{this._sectionNames.push(this._getSectionName(e.layer,t,n))})}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){const t=e.children.map(n=>this._renderLegendForLayer(n)).toArray();return z("div",{key:e.layer.uid,class:this.classes(ni.service,ni.groupLayer)},z("div",{class:ni.serviceCaptionContainer},e.title),t)}{const t=e.legendElements;if(t&&!t.length)return null;const n=t.some(a=>a.type==="relationship-ramp"),r=t.map((a,o)=>this._renderLegendForElement(a,e,o,n)).filter(a=>!!a);if(!r.length)return null;const s={[ni.groupLayerChild]:!!e.parent};return z("div",{key:e.layer.uid,class:this.classes(ni.service,s)},z("div",{class:ni.serviceCaptionContainer},z("div",{class:ni.serviceCaptionText},e.title)),z("div",{class:ni.serviceContent},r))}}_renderLegendForElement(e,t,n,r=!1,s=!1){const a=e.type==="color-ramp",o=e.type==="opacity-ramp",l=e.type==="size-ramp",c=t.layer;let u=null;if(typeof e.title=="string")u=e.title;else if(e.title){const _=e.title,b=Ix(this.messages,_,a||o);u=_.title?`${_.title} (${b})`:b}const d=this._getSectionName(c,e,n),h=this._hasIndicators&&!s?z("div",null,z(Ul,{level:this.headingLevel,class:ni.carouselTitle},t.title),z(Ul,{level:s0(this.headingLevel),class:ni.layerCaption},u)):u?z(Ul,{level:this.headingLevel,class:ni.layerCaption},u):null,p=t.effectList;let m=null;if(e.type==="symbol-table"){const _=e.infos.map((b,x)=>this._renderLegendForElementInfo(b,t,e.legendType,x)).filter(b=>!!b);if(_.length){const b=_[0].properties.classes&&_[0].properties.classes[ni.symbolRow],x={[ni.labelContainer]:!b&&!r,[ni.relationshipLabelContainer]:r};m=z("div",{class:this.classes(x)},_)}}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"?m=this._renderLegendForRamp(e,c.opacity,p):l?m=this._renderSizeRamp(e,c.opacity):e.type==="pie-chart-ramp"?m=this._renderPieChartRamp(e):e.type==="relationship-ramp"?m=wve(e,this.id,c.opacity,p):e.type==="univariate-above-and-below-ramp"?m=this._renderUnivariateAboveAndBelowRamp(e,c.opacity,p):e.type==="univariate-color-size-ramp"&&(m=this._renderUnivariateColorSizeRamp(e,c.opacity,p));if(!m)return null;const g=z("div",{key:d,class:ni.section,id:`${d}-panel`,role:"tabpanel","aria-labelledby":d,tabIndex:0},[h,m]);return s||this._sectionMap.set(d,g),g}_renderPieChartRamp(e){return z("div",{class:ni.pieChartRampPreview,bind:e.preview,afterCreate:Pa})}_renderUnivariateAboveAndBelowRamp(e,t,n){const{sizeRampElement:r,colorRampElement:s}=Tve(e,t,"horizontal");if(!r)return null;const a=Y8(r,"full",!0,"horizontal"),o=Rx(r,"above",!0,"horizontal"),l=Rx(r,"below",!0,"horizontal"),c=12,u=Ox(s,{width:o,height:c,rampAlignment:"horizontal",opacity:t,type:"above",effectList:n}),d=Ox(s,{width:l,height:c,rampAlignment:"horizontal",opacity:t,type:"below",effectList:n}),h=EL(r,"card"),p=r.infos.map(C=>C.label),m=p.length-1,g=p.map((C,S)=>S===0||S===m?z("div",{key:S},C):null),_={display:"flex",flexDirection:"column"},b={display:"flex",flexDirection:"row"},x={marginTop:"3px",display:"flex"};Su(this.container)?x.marginRight=`${h}px`:x.marginLeft=`${h}px`;const w={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return z("div",{class:ni.layerRow,key:"size-ramp-preview",styles:_},z("div",{class:this.classes(ni.symbolContainer,ni.sizeRampHorizontal),styles:b},r.infos.map((C,S)=>z("div",{key:S,class:ni.symbol,bind:C.preview,afterCreate:Pa}))),u?z("div",{class:ni.univariateAboveAndBelowColorRamp,styles:x,key:"color-ramp-preview"},z("div",{bind:u,afterCreate:Pa}),z("div",{bind:d,afterCreate:Pa})):null,z("div",{class:ni.layerInfo},z("div",{class:ni.rampLabelsContainer,styles:w},g)))}_renderUnivariateColorSizeRamp(e,t,n){const{sizeRampElement:r,colorRampElement:s}=Sve(e,"horizontal");if(!r)return null;const a=Y8(r,"full",!1,"horizontal"),o=Rx(r,"full",!1,"horizontal"),l=Ox(s,{width:o,height:12,rampAlignment:"horizontal",opacity:t,type:"full",effectList:n}),c=EL(r,"card"),u=r.infos.length-1,d=r.infos.map((_,b)=>b===0||b===u?z("div",{key:b},_.label):null),h={display:"flex",flexDirection:"column"},p={display:"flex",flexDirection:"row"},m={marginTop:"3px",display:"flex"};Su(this.container)?m.marginRight=`${c}px`:m.marginLeft=`${c}px`;const g={width:`${a}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return z("div",{class:ni.layerRow,key:"size-ramp-preview",styles:h},z("div",{class:this.classes(ni.symbolContainer,ni.sizeRampHorizontal),styles:p},r.infos.map((_,b)=>z("div",{key:b,class:ni.symbol,bind:_.preview,afterCreate:Pa}))),z("div",{class:ni.univariateAboveAndBelowColorRamp,styles:m,key:"color-ramp-preview"},z("div",{bind:l,afterCreate:Pa})),z("div",{class:ni.layerInfo},z("div",{class:ni.rampLabelsContainer,styles:g},d)))}_renderLegendForElementInfo(e,t,n,r){var o;const s=t.layer;if(e.type)return this._renderLegendForElement(e,t,r,!1,!0);const a=Ave(s,n);if(e.preview){if(!e.symbol||!e.symbol.type.includes("simple-fill")){if(!e.label)return z("div",{key:r,bind:e.preview,afterCreate:Pa});const S={[ni.symbolCell]:this._hasIndicators};return z("div",{key:r,class:this.classes(ni.layerRow,{[ni.symbolRow]:this._hasIndicators})},z("div",{class:this.classes(S),bind:e.preview,afterCreate:Pa}),z("div",{class:this.classes(ni.imageLabel,{[ni.labelCell]:this._hasIndicators})},Ix(this.messages,e.label,!1)||""))}let l=255,c=255,u=255,d=0,h=255,p=255,m=255,g=0;const _=e.symbol.color&&e.symbol.color.a,b=e.symbol.outline&&e.symbol.outline.color&&e.symbol.outline.color.a;_&&(l=e.symbol.color.r,c=e.symbol.color.g,u=e.symbol.color.b,d=e.symbol.color.a*s.opacity),b&&(h=e.symbol.outline.color.r,p=e.symbol.outline.color.g,m=e.symbol.outline.color.b,g=e.symbol.outline.color.a*s.opacity);const x=((o=e.symbol.color)==null?void 0:o.isBright)??!0,w=x?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)",C={background:_?`rgba(${l}, ${c}, ${u}, ${d})`:"none",color:x?"black":"white",textShadow:`-1px -1px 0 ${w},
                                              1px -1px 0 ${w},
                                              -1px 1px 0 ${w},
                                              1px 1px 0 ${w}`,border:b?`1px solid rgba(${h}, ${p}, ${m}, ${g})`:"none",filter:r2(t.effectList)};return z("div",{key:r,class:ni.layerRow},z("div",{class:ni.labelElement,styles:C}," ",e.label," "))}if(e.src){const l=this._renderImage(e,s,a);return z("div",{key:r,class:ni.layerRow},l,z("div",{class:ni.imageLabel},e.label||""))}}_renderImage(e,t,n){const{label:r,src:s,opacity:a}=e,o={[ni.imageryLayerStretchedImage]:n,[ni.symbol]:!n},l={opacity:`${a??t.opacity}`};return z("img",{alt:Ix(this.messages,r,!1),src:s,border:0,width:e.width,height:e.height,class:this.classes(o),styles:l})}_renderSizeRampLines(e){const t=e.infos,n=t[0],r=t[t.length-1],s=n.symbol,a=this._hasIndicators,o=Hn(n.size+n.outlineSize)*q1,l=Hn(r.size+r.outlineSize)*q1,c=a?o:o+50*q1,u=a?o/2+50*q1:o,d=jTt(s),h=WTt(s),p=document.createElement("canvas");p.width=c,p.height=u,p.style.width=p.width/q1+"px",p.style.height=p.height/q1+"px";const m=p.getContext("2d");if(a){m.beginPath();const g=0,_=0,b=c/2-l/2,x=u;m.moveTo(g,_),m.lineTo(b,x);const w=c,C=0,S=c/2+l/2,E=u;m.moveTo(w,C),m.lineTo(S,E)}else{m.beginPath();const g=0,_=u/2-l/2,b=c,x=0;m.moveTo(g,_),m.lineTo(b,x);const w=0,C=u/2+l/2,S=c,E=u;m.moveTo(w,C),m.lineTo(S,E)}return m.strokeStyle=GTt,m.stroke(),z("div",{bind:p,afterCreate:Pa,styles:a?{display:"flex",marginTop:`-${d?0:h?o/2:0}px`,marginBottom:`-${d?l:h?l/2:0}px`}:{display:"flex",marginRight:`-${d?0:h?o/2:0}px`,marginLeft:`-${d?0:h?l/2:0}px`}})}_renderSizeRamp(e,t){const n=e.infos,r=n[0].label,s=n[n.length-1].label;let a=n[0].preview,o=n[n.length-1].preview;const l=this._hasIndicators,c={"flex-direction":l?"column":"row-reverse"};a&&(a=a.cloneNode(!0),a.style.display="flex"),o&&(o=o.cloneNode(!0),o.style.display="flex");const u={opacity:t!=null?`${t}`:""};return z("div",{class:this.classes(ni.layerRow,{[ni.sizeRampRow]:l})},z("div",{class:ni.rampLabel},l?r:s),z("div",{class:ni.sizeRampContainer,styles:c},z("div",{bind:a,afterCreate:Pa,class:ni.sizeRampPreview,styles:u}),this._renderSizeRampLines(e),z("div",{bind:o,afterCreate:Pa,class:ni.sizeRampContainer,styles:u})),z("div",{class:ni.rampLabel},l?s:r))}_renderLegendForRamp(e,t,n){const r=e.infos,s=e.type==="heatmap-ramp",a=r.length-1,o=zTt,l=a>2&&!s?BTt*a:HTt,c=l+20,u=10,d=r.slice(0).reverse();d.forEach((E,A)=>{E.offset=s?E.ratio:A/a});const h=d.length-1,p=d.length%2!=0&&d[d.length/2|0],m=p&&z("div",{class:ni.intervalSeparatorsContainer},z("div",{class:ni.intervalSeparator},"|"),z("div",{class:ni.rampLabel},p.label)),g=r[r.length-1].label,_=r[0].label,b=[[{shape:{type:"path",path:`M0 ${o/2} L${u} 0 L${u} ${o} Z`},fill:d[0].color,stroke:{width:0}},{shape:{type:"rect",x:u,y:0,width:l,height:o},fill:{type:"linear",x1:u,y1:0,x2:l+u,y2:0,colors:d},stroke:{width:0}},{shape:{type:"path",path:`M${l+u} 0 L${c} ${o/2} L${l+u} ${o} Z`},fill:d[h].color,stroke:{width:0}}]],x=Yue(b,c,o),{messages:w}=this,C={filter:r2(n),opacity:t==null?null:`${t}`},S={justifyContent:"center"};return z("div",{class:ni.layerRow,styles:S},z("div",{class:ni.rampLabel},s?w[g]:g),z("div",{class:ni.symbolContainer},z("div",{styles:C},x),m),z("div",{class:ni.rampLabel},s?w[_]:_))}};f([y()],Yd.prototype,"activeLayerInfos",void 0),f([y()],Yd.prototype,"headingLevel",void 0),f([y()],Yd.prototype,"layout",void 0),f([y(),En("esri/widgets/Legend/t9n/Legend")],Yd.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],Yd.prototype,"messagesCommon",void 0),f([y({readOnly:!0})],Yd.prototype,"type",void 0),f([y()],Yd.prototype,"view",void 0),f([dr()],Yd.prototype,"_selectSection",null),Yd=f([ge("esri.widgets.Legend.styles.Card")],Yd);const fN=Yd,wi={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label",message:"esri-legend__message",header:"esri-widget__heading",hidden:"esri-hidden"},qTt="esri-legend__",KTt=24,kte={display:"flex",alignItems:"flex-start"},mN={marginLeft:"3px"},K1={display:"table-cell",verticalAlign:"middle"};let Q_=class extends gr{constructor(e,t){super(e,t),this.activeLayerInfos=null,this.headingLevel=3,this.messages=null,this.type="classic"}render(){const e=this.activeLayerInfos,t=e&&e.toArray().map(n=>this._renderLegendForLayer(n)).filter(n=>!!n);return z("div",null,t&&t.length?t:z("div",{class:wi.message},this.messages.noLegend))}_renderLegendForLayer(e){if(!e.ready)return null;const t=!!e.children.length,n=`${qTt}${e.layer.uid}-version-${e.version}`,r=e.title?Ul({level:this.headingLevel,class:this.classes(wi.header,wi.label)},e.title):null;if(t){const s=e.children.map(a=>this._renderLegendForLayer(a)).toArray();return z("div",{key:n,class:this.classes(wi.service,wi.groupLayer)},r,s)}{const s=e.legendElements;if(s&&!s.length)return null;const a=s.map(l=>this._renderLegendForElement(l,e.layer,e.effectList)).filter(l=>!!l);if(!a.length)return null;const o={[wi.groupLayerChild]:!!e.parent};return z("div",{key:n,class:this.classes(wi.service,o),tabIndex:0},r,z("div",{class:wi.layer},a))}}_renderLegendForElement(e,t,n,r){const s=e.type==="color-ramp",a=e.type==="opacity-ramp",o=e.type==="size-ramp";let l=null;if(e.type==="symbol-table"||o){const m=e.infos.map(g=>this._renderLegendForElementInfo(g,t,n,o,e.legendType)).filter(g=>!!g);m.length&&(l=z("div",{class:wi.layerBody},m))}else e.type==="color-ramp"||e.type==="opacity-ramp"||e.type==="heatmap-ramp"||e.type==="stretch-ramp"?l=this._renderLegendForRamp(e,t.opacity):e.type==="relationship-ramp"?l=wve(e,this.id,t.opacity,n):e.type==="pie-chart-ramp"?l=this._renderPieChartRamp(e):e.type==="univariate-above-and-below-ramp"?l=this._renderUnivariateAboveAndBelowRamp(e,t.opacity,n):e.type==="univariate-color-size-ramp"&&(l=this._renderUnivariateColorSizeRamp(e,t.opacity,n));if(!l)return null;const c=e.title;let u=null;if(typeof c=="string")u=c;else if(c){const m=Ix(this.messages,c,s||a);u=Eve(c,s||a)&&c.title?`${c.title} (${m})`:m}const d=r?wi.layerChildTable:wi.layerTable,h=u?z("div",{class:wi.layerCaption},u):null,p={[wi.layerTableSizeRamp]:o||!r};return z("div",{class:this.classes(d,p)},h,l)}_renderPieChartRamp(e){return z("div",{bind:e.preview,afterCreate:Pa})}_renderUnivariateAboveAndBelowRamp(e,t,n){const{sizeRampElement:r,colorRampElement:s}=Tve(e,t);if(!r)return null;const a=Rx(r,"above",!0),o=Rx(r,"below",!0),l=12,c=Ox(s,{width:l,height:a,rampAlignment:"vertical",opacity:t,type:"above",effectList:n}),u=Ox(s,{width:l,height:o,rampAlignment:"vertical",opacity:t,type:"below",effectList:n}),d=EL(r),h=r.infos.map(S=>S.label),p=h.map((S,E)=>E===0?z("div",{key:E,class:S?c?wi.univariateAboveAndBelowLabel:wi.rampLabel:null},S):E===2?z("div",null):null),m=h.length-1,g=Math.floor(h.length/2),_=h.map((S,E)=>E===g||E===m?z("div",{key:E,class:S?c?wi.univariateAboveAndBelowLabel:wi.rampLabel:null},S):null),b={display:"table-cell",verticalAlign:"middle"},x={marginTop:`${d}px`},w={height:`${a}px`},C={height:`${o}px`};return z("div",{key:"univariate-above-and-below-ramp-preview",styles:kte},z("div",{class:wi.layerBody},r.infos.map((S,E)=>z("div",{class:this.classes(wi.layerRow,wi.sizeRamp)},z("div",{class:wi.symbol,styles:b,bind:S.preview,afterCreate:Pa}),c||E%2!=0?null:z("div",{class:wi.layerInfo},h[E])))),c?z("div",{styles:x,key:"color-ramp-preview"},z("div",{styles:mN},z("div",{styles:K1},z("div",{class:wi.rampContainer,bind:c,afterCreate:Pa})),z("div",{styles:K1},z("div",{class:wi.rampLabelsContainer,styles:w},p))),z("div",{styles:mN},z("div",{styles:K1},z("div",{class:wi.rampContainer,bind:u,afterCreate:Pa})),z("div",{styles:K1},z("div",{class:wi.rampLabelsContainer,styles:C},_)))):null)}_renderUnivariateColorSizeRamp(e,t,n){const{sizeRampElement:r,colorRampElement:s}=Sve(e);if(!r)return null;const a=EL(r),o=12,l=Rx(r,"full",!1),c=Ox(s,{width:o,height:l,rampAlignment:"vertical",opacity:t,type:"full",effectList:n}),u=r.infos.length-1,d=r.infos.map((g,_)=>_===0||_===u?z("div",{key:_,class:g.label?s?wi.univariateAboveAndBelowLabel:wi.rampLabel:null},g.label):null),h={display:"table-cell",verticalAlign:"middle"},p={marginTop:`${a}px`},m={height:`${l}px`};return z("div",{key:"univariate-above-and-below-ramp-preview",styles:kte},z("div",{class:wi.layerBody},r.infos.map(g=>z("div",{class:this.classes(wi.layerRow,wi.sizeRamp)},z("div",{class:wi.symbol,styles:h,bind:g.preview,afterCreate:Pa})))),z("div",{styles:p,key:"color-ramp-preview"},z("div",{styles:mN},z("div",{styles:K1},z("div",{class:wi.rampContainer,bind:c,afterCreate:Pa})),z("div",{styles:K1},z("div",{class:wi.rampLabelsContainer,styles:m},d)))))}_renderLegendForRamp(e,t){const n=e.infos,r=e.type==="opacity-ramp",s=e.type==="heatmap-ramp",a=e.type==="stretch-ramp",o=e.preview,l=r?wi.opacityRamp:"";o.className=`${wi.colorRamp} ${l}`,t!=null&&(o.style.opacity=t.toString());const c=n.map(h=>z("div",{class:h.label?wi.rampLabel:null},s?this.messages[h.label]||h.label:a?this._getStretchStopLabel(h):h.label)),u={width:`${KTt}px`},d={height:o.style.height};return z("div",{class:wi.layerRow},z("div",{class:wi.symbolContainer,styles:u},z("div",{class:wi.rampContainer,bind:o,afterCreate:Pa})),z("div",{class:wi.layerInfo},z("div",{class:wi.rampLabelsContainer,styles:d},c)))}_getStretchStopLabel(e){return e.label?this.messages[e.label]+": "+(typeof e.value=="string"?e.value:lg(e.value,{style:"decimal",notation:e.value.toString().includes("e")?"scientific":"standard"})):""}_renderLegendForElementInfo(e,t,n,r,s){if(e.type)return this._renderLegendForElement(e,t,n,!0);let a=null;const o=Ave(t,s);if(e.preview?a=z("div",{class:wi.symbol,bind:e.preview,afterCreate:Pa}):e.src&&(a=this._renderImage(e,t,o)),!a)return null;const l={[wi.imageryLayerInfoStretched]:o},c={[wi.imageryLayerInfoStretched]:o,[wi.sizeRamp]:!o&&r};return z("div",{class:wi.layerRow},z("div",{class:this.classes(wi.symbolContainer,c)},a),z("div",{class:this.classes(wi.layerInfo,l)},Ix(this.messages,e.label,!1)||""))}_renderImage(e,t,n){const{label:r,src:s,opacity:a}=e,o={[wi.imageryLayerStretchedImage]:n,[wi.symbol]:!n},l={opacity:`${a??t.opacity}`};return z("img",{alt:Ix(this.messages,r,!1),src:s,border:0,width:e.width,height:e.height,class:this.classes(o),styles:l})}};f([y()],Q_.prototype,"activeLayerInfos",void 0),f([y()],Q_.prototype,"headingLevel",void 0),f([y(),En("esri/widgets/Legend/t9n/Legend")],Q_.prototype,"messages",void 0),f([y({readOnly:!0})],Q_.prototype,"type",void 0),Q_=f([ge("esri.widgets.Legend.styles.Classic")],Q_);const Y1=Q_,qO={base:"esri-legend",widget:"esri-widget",panel:"esri-widget--panel",widgetIcon:"esri-icon-layer-list"};let Ga=class extends gr{constructor(e,t){super(e,t),this._handles=new mi,this.headingLevel=3,this.iconClass=qO.widgetIcon,this.messages=null,this.style=new Y1,this.viewModel=new $Tt}initialize(){this.addHandles([Sn(()=>this.view,"resize",()=>this.scheduleRender()),Sn(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),ue(()=>this.headingLevel,e=>{const{style:t}=this;t&&(t.headingLevel=e)}),ue(()=>this.style,(e,t)=>{t&&e!==t&&t.destroy(),e&&(e.activeLayerInfos=this.activeLayerInfos,e.type==="card"&&(e.view=this.view),e.headingLevel=this.headingLevel)},At)])}destroy(){this._handles=_t(this._handles)}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(e){this.viewModel.activeLayerInfos=e}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(e){this.viewModel.basemapLegendVisible=e}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(e){this.viewModel.groundLegendVisible=e}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(e){this.viewModel.hideLayersNotInCurrentView=e}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(e){this.viewModel.keepCacheOnDestroy=e}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(e){this.viewModel.respectLayerVisibility=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(e){this.viewModel.layerInfos=e}castStyle(e){if(e instanceof fN||e instanceof Y1)return e;if(typeof e=="string")return e==="card"?new fN:new Y1;if(e&&typeof e.type=="string"){const t={...e};return delete t.type,new(e.type==="card"?fN:Y1)(t)}return new Y1}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){return z("div",{class:this.classes(qO.base,qO.widget,this.style instanceof Y1?qO.panel:null)},this.style.render())}_refreshActiveLayerInfos(e){this._handles.removeAll(),e.forEach(t=>this._renderOnActiveLayerInfoChange(t)),this.scheduleRender()}_renderOnActiveLayerInfoChange(e){const t=ue(()=>e.version,()=>this.scheduleRender());this._handles.add(t,`version_${e.layer.uid}`);const n=Sn(()=>e.children,"change",()=>e.children.forEach(r=>this._renderOnActiveLayerInfoChange(r)),At);this._handles.add(n,`children_${e.layer.uid}`),e.children.forEach(r=>this._renderOnActiveLayerInfoChange(r))}};f([y()],Ga.prototype,"activeLayerInfos",null),f([y()],Ga.prototype,"basemapLegendVisible",null),f([y()],Ga.prototype,"groundLegendVisible",null),f([y()],Ga.prototype,"headingLevel",void 0),f([y()],Ga.prototype,"hideLayersNotInCurrentView",null),f([y()],Ga.prototype,"keepCacheOnDestroy",null),f([y()],Ga.prototype,"respectLayerVisibility",null),f([y()],Ga.prototype,"iconClass",void 0),f([y()],Ga.prototype,"label",null),f([y()],Ga.prototype,"layerInfos",null),f([y(),En("esri/widgets/Legend/t9n/Legend")],Ga.prototype,"messages",void 0),f([y()],Ga.prototype,"style",void 0),f([Mr("style")],Ga.prototype,"castStyle",null),f([y()],Ga.prototype,"view",null),f([y()],Ga.prototype,"viewModel",void 0),Ga=f([ge("esri.widgets.Legend")],Ga);const Mve=Ga,YTt=Object.freeze(Object.defineProperty({__proto__:null,default:Mve},Symbol.toStringTag,{value:"Module"}));function XTt(i){const{wkid:e}=i;if(Xv[e]!=null)return Xv.values[Xv[e]];const{wkt:t}=i,n=t.lastIndexOf(",")+1,r=t.lastIndexOf("]]");return parseFloat(t.substring(n,r))}function Fte(i,e){return i&&i.includes(e)}function Nte(i,e){const{x:t,y:n}=i==="decimal-degrees"?fie(e,!0):e;return[t,n]}function Vte({state:{paddedViewState:i},spatialReference:e,width:t}){return e.isWrappable&&i.worldScreenWidth<t}let Sw=class extends et{constructor(e){super(e),this.scaleComputedFrom=Cs(),this.view=null}get state(){return this.get("view.ready")&&this.get("view.type")==="2d"?"ready":"disabled"}getScaleBarProperties(e,t){if(this.state==="disabled"||isNaN(e)||!t)return null;const n=this._getDistanceInKm(this.view,this.scaleComputedFrom);if(B(n))return null;if(t==="metric")return this._getScaleBarProps(e,n,"metric");const r=n/1.609;return this._getScaleBarProps(e,r,"non-metric")}_getLocationUnit(){const e=this.get("view.spatialReference"),{isWebMercator:t,wkid:n,wkt:r}=e;return t||Fte(r,"WGS_1984_Web_Mercator")?"decimal-degrees":Xv[n]!=null||Fte(r,"PROJCS")?"linear-unit":"unknown"}_getDistanceInKm(e,t){const{state:n,spatialReference:r}=e,s=this._getLocationUnit();if(s==="linear-unit")return n.extent.width*XTt(r)/1e3;const[a,o]=this._getScaleMeasuringPoints(e,t),l=s==="decimal-degrees"||r.isGeographic&&!DD(r)?$n.WGS84:r,c=new sx({paths:[[Nte(s,a),Nte(s,o)]],spatialReference:l}),u=H_e(c,10);let d;try{[d]=txt([u],"kilometers")}catch{return null}return d}_getScaleMeasuringPoints(e,t){const{width:n,height:r,position:s,spatialReference:a}=e;if(Vte(e)){const{valid:u}=aB(a);return[new Wt(u[0],0,a),new Wt(u[1],0,a)]}let o=t.y-s[1];o>r?o=r:o<0&&(o=0);const l=Cs(0,o),c=Cs(n,o);return[e.toMap(l),e.toMap(c)]}_getScaleBarProps(e,t,n){const{view:r}=this;let s=e*t/(Vte(r)?r.state.paddedViewState.worldScreenWidth:r.width),a=n==="metric"?"km":"mi";s<.1&&(a==="mi"?(s*=5280,a="ft"):a==="km"&&(s*=1e3,a="m"));let o=0;for(;s>=1;)s/=10,o++;const l=this._getConstraints(s);if(!l)return null;const{min:c,max:u}=l,d=u/s>=s/c?c:u;return{length:e*(d/s),value:10**o*d,unit:a}}_getConstraints(e){return e>.5?{min:.5,max:1}:e>.3?{min:.3,max:.5}:e>.2?{min:.2,max:.3}:e>.15?{min:.15,max:.2}:e>=.1?{min:.15,max:.1}:void 0}};f([y()],Sw.prototype,"scaleComputedFrom",void 0),f([y({readOnly:!0})],Sw.prototype,"state",null),f([y()],Sw.prototype,"view",void 0),Sw=f([ge("esri.widgets.Scalebar.ScaleBarViewModel")],Sw);const ZTt=Sw,ys={base:"esri-scale-bar esri-widget",labelContainer:"esri-scale-bar__label-container",rulerLabelContainer:"esri-scale-bar__label-container--ruler",lineLabelContainer:"esri-scale-bar__label-container--line",topLabelContainer:"esri-scale-bar__label-container--top",bottomLabelContainer:"esri-scale-bar__label-container--bottom",label:"esri-scale-bar__label",line:"esri-scale-bar__line",topLine:"esri-scale-bar__line--top",bottomLine:"esri-scale-bar__line--bottom",ruler:"esri-scale-bar__ruler",rulerBlock:"esri-scale-bar__ruler-block",barContainer:"esri-scale-bar__bar-container",rulerBarContainer:"esri-scale-bar__bar-container--ruler",lineBarContainer:"esri-scale-bar__bar-container--line",disabled:"esri-disabled"};function KO(i){return 2*i}let Xd=class extends gr{constructor(i,e){super(i,e),this.messages=null,this.unit="non-metric",this.viewModel=new ZTt}initialize(){this.addHandles([ue(()=>{const{view:i}=this;return[i==null?void 0:i.stationary,i==null?void 0:i.center,i==null?void 0:i.scale,i==null?void 0:i.zoom]},([i])=>{i&&this.scheduleRender()})])}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}set style(i){const e=this.unit==="dual"?"line":i;this._set("style",e)}castStyle(i){return i==="line"?i:"ruler"}castUnit(i){return i==="metric"||i==="dual"?i:"non-metric"}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const i=this.get("viewModel.state")==="disabled",e={[ys.disabled]:i};let t,n;if(!i){const{unit:r,style:s}=this,a=r==="metric"||r==="dual",o=50;if(r==="non-metric"||r==="dual"){const l=this.viewModel.getScaleBarProperties(o,"non-metric");l&&(n=s==="ruler"?this._renderRuler(l):this._renderLine(l,"bottom"))}if(a){const l=this.viewModel.getScaleBarProperties(o,"metric");l&&(t=s==="ruler"?this._renderRuler(l):this._renderLine(l,"top"))}}return z("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(ys.base,e)},t,n)}_renderRuler(i){const e=KO(Math.round(i.length)),{messages:t}=this,n=t[i.unit]||t.unknownUnit,r=`${KO(i.value)} ${n}`;return z("div",{class:this.classes(ys.barContainer,ys.rulerBarContainer),key:"esri-scale-bar__ruler"},z("div",{class:ys.ruler,styles:{width:`${e}px`}},z("div",{class:ys.rulerBlock}),z("div",{class:ys.rulerBlock}),z("div",{class:ys.rulerBlock}),z("div",{class:ys.rulerBlock})),z("div",{class:this.classes(ys.labelContainer,ys.rulerLabelContainer)},z("div",{class:ys.label},"0"),z("div",{class:ys.label},r)))}_renderLine(i,e){const{messages:t}=this,n=t[i.unit]||t.unknownUnit,r=`${KO(i.value)} ${n}`,s={[ys.topLabelContainer]:e==="top",[ys.bottomLabelContainer]:e==="bottom"},a=z("div",{class:this.classes(ys.labelContainer,ys.lineLabelContainer,s),key:"esri-scale-bar__label"},z("div",{class:ys.label},r)),o={[ys.topLine]:e==="top",[ys.bottomLine]:e==="bottom"},l=KO(Math.round(i.length)),c=z("div",{class:this.classes(ys.line,o),key:"esri-scale-bar__line",styles:{width:`${l}px`}});return z("div",{class:this.classes(ys.barContainer,ys.lineBarContainer),key:"esri-scale-bar__line-container"},[c,a])}_handleRootCreateOrUpdate(i){const e=this.viewModel;if(!e)return;const t=i.getBoundingClientRect(),n=t.left+window.pageXOffset,r=t.top+window.pageYOffset,s=Cs(n,r);(s.x!==e.scaleComputedFrom.x||s.y!==e.scaleComputedFrom.y)&&(e.scaleComputedFrom=s)}};f([y()],Xd.prototype,"label",null),f([y(),En("esri/widgets/ScaleBar/t9n/ScaleBar")],Xd.prototype,"messages",void 0),f([y()],Xd.prototype,"style",null),f([Mr("style")],Xd.prototype,"castStyle",null),f([y()],Xd.prototype,"unit",void 0),f([Mr("unit")],Xd.prototype,"castUnit",null),f([y()],Xd.prototype,"view",null),f([y()],Xd.prototype,"viewModel",void 0),Xd=f([ge("esri.widgets.ScaleBar")],Xd);const QTt=Xd;/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Bte(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function mf(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Bte(Object(t),!0).forEach(function(n){JTt(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Bte(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function II(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?II=function(e){return typeof e}:II=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},II(i)}function JTt(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function sg(){return sg=Object.assign||function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},sg.apply(this,arguments)}function eSt(i,e){if(i==null)return{};var t={},n=Object.keys(i),r,s;for(s=0;s<n.length;s++)r=n[s],!(e.indexOf(r)>=0)&&(t[r]=i[r]);return t}function tSt(i,e){if(i==null)return{};var t=eSt(i,e),n,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(r=0;r<s.length;r++)n=s[r],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(i,n)&&(t[n]=i[n])}return t}var iSt="1.15.0";function Fm(i){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(i)}var Cg=Fm(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),CM=Fm(/Edge/i),zte=Fm(/firefox/i),GE=Fm(/safari/i)&&!Fm(/chrome/i)&&!Fm(/android/i),Pve=Fm(/iP(ad|od|hone)/i),Ove=Fm(/chrome/i)&&Fm(/android/i),Rve={capture:!1,passive:!1};function jn(i,e,t){i.addEventListener(e,t,!Cg&&Rve)}function Ln(i,e,t){i.removeEventListener(e,t,!Cg&&Rve)}function AL(i,e){if(e){if(e[0]===">"&&(e=e.substring(1)),i)try{if(i.matches)return i.matches(e);if(i.msMatchesSelector)return i.msMatchesSelector(e);if(i.webkitMatchesSelector)return i.webkitMatchesSelector(e)}catch{return!1}return!1}}function nSt(i){return i.host&&i!==document&&i.host.nodeType?i.host:i.parentNode}function Cp(i,e,t,n){if(i){t=t||document;do{if(e!=null&&(e[0]===">"?i.parentNode===t&&AL(i,e):AL(i,e))||n&&i===t)return i;if(i===t)break}while(i=nSt(i))}return null}var Ute=/\s+/g;function lu(i,e,t){if(i&&e)if(i.classList)i.classList[t?"add":"remove"](e);else{var n=(" "+i.className+" ").replace(Ute," ").replace(" "+e+" "," ");i.className=(n+(t?" "+e:"")).replace(Ute," ")}}function Oi(i,e,t){var n=i&&i.style;if(n){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(i,""):i.currentStyle&&(t=i.currentStyle),e===void 0?t:t[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=t+(typeof t=="string"?"":"px")}}function $x(i,e){var t="";if(typeof i=="string")t=i;else do{var n=Oi(i,"transform");n&&n!=="none"&&(t=n+" "+t)}while(!e&&(i=i.parentNode));var r=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return r&&new r(t)}function Ive(i,e,t){if(i){var n=i.getElementsByTagName(e),r=0,s=n.length;if(t)for(;r<s;r++)t(n[r],r);return n}return[]}function Qp(){var i=document.scrollingElement;return i||document.documentElement}function Oa(i,e,t,n,r){if(!(!i.getBoundingClientRect&&i!==window)){var s,a,o,l,c,u,d;if(i!==window&&i.parentNode&&i!==Qp()?(s=i.getBoundingClientRect(),a=s.top,o=s.left,l=s.bottom,c=s.right,u=s.height,d=s.width):(a=0,o=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,d=window.innerWidth),(e||t)&&i!==window&&(r=r||i.parentNode,!Cg))do if(r&&r.getBoundingClientRect&&(Oi(r,"transform")!=="none"||t&&Oi(r,"position")!=="static")){var h=r.getBoundingClientRect();a-=h.top+parseInt(Oi(r,"border-top-width")),o-=h.left+parseInt(Oi(r,"border-left-width")),l=a+s.height,c=o+s.width;break}while(r=r.parentNode);if(n&&i!==window){var p=$x(r||i),m=p&&p.a,g=p&&p.d;p&&(a/=g,o/=m,d/=m,u/=g,l=a+u,c=o+d)}return{top:a,left:o,bottom:l,right:c,width:d,height:u}}}function Hte(i,e,t){for(var n=ty(i,!0),r=Oa(i)[e];n;){var s=Oa(n)[t],a=void 0;if(t==="top"||t==="left"?a=r>=s:a=r<=s,!a)return n;if(n===Qp())break;n=ty(n,!1)}return!1}function SC(i,e,t,n){for(var r=0,s=0,a=i.children;s<a.length;){if(a[s].style.display!=="none"&&a[s]!==Ri.ghost&&(n||a[s]!==Ri.dragged)&&Cp(a[s],t.draggable,i,!1)){if(r===e)return a[s];r++}s++}return null}function aG(i,e){for(var t=i.lastElementChild;t&&(t===Ri.ghost||Oi(t,"display")==="none"||e&&!AL(t,e));)t=t.previousElementSibling;return t||null}function td(i,e){var t=0;if(!i||!i.parentNode)return-1;for(;i=i.previousElementSibling;)i.nodeName.toUpperCase()!=="TEMPLATE"&&i!==Ri.clone&&(!e||AL(i,e))&&t++;return t}function Gte(i){var e=0,t=0,n=Qp();if(i)do{var r=$x(i),s=r.a,a=r.d;e+=i.scrollLeft*s,t+=i.scrollTop*a}while(i!==n&&(i=i.parentNode));return[e,t]}function rSt(i,e){for(var t in i)if(i.hasOwnProperty(t)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===i[t][n])return Number(t)}return-1}function ty(i,e){if(!i||!i.getBoundingClientRect)return Qp();var t=i,n=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var r=Oi(t);if(t.clientWidth<t.scrollWidth&&(r.overflowX=="auto"||r.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(r.overflowY=="auto"||r.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return Qp();if(n||e)return t;n=!0}}while(t=t.parentNode);return Qp()}function sSt(i,e){if(i&&e)for(var t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function gN(i,e){return Math.round(i.top)===Math.round(e.top)&&Math.round(i.left)===Math.round(e.left)&&Math.round(i.height)===Math.round(e.height)&&Math.round(i.width)===Math.round(e.width)}var WE;function $ve(i,e){return function(){if(!WE){var t=arguments,n=this;t.length===1?i.call(n,t[0]):i.apply(n,t),WE=setTimeout(function(){WE=void 0},e)}}}function aSt(){clearTimeout(WE),WE=void 0}function Lve(i,e,t){i.scrollLeft+=e,i.scrollTop+=t}function Dve(i){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(i).cloneNode(!0):t?t(i).clone(!0)[0]:i.cloneNode(!0)}var Tu="Sortable"+new Date().getTime();function oSt(){var i=[],e;return{captureAnimationState:function(){if(i=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(r){if(!(Oi(r,"display")==="none"||r===Ri.ghost)){i.push({target:r,rect:Oa(r)});var s=mf({},i[i.length-1].rect);if(r.thisAnimationDuration){var a=$x(r,!0);a&&(s.top-=a.f,s.left-=a.e)}r.fromRect=s}})}},addAnimationState:function(n){i.push(n)},removeAnimationState:function(n){i.splice(rSt(i,{target:n}),1)},animateAll:function(n){var r=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var s=!1,a=0;i.forEach(function(o){var l=0,c=o.target,u=c.fromRect,d=Oa(c),h=c.prevFromRect,p=c.prevToRect,m=o.rect,g=$x(c,!0);g&&(d.top-=g.f,d.left-=g.e),c.toRect=d,c.thisAnimationDuration&&gN(h,d)&&!gN(u,d)&&(m.top-d.top)/(m.left-d.left)===(u.top-d.top)/(u.left-d.left)&&(l=cSt(m,h,p,r.options)),gN(d,u)||(c.prevFromRect=u,c.prevToRect=d,l||(l=r.options.animation),r.animate(c,m,d,l)),l&&(s=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),s?e=setTimeout(function(){typeof n=="function"&&n()},a):typeof n=="function"&&n(),i=[]},animate:function(n,r,s,a){if(a){Oi(n,"transition",""),Oi(n,"transform","");var o=$x(this.el),l=o&&o.a,c=o&&o.d,u=(r.left-s.left)/(l||1),d=(r.top-s.top)/(c||1);n.animatingX=!!u,n.animatingY=!!d,Oi(n,"transform","translate3d("+u+"px,"+d+"px,0)"),this.forRepaintDummy=lSt(n),Oi(n,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),Oi(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){Oi(n,"transition",""),Oi(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},a)}}}}function lSt(i){return i.offsetWidth}function cSt(i,e,t,n){return Math.sqrt(Math.pow(e.top-i.top,2)+Math.pow(e.left-i.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*n.animation}var X1=[],vN={initializeByDefault:!0},TM={mount:function(e){for(var t in vN)vN.hasOwnProperty(t)&&!(t in e)&&(e[t]=vN[t]);X1.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),X1.push(e)},pluginEvent:function(e,t,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var s=e+"Global";X1.forEach(function(a){t[a.pluginName]&&(t[a.pluginName][s]&&t[a.pluginName][s](mf({sortable:t},n)),t.options[a.pluginName]&&t[a.pluginName][e]&&t[a.pluginName][e](mf({sortable:t},n)))})},initializePlugins:function(e,t,n,r){X1.forEach(function(o){var l=o.pluginName;if(!(!e.options[l]&&!o.initializeByDefault)){var c=new o(e,t,e.options);c.sortable=e,c.options=e.options,e[l]=c,sg(n,c.defaults)}});for(var s in e.options)if(e.options.hasOwnProperty(s)){var a=this.modifyOption(e,s,e.options[s]);typeof a<"u"&&(e.options[s]=a)}},getEventProperties:function(e,t){var n={};return X1.forEach(function(r){typeof r.eventProperties=="function"&&sg(n,r.eventProperties.call(t[r.pluginName],e))}),n},modifyOption:function(e,t,n){var r;return X1.forEach(function(s){e[s.pluginName]&&s.optionListeners&&typeof s.optionListeners[t]=="function"&&(r=s.optionListeners[t].call(e[s.pluginName],n))}),r}};function uSt(i){var e=i.sortable,t=i.rootEl,n=i.name,r=i.targetEl,s=i.cloneEl,a=i.toEl,o=i.fromEl,l=i.oldIndex,c=i.newIndex,u=i.oldDraggableIndex,d=i.newDraggableIndex,h=i.originalEvent,p=i.putSortable,m=i.extraEventProperties;if(e=e||t&&t[Tu],!!e){var g,_=e.options,b="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!Cg&&!CM?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=a||t,g.from=o||t,g.item=r||t,g.clone=s,g.oldIndex=l,g.newIndex=c,g.oldDraggableIndex=u,g.newDraggableIndex=d,g.originalEvent=h,g.pullMode=p?p.lastPutMode:void 0;var x=mf(mf({},m),TM.getEventProperties(n,e));for(var w in x)g[w]=x[w];t&&t.dispatchEvent(g),_[b]&&_[b].call(e,g)}}var dSt=["evt"],dc=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=n.evt,s=tSt(n,dSt);TM.pluginEvent.bind(Ri)(e,t,mf({dragEl:Rt,parentEl:Rs,ghostEl:Zi,rootEl:os,nextEl:J_,lastDownEl:$I,cloneEl:bs,cloneHidden:Yv,dragStarted:ZS,putSortable:Co,activeSortable:Ri.active,originalEvent:r,oldIndex:nx,oldDraggableIndex:jE,newIndex:hu,newDraggableIndex:Bv,hideGhostForTarget:Vve,unhideGhostForTarget:Bve,cloneNowHidden:function(){Yv=!0},cloneNowShown:function(){Yv=!1},dispatchSortableEvent:function(o){Ll({sortable:t,name:o,originalEvent:r})}},s))};function Ll(i){uSt(mf({putSortable:Co,cloneEl:bs,targetEl:Rt,rootEl:os,oldIndex:nx,oldDraggableIndex:jE,newIndex:hu,newDraggableIndex:Bv},i))}var Rt,Rs,Zi,os,J_,$I,bs,Yv,nx,hu,jE,Bv,YO,Co,Ew=!1,ML=!1,PL=[],T_,Ud,yN,_N,Wte,jte,ZS,Z1,qE,KE=!1,XO=!1,LI,Yo,bN=[],X8=!1,OL=[],GD=typeof document<"u",ZO=Pve,qte=CM||Cg?"cssFloat":"float",hSt=GD&&!Ove&&!Pve&&"draggable"in document.createElement("div"),kve=function(){if(GD){if(Cg)return!1;var i=document.createElement("x");return i.style.cssText="pointer-events:auto",i.style.pointerEvents==="auto"}}(),Fve=function(e,t){var n=Oi(e),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),s=SC(e,0,t),a=SC(e,1,t),o=s&&Oi(s),l=a&&Oi(a),c=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Oa(s).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Oa(a).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(s&&o.float&&o.float!=="none"){var d=o.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===d)?"vertical":"horizontal"}return s&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||c>=r&&n[qte]==="none"||a&&n[qte]==="none"&&c+u>r)?"vertical":"horizontal"},pSt=function(e,t,n){var r=n?e.left:e.top,s=n?e.right:e.bottom,a=n?e.width:e.height,o=n?t.left:t.top,l=n?t.right:t.bottom,c=n?t.width:t.height;return r===o||s===l||r+a/2===o+c/2},fSt=function(e,t){var n;return PL.some(function(r){var s=r[Tu].options.emptyInsertThreshold;if(!(!s||aG(r))){var a=Oa(r),o=e>=a.left-s&&e<=a.right+s,l=t>=a.top-s&&t<=a.bottom+s;if(o&&l)return n=r}}),n},Nve=function(e){function t(s,a){return function(o,l,c,u){var d=o.options.group.name&&l.options.group.name&&o.options.group.name===l.options.group.name;if(s==null&&(a||d))return!0;if(s==null||s===!1)return!1;if(a&&s==="clone")return s;if(typeof s=="function")return t(s(o,l,c,u),a)(o,l,c,u);var h=(a?o:l).options.group.name;return s===!0||typeof s=="string"&&s===h||s.join&&s.indexOf(h)>-1}}var n={},r=e.group;(!r||II(r)!="object")&&(r={name:r}),n.name=r.name,n.checkPull=t(r.pull,!0),n.checkPut=t(r.put),n.revertClone=r.revertClone,e.group=n},Vve=function(){!kve&&Zi&&Oi(Zi,"display","none")},Bve=function(){!kve&&Zi&&Oi(Zi,"display","")};GD&&!Ove&&document.addEventListener("click",function(i){if(ML)return i.preventDefault(),i.stopPropagation&&i.stopPropagation(),i.stopImmediatePropagation&&i.stopImmediatePropagation(),ML=!1,!1},!0);var S_=function(e){if(Rt){e=e.touches?e.touches[0]:e;var t=fSt(e.clientX,e.clientY);if(t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[Tu]._onDragOver(n)}}},mSt=function(e){Rt&&Rt.parentNode[Tu]._isOutsideThisEl(e.target)};function Ri(i,e){if(!(i&&i.nodeType&&i.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(i));this.el=i,this.options=e=sg({},e),i[Tu]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(i.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Fve(i,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Ri.supportPointer!==!1&&"PointerEvent"in window&&!GE,emptyInsertThreshold:5};TM.initializePlugins(this,i,t);for(var n in t)!(n in e)&&(e[n]=t[n]);Nve(e);for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));this.nativeDraggable=e.forceFallback?!1:hSt,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?jn(i,"pointerdown",this._onTapStart):(jn(i,"mousedown",this._onTapStart),jn(i,"touchstart",this._onTapStart)),this.nativeDraggable&&(jn(i,"dragover",this),jn(i,"dragenter",this)),PL.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),sg(this,oSt())}Ri.prototype={constructor:Ri,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Z1=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,Rt):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,r=this.options,s=r.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(o||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=r.filter;if(CSt(n),!Rt&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||r.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&GE&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Cp(l,r.draggable,n,!1),!(l&&l.animated)&&$I!==l)){if(nx=td(l),jE=td(l,r.draggable),typeof u=="function"){if(u.call(this,e,l,this)){Ll({sortable:t,rootEl:c,name:"filter",targetEl:l,toEl:n,fromEl:n}),dc("filter",t,{evt:e}),s&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(d){if(d=Cp(c,d.trim(),n,!1),d)return Ll({sortable:t,rootEl:d,name:"filter",targetEl:l,fromEl:n,toEl:n}),dc("filter",t,{evt:e}),!0}),u)){s&&e.cancelable&&e.preventDefault();return}r.handle&&!Cp(c,r.handle,n,!1)||this._prepareDragStart(e,o,l)}}},_prepareDragStart:function(e,t,n){var r=this,s=r.el,a=r.options,o=s.ownerDocument,l;if(n&&!Rt&&n.parentNode===s){var c=Oa(n);if(os=s,Rt=n,Rs=Rt.parentNode,J_=Rt.nextSibling,$I=n,YO=a.group,Ri.dragged=Rt,T_={target:Rt,clientX:(t||e).clientX,clientY:(t||e).clientY},Wte=T_.clientX-c.left,jte=T_.clientY-c.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,Rt.style["will-change"]="all",l=function(){if(dc("delayEnded",r,{evt:e}),Ri.eventCanceled){r._onDrop();return}r._disableDelayedDragEvents(),!zte&&r.nativeDraggable&&(Rt.draggable=!0),r._triggerDragStart(e,t),Ll({sortable:r,name:"choose",originalEvent:e}),lu(Rt,a.chosenClass,!0)},a.ignore.split(",").forEach(function(u){Ive(Rt,u.trim(),wN)}),jn(o,"dragover",S_),jn(o,"mousemove",S_),jn(o,"touchmove",S_),jn(o,"mouseup",r._onDrop),jn(o,"touchend",r._onDrop),jn(o,"touchcancel",r._onDrop),zte&&this.nativeDraggable&&(this.options.touchStartThreshold=4,Rt.draggable=!0),dc("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(CM||Cg))){if(Ri.eventCanceled){this._onDrop();return}jn(o,"mouseup",r._disableDelayedDrag),jn(o,"touchend",r._disableDelayedDrag),jn(o,"touchcancel",r._disableDelayedDrag),jn(o,"mousemove",r._delayedDragTouchMoveHandler),jn(o,"touchmove",r._delayedDragTouchMoveHandler),a.supportPointer&&jn(o,"pointermove",r._delayedDragTouchMoveHandler),r._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){Rt&&wN(Rt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Ln(e,"mouseup",this._disableDelayedDrag),Ln(e,"touchend",this._disableDelayedDrag),Ln(e,"touchcancel",this._disableDelayedDrag),Ln(e,"mousemove",this._delayedDragTouchMoveHandler),Ln(e,"touchmove",this._delayedDragTouchMoveHandler),Ln(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?jn(document,"pointermove",this._onTouchMove):t?jn(document,"touchmove",this._onTouchMove):jn(document,"mousemove",this._onTouchMove):(jn(Rt,"dragend",this),jn(os,"dragstart",this._onDragStart));try{document.selection?DI(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(Ew=!1,os&&Rt){dc("dragStarted",this,{evt:t}),this.nativeDraggable&&jn(document,"dragover",mSt);var n=this.options;!e&&lu(Rt,n.dragClass,!1),lu(Rt,n.ghostClass,!0),Ri.active=this,e&&this._appendGhost(),Ll({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Ud){this._lastX=Ud.clientX,this._lastY=Ud.clientY,Vve();for(var e=document.elementFromPoint(Ud.clientX,Ud.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Ud.clientX,Ud.clientY),e!==t);)t=e;if(Rt.parentNode[Tu]._isOutsideThisEl(e),t)do{if(t[Tu]){var n=void 0;if(n=t[Tu]._onDragOver({clientX:Ud.clientX,clientY:Ud.clientY,target:e,rootEl:t}),n&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);Bve()}},_onTouchMove:function(e){if(T_){var t=this.options,n=t.fallbackTolerance,r=t.fallbackOffset,s=e.touches?e.touches[0]:e,a=Zi&&$x(Zi,!0),o=Zi&&a&&a.a,l=Zi&&a&&a.d,c=ZO&&Yo&&Gte(Yo),u=(s.clientX-T_.clientX+r.x)/(o||1)+(c?c[0]-bN[0]:0)/(o||1),d=(s.clientY-T_.clientY+r.y)/(l||1)+(c?c[1]-bN[1]:0)/(l||1);if(!Ri.active&&!Ew){if(n&&Math.max(Math.abs(s.clientX-this._lastX),Math.abs(s.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Zi){a?(a.e+=u-(yN||0),a.f+=d-(_N||0)):a={a:1,b:0,c:0,d:1,e:u,f:d};var h="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");Oi(Zi,"webkitTransform",h),Oi(Zi,"mozTransform",h),Oi(Zi,"msTransform",h),Oi(Zi,"transform",h),yN=u,_N=d,Ud=s}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Zi){var e=this.options.fallbackOnBody?document.body:os,t=Oa(Rt,!0,ZO,!0,e),n=this.options;if(ZO){for(Yo=e;Oi(Yo,"position")==="static"&&Oi(Yo,"transform")==="none"&&Yo!==document;)Yo=Yo.parentNode;Yo!==document.body&&Yo!==document.documentElement?(Yo===document&&(Yo=Qp()),t.top+=Yo.scrollTop,t.left+=Yo.scrollLeft):Yo=Qp(),bN=Gte(Yo)}Zi=Rt.cloneNode(!0),lu(Zi,n.ghostClass,!1),lu(Zi,n.fallbackClass,!0),lu(Zi,n.dragClass,!0),Oi(Zi,"transition",""),Oi(Zi,"transform",""),Oi(Zi,"box-sizing","border-box"),Oi(Zi,"margin",0),Oi(Zi,"top",t.top),Oi(Zi,"left",t.left),Oi(Zi,"width",t.width),Oi(Zi,"height",t.height),Oi(Zi,"opacity","0.8"),Oi(Zi,"position",ZO?"absolute":"fixed"),Oi(Zi,"zIndex","100000"),Oi(Zi,"pointerEvents","none"),Ri.ghost=Zi,e.appendChild(Zi),Oi(Zi,"transform-origin",Wte/parseInt(Zi.style.width)*100+"% "+jte/parseInt(Zi.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,r=e.dataTransfer,s=n.options;if(dc("dragStart",this,{evt:e}),Ri.eventCanceled){this._onDrop();return}dc("setupClone",this),Ri.eventCanceled||(bs=Dve(Rt),bs.removeAttribute("id"),bs.draggable=!1,bs.style["will-change"]="",this._hideClone(),lu(bs,this.options.chosenClass,!1),Ri.clone=bs),n.cloneId=DI(function(){dc("clone",n),!Ri.eventCanceled&&(n.options.removeCloneOnHide||os.insertBefore(bs,Rt),n._hideClone(),Ll({sortable:n,name:"clone"}))}),!t&&lu(Rt,s.dragClass,!0),t?(ML=!0,n._loopId=setInterval(n._emulateDragOver,50)):(Ln(document,"mouseup",n._onDrop),Ln(document,"touchend",n._onDrop),Ln(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",s.setData&&s.setData.call(n,r,Rt)),jn(document,"drop",n),Oi(Rt,"transform","translateZ(0)")),Ew=!0,n._dragStartId=DI(n._dragStarted.bind(n,t,e)),jn(document,"selectstart",n),ZS=!0,GE&&Oi(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,n=e.target,r,s,a,o=this.options,l=o.group,c=Ri.active,u=YO===l,d=o.sort,h=Co||c,p,m=this,g=!1;if(X8)return;function _($,F){dc($,m,mf({evt:e,isOwner:u,axis:p?"vertical":"horizontal",revert:a,dragRect:r,targetRect:s,canSort:d,fromSortable:h,target:n,completed:x,onMove:function(ne,X){return QO(os,t,Rt,r,ne,Oa(ne),e,X)},changed:w},F))}function b(){_("dragOverAnimationCapture"),m.captureAnimationState(),m!==h&&h.captureAnimationState()}function x($){return _("dragOverCompleted",{insertion:$}),$&&(u?c._hideClone():c._showClone(m),m!==h&&(lu(Rt,Co?Co.options.ghostClass:c.options.ghostClass,!1),lu(Rt,o.ghostClass,!0)),Co!==m&&m!==Ri.active?Co=m:m===Ri.active&&Co&&(Co=null),h===m&&(m._ignoreWhileAnimating=n),m.animateAll(function(){_("dragOverAnimationComplete"),m._ignoreWhileAnimating=null}),m!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(n===Rt&&!Rt.animated||n===t&&!n.animated)&&(Z1=null),!o.dragoverBubble&&!e.rootEl&&n!==document&&(Rt.parentNode[Tu]._isOutsideThisEl(e.target),!$&&S_(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function w(){hu=td(Rt),Bv=td(Rt,o.draggable),Ll({sortable:m,name:"change",toEl:t,newIndex:hu,newDraggableIndex:Bv,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=Cp(n,o.draggable,t,!0),_("dragOver"),Ri.eventCanceled)return g;if(Rt.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||m._ignoreWhileAnimating===n)return x(!1);if(ML=!1,c&&!o.disabled&&(u?d||(a=Rs!==os):Co===this||(this.lastPutMode=YO.checkPull(this,c,Rt,e))&&l.checkPut(this,c,Rt,e))){if(p=this._getDirection(e,n)==="vertical",r=Oa(Rt),_("dragOverValid"),Ri.eventCanceled)return g;if(a)return Rs=os,b(),this._hideClone(),_("revert"),Ri.eventCanceled||(J_?os.insertBefore(Rt,J_):os.appendChild(Rt)),x(!0);var C=aG(t,o.draggable);if(!C||_St(e,p,this)&&!C.animated){if(C===Rt)return x(!1);if(C&&t===e.target&&(n=C),n&&(s=Oa(n)),QO(os,t,Rt,r,n,s,e,!!n)!==!1)return b(),C&&C.nextSibling?t.insertBefore(Rt,C.nextSibling):t.appendChild(Rt),Rs=t,w(),x(!0)}else if(C&&ySt(e,p,this)){var S=SC(t,0,o,!0);if(S===Rt)return x(!1);if(n=S,s=Oa(n),QO(os,t,Rt,r,n,s,e,!1)!==!1)return b(),t.insertBefore(Rt,S),Rs=t,w(),x(!0)}else if(n.parentNode===t){s=Oa(n);var E=0,A,P=Rt.parentNode!==t,O=!pSt(Rt.animated&&Rt.toRect||r,n.animated&&n.toRect||s,p),M=p?"top":"left",V=Hte(n,"top","top")||Hte(Rt,"top","top"),L=V?V.scrollTop:void 0;Z1!==n&&(A=s[M],KE=!1,XO=!O&&o.invertSwap||P),E=bSt(e,n,s,p,O?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,XO,Z1===n);var U;if(E!==0){var G=td(Rt);do G-=E,U=Rs.children[G];while(U&&(Oi(U,"display")==="none"||U===Zi))}if(E===0||U===n)return x(!1);Z1=n,qE=E;var H=n.nextElementSibling,k=!1;k=E===1;var D=QO(os,t,Rt,r,n,s,e,k);if(D!==!1)return(D===1||D===-1)&&(k=D===1),X8=!0,setTimeout(vSt,30),b(),k&&!H?t.appendChild(Rt):n.parentNode.insertBefore(Rt,k?H:n),V&&Lve(V,0,L-V.scrollTop),Rs=Rt.parentNode,A!==void 0&&!XO&&(LI=Math.abs(A-Oa(n)[M])),w(),x(!0)}if(t.contains(Rt))return x(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Ln(document,"mousemove",this._onTouchMove),Ln(document,"touchmove",this._onTouchMove),Ln(document,"pointermove",this._onTouchMove),Ln(document,"dragover",S_),Ln(document,"mousemove",S_),Ln(document,"touchmove",S_)},_offUpEvents:function(){var e=this.el.ownerDocument;Ln(e,"mouseup",this._onDrop),Ln(e,"touchend",this._onDrop),Ln(e,"pointerup",this._onDrop),Ln(e,"touchcancel",this._onDrop),Ln(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;if(hu=td(Rt),Bv=td(Rt,n.draggable),dc("drop",this,{evt:e}),Rs=Rt&&Rt.parentNode,hu=td(Rt),Bv=td(Rt,n.draggable),Ri.eventCanceled){this._nulling();return}Ew=!1,XO=!1,KE=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Z8(this.cloneId),Z8(this._dragStartId),this.nativeDraggable&&(Ln(document,"drop",this),Ln(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),GE&&Oi(document.body,"user-select",""),Oi(Rt,"transform",""),e&&(ZS&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Zi&&Zi.parentNode&&Zi.parentNode.removeChild(Zi),(os===Rs||Co&&Co.lastPutMode!=="clone")&&bs&&bs.parentNode&&bs.parentNode.removeChild(bs),Rt&&(this.nativeDraggable&&Ln(Rt,"dragend",this),wN(Rt),Rt.style["will-change"]="",ZS&&!Ew&&lu(Rt,Co?Co.options.ghostClass:this.options.ghostClass,!1),lu(Rt,this.options.chosenClass,!1),Ll({sortable:this,name:"unchoose",toEl:Rs,newIndex:null,newDraggableIndex:null,originalEvent:e}),os!==Rs?(hu>=0&&(Ll({rootEl:Rs,name:"add",toEl:Rs,fromEl:os,originalEvent:e}),Ll({sortable:this,name:"remove",toEl:Rs,originalEvent:e}),Ll({rootEl:Rs,name:"sort",toEl:Rs,fromEl:os,originalEvent:e}),Ll({sortable:this,name:"sort",toEl:Rs,originalEvent:e})),Co&&Co.save()):hu!==nx&&hu>=0&&(Ll({sortable:this,name:"update",toEl:Rs,originalEvent:e}),Ll({sortable:this,name:"sort",toEl:Rs,originalEvent:e})),Ri.active&&((hu==null||hu===-1)&&(hu=nx,Bv=jE),Ll({sortable:this,name:"end",toEl:Rs,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){dc("nulling",this),os=Rt=Rs=Zi=J_=bs=$I=Yv=T_=Ud=ZS=hu=Bv=nx=jE=Z1=qE=Co=YO=Ri.dragged=Ri.ghost=Ri.clone=Ri.active=null,OL.forEach(function(e){e.checked=!0}),OL.length=yN=_N=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":Rt&&(this._onDragOver(e),gSt(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,n=this.el.children,r=0,s=n.length,a=this.options;r<s;r++)t=n[r],Cp(t,a.draggable,this.el,!1)&&e.push(t.getAttribute(a.dataIdAttr)||xSt(t));return e},sort:function(e,t){var n={},r=this.el;this.toArray().forEach(function(s,a){var o=r.children[a];Cp(o,this.options.draggable,r,!1)&&(n[s]=o)},this),t&&this.captureAnimationState(),e.forEach(function(s){n[s]&&(r.removeChild(n[s]),r.appendChild(n[s]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Cp(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(t===void 0)return n[e];var r=TM.modifyOption(this,e,t);typeof r<"u"?n[e]=r:n[e]=t,e==="group"&&Nve(n)},destroy:function(){dc("destroy",this);var e=this.el;e[Tu]=null,Ln(e,"mousedown",this._onTapStart),Ln(e,"touchstart",this._onTapStart),Ln(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Ln(e,"dragover",this),Ln(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),PL.splice(PL.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Yv){if(dc("hideClone",this),Ri.eventCanceled)return;Oi(bs,"display","none"),this.options.removeCloneOnHide&&bs.parentNode&&bs.parentNode.removeChild(bs),Yv=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Yv){if(dc("showClone",this),Ri.eventCanceled)return;Rt.parentNode==os&&!this.options.group.revertClone?os.insertBefore(bs,Rt):J_?os.insertBefore(bs,J_):os.appendChild(bs),this.options.group.revertClone&&this.animate(Rt,bs),Oi(bs,"display",""),Yv=!1}}};function gSt(i){i.dataTransfer&&(i.dataTransfer.dropEffect="move"),i.cancelable&&i.preventDefault()}function QO(i,e,t,n,r,s,a,o){var l,c=i[Tu],u=c.options.onMove,d;return window.CustomEvent&&!Cg&&!CM?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=i,l.dragged=t,l.draggedRect=n,l.related=r||e,l.relatedRect=s||Oa(e),l.willInsertAfter=o,l.originalEvent=a,i.dispatchEvent(l),u&&(d=u.call(c,l,a)),d}function wN(i){i.draggable=!1}function vSt(){X8=!1}function ySt(i,e,t){var n=Oa(SC(t.el,0,t.options,!0)),r=10;return e?i.clientX<n.left-r||i.clientY<n.top&&i.clientX<n.right:i.clientY<n.top-r||i.clientY<n.bottom&&i.clientX<n.left}function _St(i,e,t){var n=Oa(aG(t.el,t.options.draggable)),r=10;return e?i.clientX>n.right+r||i.clientX<=n.right&&i.clientY>n.bottom&&i.clientX>=n.left:i.clientX>n.right&&i.clientY>n.top||i.clientX<=n.right&&i.clientY>n.bottom+r}function bSt(i,e,t,n,r,s,a,o){var l=n?i.clientY:i.clientX,c=n?t.height:t.width,u=n?t.top:t.left,d=n?t.bottom:t.right,h=!1;if(!a){if(o&&LI<c*r){if(!KE&&(qE===1?l>u+c*s/2:l<d-c*s/2)&&(KE=!0),KE)h=!0;else if(qE===1?l<u+LI:l>d-LI)return-qE}else if(l>u+c*(1-r)/2&&l<d-c*(1-r)/2)return wSt(e)}return h=h||a,h&&(l<u+c*s/2||l>d-c*s/2)?l>u+c/2?1:-1:0}function wSt(i){return td(Rt)<td(i)?1:-1}function xSt(i){for(var e=i.tagName+i.className+i.src+i.href+i.textContent,t=e.length,n=0;t--;)n+=e.charCodeAt(t);return n.toString(36)}function CSt(i){OL.length=0;for(var e=i.getElementsByTagName("input"),t=e.length;t--;){var n=e[t];n.checked&&OL.push(n)}}function DI(i){return setTimeout(i,0)}function Z8(i){return clearTimeout(i)}GD&&jn(document,"touchmove",function(i){(Ri.active||Ew)&&i.cancelable&&i.preventDefault()});Ri.utils={on:jn,off:Ln,css:Oi,find:Ive,is:function(e,t){return!!Cp(e,t,e,!1)},extend:sSt,throttle:$ve,closest:Cp,toggleClass:lu,clone:Dve,index:td,nextTick:DI,cancelNextTick:Z8,detectDirection:Fve,getChild:SC};Ri.get=function(i){return i[Tu]};Ri.mount=function(){for(var i=arguments.length,e=new Array(i),t=0;t<i;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(Ri.utils=mf(mf({},Ri.utils),n.utils)),TM.mount(n)})};Ri.create=function(i,e){return new Ri(i,e)};Ri.version=iSt;var la=[],QS,Q8,J8=!1,xN,CN,RL,JS;function TSt(){function i(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return i.prototype={dragStarted:function(t){var n=t.originalEvent;this.sortable.nativeDraggable?jn(document,"dragover",this._handleAutoScroll):this.options.supportPointer?jn(document,"pointermove",this._handleFallbackAutoScroll):n.touches?jn(document,"touchmove",this._handleFallbackAutoScroll):jn(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var n=t.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?Ln(document,"dragover",this._handleAutoScroll):(Ln(document,"pointermove",this._handleFallbackAutoScroll),Ln(document,"touchmove",this._handleFallbackAutoScroll),Ln(document,"mousemove",this._handleFallbackAutoScroll)),Kte(),kI(),aSt()},nulling:function(){RL=Q8=QS=J8=JS=xN=CN=null,la.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,n){var r=this,s=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,o=document.elementFromPoint(s,a);if(RL=t,n||this.options.forceAutoScrollFallback||CM||Cg||GE){TN(t,this.options,o,n);var l=ty(o,!0);J8&&(!JS||s!==xN||a!==CN)&&(JS&&Kte(),JS=setInterval(function(){var c=ty(document.elementFromPoint(s,a),!0);c!==l&&(l=c,kI()),TN(t,r.options,c,n)},10),xN=s,CN=a)}else{if(!this.options.bubbleScroll||ty(o,!0)===Qp()){kI();return}TN(t,this.options,ty(o,!1),!1)}}},sg(i,{pluginName:"scroll",initializeByDefault:!0})}function kI(){la.forEach(function(i){clearInterval(i.pid)}),la=[]}function Kte(){clearInterval(JS)}var TN=$ve(function(i,e,t,n){if(e.scroll){var r=(i.touches?i.touches[0]:i).clientX,s=(i.touches?i.touches[0]:i).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,l=Qp(),c=!1,u;Q8!==t&&(Q8=t,kI(),QS=e.scroll,u=e.scrollFn,QS===!0&&(QS=ty(t,!0)));var d=0,h=QS;do{var p=h,m=Oa(p),g=m.top,_=m.bottom,b=m.left,x=m.right,w=m.width,C=m.height,S=void 0,E=void 0,A=p.scrollWidth,P=p.scrollHeight,O=Oi(p),M=p.scrollLeft,V=p.scrollTop;p===l?(S=w<A&&(O.overflowX==="auto"||O.overflowX==="scroll"||O.overflowX==="visible"),E=C<P&&(O.overflowY==="auto"||O.overflowY==="scroll"||O.overflowY==="visible")):(S=w<A&&(O.overflowX==="auto"||O.overflowX==="scroll"),E=C<P&&(O.overflowY==="auto"||O.overflowY==="scroll"));var L=S&&(Math.abs(x-r)<=a&&M+w<A)-(Math.abs(b-r)<=a&&!!M),U=E&&(Math.abs(_-s)<=a&&V+C<P)-(Math.abs(g-s)<=a&&!!V);if(!la[d])for(var G=0;G<=d;G++)la[G]||(la[G]={});(la[d].vx!=L||la[d].vy!=U||la[d].el!==p)&&(la[d].el=p,la[d].vx=L,la[d].vy=U,clearInterval(la[d].pid),(L!=0||U!=0)&&(c=!0,la[d].pid=setInterval(function(){n&&this.layer===0&&Ri.active._onTouchMove(RL);var H=la[this.layer].vy?la[this.layer].vy*o:0,k=la[this.layer].vx?la[this.layer].vx*o:0;typeof u=="function"&&u.call(Ri.dragged.parentNode[Tu],k,H,i,RL,la[this.layer].el)!=="continue"||Lve(la[this.layer].el,k,H)}.bind({layer:d}),24))),d++}while(e.bubbleScroll&&h!==l&&(h=ty(h,!1)));J8=c}},30),zve=function(e){var t=e.originalEvent,n=e.putSortable,r=e.dragEl,s=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var c=n||s;o();var u=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(d)&&(a("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function oG(){}oG.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=SC(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(t,r):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:zve};sg(oG,{pluginName:"revertOnSpill"});function lG(){}lG.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable,r=n||this.sortable;r.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),r.animateAll()},drop:zve};sg(lG,{pluginName:"removeOnSpill"});Ri.mount(new TSt);Ri.mount(lG,oG);function Yte(i,e,t){i.splice(t,0,i.splice(e,1)[0])}const SSt="esri-layerlist-new-ui",ESt=_i.ofType(zD),Xte="data-sort-filter",Zte="data-layer-uid",ASt="layerUid",Vt={base:"esri-layer-list esri-widget esri-widget--panel",newUI:"esri-layer-list--new-ui",noItems:"esri-layer-list__no-items",list:"esri-layer-list__list",listRoot:"esri-layer-list__list--root",listExclusive:"esri-layer-list__list--exclusive",listInherited:"esri-layer-list__list--inherited",listIndependent:"esri-layer-list__list--independent",item:"esri-layer-list__item",itemContent:"esri-layer-list__item-content",itemMessage:"esri-layer-list__item--has-message",itemInvisible:"esri-layer-list__item--invisible",itemInvisibleAtScale:"esri-layer-list__item--invisible-at-scale",itemChildren:"esri-layer-list__item--has-children",itemSelectable:"esri-layer-list__item--selectable",itemContainer:"esri-layer-list__item-container",actionsMenu:"esri-layer-list__item-actions-menu",actionsMenuItem:"esri-layer-list__item-actions-menu-item",actionsMenuItemActive:"esri-layer-list__item-actions-menu-item--active",actions:"esri-layer-list__item-actions",actionsList:"esri-layer-list__item-actions-list",action:"esri-layer-list__item-action",actionIcon:"esri-layer-list__item-action-icon",actionImage:"esri-layer-list__item-action-image",actionTitle:"esri-layer-list__item-action-title",actionToggle:"esri-layer-list__action-toggle",actionToggleOn:"esri-layer-list__action-toggle--on",label:"esri-layer-list__item-label",message:"esri-layer-list__item-message",title:"esri-layer-list__item-title",statusIndicator:"esri-layer-list__status-indicator",publishing:"esri-layer-list__publishing",updating:"esri-layer-list__updating",connectionStatus:"esri-layer-list__connection-status",connectionStatusConnected:"esri-layer-list__connection-status--connected",toggleVisible:"esri-layer-list__item-toggle",toggleVisibleIcon:"esri-layer-list__item-toggle-icon",toggleIcon:"esri-layer-list__item-toggle-icon",radioIcon:"esri-layer-list__item-radio-icon",childToggle:"esri-layer-list__child-toggle",childToggleOpen:"esri-layer-list__child-toggle--open",childOpened:"esri-layer-list__child-toggle-icon--opened",childClosed:"esri-layer-list__child-toggle-icon--closed",childClosed_RTL:"esri-layer-list__child-toggle-icon--closed-rtl",sortableChosen:"esri-layer-list--chosen",disabled:"esri-disabled",disabledElement:"esri-disabled-element",hidden:"esri-hidden",rotating:"esri-rotating",iconEllipses:"esri-icon-handle-horizontal",iconVisible:"esri-icon-visible",iconInvisible:"esri-icon-non-visible",iconRadioSelected:"esri-icon-radio-checked",iconRadioUnselected:"esri-icon-radio-unchecked",iconNoticeTriangle:"esri-icon-notice-triangle",iconChildrenOpen:"esri-icon-down-arrow",iconDownArrow:"esri-icon-down-arrow",iconRightArrow:"esri-icon-right-triangle-arrow",iconLeftArrow:"esri-icon-left-triangle-arrow",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",widgetIcon:"esri-icon-layers"},SN={actions:"actions",actionSection:"action-section",items:"items"},cS={exclusive:"exclusive",inherited:"inherited",independent:"independent"};function Uve(i){const{actionsOpen:e,children:t}=i;e&&(i.actionsOpen=!1),t.forEach(n=>Uve(n))}const EN="root",Qte={statusIndicators:!0,errors:!1};let Yr=class extends gr{constructor(e,t){super(e,t),this._handles=new mi,this._sortableNodes=new Map,this._sortableMap=new Map,this._focusSortUid=null,this._newUI=Fi(SSt),this._tooltipReferenceMap=new Map,this.visibleItems=null,this.iconClass=Vt.widgetIcon,this.listItemCanGiveFunction=null,this.listItemCanReceiveFunction=null,this.messages=null,this.messagesCommon=null,this.multipleSelectionEnabled=!1,this.selectionEnabled=!1,this.selectedItems=new ESt,this.viewModel=new XH,this.visibleElements={...Qte},this._onSortableSort=({to:n,from:r,item:s,newIndex:a})=>{r&&n&&(r===n?this._sortLayers(this._sortableMap.get(r.dataset.group)):this._moveLayerFromChildList({to:n,from:r,item:s,newIndex:a}))},this._sortableCanSort=(n,r)=>!(!n.el.dataset.group||!r.el.dataset.group),this._sortableCanPull=(n,r,s)=>{const{listItemCanGiveFunction:a}=this,o={selected:s["data-item"],from:r.el["data-item"],to:n.el["data-item"]};return!this._sortableCanSort(n,r)||typeof a!="function"||a.call(null,o)},this._sortableCanPut=(n,r,s)=>{const{listItemCanReceiveFunction:a}=this,o={selected:s["data-item"],from:r.el["data-item"],to:n.el["data-item"]};return!this._sortableCanSort(n,r)||typeof a!="function"||a.call(null,o)},this._onSortableEnd=({oldIndex:n,from:r,to:s,item:a})=>{r!==s&&r.insertBefore(a,r.children[n])}}initialize(){const e=this.operationalItems;this._setVisibleItems(e),this.addHandles([Sn(()=>this.operationalItems,"change",()=>this._itemsChanged(e)),ue(()=>this.visibleElements,()=>this._itemsChanged(e)),ue(()=>this.selectionEnabled,()=>this._toggleAllSorting(),At)])}loadDependencies(){return Promise.all([Ee(()=>import("./calcite-icon-5dd27db1.js"),["./calcite-icon-5dd27db1.js","./icon-1a289254.js","./dom-5b7af1bf.js","./observers-c77bfda3.js"],import.meta.url),Ee(()=>import("./calcite-tooltip-2c1ea5a7.js"),["./calcite-tooltip-2c1ea5a7.js","./tooltip-87951009.js","./dom-5b7af1bf.js","./guid-e49c4e43.js","./floating-ui-bda1a599.js","./preload-helper-41c905a7.js"],import.meta.url)])}destroy(){this._destroySortables(),this._tooltipReferenceMap.clear(),this._handles.destroy(),this._handles=null}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get listItemCreatedFunction(){return this.viewModel.listItemCreatedFunction}set listItemCreatedFunction(e){this.viewModel.listItemCreatedFunction=e}get operationalItems(){return this.viewModel.operationalItems}set operationalItems(e){this.viewModel.operationalItems=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...Qte,...e}}triggerAction(e,t){return this.viewModel.triggerAction(e,t)}render(){var o;const{visibleItems:e,_newUI:t}=this,n=(o=this.viewModel)==null?void 0:o.state,r={[Vt.newUI]:t,[Vt.hidden]:n==="loading",[Vt.disabled]:n==="disabled"},s=this.renderItemTooltips(),a=this.renderItems();return z("div",{class:this.classes(Vt.base,r)},e!=null&&e.length?[s,a]:this.renderNoItems())}renderItemTooltip(e){const{_tooltipReferenceMap:t,messages:n}=this;return e?z("calcite-tooltip",{label:n.layerIncompatible,referenceElement:t.get(e.uid)},n.layerIncompatibleTooltip):null}renderItemTooltipNodes(e){const{incompatible:t,children:n}=e;return[t?this.renderItemTooltip(e):null,...t?[]:n==null?void 0:n.toArray().map(r=>this.renderItemTooltipNodes(r))]}renderItemTooltips(){return this.visibleItems.toArray().map(e=>this.renderItemTooltipNodes(e))}renderNoItems(){return z("div",{class:Vt.noItems},this.messages.noItemsToDisplay)}renderItems(){const{visibleItems:e,selectionEnabled:t,messages:n}=this;return z("ul",{"aria-label":n.widgetLabel,role:t?"listbox":void 0,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,"data-group":EN,bind:this,class:this.classes(Vt.list,Vt.listRoot,Vt.listIndependent)},e==null?void 0:e.map(r=>this.renderItem(r,null)).toArray())}renderActionsMenuIcon(e,t){const{messagesCommon:n}=this,r={[Vt.actionsMenuItemActive]:e.actionsOpen};return z("div",{key:"actions-menu-toggle","data-item":e,bind:this,onclick:this._toggleActionsOpen,onkeydown:this._toggleActionsOpen,class:this.classes(Vt.actionsMenuItem,r),tabindex:"0",role:"button","aria-controls":t,"aria-label":n.options,title:n.options},z("span",{"aria-hidden":"true",class:Vt.iconEllipses}))}renderActionsMenu(e,t,n,r){const{panel:s}=e,a=s&&s.visible?this.renderPanelButton(s):null,o=n===1&&this._getSingleActionButton(t),l=o?this.renderAction({item:e,action:o,singleAction:!0}):null,c=!o&&n?this.renderActionsMenuIcon(e,r):null;return c||a||o?z("div",{key:"actions-menu",class:Vt.actionsMenu},a,l,c):null}renderChildList(e,t){var d;const{selectionEnabled:n}=this,{visibilityMode:r,children:s}=e,a=this._hasChildren(e),o=!a&&n&&((d=e.layer)==null?void 0:d.type)==="group",{exclusive:l,inherited:c}=cS,u={[Vt.listExclusive]:r===l,[Vt.listInherited]:r===c,[Vt.listIndependent]:r!==c&&r!==l};return a||o?z("ul",{bind:this,key:"list-items",id:t,"data-group":e.uid,"data-item":e,afterCreate:this._sortNodeCreated,afterUpdate:this._sortNodeCreated,afterRemoved:this._sortNodeRemoved,class:this.classes(Vt.list,u),"aria-expanded":e.open?"true":"false",role:n?"listbox":r===l?"radiogroup":"group",hidden:!e.open&&!o||null},s==null?void 0:s.map(h=>this.renderItem(h,e)).toArray()):null}renderChildrenToggle(e,t){const{messagesCommon:n}=this,r=this._hasChildren(e),s={[Vt.childToggleOpen]:e.open},a=e.open?n.collapse:n.expand;return r?z("span",{onclick:this._toggleChildrenClick,onkeydown:this._toggleChildrenClick,"data-item":e,key:"toggle-children",class:this.classes(Vt.childToggle,s),tabindex:"0",role:"button","aria-controls":t,"aria-label":a,title:a},z("span",{"aria-hidden":"true",class:this.classes(Vt.childClosed,Vt.iconRightArrow)}),z("span",{"aria-hidden":"true",class:this.classes(Vt.childOpened,Vt.iconDownArrow)}),z("span",{"aria-hidden":"true",class:this.classes(Vt.childClosed_RTL,Vt.iconLeftArrow)})):null}renderItemMessage(e){return e.error?z("div",{key:"esri-layer-list__error",class:Vt.message,role:"alert"},z("span",{"aria-hidden":"true",class:Vt.iconNoticeTriangle}),this.messages.layerError):e.incompatible?z("div",{key:"esri-layer-list__incompatible",class:Vt.message,role:"alert"},z("span",{bind:this,tabIndex:0,"aria-hidden":"true",class:Vt.iconNoticeTriangle,afterCreate:t=>this._setTooltipReference(t,e)}),this.messages.layerIncompatible):null}renderItemContent(e,t,n){const{id:r}=this,s=`${r}_${e.uid}`,a=`${s}_actions`,o=`${s}__list`,{panel:l}=e,c=this._filterActions(e.actionsSections),u=this._countActions(c);return[z("div",{key:"list-item-container",class:Vt.itemContainer},this.renderChildrenToggle(e,o),this.renderLabel(e,t,n),this.renderActionsMenu(e,c,u,a)),this.renderItemMessage(e),u?this.renderActionsSections(e,c,a):null,l&&l.open&&!l.disabled?l.render():null,this.renderChildList(e,o)]}renderItem(e,t){var d;const{_newUI:n,id:r,selectionEnabled:s,selectedItems:a}=this,o=`${`${r}_${e.uid}`}__title`,l=this._hasMessage(e),c=this._hasChildren(e),u={[Vt.itemChildren]:c,[Vt.itemMessage]:!!l,[Vt.itemInvisible]:n&&!e.visible,[Vt.itemInvisibleAtScale]:!e.visibleAtCurrentScale,[Vt.itemSelectable]:s};if(s){const h={[Zte]:(d=e.layer)==null?void 0:d.uid,[Xte]:(!e.sortable).toString()};return z("li",{key:`item-with-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Vt.item,u),"aria-labelledby":o,onclick:this._toggleSelection,onkeydown:this._selectionKeydown,"data-item":e,"data-group":t?t.uid:EN,tabIndex:0,"aria-selected":cN(e,a)?"true":"false",role:"option",...h},this.renderItemContent(e,t,o))}return z("li",{key:`item-no-selection-${e.uid}`,bind:this,afterCreate:this._focusListItem,afterUpdate:this._focusListItem,class:this.classes(Vt.item,u),"aria-labelledby":o},this.renderItemContent(e,t,o))}renderConnectionIcon(e){const{connectionStatus:t}=e;return T(t)?z("calcite-icon",{icon:t==="connected"?"check-circle":"offline",scale:"s"}):null}renderItemStatus(e,t){const{visibleElements:n}=this;if(!n.statusIndicators)return null;const{connectionStatus:r,publishing:s,updating:a}=e,o=a&&!t,l=!!r;return z("span",{class:this.classes({[Vt.statusIndicator]:!0,[Vt.publishing]:s,[Vt.updating]:o,[Vt.connectionStatus]:l,[Vt.connectionStatusConnected]:l&&r==="connected"}),key:"layer-item-status"},this.renderConnectionIcon(e))}renderItemTitle(e,t){const{messages:n}=this;if(!e)return null;const r=e.title||n.untitledLayer,s=e.visibleAtCurrentScale?r:`${r} (${n.layerInvisibleAtScale})`;return z("span",{key:"layer-title-container",id:t,title:s,"aria-label":s,class:Vt.title},r)}renderItemToggleIcon(e,t){const{_newUI:n}=this,{exclusive:r}=cS,s=t&&t.visibilityMode,a={[Vt.toggleVisibleIcon]:n,[Vt.toggleIcon]:n&&s!==r,[Vt.radioIcon]:n&&s===r,[Vt.iconRadioSelected]:s===r&&e.visible,[Vt.iconRadioUnselected]:s===r&&!e.visible,[Vt.iconVisible]:s!==r&&e.visible,[Vt.iconInvisible]:s!==r&&!e.visible};return z("span",{key:"item-toggle-icon",class:this.classes(a),"aria-hidden":"true"})}renderItemToggle(e,t,n){const{selectionEnabled:r,messages:s}=this,{exclusive:a}=cS,o=t&&t.visibilityMode,l=o===a?"radio":"switch";return z("span",r?{key:"item-toggle-selection-enabled",class:Vt.toggleVisible,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":o,tabIndex:0,title:e.visible?s.hideLayer:s.showLayer,"aria-checked":e.visible?"true":"false",role:l,"aria-labelledby":n}:{key:"item-toggle",class:Vt.toggleVisible},this.renderItemToggleIcon(e,t))}renderLabel(e,t,n){const{selectionEnabled:r,_newUI:s,messages:a}=this,{inherited:o,exclusive:l}=cS,c=t==null?void 0:t.visibilityMode,u=c===l?"radio":"switch",d=s?[this.renderItemTitle(e,n),this.renderItemStatus(e,t),this.renderItemToggle(e,t,n)]:[this.renderItemToggle(e,t,n),this.renderItemTitle(e,n),this.renderItemStatus(e,t)],h=z("div",r?{key:`item-label-no-selection-${e.uid}`,class:Vt.label}:{key:`item-label-with-selection-${e.uid}`,class:Vt.label,bind:this,onclick:this._toggleVisibility,onkeydown:this._toggleVisibility,"data-item":e,"data-parent-visibility":c,tabIndex:0,"aria-checked":e.visible?"true":"false",title:e.visible?a.hideLayer:a.showLayer,role:u,"aria-labelledby":n},d);return c===o||e.error?z("div",{key:`item-label-container-${e.uid}`,class:Vt.label},this.renderItemTitle(e,n),this.renderItemStatus(e,t)):h}renderPanelButton(e){const{className:t,open:n,title:r,image:s}=e,a=s||t?t:Vt.iconDefaultAction,o=this._getIconImageStyles(e),l={[Vt.actionsMenuItemActive]:n},c={[Vt.actionImage]:!!o["background-image"],[Vt.disabledElement]:e.disabled};return a&&(c[a]=!!a),z("div",{"aria-disabled":e.disabled.toString(),key:`panel-${e.uid}`,bind:this,"data-panel":e,onclick:this._triggerPanel,onkeydown:this._triggerPanel,class:this.classes(Vt.actionsMenuItem,l),role:"button",tabindex:e.disabled?null:0,title:r,"aria-label":r},z("span",{class:this.classes(c),styles:o}))}renderActionsSections(e,t,n){const r=t.toArray().map((s,a)=>z("ul",{key:`${e}-action-section-${a}`,class:Vt.actionsList},this.renderActionSection(e,s)));return z("div",{role:"group","aria-expanded":e.actionsOpen?"true":"false",key:"actions-section",id:n,class:Vt.actions,hidden:!e.actionsOpen||null},r)}renderActionSection(e,t){return(t&&t.toArray()).map(n=>this.renderAction({item:e,action:n}))}renderActionIcon(e){const{active:t,className:n}=e,r=this._getIconImageStyles(e),s=e.type!=="button"||e.image||n?n:Vt.iconDefaultAction,a={[Vt.actionImage]:!t&&!!r["background-image"],[Vt.iconLoading]:t,[Vt.rotating]:t};return s&&!t&&(a[s]=!0),z("span",{key:"action-icon","aria-hidden":"true",class:this.classes(Vt.actionIcon,a),styles:r})}renderActionTitle(e,t){return t?null:z("span",{key:"action-title",class:Vt.actionTitle},e)}renderAction(e){const{item:t,action:n,singleAction:r}=e,{active:s,disabled:a,title:o}=n,l={[Vt.actionsMenuItem]:r&&n.type==="button",[Vt.action]:s||!r&&n.type!=="toggle",[Vt.actionToggle]:!s&&n.type==="toggle",[Vt.actionToggleOn]:!s&&n.type==="toggle"&&n.value,[Vt.disabledElement]:a},c=[this.renderActionIcon(n),this.renderActionTitle(o,r)];return r?z("div",{bind:this,"data-item":t,"data-action":n,role:"button",key:`single-action-${n.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",title:o,"aria-label":o},c):z("li",{bind:this,"data-item":t,"data-action":n,key:`action-${n.uid}`,onclick:this._triggerAction,onkeydown:this._triggerAction,classes:l,tabindex:"0",role:"button",title:o,"aria-label":o},c)}_setTooltipReference(e,t){this._tooltipReferenceMap.set(t.uid,e),this.scheduleRender()}_hasMessage(e){return!!e.error||e.incompatible}_hasChildren(e){return!!e.children.length&&!this._hasMessage(e)}_sortNodeRemoved(e){const{_sortableMap:t}=this,n=e.dataset.group,r=t.get(n);r&&r.destroy(),t.delete(n)}_destroySortables(){const{_sortableMap:e,_sortableNodes:t}=this;e.forEach(n=>n&&n.destroy()),e.clear(),t.clear()}_moveLayerFromChildList({to:e,from:t,item:n,newIndex:r}){const s=n["data-item"],a=e["data-item"],o=t["data-item"];this.viewModel.moveListItem(s,o,a,r)}_sortLayers(e){var r,s;if(!e)return;const t=e.el["data-item"],n=e.toArray();t?rCt(t,n):Uge((s=(r=this.view)==null?void 0:r.map)==null?void 0:s.layers,n)}_toggleSorting(e,t){const{_sortableMap:n,selectionEnabled:r}=this,s=n.get(t),a=e["data-item"],o=(t===EN||a.childrenSortable&&iCt(a))&&r;if(s)s.option("disabled",!o);else if(o){const l=Ri.create(e,{dataIdAttr:Zte,group:{name:t,pull:this._sortableCanPull,put:this._sortableCanPut},filter:`[${Xte}="true"]`,fallbackTolerance:4,onSort:this._onSortableSort,onEnd:this._onSortableEnd,disabled:!o,chosenClass:Vt.sortableChosen});n.set(t,l)}}_toggleAllSorting(){this._sortableNodes.forEach((e,t)=>this._toggleSorting(e,t))}_sortNodeCreated(e){const t=e.dataset.group;t&&(this._sortableNodes.set(t,e),this._toggleSorting(e,t))}_setVisibleItems(e){this.visibleItems=e==null?void 0:e.filter(t=>!t.hidden&&(this.visibleElements.errors||!t.error))}_getSingleActionButton(e){return e.reduce(t=>t).filter(t=>t&&t.type==="button").getItemAt(0)}_focusListItem(e){var n;const{_focusSortUid:t}=this;!e||!t||((n=e["data-item"].layer)==null?void 0:n.uid)===t&&(e.focus(),this._focusSortUid=null)}_watchActionSectionChanges(e,t){const n=SN.actionSection+t;this._handles.add(e.on("change",this.scheduleRender.bind(this)),n),e.forEach(r=>this._renderOnActionChanges(r,t))}_renderOnActionChanges(e,t){const n=SN.actions+t;e.type!=="toggle"?e.type!=="slider"?this._handles.add(ue(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible],()=>this.scheduleRender(),At),n):this._handles.add(ue(()=>[e==null?void 0:e.className,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value,e==null?void 0:e.displayValueEnabled,e==null?void 0:e.max,e==null?void 0:e.min,e==null?void 0:e.step],()=>this.scheduleRender(),At),n):this._handles.add(ue(()=>[e==null?void 0:e.className,e==null?void 0:e.image,e==null?void 0:e.id,e==null?void 0:e.title,e==null?void 0:e.visible,e==null?void 0:e.value],()=>this.scheduleRender(),At),n)}_renderOnItemChanges(e){const t=e.uid,n=SN.items+t;this._handles.add([ue(()=>{var r,s,a;return[e==null?void 0:e.actionsOpen,e==null?void 0:e.visible,e==null?void 0:e.open,e==null?void 0:e.updating,e==null?void 0:e.connectionStatus,e==null?void 0:e.publishing,e==null?void 0:e.title,e==null?void 0:e.visibleAtCurrentScale,e==null?void 0:e.error,e==null?void 0:e.visibilityMode,e==null?void 0:e.panel,(r=e==null?void 0:e.panel)==null?void 0:r.title,(s=e==null?void 0:e.panel)==null?void 0:s.content,(a=e==null?void 0:e.panel)==null?void 0:a.className,e==null?void 0:e.sortable,e==null?void 0:e.childrenSortable]},()=>this.scheduleRender(),hn),ue(()=>[e==null?void 0:e.hidden,e==null?void 0:e.error],()=>this._setVisibleItems(this.operationalItems)),e.actionsSections.on("change",()=>this.scheduleRender()),e.children.on("change",()=>this.scheduleRender())],n),e.children.forEach(r=>this._renderOnItemChanges(r)),e.actionsSections.forEach(r=>this._watchActionSectionChanges(r,t))}_itemsChanged(e){this._handles.removeAll(),e.forEach(t=>this._renderOnItemChanges(t)),this._tooltipReferenceMap.clear(),this._setVisibleItems(e),this.scheduleRender()}_filterActions(e){return e.map(t=>t.filter(n=>n.visible))}_countActions(e){return e.reduce((t,n)=>t+n.length,0)}_getIconImageStyles(e){const t=e.declaredClass==="esri.widgets.LayerList.ListItemPanel"||e.declaredClass==="esri.support.Action.ActionButton"||e.declaredClass==="esri.support.Action.ActionToggle"?e.image:null;return{"background-image":t?`url("${t}")`:null}}_selectionKeydown(e){var m,g,_,b;const t=["ArrowDown","ArrowUp"],n=Uv(e);if(!t.includes(n))return void this._toggleSelection(e);e.stopPropagation();const r=e.currentTarget,s=r["data-item"],{_sortableMap:a,selectedItems:o}=this,l=r.dataset.group,c=a.get(l);if(!c)return;const u=cN(s,o),d=c.toArray(),h=e.target,p=d.indexOf(h.dataset[ASt]);if(p!==-1){if(n==="ArrowDown"){const x=p+1;if(x>=d.length)return;u?(Yte(d,p,x),c.sort(d),this._sortLayers(c),this._focusSortUid=(m=s.layer)==null?void 0:m.uid):(this._focusSortUid=(g=s.layer)==null?void 0:g.uid,this.scheduleRender())}if(n==="ArrowUp"){const x=p-1;if(x<=-1)return;u?(Yte(d,p,x),c.sort(d),this._sortLayers(c),this._focusSortUid=(_=s.layer)==null?void 0:_.uid):(this._focusSortUid=(b=s.layer)==null?void 0:b.uid,this.scheduleRender())}}}_toggleActionsOpen(e){const t=e.currentTarget["data-item"],{actionsOpen:n}=t,r=!n;r&&this.operationalItems.forEach(s=>Uve(s)),t.actionsOpen=r,e.stopPropagation()}_triggerPanel(e){const t=e.currentTarget["data-panel"];e.stopPropagation(),t&&!t.disabled&&(t.open=!t.open)}_triggerAction(e){const t=e.currentTarget,n=t["data-action"],r=t["data-item"];n.type==="toggle"&&(n.value=!n.value),this.triggerAction(n,r),e.stopPropagation()}_toggleVisibility(e){const t=e.currentTarget,n=t.getAttribute("data-parent-visibility"),r=t["data-item"];n===cS.exclusive&&r.visible||(r.visible=!r.visible),e.stopPropagation()}_toggleChildrenClick(e){const t=e.currentTarget["data-item"];t.open=!t.open,e.stopPropagation()}_toggleSelection(e){var o,l;e.stopPropagation();const{multipleSelectionEnabled:t,selectedItems:n}=this,r=e.currentTarget["data-item"],s=cN(r,n),{length:a}=n;if(!t)return a&&!(s&&a===1)?(n.removeAll(),void n.add(r)):void(s?(o=n.remove)==null?void 0:o.call(n,s):n.add(r));s?(l=n.remove)==null||l.call(n,s):n.add(r)}};f([y()],Yr.prototype,"visibleItems",void 0),f([y()],Yr.prototype,"iconClass",void 0),f([y()],Yr.prototype,"label",null),f([y()],Yr.prototype,"listItemCanGiveFunction",void 0),f([y()],Yr.prototype,"listItemCanReceiveFunction",void 0),f([y()],Yr.prototype,"listItemCreatedFunction",null),f([y(),En("esri/widgets/LayerList/t9n/LayerList")],Yr.prototype,"messages",void 0),f([y(),En("esri/t9n/common")],Yr.prototype,"messagesCommon",void 0),f([y()],Yr.prototype,"multipleSelectionEnabled",void 0),f([y()],Yr.prototype,"operationalItems",null),f([y()],Yr.prototype,"selectionEnabled",void 0),f([y()],Yr.prototype,"selectedItems",void 0),f([y()],Yr.prototype,"view",null),f([WC("trigger-action"),y({type:XH})],Yr.prototype,"viewModel",void 0),f([y()],Yr.prototype,"visibleElements",void 0),f([Mr("visibleElements")],Yr.prototype,"castVisibleElements",null),f([dr()],Yr.prototype,"_toggleActionsOpen",null),f([dr()],Yr.prototype,"_triggerPanel",null),f([dr()],Yr.prototype,"_triggerAction",null),f([dr()],Yr.prototype,"_toggleVisibility",null),f([dr()],Yr.prototype,"_toggleChildrenClick",null),f([dr()],Yr.prototype,"_toggleSelection",null),Yr=f([ge("esri.widgets.LayerList")],Yr);const MSt=Yr,hs={main:new Xt([255,127,0]),selected:new Xt([255,255,255]),outline:new Xt([0,0,0,.5]),selectedOutline:new Xt([255,255,255]),hoverOutline:new Xt([255,255,255]),secondary:new Xt([255,255,255]),secondaryOutline:new Xt([100,100,100]),transparent:new Xt([0,0,0,0])};function QC(i,e){if(e)for(const t in e)i[t]=e[t]}let YE=class{constructor(e){this.size=8,this.hoverSize=10,this.color=hs.main,this.hoverColor=hs.main,this.outlineColor=hs.outline,this.hoverOutlineColor=hs.hoverOutline,QC(this,e)}};class PSt{constructor(e){this.color=hs.secondary,this.hoverColor=hs.main,QC(this,e)}}let OSt=class{constructor(e){this.color=hs.transparent,this.hoverColor=hs.transparent,this.outlineColor=hs.main,this.hoverOutlineColor=hs.main,this.stagedColor=hs.transparent,this.stagedOutlineColor=hs.secondary,QC(this,e)}},RSt=class{constructor(e){this.vertex=new YE,this.midpoint=new YE({color:hs.secondary,outlineColor:hs.secondaryOutline,size:6}),this.selected=new YE({color:hs.selected,hoverColor:hs.selected,hoverOutlineColor:hs.hoverOutline}),QC(this,e)}},ISt=class{constructor(e){this.center=new YE({color:hs.secondaryOutline}),this.fill=new OSt,this.line=new PSt,this.vertex=new YE({color:hs.selected,outlineColor:hs.main,hoverColor:hs.selected,hoverOutlineColor:hs.secondaryOutline}),QC(this,e)}},$St=class{constructor(e){this.reshapeGraphics=new RSt,this.transformGraphics=new ISt,QC(this,e)}};const uBt=new $St;let Hve=class extends xM{constructor(e,t,n){super(t,n),this.point=e}equals(e){return e instanceof Hve&&ul(this.point,e.point)}},LSt=class{draw(e,t){const n=this._getUniqueHints(e),r=[];for(const s of n)s instanceof qH&&r.push(this.visualizeIntersectionPoint(s,t)),s instanceof Lh&&r.push(this.visualizeLine(s,t)),s instanceof WH&&r.push(this.visualizeParallelSign(s,t)),s instanceof VD&&r.push(this.visualizeRightAngleQuad(s,t)),s instanceof Hve&&r.push(this.visualizePoint(s,t));return JE(r)}_getUniqueHints(e){const t=[];for(const n of e){let r=!0;for(const s of t)if(n.equals(s)){r=!1;break}r&&t.push(n)}return t}},DSt=class extends LSt{constructor(e){super(),this._graphicsLayer=e}visualizeIntersectionPoint(e,t){return this._visualizeSnappingIndicator(new Wt({x:e.intersectionPoint[0],y:e.intersectionPoint[1],spatialReference:t.coordinateHelper.spatialReference}),FSt)}visualizePoint(e,t){return this._visualizeSnappingIndicator(new Wt({x:e.point[0],y:e.point[1],spatialReference:t.coordinateHelper.spatialReference}),NSt)}visualizeLine(e,t){return this._visualizeSnappingIndicator(new sx({paths:[[e.lineStart,e.lineEnd]],spatialReference:t.coordinateHelper.spatialReference}),VSt)}visualizeParallelSign(e,t){return this._visualizeSnappingIndicator(new sx({paths:[[e.lineStart,e.lineEnd]],spatialReference:t.coordinateHelper.spatialReference}),BSt)}visualizeRightAngleQuad(e,t){return this._visualizeSnappingIndicator(new sx({paths:[[e.previousVertex,e.centerVertex,e.nextVertex]],spatialReference:t.coordinateHelper.spatialReference}),HSt(e))}_visualizeSnappingIndicator(e,t){const n=new ao({geometry:e,symbol:t});return this._graphicsLayer.add(n),bh(()=>{this._graphicsLayer.remove(n)})}};const EC=hs.main.toArray(),kSt=[...hs.main.toRgb(),100],FSt=new wh({outline:new s2({width:1.5,color:EC}),size:15,color:[0,0,0,0]}),NSt=new wh({outline:{width:.5,color:[0,0,0,1]},size:10,color:EC}),VSt=new n3({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:pxe.Butt,joinStyle:fxe.Round,miterLimit:10,width:Gp(Fu.lineHintWidthTarget),color:EC}]}}}),BSt=new n3({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:-1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,1.5],[7,1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:EC}]}}],scaleSymbolsProportionally:!0,respectFrame:!0},{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:1,z:0},anchorPointUnits:"Relative",size:5,markerPlacement:{type:"CIMMarkerPlacementOnLine",placePerPart:!0,angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-5,ymin:-1.5,xmax:5,ymax:1.5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[7,0],[-7,0],[-7,-1.5],[7,-1.5]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:EC}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),Gve=i=>new n3({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPoint:{x:.5,y:.5,z:0},anchorPointUnits:"Relative",size:Gp(Fu.rightAngleHintSize),rotation:i,markerPlacement:{type:"CIMMarkerPlacementOnVertices",placePerPart:!0,angleToLine:!0,placeOnEndPoints:!1},frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[5,-5],[-5,-5],[-5,5],[5,5],[5,-5]]]},symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:Gp(Fu.rightAngleHintOutlineSize),color:EC},{type:"CIMSolidFill",enable:!0,color:kSt}]}}],scaleSymbolsProportionally:!0,respectFrame:!0}]}}}),zSt=Gve(45),USt=Gve(225),HSt=(()=>{const i=xt(),e=xt(),t=q();return n=>(Yn(i,n.centerVertex,n.previousVertex),Yn(e,n.nextVertex,n.previousVertex),Yie(t,i,e),t[2]<0?zSt:USt)})();var ca;(function(i){i[i.Z=0]="Z",i[i.M=1]="M"})(ca||(ca={}));let GSt=class{constructor(e){this.spatialReference=e}createVector(){return this._tag(xt())}pointToVector(e){return this._tag(dn(e.x,e.y))}arrayToVector(e){return this._tag(dn(e[0],e[1]))}vectorToArray(e){return[e[0],e[1]]}pointToArray(e){return[e.x,e.y]}vectorToPoint(e,t=new Wt){return t.x=e[0],t.y=e[1],t.z=void 0,t.m=void 0,t.spatialReference=this.spatialReference,t}arrayToPoint(e,t=new Wt){return t.x=e[0],t.y=e[1],t.z=void 0,t.m=void 0,t.spatialReference=this.spatialReference,t}vectorToDehydratedPoint(e,t={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return t.x=e[0],t.y=e[1],t.z=void 0,t.m=void 0,t.hasZ=!1,t.hasM=!1,t.spatialReference=this.spatialReference,t}lerp(e,t,n,r){return Hv(r,e,t,n)}addDelta(e,t,n){e[0]+=t,e[1]+=n}distance(e,t){return sf(e,t)}getZ(e,t){return t}hasZ(){return!1}getM(e,t){return t}hasM(){return!1}clone(e){return this._tag(Zie(e))}copy(e,t){return Zs(t,e)}fromXYZ(e){return this._tag(dn(e[0],e[1]))}toXYZ(e,t=q()){return je(t,e[0],e[1],0)}equals(e,t){return SB(e,t)}_tag(e){return e}},Jte=class{constructor(e,t){this._valueType=e,this.spatialReference=t}createVector(){return this._tag(q())}pointToVector(e){return this._tag(Gt(e.x,e.y,this._valueType===ca.Z?e.z:e.m))}arrayToVector(e){return this._tag(Gt(e[0],e[1],e[2]||0))}vectorToArray(e){return[e[0],e[1],e[2]]}pointToArray(e){return this._valueType===ca.Z?[e.x,e.y,e.z]:[e.x,e.y,e.m]}vectorToPoint(e,t=new Wt){return t.x=e[0],t.y=e[1],t.z=this._valueType===ca.Z?e[2]:void 0,t.m=this._valueType===ca.M?e[2]:void 0,t.spatialReference=this.spatialReference,t}arrayToPoint(e,t=new Wt){return t.x=e[0],t.y=e[1],t.z=this._valueType===ca.Z?e[2]:void 0,t.m=this._valueType===ca.M?e[2]:void 0,t.spatialReference=this.spatialReference,t}vectorToDehydratedPoint(e,t={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){const n=this._valueType===ca.Z,r=this._valueType===ca.M;return t.x=e[0],t.y=e[1],t.z=n?e[2]:void 0,t.m=r?e[2]:void 0,t.hasZ=n,t.hasM=r,t.spatialReference=this.spatialReference,t}lerp(e,t,n,r){return oo(r,e,t,n)}addDelta(e,t,n,r){e[0]+=t,e[1]+=n,this._valueType===ca.Z&&(e[2]+=r)}distance(e,t){return this._valueType===ca.Z?Gn(e,t):sf(e,t)}getZ(e,t){return this._valueType===ca.Z?e[2]:t}hasZ(){return this._valueType===ca.Z}getM(e,t){return this._valueType===ca.M?e[2]:t}hasM(){return this._valueType===ca.M}clone(e){return this._tag(gu(e))}copy(e,t){return Ge(t,e)}fromXYZ(e,t=0,n=0){return this._tag(Gt(e[0],e[1],this._valueType===ca.Z?e.length>2?e[2]:t:n))}toXYZ(e,t=q()){return je(t,e[0],e[1],this._valueType===ca.Z?e[2]:0)}equals(e,t){return af(e,t)}_tag(e){return e}},WSt=class{constructor(e){this.spatialReference=e}createVector(){return this._tag(Dn())}pointToVector(e){return this._tag(Xn(e.x,e.y,e.z,e.m))}arrayToVector(e){return this._tag(Xn(e[0],e[1],e[2]||0,e[3]||0))}vectorToArray(e){return[e[0],e[1],e[2],e[3]]}pointToArray(e){return[e.x,e.y,e.z,e.m]}vectorToPoint(e,t=new Wt){return t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.spatialReference=this.spatialReference,t}arrayToPoint(e,t=new Wt){return t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.spatialReference=this.spatialReference,t}vectorToDehydratedPoint(e,t={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return t.x=e[0],t.y=e[1],t.z=e[2],t.m=e[3],t.hasZ=!0,t.hasM=!0,t.spatialReference=this.spatialReference,t}lerp(e,t,n,r){return bne(r,e,t,n)}addDelta(e,t,n,r){e[0]+=t,e[1]+=n,e[2]+=r}distance(e,t){return Gn(e,t)}getZ(e){return e[2]}hasZ(){return!0}getM(e){return e[3]}hasM(){return!0}clone(e){return this._tag(yne(e))}copy(e,t){return Em(t,e)}fromXYZ(e,t=0,n=0){return this._tag(Xn(e[0],e[1],e.length>2?e[2]:t,n))}toXYZ(e,t=q()){return je(t,e[0],e[1],e[2])}equals(e,t){return ebe(e,t)}_tag(e){return e}};function cG(i,e,t){return i&&e?new WSt(t):e?new Jte(ca.M,t):i?new Jte(ca.Z,t):new GSt(t)}function jSt(i,e){if(!e.supported)return;let t=1/0,n=-1/0;const r=e.upperBoundX-e.lowerBoundX;i.forEach(a=>{let o=a.pos[0];for(;o<e.lowerBoundX;)o+=r;for(;o>e.upperBoundX;)o-=r;t=Math.min(t,o),n=Math.max(n,o),a.pos[0]=o});const s=n-t;r-s<s&&i.forEach(a=>{a.pos[0]<0&&(a.pos[0]+=r)})}function qSt(i,e){const t=aB(i);return e===Ot.Global&&t?{supported:!0,lowerBoundX:t.valid[0],upperBoundX:t.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}let XE=class{constructor(e){this.component=e,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(e){this._pos=e,this.component.unnormalizeVertexPositions()}},Nm=class{constructor(e,t,n){this.component=e,this.leftVertex=t,this.rightVertex=n,this.type="edge",t.rightEdge=this,n.leftEdge=this}},Lx=class{constructor(e,t){this._spatialReference=e,this._viewingMode=t,this.vertices=[],this.edges=[]}unnormalizeVertexPositions(){this.vertices.length<=1||jSt(this.vertices,qSt(this._spatialReference,this._viewingMode))}updateVertexIndex(e,t){if(this.vertices.length===0)return;const n=this.vertices[0];let r=null,s=e,a=t;do r=s,r.index=a++,s=r.rightEdge?r.rightEdge.rightVertex:null;while(s!=null&&s!==n);r.leftEdge&&r!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(r),this.vertices.length-1)}getFirstVertex(){return this.vertices.length===0?null:this.vertices[0]}getLastVertex(){return this.vertices.length===0?null:this.vertices[this.vertices.length-1]}isClosed(){return this.vertices.length>2&&this.vertices[0].leftEdge!==null}swapVertices(e,t){const n=this.vertices[e];this.vertices[e]=this.vertices[t],this.vertices[t]=n}iterateVertices(e){if(this.vertices.length===0)return;const t=this.vertices[0];let n=t;do e(n,n.index),n=T(n.rightEdge)?n.rightEdge.rightVertex:null;while(n!==t&&n!=null)}},SM=class extends Pn{constructor(e,t){super(),this.type=e,this.coordinateHelper=t,this._geometry=null,this._dirty=!0,this.components=[]}get geometry(){if(this._dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon()}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}notifyChanges(e){this._dirty=!0,this.emit("change",e)}_toPoint(){return this.components.length===0||this.components[0].vertices.length===0?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const e=[],t=this.coordinateHelper.vectorToArray;for(const n of this.components){if(n.vertices.length<1)continue;const r=[];let s=n.vertices.find(o=>o.leftEdge==null);const a=s;do r.push(t(s.pos)),s=s.rightEdge?s.rightEdge.rightVertex:null;while(s&&s!==a);e.push(r)}return new sx({paths:e,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const e=[],t=this.coordinateHelper.vectorToArray;for(const n of this.components){if(n.vertices.length<1)continue;const r=[],s=n.vertices[0];let a=s;const o=a;do r.push(t(a.pos)),a=T(a.rightEdge)?a.rightEdge.rightVertex:null;while(a&&a!==o);n.isClosed()&&r.push(t(s.pos)),e.push(r)}return new Om({rings:e,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(e,t){const n=e.spatialReference,r=cG(e.hasZ,e.hasM,n),s=new SM(e.type,r);switch(e.type){case"polygon":{const a=e.rings;for(let o=0;o<a.length;++o){const l=a[o],c=new Lx(n,t),u=l.length>2&&K0(l[0],l[l.length-1]),d=u?l.length-1:l.length;for(let p=0;p<d;++p){const m=r.arrayToVector(l[p]),g=new XE(c);c.vertices.push(g),g.pos=m,g.index=p}const h=c.vertices.length-1;for(let p=0;p<h;++p){const m=c.vertices[p],g=c.vertices[p+1],_=new Nm(c,m,g);c.edges.push(_)}if(u){const p=new Nm(c,c.vertices[c.vertices.length-1],c.vertices[0]);c.edges.push(p)}s.components.push(c)}break}case"polyline":for(const a of e.paths){const o=new Lx(n,t),l=a.length;for(let u=0;u<l;++u){const d=r.arrayToVector(a[u]),h=new XE(o);o.vertices.push(h),h.pos=d,h.index=u}const c=o.vertices.length-1;for(let u=0;u<c;++u){const d=o.vertices[u],h=o.vertices[u+1],p=new Nm(o,d,h);o.edges.push(p)}s.components.push(o)}break;case"point":{const a=new Lx(n,t),o=new XE(a);o.index=0,o.pos=r.pointToVector(e),a.vertices.push(o),s.components.push(a);break}}return s}};var pm;(function(i){i[i.NEW_STEP=0]="NEW_STEP",i[i.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS"})(pm||(pm={}));let KSt=class{constructor(e,t,n){this._editGeometry=e,this._component=t,this._pos=n,this._addedVertex=null,this._originalEdge=null,this._left=null,this._right=null}apply(){let e="redo";B(this._addedVertex)&&(e="apply",this._addedVertex=new XE(this._component));const t=this._component.getLastVertex();if(B(t))this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let n=null;t.rightEdge&&(this._originalEdge=t.rightEdge,n=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1)),this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,B(this._left)&&(this._left=new Nm(this._component,t,this._addedVertex)),this._component.edges.push(this._left),t.rightEdge=this._left,T(this._originalEdge)&&T(n)&&(B(this._right)&&(this._right=new Nm(this._component,this._addedVertex,n)),this._component.edges.push(this._right),n.leftEdge=this._right),this._component.updateVertexIndex(this._addedVertex,t.index+1)}this._editGeometry.notifyChanges({operation:e,addedVertices:[this._addedVertex]})}undo(){B(this._addedVertex)||(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),T(this._left)&&(this._component.edges.splice(this._component.edges.indexOf(this._left),1),this._left.leftVertex.rightEdge=null),T(this._right)&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),T(this._originalEdge)&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),T(this._left)?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}},Wve=class{constructor(e,t,n){this._editGeometry=e,this._vertices=t,this.operation=n,this._undone=!1}apply(){this._vertices.forEach(e=>this.operation.apply(e)),this._editGeometry.components.forEach(e=>e.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach(e=>this.operation.undo(e)),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices}),this._undone=!0}canAccumulate(e){if(this._undone||e._vertices.length!==this._vertices.length)return!1;for(let t=0;t<e._vertices.length;++t)if(e._vertices[t]!==this._vertices[t])return!1;return this.operation.canAccumulate(e.operation)}accumulate(e){return!!(e instanceof Wve&&this.canAccumulate(e))&&(this._vertices.forEach(t=>this.operation.accumulate(t,e.operation)),this.operation.accumulateParams(e.operation),this._editGeometry.components.forEach(t=>t.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0)}};var Jp;(function(i){i[i.CUMULATIVE=0]="CUMULATIVE",i[i.REPLACE=1]="REPLACE"})(Jp||(Jp={}));let YSt=class{constructor(e,t,n=0){this._editGeometry=e,this._vertices=t,this._minNumberOfVertices=n,this.removedVertices=null}apply(){let e="redo";if(this.removedVertices==null){const t=this.removedVertices=[];this._vertices.forEach(n=>{const r=this._removeVertex(n);T(r)&&t.push(r)}),e="apply"}else this.removedVertices.forEach(t=>{this._removeVertex(t.removedVertex)});this._editGeometry.notifyChanges({operation:e,removedVertices:this._vertices})}undo(){var e;(e=this.removedVertices)==null||e.forEach(t=>{this._undoRemoveVertex(t)}),this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(e){const t=e.component;if(t.vertices.length<=this._minNumberOfVertices)return null;const n={removedVertex:e,createdEdge:null},r=e.leftEdge,s=e.rightEdge;return t.vertices.splice(t.vertices.indexOf(e),1),r&&(t.edges.splice(t.edges.indexOf(r),1),r.leftVertex.rightEdge=null),s&&(t.edges.splice(t.edges.indexOf(s),1),s.rightVertex.leftEdge=null),e.index===0&&s&&this._vertices.length>0&&t.swapVertices(t.vertices.indexOf(s.rightVertex),0),r&&s&&(n.createdEdge=new Nm(t,r.leftVertex,s.rightVertex),t.edges.push(n.createdEdge)),s&&t.updateVertexIndex(s.rightVertex,s.rightVertex.index-1),n}_undoRemoveVertex(e){const t=e.removedVertex,n=e.removedVertex.component,r=t.leftEdge,s=t.rightEdge;e.createdEdge&&n.edges.splice(n.edges.indexOf(e.createdEdge),1),n.vertices.push(t),r&&(n.edges.push(r),r.leftVertex.rightEdge=r),s&&(n.edges.push(s),s.rightVertex.leftEdge=s),n.updateVertexIndex(t,t.index)}},XSt=class{constructor(e,t,n){this._editGeometry=e,this._edge=t,this._t=n,this.createdVertex=null,this._left=null,this._right=null}apply(){let e="redo";const t=this._edge,n=t.component,r=t.leftVertex,s=t.rightVertex;n.edges.splice(n.edges.indexOf(t),1),B(this.createdVertex)&&(e="apply",this.createdVertex=new XE(t.component)),n.vertices.push(this.createdVertex),this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(t.leftVertex.pos,t.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector()),B(this._left)&&(this._left=new Nm(n,r,this.createdVertex)),this._left.leftVertex.leftEdge?n.edges.push(this._left):n.edges.unshift(this._left),r.rightEdge=this._left,B(this._right)&&(this._right=new Nm(n,this.createdVertex,s)),n.edges.push(this._right),s.leftEdge=this._right,n.updateVertexIndex(this.createdVertex,r.index+1),this._editGeometry.notifyChanges({operation:e,addedVertices:[this.createdVertex]})}undo(){if(B(this.createdVertex)||B(this._left)||B(this._right))return null;const e=this._edge,t=e.component,n=this.createdVertex.leftEdge,r=this.createdVertex.rightEdge,s=n==null?void 0:n.leftVertex,a=r==null?void 0:r.rightVertex;t.vertices.splice(t.vertices.indexOf(this.createdVertex),1),t.edges.splice(t.edges.indexOf(this._left),1),t.edges.splice(t.edges.indexOf(this._right),1),this._edge.leftVertex.leftEdge?t.edges.push(this._edge):t.edges.unshift(this._edge),s&&(s.rightEdge=e),a&&(a.leftEdge=e),s&&t.updateVertexIndex(s,s.index),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}},jve=class{constructor(e,t,n){this._editGeometry=e,this._vertex=t,this._pos=n}apply(){const e=B(this._originalPosition);e&&(this._originalPosition=this._vertex.pos),this._apply(e?"apply":"redo")}undo(){this._vertex.pos=kt(this._originalPosition),this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(e){return e instanceof jve&&e._vertex===this._vertex&&(this._pos=e._pos,this._apply("apply"),!0)}_apply(e){this._vertex.pos=this._pos,this._editGeometry.components.forEach(t=>t.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:e,updatedVertices:[this._vertex]})}},ZSt=class{constructor(e,t){this._editGeometry=e,this._component=t,this._createdEdge=null}apply(){let e="redo";if(B(this._createdEdge)){e="apply";const t=this._component.getFirstVertex(),n=this._component.getLastVertex();if(this._component.isClosed()||this._component.vertices.length<3||B(t)||B(n))return;this._createdEdge=new Nm(this._component,n,t)}this._createdEdge.leftVertex.rightEdge=this._createdEdge,this._createdEdge.rightVertex.leftEdge=this._createdEdge,this._component.edges.push(this._createdEdge),this._editGeometry.notifyChanges({operation:e})}undo(){B(this._createdEdge)||(BI(this._component.edges,this._createdEdge),this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}},qve=class{constructor(e,t,n,r){this._helper=e,this.dx=t,this.dy=n,this.dz=r}_move(e,t,n,r){this._helper.addDelta(e.pos,t,n,r)}apply(e){this._move(e,this.dx,this.dy,this.dz)}undo(e){this._move(e,-this.dx,-this.dy,-this.dz)}canAccumulate(e){return e instanceof qve}accumulate(e,t){this._move(e,t.dx,t.dy,t.dz)}accumulateParams(e){this.dx+=e.dx,this.dy+=e.dy,this.dz+=e.dz}},eB=class{constructor(e,t,n,r=0,s=ZE.IMMEDIATE){this._helper=e,this._planeType=t,this._edge=n,this.distance=r,this._plane=Dr(),this._offsetPlane=Dr(),this._minDistance=-1/0,this._maxDistance=1/0,this._selectedArrow=1,s===ZE.IMMEDIATE&&this._initialize()}get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){var s,a,o,l;const e=this._toXYZ(this._edge.leftVertex.pos),t=this._toXYZ((a=(s=this._edge.leftVertex.leftEdge)==null?void 0:s.leftVertex)==null?void 0:a.pos),n=this._toXYZ(this._edge.rightVertex.pos),r=this._toXYZ((l=(o=this._edge.rightVertex.rightEdge)==null?void 0:o.rightVertex)==null?void 0:l.pos);this._edgeDirection=Hm(q(),e,n),this._left=this._computeNeighbor(e,t,this._edgeDirection),this._right=this._computeNeighbor(n,r,this._edgeDirection)}_toXYZ(e){return T(e)?this._helper.toXYZ(e):null}_pointToXYZ(e){return this._toXYZ(this._helper.pointToVector(e))}_computeNeighbor(e,t,n){if(B(t))return{start:e,end:t,direction:Gt(-n[1],n[0],0),isOriginalDirection:!0};const r=Hm(q(),e,t),s=!this._passesBisectingAngleThreshold(r,n);return{start:e,end:t,direction:s?this._bisectVectorsPerpendicular(n,r):r,isOriginalDirection:!s}}_passesBisectingAngleThreshold(e,t){const n=Math.abs(RB(t,e));return n>=eie&&n<=Math.PI-eie}_bisectVectorsPerpendicular(e,t){const n=dt(e,t)<0?e:No(q(),e),r=Math.abs(dt(n,t));if(!(r<tie||r>1-tie))return this._bisectDirection(n,t);const s=vi(q(),n,[0,0,1]);return mt(s,s)}_bisectDirection(e,t){const n=rt(q(),e,t);return mt(n,n)}_initializePlane(){const e=this._computeNormalDirection(this._left),t=this._computeNormalDirection(this._right);dt(e,t)<0&&No(t,t),Gx(this._left.start,this._bisectDirection(e,t),this._plane)}_computeNormalDirection(e){const t=vi(q(),e.direction,this._edgeDirection);mt(t,t);const n=vi(q(),this._edgeDirection,t);return this._planeType===tB.XY&&(n[2]=0),mt(n,n)}_initializeDistanceConstraints(){T(this._left.end)&&!this.requiresSplitEdgeLeft&&this._updateDistanceConstraint(tr(this._plane,this._left.end)),T(this._right.end)&&!this.requiresSplitEdgeRight&&this._updateDistanceConstraint(tr(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(e){e<=0&&(this._minDistance=Math.max(this._minDistance,e)),e>=0&&(this._maxDistance=Math.min(this._maxDistance,e))}_updateIntersectDistanceConstraint(e){const t=ro(e),n=this._edgeDirection,r=rt(q(),this._left.start,this._left.direction),s=rt(q(),this._right.start,this._right.direction),a=this._pointInBasis2D(xt(),t,n,this._left.start),o=this._pointInBasis2D(xt(),t,n,r),l=this._pointInBasis2D(xt(),t,n,this._right.start),c=this._pointInBasis2D(xt(),t,n,s),[u]=cxt({start:o,end:a,type:gs.LINE},{start:c,end:l,type:gs.LINE});if(!u)return;const d=Yn(xt(),a,o);my(d,d);const h=Yn(xt(),u,o),p=cr(d,h),m=rt(q(),r,Ye(q(),this._left.direction,-p)),g=tr(e,m);this._updateDistanceConstraint(g)}_pointInBasis2D(e,t,n,r){return e[0]=L0(t,r),e[1]=L0(n,r),e}_offset(e,t){Number.isFinite(this._minDistance)&&(t=Math.max(this._minDistance,t)),Number.isFinite(this._maxDistance)&&(t=Math.min(this._maxDistance,t)),nE(this._offsetPlane,this._plane),this._offsetPlane[3]-=t;const n=(s,a,o)=>T(a)&&W0e(this._offsetPlane,s,rt(q(),s,a),o),r=q();(e===this._edge.leftVertex?n(this._left.start,this._left.direction,r):n(this._right.start,this._right.direction,r))&&this._helper.copy(this._helper.fromXYZ(r,void 0,this._helper.getM(e.pos)),e.pos)}selectArrowFromStartPoint(e){this._selectedArrow=FB(this.plane,this._pointToXYZ(e))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(e){return tr(this.plane,this._pointToXYZ(e))}apply(e){this._offset(e,this.distance)}undo(e){this._offset(e,0)}canAccumulate(e){return e instanceof eB&&this._edge.leftVertex.index===e._edge.leftVertex.index&&this._edge.rightVertex.index===e._edge.rightVertex.index&&this._edge.component===e._edge.component&&this._maybeEqualsVec3(this._left.direction,e._left.direction)&&this._maybeEqualsVec3(this._right.direction,e._right.direction)&&af(ro(this._plane),ro(e._plane))}accumulate(e,t){const n=this._plane[3]-t._plane[3]+t.distance;this._offset(e,n)}accumulateParams(e){const t=e.distance-e._plane[3];this.distance=t+this._plane[3]}clone(){const e=new eB(this._helper,this._planeType,this._edge,this.distance,ZE.DEFERRED);return nE(e._plane,this._plane),nE(e._offsetPlane,this._offsetPlane),e._maxDistance=this._maxDistance,e._minDistance=this._minDistance,e._left=this._cloneNeighbor(this._left),e._right=this._cloneNeighbor(this._right),e._edgeDirection=Ge(q(),this._edgeDirection),e}_maybeEqualsVec3(e,t){return B(e)&&B(t)||T(e)&&T(t)&&af(e,t)}_cloneNeighbor({start:e,end:t,direction:n,isOriginalDirection:r}){return{start:Ge(q(),e),end:T(t)?Ge(q(),t):null,direction:Ge(q(),n),isOriginalDirection:r}}};const eie=zi(15),tie=.001;var tB,ZE;(function(i){i[i.XYZ=0]="XYZ",i[i.XY=1]="XY"})(tB||(tB={})),function(i){i[i.IMMEDIATE=0]="IMMEDIATE",i[i.DEFERRED=1]="DEFERRED"}(ZE||(ZE={}));let Kve=class{constructor(e,t,n=Jp.CUMULATIVE){this.origin=e,this.angle=t,this._accumulationType=n}_rotate(e,t){t0e(e.pos,e.pos,this.origin,t)}apply(e){this._rotate(e,this.angle)}undo(e){this._rotate(e,-this.angle)}canAccumulate(e){return e instanceof Kve&&K0(this.origin,e.origin)}accumulate(e,t){const n=t._accumulationType===Jp.REPLACE;this._rotate(e,n?t.angle-this.angle:t.angle)}accumulateParams(e){const t=e._accumulationType===Jp.REPLACE;this.angle=t?e.angle:this.angle+e.angle}},Yve=class{constructor(e,t,n,r,s=Jp.CUMULATIVE){this.origin=e,this.axis1=t,this.factor1=n,this.factor2=r,this._accumulationType=s,this.axis2=dn(t[1],-t[0])}_scale(e,t,n){NG(e.pos,e.pos,this.origin,this.axis1,t),NG(e.pos,e.pos,this.origin,this.axis2,n)}apply(e){this._scale(e,this.factor1,this.factor2)}undo(e){this._scale(e,1/this.factor1,1/this.factor2)}canAccumulate(e){return e instanceof Yve&&K0(this.origin,e.origin)&&K0(this.axis1,e.axis1)}accumulate(e,t){t._accumulationType===Jp.REPLACE?this._scale(e,t.factor1/this.factor1,t.factor2/this.factor2):this._scale(e,t.factor1,t.factor2)}accumulateParams(e){const t=e._accumulationType===Jp.REPLACE;this.factor1=t?e.factor1:this.factor1*e.factor1,this.factor2=t?e.factor2:this.factor2*e.factor2}},QSt=class{constructor(){this._operations=[],this._closed=!1}close(){this._closed=!0}apply(){for(const e of this._operations)e.apply()}undo(){for(let e=this._operations.length-1;e>=0;e--)this._operations[e].undo()}accumulate(e){if(this._closed)return!1;const t=this._operations.length?this._operations[this._operations.length-1]:null;return t&&t.accumulate(e)||(this._operations.push(e),e.apply()),!0}},WD=class extends Pn{constructor(e){super(),this.data=e,this._undoStack=[],this._redoStack=[],this._listener=this.data.on("change",t=>{t.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:t.addedVertices,operation:t.operation}),t.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:t.removedVertices,operation:t.operation}),t.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:t.updatedVertices,operation:t.operation})})}destroy(){this._listener.remove()}splitEdge(e,t){return this._apply(new XSt(this.data,e,t))}updateVertices(e,t,n=pm.ACCUMULATE_STEPS){return this._apply(new Wve(this.data,e,t),n)}moveVertices(e,t,n,r,s=pm.ACCUMULATE_STEPS){return this.updateVertices(e,new qve(this.data.coordinateHelper,t,n,r),s)}scaleVertices(e,t,n,r,s,a=pm.ACCUMULATE_STEPS,o=Jp.CUMULATIVE){return this.updateVertices(e,new Yve(t,n,r,s,o),a)}rotateVertices(e,t,n,r=pm.ACCUMULATE_STEPS,s=Jp.CUMULATIVE){return this.updateVertices(e,new Kve(t,n,s),r)}removeVertices(e){return this._apply(new YSt(this.data,e,this._minNumVerticesPerType))}appendVertex(e){return this.data.components.length===0?null:this._apply(new KSt(this.data,this.data.components[0],e))}setVertexPosition(e,t){return this._apply(new jve(this.data,e,t))}offsetEdge(e,t,n,r=pm.ACCUMULATE_STEPS){return this.updateVertices([t.leftVertex,t.rightVertex],new eB(this.data.coordinateHelper,e,t,n),r)}closeComponent(e){return this.data.components.includes(e)?this._apply(new ZSt(this.data,e)):null}canRemoveVertex(){return this.data.components[0].vertices.length>this._minNumVerticesPerType}createUndoGroup(){const e=new QSt;return this._apply(e),{remove:()=>e.close()}}undo(){if(this._undoStack.length>0){const e=this._undoStack.pop();return e.undo(),this._redoStack.push(e),e}return null}redo(){if(this._redoStack.length>0){const e=this._redoStack.pop();return e.apply(),this._undoStack.push(e),e}return null}get canUndo(){return this._undoStack.length>0}get canRedo(){return this._redoStack.length>0}get lastOperation(){return this._undoStack.length>0?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(e,t=pm.ACCUMULATE_STEPS){return t!==pm.NEW_STEP&&!B(this.lastOperation)&&this.lastOperation.accumulate(e)||(e.apply(),this._undoStack.push(e),this._redoStack=[]),e}static fromGeometry(e,t){return new WD(SM.fromGeometry(e,t))}},IL=class{constructor(e){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.editGeometryOperations=e.editGeometryOperations,this.elevationInfo=e.elevationInfo,this.pointer=e.pointer,this.vertexHandle=e.vertexHandle,this.excludeFeature=e.excludeFeature,this.visualizer=e.visualizer,this.selfSnappingZ=e.selfSnappingZ}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}},zv=class extends et{constructor(e){super(e),this.constrainResult=t=>t,this._snapPoints=null,this._abortController=null,this._stagedPoint=null,this._snap=DL(async(t,n,r,s)=>{const a=await this._frameTask.schedule(()=>n.snap({...t,context:r,signal:s}),s);a.valid&&await this._frameTask.schedule(()=>{this.stagedPoint=a.apply(),t!==this._snapPoints&&T(this._snapPoints)&&(this.stagedPoint=n.update({...this._snapPoints,context:r}))},s)})}get stagedPoint(){return this._stagedPoint}set stagedPoint(e){this._stagedPoint=this.constrainResult(e)}initialize(){var t,n;const e=this.view.type==="3d"?(n=(t=this.view)==null?void 0:t.resourceController)==null?void 0:n.scheduler:null;this._frameTask=T(e)?e.registerTask($r.SNAPPING):GA}destroy(){this._abortController=ll(this._abortController),this._frameTask=Gr(this._frameTask)}async snap(e,t,n){const{point:r,scenePoint:s}=e;return this.stagedPoint=t.update({point:r,scenePoint:s,context:n}),this._snapPoints=e,B(this._abortController)&&(this._abortController=new AbortController),this._snap(e,t,n,this._abortController.signal)}abort(){this._abortController=ll(this._abortController)}};f([y({constructOnly:!0})],zv.prototype,"view",void 0),f([y()],zv.prototype,"stagedPoint",null),f([y()],zv.prototype,"constrainResult",void 0),f([y()],zv.prototype,"_stagedPoint",void 0),zv=f([ge("esri.views.interactive.snapping.SnappingOperation")],zv);var iB;let Dl=iB=class extends Pn.EventedAccessor{constructor(i){super(i),this._hasZ=null,this._cursorScreenPoint=null,this._activePointerId=null,this._stagedVertexUnsnapped=null,this._lastVertexUnsnapped=null,this._handles=new mi,this._viewHandlesKey="view-handles",this._undoRedoHandlesKey="undo-redo-handles",this._drawToolHandlesKey="draw-tool",this._nativeEventHistory={undoStack:[],redoStack:[]},this.interactiveUndoDisabled=!1,this.history=[],this.redoHistory=[],this.snapToScene=!1,this.view=null,this.elevationInfo=null,this.defaultZ=0,this._coordinateHelper=cG(i.hasZ,!1,i.view.spatialReference),this._snappingManager=i.snappingManager,this._editGeometryOperations=new WD(new SM(i.editGeometryType??"polygon",this._coordinateHelper)),this._snappingGraphicsLayer=new wB({id:iB.SNAPPING_GRAPHICS_LAYER_ID,listMode:"hide",internal:!0}),this._snappingContext=new IL({editGeometryOperations:this._editGeometryOperations,elevationInfo:{mode:"on-the-ground",offset:0},pointer:"mouse",visualizer:new DSt(this._snappingGraphicsLayer)}),this._activeComponent=new Lx(i.view.spatialReference,Ot.Local),this._editGeometryOperations.data.components.push(this._activeComponent)}normalizeCtorArgs(i){const e={...i};return delete e.editGeometryType,e}initialize(){this._snappingOperation=new zv({view:this.view}),this.view.type==="2d"&&this.view.map.layers.add(this._snappingGraphicsLayer)}destroy(){this._handles.destroy(),this.view.map.layers.remove(this._snappingGraphicsLayer),this._snappingGraphicsLayer.destroy(),T(this._snappingManager)&&this._snappingManager.doneSnapping(),this._snappingOperation=_t(this._snappingOperation),this._editGeometryOperations.destroy()}get _committedVertices(){return this._editGeometryOperations.data.components[0].vertices.map(i=>i.pos)}get vertices(){return T(this._stagedVertex)?[...this._committedVertices,this._coordinateHelper.pointToArray(this._stagedVertex)]:this._committedVertices}get hasZ(){return T(this._hasZ)?this._hasZ:this.view.type==="3d"}set hasZ(i){this._hasZ=i,this.notifyChange("hasZ")}get _stagedVertex(){return this._snappingOperation.stagedPoint}set _stagedVertex(i){this._snappingOperation.stagedPoint=ko(i)}canUndo(){return this._editGeometryOperations.canUndo}canRedo(){return this._editGeometryOperations.canRedo}undo(){this.canUndo&&this._editGeometryOperations.undo()}redo(){this.canRedo&&this._editGeometryOperations.redo()}getCoordsFromScreenPoint(i){const e=this.screenToMap(i);return B(e)?null:e.hasZ?[e.x,e.y,e.z]:[e.x,e.y]}getCoordsAndPointFromScreenPoint(i){const e=this.screenToMap(i);return B(e)?null:e.hasZ?{vertex:[e.x,e.y,e.z],mapPoint:e}:{vertex:[e.x,e.y],mapPoint:e}}screenToMap(i){let e=null;if(this.view.type==="3d")if(this.hasZ){const t=Jt(this.elevationInfo,JSt);e=this.view.sceneIntersectionHelper.intersectElevationFromScreen(Fn(i.x,i.y),t,this._getGeometryZValue())}else{const t=Jt(this.elevationInfo,eEt);e=this.view.sceneIntersectionHelper.intersectElevationFromScreen(Fn(i.x,i.y),t,0),T(e)&&(e.z=void 0)}else e=this.view.toMap(i),T(e)&&(e.z=this.hasZ?this._getGeometryZValue():void 0);return e}_pushCursorVertex(i,e){const t=Id(i[0],i[1],null,this.view.spatialReference);this._stagedVertexUnsnapped=t;const n=this._snappingManager;if(B(n))return this._stagedVertex=t,void e();iy(this._snappingOperation.snap({point:t},n,this._snappingContext)).then(()=>{e()})}_popCursorVertex(){this._stagedVertexUnsnapped=null,this._stagedVertex=null}_getGeometryZValue(){return this.defaultZ}_abortSnapping(){this._snappingOperation.abort()}_isDuplicateOfLastVertex(i){const e=this._editGeometryOperations.data.components[0].getLastVertex();if(T(e)&&i[0]===e[0]&&i[1]===e[1])return!0;const{x:t,y:n}=this._coordinateHelper.vectorToDehydratedPoint(i);return!(!T(this._lastVertexUnsnapped)||t!==this._lastVertexUnsnapped.x||n!==this._lastVertexUnsnapped.y)}_shouldHandlePointerEvent(i){return this._isPrimaryPointerAction(i)&&(B(this._activePointerId)||this._activePointerId===i.pointerId)}_vertexAddHandler(i){const e=T(this._stagedVertex)?this._coordinateHelper.pointToArray(this._stagedVertex):this.getCoordsFromScreenPoint(this._cursorScreenPoint);T(e)&&this._addVertex(e,i.native)}_drawCompleteHandler(i){this._completeDrawing(i.native)}_isPrimaryPointerAction(i){return i.pointerType!=="mouse"||i.button===0}};Dl.SNAPPING_GRAPHICS_LAYER_ID="DrawAction-snapping-graphics-layer",f([y({readOnly:!0})],Dl.prototype,"vertices",null),f([y({type:Boolean,nonNullable:!0})],Dl.prototype,"interactiveUndoDisabled",void 0),f([y({readOnly:!0})],Dl.prototype,"history",void 0),f([y({readOnly:!0})],Dl.prototype,"redoHistory",void 0),f([y()],Dl.prototype,"snapToScene",void 0),f([y()],Dl.prototype,"view",void 0),f([y()],Dl.prototype,"elevationInfo",void 0),f([y({nonNullable:!0})],Dl.prototype,"defaultZ",void 0),f([y()],Dl.prototype,"hasZ",null),f([y()],Dl.prototype,"_snappingOperation",void 0),f([y()],Dl.prototype,"_stagedVertex",null),Dl=iB=f([ge("esri.views.draw.DrawAction")],Dl);const JSt={mode:"absolute-height",offset:0},eEt={mode:"on-the-ground",offset:0},EM=Dl;class ef{constructor(e,t,n,r){this.view=e,this.native=t,this.vertexIndex=n,this.vertices=r,this.defaultPrevented=!1,this.type="vertex-add"}preventDefault(){this.defaultPrevented=!0}}let uG=class{constructor(e,t,n,r){this.view=e,this.native=t,this.vertexIndex=n,this.vertices=r,this.defaultPrevented=!1,this.type="vertex-remove"}preventDefault(){this.defaultPrevented=!0}},ag=class{constructor(e,t,n,r,s=null){this.view=e,this.native=t,this.vertexIndex=n,this.vertices=r,this.mapPoint=s,this.coordinates=null,this.defaultPrevented=!1,this.type="cursor-update",this.coordinates=r.length===1?r[0]:null}preventDefault(){this.defaultPrevented=!0}},og=class{constructor(e,t){this.native=e,this.vertices=t,this.coordinates=null,this.defaultPrevented=!1,this.type="draw-complete",this.coordinates=t.length===1?t[0]:null}preventDefault(){this.defaultPrevented=!0}},nB=class extends EM{constructor(e){super(e),this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1}initialize(){this._addViewHandles(),this._addUndoRedoHandles()}destroy(){this._removeViewHandles(),this._removeUndoRedoHandles(),this.emit("destroy")}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}complete(){this._completeDrawing()}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("click",e=>{e.stopPropagation()},Pt.TOOL),this.view.on("pointer-down",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=Cr(e),e.pointerType==="touch"&&this._updateCursor(e.native))},Pt.TOOL),this.view.on("pointer-move",e=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._abortSnapping(),this._cursorScreenPoint=Cr(e),e.pointerType!=="touch"&&this._updateCursor(e.native)},Pt.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._addVertexOnPointerUp=!1)},Pt.TOOL),this.view.on("pointer-up",e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp)this._vertexAddHandler(e);else{const t=e.pointerType==="touch";this._updateCursor(e.native,t)}},Pt.TOOL),this.view.on("drag",["Shift"],e=>{e.stopPropagation()},Pt.TOOL),this.view.on("double-click",e=>{e.stopPropagation(),this._drawCompleteHandler(e)},Pt.TOOL),this.view.on("double-click",["Control"],e=>{e.stopPropagation(),this._drawCompleteHandler(e)},Pt.TOOL),this.view.on("key-down",e=>{const{key:t,repeat:n}=e;t===fi.vertexAdd&&!n&&this._cursorScreenPoint?(e.stopPropagation(),this._abortSnapping(),this._vertexAddHandler(e)):t!==fi.complete||n?t!==fi.undo||this.interactiveUndoDisabled||n?t!==fi.redo||this.interactiveUndoDisabled||n?t!==fi.pan||n||e.stopPropagation():(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e))},Pt.TOOL),this.view.on("key-up",e=>{e.key===fi.pan&&e.stopPropagation()},Pt.TOOL)],this._viewHandlesKey)}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._handles.add([this._editGeometryOperations.on("vertex-remove",e=>{if(this.notifyChange("vertices"),e.operation==="undo"){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const n=[...this._committedVertices];T(this._stagedVertex)&&n.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new uG(this.view,t,e.vertices[0].index,n))}}),this._editGeometryOperations.on("vertex-add",e=>{if(this.notifyChange("vertices"),e.operation==="apply"){const t=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],n=this._committedVertices.length-1,r=new ef(this.view,t,n,this.vertices);this.emit("vertex-add",r),r.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if(e.operation==="redo"){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const n=[...this._committedVertices];T(this._stagedVertex)&&n.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new ef(this.view,t,e.vertices[0].index,n))}})],this._undoRedoHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_removeUndoRedoHandles(){this._handles.remove(this._undoRedoHandlesKey)}_addVertex(e,t){const n=this._coordinateHelper.arrayToVector(e);if(this._isDuplicateOfLastVertex(n))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(n);const r=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(r)}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const n=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);T(n)&&!t&&this._pushCursorVertex(n.vertex,()=>this.emit("cursor-update",new ag(this.view,e,this._activeComponent.vertices.length,this.vertices,T(this._stagedVertex)?new Wt(this._stagedVertex):null)))}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this._abortSnapping(),T(this._snappingManager)&&this._snappingManager.doneSnapping(),this.vertices.length<1)return;const t=new og(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}};nB=f([ge("esri.views.draw.MultipointDrawAction")],nB);const Xve=["freehand","hybrid","click"],jD="click";let tEt=class{constructor({grabbableForEvent:e}){this.events=new Pn,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=e}intersectionDistance(e,t){return 0}attach(){}detach(){}};function rx(i,e,t,n){if(n==null||i.hasZ||(n=void 0),i.type==="point")return i.x+=e,i.y+=t,i.hasZ&&n!=null&&(i.z+=n),i;if(i.type==="multipoint"){const a=i.points;for(let o=0;o<a.length;o++)a[o]=iie(a[o],e,t,n);return i}if(i.type==="extent")return i.xmin+=e,i.xmax+=e,i.ymin+=t,i.ymax+=t,n!=null&&(i.zmin+=n,i.zmax+=n),i;const r=Ux(i),s=i.type==="polyline"?i.paths:i.rings;for(let a=0;a<r.length;a++){const o=r[a];for(let l=0;l<o.length;l++)o[l]=iie(o[l],e,t,n)}return"paths"in i?i.paths=s:i.rings=s,i}function BBt(i,e,t,n,r){const s=i.clone(),a=n.resolution;if(s.type==="point"){if(r)rx(s,e*a,-t*a);else{const o=n.state.transform,l=n.state.inverseTransform,c=o[0]*s.x+o[2]*s.y+o[4],u=o[1]*s.x+o[3]*s.y+o[5];s.x=l[0]*(c+e)+l[2]*(u+t)+l[4],s.y=l[1]*(c+e)+l[3]*(u+t)+l[5]}return s}if(s.type==="multipoint"){if(r)rx(s,e*a,-t*a);else{const o=s.points,l=n.state.transform,c=n.state.inverseTransform;for(let u=0;u<o.length;u++){const d=o[u],h=l[0]*d[0]+l[2]*d[1]+l[4],p=l[1]*d[0]+l[3]*d[1]+l[5],m=c[0]*(h+e)+c[2]*(p+t)+c[4],g=c[1]*(h+e)+c[3]*(p+t)+c[5];o[u]=VA(d,m,g,void 0)}}return s}if(s.type==="extent"){if(r)rx(s,e*a,-t*a);else{const o=n.state.transform,l=n.state.inverseTransform,c=o[0]*s.xmin+o[2]*s.ymin+o[4],u=o[1]*s.xmin+o[3]*s.ymin+o[5],d=o[0]*s.xmax+o[2]*s.ymax+o[4],h=o[1]*s.xmax+o[3]*s.ymax+o[5];s.xmin=l[0]*(c+e)+l[2]*(u+t)+l[4],s.ymin=l[1]*(c+e)+l[3]*(u+t)+l[5],s.xmax=l[0]*(d+e)+l[2]*(h+t)+l[4],s.ymax=l[1]*(d+e)+l[3]*(h+t)+l[5]}return s}if(r)rx(s,e*a,-t*a);else{const o=Ux(s),l=s.type==="polyline"?s.paths:s.rings,c=n.state.transform,u=n.state.inverseTransform;for(let d=0;d<o.length;d++){const h=o[d];for(let p=0;p<h.length;p++){const m=h[p],g=c[0]*m[0]+c[2]*m[1]+c[4],_=c[1]*m[0]+c[3]*m[1]+c[5],b=u[0]*(g+e)+u[2]*(_+t)+u[4],x=u[1]*(g+e)+u[3]*(_+t)+u[5];h[p]=VA(m,b,x,void 0)}}"paths"in s?s.paths=l:s.rings=l}return s}function zBt(i,e,t,n){if(i.type==="point"){const{x:m,y:g}=i,_=n?n[0]:m,b=n?n[1]:g,x=i.clone(),w=(m-_)*e+_,C=(g-b)*t+b;return x.x=w,x.y=C,x}if(i.type==="multipoint"){const m=Ux(i),g=qi(),[_,b,x,w]=$G(g,[m]),C=n?n[0]:(_+x)/2,S=n?n[1]:(w+b)/2,E=i.clone(),A=E.points;for(let P=0;P<A.length;P++){const O=A[P],[M,V]=O,L=(M-C)*e+C,U=(V-S)*t+S;A[P]=VA(O,L,U,void 0)}return E}if(i.type==="extent"){const{xmin:m,xmax:g,ymin:_,ymax:b}=i,x=n?n[0]:(m+g)/2,w=n?n[1]:(b+_)/2,C=i.clone();if(C.xmin=(m-x)*e+x,C.ymax=(b-w)*t+w,C.xmax=(g-x)*e+x,C.ymin=(_-w)*t+w,C.xmin>C.xmax){const S=C.xmin,E=C.xmax;C.xmin=E,C.xmax=S}if(C.ymin>C.ymax){const S=C.ymin,E=C.ymax;C.ymin=E,C.ymax=S}return C}const r=Ux(i),s=qi(),[a,o,l,c]=$G(s,r),u=n?n[0]:(a+l)/2,d=n?n[1]:(c+o)/2,h=i.clone(),p=h.type==="polyline"?h.paths:h.rings;for(let m=0;m<r.length;m++){const g=r[m];for(let _=0;_<g.length;_++){const b=g[_],[x,w]=b,C=(x-u)*e+u,S=(w-d)*t+d;p[m][_]=VA(b,C,S,void 0)}}return"paths"in h?h.paths=p:h.rings=p,h}function UBt(i,e,t,n,r,s){const a=Math.sqrt((t-i)*(t-i)+(n-e)*(n-e));return Math.sqrt((r-i)*(r-i)+(s-e)*(s-e))/a}function HBt(i,e,t){const n=Math.atan2(e.y-t.y,e.x-t.x)-Math.atan2(i.y-t.y,i.x-t.x),r=Math.atan2(Math.sin(n),Math.cos(n));return ql(r)}function iie(i,e,t,n){return VA(i,i[0]+e,i[1]+t,i[2]!=null&&n!=null?i[2]+n:void 0)}function VA(i,e,t,n){const r=[e,t];return i.length>2&&r.push(n??i[2]),i.length>3&&r.push(i[3]),r}function iEt(i,e){let t=null,n=null;return r=>{if(r.action==="cancel")return void(T(n)&&(n.execute({action:"cancel"}),t=null,n=null));const s={action:r.action,screenStart:r.start,screenEnd:r.screenPoint};r.action==="start"&&B(t)&&(t=new AC,n=new AC,e(i,t,n,r.pointerType,s)),T(t)&&t.execute(s),r.action==="end"&&T(t)&&(t=null,n=null)}}function AN(i,e){return i.events.on("drag",iEt(i,e))}function GBt(i,e){const t=[i.x,i.y,i.z],n=e,r=[Math.cos(n),Math.sin(n)],s=Math.sqrt(r[0]*r[0]+r[1]*r[1]);if(s===0)return null;r[0]/=s,r[1]/=s;const a=o=>{const l=(o.x-t[0])*r[0]+(o.y-t[1])*r[1];o.x=t[0]+l*r[0],o.y=t[1]+l*r[1]};return o=>(a(o.mapStart),a(o.mapEnd),{...o,axis:r})}function nEt(i,e){let t=null;return n=>{if(n.action==="start"&&(t=rEt(i,n.mapStart.spatialReference,e)),B(t))return null;const r=n.mapEnd.x-n.mapStart.x,s=n.mapEnd.y-n.mapStart.y,a=n.mapEnd.z-n.mapStart.z;return t.move(r,s,a),{...n,translationX:r,translationY:s,translationZ:a}}}function Zve(i,e){return B(i)?null:i.spatialReference.equals(e)?i.clone():Bc(i,e)}function rEt(i,e,t){const n=i.geometry,r=cut(e);if(B(n))return null;if(n.type==="mesh")return sEt(i,n,r,t);const s=Zve(n,r),a=n.spatialReference;return B(s)?null:{move:(o,l,c)=>{const u=rx(s.clone(),o,l,c);u.spatialReference.equals(a)?i.geometry=u:i.geometry=Bc(u,a)}}}function sEt(i,e,t,n){if(T(e.transform))return aEt(i,e,e.transform,t);if(!e.spatialReference.equals(t))return null;let r=0,s=0,a=0;return{move:(o,l,c)=>{const u=o-r,d=l-s,h=c-a;if(u||d||h){const p=new Wt(e.origin.x+u,e.origin.y+d,e.origin.z+h,e.origin.spatialReference);e.centerAt(p,{geographic:n===Ot.Global}),i.notifyGeometryChanged(),r=o,s=l,a=c}}}}function aEt(i,e,t,n){const r=Zve(t.getOriginPoint(e.spatialReference),n),s=e.spatialReference;return B(r)?null:{move:(a,o,l)=>{const c=rx(r.clone(),a,o,l);if(c.spatialReference.equals(s))t.origin=Gt(c.x,c.y,c.z);else{const u=Bc(c,s);T(u)&&(t.origin=Gt(u.x,u.y,u.z))}i.notifyMeshTransformChanged(),i.notifyGeometryChanged()}}}function WBt(i,e){const t=i.map(n=>kt(nEt(n,e))).filter(n=>T(n));return n=>{const r=n.mapEnd.x-n.mapStart.x,s=n.mapEnd.y-n.mapStart.y,a=n.mapEnd.z-n.mapStart.z;return t.forEach(o=>o(n)),{...n,translationX:r,translationY:s,translationZ:a}}}function oEt(i,e){const t=new Map;for(const n of e)t.set(n,ko(i[n]));return n=>(t.forEach((r,s)=>{i[s]=r}),n)}function lEt(i){return T(i.geometry)&&i.geometry.type==="mesh"?cEt(i,i.geometry):oEt(i,["geometry"])}function cEt(i,e){const t=T(e.transform)?e.transform.clone():null,n=e.vertexAttributes.clonePositional();return r=>(e.transform=t,e.vertexAttributes=n,i.notifyGeometryChanged(),r)}function jBt(i){const e=i.map(t=>kt(lEt(t))).filter(t=>T(t));return t=>(e.forEach(n=>n(t)),t)}function qBt(){let i=0,e=0,t=0;return n=>{n.action==="start"&&(i=n.mapStart.x,e=n.mapStart.y,t=n.mapStart.z);const r=n.mapEnd.x-i,s=n.mapEnd.y-e,a=n.mapEnd.z-t;return i=n.mapEnd.x,e=n.mapEnd.y,t=n.mapEnd.z,{...n,mapDeltaX:r,mapDeltaY:s,mapDeltaZ:a,mapDeltaSpatialReference:n.mapStart.spatialReference}}}function KBt(){let i=0,e=0;return t=>{t.action==="start"&&(i=t.screenStart.x,e=t.screenStart.y);const n=t.screenEnd.x-i,r=t.screenEnd.y-e;return i=t.screenEnd.x,e=t.screenEnd.y,{...t,screenDeltaX:n,screenDeltaY:r}}}function YBt(i,e){let t=null,n=0,r=0;return s=>{if(s.action==="start"&&(t=i.toScreen(e),t.x<0||t.x>i.width||t.y<0||t.y>i.height?t=null:(n=s.screenStart.x-t.x,r=s.screenStart.y-t.y)),t==null)return null;const a=lt(s.screenEnd.x-n,0,i.width),o=lt(s.screenEnd.y-r,0,i.height),l=Cs(a,o);return s.screenStart=t,s.screenEnd=l,s}}class AC{constructor(){this.execute=()=>{}}next(e,t=new AC){return T(e)&&(this.execute=n=>{const r=e(n);T(r)&&t.execute(r)}),t}}function uEt(i,e,t=[]){if(i.type==="2d")return r=>r;let n=null;return r=>{r.action==="start"&&(n=i.toMap(r.screenStart,{exclude:t}),T(n)&&(n.z=l5(n,i,e)));const s=i.toMap(r.screenEnd,{exclude:t});T(s)&&(s.z=l5(s,i,e));const a=T(n)&&T(s)?{sceneStart:n,sceneEnd:s}:null;return{...r,scenePoints:a}}}class dEt{constructor(){this.next=new AC}createSnapDragEventPipelineStep({predicate:e=()=>!0,cancel:t,snappingManager:n,snappingContext:r,updatingHandles:s,useZ:a=!0}){if(B(n))return m=>m;let o=null,l=null;const c=()=>{o=ll(o),n.doneSnapping(),T(l)&&l.frameTask.remove(),l=null};t.next(m=>(c(),m)),this.next=new AC;const u=this._createSnapFunction(n,a);let d=null,h=null,p=null;return m=>{if(!e(m))return m;if(m.action==="start"){const g=this._createFrameTask(n.view);if(l=this._createSnappingInfo(r,m,g),l.context.selfSnappingZ=null,!a&&T(m.info)){const _=this._extractSelfSnappingZ(r.coordinateHelper,m.info.handle.component);T(_)&&(l.context.selfSnappingZ={value:_,elevationInfo:r.elevationInfo})}}if(T(l)){const{context:g,originalScenePos:_,originalPos:b}=l,{mapEnd:x,mapStart:w,action:C,scenePoints:S}=m,E=this._updatePosition(b,this._computeMapDelta(x,w)),A=this._computeMapDelta(w,b),P={...m,action:"update"},O=l.context,M=this._updateScenePosition(_,S),V=n.update({point:E,scenePoint:M,context:g});if(p=V,this._applySnappedUpdate(x,V,A,a),d=E,h=M,C!=="end"){const{frameTask:L}=l;B(o)&&(o=new AbortController),s.addPromise(iy(u({frameTask:L,event:P,context:O,point:E,scenePoint:M,delta:A,lastPos:d,lastScenePos:h,lastUpdate:p},o.signal)))}}return m.action==="end"&&c(),m}}_createSnapFunction(e,t){return DL(async({frameTask:n,point:r,scenePoint:s,context:a,event:o,delta:l,lastPos:c,lastScenePos:u,lastUpdate:d},h)=>{const p=await n.schedule(()=>e.snap({point:r,scenePoint:s,context:a,signal:h}),h);if(p.valid){let m=await n.schedule(()=>p.apply(),h);r!==c&&T(c)&&(m=e.update({point:c,scenePoint:u,context:a})),eL(m,d)||(this._applySnappedUpdate(o.mapEnd,m,l,t),this.next.execute(o))}})}_createFrameTask(e){return e.type==="3d"?e.resourceController.scheduler.registerTask($r.SNAPPING):GA}_createSnappingInfo(e,t,n){return{context:new IL({editGeometryOperations:e.editGeometryOperations,elevationInfo:e.elevationInfo,pointer:e.pointer,vertexHandle:T(t.info)?t.info.handle:null,excludeFeature:e.excludeFeature,visualizer:e.visualizer}),originalPos:T(t.snapOrigin)?e.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:T(t.scenePoints)?t.scenePoints.sceneStart:null,frameTask:n}}_updatePosition(e,[t,n,r]){const s=pD(e);return s.x+=t,s.y+=n,s.hasZ&&(s.z+=r),s}_updateScenePosition(e,t){return B(e)||B(t)?null:this._updatePosition(e,this._computeMapDelta(t.sceneEnd,t.sceneStart))}_computeMapDelta(e,t){const n=e.hasZ&&t.hasZ?e.z-t.z:0;return[e.x-t.x,e.y-t.y,n]}_applySnappedUpdate(e,t,[n,r,s],a){e.x=t.x+n,e.y=t.y+r,a&&e.hasZ&&t.hasZ&&(e.z=t.z+s)}_extractSelfSnappingZ(e,t){if(!e.hasZ())return null;const n=t.vertices;let r=null;for(const s of n){const a=e.getZ(s.pos);if(T(r)&&Math.abs(a-r)>1e-6)return null;B(r)&&(r=a)}return r}}let Xr=class extends Pn.EventedMixin(PC){constructor(i){super(i),this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._snappingPipeline=new dEt,this.isDraped=!0,this.labelOptions=new kD,this.tooltipOptions=new FD,this.snapToSceneEnabled=null,this.lastVertex=null,B(i.elevationInfo)&&(this.elevationInfo=yre(i.hasZ))}initialize(){const{geometryType:i,view:e}=this,{spatialReference:t}=e,n="viewingMode"in e.state?e.state.viewingMode:Ot.Local,r=i==="segment"||i==="multipoint"?"polyline":i;this.coordinateHelper=cG(this.hasZ,this.hasM,t),this._editGeometryOperations=new WD(new SM(r,this.coordinateHelper)),this._snappingOperation=new zv({view:e,constrainResult:a=>B(a)?a:this._getEffectiveDrawSurface().constrainZ(a)}),this.handles.add(ue(()=>this.stagedVertex,a=>{B(a)||this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(a)}],operation:"apply",type:"vertex-update"})},{sync:!0,equals:(a,o)=>Eye(a,o,eL)})),this._activeComponent=new Lx(t,n),this._editGeometryOperations.data.components.push(this._activeComponent);const s=this.segmentLabels;T(s)&&(s.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.handles.add([ue(()=>this.labelOptions.enabled,a=>{s.visible=a},hn),this.on("cursor-update",()=>{const a=this.stagedVertex;s.stagedVertex=T(a)?this.coordinateHelper.pointToVector(a):null})])),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],a=>{const o=a.vertices.map(d=>({componentIndex:0,vertexIndex:d.index,coordinates:this.coordinateHelper.vectorToArray(d.pos)})),l=o.map(d=>d.coordinates);switch(a.type){case"vertex-add":this.emit(a.type,{...a,added:l,vertices:o});break;case"vertex-update":this.emit(a.type,{...a,updated:l,vertices:o});break;case"vertex-remove":this.emit(a.type,{...a,removed:l,vertices:o})}const c=this._activeComponent.getLastVertex(),u=T(c)?this.coordinateHelper.vectorToDehydratedPoint(c.pos):null;(B(u)||B(this.lastVertex)||!eL(this.lastVertex,u))&&(this.lastVertex=u)})),this._manipulator=new tEt({grabbableForEvent:a=>this.drawingMode!=="click"||a.pointerType==="touch"&&this._snappingEnabled&&this._pointerDownStates.size===1}),this.manipulators.add(this._manipulator),this._manipulator.grabbable=i!=="point",this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",a=>this._onImmediateClick(a)),this._manipulator.events.on("immediate-double-click",a=>this._onImmediateDoubleClick(a))])}destroy(){_t(this.segmentLabels),_t(this._snappingOperation),this._editGeometryOperations=_t(this._editGeometryOperations)}get _snappingEnabled(){return T(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const i=this._getEffectiveDrawSurface();return this.view.type==="3d"&&this.drawSurface!==i}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(i=>this.coordinateHelper.vectorToArray(i.pos))}set drawingMode(i){this._set("drawingMode",i??jD)}get interactive(){return this._manipulator.interactive}set interactive(i){this._manipulator.interactive=i}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return T(this.stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get stagedVertex(){return this._snappingOperation.stagedPoint}set stagedVertex(i){this._snappingOperation.stagedPoint=ko(i)}get updating(){return this.updatingHandles.updating}get vertices(){const i=this.committedVertices;return T(this.stagedVertex)&&i.push(this.coordinateHelper.pointToArray(this.stagedVertex)),i}cancel(){this.complete({aborted:!0})}commitStagedVertex(){if(this._snappingOperation.abort(),T(this.stagedVertex)){const{stagedVertex:i}=this;this.stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(i))}}complete(i){const e=i&&i.aborted||!1;this._snappingOperation.abort(),T(this.snappingManager)&&this.snappingManager.doneSnapping(),this.geometryType==="segment"||this.geometryType==="point"?this.commitStagedVertex():this.stagedVertex=null;const t=this.geometryType==="multipoint"&&this.numVertices===0||this.geometryType==="polyline"&&this.numVertices<2||this.geometryType==="polygon"&&this.numVertices<3;this._createOperationCompleted=!t,(this.isCompleted||e)&&this.emit("complete",{vertices:this.vertices.map((n,r)=>({componentIndex:0,vertexIndex:r,coordinates:n})),aborted:e,type:"complete"})}onInputEvent(i){switch(i.type){case"pointer-down":this._pointerDownStates.add(i.pointerId);break;case"pointer-up":this._pointerDownStates.delete(i.pointerId)}switch(i.type){case"pointer-move":return this._onPointerMove(i);case"hold":return this._onHold(i)}}redo(){this._editGeometryOperations.redo()}undo(){T(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_closeOnClickVertexIndex(i){const e=this._activeComponent;if(this.geometryType==="polygon"&&e.vertices.length>2){if(this._vertexWithinPointerDistance(e.vertices[0].pos,i))return 0;if(this._vertexWithinPointerDistance(e.vertices[e.vertices.length-1].pos,i))return e.vertices.length-1}return null}_createManipulatorDragPipeline(i){switch(kt(this.drawingMode)){case"click":return this._createManipulatorDragPipelineClick(i);case"freehand":return this._createManipulatorDragPipelineFreehand(i);case"hybrid":return this._createManipulatorDragPipelineHybrid(i)}}_createManipulatorDragPipelineClick(i){return AN(i,(e,t,n,r)=>{const s=r==="touch"&&this._snappingEnabled;!this.isCompleted&&s&&(n=n.next(a=>(s&&T(this.snappingManager)&&this.snappingManager.doneSnapping(),a)),t.next(this._screenToMapDragEventStep()).next(a=>(a.action==="start"&&(this.stagedVertex=a.mapStart,(this.geometryType==="segment"||s&&this.numVertices===0)&&this.commitStagedVertex()),a)).next(uEt(this.view,this.elevationInfo)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>s,cancel:n,snappingManager:this.snappingManager,snappingContext:new IL({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:r,visualizer:this.snappingVisualizer}),updatingHandles:this.updatingHandles,useZ:!this._requiresScenePoint}),this._snappingPipeline.next).next(a=>(s&&(this.stagedVertex=a.mapEnd,a.action==="end"&&this.commitStagedVertex()),a)).next(a=>(a.action==="end"&&(this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()),a)))})}_createManipulatorDragPipelineFreehand(i){return AN(i,(e,t)=>{this.isCompleted||t.next(this._screenToMapDragEventStep()).next(n=>(n.action==="start"&&(B(this.stagedVertex)&&(this.stagedVertex=n.mapStart),this.geometryType==="segment"&&this.commitStagedVertex()),n)).next(n=>{switch(n.action){case"start":case"update":this.stagedVertex=n.mapEnd,this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.complete()}return n})})}_createManipulatorDragPipelineHybrid(i){return AN(i,(e,t)=>{this.isCompleted||t.next(this._screenToMapDragEventStep()).next(n=>(n.action==="start"&&(B(this.stagedVertex)&&(this.stagedVertex=n.mapStart),this.commitStagedVertex()),n)).next(n=>{switch(n.action){case"start":case"update":this.stagedVertex=n.mapEnd,this.geometryType!=="polygon"&&this.geometryType!=="polyline"||this.commitStagedVertex();break;case"end":this.geometryType!=="segment"&&this.geometryType!=="point"||this.complete()}return n})})}get _drawAtFixedElevation(){return(this.geometryType==="segment"||this.geometryType==="polygon")&&this.numCommittedVertices>0}_getEffectiveDrawSurface(){if(B(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ())return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let i=this.defaultZ,e=!1;return T(this.elevationInfo)&&this.elevationInfo.mode==="absolute-height"&&(e=!0),T(this.snapToSceneEnabled)&&(e=this.snapToSceneEnabled),T(this.elevationInfo)&&this.elevationInfo.mode==="on-the-ground"&&(e=!1),this._drawAtFixedElevation&&(i=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),e=!1),e?this.drawSurface:(this.elevationDrawSurface.defaultZ=i,this.elevationDrawSurface)}_mapToScreen(i){return this._getEffectiveDrawSurface().mapToScreen(i)}_onHold(i){this._snappingOperation.abort(),this.drawingMode==="click"&&i.pointerType==="touch"&&this._snappingEnabled&&(this.stagedVertex=i.mapPoint),i.stopPropagation()}_onImmediateClick(i){if(i.pointerType==="mouse"&&i.button===2||this._manipulator.dragging)return;const e=this._activeComponent,t=this._closeOnClickVertexIndex(i.screenPoint);if(T(t))return i.stopPropagation(),void this.complete();const n=this._screenToMap(i.screenPoint);if(T(n))switch(this.drawingMode){case"freehand":this.geometryType==="point"&&(T(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(n)),this.complete());break;case"click":case"hybrid":this._snappingOperation.abort(),T(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(n)),(this.geometryType==="point"||this.geometryType==="segment"&&e.vertices.length===2||this.geometryType==="segment"&&this.drawingMode==="hybrid"&&e.vertices.length===1)&&this.complete()}i.stopPropagation()}_onImmediateDoubleClick(i){this._manipulator.dragging||this.geometryType==="point"||(this.complete(),i.stopPropagation())}_onPointerMove(i){const e=Cs(i.x,i.y),t=this._snappingOperation;if(this._manipulator.dragging||this._pointerDownStates.has(i.pointerId)||this._manipulator.grabbing||!this._manipulator.interactive)return void t.abort();i.stopPropagation();const n=this._closeOnClickVertexIndex(e);if(T(n))return this._closeOnVertex(n),void t.abort();const r=this._screenToMap(e),s=this._requiresScenePoint?this.drawSurface.screenToMap(e):null;if(this._manipulator.cursor=T(r)?"crosshair":null,B(r))return void t.abort();const a=this.snappingManager;if(B(a))return this.stagedVertex=r,void t.abort();const o=this._drawAtFixedElevation?Qa(this.elevationDrawSurface,({defaultZ:c})=>c):null,l=new IL({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:i.pointerType,visualizer:this.snappingVisualizer,selfSnappingZ:T(o)?{value:o,elevationInfo:this.elevationInfo}:null});this.updatingHandles.addPromise(iy(t.snap({point:r,scenePoint:s},a,l)))}_closeOnVertex(i){this.stagedVertex=null;const e={componentIndex:0,vertexIndex:i,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[i].pos)};this.emit("cursor-update",{updated:null,vertices:[e],operation:"apply",type:"vertex-update"})}_screenToMap(i){return this._getEffectiveDrawSurface().screenToMap(i)}_screenToMapDragEventStep(){let i=null;return e=>{if(e.action==="start"&&(i=this._screenToMap(e.screenStart)),B(i))return null;const t=this._screenToMap(e.screenEnd);return T(t)?{...e,mapStart:i,mapEnd:t}:null}}_vertexWithinPointerDistance(i,e){const n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(i));return!!T(n)&&hEt(n,e,25)}};function hEt(i,e,t){const n=i.x-e.x,r=i.y-e.y;return n*n+r*r<=t}f([y()],Xr.prototype,"_snappingEnabled",null),f([y()],Xr.prototype,"defaultZ",void 0),f([y()],Xr.prototype,"isDraped",void 0),f([y({value:jD})],Xr.prototype,"drawingMode",null),f([y({constructOnly:!0})],Xr.prototype,"elevationDrawSurface",void 0),f([y({constructOnly:!0})],Xr.prototype,"elevationInfo",void 0),f([y({constructOnly:!0,type:kD})],Xr.prototype,"labelOptions",void 0),f([y({constructOnly:!0,type:FD})],Xr.prototype,"tooltipOptions",void 0),f([y({constructOnly:!0})],Xr.prototype,"geometryType",void 0),f([y({constructOnly:!0})],Xr.prototype,"hasM",void 0),f([y({constructOnly:!0})],Xr.prototype,"hasZ",void 0),f([y({constructOnly:!0})],Xr.prototype,"manipulators",void 0),f([y({constructOnly:!0})],Xr.prototype,"drawSurface",void 0),f([y({constructOnly:!0})],Xr.prototype,"segmentLabels",void 0),f([y({constructOnly:!0})],Xr.prototype,"snappingManager",void 0),f([y({constructOnly:!0})],Xr.prototype,"snappingVisualizer",void 0),f([y()],Xr.prototype,"snapToSceneEnabled",void 0),f([y()],Xr.prototype,"_snappingOperation",void 0),f([y()],Xr.prototype,"stagedVertex",null),f([y()],Xr.prototype,"lastVertex",void 0),f([y()],Xr.prototype,"updating",null),f([y({constructOnly:!0})],Xr.prototype,"view",void 0),Xr=f([ge("esri.views.draw.DrawOperation")],Xr);class pEt{constructor(e,t,n,r=null){this._elevationInfo=e,this.defaultZ=t,this._view=n,this._excludeGraphics=r}screenToMap(e){if(T(this.defaultZ))return this._view.sceneIntersectionHelper.intersectElevationFromScreen(Fn(e.x,e.y),this._elevationInfo,this.defaultZ,this._excludeGraphics);const t=this._view.sceneIntersectionHelper.intersectElevationFromScreen(Fn(e.x,e.y),this._elevationInfo,0,this._excludeGraphics);return T(t)&&(t.z=void 0),t}mapToScreen(e){const t=Id(e.x,e.y,mz(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(t)}constrainZ(e){const{defaultZ:t}=this;return T(t)&&e.z!==t&&((e=pD(e)).z=t),e}}class fEt{constructor(e,t,n=[]){this.view=e,this.elevationInfo=t,this.exclude=n}screenToMap(e){const t=this.view.toMap(e,{exclude:this.exclude});return T(t)&&(t.z=l5(t,this.view,this.elevationInfo)),t}mapToScreen(e){let t=e;return T(this.elevationInfo)&&(t=Id(e.x,e.y,mz(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}constrainZ(e){return e}}class XBt{constructor(e,t=!1,n=0){this.view=e,this.hasZ=t,this.defaultZ=n,this.mapToScreen=r=>e.toScreen(r),this.screenToMap=t?r=>{const s=e.toMap(r);return s.z=n,s}:r=>e.toMap(r)}constrainZ(e){const{defaultZ:t}=this;return this.hasZ&&e.z!==t&&((e=pD(e)).z=t),e}}var g0;(function(i){i[i.WhenToolEditable=0]="WhenToolEditable",i[i.WhenToolNotEditable=1]="WhenToolNotEditable",i[i.Always=2]="Always"})(g0||(g0={}));class mEt{constructor(){this._isToolEditable=!0,this._manipulators=new _i,this._resourceContexts={manipulator3D:{}},this._attached=!1}set isToolEditable(e){this._isToolEditable=e}get length(){return this._manipulators.length}add(e,t=g0.WhenToolEditable){this.addMany([e],t)}addMany(e,t=g0.WhenToolEditable){for(const n of e){const r={manipulator:n,visibilityPredicate:t,attached:!1};this._manipulators.add(r),this._attached&&this._updateManipulatorAttachment(r)}}remove(e){for(let t=0;t<this._manipulators.length;t++)if(this._manipulators.getItemAt(t).manipulator===e){const n=this._manipulators.splice(t,1)[0];this._detachManipulator(n);break}}removeAll(){this._manipulators.forEach(e=>{this._detachManipulator(e)}),this._manipulators.removeAll()}attach(){this._manipulators.forEach(e=>{this._updateManipulatorAttachment(e)}),this._attached=!0}detach(){this._manipulators.forEach(e=>{this._detachManipulator(e)}),this._attached=!1}destroy(){this.detach(),this._manipulators.forEach(({manipulator:e})=>{e.destroy&&e.destroy()}),this._manipulators.destroy(),this._resourceContexts=null}on(e,t){return this._manipulators.on(e,n=>{t(n)})}forEach(e){for(const t of this._manipulators.items)e(t)}some(e){return this._manipulators.items.some(e)}toArray(){const e=[];return this.forEach(t=>e.push(t.manipulator)),e}intersect(e,t){let n=null,r=Number.MAX_VALUE;return this._manipulators.forEach(({manipulator:s,attached:a})=>{if(!a||!s.interactive)return;const o=s.intersectionDistance(e,t);T(o)&&o<r&&(r=o,n=s)}),n}_updateManipulatorAttachment(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}_attachManipulator(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}_detachManipulator(e){if(!e.attached)return;const t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}_isManipulatorItemVisible(e){return e.visibilityPredicate===g0.Always||(this._isToolEditable?e.visibilityPredicate===g0.WhenToolEditable:e.visibilityPredicate===g0.WhenToolNotEditable)}}let _o=class extends et{constructor(e){super(e),this.manipulators=new mEt,this.automaticManipulatorSelection=!0,this.hasGrabbedManipulators=!1,this.hasHoveredManipulators=!1,this.firstGrabbedManipulator=null,this.created=!1,this.removeIncompleteOnCancel=!0,this._editableFlags=new Map([[ad.MANAGER,!0],[ad.USER,!0]]),this._creationFinishedResolver=_b()}get active(){return this.view!=null&&this.view.activeTool===this}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this._syncVisible())}get editable(){return this.getEditableFlag(ad.USER)}set editable(e){this.setEditableFlag(ad.USER,e)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy(),this._set("view",null)}onAdd(){this._syncVisible()}activate(){B(this.view)?tt.getLogger(this.declaredClass).error("Can't activate tool if view is not defined."):(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(e){this.onInputEvent(e)}handleInputEventAfter(e){this.onInputEventAfter(e)}setEditableFlag(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),e===ad.USER&&this.notifyChange("editable"),this.onEditableChange(),this.onManipulatorSelectionChanged()}getEditableFlag(e){return this._editableFlags.get(e)}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(e){}onInputEventAfter(e){}get internallyEditable(){return this.getEditableFlag(ad.USER)&&this.getEditableFlag(ad.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this),this._set("created",!0)}_syncVisible(){if(this.initialized){if(this.visible)this._show();else if(this._hide(),this.active)return void(this.view.activeTool=null)}}_show(){this._updateManipulatorAttachment(),this.onShow()}_hide(){this._updateManipulatorAttachment(),this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};f([y({constructOnly:!0})],_o.prototype,"view",void 0),f([y({readOnly:!0})],_o.prototype,"active",null),f([y({value:!0})],_o.prototype,"visible",null),f([y({value:!0})],_o.prototype,"editable",null),f([y({readOnly:!0})],_o.prototype,"manipulators",void 0),f([y({readOnly:!0})],_o.prototype,"updating",null),f([y()],_o.prototype,"cursor",null),f([y({readOnly:!0})],_o.prototype,"automaticManipulatorSelection",void 0),f([y()],_o.prototype,"hasFocusedManipulators",null),f([y()],_o.prototype,"hasGrabbedManipulators",void 0),f([y()],_o.prototype,"hasHoveredManipulators",void 0),f([y()],_o.prototype,"firstGrabbedManipulator",void 0),f([y({readOnly:!0})],_o.prototype,"created",void 0),f([y({readOnly:!0})],_o.prototype,"removeIncompleteOnCancel",void 0),_o=f([ge("esri.views.interactive.InteractiveToolBase")],_o);let To=class extends Ba(Pn.EventedMixin(_o)){constructor(i){super(i),this.defaultZ=0,this.elevationInfo=null,this.hasZ=!0,this.mode=null,this.snapToScene=null,this.type="draw-3d"}initialize(){const i=this.view,e=yre(this.hasZ,this.elevationInfo);this.drawOperation=new Xr({view:i,manipulators:this.manipulators,geometryType:this.geometryType,drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:i.type==="3d"?new fEt(i,e):null,elevationDrawSurface:i.type==="3d"?new pEt(e,this.defaultZ,i):null,hasM:!1,elevationInfo:e}),this.handles.add([this.drawOperation.on("vertex-add",t=>this.onVertexAdd(t)),this.drawOperation.on("vertex-remove",t=>this.onVertexRemove(t)),this.drawOperation.on("vertex-update",t=>this.onVertexUpdate(t)),this.drawOperation.on("cursor-update",t=>this.onCursorUpdate(t)),this.drawOperation.on("complete",t=>this.onComplete(t))]),this.finishToolCreation()}destroy(){this.drawOperation=_t(this.drawOperation),this._set("view",null)}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set enabled(i){this.drawOperation.interactive=i,this._set("enabled",i)}get updating(){var i;return((i=this.drawOperation)==null?void 0:i.updating)??!1}completeCreateOperation(){this.drawOperation.complete()}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}getVertexCoords(){return this.drawOperation.vertices}onInputEvent(i){this.drawOperation.onInputEvent(i)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}onComplete(i){this.emit("complete",i)}onCursorUpdate(i){this.emit("cursor-update",i)}onVertexAdd(i){this.emit("vertex-add",i)}onVertexRemove(i){this.emit("vertex-remove",i)}onVertexUpdate(i){this.emit("vertex-update",i)}};f([y({constructOnly:!0,nonNullable:!0})],To.prototype,"defaultZ",void 0),f([y()],To.prototype,"drawOperation",void 0),f([y({constructOnly:!0})],To.prototype,"elevationInfo",void 0),f([y({value:!0})],To.prototype,"enabled",null),f([y({constructOnly:!0})],To.prototype,"geometryType",void 0),f([y({constructOnly:!0})],To.prototype,"hasZ",void 0),f([y({constructOnly:!0})],To.prototype,"mode",void 0),f([y()],To.prototype,"snapToScene",void 0),f([y({readOnly:!0})],To.prototype,"type",void 0),f([y({readOnly:!0})],To.prototype,"updating",null),f([y({constructOnly:!0,nonNullable:!0})],To.prototype,"view",void 0),To=f([ge("esri.views.draw.DrawTool")],To);let rB=class extends EM{constructor(i){super(i),this._addVertexOnPointerUp=!1}initialize(){this.view.type==="2d"?this._addViewHandles():this._addDrawTool()}destroy(){this.view.type==="2d"?this._removeViewHandles():this._removeDrawTool(),this.emit("destroy")}complete(){this.view.type==="2d"?this._cursorScreenPoint&&this._completeDrawing():this._drawTool.completeCreateOperation()}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("pointer-down",i=>{this._shouldHandlePointerEvent(i)&&(this._abortSnapping(),this._activePointerId=i.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=Cr(i),i.pointerType==="touch"&&this._updateCursor(i.native))},Pt.TOOL),this.view.on("pointer-move",i=>{this._abortSnapping(),this._cursorScreenPoint=Cr(i),i.pointerType!=="touch"&&this._updateCursor(i.native)},Pt.TOOL),this.view.on("pointer-drag",i=>{this._shouldHandlePointerEvent(i)&&(this._abortSnapping(),this._addVertexOnPointerUp=!1)},Pt.TOOL),this.view.on("pointer-up",i=>{if(this._shouldHandlePointerEvent(i))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp)i.stopPropagation(),this._vertexAddHandler(i);else{const e=i.pointerType==="touch";this._updateCursor(i.native,e)}},Pt.TOOL),this.view.on("drag",["Shift"],i=>{i.stopPropagation()},Pt.TOOL),this.view.on("key-down",i=>{i.key===fi.complete&&this._cursorScreenPoint&&(this._abortSnapping(),this._vertexAddHandler(i))},Pt.TOOL)],this._viewHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_addDrawTool(){this._drawTool=new To({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"point",mode:"click"}),this.view.addAndActivateTool(this._drawTool),this._handles.add([this._drawTool.on("cursor-update",i=>{i.vertices.length===1&&this.emit("cursor-update",new ag(this.view,null,i.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",i=>{this.emit("draw-complete",new og(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})],this._drawToolHandlesKey)}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=_t(this._drawTool)}_addVertex(i){const e=this._coordinateHelper.arrayToVector(i);this._isDuplicateOfLastVertex(e)||(this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(e),this.notifyChange("vertices"),this._completeDrawing())}_updateCursor(i,e=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const t=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);T(t)&&!e&&this._pushCursorVertex(t.vertex,()=>this.emit("cursor-update",new ag(this.view,i,this._activeComponent.vertices.length,this.vertices,T(this._stagedVertex)?new Wt(this._stagedVertex):null)))}_completeDrawing(i){this._activePointerId=null,this._popCursorVertex(),this._abortSnapping(),T(this._snappingManager)&&this._snappingManager.doneSnapping();const e=new og(i,this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this._removeViewHandles()}};rB=f([ge("esri.views.draw.PointDrawAction")],rB);let Aw=class extends EM{constructor(e){super(e),this._panEnabled=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this.mode=jD}initialize(){this.view.type==="2d"?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool()}destroy(){this.view.type==="2d"?(this._removeViewHandles(),this._removeUndoRedoHandles()):this._removeDrawTool(),this.emit("destroy")}get _dragEnabled(){return this.mode==="freehand"||this.mode==="hybrid"}get _clickEnabled(){return this.mode==="click"||this.mode==="hybrid"}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}complete(){this.view.type==="2d"?this._completeDrawing():this._drawTool.completeCreateOperation()}_getGeometryZValue(){return this.hasZ&&this.vertices.length>0?this.vertices[0][2]:this.defaultZ}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("click",e=>{e.stopPropagation()},Pt.TOOL),this.view.on("pointer-down",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._activePointerId=e.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=Cr(e),e.pointerType==="touch"&&this._updateCursor(e.native))},Pt.TOOL),this.view.on("pointer-move",e=>{this._abortSnapping(),this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._cursorScreenPoint=Cr(e),e.pointerType!=="touch"&&this._updateCursor(e.native)},Pt.TOOL),this.view.on("pointer-drag",e=>{this._shouldHandlePointerEvent(e)&&(this._abortSnapping(),this._cursorScreenPoint=Cr(e),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(e):this._addVertexOnPointerUp=!1)},Pt.TOOL),this.view.on("pointer-up",e=>{if(this._shouldHandlePointerEvent(e))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return this.vertices.length===1&&this.vertices.pop(),void this._drawCompleteHandler(e);this._vertexAddHandler(e)}else{const t=e.pointerType==="touch";this._updateCursor(e.native,t)}},Pt.TOOL),this.view.on("drag",e=>{this._dragEnabled&&T(this._activePointerId)&&!this._panEnabled&&e.stopPropagation()},Pt.TOOL),this.view.on("drag",["Shift"],e=>{e.stopPropagation()},Pt.TOOL),this.view.on("double-click",e=>{e.stopPropagation(),this._drawCompleteHandler(e)},Pt.TOOL),this.view.on("double-click",["Control"],e=>{e.stopPropagation(),this._drawCompleteHandler(e)},Pt.TOOL),this.view.on("key-down",e=>{const{key:t,repeat:n}=e;t===fi.vertexAdd&&!n&&this._cursorScreenPoint?(e.stopPropagation(),this._abortSnapping(),this._vertexAddHandler(e)):t!==fi.complete||n?t!==fi.undo||this.interactiveUndoDisabled||n?t!==fi.redo||this.interactiveUndoDisabled||n?t!==fi.pan||n||(e.stopPropagation(),this._panEnabled=!0):(e.stopPropagation(),this.redo()):(e.stopPropagation(),this.undo()):(e.stopPropagation(),this._drawCompleteHandler(e))},Pt.TOOL),this.view.on("key-up",e=>{e.key===fi.pan&&(e.stopPropagation(),this._panEnabled=!1)},Pt.TOOL)],this._viewHandlesKey)}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._handles.add([this._editGeometryOperations.on("vertex-remove",e=>{if(this.notifyChange("vertices"),e.operation==="undo"){const t=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(t);const n=[...this._committedVertices];T(this._stagedVertex)&&n.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new uG(this.view,t,e.vertices[0].index,n))}}),this._editGeometryOperations.on("vertex-add",e=>{if(this.notifyChange("vertices"),e.operation==="apply"){const t=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],n=this._committedVertices.length-1,r=new ef(this.view,t,n,this.vertices);this.emit("vertex-add",r),r.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if(e.operation==="redo"){const t=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(t);const n=[...this._committedVertices];T(this._stagedVertex)&&n.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new ef(this.view,t,e.vertices[0].index,n))}})],this._undoRedoHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_removeUndoRedoHandles(){this._handles.remove(this._undoRedoHandlesKey)}_addDrawTool(){this._drawTool=new To({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polygon",mode:this.mode}),this.view.addAndActivateTool(this._drawTool),this._drawTool.on("vertex-add",e=>{e.vertices.length===1&&this.emit("vertex-add",new ef(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("cursor-update",e=>{e.vertices.length===1&&this.emit("cursor-update",new ag(this.view,null,e.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",e=>{this.emit("draw-complete",new og(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=_t(this._drawTool)}_addVertex(e,t){const n=this._coordinateHelper.arrayToVector(e);if(this._isDuplicateOfLastVertex(n))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(n);const r=t||new Event("placeholder");this._nativeEventHistory.undoStack.push(r)}_updateCursor(e,t=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const n=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);T(n)&&!t&&this._pushCursorVertex(n.vertex,()=>this.emit("cursor-update",new ag(this.view,e,this._activeComponent.vertices.length,this.vertices,T(this._stagedVertex)?new Wt(this._stagedVertex):null)))}_completeDrawing(e){if(this._activePointerId=null,this._popCursorVertex(),this._committedVertices.length<3)return;this._abortSnapping(),T(this._snappingManager)&&this._snappingManager.doneSnapping();const t=new og(e,this.vertices);this.emit("draw-complete",t),t.defaultPrevented||this._removeViewHandles()}};f([y()],Aw.prototype,"_dragEnabled",null),f([y()],Aw.prototype,"_clickEnabled",null),f([y({type:Xve})],Aw.prototype,"mode",void 0),Aw=f([ge("esri.views.draw.PolygonDrawAction")],Aw);let Mw=class extends EM{constructor(i){super(i),this._panEnabled=!1,this._popVertexOnPointerMove=!1,this._addVertexOnPointerUp=!1,this.mode=jD}initialize(){this.view.type==="2d"?(this._addViewHandles(),this._addUndoRedoHandles()):this._addDrawTool()}destroy(){this.view.type==="2d"?(this._removeViewHandles(),this._removeUndoRedoHandles()):this._removeDrawTool(),this.emit("destroy")}get _clickEnabled(){return this.mode==="click"||this.mode==="hybrid"}get _dragEnabled(){return this.mode==="freehand"||this.mode==="hybrid"}undo(){super.undo(),this.notifyChange("vertices")}redo(){super.redo(),this.notifyChange("vertices")}complete(){this.view.type==="2d"?this._completeDrawing():this._drawTool.completeCreateOperation()}_addViewHandles(){this._removeViewHandles(),this._handles.add([this.view.on("click",i=>{i.stopPropagation()},Pt.TOOL),this.view.on("pointer-down",i=>{this._shouldHandlePointerEvent(i)&&!this._panEnabled&&(this._abortSnapping(),this._activePointerId=i.pointerId,this._addVertexOnPointerUp=!0,this._cursorScreenPoint=Cr(i),i.pointerType==="touch"&&this._updateCursor(i.native))},Pt.TOOL),this.view.on("pointer-move",i=>{this._popVertexOnPointerMove&&(this.undo(),this._popVertexOnPointerMove=!1),this._abortSnapping(),this._cursorScreenPoint=Cr(i),i.pointerType!=="touch"&&this._updateCursor(i.native)},Pt.TOOL),this.view.on("pointer-drag",i=>{this._shouldHandlePointerEvent(i)&&(this._abortSnapping(),this._cursorScreenPoint=Cr(i),this._dragEnabled&&!this._panEnabled?this._vertexAddHandler(i):this._addVertexOnPointerUp=!1)},Pt.TOOL),this.view.on("pointer-up",i=>{if(this._shouldHandlePointerEvent(i))if(this._abortSnapping(),this._activePointerId=null,this._addVertexOnPointerUp){if(!this._clickEnabled)return this.vertices.length===1&&this.vertices.pop(),void this._drawCompleteHandler(i);this._vertexAddHandler(i)}else{const e=i.pointerType==="touch";this._updateCursor(i.native,e)}},Pt.TOOL),this.view.on("drag",i=>{this._dragEnabled&&T(this._activePointerId)&&!this._panEnabled&&i.stopPropagation()},Pt.TOOL),this.view.on("drag",["Shift"],i=>{i.stopPropagation()},Pt.TOOL),this.view.on("double-click",i=>{i.stopPropagation(),this._drawCompleteHandler(i)},Pt.TOOL),this.view.on("double-click",["Control"],i=>{i.stopPropagation(),this._drawCompleteHandler(i)},Pt.TOOL),this.view.on("key-down",i=>{const{key:e,repeat:t}=i;e===fi.vertexAdd&&!t&&this._cursorScreenPoint?(i.stopPropagation(),this._abortSnapping(),this._vertexAddHandler(i)):e!==fi.complete||t?e!==fi.undo||this.interactiveUndoDisabled||t?e!==fi.redo||this.interactiveUndoDisabled||t?e!==fi.pan||t||(i.stopPropagation(),this._panEnabled=!0):(i.stopPropagation(),this.redo()):(i.stopPropagation(),this.undo()):(i.stopPropagation(),this._drawCompleteHandler(i))},Pt.TOOL),this.view.on("key-up",i=>{i.key===fi.pan&&(i.stopPropagation(),this._panEnabled=!1)},Pt.TOOL)],this._viewHandlesKey)}_addUndoRedoHandles(){this._removeUndoRedoHandles(),this._handles.add([this._editGeometryOperations.on("vertex-remove",i=>{if(this.notifyChange("vertices"),i.operation==="undo"){const e=this._nativeEventHistory.undoStack.pop();this._nativeEventHistory.redoStack.push(e);const t=[...this._committedVertices];T(this._stagedVertex)&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("undo",new uG(this.view,e,i.vertices[0].index,t))}}),this._editGeometryOperations.on("vertex-add",i=>{if(this.notifyChange("vertices"),i.operation==="apply"){const e=this._nativeEventHistory.undoStack[this._nativeEventHistory.undoStack.length],t=this._committedVertices.length-1,n=new ef(this.view,e,t,this.vertices);this.emit("vertex-add",n),n.defaultPrevented&&(this._popVertexOnPointerMove=!0)}else if(i.operation==="redo"){const e=this._nativeEventHistory.redoStack.pop();this._nativeEventHistory.undoStack.push(e);const t=[...this._committedVertices];T(this._stagedVertex)&&t.push(this._coordinateHelper.pointToArray(this._stagedVertex)),this.emit("redo",new ef(this.view,e,i.vertices[0].index,t))}})],this._undoRedoHandlesKey)}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_removeUndoRedoHandles(){this._handles.remove(this._undoRedoHandlesKey)}_addDrawTool(){this._drawTool=new To({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"polyline",mode:this.mode}),this.view.addAndActivateTool(this._drawTool),this._handles.add([this._drawTool.on("vertex-add",i=>{i.vertices.length===1&&this.emit("vertex-add",new ef(this.view,null,i.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("cursor-update",i=>{i.vertices.length===1&&this.emit("cursor-update",new ag(this.view,null,i.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",i=>{this.emit("draw-complete",new og(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})],this._drawToolHandlesKey)}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=_t(this._drawTool)}_addVertex(i,e){const t=this._coordinateHelper.arrayToVector(i);if(this._isDuplicateOfLastVertex(t))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(t);const n=e||new Event("placeholder");this._nativeEventHistory.undoStack.push(n)}_updateCursor(i,e=!1){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const t=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);T(t)&&!e&&this._pushCursorVertex(t.vertex,()=>this.emit("cursor-update",new ag(this.view,i,this._activeComponent.vertices.length,this.vertices,T(this._stagedVertex)?new Wt(this._stagedVertex):null)))}_completeDrawing(i){if(this._activePointerId=null,this._popCursorVertex(),this._committedVertices.length<2)return;this._abortSnapping(),T(this._snappingManager)&&this._snappingManager.doneSnapping();const e=new og(i,this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this._removeViewHandles()}};f([y()],Mw.prototype,"_clickEnabled",null),f([y()],Mw.prototype,"_dragEnabled",null),f([y({type:Xve})],Mw.prototype,"mode",void 0),Mw=f([ge("esri.views.draw.PolylineDrawAction")],Mw);function $L(i,e,t=null){return T(t)?[i,e,t]:[i,e]}function Qve(i,e,t=null){return T(t)?{x:i,y:e,z:t}:{x:i,y:e}}class Jve{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return Aye(e.map(t=>this.mapToLocal(t)))}get doUnnormalization(){return!1}}class gEt extends Jve{constructor(e,t,n=null){super(t),this._defaultZ=n,this.transform=Kp(),this.transformInv=Kp(),this.transform=mde(e),yB(this.transformInv,this.transform)}makeMapPoint(e,t){return $L(e,t,this._defaultZ)}mapToLocal(e){return Qve(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}localToMap(e){return $L(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this._defaultZ)}}class vEt extends Jve{constructor(e,t){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=q(),this.tangentFrameUpWS=q(),this.tangentFrameRightWS=q(),this.tangentFrameForwardWS=q(),this.localFrameRightWS=q(),this.localFrameUpWS=q(),this.worldToLocalTransform=n5(),this.localToWorldTransform=n5(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=t,this.defaultZ=t.hasZ?t.z:null;const n=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,dh.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,dh.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,dh.Z,this.tangentFrameForwardWS);const r=q();Ye(r,this.tangentFrameForwardWS,dt(n,this.tangentFrameForwardWS)),nt(this.localFrameRightWS,n,r),mt(this.localFrameRightWS,this.localFrameRightWS),vi(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),I1e(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),$1e(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return this.view.viewingMode==="global"}makeMapPoint(e,t){return $L(e,t,this.defaultZ)}mapToLocal(e){const t=q();this.view.renderCoordsHelper.toRenderCoords(new Wt({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),HN(t,t,this.worldToLocalTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return T(n)?Qve(n.x/this.scale,n.y/this.scale):null}localToMap(e){const t=q();this.view.renderCoordsHelper.toRenderCoords(new Wt({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),HN(t,t,this.localToWorldTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return T(n)?$L(n.x,n.y,this.defaultZ):null}}function yEt(i,e){if(i.type==="2d")return new gEt(i.state.transform,i.spatialReference,e.length>2?e[2]:null);if(i.type==="3d"){const t=e.length>2?new Wt({x:e[0],y:e[1],z:e[2],spatialReference:i.spatialReference}):new Wt({x:e[0],y:e[1],spatialReference:i.spatialReference});return new vEt(i,t)}return null}const _Et=["freehand","click"];let FI=class extends EM{constructor(i){super(i),this._isDragging=!1,this._panEnabled=!1,this._addVertexOnPointerUp=!1,this.viewAlignedCoordinateSystem=null,this.mode="freehand"}initialize(){this.view.type==="2d"?this._addViewHandles():this._addDrawTool()}destroy(){this.view.type==="2d"?this._removeViewHandles():this._removeDrawTool(),this.emit("destroy")}complete(){this.view.type==="2d"?this._completeDrawing():this._drawTool.completeCreateOperation()}_getGeometryZValue(){return this.hasZ&&this.vertices.length>0?this.vertices[0][2]:this.defaultZ}_addViewHandles(){this._removeViewHandles(),this.mode==="click"?this._handles.add(this._getClickModeViewHandles(),this._viewHandlesKey):this._handles.add(this._getDragModeViewHandles(),this._viewHandlesKey)}_getDragModeViewHandles(){return[this.view.on("immediate-click",i=>{if(i.stopPropagation(),i.mapPoint&&!this._panEnabled){const e=this.getCoordsFromScreenPoint(Cr(i));T(e)&&(this._vertexAddHandler(i),this._drawCompleteHandler(i))}},Pt.TOOL),this.view.on("pointer-down",i=>{this._shouldHandlePointerEvent(i)&&(this._abortSnapping(),this._panEnabled||(this._resetGeometry(),this._addVertexOnPointerUp=!0,this._cursorScreenPoint=Cr(i),this._activePointerId=i.pointerId,this._vertexAddHandler(i),this._isDragging=!1,i.pointerType==="touch"&&this._updateCursor(i.native)))},Pt.TOOL),this.view.on("pointer-move",i=>{this._abortSnapping(),B(this._activePointerId)&&i.pointerType!=="touch"&&(this._cursorScreenPoint=Cr(i),this._updateCursor(i.native))},Pt.TOOL),this.view.on("pointer-drag",i=>{this._shouldHandlePointerEvent(i)&&(this._abortSnapping(),this._isDragging=!0,this._cursorScreenPoint=Cr(i),this._updateCursor(i.native))},Pt.TOOL),this.view.on("pointer-up",i=>{this._shouldHandlePointerEvent(i)&&this._addVertexOnPointerUp&&(this._abortSnapping(),this._activePointerId=null,this._isDragging&&this._vertexAddHandler(i),this._committedVertices.length===2&&this._drawCompleteHandler(i),this._isDragging=!1)},Pt.TOOL),this.view.on("key-down",i=>{i.key===fi.complete&&this._cursorScreenPoint?(this._abortSnapping(),this._vertexAddHandler(i),this._drawCompleteHandler(i)):i.key===fi.pan&&(this._panEnabled=!0)},Pt.TOOL),this.view.on("key-up",i=>{i.key===fi.pan&&(this._panEnabled=!1)},Pt.TOOL),this.view.on("drag",i=>{T(this._activePointerId)&&i.stopPropagation()},Pt.TOOL),this.view.on("drag",["Shift"],i=>{i.stopPropagation()},Pt.TOOL)]}_getClickModeViewHandles(){return[this.view.on("pointer-down",i=>{this._abortSnapping(),this._cursorScreenPoint=Cr(i),this._activePointerId=i.pointerId,this._isDragging=!1,i.pointerType==="touch"&&this._updateCursor(i.native)},Pt.TOOL),this.view.on("pointer-move",i=>{this._abortSnapping(),this._cursorScreenPoint=Cr(i),B(this._activePointerId)&&i.pointerType!=="touch"&&this._updateCursor(i.native)},Pt.TOOL),this.view.on("pointer-drag",i=>{this._shouldHandlePointerEvent(i)&&(this._abortSnapping(),this._isDragging=!0)},Pt.TOOL),this.view.on("pointer-up",i=>{this._shouldHandlePointerEvent(i)&&(this._abortSnapping(),this._activePointerId=null,i.stopPropagation(),this._isDragging||this._vertexAddHandler(i),this.vertices.length!==2||this._isDragging||this._drawCompleteHandler(i),this._isDragging=!1)},Pt.TOOL),this.view.on("key-down",i=>{i.key===fi.vertexAdd&&this._cursorScreenPoint&&(this._vertexAddHandler(i),this.vertices.length===2&&this._drawCompleteHandler(i)),i.key===fi.complete&&this._cursorScreenPoint&&this.vertices.length===2&&(this._vertexAddHandler(i),this._drawCompleteHandler(i))},Pt.TOOL)]}_removeViewHandles(){this._handles.remove(this._viewHandlesKey)}_addDrawTool(){this._drawTool=new To({view:this.view,elevationInfo:this.elevationInfo,hasZ:this.hasZ,geometryType:"segment",mode:this.mode}),this.view.addAndActivateTool(this._drawTool),this._handles.add([this._drawTool.on("vertex-add",i=>{i.vertices.length===1&&this.emit("vertex-add",new ef(this.view,null,i.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("cursor-update",i=>{i.vertices.length===1&&this.emit("cursor-update",new ag(this.view,null,i.vertices[0].vertexIndex,this._drawTool.getVertexCoords()))}),this._drawTool.on("complete",i=>{this.emit("draw-complete",new og(null,this._drawTool.getVertexCoords())),this._removeDrawTool()})],this._drawToolHandlesKey)}_removeDrawTool(){this._handles.remove(this._drawToolHandlesKey),this.view.tools.remove(this._drawTool),this._drawTool=_t(this._drawTool)}_addVertex(i,e){const t=this._coordinateHelper.arrayToVector(i);if(this._isDuplicateOfLastVertex(t))return;this._lastVertexUnsnapped=this._stagedVertexUnsnapped,this._popCursorVertex(),this._editGeometryOperations.appendVertex(t),this._committedVertices.length===1&&(this.viewAlignedCoordinateSystem=yEt(this.view,this._committedVertices[0]));const n=this._committedVertices.length-1,r=new ef(this.view,e,n,this.vertices);this.emit("vertex-add",r)}_updateCursor(i){if(this._popCursorVertex(),!this._cursorScreenPoint)return;const e=this.getCoordsAndPointFromScreenPoint(this._cursorScreenPoint);T(e)&&this._pushCursorVertex(e.vertex,()=>this.emit("cursor-update",new ag(this.view,i,this._activeComponent.vertices.length,this.vertices,T(this._stagedVertex)?new Wt(this._stagedVertex):null)))}_completeDrawing(i){if(this._activePointerId=null,this._popCursorVertex(),this._cursorScreenPoint=null,this._isDragging=!1,this._abortSnapping(),T(this._snappingManager)&&this._snappingManager.doneSnapping(),this.vertices.length<1)return;const e=new og(i,this.vertices);this.emit("draw-complete",e),e.defaultPrevented||this._removeViewHandles()}_resetGeometry(){this._editGeometryOperations.destroy(),this._editGeometryOperations=new WD(new SM("polygon",this._coordinateHelper)),this._activeComponent=new Lx(this._coordinateHelper.spatialReference,Ot.Local),this._editGeometryOperations.data.components.push(this._activeComponent)}};f([y({type:_Et})],FI.prototype,"mode",void 0),FI=f([ge("esri/views/2d/engine/markup/SegmentDrawAction")],FI);let Pw=class extends et{constructor(){super(...arguments),this.activeAction=null,this.type="draw",this.view=null}destroy(){this.activeAction&&(this.activeAction.destroy(),this.activeAction=null)}create(i,e){this.reset();const t={view:this.view,...e};switch(i){case"point":t.editGeometryType="point",this.activeAction=new rB(t);break;case"polyline":t.editGeometryType="polyline",this.activeAction=new Mw(t);break;case"multipoint":t.editGeometryType="polygon",this.activeAction=new nB(t);break;case"polygon":t.editGeometryType="polygon",this.activeAction=new Aw(t);break;case"rectangle":case"circle":case"ellipse":case"triangle":t.editGeometryType="polygon",this.activeAction=new FI(t)}return this.activeAction}complete(){this.activeAction&&this.activeAction.complete(),this.activeAction=null}reset(){this.activeAction&&this.activeAction.destroy(),this.activeAction=null}};f([y()],Pw.prototype,"activeAction",void 0),f([y({readOnly:!0})],Pw.prototype,"type",void 0),f([y()],Pw.prototype,"view",void 0),Pw=f([ge("esri.views.draw.Draw")],Pw);const nie=Pw;const eye=(i,e)=>{const t=i.__vccOpts||i;for(const[n,r]of e)t[n]=r;return t},Bh=i=>(pCe("data-v-75b61aea"),i=i(),fCe(),i),bEt=Bh(()=>Q("img",{id:"title",src:UZe},null,-1)),wEt={id:"navigation"},xEt={class:"img"},CEt={t:"1672747217814",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6475",width:"19",height:"19",style:{display:"block",margin:"auto",position:"relative",top:"3px"}},TEt=Bh(()=>Q("path",{d:"M273.0752 1024H204.8v-204.8H0V0h819.2v204.8h204.8v819.2H273.0752zM750.9504 204.8V68.2752H68.2752v682.6752H204.8V204.8h546.1248z",fill:"#000000","p-id":"6476"},null,-1)),SEt=[TEt],EEt=Bh(()=>Q("div",{class:"txt",id:"basemap_txt"},"",-1)),AEt=Bh(()=>Q("div",null,[Q("div",{class:"img"},[Q("svg",{t:"1672747256047",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7481",width:"25",height:"25"},[Q("path",{d:"M512 78.769231l433.230769 315.076923-433.230769 315.076923L78.769231 393.846154 512 78.769231z m352 492.307692L945.230769 630.153846 512 945.230769 78.769231 630.153846l81.230769-59.076923L512 827.076923l352-256z",fill:"#000000","p-id":"7482"})])]),Q("div",{class:"txt",id:"layer_txt"},"")],-1)),MEt=[AEt],PEt=Bh(()=>Q("div",null,[Q("div",{class:"img"},[Q("svg",{t:"1675064009467",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3147",width:"25",height:"25"},[Q("path",{d:"M862.709333 116.042667a32 32 0 1 1 45.248 45.248L455.445333 613.813333a32 32 0 1 1-45.258666-45.258666L862.709333 116.053333zM853.333333 448a32 32 0 0 1 64 0v352c0 64.8-52.533333 117.333333-117.333333 117.333333H224c-64.8 0-117.333333-52.533333-117.333333-117.333333V224c0-64.8 52.533333-117.333333 117.333333-117.333333h341.333333a32 32 0 0 1 0 64H224a53.333333 53.333333 0 0 0-53.333333 53.333333v576a53.333333 53.333333 0 0 0 53.333333 53.333333h576a53.333333 53.333333 0 0 0 53.333333-53.333333V448z",fill:"#000000","p-id":"3148"})])]),Q("div",{class:"txt",id:"editor_txt"},"")],-1)),OEt=[PEt],REt=Bh(()=>Q("div",null,[Q("div",{class:"img"},[Q("svg",{t:"1675085099435",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"3002",width:"23",height:"23"},[Q("path",{d:"M1014.4 971L731.1 687.7c28.4-32.8 51.3-69.6 68.2-109.7C821 526.6 832 472.1 832 416s-11-110.6-32.7-161.9c-21-49.5-50.9-94-89.1-132.2-38.2-38.3-82.7-68.2-132.3-89.2C526.6 11 472.1 0 416 0S305.4 11 254.1 32.7c-49.5 21-94 50.9-132.2 89.1-38.3 38.2-68.2 82.7-89.2 132.3C11 305.4 0 359.9 0 416s11 110.6 32.7 161.9c21 49.5 50.9 94 89.1 132.2 38.2 38.2 82.7 68.2 132.2 89.1C305.4 821 359.9 832 416 832s110.6-11 161.9-32.7c40.5-17.1 77.7-40.4 110.8-69.1L972 1013.4c11.7 11.7 30.8 11.7 42.4 0 11.7-11.7 11.7-30.8 0-42.4zM416 772c-95.1 0-184.5-37-251.7-104.3C97 600.5 60 511.1 60 416s37-184.5 104.3-251.7C231.5 97 320.9 60 416 60s184.5 37 251.7 104.3C735 231.5 772 320.9 772 416s-37 184.5-104.3 251.7C600.5 735 511.1 772 416 772z",fill:"#000000","p-id":"3003"})])]),Q("div",{class:"txt",id:"query_txt"},"")],-1)),IEt=[REt],$Et={id:"query"},LEt=Bh(()=>Q("div",null,[Q("div",{class:"img"},[Q("svg",{t:"1675085997837",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"14050",width:"20",height:"20"},[Q("path",{d:"M594.8 671.7l120.3 46.9-100.7 80.7z",fill:"#000000","p-id":"14051"}),Q("path",{d:"M591.2 859l-36.4-237.2 223.6 87.1L591.2 859z m43.7-137.3l2.8 18 14.2-11.4-17-6.6z",fill:"#000000","p-id":"14052"}),Q("path",{d:"M810.6 934.7c-8.2 0-16.4-3.1-22.6-9.4L606.7 744.1c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L833.2 880c12.5 12.5 12.5 32.8 0 45.3-6.3 6.3-14.4 9.4-22.6 9.4z",fill:"#000000","p-id":"14053"}),Q("path",{d:"M512.3 905.2H285.9L58.7 511.8l227.2-393.4h454.3l227.1 393.4-105.5 182.7c-8.8 15.3-28.4 20.5-43.7 11.7-15.3-8.8-20.5-28.4-11.7-43.7l87-150.7-190.2-329.4H322.8L132.6 511.8l190.2 329.4h189.5c17.7 0 32 14.3 32 32s-14.3 32-32 32z",fill:"#000000","p-id":"14054"})])]),Q("div",{class:"txt",id:"polygon_txt"},"")],-1)),DEt=[LEt],kEt=Bh(()=>Q("div",null,[Q("div",{class:"img"},[Q("svg",{t:"1675087123756",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"15313",width:"20",height:"20"},[Q("path",{d:"M864 896H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h704a32 32 0 0 1 32 32v704a32 32 0 0 1-32 32zM192 832h640V192H192v640z","p-id":"15314",fill:"#000000"})])]),Q("div",{class:"txt",id:"rectangle_txt"},"")],-1)),FEt=[kEt],NEt=Bh(()=>Q("div",null,[Q("div",{class:"img"},[Q("svg",{t:"1675087218193",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2575",width:"20",height:"20"},[Q("path",{d:"M850.538343 895.516744c-11.494799 0-22.988574-4.386914-31.763424-13.161764L141.103692 204.669426c-17.548678-17.534352-17.548678-45.992497 0-63.525825 17.548678-17.548678 45.977147-17.548678 63.525825 0l677.671227 677.685553c17.548678 17.534352 17.548678 45.992497 0 63.525825C873.526917 891.128807 862.032118 895.516744 850.538343 895.516744z",fill:"#000000","p-id":"2576"}),Q("path",{d:"M172.867116 895.516744c-11.494799 0-22.988574-4.386914-31.763424-13.161764-17.548678-17.534352-17.548678-45.992497 0-63.525825l677.671227-677.685553c17.548678-17.548678 45.977147-17.548678 63.525825 0 17.548678 17.534352 17.548678 45.992497 0 63.525825L204.629517 882.354979C195.85569 891.128807 184.360891 895.516744 172.867116 895.516744z",fill:"#000000","p-id":"2577"})])]),Q("div",{class:"txt"},"")],-1)),VEt=[NEt],BEt=Bh(()=>Q("div",null,[Q("div",{class:"img"},[Q("svg",{t:"1675087346310",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4981",width:"20",height:"20"},[Q("path",{d:"M384.119471 821.116243c-11.918447 0-23.837918-4.527107-32.936133-13.573133L77.629032 535.332405c-18.196431-18.107403-18.196431-47.456848 0-65.557088 18.196431-18.107403 47.674812-18.10024 65.871243-0.007163l240.619196 239.436254 495.173776-492.739331c18.196431-18.107403 47.674812-18.107403 65.871243 0 18.196431 18.10024 18.196431 47.449685 0 65.557088L417.055604 807.535947C407.956366 816.589137 396.037918 821.116243 384.119471 821.116243z","p-id":"4982",fill:"#000000"})])]),Q("div",{class:"txt"},"")],-1)),zEt=[BEt],UEt=Bh(()=>Q("div",{id:"view",class:"cc"},null,-1)),HEt={id:"basemapGallery"},GEt=JCe('<div id="compass" data-v-75b61aea></div><div id="zoom" data-v-75b61aea></div><div id="home" data-v-75b61aea></div><div id="legend" data-v-75b61aea></div><div id="scaleBar" data-v-75b61aea></div>',5),WEt={id:"layerList"},jEt={id:"popupTemplate_editor"},qEt={id:"editor"},KEt={__name:"Home",setup(i){ATe(E=>({"7dd2890e":v(t).basemap,f771ab98:v(t).layer,"0e612e2c":v(t).editor,f6d324aa:v(t).query,"79f3fd5d":v(t).polygon,"01b1d8d2":v(t).rectangle}));let e=Ji({basemap:!1,layer:!1,editor:!1,popupTemplate_editor:!1,query:!1}),t=Ji({basemap:"black",layer:"black",editor:"black",query:"black",polygon:"black",rectangle:"black"});function n(){e.basemap==!1?(e.basemap=!0,t.basemap="#0079c1",eu({message:"",type:"success",duration:1200})):(e.basemap=!1,t.basemap="black",eu({message:"",type:"success",duration:1200}))}function r(){e.layer==!1?(e.layer=!0,t.layer="#0079c1",eu({message:"",type:"success",duration:1200})):(e.layer=!1,t.layer="black",eu({message:"",type:"success",duration:1200}))}function s(){e.editor==!1&&e.popupTemplate_editor==!0?eu({message:"",type:"error",duration:1200}):e.editor==!1&&e.popupTemplate_editor==!1?(e.editor=!0,t.editor="#0079c1",eu({message:"",type:"success",duration:1200})):(e.editor=!1,t.editor="black",eu({message:"",type:"success",duration:1200}))}function a(){e.query==!1?(e.query=!0,t.query="#0079c1",eu({message:"",type:"success",duration:1200})):(e.query=!1,t.query="black",eu({message:"",type:"success",duration:1200}))}const o=new Y1t({zoom:11,center:[111.99,37.02]}),l=new due({basemap:"arcgis-topographic"});let c=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_states/FeatureServer/0",outFields:["*"],renderer:{type:"simple",symbol:{type:"picture-marker",url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAAAXNSR0IArs4c6QAAB09JREFUeF7tnVnIdlMUx38fcaEMRVFIyYUhigtDlHm+MI9lnkLIlDlDZCZSZjJkzljmsYgQIhkiLshQUqYiouXbr+/1fN/7nLP22fs8ez/nv27em7XWWfu//mfttYfzvPOQDBqBeYMevQaPCDBwEogAIsDAERj48FUBRICBIzDw4asCiAADR2Dgw1cFEAEGjcBuwCNDRmDIFeA64FjgF2A74PUhEmGIBFgZeB5YcyTh5wIXDI0EQyPAgcAdY5L8KrBjqAqD4MKQCGCJNwK0kV2Ax9so1q4zBAJYqbeSb6XfI9YjHOcxqFF32glgTZ4lMlY+CVPCF7EOSrebZgI8DNgyL4UcDtyawlFpPqaRABsCzwHLJAb7PmC/xD4n7m7aCHA6cHFGVH8IU8JbGZ/Rq+tpIcDSgJX8bZzo3Rb0D3XaGdEuddoUqT4NBNgWeAbc19usnFtZN9kXuNeZoReAvYAfnXZFqddOgIuAM52IvhO2fq2cz5blgWeBDZz+dgaedNoUo14rAVYBHgI2ciJ5CXBGg431EFbiPXIlcIrHoBTdGgmwR0i+B8O/wlv/YkujrUI1WLylvqm9H6aETx02E1etjQDXRuzOPQ3Y1u4fTrSXBB4DdnDaHdxw3uB0l1e9FgKsAzwArO2E42TgKqfNqPpJgJV4j9wJGBH+9hhNQrcGAtgSzbsL9y2wE/BuIlDXD43eSg5/34Qp4TWHTe+qJRNgsZB4e5M8cpfj1M/j13TtzT7AaXQqcIXTpjf1UgmwCXA/sKoTCTvuNQLkFCOAEcEjT4Up4XuPUR+6JRLgxIh5+wNgd+CzPkAD1gg7j+s6nvcnsGdoLB1meVVLIsByoeRbIj1iTZ41e5MQaw6tSfTIZcBpHoOcuqUQwJZati27rHOwuxbwRtkS81Fn3G+HKeFDp11y9RIIYJcxz3OOzDZ09ge+c9rlUl8RuAewDSSPHAHc4jFIrTtJAqwG3AzYYY5HzgbsDKBEOQu40BmYnUgeA/zutEuiPikC7B1O32yp11bs8GYfwE7hSpatwwrGDpfaypfAIcDLbQ1S6U2CANa0WafvEesPDgN+8xhNUHep0NDaMbNH7GQz54WWhWLpkwDrATcCG3sQAU4A7AygRjkeuMYZ+BPA0cDXTrso9b4IYM3OTc4IPwYOAt502pWmbncU7ZuE0S+RxsX5a5gSHsw9mNwEWAK4PpRvz1iMLEd5DCrQtep3pDPOqyP2GVyPyEmAzYAbADvJ84gd/tzuMahI1xq9mXuIbcN+I0wJ77U18OjlIoDdjrncEwhgp2Y2VXzktKtNfa2w/N3UGbgtFa2aJpXUBFghBGl73h6p9kqVZ5AjunZC6N3CvjtUA/ukPYmkJIBdjrSSb/f12srPgJV8u983RLEXxaYEu9beVj4PJLCPXzpLKgLYd/XnOKOxq9z2ydVXTrtpU7cXxraDt3cOLMnvGXQlwOrhrfdu557vHOxQ1C2pHrH7jtYbRH+82oUAW4STuNTf4HkAkC78FC69Rm0jdyXAS8pAEQhsGXuOIAIUkb/OQYgAnSGs24EIUHf+OkcvAnSGsG4HIkDd+esc/cQIYEvBUbHPoeZqLsetc7vsDYzza8ujVyIh3hxY1Bhn3OWK2evXxtj7MtCLqV38bCKA93KoxWAJGrccNWDsDYkR8zuOALFvXi4s3GPssgz0PizXoEUAbyZm6YsA48FTBehArlFTVYAFiOTCwp0uVQBVADdpYg1ysV49QGxGIn5arcOj/v38S6uA+QjmwsKdH00BmgLcpIk1yMV6TQGxGdEU0IicloGNELVXUAXQMlBNYOBArpeh/esYNNUEqgl0kybWIBfr1QTGZkRNYCNyagIbIWqvoAqgJlBNoJrAuSuG3YLRhZD5+MRi0b4eaxXQCiv1AK1gaqekHkA9gHoA9QDqAQyBXNWwXS2epaWdQO0EukkTa5CL9doJjM2IdgIbkdMqoBGi9gqqAFoFaBWgVYBWAVoFzMGB2O1PNYHtp+GFNLUM1DKwA318pmoC1QSqCZzWJnCuY9yZH4uY+dv0ZZCvpizQHsoPRIziGXN8/j+MU/UATRsmsYmV3dwIdPnhi/+8igD1UkwEqDd3SSIXAZLAWK8TEaDe3CWJXARIAmO9TkSAenOXJPKqCNB5vZoEskU7SbUSyhFi0/5G7O8f9r4MjP1BxRyg1uIz5yGXCFABC0SACpKUM0QRICe6FfgWASpIUs4QRYCc6FbgWwSoIEk5QxQBcqJbgW8RoIIk5QxRBMiJbgW+RYAKkpQzRBEgJ7oV+J46AlSAeXEh5vpnWL2fBRSH7BQEVNVx8BTgXdwQRIDiUtJvQCJAv3gX9zQRoLiU9BuQCNAv3sU9TQQoLiX9BlQcAfodvp5mCBRzKVTpqBSBkq9EVwppXWGLAHXlK3m0IkBySOtyKALUla/k0YoAySGty6EIUFe+kkcrAiSHtC6HIkBd+UoerQiQHNK6HIoAdeUrebQiQHJI63L4Dwc4DJ9iodP3AAAAAElFTkSuQmCC",width:"15px",height:"15px"}},title:""}),u=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_point/FeatureServer/0",outFields:["*"],renderer:{type:"simple",symbol:{type:"simple-marker",size:6,color:"black",outline:{width:.5,color:"white"}}},title:""}),d=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_road/FeatureServer/0",outFields:["*"],renderer:{type:"simple",symbol:{type:"simple-line"}},title:""}),h=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_railways/FeatureServer/0",outFields:["*"],renderer:{type:"simple",symbol:{type:"simple-line",style:"long-dash-dot-dot",width:"2px"}},title:""}),p=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_waterways/FeatureServer/0",outFields:["*"],renderer:{type:"simple",symbol:{type:"simple-line",color:"#00b6ff"}},title:""}),m=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_artificial/FeatureServer/0",outFields:["*"],renderer:{type:"simple",symbol:{type:"simple-fill",color:"#708090"}},title:""}),g=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_natural/FeatureServer/0",outFields:["*"],renderer:{type:"simple",symbol:{type:"simple-fill",color:"green"}},title:""}),_=new gp({url:"https://services7.arcgis.com/fiKGTLSbzNPulLL9/arcgis/rest/services/jiexiu_range/FeatureServer/0",renderer:{type:"simple",symbol:{type:"simple-fill",color:"transparent",outline:{color:"red",width:1}}},title:""});qt(()=>{QE.apiKey="AAPK9fadeb203a6d4200b1fe3e6d8ca044caWPf-vFMCLk6mjVT2nRaISumIykxGCy0lxhpXfijjCAHqU31gNAr-h-X-Sh75bhxf",o.container="view",o.map=l;let E=new b_e({title:"",content:[{type:"fields",fieldInfos:[{fieldName:"name",label:""},{fieldName:"type",label:""}]}],actions:[{title:"",id:"edit-this",className:"esri-icon-edit"}]});o.popup.dockOptions={buttonEnabled:!1},c.popupTemplate=E,u.popupTemplate=E,d.popupTemplate=E,h.popupTemplate=E,p.popupTemplate=E,m.popupTemplate=E,g.popupTemplate=E,l.addMany([_,g,m,p,h,d,u,c]);const A=new Ate({view:o,visibleElements:{snappingControls:!1},container:"popupTemplate_editor",layerInfos:[{formTemplate:{elements:[{type:"field",fieldName:"name",label:""},{type:"field",fieldName:"type",label:""}]}}]});function P(){e.editor==!0?eu({message:"",type:"error",duration:1200}):(e.popupTemplate_editor=!0,eu({message:"",type:"sucess",duration:1200}),A.activeWorkFlow||(o.popup.visible=!1,A.startUpdateWorkflowAtFeatureEdit(o.popup.selectedFeature),o.ui.add(A))),rs(()=>A.viewModel.state==="ready",()=>{e.popupTemplate_editor=!1,o.ui.remove(A),setTimeout(()=>{o.popup.visible=!0},3e3)})}o.popup.on("trigger-action",U=>{U.action.id==="edit-this"&&P()});let O;o.popup.watch("visible",U=>{A.viewModel.state==="editing-existing-feature"?o.popup.close():O=o.popup.features});function M(){e.popupTemplate_editor==!1,o.ui.remove(A),O.forEach(U=>{U.popupTemplate=E}),O&&(setTimeout(()=>{o.popup.open({fetchFeatures:!0,shouldFocus:!0,features:O})},3e3),eu({message:" ......",type:"success",duration:3e3})),A.viewModel.cancelWorkflow()}c.on("apply-edits",()=>{M()}),u.on("apply-edits",()=>{M()}),d.on("apply-edits",()=>{M()}),h.on("apply-edits",()=>{M()}),p.on("apply-edits",()=>{M()}),m.on("apply-edits",()=>{M()}),g.on("apply-edits",()=>{M()}),o.ui.components=["attribution"],new MCt({view:o,container:"basemapGallery"}),new Gde({view:o,container:"compass"}),new qde({view:o,container:"zoom"}),new PCt({view:o,container:"home"});const V=new Mve({view:o,layerInfos:[{layer:_},{layer:c},{layer:u},{layer:d},{layer:h},{layer:p},{layer:m},{layer:g}],container:document.createElement("div")});V.style={type:"card",layout:"side-by-side"};const L=new _Ct({expandIconClass:"esri-icon-right",collapseIconClass:"esri-icon-left",view:o,content:V,container:"legend",expandTooltip:"",expanded:!0});o.ui.add(L),new QTt({view:o,container:"scaleBar"}),new MSt({view:o,container:"layerList"}),new Ate({view:o,container:"editor",layerInfos:[{formTemplate:{elements:[{type:"field",fieldName:"name",label:""},{type:"field",fieldName:"type",label:""}]}}]})});let b;function x(){t.polygon="#0079c1",t.rectangle="black";const E=new nie({view:o});o.graphics.removeAll(),E.create("polygon").on(["vertex-add","vertex-remove","cursor-update","redo","undo","draw-complete"],P);function P(O){let V={type:"polygon",rings:O.vertices,spatialReference:o.spatialReference};o.graphics.removeAll();let L=new ao({geometry:V,symbol:{type:"simple-fill",style:"solid",outline:{color:"black",width:1}}});b=L.geometry,o.graphics.add(L)}}function w(){t.rectangle="#0079c1",t.polygon="black";const E=new nie({view:o});o.graphics.removeAll(),E.create("rectangle",{mode:"click"}).on(["vertex-add","cursor-update","draw-complete"],P);function P(O){o.graphics.removeAll();let M=O.vertices;if(M.length<2)return;let L={type:"polygon",rings:[[M[0],[M[1][0],M[0][1]],M[1],[M[0][0],M[1][1]]]],spatialReference:o.spatialReference},U={type:"simple-fill",style:"solid",outline:{color:"black",width:1}},G=new ao({geometry:L,symbol:U});b=G.geometry,o.graphics.add(G)}}function C(){o.graphics.removeAll(),b="",t.polygon="black",t.rectangle="black"}function S(){o.graphics.removeAll(),t.polygon="black",t.rectangle="black",E(b);async function E(P){let O=new eR({returnGeometry:!0,outFields:["name","type"],geometry:P,outSpatialReference:o.SpatialReference,spatialRelationship:"intersects"}),M=await c.queryFeatures(O),V=await u.queryFeatures(O);A(M,V)}function A(P,O){let M="";M=""+P.features.length+"";let V="";P.features.forEach(G=>{V=V+G.attributes.name}),M=M+V;let L="",U="";L=""+O.features.length+"",O.features.forEach(G=>{U=U+G.attributes.name}),L=L+V,lue.success({title:"",message:M+"         "+L,position:"top-left",offset:74}),b=""}}return(E,A)=>(I(),Z(gt,null,[bEt,Q("div",wEt,[Q("div",{class:"item",onClick:n},[Q("div",null,[Q("div",xEt,[(I(),Z("svg",CEt,SEt))]),EEt])]),Q("div",{class:"item",onClick:r},MEt),Q("div",{class:"item",onClick:s},OEt),Q("div",{class:"item",onClick:a},IEt)]),zt(Q("div",$Et,[Q("div",{class:"item",id:"item1",onClick:x},DEt),Q("div",{class:"item",id:"item1",onClick:w},FEt),Q("div",{class:"item",id:"item1",onClick:C},VEt),Q("div",{class:"item",id:"item1",onClick:S},zEt)],512),[[Ei,v(e).query]]),UEt,zt(Q("div",HEt,null,512),[[Ei,v(e).basemap]]),GEt,zt(Q("div",WEt,null,512),[[Ei,v(e).layer]]),zt(Q("div",jEt,null,512),[[Ei,v(e).popupTemplate_editor]]),zt(Q("div",qEt,null,512),[[Ei,v(e).editor]])],64))}},YEt=eye(KEt,[["__scopeId","data-v-75b61aea"]]),XEt={components:{Home:YEt}};function ZEt(i,e,t,n,r,s){const a=jt("Home");return I(),Se(a)}const QEt=eye(XEt,[["render",ZEt]]),tye=Mse(QEt);tye.use(zZe);tye.mount("#app");export{wtt as $,ZFt as A,O7 as B,xu as C,W3t as D,Ia as E,G3t as F,wde as G,pfe as H,yu as I,jut as J,dmt as K,v7 as L,eve as M,Ns as N,Xfe as O,Pt as P,Q8t as Q,CIt as R,Z3 as S,u1t as T,QRt as U,Mmt as V,n8 as W,ghe as X,jv as Y,fge as Z,pge as _,wx as a,GC as a$,Ott as a0,V4t as a1,G4t as a2,pI as a3,U4t as a4,z4t as a5,ptt as a6,_It as a7,pvt as a8,Z4t as a9,yp as aA,iF as aB,L7 as aC,Ls as aD,Ype as aE,tg as aF,_M as aG,j6 as aH,iL as aI,WFt as aJ,Yvt as aK,Igt as aL,$gt as aM,_ge as aN,bge as aO,Vp as aP,WD as aQ,SM as aR,cG as aS,Lx as aT,Akt as aU,xg as aV,Kw as aW,wkt as aX,J6 as aY,bRt as aZ,wRt as a_,MA as aa,Z$t as ab,cn as ac,_r as ad,br as ae,wC as af,JRt as ag,Kmt as ah,_D as ai,Mdt as aj,Sr as ak,YU as al,z_t as am,Hue as an,Ax as ao,z3t as ap,S5t as aq,Dd as ar,H3t as as,fut as at,$p as au,eIt as av,tgt as aw,V3t as ax,fNt as ay,ur as az,Npe as b,dnt as b$,W3 as b0,uRt as b1,dRt as b2,hRt as b3,pRt as b4,yRt as b5,fRt as b6,mRt as b7,gRt as b8,vRt as b9,X$t as bA,LSt as bB,_te as bC,m8t as bD,$h as bE,io as bF,Jpe as bG,_C as bH,E6 as bI,DD as bJ,txt as bK,ID as bL,U1t as bM,p6t as bN,m6t as bO,f6t as bP,NY as bQ,Cr as bR,wg as bS,$b as bT,Jm as bU,OU as bV,eLt as bW,CX as bX,Rrt as bY,_ot as bZ,RU as b_,_Rt as ba,f8t as bb,pD as bc,BY as bd,J$t as be,VY as bf,AN as bg,oEt as bh,AC as bi,jH as bj,Fu as bk,DH as bl,fp as bm,Tv as bn,dEt as bo,zv as bp,IL as bq,fi as br,dIt as bs,Wht as bt,_o as bu,Nn as bv,cut as bw,Zhe as bx,JQ as by,RQ as bz,Vpe as c,Ohe as c$,eD as c0,Xr as c1,XBt as c2,DSt as c3,Qve as c4,nxt as c5,kD as c6,FD as c7,yEt as c8,N6t as c9,qve as cA,Kve as cB,Yve as cC,Jp as cD,L6t as cE,z6t as cF,qV as cG,mte as cH,BBt as cI,uBt as cJ,zBt as cK,UBt as cL,HBt as cM,pme as cN,myt as cO,wa as cP,WV as cQ,zRt as cR,fM as cS,CE as cT,ert as cU,rrt as cV,Ahe as cW,Ehe as cX,drt as cY,BU as cZ,_rt as c_,Sxt as ca,Ght as cb,Hht as cc,K_ as cd,fEt as ce,pEt as cf,nEt as cg,lEt as ch,YBt as ci,GBt as cj,KBt as ck,tLt as cl,Ort as cm,Q$t as cn,qBt as co,Qwt as cp,Kn as cq,WBt as cr,jBt as cs,tB as ct,eB as cu,pm as cv,uEt as cw,B6t as cx,DO as cy,Wve as cz,xIt as d,HU as d0,Trt as d1,Drt as d2,Jrt as d3,gb as d4,Uyt as d5,K_t as d6,mH as d7,Ume as d8,s0t as d9,ont as dA,So as dB,Lge as dC,yxt as dD,Lh as dE,Txt as dF,gxt as dG,Hve as dH,Y6t as dI,K6t as dJ,BH as dK,e1t as dL,cbt as dM,Kbt as dN,Hme as da,o0t as db,Gme as dc,c0t as dd,Wme as de,d0t as df,Mhe as dg,frt as dh,Hvt as di,Uvt as dj,AD as dk,Gvt as dl,U0t as dm,qme as dn,W0t as dp,Kme as dq,q0t as dr,Yme as ds,obt as dt,RD as du,mbt as dv,Ebt as dw,Mbt as dx,Obt as dy,rhe as dz,Lde as e,L0t as f,OE as g,hDt as h,pDt as i,aut as j,mkt as k,kpe as l,Pit as m,bde as n,umt as o,Itt as p,Gut as q,Zm as r,v1t as s,Fa as t,ga as u,X3t as v,Y3t as w,Od as x,D1t as y,B3t as z};
