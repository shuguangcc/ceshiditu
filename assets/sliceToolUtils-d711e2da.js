import"./geometry-5a216427.js";import{e as V,y as H,s as $e,n as Xe,l as Ye}from"./cast-7928d7aa.js";import{i as Ze}from"./Clonable-ba795b08.js";import{s as _e}from"./Cyclical-b66238c6.js";import{z as Be,e as Je,r as W,t as x}from"./typedArrayUtil-a8b5b3e9.js";import{a as Oe}from"./ensureType-cf29afa9.js";import{g as G}from"./persistable-19c823da.js";import{w as Ke}from"./Extent-69509002.js";import{h as Qe}from"./string-cdf077e6.js";import{s as et}from"./Error-653283ae.js";import{m as Q,b as tt}from"./mathUtils-2519596a.js";import{p as ce}from"./screenUtils-410d12c0.js";import{R as me,i as xe,u as j,b as Ue,r as Te,c as Ee,I as Ie,m as rt}from"./mat4-44a0988f.js";import{e as ae}from"./mat4f64-1e28eae0.js";import{Q as we}from"./quat-5b263584.js";import{r as M,s as P,o as ee,u as _,g as h,e as I,z as S,P as F,_ as y,v as it}from"./vec3-a020a6f6.js";import{r as C,n as te,t as st}from"./vec3f64-2f9cef06.js";import{z as ot}from"./projection-d7b57a6c.js";import{d as nt,c as d,e as z,i as at,o as Ae,n as Ce}from"./sphere-4f5e644f.js";import{ai as dt,aj as ct,ab as lt,bd as oe,by as Y,be as le,bz as He,bf as L,aW as ut,bW as gt,bX as Re,bY as pt,bV as mt,bZ as ht,b_ as ft,W as Fe,bS as De,b$ as ue,bU as bt,c0 as $t}from"./index-455b69b8.js";import{_ as Ge,O as je}from"./plane-45609588.js";import{e as q,r as U}from"./vec4f64-e407da96.js";import{n as _t,c as Ot,b as Tt}from"./LineVisualElement-69b2e868.js";import{D as Et,i as ze,x as It,R as wt}from"./manipulatorUtils-302eea16.js";import{a as ve}from"./vec4-790471c0.js";import{E as At,d as Ct,x as Rt,c as T}from"./VisualVariablePassParameters-5807c7dc.js";import{h as vt}from"./Matrix3PassUniform-da8eddae.js";import{t as yt}from"./ShaderTechniqueConfiguration-9f5b4555.js";import{E as Lt,t as Nt}from"./objectResourceUtils-ef6e3cdf.js";import{_ as Mt}from"./preload-helper-41c905a7.js";import{o as Pt,n as ye,t as St}from"./ShaderBuilder-93e8045e.js";import{t as kt,e as Vt,o as Wt,W as xt,l as Ut,_ as Ht}from"./EvaluateSceneLighting.glsl-3bbc6edf.js";import{v as Ft}from"./View.glsl-8b12b8c2.js";import{e as Le}from"./Float4PassUniform-3a47b7b3.js";import{o as Dt}from"./FloatPassUniform-d2dfc562.js";import{O as Ne}from"./VertexAttribute-9c5c630d.js";import{R as Z,I as Gt}from"./enums-64ab819c.js";import{n as B}from"./basicInterfaces-19ed850e.js";let w=class extends Ze(Ye){constructor(t){super(t),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(t){return this.heading===t.heading&&this.tilt===t.tilt&&Be(this.position,t.position)&&this.width===t.width&&this.height===t.height}};V([H({readOnly:!0,json:{read:!1,write:!0}})],w.prototype,"type",void 0),V([H({type:Ke}),G()],w.prototype,"position",void 0),V([H({type:Number,nonNullable:!0,range:{min:0,max:360}}),G(),$e(e=>_e.normalize(Oe(e),0,!0))],w.prototype,"heading",void 0),V([H({type:Number,nonNullable:!0,range:{min:0,max:360}}),G(),$e(e=>_e.normalize(Oe(e),0,!0))],w.prototype,"tilt",void 0),V([H({type:Number,nonNullable:!0}),G()],w.prototype,"width",void 0),V([H({type:Number,nonNullable:!0}),G()],w.prototype,"height",void 0),w=V([Xe("esri.analysis.SlicePlane")],w);const jt=w,pi=Qe("mac")?"Meta":"Control",mi="Shift",zt=2,qt=1.15,Xt=1.15,hi=2500,fi=.02,Yt=Math.cos(Q(45)),Me=Math.cos(Q(5)),bi=.95,$i=.3,Zt=.7,X=C(1,.5,0),_i=2,Bt=1,Jt=q([...X,Zt]),Kt=[0,0,0,.04],Qt=q([...X,.5]),er=U(1,1,1,1),tr=U(1,.8,.6,1),rr=U(1,.93,.86,1),ir=q([...X,1]),sr=q([...X,1]),or=3,Pe=11,ge=22.5,K=40,Se=48,nr=2.25,ar=q([...X,1]),dr=4,ke=1,cr=.3,lr=6,ur=4,Ve=1600,gr=.4;function pr(e){const t=new Pt;t.extensions.add("GL_OES_standard_derivatives");const{vertex:r,fragment:s,attributes:o,varyings:n}=t;return Ft(r,e),o.add(Ne.POSITION,"vec3"),o.add(Ne.UV0,"vec2"),n.add("vUV","vec2"),r.code.add(ye`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),s.uniforms.add([new Le("backgroundColor",i=>i.backgroundColor),new Le("gridColor",i=>i.gridColor),new Dt("gridWidth",i=>i.gridWidth)]),s.code.add(ye`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),t}const mr=Object.freeze(Object.defineProperty({__proto__:null,build:pr},Symbol.toStringTag,{value:"Module"}));let hr=class extends St{constructor(){super(...arguments),this.backgroundColor=U(1,0,0,.5),this.gridColor=U(0,1,0,.5),this.gridWidth=4}};class ne extends Vt{initializeProgram(t){return new Wt(t.rctx,ne.shader.get().build(this.configuration),At)}initializePipeline(){return xt({blending:Ut(Z.ONE,Z.ONE,Z.ONE_MINUS_SRC_ALPHA,Z.ONE_MINUS_SRC_ALPHA),depthTest:{func:Gt.LESS},colorWrite:Ht})}}ne.shader=new kt(mr,()=>Mt(()=>import("./SlicePlaneMaterial.glsl-4f93655f.js"),["./SlicePlaneMaterial.glsl-4f93655f.js","./View.glsl-8b12b8c2.js","./mat4-44a0988f.js","./vec3f64-2f9cef06.js","./common-c186b691.js","./mat4f32-77b3d8ac.js","./vec3-a020a6f6.js","./ShaderBuilder-93e8045e.js","./typedArrayUtil-a8b5b3e9.js","./Error-653283ae.js","./string-cdf077e6.js","./VertexAttribute-9c5c630d.js","./geometry-5a216427.js","./ensureType-cf29afa9.js","./Extent-69509002.js","./cast-7928d7aa.js","./nextTick-3ee5a785.js","./promiseUtils-6684e352.js","./Ellipsoid-89682c5e.js","./Polyline-bf268e7b.js","./typeUtils-eb9416d0.js","./jsonMap-c1f958cf.js","./Clonable-ba795b08.js","./Cyclical-b66238c6.js","./mathUtils-2519596a.js","./vec4-790471c0.js","./persistable-19c823da.js","./preload-helper-41c905a7.js","./multiOriginJSONSupportUtils-c978f4c3.js","./request-d3e98716.js","./uuid-73213768.js","./persistableUrlUtils-a16d0f55.js","./screenUtils-410d12c0.js","./mat4f64-1e28eae0.js","./quat-5b263584.js","./mat3f64-c6305894.js","./quatf64-7fd38d64.js","./projection-d7b57a6c.js","./unitUtils-47abac71.js","./SimpleObservable-7dcdef1d.js","./assets-0b172f07.js","./aaBoundingRect-4a760199.js","./zscale-1e1fc911.js","./sphere-4f5e644f.js","./vec4f64-e407da96.js","./byteSizeEstimations-f0cab514.js","./vec2f64-30dc1443.js","./index-455b69b8.js","./Basemap-a8f7f439.js","./Collection-78126e82.js","./Evented-515b9d9c.js","./collectionUtils-3831b7c4.js","./deprecate-b9088bd3.js","./Loadable-48bc1293.js","./Promise-dfdee8ba.js","./loadAll-7fd968fe.js","./asyncUtils-62e8a185.js","./Portal-8b65c9c4.js","./locale-30120714.js","./PortalGroup-bfe93c76.js","./PortalUser-4c8e1adc.js","./PortalItem-aa42c739.js","./messages-be07754e.js","./writeUtils-067c4f82.js","./layerUtils-034678f6.js","./Color-a42a8267.js","./colorUtils-639f4d25.js","./compilerUtils-034cacb8.js","./enumeration-3c281341.js","./opacityUtils-243aae26.js","./CollectionFlattener-3dd1f479.js","./TablesMixin-e7a6aab1.js","./Layer-f0696768.js","./Identifiable-aa6d459d.js","./Graphic-b46e2684.js","./PopupTemplate-6eb885db.js","./fieldUtils-31bfecd2.js","./arcadeOnDemand-c6d1b9f2.js","./number-347a3a44.js","./symbols-fa594797.js","./CIMSymbol-1379245a.js","./Symbol-fc4312a4.js","./symbolLayerUtils3D-1f8d4478.js","./aaBoundingBox-fc742a4e.js","./Symbol3DAnchorPosition2D-c0f4a14d.js","./jsonUtils-03c4af61.js","./reactiveUtils-f41a4e00.js","./workers-898a7c4c.js","./Connection-a681777e.js","./Queue-3a0c055d.js","./intl-f1e98361.js","./TileInfo-34f80a8e.js","./widget-f7489a3f.js","./dom-5b7af1bf.js","./HandleOwner-e1406413.js","./executeQueryJSON-bcd96e1a.js","./normalizeUtils-ee4bf39f.js","./query-922e6fbf.js","./pbfQueryUtils-72f9b45b.js","./pbf-e1a6c35b.js","./OptimizedFeature-3de538c1.js","./OptimizedFeatureSet-1d1ac4b9.js","./queryZScale-d9d8ef40.js","./FeatureSet-0573546e.js","./Field-f5fc9f6b.js","./fieldType-b1002185.js","./Query-ff8c2cfb.js","./TimeExtent-744afd75.js","./RelationshipQuery-db5fcd0c.js","./LegendOptions-e65e7a9c.js","./utils-725f8b4e.js","./BlendLayer-d8293c8d.js","./parser-2b40deea.js","./ItemCache-ee28c7ba.js","./MemCache-4b976a8b.js","./cimSymbolUtils-2e4dde89.js","./utils-c81a5c52.js","./jsonUtils-c56f8821.js","./UniqueValueRenderer-103ec66d.js","./diffUtils-1ac65748.js","./colorRamps-3a8ac20b.js","./sizeVariableUtils-d4870b0d.js","./visualVariableUtils-c59ab38d.js","./lengthUtils-d2d33f94.js","./jsonUtils-d7db3dc7.js","./styleUtils-4adfed9e.js","./DictionaryLoader-2cf5144e.js","./LRUCache-14115d91.js","./heatmapUtils-84e8c43b.js","./featureConversionUtils-01cdde8a.js","./TopFeaturesQuery-785f5453.js","./FeatureLayer-a9f3e6ec.js","./MultiOriginJSONSupport-27362d57.js","./LayerFloorInfo-2cd5e8ae.js","./FeatureLayerBase-aebdf2da.js","./HeightModelInfo-22ad72d7.js","./arcgisLayerUrl-0b2b7691.js","./OperationalLayer-24e6fa34.js","./ElevationInfo-ce9cacc2.js","./editsZScale-2015e7db.js","./APIKeyMixin-34d76a46.js","./ArcGISService-ea748edf.js","./CustomParametersMixin-807d2055.js","./EditBusLayer-40671d1a.js","./FeatureReductionLayer-4077b2ae.js","./labelingInfo-5c3a46f6.js","./labelUtils-a194a22a.js","./defaultsJSON-59981e75.js","./OrderedLayer-e7edf19c.js","./PortalLayer-f1a64f99.js","./RefreshableLayer-1c078c47.js","./ScaleRangeLayer-271178b7.js","./TemporalLayer-39c07299.js","./TimeInfo-c89d0ef4.js","./FeatureTemplate-746d033e.js","./FeatureType-c83c5f49.js","./fieldProperties-7547b373.js","./FieldsIndex-aa6dd3fa.js","./versionUtils-92993d41.js","./styleUtils-da81b13f.js","./popupUtils-07fe66a7.js","./colorUtils-82440b70.js","./mat2d-d0b91e3e.js","./Scheduler-8433672d.js","./GraphicsLayer-10573c27.js","./ViewingMode-5d7d590b.js","./enums-0fc02184.js","./vec2-2cef68de.js","./mat3-3fc68e72.js","./mat3f32-d3d088e8.js","./vec2f32-461e65a9.js","./TileStrategy-4189758f.js","./TileStore-787dbea4.js","./TileKey-0750ad58.js","./rbush-8e36784a.js","./quickselect-322ec8e1.js","./capabilities-3636c6a4.js","./context-util-1e3c8cfc.js","./lineSegment-e6f72ff2.js","./plane-45609588.js","./scaleUtils-b32a50d8.js","./ElevationSamplerData-7decf898.js","./PhysicallyBasedRendering.glsl-a986c926.js","./FloatPassUniform-d2dfc562.js","./Float4PassUniform-3a47b7b3.js","./RgbaFloatEncoding.glsl-6036ca34.js","./Texture2DPassUniform-6e8ae673.js","./vec3f32-c9aa289f.js","./Texture2DDrawUniform-22924c6f.js","./basicInterfaces-19ed850e.js","./PiUtils.glsl-0c0898f0.js","./ReadLinearDepth.glsl-7ff30f7d.js","./WaterSurface.glsl-fc8a5726.js","./ForwardLinearDepth.glsl-36f9eb3b.js","./Matrix3PassUniform-da8eddae.js","./Slice.glsl-a612de15.js","./Transform.glsl-f15542a7.js","./OutputHighlight.glsl-7364b03b.js","./MultipassTerrainTest.glsl-e79d40de.js","./NormalUtils.glsl-a59958d7.js","./AlphaCutoff-96178e0d.js","./TransparencyPassType-cd195b0e.js","./EvaluateSceneLighting.glsl-3bbc6edf.js","./VisualVariablePassParameters-5807c7dc.js","./enums-64ab819c.js","./VertexElementDescriptor-2925c6af.js","./FramebufferObject-50e1b68f.js","./Texture-e79b14e7.js","./Util-a48361c6.js","./SSAOBlur.glsl-c6f142fc.js","./ScreenSpacePass-00f8c8a4.js","./SSAO.glsl-6f3b4065.js","./ShaderTechniqueConfiguration-9f5b4555.js","./HUD.glsl-80cf9a21.js","./VerticalOffset.glsl-86460edb.js","./objectResourceUtils-ef6e3cdf.js","./devEnvironmentUtils-5002a058.js","./BufferView-646ba1de.js","./vec33-ce3aa99b.js","./DefaultMaterial_COLOR_GAMMA-9831d979.js","./types-e1c0a5bf.js","./Version-9baeb7ac.js","./Texture-bbae5d9d.js","./TextureOnly.glsl-18701a3b.js","./InterleavedLayout-5e9cf734.js","./MixExternalColor.glsl-25f0049c.js","./symbolColorUtils-604c5345.js","./ObjectAndLayerIdColor.glsl-73c19386.js","./OutputDepth.glsl-179f1d8f.js","./VisualVariables.glsl-b8290512.js","./DiscardOrAdjustAlphaBlend.glsl-5f837994.js","./Normals.glsl-90e28525.js","./DefaultMaterial.glsl-b4f4cbc5.js","./VertexColor.glsl-db21b96c.js","./DefaultTechniqueConfiguration-e8962072.js","./RealisticTree.glsl-2b30ed32.js","./edgeProcessing-3ca548e1.js","./deduplicate-b0bc48cc.js","./projection-aa2a8986.js","./Octree-1a841545.js","./HUDMaterial.glsl-4bf3c7df.js","./sdfPrimitives-a24e9cb2.js","./floatRGBA-fa8308d2.js","./dehydratedFeatures-4eeb381a.js","./quantizationUtils-33aba427.js","./labelFormatUtils-4d730eaa.js","./I3SUtil-3ffd3baa.js","./I3SBinaryReader-3d2c2faa.js","./LineCallout.glsl-a0056465.js","./earcut-58237617.js","./QueryEngineResult-665bf7fb.js","./WhereClause-2b5b05b2.js","./utils-30a9a7e0.js","./generateRendererUtils-a996108f.js","./utils-1f4fcfec.js","./json-48e3ea08.js","./MeshComponent-f50df6af.js","./MarkerSizing.glsl-c6fa192a.js","./RibbonLine.glsl-2a3b4d4e.js","./LineStipple.glsl-de782d6a.js","./callExpressionWithFeature-a7532499.js","./LineMarker.glsl-8f444621.js","./NativeLine.glsl-cdbbf172.js","./Path.glsl-60b36878.js","./ColorMaterial.glsl-8310ffb3.js","./Pattern.glsl-d3388745.js","./EffectView-d3bf37ed.js","./LercDecoder-73115fd2.js","./config-1337d16e.js","./workerHelper-c6d4a8cb.js","./Subtype-5b01b21f.js","./datetime-4f774298.js","./elevationInfoUtils-427916a5.js","./ExportImageParameters-f328a234.js","./sublayerUtils-ba7f61bc.js","./webStyleSymbolUtils-55ed91cd.js","./enums-4b2a86a0.js","./index-8e3f441a.css","./LineVisualElement-69b2e868.js","./manipulatorUtils-302eea16.js","./ImageMaterial-0dc3e395.js","./ImageMaterial.glsl-2969e37d.js","./ShadedColorMaterial.glsl-7dee9441.js"],import.meta.url));class fr extends Ct{constructor(t){super(t,new $r),this._configuration=new yt}intersect(t,r,s,o,n,i,a){return Rt(t,r,o,n,i,void 0,a)}createBufferWriter(){return new dt(ct)}requiresSlot(t,r){return r===vt.Color&&t===Lt.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(t){return new br(t)}getConfiguration(){return this._configuration}}class br extends Nt{constructor(t){super(t),this.ensureTechnique(ne,null)}beginSlot(){return Je(this.technique)}}class $r extends hr{constructor(){super(...arguments),this.renderOccluded=T.Occlude}}class _r extends _t{constructor(t){super(t),this._material=null,this._renderOccluded=T.OccludeAndTransparent,this._gridWidth=1,this._gridColor=U(1,0,0,1),this._backgroundColor=U(1,0,0,1),this.applyProps(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(t){this._gridWidth!==t&&(this._gridWidth=t,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(t){ve(this._gridColor,t),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){ve(this._backgroundColor,t),this._updateMaterial()}createExternalResources(){this._material=new fr(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(t){W(this._material)&&t(this._material)}createGeometries(t){if(W(this._material)){const r=lt();t.addGeometry(r,this._material)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){W(this._material)&&this._material.setParameters(this._materialParameters)}}function Ti(e,t,r,s,o,n,i,a){return Or(t,i.worldUpAtPosition(e,d.get()),o,n,a.basis1,a.basis2),h(a.basis1,a.basis1,r),h(a.basis2,a.basis2,s),M(a.origin,e),je(a.basis2,a.basis1,a.origin,a.plane),a}function Or(e,t,r,s,o,n){const i=F(e,t),a=d.get(),c=d.get();switch(s===N.HORIZONTAL_OR_VERTICAL?Math.abs(i)>Yt?N.HORIZONTAL:N.VERTICAL:s){case N.VERTICAL:{const u=Math.abs(i)<=Me?e:r.viewUp;y(a,u,t),M(c,t);break}case N.HORIZONTAL:y(a,r.viewUp,t),y(c,t,a);break;case N.TILTED:{const u=Math.abs(i)<=Me?t:r.viewUp;y(a,u,e),y(c,e,a);break}}const g=y(d.get(),a,c);F(g,r.viewForward)>0&&h(c,c,-1),S(o,a),S(n,c)}function Tr(e,t,r){const s=t.worldUpAtPosition(e.origin,d.get()),o=e.basis1,n=be(e,s),i=Math.round(n/D)*D;return ue(e,i-n,o,r)}function Ei(e,t,r,s,o,n){const i=M(d.get(),o.origin);_(i,i,h(d.get(),o.basis1,e.direction[0]<0?1:-1)),_(i,i,h(d.get(),o.basis2,e.direction[1]<0?1:-1));const a=P(o.basis1),c=P(o.basis2),g=I(d.get(),r,i),u=I(d.get(),t,i);let l=0,O=0;if(fe(e)){const $=pe(o),v=pe(n);l=a-.5*e.direction[0]*F(o.basis1,u)/a,O=c-.5*e.direction[1]*F(o.basis2,u)/c;const k=v/$;l*=k,O*=k}const E=l+.5*e.direction[0]*F(o.basis1,g)/a,f=O+.5*e.direction[1]*F(o.basis2,g)/c,p=h(d.get(),o.basis1,E/a),m=h(d.get(),o.basis2,f/c);(E<=0||We(n.origin,p,s)<=Ve)&&M(p,n.basis1),(f<=0||We(n.origin,m,s)<=Ve)&&M(m,n.basis2);const b=M(d.get(),i);return _(b,b,h(d.get(),p,e.direction[0]<0?-1:1)),_(b,b,h(d.get(),m,e.direction[1]<0?-1:1)),mt(b,p,m,n)}function Ii(e,t){return gr*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function wi(e,t,r,s){const o=y(d.get(),t,r);return y(o,o,t),Ge(e,o,s)}function Ai(e,t){return Et(e.basis1,e.basis2,e.origin,t)}function Ci(e,t,r,s){const o=t.worldUpAtPosition(e.origin,d.get()),n=d.get();switch(r){case re.HEADING:M(n,o);break;case re.TILT:M(n,e.basis1)}return Ge(e.origin,n,s)}function Ri(e,t,r,s){const o=he(r,R.NEGATIVE_X),n=z.get();rt(n,t,o.edge*Math.PI/2);const i=S(d.get(),o.basis);let a=h(d.get(),i,o.direction*s.computeScreenPixelSizeAt(o.position)*K);_(a,a,o.position);const c=s.projectToRenderScreen(a,ce(d.get())),g=Er(s,c);ht(s,c,J),S(J.direction,J.direction);const u=d.get();!g&&ft(r,J,u)&&(a=u),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=st(a),g?e.state|=ie:e.state&=~ie}function Er(e,t){const[r,s,o,n]=e.viewport,i=Math.min(o,n)/16;let a=!0;return t[0]<r+i?(t[0]=r+i,a=!1):t[0]>r+o-i&&(t[0]=r+o-i,a=!1),t[1]<s+i?(t[1]=s+i,a=!1):t[1]>s+n-i&&(t[1]=s+n-i,a=!1),a}function vi(e,t,r,s){const o=P(s.basis1),n=P(s.basis2),i=qe(s),a=pe(s),c=ee(d.get(),0,0,0);_(c,h(d.get(),s.basis1,t.direction[0]),h(d.get(),s.basis2,t.direction[1])),_(c,s.origin,c);let g=0,u=1;if(fe(t))t.direction[0]===1&&t.direction[1]===-1?g=D:t.direction[0]===1&&t.direction[1]===1?g=Math.PI:t.direction[0]===-1&&t.direction[1]===1&&(g=3*Math.PI/2),u=a;else{const O=t.direction[0]!==0?1:2;g=O===1?D:0,u=(O===1?n:o)-i}const l=me(z.get(),g);xe(l,l,ee(d.get(),u,u,u)),j(l,r,l),l[12]=0,l[13]=0,l[14]=0,e.modelTransform=l,e.renderLocation=c}function yi(e,t,r,s){const o=s.worldUpAtPosition(r.origin,d.get()),n=he(r,R.POSITIVE_X),i=me(z.get(),n.edge*Math.PI/2);Ue(i,i,-be(r,o)),j(i,t,i),i[12]=0,i[13]=0,i[14]=0,e.modelTransform=i,e.renderLocation=n.position}function Li(e,t,r){const s=he(r,R.POSITIVE_Y),o=me(z.get(),s.edge*Math.PI/2);Ue(o,o,D),j(o,t,o),o[12]=0,o[13]=0,o[14]=0,e.modelTransform=o,e.renderLocation=s.position}var R;function he(e,t){switch(t){case R.POSITIVE_X:return{basis:e.basis1,direction:1,position:_(d.get(),e.origin,e.basis1),edge:t};case R.POSITIVE_Y:return{basis:e.basis2,direction:1,position:_(d.get(),e.origin,e.basis2),edge:t};case R.NEGATIVE_X:return{basis:e.basis1,direction:-1,position:I(d.get(),e.origin,e.basis1),edge:t};case R.NEGATIVE_Y:return{basis:e.basis2,direction:-1,position:I(d.get(),e.origin,e.basis2),edge:t}}}function We(e,t,r){const s=r.projectToRenderScreen(_(d.get(),e,t),ce(d.get())),o=r.projectToRenderScreen(I(d.get(),e,t),ce(d.get()));return it(I(s,s,o))}function qe(e){const t=P(e.basis1),r=P(e.basis2);return cr*Math.min(t,r)}function pe(e){return qe(e)}function fe(e){return e.direction[0]!==0&&e.direction[1]!==0}function Ni(e,t=se.CENTER_ON_ARROW){const r=t===se.CENTER_ON_CALLOUT?K:0,s=[C(r,0,-Se/2),C(r,0,Se/2)],o=Ar(s,!0),n=(p,m)=>Ir(s,s,{tubeRadius:or,tipRadius:Pe,tipLength:ge,tubeFocusMultiplier:qt,tipFocusMultiplier:Xt,padding:p,bothEnds:!0,flat:null,focusTipLength:!0,addCap:m}),i=n(0,!1),a=n(nr,!0),c=new Y({color:er,cullFace:B.Back,renderOccluded:T.Opaque}),g=new Y({color:tr,cullFace:B.Back,renderOccluded:T.Opaque}),u=new Y({color:rr,cullFace:B.Back,renderOccluded:T.Opaque}),l=new Y({color:sr,transparent:!0,writeDepth:!1,cullFace:B.Front,renderOccluded:T.Transparent}),O=le([[r,0,0],[r-K,0,0]]),E=le([[r,0,0],[r-K,0,0]]),f=new He({color:ir,renderOccluded:T.OccludeAndTransparent});return new ze({view:e,renderObjects:[...i.normal.map(({part:p,geometry:m,transform:b})=>({geometry:m,material:p==="tip"?c:p==="cap"?g:u,transform:b,stateMask:L.Unfocused|A})),...a.normal.map(({geometry:p,transform:m})=>({geometry:p,material:l,transform:m,stateMask:L.Unfocused|A})),{geometry:O,material:f,stateMask:L.Unfocused|A|ie},...i.focused.map(({part:p,geometry:m,transform:b})=>({geometry:m,material:p==="tip"?c:p==="cap"?g:u,transform:b,stateMask:L.Focused|A})),...a.focused.map(({geometry:p,transform:m})=>({geometry:p,material:l,transform:m,stateMask:L.Focused|A})),{geometry:E,material:f,stateMask:L.Focused|A|ie}],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[o]},collisionPriority:1,radius:Pe,state:A})}function Mi(e,t){const r=wt(e,{customStateMask:A,texture:t});return r.state=A,r}function Pi(e){const t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new Ot({view:e,attached:!1,color:Jt,width:Bt,writeDepthEnabled:!1,renderOccluded:T.OccludeAndTransparent,geometry:[t]})}function Si(e){return new _r({view:e,attached:!1,backgroundColor:[...Kt],gridColor:Qt,gridWidth:4,renderOccluded:T.OccludeAndTransparent})}function ki(e,t){const r=fe(t),s=r?[C(1,0,0),C(0,0,0),C(0,1,0)]:[C(1,0,0),C(-1,0,0)],o=le(s),n=ar,i=f=>new ut({color:n,width:f,renderOccluded:T.OccludeAndTransparent}),a=()=>new He({color:n,renderOccluded:T.OccludeAndTransparent}),c=r?dr:ke,g=c*zt,u=ke,l=f=>f>1?i(f):a(),O=[{geometry:o,material:l(c),stateMask:L.Unfocused|de},{geometry:o,material:l(g),stateMask:L.Focused|de},{geometry:o,material:l(u),stateMask:Rr}],E=new ze({view:e,renderObjects:O,collisionType:{type:"line",paths:[s]},radius:r?lr:ur,...It});return E.state=de,E}function Ir(e,t,r){const s=o=>{const n=(o?t:e).slice(0),i=I(d.get(),n[0],n[1]);S(i,i);const a=I(d.get(),n[n.length-1],n[n.length-2]);if(S(a,a),r.padding>0){const $=h(te(),a,-r.padding);if(n[n.length-1]=_($,$,n[n.length-1]),r.bothEnds){const v=h(te(),i,-r.padding);n[0]=_(v,v,n[0])}}const c=o?r.tipFocusMultiplier:1,g=r.tipLength*(r.focusTipLength?c:1),u=r.tipRadius*c,l=Te(z.get());if(r.padding>0){const $=g/4,v=ee(d.get(),0,$,0),k=1+r.padding/$;Ee(l,l,v),xe(l,l,ee(d.get(),k,k,k)),Ee(l,l,h(v,v,-1/k))}const O=Te(ae()),E=C(0,1,0),f=Ie(ae(),we(Ae.get(),E,a));f[12]=n[n.length-1][0],f[13]=n[n.length-1][1],f[14]=n[n.length-1][2],j(f,f,l);const p=[{part:"tube",geometry:wr(r.tubeRadius*(o?r.tubeFocusMultiplier:1)+r.padding,r.flat,n),transform:O}];let m,b;if(W(r.flat)?m=gt(g,u,u,r.flat.thickness):(m=Re(g,u,24,!1,!1,!0),b=Re(g,u,24,!1,!0,!1)),p.push({part:"tip",geometry:m,transform:f}),b&&p.push({part:"cap",geometry:b,transform:f}),r.bothEnds){const $=Ie(ae(),we(Ae.get(),E,i));$[12]=n[0][0],$[13]=n[0][1],$[14]=n[0][2],j($,$,l),p.push({part:"tip",geometry:m,transform:$}),b&&p.push({part:"cap",geometry:b,transform:$})}return p};return{normal:s(!1),focused:s(!0)}}function wr(e,t,r){const s=[];if(W(t))s.push([e,t.thickness/2],[-e,t.thickness/2],[-e,-t.thickness/2],[e,-t.thickness/2]);else for(let n=0;n<12;n++){const i=n/12*2*Math.PI;s.push([Math.cos(i)*e,Math.sin(i)*e])}return pt(s,r,[],[],!1)}function Ar(e,t){const r=I(te(),e[e.length-1],e[e.length-2]);if(S(r,r),h(r,r,ge),_(r,r,e[e.length-1]),t){const s=I(te(),e[0],e[1]);return S(s,s),h(s,s,ge),_(s,s,e[0]),[s,...e,r]}return[...e,r]}function Vi(e,t,r,s=new jt){if(x(e))return null;const{renderCoordsHelper:o}=t,n=o.fromRenderCoords(e.origin,t.spatialReference);if(x(n))return null;const i=ot(n,r);if(x(i))return null;s.position=i;const a=2*P(e.basis1),c=2*P(e.basis2),g=Fe.renderUnitScaleFactor(t.spatialReference,r);s.width=a*g,s.height=c*g;const u=o.worldUpAtPosition(e.origin,d.get());return s.tilt=tt(be(e,u)),s.heading=o.headingAtPosition(e.origin,e.basis1)-90,s}function be(e,t){return at(t,e.basis2,e.basis1)+D}function Cr(e,t,r,s,o,n,i=De()){return n.toRenderCoords(e,i.origin)?(n.worldBasisAtPosition(i.origin,Ce.X,i.basis1),n.worldBasisAtPosition(i.origin,Ce.Y,i.basis2),je(i.basis2,i.basis1,i.origin,i.plane),ue(i,-Q(t),bt(i),i),ue(i,Q(r),i.basis1,i),h(i.basis1,i.basis1,s/2),h(i.basis2,i.basis2,o/2),$t(i),i):(et.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function Wi(e,t){if(x(e)||x(e.position))return null;const r=Tt(e.position,t.spatialReference,t.elevationProvider);if(x(r))return null;const s=Fe.renderUnitScaleFactor(e.position.spatialReference,t.spatialReference),o=e.width*s,n=e.height*s;return{position:r,heading:e.heading,tilt:e.tilt,renderWidth:o,renderHeight:n}}function xi(e,t,r,s=De()){if(x(e))return null;const o=Cr(e.position,e.heading,e.tilt,e.renderWidth,e.renderHeight,t.renderCoordsHelper,s);return!r.tiltEnabled&&W(o)&&Tr(o,t.renderCoordsHelper,o),o}(function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.POSITIVE_Y=1]="POSITIVE_Y",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.NEGATIVE_Y=3]="NEGATIVE_Y"})(R||(R={}));const A=oe.Custom1;var re,N;(function(e){e[e.HEADING=1]="HEADING",e[e.TILT=2]="TILT"})(re||(re={})),function(e){e[e.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.TILTED=3]="TILTED"}(N||(N={}));const ie=oe.Custom2,J=nt(),D=Math.PI/2,de=oe.Custom1,Rr=oe.Custom2;var se;function Ui(e){const t=e.type==="building-scene-3d"?e:null;return W(t)}(function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(se||(se={}));export{ie as A,Ai as B,Qt as C,Ti as G,A as I,vi as J,yi as K,Rr as L,$i as M,xi as O,Li as Q,re as R,Wi as T,wi as W,Ei as Y,Ii as Z,se as _,Mi as a,_i as b,Pi as c,pi as d,hi as e,Jt as f,Vi as g,jt as h,fi as i,de as j,Ui as k,Si as l,mi as m,bi as n,Ni as o,Ci as q,pe as r,fe as s,pr as t,ki as u,Bt as v,N as w,Kt as x,Ri as z};
