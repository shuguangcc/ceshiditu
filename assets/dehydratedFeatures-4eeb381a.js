import{t as m}from"./byteSizeEstimations-f0cab514.js";import"./string-cdf077e6.js";import{r as p,t as h,O as l}from"./typedArrayUtil-a8b5b3e9.js";import{k as f}from"./cast-7928d7aa.js";import{k as y}from"./Extent-69509002.js";import{a as g,A as b,s as c}from"./aaBoundingBox-fc742a4e.js";import{u as d,D as x,x as u}from"./aaBoundingRect-4a760199.js";import{C as Z,B as k,q as M,v as N}from"./quantizationUtils-33aba427.js";import{i as v}from"./typeUtils-eb9416d0.js";import{y as I}from"./Field-f5fc9f6b.js";class q{constructor(e,s,n){this.uid=e,this.geometry=s,this.attributes=n,this.visible=!0,this.objectId=null,this.centroid=null}}function B(t){return p(t.geometry)}class C{constructor(){this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null}}function D(t){const e=v.fromJSON(t.geometryType),s=y.fromJSON(t.spatialReference),n=t.transform,o=t.features.map(i=>{const a=F(i,e,s,t.objectIdFieldName),r=a.geometry;if(p(r)&&n)switch(r.type){case"point":a.geometry=N(n,r,r,r.hasZ,r.hasM);break;case"multipoint":a.geometry=M(n,r,r,r.hasZ,r.hasM);break;case"polygon":a.geometry=k(n,r,r,r.hasZ,r.hasM);break;case"polyline":a.geometry=Z(n,r,r,r.hasZ,r.hasM);break;case"extent":case"mesh":a.geometry=r}return a});return{geometryType:e,features:o,spatialReference:s,fields:t.fields?t.fields.map(i=>I.fromJSON(i)):null,objectIdFieldName:t.objectIdFieldName,globalIdFieldName:t.globalIdFieldName,geohashFieldName:t.geohashFieldName,geometryProperties:t.geometryProperties,hasZ:t.hasZ,hasM:t.hasM,exceededTransferLimit:t.exceededTransferLimit,transform:null}}function F(t,e,s,n){return{uid:f(),objectId:n&&t.attributes?t.attributes[n]:null,attributes:t.attributes,geometry:z(t.geometry,e,s),visible:!0}}function z(t,e,s){if(h(t))return null;switch(e){case"point":{const n=t;return{x:n.x,y:n.y,z:n.z,m:n.m,hasZ:n.z!=null,hasM:n.m!=null,type:"point",spatialReference:s}}case"polyline":{const n=t;return{paths:n.paths,hasZ:!!n.hasZ,hasM:!!n.hasM,type:"polyline",spatialReference:s}}case"polygon":{const n=t;return{rings:n.rings,hasZ:!!n.hasZ,hasM:!!n.hasM,type:"polygon",spatialReference:s}}case"multipoint":{const n=t;return{points:n.points,hasZ:!!n.hasZ,hasM:!!n.hasM,type:"multipoint",spatialReference:s}}}}function E(t,e,s,n){return{x:t,y:e,z:s,hasZ:s!=null,hasM:!1,spatialReference:n,type:"point"}}function A(t){if(h(t))return 0;let e=32;switch(t.type){case"point":e+=42;break;case"polyline":case"polygon":{let s=0;const n=2+(t.hasZ?1:0)+(t.hasM?1:0),o=t.type==="polyline"?t.paths:t.rings;for(const i of o)s+=i.length;e+=8*s*n+64,e+=128*s,e+=34,e+=32*(o.length+1);break}case"multipoint":{const s=2+(t.hasZ?1:0)+(t.hasM?1:0),n=t.points.length;e+=8*n*s+64,e+=128*n,e+=34,e+=32;break}case"extent":e+=98,t.hasM&&(e+=32),t.hasZ&&(e+=32);break;case"mesh":e+=l(t.vertexAttributes.position),e+=l(t.vertexAttributes.normal),e+=l(t.vertexAttributes.uv),e+=l(t.vertexAttributes.tangent)}return e}function G(t){let e=32;return e+=m(t.attributes),e+=3,e+=8+A(t.geometry),e}function H(t){if(h(t))return 0;switch(t.type){case"point":return 1;case"polyline":{let e=0;for(const s of t.paths)e+=s.length;return e}case"polygon":{let e=0;for(const s of t.rings)e+=s.length;return e}case"multipoint":return t.points.length;case"extent":return 2;case"mesh":{const e=t.vertexAttributes&&t.vertexAttributes.position;return e?e.length/3:0}default:return}}function K(t){if(h(t))return!1;switch(t.type){case"extent":case"point":return!0;case"polyline":for(const e of t.paths)if(e.length>0)return!0;return!1;case"polygon":for(const e of t.rings)if(e.length>0)return!0;return!1;case"multipoint":return t.points.length>0;case"mesh":return!t.loaded||t.vertexAttributes.position.length>0}}function Q(t,e){switch(b(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[3]=t.x,e[1]=e[4]=t.y,t.hasZ&&(e[2]=e[5]=t.z);break;case"polyline":for(let s=0;s<t.paths.length;s++)c(e,t.paths[s],t.hasZ);break;case"polygon":for(let s=0;s<t.rings.length;s++)c(e,t.rings[s],t.hasZ);break;case"multipoint":c(e,t.points,t.hasZ);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[3]=t.xmax,e[4]=t.ymax,t.zmin!=null&&(e[2]=t.zmin),t.zmax!=null&&(e[5]=t.zmax)}}function U(t,e){switch(x(e),t.type==="mesh"&&(t=t.extent),t.type){case"point":e[0]=e[2]=t.x,e[1]=e[3]=t.y;break;case"polyline":for(let s=0;s<t.paths.length;s++)u(e,t.paths[s]);break;case"polygon":for(let s=0;s<t.rings.length;s++)u(e,t.rings[s]);break;case"multipoint":u(e,t.points);break;case"extent":e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax}}function V(t,e){return t.objectId!=null?t.objectId:t.attributes&&e?t.attributes[e]:null}g();d();export{G as A,U as J,B as M,C as N,V as O,K as S,Q as T,q as j,E as v,H as w,D as z};
