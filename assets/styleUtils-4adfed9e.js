import{O as p,U as b,F as w}from"./request-d3e98716.js";import{a as m}from"./Error-653283ae.js";import{r as u}from"./typedArrayUtil-a8b5b3e9.js";import{w as h}from"./promiseUtils-6684e352.js";import{j}from"./Portal-8b65c9c4.js";import{d as U}from"./PortalGroup-bfe93c76.js";import{h as y}from"./string-cdf077e6.js";const $=()=>!!y("enable-feature:force-wosr"),E=()=>!!y("enable-feature:direct-3d-object-feature-layer-display"),M=()=>!!y("enable-feature:SceneLayer-editing"),f={};async function N(e,r){try{return{data:(await R(e,r)).data,baseUrl:p(e),styleUrl:e}}catch(t){return h(t),null}}function g(e,r,t){const s=u(r.portal)?r.portal:j.getDefault();let n;const a=`${s.url} - ${s.user&&s.user.username} - ${e}`;return f[a]||(f[a]=I(e,s,t).then(o=>(n=o,o.fetchData())).then(o=>({data:o,baseUrl:n.itemUrl??"",styleName:e}))),f[a]}function I(e,r,t){return r.load(t).then(()=>{const s=new U({disableExtraQuery:!0,query:`owner:${i} AND type:${c} AND typekeywords:"${e}"`});return r.queryItems(s,t)}).then(({results:s})=>{var o;let n=null;const a=e.toLowerCase();if(s&&Array.isArray(s)){for(const l of s)if(((o=l.typeKeywords)==null?void 0:o.some(d=>d.toLowerCase()===a))&&l.type===c&&l.owner===i){n=l;break}}if(!n)throw new m("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(t)})}function O(e,r,t){return e&&u(e.styleUrl)?N(e.styleUrl,t):e&&u(e.styleName)?g(e.styleName,r,t):Promise.reject(new m("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function T(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function v(e,r){if(r==="cimRef")return e.cimRef;if(e.formatInfos&&!$()){for(const t of e.formatInfos)if(t.type==="gltf")return t.href}return e.webRef}function R(e,r){const t={responseType:"json",query:{f:"json"},...r};return b(w(e),t)}const i="esri_en",c="Style",F="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{E as a,R as b,O as c,v as d,T as p,M as t,F as w};
